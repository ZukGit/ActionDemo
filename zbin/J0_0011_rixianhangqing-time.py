#  encoding: utf-8

import tushare as ts
import os
import pandas as pd  # https://www.jianshu.com/p/5c0aa1fa19af
import openpyxl 
from openpyxl import load_workbook,Workbook
import time,datetime  # https://www.jb51.net/article/66019.htm
import re
import os
import tempfile

############################## 全局数据初始化块 数据初始化函数  End ##############################

##############  properities 函数 Begin ##############

class Properties:

    def __init__(self, file_name):
        self.file_name = file_name
        self.properties = {}
        try:
            fopen = open(self.file_name, 'r')
            for line in fopen:
                line = line.strip()
                if line.find('=') > 0 and not line.startswith('#'):
                    strs = line.split('=')
                    self.properties[strs[0].strip()] = strs[1].strip()
        except Exception :
            raise
        else:
            fopen.close()

    def has_key(self, key):
        return key in self.properties

    def get(self, key, default_value=''):
        if key in self.properties:
            return self.properties[key]
        return default_value

    def put(self, key, value):
        self.properties[key] = value
        replace_property(self.file_name, key + '=.*', key + '=' + value, True)


def replace_property(file_name, from_regex, to_str, append_on_not_exists=True):
    tmpfile = tempfile.TemporaryFile()

    if os.path.exists(file_name):
        r_open = open(file_name, 'r')
        pattern = re.compile(r'' + from_regex)
        found = None
        for line in r_open:
            if pattern.search(line) and not line.strip().startswith('#'):
                found = True
                line = re.sub(from_regex, to_str, line)
            tmpfile.write(line.encode())
        if not found and append_on_not_exists:
            tmpfile.write(('\n' + to_str).encode())
        r_open.close()
        tmpfile.seek(0)

        content = tmpfile.read()

        if os.path.exists(file_name):
            os.remove(file_name)

        w_open = open(file_name, 'wb')
        w_open.write(content)
        w_open.close()

        tmpfile.close()
    else:
        print ("file %s not found" % file_name)

##############  properities 函数 End ##############


##############  XLSX excel 函数 Begin ##############

def createexcel(filename):    ### 创建本地文件名称为 filename的文件
    wb = Workbook()
    curPath = os.path.abspath('.')
    cur_desktop_path=os.path.join(os.path.expanduser("~"), 'Desktop')
    curDir = cur_desktop_path+os.sep+"zbin"+os.sep+"J0_Data"+os.sep  ## 创建~/Desktop/zbin/J0_Data 这个 这个工作目录
    #curDir = curPath+os.sep
    if not os.path.exists(curDir):
        os.makedirs(curDir)
    #curPath = os.path.dirname(os.path.abspath('.'))
    #t = time.strftime('%Y%m%d%H%M%S', time.localtime(time.time()))
    #suffix = '.xlsx' # 文件类型
    #newfile = t + suffix
    xlsxPath = curDir + filename
    print("curPath curDir=" + curPath)
    print("createexcel zbin_JO_Dir=" + curDir)
    print("createexcel path=" + xlsxPath)
    if not os.path.exists(xlsxPath):
        wb.save(xlsxPath)
        print(" wb.save(xlsxPath)  xlsxPath =" + xlsxPath)
        time.sleep(1)
    return xlsxPath

def getColumnIndex(table, columnName):   ## 返回 table 中 名称为  columnName 的 那列 的索引
    columnIndex = None
    for i in range(table.ncols):
        if(table.cell_value(0, i) == columnName):
            columnIndex = i
            break
    return columnIndex
#封装函数    https://blog.csdn.net/weixin_41267342/article/details/86634007

##############  XLSX excel 函数 End ##############



############################## Prop初始化 Begin ##############################

#
#Thu Aug 13 22:33:45 CST 2020
#rixianhangqing-time_record_date=20200707
#rixianhangqing-time_start_date=20010101

desktop_path = os.path.join(os.path.expanduser("~"), 'Desktop')
zbin_path = str(desktop_path)+os.sep+"zbin"
j0_properties_path= str(zbin_path)+os.sep+"J0.properties"
print("desktop_path = "+ str(desktop_path))
print("zbin_path = "+ str(zbin_path))
print("j0_properties_path = "+ str(j0_properties_path))
J0_PROPS =  Properties(j0_properties_path)


############################## Prop初始化 End ##############################


############## tscode_股票列表的初始化  Begin ##############
#封装函数    https://blog.csdn.net/weixin_41267342/article/details/86634007
def init_tscode_data(book_name, sheet_name,ts_code_set,tscode_name_dict):
    # 读取excel
    wb = openpyxl.load_workbook(book_name)
    # 读取sheet表
    ws = wb[sheet_name]
    for i in range(ws.max_row):
         # 获取下拉框中的所有选择值
         if (i == 0 or i == 1):
             continue
         #print("i="+str(i)+" 总的列数:" + str(ws.max_row)+"  value:"+str(ws.cell(i,2).value))
         tscode_item = str(ws.cell(i,1).value)  ##  20201010--> 2:ts_code    4_name   ##  20201116--> 1:ts_code    3_name 
         tscode_name_item = str(ws.cell(i,3).value)
         #print("index="+str(i)+" tscode_item = "+ str(tscode_item) + "   tscode_name_item="+str(tscode_name_item))
         ts_code_set.add(str(ws.cell(i,1).value))
         tscode_name_dict[tscode_item]=tscode_name_item



tscode_set = set()    #### 股票代码的集合   000001.SZ   .... 999999.SH
tscode_name_dict = dict()  #### code-name 的 map的集合
init_tscode_data(zbin_path+os.sep+"J0_Python"+os.sep+"J0_股票列表.xlsx","股票列表",tscode_set,tscode_name_dict)
############## tscode_股票列表的初始化  End  ##############


############################## 运行属性 Begin ##############################
pd.set_option('display.max_rows', None)   ##  解决纵向出现...
#pd.set_option('display.width', 1000) 
pd.set_option('expand_frame_repr', False)  ##  解决横向出现...
Cur_Abs_Path=os.path.abspath('.')   # 表示当前所处的文件夹的绝对路径
print("当前绝对路径:"+Cur_Abs_Path)
Cur_Ref_Path=os.path.abspath('..')  # 表示当前所处的文件夹上一级文件夹的绝对路径
print("当前父目录绝对路径:"+Cur_Ref_Path)
############################## 运行属性 End ##############################

############################## 时间Date Begin ##############################

now_yyyymmdd=str(time.strftime('%Y%m%d', time.localtime(time.time())))
print("now_yyyymmdd = "+ str(now_yyyymmdd))

############################## 时间Date End ##############################





pro = ts.pro_api('43acb9a5ddc2cf73c6c4ea54796748f965457ed57daaa736bb778ea2')
# print(J0_PROPS.get(tree_node_name+"record_date"))           #根据key读取value
# J0_PROPS.put(tree_node_name+"record_date", now_yyyymmdd)       ###  覆盖原有的 key 和 value
#  zukgit
# rixianhangqing-time_zukgit_website  =   https://tushare.pro/document/2?doc_id=27
tree_node_name="rixianhangqing-time"+"_"
createexcel('daily_201001.xlsx')
daily_201001_book = load_workbook('C:\\Users\\zhuzj5\\Desktop\\zbin\\J0_Data\\daily_201001.xlsx')
daily_201001_excel_writer = pd.ExcelWriter('C:\\Users\\zhuzj5\\Desktop\\zbin\\J0_Data\\daily_201001.xlsx', engine='openpyxl')
daily_201001_excel_writer.book = daily_201001_book
daily_201001_excel_writer.sheets = dict((ws.title, ws) for ws in daily_201001_book.worksheets)
J0_PROPS.put(tree_node_name+"record_date", "20100101")       ###  更新 记录日期
daily_20100104 = pro.daily(start_date='',end_date='',trade_date='20100104', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20100104_tscode_list = list() 
for ts_code_sh in daily_20100104['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20100104_tscode_list.append(stock_name)
daily_20100104_addname_dataframe=pd.DataFrame()
daily_20100104_addname_dataframe['cname'] = daily_20100104_tscode_list
for table_name in daily_20100104.columns.values.tolist():
    daily_20100104_addname_dataframe[table_name] = daily_20100104[table_name]
print("日线行情-时间为序  daily_20100104 返回数据 row 行数 = "+str(daily_20100104.shape[0]))
daily_20100104_addname_dataframe.to_excel(daily_201001_excel_writer,'4_1',index=False)
daily_201001_excel_writer.save()
daily_20100105 = pro.daily(start_date='',end_date='',trade_date='20100105', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20100105_tscode_list = list() 
for ts_code_sh in daily_20100105['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20100105_tscode_list.append(stock_name)
daily_20100105_addname_dataframe=pd.DataFrame()
daily_20100105_addname_dataframe['cname'] = daily_20100105_tscode_list
for table_name in daily_20100105.columns.values.tolist():
    daily_20100105_addname_dataframe[table_name] = daily_20100105[table_name]
print("日线行情-时间为序  daily_20100105 返回数据 row 行数 = "+str(daily_20100105.shape[0]))
daily_20100105_addname_dataframe.to_excel(daily_201001_excel_writer,'5_2',index=False)
daily_201001_excel_writer.save()
daily_20100106 = pro.daily(start_date='',end_date='',trade_date='20100106', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20100106_tscode_list = list() 
for ts_code_sh in daily_20100106['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20100106_tscode_list.append(stock_name)
daily_20100106_addname_dataframe=pd.DataFrame()
daily_20100106_addname_dataframe['cname'] = daily_20100106_tscode_list
for table_name in daily_20100106.columns.values.tolist():
    daily_20100106_addname_dataframe[table_name] = daily_20100106[table_name]
print("日线行情-时间为序  daily_20100106 返回数据 row 行数 = "+str(daily_20100106.shape[0]))
daily_20100106_addname_dataframe.to_excel(daily_201001_excel_writer,'6_3',index=False)
daily_201001_excel_writer.save()
daily_20100107 = pro.daily(start_date='',end_date='',trade_date='20100107', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20100107_tscode_list = list() 
for ts_code_sh in daily_20100107['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20100107_tscode_list.append(stock_name)
daily_20100107_addname_dataframe=pd.DataFrame()
daily_20100107_addname_dataframe['cname'] = daily_20100107_tscode_list
for table_name in daily_20100107.columns.values.tolist():
    daily_20100107_addname_dataframe[table_name] = daily_20100107[table_name]
print("日线行情-时间为序  daily_20100107 返回数据 row 行数 = "+str(daily_20100107.shape[0]))
daily_20100107_addname_dataframe.to_excel(daily_201001_excel_writer,'7_4',index=False)
daily_201001_excel_writer.save()
daily_20100108 = pro.daily(start_date='',end_date='',trade_date='20100108', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20100108_tscode_list = list() 
for ts_code_sh in daily_20100108['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20100108_tscode_list.append(stock_name)
daily_20100108_addname_dataframe=pd.DataFrame()
daily_20100108_addname_dataframe['cname'] = daily_20100108_tscode_list
for table_name in daily_20100108.columns.values.tolist():
    daily_20100108_addname_dataframe[table_name] = daily_20100108[table_name]
print("日线行情-时间为序  daily_20100108 返回数据 row 行数 = "+str(daily_20100108.shape[0]))
daily_20100108_addname_dataframe.to_excel(daily_201001_excel_writer,'8_5',index=False)
daily_201001_excel_writer.save()
daily_20100111 = pro.daily(start_date='',end_date='',trade_date='20100111', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20100111_tscode_list = list() 
for ts_code_sh in daily_20100111['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20100111_tscode_list.append(stock_name)
daily_20100111_addname_dataframe=pd.DataFrame()
daily_20100111_addname_dataframe['cname'] = daily_20100111_tscode_list
for table_name in daily_20100111.columns.values.tolist():
    daily_20100111_addname_dataframe[table_name] = daily_20100111[table_name]
print("日线行情-时间为序  daily_20100111 返回数据 row 行数 = "+str(daily_20100111.shape[0]))
daily_20100111_addname_dataframe.to_excel(daily_201001_excel_writer,'11_1',index=False)
daily_201001_excel_writer.save()
daily_20100112 = pro.daily(start_date='',end_date='',trade_date='20100112', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20100112_tscode_list = list() 
for ts_code_sh in daily_20100112['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20100112_tscode_list.append(stock_name)
daily_20100112_addname_dataframe=pd.DataFrame()
daily_20100112_addname_dataframe['cname'] = daily_20100112_tscode_list
for table_name in daily_20100112.columns.values.tolist():
    daily_20100112_addname_dataframe[table_name] = daily_20100112[table_name]
print("日线行情-时间为序  daily_20100112 返回数据 row 行数 = "+str(daily_20100112.shape[0]))
daily_20100112_addname_dataframe.to_excel(daily_201001_excel_writer,'12_2',index=False)
daily_201001_excel_writer.save()
daily_20100113 = pro.daily(start_date='',end_date='',trade_date='20100113', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20100113_tscode_list = list() 
for ts_code_sh in daily_20100113['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20100113_tscode_list.append(stock_name)
daily_20100113_addname_dataframe=pd.DataFrame()
daily_20100113_addname_dataframe['cname'] = daily_20100113_tscode_list
for table_name in daily_20100113.columns.values.tolist():
    daily_20100113_addname_dataframe[table_name] = daily_20100113[table_name]
print("日线行情-时间为序  daily_20100113 返回数据 row 行数 = "+str(daily_20100113.shape[0]))
daily_20100113_addname_dataframe.to_excel(daily_201001_excel_writer,'13_3',index=False)
daily_201001_excel_writer.save()
daily_20100114 = pro.daily(start_date='',end_date='',trade_date='20100114', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20100114_tscode_list = list() 
for ts_code_sh in daily_20100114['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20100114_tscode_list.append(stock_name)
daily_20100114_addname_dataframe=pd.DataFrame()
daily_20100114_addname_dataframe['cname'] = daily_20100114_tscode_list
for table_name in daily_20100114.columns.values.tolist():
    daily_20100114_addname_dataframe[table_name] = daily_20100114[table_name]
print("日线行情-时间为序  daily_20100114 返回数据 row 行数 = "+str(daily_20100114.shape[0]))
daily_20100114_addname_dataframe.to_excel(daily_201001_excel_writer,'14_4',index=False)
daily_201001_excel_writer.save()
daily_20100115 = pro.daily(start_date='',end_date='',trade_date='20100115', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20100115_tscode_list = list() 
for ts_code_sh in daily_20100115['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20100115_tscode_list.append(stock_name)
daily_20100115_addname_dataframe=pd.DataFrame()
daily_20100115_addname_dataframe['cname'] = daily_20100115_tscode_list
for table_name in daily_20100115.columns.values.tolist():
    daily_20100115_addname_dataframe[table_name] = daily_20100115[table_name]
print("日线行情-时间为序  daily_20100115 返回数据 row 行数 = "+str(daily_20100115.shape[0]))
daily_20100115_addname_dataframe.to_excel(daily_201001_excel_writer,'15_5',index=False)
daily_201001_excel_writer.save()
daily_20100118 = pro.daily(start_date='',end_date='',trade_date='20100118', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20100118_tscode_list = list() 
for ts_code_sh in daily_20100118['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20100118_tscode_list.append(stock_name)
daily_20100118_addname_dataframe=pd.DataFrame()
daily_20100118_addname_dataframe['cname'] = daily_20100118_tscode_list
for table_name in daily_20100118.columns.values.tolist():
    daily_20100118_addname_dataframe[table_name] = daily_20100118[table_name]
print("日线行情-时间为序  daily_20100118 返回数据 row 行数 = "+str(daily_20100118.shape[0]))
daily_20100118_addname_dataframe.to_excel(daily_201001_excel_writer,'18_1',index=False)
daily_201001_excel_writer.save()
daily_20100119 = pro.daily(start_date='',end_date='',trade_date='20100119', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20100119_tscode_list = list() 
for ts_code_sh in daily_20100119['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20100119_tscode_list.append(stock_name)
daily_20100119_addname_dataframe=pd.DataFrame()
daily_20100119_addname_dataframe['cname'] = daily_20100119_tscode_list
for table_name in daily_20100119.columns.values.tolist():
    daily_20100119_addname_dataframe[table_name] = daily_20100119[table_name]
print("日线行情-时间为序  daily_20100119 返回数据 row 行数 = "+str(daily_20100119.shape[0]))
daily_20100119_addname_dataframe.to_excel(daily_201001_excel_writer,'19_2',index=False)
daily_201001_excel_writer.save()
daily_20100120 = pro.daily(start_date='',end_date='',trade_date='20100120', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20100120_tscode_list = list() 
for ts_code_sh in daily_20100120['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20100120_tscode_list.append(stock_name)
daily_20100120_addname_dataframe=pd.DataFrame()
daily_20100120_addname_dataframe['cname'] = daily_20100120_tscode_list
for table_name in daily_20100120.columns.values.tolist():
    daily_20100120_addname_dataframe[table_name] = daily_20100120[table_name]
print("日线行情-时间为序  daily_20100120 返回数据 row 行数 = "+str(daily_20100120.shape[0]))
daily_20100120_addname_dataframe.to_excel(daily_201001_excel_writer,'20_3',index=False)
daily_201001_excel_writer.save()
daily_20100121 = pro.daily(start_date='',end_date='',trade_date='20100121', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20100121_tscode_list = list() 
for ts_code_sh in daily_20100121['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20100121_tscode_list.append(stock_name)
daily_20100121_addname_dataframe=pd.DataFrame()
daily_20100121_addname_dataframe['cname'] = daily_20100121_tscode_list
for table_name in daily_20100121.columns.values.tolist():
    daily_20100121_addname_dataframe[table_name] = daily_20100121[table_name]
print("日线行情-时间为序  daily_20100121 返回数据 row 行数 = "+str(daily_20100121.shape[0]))
daily_20100121_addname_dataframe.to_excel(daily_201001_excel_writer,'21_4',index=False)
daily_201001_excel_writer.save()
daily_20100122 = pro.daily(start_date='',end_date='',trade_date='20100122', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20100122_tscode_list = list() 
for ts_code_sh in daily_20100122['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20100122_tscode_list.append(stock_name)
daily_20100122_addname_dataframe=pd.DataFrame()
daily_20100122_addname_dataframe['cname'] = daily_20100122_tscode_list
for table_name in daily_20100122.columns.values.tolist():
    daily_20100122_addname_dataframe[table_name] = daily_20100122[table_name]
print("日线行情-时间为序  daily_20100122 返回数据 row 行数 = "+str(daily_20100122.shape[0]))
daily_20100122_addname_dataframe.to_excel(daily_201001_excel_writer,'22_5',index=False)
daily_201001_excel_writer.save()
daily_20100125 = pro.daily(start_date='',end_date='',trade_date='20100125', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20100125_tscode_list = list() 
for ts_code_sh in daily_20100125['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20100125_tscode_list.append(stock_name)
daily_20100125_addname_dataframe=pd.DataFrame()
daily_20100125_addname_dataframe['cname'] = daily_20100125_tscode_list
for table_name in daily_20100125.columns.values.tolist():
    daily_20100125_addname_dataframe[table_name] = daily_20100125[table_name]
print("日线行情-时间为序  daily_20100125 返回数据 row 行数 = "+str(daily_20100125.shape[0]))
daily_20100125_addname_dataframe.to_excel(daily_201001_excel_writer,'25_1',index=False)
daily_201001_excel_writer.save()
daily_20100126 = pro.daily(start_date='',end_date='',trade_date='20100126', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20100126_tscode_list = list() 
for ts_code_sh in daily_20100126['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20100126_tscode_list.append(stock_name)
daily_20100126_addname_dataframe=pd.DataFrame()
daily_20100126_addname_dataframe['cname'] = daily_20100126_tscode_list
for table_name in daily_20100126.columns.values.tolist():
    daily_20100126_addname_dataframe[table_name] = daily_20100126[table_name]
print("日线行情-时间为序  daily_20100126 返回数据 row 行数 = "+str(daily_20100126.shape[0]))
daily_20100126_addname_dataframe.to_excel(daily_201001_excel_writer,'26_2',index=False)
daily_201001_excel_writer.save()
daily_20100127 = pro.daily(start_date='',end_date='',trade_date='20100127', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20100127_tscode_list = list() 
for ts_code_sh in daily_20100127['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20100127_tscode_list.append(stock_name)
daily_20100127_addname_dataframe=pd.DataFrame()
daily_20100127_addname_dataframe['cname'] = daily_20100127_tscode_list
for table_name in daily_20100127.columns.values.tolist():
    daily_20100127_addname_dataframe[table_name] = daily_20100127[table_name]
print("日线行情-时间为序  daily_20100127 返回数据 row 行数 = "+str(daily_20100127.shape[0]))
daily_20100127_addname_dataframe.to_excel(daily_201001_excel_writer,'27_3',index=False)
daily_201001_excel_writer.save()
daily_20100128 = pro.daily(start_date='',end_date='',trade_date='20100128', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20100128_tscode_list = list() 
for ts_code_sh in daily_20100128['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20100128_tscode_list.append(stock_name)
daily_20100128_addname_dataframe=pd.DataFrame()
daily_20100128_addname_dataframe['cname'] = daily_20100128_tscode_list
for table_name in daily_20100128.columns.values.tolist():
    daily_20100128_addname_dataframe[table_name] = daily_20100128[table_name]
print("日线行情-时间为序  daily_20100128 返回数据 row 行数 = "+str(daily_20100128.shape[0]))
daily_20100128_addname_dataframe.to_excel(daily_201001_excel_writer,'28_4',index=False)
daily_201001_excel_writer.save()
daily_20100129 = pro.daily(start_date='',end_date='',trade_date='20100129', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20100129_tscode_list = list() 
for ts_code_sh in daily_20100129['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20100129_tscode_list.append(stock_name)
daily_20100129_addname_dataframe=pd.DataFrame()
daily_20100129_addname_dataframe['cname'] = daily_20100129_tscode_list
for table_name in daily_20100129.columns.values.tolist():
    daily_20100129_addname_dataframe[table_name] = daily_20100129[table_name]
print("日线行情-时间为序  daily_20100129 返回数据 row 行数 = "+str(daily_20100129.shape[0]))
daily_20100129_addname_dataframe.to_excel(daily_201001_excel_writer,'29_5',index=False)
daily_201001_excel_writer.save()




createexcel('daily_201002.xlsx')
daily_201002_book = load_workbook('C:\\Users\\zhuzj5\\Desktop\\zbin\\J0_Data\\daily_201002.xlsx')
daily_201002_excel_writer = pd.ExcelWriter('C:\\Users\\zhuzj5\\Desktop\\zbin\\J0_Data\\daily_201002.xlsx', engine='openpyxl')
daily_201002_excel_writer.book = daily_201002_book
daily_201002_excel_writer.sheets = dict((ws.title, ws) for ws in daily_201002_book.worksheets)
J0_PROPS.put(tree_node_name+"record_date", "20100201")       ###  更新 记录日期
daily_20100201 = pro.daily(start_date='',end_date='',trade_date='20100201', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20100201_tscode_list = list() 
for ts_code_sh in daily_20100201['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20100201_tscode_list.append(stock_name)
daily_20100201_addname_dataframe=pd.DataFrame()
daily_20100201_addname_dataframe['cname'] = daily_20100201_tscode_list
for table_name in daily_20100201.columns.values.tolist():
    daily_20100201_addname_dataframe[table_name] = daily_20100201[table_name]
print("日线行情-时间为序  daily_20100201 返回数据 row 行数 = "+str(daily_20100201.shape[0]))
daily_20100201_addname_dataframe.to_excel(daily_201002_excel_writer,'1_1',index=False)
daily_201002_excel_writer.save()
daily_20100202 = pro.daily(start_date='',end_date='',trade_date='20100202', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20100202_tscode_list = list() 
for ts_code_sh in daily_20100202['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20100202_tscode_list.append(stock_name)
daily_20100202_addname_dataframe=pd.DataFrame()
daily_20100202_addname_dataframe['cname'] = daily_20100202_tscode_list
for table_name in daily_20100202.columns.values.tolist():
    daily_20100202_addname_dataframe[table_name] = daily_20100202[table_name]
print("日线行情-时间为序  daily_20100202 返回数据 row 行数 = "+str(daily_20100202.shape[0]))
daily_20100202_addname_dataframe.to_excel(daily_201002_excel_writer,'2_2',index=False)
daily_201002_excel_writer.save()
daily_20100203 = pro.daily(start_date='',end_date='',trade_date='20100203', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20100203_tscode_list = list() 
for ts_code_sh in daily_20100203['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20100203_tscode_list.append(stock_name)
daily_20100203_addname_dataframe=pd.DataFrame()
daily_20100203_addname_dataframe['cname'] = daily_20100203_tscode_list
for table_name in daily_20100203.columns.values.tolist():
    daily_20100203_addname_dataframe[table_name] = daily_20100203[table_name]
print("日线行情-时间为序  daily_20100203 返回数据 row 行数 = "+str(daily_20100203.shape[0]))
daily_20100203_addname_dataframe.to_excel(daily_201002_excel_writer,'3_3',index=False)
daily_201002_excel_writer.save()
daily_20100204 = pro.daily(start_date='',end_date='',trade_date='20100204', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20100204_tscode_list = list() 
for ts_code_sh in daily_20100204['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20100204_tscode_list.append(stock_name)
daily_20100204_addname_dataframe=pd.DataFrame()
daily_20100204_addname_dataframe['cname'] = daily_20100204_tscode_list
for table_name in daily_20100204.columns.values.tolist():
    daily_20100204_addname_dataframe[table_name] = daily_20100204[table_name]
print("日线行情-时间为序  daily_20100204 返回数据 row 行数 = "+str(daily_20100204.shape[0]))
daily_20100204_addname_dataframe.to_excel(daily_201002_excel_writer,'4_4',index=False)
daily_201002_excel_writer.save()
daily_20100205 = pro.daily(start_date='',end_date='',trade_date='20100205', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20100205_tscode_list = list() 
for ts_code_sh in daily_20100205['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20100205_tscode_list.append(stock_name)
daily_20100205_addname_dataframe=pd.DataFrame()
daily_20100205_addname_dataframe['cname'] = daily_20100205_tscode_list
for table_name in daily_20100205.columns.values.tolist():
    daily_20100205_addname_dataframe[table_name] = daily_20100205[table_name]
print("日线行情-时间为序  daily_20100205 返回数据 row 行数 = "+str(daily_20100205.shape[0]))
daily_20100205_addname_dataframe.to_excel(daily_201002_excel_writer,'5_5',index=False)
daily_201002_excel_writer.save()
daily_20100208 = pro.daily(start_date='',end_date='',trade_date='20100208', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20100208_tscode_list = list() 
for ts_code_sh in daily_20100208['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20100208_tscode_list.append(stock_name)
daily_20100208_addname_dataframe=pd.DataFrame()
daily_20100208_addname_dataframe['cname'] = daily_20100208_tscode_list
for table_name in daily_20100208.columns.values.tolist():
    daily_20100208_addname_dataframe[table_name] = daily_20100208[table_name]
print("日线行情-时间为序  daily_20100208 返回数据 row 行数 = "+str(daily_20100208.shape[0]))
daily_20100208_addname_dataframe.to_excel(daily_201002_excel_writer,'8_1',index=False)
daily_201002_excel_writer.save()
daily_20100209 = pro.daily(start_date='',end_date='',trade_date='20100209', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20100209_tscode_list = list() 
for ts_code_sh in daily_20100209['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20100209_tscode_list.append(stock_name)
daily_20100209_addname_dataframe=pd.DataFrame()
daily_20100209_addname_dataframe['cname'] = daily_20100209_tscode_list
for table_name in daily_20100209.columns.values.tolist():
    daily_20100209_addname_dataframe[table_name] = daily_20100209[table_name]
print("日线行情-时间为序  daily_20100209 返回数据 row 行数 = "+str(daily_20100209.shape[0]))
daily_20100209_addname_dataframe.to_excel(daily_201002_excel_writer,'9_2',index=False)
daily_201002_excel_writer.save()
daily_20100210 = pro.daily(start_date='',end_date='',trade_date='20100210', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20100210_tscode_list = list() 
for ts_code_sh in daily_20100210['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20100210_tscode_list.append(stock_name)
daily_20100210_addname_dataframe=pd.DataFrame()
daily_20100210_addname_dataframe['cname'] = daily_20100210_tscode_list
for table_name in daily_20100210.columns.values.tolist():
    daily_20100210_addname_dataframe[table_name] = daily_20100210[table_name]
print("日线行情-时间为序  daily_20100210 返回数据 row 行数 = "+str(daily_20100210.shape[0]))
daily_20100210_addname_dataframe.to_excel(daily_201002_excel_writer,'10_3',index=False)
daily_201002_excel_writer.save()
daily_20100211 = pro.daily(start_date='',end_date='',trade_date='20100211', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20100211_tscode_list = list() 
for ts_code_sh in daily_20100211['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20100211_tscode_list.append(stock_name)
daily_20100211_addname_dataframe=pd.DataFrame()
daily_20100211_addname_dataframe['cname'] = daily_20100211_tscode_list
for table_name in daily_20100211.columns.values.tolist():
    daily_20100211_addname_dataframe[table_name] = daily_20100211[table_name]
print("日线行情-时间为序  daily_20100211 返回数据 row 行数 = "+str(daily_20100211.shape[0]))
daily_20100211_addname_dataframe.to_excel(daily_201002_excel_writer,'11_4',index=False)
daily_201002_excel_writer.save()
daily_20100212 = pro.daily(start_date='',end_date='',trade_date='20100212', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20100212_tscode_list = list() 
for ts_code_sh in daily_20100212['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20100212_tscode_list.append(stock_name)
daily_20100212_addname_dataframe=pd.DataFrame()
daily_20100212_addname_dataframe['cname'] = daily_20100212_tscode_list
for table_name in daily_20100212.columns.values.tolist():
    daily_20100212_addname_dataframe[table_name] = daily_20100212[table_name]
print("日线行情-时间为序  daily_20100212 返回数据 row 行数 = "+str(daily_20100212.shape[0]))
daily_20100212_addname_dataframe.to_excel(daily_201002_excel_writer,'12_5',index=False)
daily_201002_excel_writer.save()
daily_20100222 = pro.daily(start_date='',end_date='',trade_date='20100222', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20100222_tscode_list = list() 
for ts_code_sh in daily_20100222['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20100222_tscode_list.append(stock_name)
daily_20100222_addname_dataframe=pd.DataFrame()
daily_20100222_addname_dataframe['cname'] = daily_20100222_tscode_list
for table_name in daily_20100222.columns.values.tolist():
    daily_20100222_addname_dataframe[table_name] = daily_20100222[table_name]
print("日线行情-时间为序  daily_20100222 返回数据 row 行数 = "+str(daily_20100222.shape[0]))
daily_20100222_addname_dataframe.to_excel(daily_201002_excel_writer,'22_1',index=False)
daily_201002_excel_writer.save()
daily_20100223 = pro.daily(start_date='',end_date='',trade_date='20100223', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20100223_tscode_list = list() 
for ts_code_sh in daily_20100223['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20100223_tscode_list.append(stock_name)
daily_20100223_addname_dataframe=pd.DataFrame()
daily_20100223_addname_dataframe['cname'] = daily_20100223_tscode_list
for table_name in daily_20100223.columns.values.tolist():
    daily_20100223_addname_dataframe[table_name] = daily_20100223[table_name]
print("日线行情-时间为序  daily_20100223 返回数据 row 行数 = "+str(daily_20100223.shape[0]))
daily_20100223_addname_dataframe.to_excel(daily_201002_excel_writer,'23_2',index=False)
daily_201002_excel_writer.save()
daily_20100224 = pro.daily(start_date='',end_date='',trade_date='20100224', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20100224_tscode_list = list() 
for ts_code_sh in daily_20100224['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20100224_tscode_list.append(stock_name)
daily_20100224_addname_dataframe=pd.DataFrame()
daily_20100224_addname_dataframe['cname'] = daily_20100224_tscode_list
for table_name in daily_20100224.columns.values.tolist():
    daily_20100224_addname_dataframe[table_name] = daily_20100224[table_name]
print("日线行情-时间为序  daily_20100224 返回数据 row 行数 = "+str(daily_20100224.shape[0]))
daily_20100224_addname_dataframe.to_excel(daily_201002_excel_writer,'24_3',index=False)
daily_201002_excel_writer.save()
daily_20100225 = pro.daily(start_date='',end_date='',trade_date='20100225', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20100225_tscode_list = list() 
for ts_code_sh in daily_20100225['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20100225_tscode_list.append(stock_name)
daily_20100225_addname_dataframe=pd.DataFrame()
daily_20100225_addname_dataframe['cname'] = daily_20100225_tscode_list
for table_name in daily_20100225.columns.values.tolist():
    daily_20100225_addname_dataframe[table_name] = daily_20100225[table_name]
print("日线行情-时间为序  daily_20100225 返回数据 row 行数 = "+str(daily_20100225.shape[0]))
daily_20100225_addname_dataframe.to_excel(daily_201002_excel_writer,'25_4',index=False)
daily_201002_excel_writer.save()
daily_20100226 = pro.daily(start_date='',end_date='',trade_date='20100226', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20100226_tscode_list = list() 
for ts_code_sh in daily_20100226['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20100226_tscode_list.append(stock_name)
daily_20100226_addname_dataframe=pd.DataFrame()
daily_20100226_addname_dataframe['cname'] = daily_20100226_tscode_list
for table_name in daily_20100226.columns.values.tolist():
    daily_20100226_addname_dataframe[table_name] = daily_20100226[table_name]
print("日线行情-时间为序  daily_20100226 返回数据 row 行数 = "+str(daily_20100226.shape[0]))
daily_20100226_addname_dataframe.to_excel(daily_201002_excel_writer,'26_5',index=False)
daily_201002_excel_writer.save()




createexcel('daily_201003.xlsx')
daily_201003_book = load_workbook('C:\\Users\\zhuzj5\\Desktop\\zbin\\J0_Data\\daily_201003.xlsx')
daily_201003_excel_writer = pd.ExcelWriter('C:\\Users\\zhuzj5\\Desktop\\zbin\\J0_Data\\daily_201003.xlsx', engine='openpyxl')
daily_201003_excel_writer.book = daily_201003_book
daily_201003_excel_writer.sheets = dict((ws.title, ws) for ws in daily_201003_book.worksheets)
J0_PROPS.put(tree_node_name+"record_date", "20100301")       ###  更新 记录日期
daily_20100301 = pro.daily(start_date='',end_date='',trade_date='20100301', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20100301_tscode_list = list() 
for ts_code_sh in daily_20100301['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20100301_tscode_list.append(stock_name)
daily_20100301_addname_dataframe=pd.DataFrame()
daily_20100301_addname_dataframe['cname'] = daily_20100301_tscode_list
for table_name in daily_20100301.columns.values.tolist():
    daily_20100301_addname_dataframe[table_name] = daily_20100301[table_name]
print("日线行情-时间为序  daily_20100301 返回数据 row 行数 = "+str(daily_20100301.shape[0]))
daily_20100301_addname_dataframe.to_excel(daily_201003_excel_writer,'1_1',index=False)
daily_201003_excel_writer.save()
daily_20100302 = pro.daily(start_date='',end_date='',trade_date='20100302', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20100302_tscode_list = list() 
for ts_code_sh in daily_20100302['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20100302_tscode_list.append(stock_name)
daily_20100302_addname_dataframe=pd.DataFrame()
daily_20100302_addname_dataframe['cname'] = daily_20100302_tscode_list
for table_name in daily_20100302.columns.values.tolist():
    daily_20100302_addname_dataframe[table_name] = daily_20100302[table_name]
print("日线行情-时间为序  daily_20100302 返回数据 row 行数 = "+str(daily_20100302.shape[0]))
daily_20100302_addname_dataframe.to_excel(daily_201003_excel_writer,'2_2',index=False)
daily_201003_excel_writer.save()
daily_20100303 = pro.daily(start_date='',end_date='',trade_date='20100303', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20100303_tscode_list = list() 
for ts_code_sh in daily_20100303['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20100303_tscode_list.append(stock_name)
daily_20100303_addname_dataframe=pd.DataFrame()
daily_20100303_addname_dataframe['cname'] = daily_20100303_tscode_list
for table_name in daily_20100303.columns.values.tolist():
    daily_20100303_addname_dataframe[table_name] = daily_20100303[table_name]
print("日线行情-时间为序  daily_20100303 返回数据 row 行数 = "+str(daily_20100303.shape[0]))
daily_20100303_addname_dataframe.to_excel(daily_201003_excel_writer,'3_3',index=False)
daily_201003_excel_writer.save()
daily_20100304 = pro.daily(start_date='',end_date='',trade_date='20100304', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20100304_tscode_list = list() 
for ts_code_sh in daily_20100304['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20100304_tscode_list.append(stock_name)
daily_20100304_addname_dataframe=pd.DataFrame()
daily_20100304_addname_dataframe['cname'] = daily_20100304_tscode_list
for table_name in daily_20100304.columns.values.tolist():
    daily_20100304_addname_dataframe[table_name] = daily_20100304[table_name]
print("日线行情-时间为序  daily_20100304 返回数据 row 行数 = "+str(daily_20100304.shape[0]))
daily_20100304_addname_dataframe.to_excel(daily_201003_excel_writer,'4_4',index=False)
daily_201003_excel_writer.save()
daily_20100305 = pro.daily(start_date='',end_date='',trade_date='20100305', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20100305_tscode_list = list() 
for ts_code_sh in daily_20100305['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20100305_tscode_list.append(stock_name)
daily_20100305_addname_dataframe=pd.DataFrame()
daily_20100305_addname_dataframe['cname'] = daily_20100305_tscode_list
for table_name in daily_20100305.columns.values.tolist():
    daily_20100305_addname_dataframe[table_name] = daily_20100305[table_name]
print("日线行情-时间为序  daily_20100305 返回数据 row 行数 = "+str(daily_20100305.shape[0]))
daily_20100305_addname_dataframe.to_excel(daily_201003_excel_writer,'5_5',index=False)
daily_201003_excel_writer.save()
daily_20100308 = pro.daily(start_date='',end_date='',trade_date='20100308', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20100308_tscode_list = list() 
for ts_code_sh in daily_20100308['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20100308_tscode_list.append(stock_name)
daily_20100308_addname_dataframe=pd.DataFrame()
daily_20100308_addname_dataframe['cname'] = daily_20100308_tscode_list
for table_name in daily_20100308.columns.values.tolist():
    daily_20100308_addname_dataframe[table_name] = daily_20100308[table_name]
print("日线行情-时间为序  daily_20100308 返回数据 row 行数 = "+str(daily_20100308.shape[0]))
daily_20100308_addname_dataframe.to_excel(daily_201003_excel_writer,'8_1',index=False)
daily_201003_excel_writer.save()
daily_20100309 = pro.daily(start_date='',end_date='',trade_date='20100309', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20100309_tscode_list = list() 
for ts_code_sh in daily_20100309['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20100309_tscode_list.append(stock_name)
daily_20100309_addname_dataframe=pd.DataFrame()
daily_20100309_addname_dataframe['cname'] = daily_20100309_tscode_list
for table_name in daily_20100309.columns.values.tolist():
    daily_20100309_addname_dataframe[table_name] = daily_20100309[table_name]
print("日线行情-时间为序  daily_20100309 返回数据 row 行数 = "+str(daily_20100309.shape[0]))
daily_20100309_addname_dataframe.to_excel(daily_201003_excel_writer,'9_2',index=False)
daily_201003_excel_writer.save()
daily_20100310 = pro.daily(start_date='',end_date='',trade_date='20100310', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20100310_tscode_list = list() 
for ts_code_sh in daily_20100310['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20100310_tscode_list.append(stock_name)
daily_20100310_addname_dataframe=pd.DataFrame()
daily_20100310_addname_dataframe['cname'] = daily_20100310_tscode_list
for table_name in daily_20100310.columns.values.tolist():
    daily_20100310_addname_dataframe[table_name] = daily_20100310[table_name]
print("日线行情-时间为序  daily_20100310 返回数据 row 行数 = "+str(daily_20100310.shape[0]))
daily_20100310_addname_dataframe.to_excel(daily_201003_excel_writer,'10_3',index=False)
daily_201003_excel_writer.save()
daily_20100311 = pro.daily(start_date='',end_date='',trade_date='20100311', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20100311_tscode_list = list() 
for ts_code_sh in daily_20100311['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20100311_tscode_list.append(stock_name)
daily_20100311_addname_dataframe=pd.DataFrame()
daily_20100311_addname_dataframe['cname'] = daily_20100311_tscode_list
for table_name in daily_20100311.columns.values.tolist():
    daily_20100311_addname_dataframe[table_name] = daily_20100311[table_name]
print("日线行情-时间为序  daily_20100311 返回数据 row 行数 = "+str(daily_20100311.shape[0]))
daily_20100311_addname_dataframe.to_excel(daily_201003_excel_writer,'11_4',index=False)
daily_201003_excel_writer.save()
daily_20100312 = pro.daily(start_date='',end_date='',trade_date='20100312', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20100312_tscode_list = list() 
for ts_code_sh in daily_20100312['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20100312_tscode_list.append(stock_name)
daily_20100312_addname_dataframe=pd.DataFrame()
daily_20100312_addname_dataframe['cname'] = daily_20100312_tscode_list
for table_name in daily_20100312.columns.values.tolist():
    daily_20100312_addname_dataframe[table_name] = daily_20100312[table_name]
print("日线行情-时间为序  daily_20100312 返回数据 row 行数 = "+str(daily_20100312.shape[0]))
daily_20100312_addname_dataframe.to_excel(daily_201003_excel_writer,'12_5',index=False)
daily_201003_excel_writer.save()
daily_20100315 = pro.daily(start_date='',end_date='',trade_date='20100315', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20100315_tscode_list = list() 
for ts_code_sh in daily_20100315['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20100315_tscode_list.append(stock_name)
daily_20100315_addname_dataframe=pd.DataFrame()
daily_20100315_addname_dataframe['cname'] = daily_20100315_tscode_list
for table_name in daily_20100315.columns.values.tolist():
    daily_20100315_addname_dataframe[table_name] = daily_20100315[table_name]
print("日线行情-时间为序  daily_20100315 返回数据 row 行数 = "+str(daily_20100315.shape[0]))
daily_20100315_addname_dataframe.to_excel(daily_201003_excel_writer,'15_1',index=False)
daily_201003_excel_writer.save()
daily_20100316 = pro.daily(start_date='',end_date='',trade_date='20100316', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20100316_tscode_list = list() 
for ts_code_sh in daily_20100316['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20100316_tscode_list.append(stock_name)
daily_20100316_addname_dataframe=pd.DataFrame()
daily_20100316_addname_dataframe['cname'] = daily_20100316_tscode_list
for table_name in daily_20100316.columns.values.tolist():
    daily_20100316_addname_dataframe[table_name] = daily_20100316[table_name]
print("日线行情-时间为序  daily_20100316 返回数据 row 行数 = "+str(daily_20100316.shape[0]))
daily_20100316_addname_dataframe.to_excel(daily_201003_excel_writer,'16_2',index=False)
daily_201003_excel_writer.save()
daily_20100317 = pro.daily(start_date='',end_date='',trade_date='20100317', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20100317_tscode_list = list() 
for ts_code_sh in daily_20100317['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20100317_tscode_list.append(stock_name)
daily_20100317_addname_dataframe=pd.DataFrame()
daily_20100317_addname_dataframe['cname'] = daily_20100317_tscode_list
for table_name in daily_20100317.columns.values.tolist():
    daily_20100317_addname_dataframe[table_name] = daily_20100317[table_name]
print("日线行情-时间为序  daily_20100317 返回数据 row 行数 = "+str(daily_20100317.shape[0]))
daily_20100317_addname_dataframe.to_excel(daily_201003_excel_writer,'17_3',index=False)
daily_201003_excel_writer.save()
daily_20100318 = pro.daily(start_date='',end_date='',trade_date='20100318', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20100318_tscode_list = list() 
for ts_code_sh in daily_20100318['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20100318_tscode_list.append(stock_name)
daily_20100318_addname_dataframe=pd.DataFrame()
daily_20100318_addname_dataframe['cname'] = daily_20100318_tscode_list
for table_name in daily_20100318.columns.values.tolist():
    daily_20100318_addname_dataframe[table_name] = daily_20100318[table_name]
print("日线行情-时间为序  daily_20100318 返回数据 row 行数 = "+str(daily_20100318.shape[0]))
daily_20100318_addname_dataframe.to_excel(daily_201003_excel_writer,'18_4',index=False)
daily_201003_excel_writer.save()
daily_20100319 = pro.daily(start_date='',end_date='',trade_date='20100319', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20100319_tscode_list = list() 
for ts_code_sh in daily_20100319['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20100319_tscode_list.append(stock_name)
daily_20100319_addname_dataframe=pd.DataFrame()
daily_20100319_addname_dataframe['cname'] = daily_20100319_tscode_list
for table_name in daily_20100319.columns.values.tolist():
    daily_20100319_addname_dataframe[table_name] = daily_20100319[table_name]
print("日线行情-时间为序  daily_20100319 返回数据 row 行数 = "+str(daily_20100319.shape[0]))
daily_20100319_addname_dataframe.to_excel(daily_201003_excel_writer,'19_5',index=False)
daily_201003_excel_writer.save()
daily_20100322 = pro.daily(start_date='',end_date='',trade_date='20100322', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20100322_tscode_list = list() 
for ts_code_sh in daily_20100322['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20100322_tscode_list.append(stock_name)
daily_20100322_addname_dataframe=pd.DataFrame()
daily_20100322_addname_dataframe['cname'] = daily_20100322_tscode_list
for table_name in daily_20100322.columns.values.tolist():
    daily_20100322_addname_dataframe[table_name] = daily_20100322[table_name]
print("日线行情-时间为序  daily_20100322 返回数据 row 行数 = "+str(daily_20100322.shape[0]))
daily_20100322_addname_dataframe.to_excel(daily_201003_excel_writer,'22_1',index=False)
daily_201003_excel_writer.save()
daily_20100323 = pro.daily(start_date='',end_date='',trade_date='20100323', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20100323_tscode_list = list() 
for ts_code_sh in daily_20100323['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20100323_tscode_list.append(stock_name)
daily_20100323_addname_dataframe=pd.DataFrame()
daily_20100323_addname_dataframe['cname'] = daily_20100323_tscode_list
for table_name in daily_20100323.columns.values.tolist():
    daily_20100323_addname_dataframe[table_name] = daily_20100323[table_name]
print("日线行情-时间为序  daily_20100323 返回数据 row 行数 = "+str(daily_20100323.shape[0]))
daily_20100323_addname_dataframe.to_excel(daily_201003_excel_writer,'23_2',index=False)
daily_201003_excel_writer.save()
daily_20100324 = pro.daily(start_date='',end_date='',trade_date='20100324', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20100324_tscode_list = list() 
for ts_code_sh in daily_20100324['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20100324_tscode_list.append(stock_name)
daily_20100324_addname_dataframe=pd.DataFrame()
daily_20100324_addname_dataframe['cname'] = daily_20100324_tscode_list
for table_name in daily_20100324.columns.values.tolist():
    daily_20100324_addname_dataframe[table_name] = daily_20100324[table_name]
print("日线行情-时间为序  daily_20100324 返回数据 row 行数 = "+str(daily_20100324.shape[0]))
daily_20100324_addname_dataframe.to_excel(daily_201003_excel_writer,'24_3',index=False)
daily_201003_excel_writer.save()
daily_20100325 = pro.daily(start_date='',end_date='',trade_date='20100325', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20100325_tscode_list = list() 
for ts_code_sh in daily_20100325['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20100325_tscode_list.append(stock_name)
daily_20100325_addname_dataframe=pd.DataFrame()
daily_20100325_addname_dataframe['cname'] = daily_20100325_tscode_list
for table_name in daily_20100325.columns.values.tolist():
    daily_20100325_addname_dataframe[table_name] = daily_20100325[table_name]
print("日线行情-时间为序  daily_20100325 返回数据 row 行数 = "+str(daily_20100325.shape[0]))
daily_20100325_addname_dataframe.to_excel(daily_201003_excel_writer,'25_4',index=False)
daily_201003_excel_writer.save()
daily_20100326 = pro.daily(start_date='',end_date='',trade_date='20100326', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20100326_tscode_list = list() 
for ts_code_sh in daily_20100326['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20100326_tscode_list.append(stock_name)
daily_20100326_addname_dataframe=pd.DataFrame()
daily_20100326_addname_dataframe['cname'] = daily_20100326_tscode_list
for table_name in daily_20100326.columns.values.tolist():
    daily_20100326_addname_dataframe[table_name] = daily_20100326[table_name]
print("日线行情-时间为序  daily_20100326 返回数据 row 行数 = "+str(daily_20100326.shape[0]))
daily_20100326_addname_dataframe.to_excel(daily_201003_excel_writer,'26_5',index=False)
daily_201003_excel_writer.save()
daily_20100329 = pro.daily(start_date='',end_date='',trade_date='20100329', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20100329_tscode_list = list() 
for ts_code_sh in daily_20100329['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20100329_tscode_list.append(stock_name)
daily_20100329_addname_dataframe=pd.DataFrame()
daily_20100329_addname_dataframe['cname'] = daily_20100329_tscode_list
for table_name in daily_20100329.columns.values.tolist():
    daily_20100329_addname_dataframe[table_name] = daily_20100329[table_name]
print("日线行情-时间为序  daily_20100329 返回数据 row 行数 = "+str(daily_20100329.shape[0]))
daily_20100329_addname_dataframe.to_excel(daily_201003_excel_writer,'29_1',index=False)
daily_201003_excel_writer.save()
daily_20100330 = pro.daily(start_date='',end_date='',trade_date='20100330', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20100330_tscode_list = list() 
for ts_code_sh in daily_20100330['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20100330_tscode_list.append(stock_name)
daily_20100330_addname_dataframe=pd.DataFrame()
daily_20100330_addname_dataframe['cname'] = daily_20100330_tscode_list
for table_name in daily_20100330.columns.values.tolist():
    daily_20100330_addname_dataframe[table_name] = daily_20100330[table_name]
print("日线行情-时间为序  daily_20100330 返回数据 row 行数 = "+str(daily_20100330.shape[0]))
daily_20100330_addname_dataframe.to_excel(daily_201003_excel_writer,'30_2',index=False)
daily_201003_excel_writer.save()
daily_20100331 = pro.daily(start_date='',end_date='',trade_date='20100331', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20100331_tscode_list = list() 
for ts_code_sh in daily_20100331['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20100331_tscode_list.append(stock_name)
daily_20100331_addname_dataframe=pd.DataFrame()
daily_20100331_addname_dataframe['cname'] = daily_20100331_tscode_list
for table_name in daily_20100331.columns.values.tolist():
    daily_20100331_addname_dataframe[table_name] = daily_20100331[table_name]
print("日线行情-时间为序  daily_20100331 返回数据 row 行数 = "+str(daily_20100331.shape[0]))
daily_20100331_addname_dataframe.to_excel(daily_201003_excel_writer,'31_3',index=False)
daily_201003_excel_writer.save()




createexcel('daily_201004.xlsx')
daily_201004_book = load_workbook('C:\\Users\\zhuzj5\\Desktop\\zbin\\J0_Data\\daily_201004.xlsx')
daily_201004_excel_writer = pd.ExcelWriter('C:\\Users\\zhuzj5\\Desktop\\zbin\\J0_Data\\daily_201004.xlsx', engine='openpyxl')
daily_201004_excel_writer.book = daily_201004_book
daily_201004_excel_writer.sheets = dict((ws.title, ws) for ws in daily_201004_book.worksheets)
J0_PROPS.put(tree_node_name+"record_date", "20100401")       ###  更新 记录日期
daily_20100401 = pro.daily(start_date='',end_date='',trade_date='20100401', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20100401_tscode_list = list() 
for ts_code_sh in daily_20100401['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20100401_tscode_list.append(stock_name)
daily_20100401_addname_dataframe=pd.DataFrame()
daily_20100401_addname_dataframe['cname'] = daily_20100401_tscode_list
for table_name in daily_20100401.columns.values.tolist():
    daily_20100401_addname_dataframe[table_name] = daily_20100401[table_name]
print("日线行情-时间为序  daily_20100401 返回数据 row 行数 = "+str(daily_20100401.shape[0]))
daily_20100401_addname_dataframe.to_excel(daily_201004_excel_writer,'1_4',index=False)
daily_201004_excel_writer.save()
daily_20100402 = pro.daily(start_date='',end_date='',trade_date='20100402', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20100402_tscode_list = list() 
for ts_code_sh in daily_20100402['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20100402_tscode_list.append(stock_name)
daily_20100402_addname_dataframe=pd.DataFrame()
daily_20100402_addname_dataframe['cname'] = daily_20100402_tscode_list
for table_name in daily_20100402.columns.values.tolist():
    daily_20100402_addname_dataframe[table_name] = daily_20100402[table_name]
print("日线行情-时间为序  daily_20100402 返回数据 row 行数 = "+str(daily_20100402.shape[0]))
daily_20100402_addname_dataframe.to_excel(daily_201004_excel_writer,'2_5',index=False)
daily_201004_excel_writer.save()
daily_20100406 = pro.daily(start_date='',end_date='',trade_date='20100406', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20100406_tscode_list = list() 
for ts_code_sh in daily_20100406['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20100406_tscode_list.append(stock_name)
daily_20100406_addname_dataframe=pd.DataFrame()
daily_20100406_addname_dataframe['cname'] = daily_20100406_tscode_list
for table_name in daily_20100406.columns.values.tolist():
    daily_20100406_addname_dataframe[table_name] = daily_20100406[table_name]
print("日线行情-时间为序  daily_20100406 返回数据 row 行数 = "+str(daily_20100406.shape[0]))
daily_20100406_addname_dataframe.to_excel(daily_201004_excel_writer,'6_2',index=False)
daily_201004_excel_writer.save()
daily_20100407 = pro.daily(start_date='',end_date='',trade_date='20100407', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20100407_tscode_list = list() 
for ts_code_sh in daily_20100407['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20100407_tscode_list.append(stock_name)
daily_20100407_addname_dataframe=pd.DataFrame()
daily_20100407_addname_dataframe['cname'] = daily_20100407_tscode_list
for table_name in daily_20100407.columns.values.tolist():
    daily_20100407_addname_dataframe[table_name] = daily_20100407[table_name]
print("日线行情-时间为序  daily_20100407 返回数据 row 行数 = "+str(daily_20100407.shape[0]))
daily_20100407_addname_dataframe.to_excel(daily_201004_excel_writer,'7_3',index=False)
daily_201004_excel_writer.save()
daily_20100408 = pro.daily(start_date='',end_date='',trade_date='20100408', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20100408_tscode_list = list() 
for ts_code_sh in daily_20100408['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20100408_tscode_list.append(stock_name)
daily_20100408_addname_dataframe=pd.DataFrame()
daily_20100408_addname_dataframe['cname'] = daily_20100408_tscode_list
for table_name in daily_20100408.columns.values.tolist():
    daily_20100408_addname_dataframe[table_name] = daily_20100408[table_name]
print("日线行情-时间为序  daily_20100408 返回数据 row 行数 = "+str(daily_20100408.shape[0]))
daily_20100408_addname_dataframe.to_excel(daily_201004_excel_writer,'8_4',index=False)
daily_201004_excel_writer.save()
daily_20100409 = pro.daily(start_date='',end_date='',trade_date='20100409', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20100409_tscode_list = list() 
for ts_code_sh in daily_20100409['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20100409_tscode_list.append(stock_name)
daily_20100409_addname_dataframe=pd.DataFrame()
daily_20100409_addname_dataframe['cname'] = daily_20100409_tscode_list
for table_name in daily_20100409.columns.values.tolist():
    daily_20100409_addname_dataframe[table_name] = daily_20100409[table_name]
print("日线行情-时间为序  daily_20100409 返回数据 row 行数 = "+str(daily_20100409.shape[0]))
daily_20100409_addname_dataframe.to_excel(daily_201004_excel_writer,'9_5',index=False)
daily_201004_excel_writer.save()
daily_20100412 = pro.daily(start_date='',end_date='',trade_date='20100412', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20100412_tscode_list = list() 
for ts_code_sh in daily_20100412['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20100412_tscode_list.append(stock_name)
daily_20100412_addname_dataframe=pd.DataFrame()
daily_20100412_addname_dataframe['cname'] = daily_20100412_tscode_list
for table_name in daily_20100412.columns.values.tolist():
    daily_20100412_addname_dataframe[table_name] = daily_20100412[table_name]
print("日线行情-时间为序  daily_20100412 返回数据 row 行数 = "+str(daily_20100412.shape[0]))
daily_20100412_addname_dataframe.to_excel(daily_201004_excel_writer,'12_1',index=False)
daily_201004_excel_writer.save()
daily_20100413 = pro.daily(start_date='',end_date='',trade_date='20100413', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20100413_tscode_list = list() 
for ts_code_sh in daily_20100413['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20100413_tscode_list.append(stock_name)
daily_20100413_addname_dataframe=pd.DataFrame()
daily_20100413_addname_dataframe['cname'] = daily_20100413_tscode_list
for table_name in daily_20100413.columns.values.tolist():
    daily_20100413_addname_dataframe[table_name] = daily_20100413[table_name]
print("日线行情-时间为序  daily_20100413 返回数据 row 行数 = "+str(daily_20100413.shape[0]))
daily_20100413_addname_dataframe.to_excel(daily_201004_excel_writer,'13_2',index=False)
daily_201004_excel_writer.save()
daily_20100414 = pro.daily(start_date='',end_date='',trade_date='20100414', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20100414_tscode_list = list() 
for ts_code_sh in daily_20100414['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20100414_tscode_list.append(stock_name)
daily_20100414_addname_dataframe=pd.DataFrame()
daily_20100414_addname_dataframe['cname'] = daily_20100414_tscode_list
for table_name in daily_20100414.columns.values.tolist():
    daily_20100414_addname_dataframe[table_name] = daily_20100414[table_name]
print("日线行情-时间为序  daily_20100414 返回数据 row 行数 = "+str(daily_20100414.shape[0]))
daily_20100414_addname_dataframe.to_excel(daily_201004_excel_writer,'14_3',index=False)
daily_201004_excel_writer.save()
daily_20100415 = pro.daily(start_date='',end_date='',trade_date='20100415', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20100415_tscode_list = list() 
for ts_code_sh in daily_20100415['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20100415_tscode_list.append(stock_name)
daily_20100415_addname_dataframe=pd.DataFrame()
daily_20100415_addname_dataframe['cname'] = daily_20100415_tscode_list
for table_name in daily_20100415.columns.values.tolist():
    daily_20100415_addname_dataframe[table_name] = daily_20100415[table_name]
print("日线行情-时间为序  daily_20100415 返回数据 row 行数 = "+str(daily_20100415.shape[0]))
daily_20100415_addname_dataframe.to_excel(daily_201004_excel_writer,'15_4',index=False)
daily_201004_excel_writer.save()
daily_20100416 = pro.daily(start_date='',end_date='',trade_date='20100416', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20100416_tscode_list = list() 
for ts_code_sh in daily_20100416['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20100416_tscode_list.append(stock_name)
daily_20100416_addname_dataframe=pd.DataFrame()
daily_20100416_addname_dataframe['cname'] = daily_20100416_tscode_list
for table_name in daily_20100416.columns.values.tolist():
    daily_20100416_addname_dataframe[table_name] = daily_20100416[table_name]
print("日线行情-时间为序  daily_20100416 返回数据 row 行数 = "+str(daily_20100416.shape[0]))
daily_20100416_addname_dataframe.to_excel(daily_201004_excel_writer,'16_5',index=False)
daily_201004_excel_writer.save()
daily_20100419 = pro.daily(start_date='',end_date='',trade_date='20100419', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20100419_tscode_list = list() 
for ts_code_sh in daily_20100419['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20100419_tscode_list.append(stock_name)
daily_20100419_addname_dataframe=pd.DataFrame()
daily_20100419_addname_dataframe['cname'] = daily_20100419_tscode_list
for table_name in daily_20100419.columns.values.tolist():
    daily_20100419_addname_dataframe[table_name] = daily_20100419[table_name]
print("日线行情-时间为序  daily_20100419 返回数据 row 行数 = "+str(daily_20100419.shape[0]))
daily_20100419_addname_dataframe.to_excel(daily_201004_excel_writer,'19_1',index=False)
daily_201004_excel_writer.save()
daily_20100420 = pro.daily(start_date='',end_date='',trade_date='20100420', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20100420_tscode_list = list() 
for ts_code_sh in daily_20100420['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20100420_tscode_list.append(stock_name)
daily_20100420_addname_dataframe=pd.DataFrame()
daily_20100420_addname_dataframe['cname'] = daily_20100420_tscode_list
for table_name in daily_20100420.columns.values.tolist():
    daily_20100420_addname_dataframe[table_name] = daily_20100420[table_name]
print("日线行情-时间为序  daily_20100420 返回数据 row 行数 = "+str(daily_20100420.shape[0]))
daily_20100420_addname_dataframe.to_excel(daily_201004_excel_writer,'20_2',index=False)
daily_201004_excel_writer.save()
daily_20100421 = pro.daily(start_date='',end_date='',trade_date='20100421', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20100421_tscode_list = list() 
for ts_code_sh in daily_20100421['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20100421_tscode_list.append(stock_name)
daily_20100421_addname_dataframe=pd.DataFrame()
daily_20100421_addname_dataframe['cname'] = daily_20100421_tscode_list
for table_name in daily_20100421.columns.values.tolist():
    daily_20100421_addname_dataframe[table_name] = daily_20100421[table_name]
print("日线行情-时间为序  daily_20100421 返回数据 row 行数 = "+str(daily_20100421.shape[0]))
daily_20100421_addname_dataframe.to_excel(daily_201004_excel_writer,'21_3',index=False)
daily_201004_excel_writer.save()
daily_20100422 = pro.daily(start_date='',end_date='',trade_date='20100422', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20100422_tscode_list = list() 
for ts_code_sh in daily_20100422['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20100422_tscode_list.append(stock_name)
daily_20100422_addname_dataframe=pd.DataFrame()
daily_20100422_addname_dataframe['cname'] = daily_20100422_tscode_list
for table_name in daily_20100422.columns.values.tolist():
    daily_20100422_addname_dataframe[table_name] = daily_20100422[table_name]
print("日线行情-时间为序  daily_20100422 返回数据 row 行数 = "+str(daily_20100422.shape[0]))
daily_20100422_addname_dataframe.to_excel(daily_201004_excel_writer,'22_4',index=False)
daily_201004_excel_writer.save()
daily_20100423 = pro.daily(start_date='',end_date='',trade_date='20100423', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20100423_tscode_list = list() 
for ts_code_sh in daily_20100423['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20100423_tscode_list.append(stock_name)
daily_20100423_addname_dataframe=pd.DataFrame()
daily_20100423_addname_dataframe['cname'] = daily_20100423_tscode_list
for table_name in daily_20100423.columns.values.tolist():
    daily_20100423_addname_dataframe[table_name] = daily_20100423[table_name]
print("日线行情-时间为序  daily_20100423 返回数据 row 行数 = "+str(daily_20100423.shape[0]))
daily_20100423_addname_dataframe.to_excel(daily_201004_excel_writer,'23_5',index=False)
daily_201004_excel_writer.save()
daily_20100426 = pro.daily(start_date='',end_date='',trade_date='20100426', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20100426_tscode_list = list() 
for ts_code_sh in daily_20100426['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20100426_tscode_list.append(stock_name)
daily_20100426_addname_dataframe=pd.DataFrame()
daily_20100426_addname_dataframe['cname'] = daily_20100426_tscode_list
for table_name in daily_20100426.columns.values.tolist():
    daily_20100426_addname_dataframe[table_name] = daily_20100426[table_name]
print("日线行情-时间为序  daily_20100426 返回数据 row 行数 = "+str(daily_20100426.shape[0]))
daily_20100426_addname_dataframe.to_excel(daily_201004_excel_writer,'26_1',index=False)
daily_201004_excel_writer.save()
daily_20100427 = pro.daily(start_date='',end_date='',trade_date='20100427', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20100427_tscode_list = list() 
for ts_code_sh in daily_20100427['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20100427_tscode_list.append(stock_name)
daily_20100427_addname_dataframe=pd.DataFrame()
daily_20100427_addname_dataframe['cname'] = daily_20100427_tscode_list
for table_name in daily_20100427.columns.values.tolist():
    daily_20100427_addname_dataframe[table_name] = daily_20100427[table_name]
print("日线行情-时间为序  daily_20100427 返回数据 row 行数 = "+str(daily_20100427.shape[0]))
daily_20100427_addname_dataframe.to_excel(daily_201004_excel_writer,'27_2',index=False)
daily_201004_excel_writer.save()
daily_20100428 = pro.daily(start_date='',end_date='',trade_date='20100428', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20100428_tscode_list = list() 
for ts_code_sh in daily_20100428['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20100428_tscode_list.append(stock_name)
daily_20100428_addname_dataframe=pd.DataFrame()
daily_20100428_addname_dataframe['cname'] = daily_20100428_tscode_list
for table_name in daily_20100428.columns.values.tolist():
    daily_20100428_addname_dataframe[table_name] = daily_20100428[table_name]
print("日线行情-时间为序  daily_20100428 返回数据 row 行数 = "+str(daily_20100428.shape[0]))
daily_20100428_addname_dataframe.to_excel(daily_201004_excel_writer,'28_3',index=False)
daily_201004_excel_writer.save()
daily_20100429 = pro.daily(start_date='',end_date='',trade_date='20100429', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20100429_tscode_list = list() 
for ts_code_sh in daily_20100429['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20100429_tscode_list.append(stock_name)
daily_20100429_addname_dataframe=pd.DataFrame()
daily_20100429_addname_dataframe['cname'] = daily_20100429_tscode_list
for table_name in daily_20100429.columns.values.tolist():
    daily_20100429_addname_dataframe[table_name] = daily_20100429[table_name]
print("日线行情-时间为序  daily_20100429 返回数据 row 行数 = "+str(daily_20100429.shape[0]))
daily_20100429_addname_dataframe.to_excel(daily_201004_excel_writer,'29_4',index=False)
daily_201004_excel_writer.save()
daily_20100430 = pro.daily(start_date='',end_date='',trade_date='20100430', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20100430_tscode_list = list() 
for ts_code_sh in daily_20100430['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20100430_tscode_list.append(stock_name)
daily_20100430_addname_dataframe=pd.DataFrame()
daily_20100430_addname_dataframe['cname'] = daily_20100430_tscode_list
for table_name in daily_20100430.columns.values.tolist():
    daily_20100430_addname_dataframe[table_name] = daily_20100430[table_name]
print("日线行情-时间为序  daily_20100430 返回数据 row 行数 = "+str(daily_20100430.shape[0]))
daily_20100430_addname_dataframe.to_excel(daily_201004_excel_writer,'30_5',index=False)
daily_201004_excel_writer.save()




createexcel('daily_201005.xlsx')
daily_201005_book = load_workbook('C:\\Users\\zhuzj5\\Desktop\\zbin\\J0_Data\\daily_201005.xlsx')
daily_201005_excel_writer = pd.ExcelWriter('C:\\Users\\zhuzj5\\Desktop\\zbin\\J0_Data\\daily_201005.xlsx', engine='openpyxl')
daily_201005_excel_writer.book = daily_201005_book
daily_201005_excel_writer.sheets = dict((ws.title, ws) for ws in daily_201005_book.worksheets)
J0_PROPS.put(tree_node_name+"record_date", "20100501")       ###  更新 记录日期
daily_20100504 = pro.daily(start_date='',end_date='',trade_date='20100504', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20100504_tscode_list = list() 
for ts_code_sh in daily_20100504['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20100504_tscode_list.append(stock_name)
daily_20100504_addname_dataframe=pd.DataFrame()
daily_20100504_addname_dataframe['cname'] = daily_20100504_tscode_list
for table_name in daily_20100504.columns.values.tolist():
    daily_20100504_addname_dataframe[table_name] = daily_20100504[table_name]
print("日线行情-时间为序  daily_20100504 返回数据 row 行数 = "+str(daily_20100504.shape[0]))
daily_20100504_addname_dataframe.to_excel(daily_201005_excel_writer,'4_2',index=False)
daily_201005_excel_writer.save()
daily_20100505 = pro.daily(start_date='',end_date='',trade_date='20100505', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20100505_tscode_list = list() 
for ts_code_sh in daily_20100505['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20100505_tscode_list.append(stock_name)
daily_20100505_addname_dataframe=pd.DataFrame()
daily_20100505_addname_dataframe['cname'] = daily_20100505_tscode_list
for table_name in daily_20100505.columns.values.tolist():
    daily_20100505_addname_dataframe[table_name] = daily_20100505[table_name]
print("日线行情-时间为序  daily_20100505 返回数据 row 行数 = "+str(daily_20100505.shape[0]))
daily_20100505_addname_dataframe.to_excel(daily_201005_excel_writer,'5_3',index=False)
daily_201005_excel_writer.save()
daily_20100506 = pro.daily(start_date='',end_date='',trade_date='20100506', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20100506_tscode_list = list() 
for ts_code_sh in daily_20100506['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20100506_tscode_list.append(stock_name)
daily_20100506_addname_dataframe=pd.DataFrame()
daily_20100506_addname_dataframe['cname'] = daily_20100506_tscode_list
for table_name in daily_20100506.columns.values.tolist():
    daily_20100506_addname_dataframe[table_name] = daily_20100506[table_name]
print("日线行情-时间为序  daily_20100506 返回数据 row 行数 = "+str(daily_20100506.shape[0]))
daily_20100506_addname_dataframe.to_excel(daily_201005_excel_writer,'6_4',index=False)
daily_201005_excel_writer.save()
daily_20100507 = pro.daily(start_date='',end_date='',trade_date='20100507', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20100507_tscode_list = list() 
for ts_code_sh in daily_20100507['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20100507_tscode_list.append(stock_name)
daily_20100507_addname_dataframe=pd.DataFrame()
daily_20100507_addname_dataframe['cname'] = daily_20100507_tscode_list
for table_name in daily_20100507.columns.values.tolist():
    daily_20100507_addname_dataframe[table_name] = daily_20100507[table_name]
print("日线行情-时间为序  daily_20100507 返回数据 row 行数 = "+str(daily_20100507.shape[0]))
daily_20100507_addname_dataframe.to_excel(daily_201005_excel_writer,'7_5',index=False)
daily_201005_excel_writer.save()
daily_20100510 = pro.daily(start_date='',end_date='',trade_date='20100510', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20100510_tscode_list = list() 
for ts_code_sh in daily_20100510['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20100510_tscode_list.append(stock_name)
daily_20100510_addname_dataframe=pd.DataFrame()
daily_20100510_addname_dataframe['cname'] = daily_20100510_tscode_list
for table_name in daily_20100510.columns.values.tolist():
    daily_20100510_addname_dataframe[table_name] = daily_20100510[table_name]
print("日线行情-时间为序  daily_20100510 返回数据 row 行数 = "+str(daily_20100510.shape[0]))
daily_20100510_addname_dataframe.to_excel(daily_201005_excel_writer,'10_1',index=False)
daily_201005_excel_writer.save()
daily_20100511 = pro.daily(start_date='',end_date='',trade_date='20100511', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20100511_tscode_list = list() 
for ts_code_sh in daily_20100511['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20100511_tscode_list.append(stock_name)
daily_20100511_addname_dataframe=pd.DataFrame()
daily_20100511_addname_dataframe['cname'] = daily_20100511_tscode_list
for table_name in daily_20100511.columns.values.tolist():
    daily_20100511_addname_dataframe[table_name] = daily_20100511[table_name]
print("日线行情-时间为序  daily_20100511 返回数据 row 行数 = "+str(daily_20100511.shape[0]))
daily_20100511_addname_dataframe.to_excel(daily_201005_excel_writer,'11_2',index=False)
daily_201005_excel_writer.save()
daily_20100512 = pro.daily(start_date='',end_date='',trade_date='20100512', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20100512_tscode_list = list() 
for ts_code_sh in daily_20100512['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20100512_tscode_list.append(stock_name)
daily_20100512_addname_dataframe=pd.DataFrame()
daily_20100512_addname_dataframe['cname'] = daily_20100512_tscode_list
for table_name in daily_20100512.columns.values.tolist():
    daily_20100512_addname_dataframe[table_name] = daily_20100512[table_name]
print("日线行情-时间为序  daily_20100512 返回数据 row 行数 = "+str(daily_20100512.shape[0]))
daily_20100512_addname_dataframe.to_excel(daily_201005_excel_writer,'12_3',index=False)
daily_201005_excel_writer.save()
daily_20100513 = pro.daily(start_date='',end_date='',trade_date='20100513', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20100513_tscode_list = list() 
for ts_code_sh in daily_20100513['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20100513_tscode_list.append(stock_name)
daily_20100513_addname_dataframe=pd.DataFrame()
daily_20100513_addname_dataframe['cname'] = daily_20100513_tscode_list
for table_name in daily_20100513.columns.values.tolist():
    daily_20100513_addname_dataframe[table_name] = daily_20100513[table_name]
print("日线行情-时间为序  daily_20100513 返回数据 row 行数 = "+str(daily_20100513.shape[0]))
daily_20100513_addname_dataframe.to_excel(daily_201005_excel_writer,'13_4',index=False)
daily_201005_excel_writer.save()
daily_20100514 = pro.daily(start_date='',end_date='',trade_date='20100514', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20100514_tscode_list = list() 
for ts_code_sh in daily_20100514['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20100514_tscode_list.append(stock_name)
daily_20100514_addname_dataframe=pd.DataFrame()
daily_20100514_addname_dataframe['cname'] = daily_20100514_tscode_list
for table_name in daily_20100514.columns.values.tolist():
    daily_20100514_addname_dataframe[table_name] = daily_20100514[table_name]
print("日线行情-时间为序  daily_20100514 返回数据 row 行数 = "+str(daily_20100514.shape[0]))
daily_20100514_addname_dataframe.to_excel(daily_201005_excel_writer,'14_5',index=False)
daily_201005_excel_writer.save()
daily_20100517 = pro.daily(start_date='',end_date='',trade_date='20100517', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20100517_tscode_list = list() 
for ts_code_sh in daily_20100517['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20100517_tscode_list.append(stock_name)
daily_20100517_addname_dataframe=pd.DataFrame()
daily_20100517_addname_dataframe['cname'] = daily_20100517_tscode_list
for table_name in daily_20100517.columns.values.tolist():
    daily_20100517_addname_dataframe[table_name] = daily_20100517[table_name]
print("日线行情-时间为序  daily_20100517 返回数据 row 行数 = "+str(daily_20100517.shape[0]))
daily_20100517_addname_dataframe.to_excel(daily_201005_excel_writer,'17_1',index=False)
daily_201005_excel_writer.save()
daily_20100518 = pro.daily(start_date='',end_date='',trade_date='20100518', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20100518_tscode_list = list() 
for ts_code_sh in daily_20100518['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20100518_tscode_list.append(stock_name)
daily_20100518_addname_dataframe=pd.DataFrame()
daily_20100518_addname_dataframe['cname'] = daily_20100518_tscode_list
for table_name in daily_20100518.columns.values.tolist():
    daily_20100518_addname_dataframe[table_name] = daily_20100518[table_name]
print("日线行情-时间为序  daily_20100518 返回数据 row 行数 = "+str(daily_20100518.shape[0]))
daily_20100518_addname_dataframe.to_excel(daily_201005_excel_writer,'18_2',index=False)
daily_201005_excel_writer.save()
daily_20100519 = pro.daily(start_date='',end_date='',trade_date='20100519', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20100519_tscode_list = list() 
for ts_code_sh in daily_20100519['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20100519_tscode_list.append(stock_name)
daily_20100519_addname_dataframe=pd.DataFrame()
daily_20100519_addname_dataframe['cname'] = daily_20100519_tscode_list
for table_name in daily_20100519.columns.values.tolist():
    daily_20100519_addname_dataframe[table_name] = daily_20100519[table_name]
print("日线行情-时间为序  daily_20100519 返回数据 row 行数 = "+str(daily_20100519.shape[0]))
daily_20100519_addname_dataframe.to_excel(daily_201005_excel_writer,'19_3',index=False)
daily_201005_excel_writer.save()
daily_20100520 = pro.daily(start_date='',end_date='',trade_date='20100520', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20100520_tscode_list = list() 
for ts_code_sh in daily_20100520['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20100520_tscode_list.append(stock_name)
daily_20100520_addname_dataframe=pd.DataFrame()
daily_20100520_addname_dataframe['cname'] = daily_20100520_tscode_list
for table_name in daily_20100520.columns.values.tolist():
    daily_20100520_addname_dataframe[table_name] = daily_20100520[table_name]
print("日线行情-时间为序  daily_20100520 返回数据 row 行数 = "+str(daily_20100520.shape[0]))
daily_20100520_addname_dataframe.to_excel(daily_201005_excel_writer,'20_4',index=False)
daily_201005_excel_writer.save()
daily_20100521 = pro.daily(start_date='',end_date='',trade_date='20100521', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20100521_tscode_list = list() 
for ts_code_sh in daily_20100521['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20100521_tscode_list.append(stock_name)
daily_20100521_addname_dataframe=pd.DataFrame()
daily_20100521_addname_dataframe['cname'] = daily_20100521_tscode_list
for table_name in daily_20100521.columns.values.tolist():
    daily_20100521_addname_dataframe[table_name] = daily_20100521[table_name]
print("日线行情-时间为序  daily_20100521 返回数据 row 行数 = "+str(daily_20100521.shape[0]))
daily_20100521_addname_dataframe.to_excel(daily_201005_excel_writer,'21_5',index=False)
daily_201005_excel_writer.save()
daily_20100524 = pro.daily(start_date='',end_date='',trade_date='20100524', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20100524_tscode_list = list() 
for ts_code_sh in daily_20100524['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20100524_tscode_list.append(stock_name)
daily_20100524_addname_dataframe=pd.DataFrame()
daily_20100524_addname_dataframe['cname'] = daily_20100524_tscode_list
for table_name in daily_20100524.columns.values.tolist():
    daily_20100524_addname_dataframe[table_name] = daily_20100524[table_name]
print("日线行情-时间为序  daily_20100524 返回数据 row 行数 = "+str(daily_20100524.shape[0]))
daily_20100524_addname_dataframe.to_excel(daily_201005_excel_writer,'24_1',index=False)
daily_201005_excel_writer.save()
daily_20100525 = pro.daily(start_date='',end_date='',trade_date='20100525', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20100525_tscode_list = list() 
for ts_code_sh in daily_20100525['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20100525_tscode_list.append(stock_name)
daily_20100525_addname_dataframe=pd.DataFrame()
daily_20100525_addname_dataframe['cname'] = daily_20100525_tscode_list
for table_name in daily_20100525.columns.values.tolist():
    daily_20100525_addname_dataframe[table_name] = daily_20100525[table_name]
print("日线行情-时间为序  daily_20100525 返回数据 row 行数 = "+str(daily_20100525.shape[0]))
daily_20100525_addname_dataframe.to_excel(daily_201005_excel_writer,'25_2',index=False)
daily_201005_excel_writer.save()
daily_20100526 = pro.daily(start_date='',end_date='',trade_date='20100526', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20100526_tscode_list = list() 
for ts_code_sh in daily_20100526['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20100526_tscode_list.append(stock_name)
daily_20100526_addname_dataframe=pd.DataFrame()
daily_20100526_addname_dataframe['cname'] = daily_20100526_tscode_list
for table_name in daily_20100526.columns.values.tolist():
    daily_20100526_addname_dataframe[table_name] = daily_20100526[table_name]
print("日线行情-时间为序  daily_20100526 返回数据 row 行数 = "+str(daily_20100526.shape[0]))
daily_20100526_addname_dataframe.to_excel(daily_201005_excel_writer,'26_3',index=False)
daily_201005_excel_writer.save()
daily_20100527 = pro.daily(start_date='',end_date='',trade_date='20100527', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20100527_tscode_list = list() 
for ts_code_sh in daily_20100527['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20100527_tscode_list.append(stock_name)
daily_20100527_addname_dataframe=pd.DataFrame()
daily_20100527_addname_dataframe['cname'] = daily_20100527_tscode_list
for table_name in daily_20100527.columns.values.tolist():
    daily_20100527_addname_dataframe[table_name] = daily_20100527[table_name]
print("日线行情-时间为序  daily_20100527 返回数据 row 行数 = "+str(daily_20100527.shape[0]))
daily_20100527_addname_dataframe.to_excel(daily_201005_excel_writer,'27_4',index=False)
daily_201005_excel_writer.save()
daily_20100528 = pro.daily(start_date='',end_date='',trade_date='20100528', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20100528_tscode_list = list() 
for ts_code_sh in daily_20100528['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20100528_tscode_list.append(stock_name)
daily_20100528_addname_dataframe=pd.DataFrame()
daily_20100528_addname_dataframe['cname'] = daily_20100528_tscode_list
for table_name in daily_20100528.columns.values.tolist():
    daily_20100528_addname_dataframe[table_name] = daily_20100528[table_name]
print("日线行情-时间为序  daily_20100528 返回数据 row 行数 = "+str(daily_20100528.shape[0]))
daily_20100528_addname_dataframe.to_excel(daily_201005_excel_writer,'28_5',index=False)
daily_201005_excel_writer.save()
daily_20100531 = pro.daily(start_date='',end_date='',trade_date='20100531', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20100531_tscode_list = list() 
for ts_code_sh in daily_20100531['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20100531_tscode_list.append(stock_name)
daily_20100531_addname_dataframe=pd.DataFrame()
daily_20100531_addname_dataframe['cname'] = daily_20100531_tscode_list
for table_name in daily_20100531.columns.values.tolist():
    daily_20100531_addname_dataframe[table_name] = daily_20100531[table_name]
print("日线行情-时间为序  daily_20100531 返回数据 row 行数 = "+str(daily_20100531.shape[0]))
daily_20100531_addname_dataframe.to_excel(daily_201005_excel_writer,'31_1',index=False)
daily_201005_excel_writer.save()




createexcel('daily_201006.xlsx')
daily_201006_book = load_workbook('C:\\Users\\zhuzj5\\Desktop\\zbin\\J0_Data\\daily_201006.xlsx')
daily_201006_excel_writer = pd.ExcelWriter('C:\\Users\\zhuzj5\\Desktop\\zbin\\J0_Data\\daily_201006.xlsx', engine='openpyxl')
daily_201006_excel_writer.book = daily_201006_book
daily_201006_excel_writer.sheets = dict((ws.title, ws) for ws in daily_201006_book.worksheets)
J0_PROPS.put(tree_node_name+"record_date", "20100601")       ###  更新 记录日期
daily_20100601 = pro.daily(start_date='',end_date='',trade_date='20100601', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20100601_tscode_list = list() 
for ts_code_sh in daily_20100601['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20100601_tscode_list.append(stock_name)
daily_20100601_addname_dataframe=pd.DataFrame()
daily_20100601_addname_dataframe['cname'] = daily_20100601_tscode_list
for table_name in daily_20100601.columns.values.tolist():
    daily_20100601_addname_dataframe[table_name] = daily_20100601[table_name]
print("日线行情-时间为序  daily_20100601 返回数据 row 行数 = "+str(daily_20100601.shape[0]))
daily_20100601_addname_dataframe.to_excel(daily_201006_excel_writer,'1_2',index=False)
daily_201006_excel_writer.save()
daily_20100602 = pro.daily(start_date='',end_date='',trade_date='20100602', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20100602_tscode_list = list() 
for ts_code_sh in daily_20100602['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20100602_tscode_list.append(stock_name)
daily_20100602_addname_dataframe=pd.DataFrame()
daily_20100602_addname_dataframe['cname'] = daily_20100602_tscode_list
for table_name in daily_20100602.columns.values.tolist():
    daily_20100602_addname_dataframe[table_name] = daily_20100602[table_name]
print("日线行情-时间为序  daily_20100602 返回数据 row 行数 = "+str(daily_20100602.shape[0]))
daily_20100602_addname_dataframe.to_excel(daily_201006_excel_writer,'2_3',index=False)
daily_201006_excel_writer.save()
daily_20100603 = pro.daily(start_date='',end_date='',trade_date='20100603', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20100603_tscode_list = list() 
for ts_code_sh in daily_20100603['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20100603_tscode_list.append(stock_name)
daily_20100603_addname_dataframe=pd.DataFrame()
daily_20100603_addname_dataframe['cname'] = daily_20100603_tscode_list
for table_name in daily_20100603.columns.values.tolist():
    daily_20100603_addname_dataframe[table_name] = daily_20100603[table_name]
print("日线行情-时间为序  daily_20100603 返回数据 row 行数 = "+str(daily_20100603.shape[0]))
daily_20100603_addname_dataframe.to_excel(daily_201006_excel_writer,'3_4',index=False)
daily_201006_excel_writer.save()
daily_20100604 = pro.daily(start_date='',end_date='',trade_date='20100604', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20100604_tscode_list = list() 
for ts_code_sh in daily_20100604['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20100604_tscode_list.append(stock_name)
daily_20100604_addname_dataframe=pd.DataFrame()
daily_20100604_addname_dataframe['cname'] = daily_20100604_tscode_list
for table_name in daily_20100604.columns.values.tolist():
    daily_20100604_addname_dataframe[table_name] = daily_20100604[table_name]
print("日线行情-时间为序  daily_20100604 返回数据 row 行数 = "+str(daily_20100604.shape[0]))
daily_20100604_addname_dataframe.to_excel(daily_201006_excel_writer,'4_5',index=False)
daily_201006_excel_writer.save()
daily_20100607 = pro.daily(start_date='',end_date='',trade_date='20100607', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20100607_tscode_list = list() 
for ts_code_sh in daily_20100607['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20100607_tscode_list.append(stock_name)
daily_20100607_addname_dataframe=pd.DataFrame()
daily_20100607_addname_dataframe['cname'] = daily_20100607_tscode_list
for table_name in daily_20100607.columns.values.tolist():
    daily_20100607_addname_dataframe[table_name] = daily_20100607[table_name]
print("日线行情-时间为序  daily_20100607 返回数据 row 行数 = "+str(daily_20100607.shape[0]))
daily_20100607_addname_dataframe.to_excel(daily_201006_excel_writer,'7_1',index=False)
daily_201006_excel_writer.save()
daily_20100608 = pro.daily(start_date='',end_date='',trade_date='20100608', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20100608_tscode_list = list() 
for ts_code_sh in daily_20100608['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20100608_tscode_list.append(stock_name)
daily_20100608_addname_dataframe=pd.DataFrame()
daily_20100608_addname_dataframe['cname'] = daily_20100608_tscode_list
for table_name in daily_20100608.columns.values.tolist():
    daily_20100608_addname_dataframe[table_name] = daily_20100608[table_name]
print("日线行情-时间为序  daily_20100608 返回数据 row 行数 = "+str(daily_20100608.shape[0]))
daily_20100608_addname_dataframe.to_excel(daily_201006_excel_writer,'8_2',index=False)
daily_201006_excel_writer.save()
daily_20100609 = pro.daily(start_date='',end_date='',trade_date='20100609', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20100609_tscode_list = list() 
for ts_code_sh in daily_20100609['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20100609_tscode_list.append(stock_name)
daily_20100609_addname_dataframe=pd.DataFrame()
daily_20100609_addname_dataframe['cname'] = daily_20100609_tscode_list
for table_name in daily_20100609.columns.values.tolist():
    daily_20100609_addname_dataframe[table_name] = daily_20100609[table_name]
print("日线行情-时间为序  daily_20100609 返回数据 row 行数 = "+str(daily_20100609.shape[0]))
daily_20100609_addname_dataframe.to_excel(daily_201006_excel_writer,'9_3',index=False)
daily_201006_excel_writer.save()
daily_20100610 = pro.daily(start_date='',end_date='',trade_date='20100610', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20100610_tscode_list = list() 
for ts_code_sh in daily_20100610['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20100610_tscode_list.append(stock_name)
daily_20100610_addname_dataframe=pd.DataFrame()
daily_20100610_addname_dataframe['cname'] = daily_20100610_tscode_list
for table_name in daily_20100610.columns.values.tolist():
    daily_20100610_addname_dataframe[table_name] = daily_20100610[table_name]
print("日线行情-时间为序  daily_20100610 返回数据 row 行数 = "+str(daily_20100610.shape[0]))
daily_20100610_addname_dataframe.to_excel(daily_201006_excel_writer,'10_4',index=False)
daily_201006_excel_writer.save()
daily_20100611 = pro.daily(start_date='',end_date='',trade_date='20100611', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20100611_tscode_list = list() 
for ts_code_sh in daily_20100611['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20100611_tscode_list.append(stock_name)
daily_20100611_addname_dataframe=pd.DataFrame()
daily_20100611_addname_dataframe['cname'] = daily_20100611_tscode_list
for table_name in daily_20100611.columns.values.tolist():
    daily_20100611_addname_dataframe[table_name] = daily_20100611[table_name]
print("日线行情-时间为序  daily_20100611 返回数据 row 行数 = "+str(daily_20100611.shape[0]))
daily_20100611_addname_dataframe.to_excel(daily_201006_excel_writer,'11_5',index=False)
daily_201006_excel_writer.save()
daily_20100617 = pro.daily(start_date='',end_date='',trade_date='20100617', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20100617_tscode_list = list() 
for ts_code_sh in daily_20100617['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20100617_tscode_list.append(stock_name)
daily_20100617_addname_dataframe=pd.DataFrame()
daily_20100617_addname_dataframe['cname'] = daily_20100617_tscode_list
for table_name in daily_20100617.columns.values.tolist():
    daily_20100617_addname_dataframe[table_name] = daily_20100617[table_name]
print("日线行情-时间为序  daily_20100617 返回数据 row 行数 = "+str(daily_20100617.shape[0]))
daily_20100617_addname_dataframe.to_excel(daily_201006_excel_writer,'17_4',index=False)
daily_201006_excel_writer.save()
daily_20100618 = pro.daily(start_date='',end_date='',trade_date='20100618', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20100618_tscode_list = list() 
for ts_code_sh in daily_20100618['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20100618_tscode_list.append(stock_name)
daily_20100618_addname_dataframe=pd.DataFrame()
daily_20100618_addname_dataframe['cname'] = daily_20100618_tscode_list
for table_name in daily_20100618.columns.values.tolist():
    daily_20100618_addname_dataframe[table_name] = daily_20100618[table_name]
print("日线行情-时间为序  daily_20100618 返回数据 row 行数 = "+str(daily_20100618.shape[0]))
daily_20100618_addname_dataframe.to_excel(daily_201006_excel_writer,'18_5',index=False)
daily_201006_excel_writer.save()
daily_20100621 = pro.daily(start_date='',end_date='',trade_date='20100621', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20100621_tscode_list = list() 
for ts_code_sh in daily_20100621['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20100621_tscode_list.append(stock_name)
daily_20100621_addname_dataframe=pd.DataFrame()
daily_20100621_addname_dataframe['cname'] = daily_20100621_tscode_list
for table_name in daily_20100621.columns.values.tolist():
    daily_20100621_addname_dataframe[table_name] = daily_20100621[table_name]
print("日线行情-时间为序  daily_20100621 返回数据 row 行数 = "+str(daily_20100621.shape[0]))
daily_20100621_addname_dataframe.to_excel(daily_201006_excel_writer,'21_1',index=False)
daily_201006_excel_writer.save()
daily_20100622 = pro.daily(start_date='',end_date='',trade_date='20100622', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20100622_tscode_list = list() 
for ts_code_sh in daily_20100622['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20100622_tscode_list.append(stock_name)
daily_20100622_addname_dataframe=pd.DataFrame()
daily_20100622_addname_dataframe['cname'] = daily_20100622_tscode_list
for table_name in daily_20100622.columns.values.tolist():
    daily_20100622_addname_dataframe[table_name] = daily_20100622[table_name]
print("日线行情-时间为序  daily_20100622 返回数据 row 行数 = "+str(daily_20100622.shape[0]))
daily_20100622_addname_dataframe.to_excel(daily_201006_excel_writer,'22_2',index=False)
daily_201006_excel_writer.save()
daily_20100623 = pro.daily(start_date='',end_date='',trade_date='20100623', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20100623_tscode_list = list() 
for ts_code_sh in daily_20100623['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20100623_tscode_list.append(stock_name)
daily_20100623_addname_dataframe=pd.DataFrame()
daily_20100623_addname_dataframe['cname'] = daily_20100623_tscode_list
for table_name in daily_20100623.columns.values.tolist():
    daily_20100623_addname_dataframe[table_name] = daily_20100623[table_name]
print("日线行情-时间为序  daily_20100623 返回数据 row 行数 = "+str(daily_20100623.shape[0]))
daily_20100623_addname_dataframe.to_excel(daily_201006_excel_writer,'23_3',index=False)
daily_201006_excel_writer.save()
daily_20100624 = pro.daily(start_date='',end_date='',trade_date='20100624', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20100624_tscode_list = list() 
for ts_code_sh in daily_20100624['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20100624_tscode_list.append(stock_name)
daily_20100624_addname_dataframe=pd.DataFrame()
daily_20100624_addname_dataframe['cname'] = daily_20100624_tscode_list
for table_name in daily_20100624.columns.values.tolist():
    daily_20100624_addname_dataframe[table_name] = daily_20100624[table_name]
print("日线行情-时间为序  daily_20100624 返回数据 row 行数 = "+str(daily_20100624.shape[0]))
daily_20100624_addname_dataframe.to_excel(daily_201006_excel_writer,'24_4',index=False)
daily_201006_excel_writer.save()
daily_20100625 = pro.daily(start_date='',end_date='',trade_date='20100625', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20100625_tscode_list = list() 
for ts_code_sh in daily_20100625['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20100625_tscode_list.append(stock_name)
daily_20100625_addname_dataframe=pd.DataFrame()
daily_20100625_addname_dataframe['cname'] = daily_20100625_tscode_list
for table_name in daily_20100625.columns.values.tolist():
    daily_20100625_addname_dataframe[table_name] = daily_20100625[table_name]
print("日线行情-时间为序  daily_20100625 返回数据 row 行数 = "+str(daily_20100625.shape[0]))
daily_20100625_addname_dataframe.to_excel(daily_201006_excel_writer,'25_5',index=False)
daily_201006_excel_writer.save()
daily_20100628 = pro.daily(start_date='',end_date='',trade_date='20100628', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20100628_tscode_list = list() 
for ts_code_sh in daily_20100628['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20100628_tscode_list.append(stock_name)
daily_20100628_addname_dataframe=pd.DataFrame()
daily_20100628_addname_dataframe['cname'] = daily_20100628_tscode_list
for table_name in daily_20100628.columns.values.tolist():
    daily_20100628_addname_dataframe[table_name] = daily_20100628[table_name]
print("日线行情-时间为序  daily_20100628 返回数据 row 行数 = "+str(daily_20100628.shape[0]))
daily_20100628_addname_dataframe.to_excel(daily_201006_excel_writer,'28_1',index=False)
daily_201006_excel_writer.save()
daily_20100629 = pro.daily(start_date='',end_date='',trade_date='20100629', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20100629_tscode_list = list() 
for ts_code_sh in daily_20100629['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20100629_tscode_list.append(stock_name)
daily_20100629_addname_dataframe=pd.DataFrame()
daily_20100629_addname_dataframe['cname'] = daily_20100629_tscode_list
for table_name in daily_20100629.columns.values.tolist():
    daily_20100629_addname_dataframe[table_name] = daily_20100629[table_name]
print("日线行情-时间为序  daily_20100629 返回数据 row 行数 = "+str(daily_20100629.shape[0]))
daily_20100629_addname_dataframe.to_excel(daily_201006_excel_writer,'29_2',index=False)
daily_201006_excel_writer.save()
daily_20100630 = pro.daily(start_date='',end_date='',trade_date='20100630', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20100630_tscode_list = list() 
for ts_code_sh in daily_20100630['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20100630_tscode_list.append(stock_name)
daily_20100630_addname_dataframe=pd.DataFrame()
daily_20100630_addname_dataframe['cname'] = daily_20100630_tscode_list
for table_name in daily_20100630.columns.values.tolist():
    daily_20100630_addname_dataframe[table_name] = daily_20100630[table_name]
print("日线行情-时间为序  daily_20100630 返回数据 row 行数 = "+str(daily_20100630.shape[0]))
daily_20100630_addname_dataframe.to_excel(daily_201006_excel_writer,'30_3',index=False)
daily_201006_excel_writer.save()




createexcel('daily_201007.xlsx')
daily_201007_book = load_workbook('C:\\Users\\zhuzj5\\Desktop\\zbin\\J0_Data\\daily_201007.xlsx')
daily_201007_excel_writer = pd.ExcelWriter('C:\\Users\\zhuzj5\\Desktop\\zbin\\J0_Data\\daily_201007.xlsx', engine='openpyxl')
daily_201007_excel_writer.book = daily_201007_book
daily_201007_excel_writer.sheets = dict((ws.title, ws) for ws in daily_201007_book.worksheets)
J0_PROPS.put(tree_node_name+"record_date", "20100701")       ###  更新 记录日期
daily_20100701 = pro.daily(start_date='',end_date='',trade_date='20100701', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20100701_tscode_list = list() 
for ts_code_sh in daily_20100701['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20100701_tscode_list.append(stock_name)
daily_20100701_addname_dataframe=pd.DataFrame()
daily_20100701_addname_dataframe['cname'] = daily_20100701_tscode_list
for table_name in daily_20100701.columns.values.tolist():
    daily_20100701_addname_dataframe[table_name] = daily_20100701[table_name]
print("日线行情-时间为序  daily_20100701 返回数据 row 行数 = "+str(daily_20100701.shape[0]))
daily_20100701_addname_dataframe.to_excel(daily_201007_excel_writer,'1_4',index=False)
daily_201007_excel_writer.save()
daily_20100702 = pro.daily(start_date='',end_date='',trade_date='20100702', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20100702_tscode_list = list() 
for ts_code_sh in daily_20100702['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20100702_tscode_list.append(stock_name)
daily_20100702_addname_dataframe=pd.DataFrame()
daily_20100702_addname_dataframe['cname'] = daily_20100702_tscode_list
for table_name in daily_20100702.columns.values.tolist():
    daily_20100702_addname_dataframe[table_name] = daily_20100702[table_name]
print("日线行情-时间为序  daily_20100702 返回数据 row 行数 = "+str(daily_20100702.shape[0]))
daily_20100702_addname_dataframe.to_excel(daily_201007_excel_writer,'2_5',index=False)
daily_201007_excel_writer.save()
daily_20100705 = pro.daily(start_date='',end_date='',trade_date='20100705', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20100705_tscode_list = list() 
for ts_code_sh in daily_20100705['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20100705_tscode_list.append(stock_name)
daily_20100705_addname_dataframe=pd.DataFrame()
daily_20100705_addname_dataframe['cname'] = daily_20100705_tscode_list
for table_name in daily_20100705.columns.values.tolist():
    daily_20100705_addname_dataframe[table_name] = daily_20100705[table_name]
print("日线行情-时间为序  daily_20100705 返回数据 row 行数 = "+str(daily_20100705.shape[0]))
daily_20100705_addname_dataframe.to_excel(daily_201007_excel_writer,'5_1',index=False)
daily_201007_excel_writer.save()
daily_20100706 = pro.daily(start_date='',end_date='',trade_date='20100706', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20100706_tscode_list = list() 
for ts_code_sh in daily_20100706['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20100706_tscode_list.append(stock_name)
daily_20100706_addname_dataframe=pd.DataFrame()
daily_20100706_addname_dataframe['cname'] = daily_20100706_tscode_list
for table_name in daily_20100706.columns.values.tolist():
    daily_20100706_addname_dataframe[table_name] = daily_20100706[table_name]
print("日线行情-时间为序  daily_20100706 返回数据 row 行数 = "+str(daily_20100706.shape[0]))
daily_20100706_addname_dataframe.to_excel(daily_201007_excel_writer,'6_2',index=False)
daily_201007_excel_writer.save()
daily_20100707 = pro.daily(start_date='',end_date='',trade_date='20100707', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20100707_tscode_list = list() 
for ts_code_sh in daily_20100707['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20100707_tscode_list.append(stock_name)
daily_20100707_addname_dataframe=pd.DataFrame()
daily_20100707_addname_dataframe['cname'] = daily_20100707_tscode_list
for table_name in daily_20100707.columns.values.tolist():
    daily_20100707_addname_dataframe[table_name] = daily_20100707[table_name]
print("日线行情-时间为序  daily_20100707 返回数据 row 行数 = "+str(daily_20100707.shape[0]))
daily_20100707_addname_dataframe.to_excel(daily_201007_excel_writer,'7_3',index=False)
daily_201007_excel_writer.save()
daily_20100708 = pro.daily(start_date='',end_date='',trade_date='20100708', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20100708_tscode_list = list() 
for ts_code_sh in daily_20100708['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20100708_tscode_list.append(stock_name)
daily_20100708_addname_dataframe=pd.DataFrame()
daily_20100708_addname_dataframe['cname'] = daily_20100708_tscode_list
for table_name in daily_20100708.columns.values.tolist():
    daily_20100708_addname_dataframe[table_name] = daily_20100708[table_name]
print("日线行情-时间为序  daily_20100708 返回数据 row 行数 = "+str(daily_20100708.shape[0]))
daily_20100708_addname_dataframe.to_excel(daily_201007_excel_writer,'8_4',index=False)
daily_201007_excel_writer.save()
daily_20100709 = pro.daily(start_date='',end_date='',trade_date='20100709', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20100709_tscode_list = list() 
for ts_code_sh in daily_20100709['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20100709_tscode_list.append(stock_name)
daily_20100709_addname_dataframe=pd.DataFrame()
daily_20100709_addname_dataframe['cname'] = daily_20100709_tscode_list
for table_name in daily_20100709.columns.values.tolist():
    daily_20100709_addname_dataframe[table_name] = daily_20100709[table_name]
print("日线行情-时间为序  daily_20100709 返回数据 row 行数 = "+str(daily_20100709.shape[0]))
daily_20100709_addname_dataframe.to_excel(daily_201007_excel_writer,'9_5',index=False)
daily_201007_excel_writer.save()
daily_20100712 = pro.daily(start_date='',end_date='',trade_date='20100712', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20100712_tscode_list = list() 
for ts_code_sh in daily_20100712['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20100712_tscode_list.append(stock_name)
daily_20100712_addname_dataframe=pd.DataFrame()
daily_20100712_addname_dataframe['cname'] = daily_20100712_tscode_list
for table_name in daily_20100712.columns.values.tolist():
    daily_20100712_addname_dataframe[table_name] = daily_20100712[table_name]
print("日线行情-时间为序  daily_20100712 返回数据 row 行数 = "+str(daily_20100712.shape[0]))
daily_20100712_addname_dataframe.to_excel(daily_201007_excel_writer,'12_1',index=False)
daily_201007_excel_writer.save()
daily_20100713 = pro.daily(start_date='',end_date='',trade_date='20100713', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20100713_tscode_list = list() 
for ts_code_sh in daily_20100713['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20100713_tscode_list.append(stock_name)
daily_20100713_addname_dataframe=pd.DataFrame()
daily_20100713_addname_dataframe['cname'] = daily_20100713_tscode_list
for table_name in daily_20100713.columns.values.tolist():
    daily_20100713_addname_dataframe[table_name] = daily_20100713[table_name]
print("日线行情-时间为序  daily_20100713 返回数据 row 行数 = "+str(daily_20100713.shape[0]))
daily_20100713_addname_dataframe.to_excel(daily_201007_excel_writer,'13_2',index=False)
daily_201007_excel_writer.save()
daily_20100714 = pro.daily(start_date='',end_date='',trade_date='20100714', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20100714_tscode_list = list() 
for ts_code_sh in daily_20100714['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20100714_tscode_list.append(stock_name)
daily_20100714_addname_dataframe=pd.DataFrame()
daily_20100714_addname_dataframe['cname'] = daily_20100714_tscode_list
for table_name in daily_20100714.columns.values.tolist():
    daily_20100714_addname_dataframe[table_name] = daily_20100714[table_name]
print("日线行情-时间为序  daily_20100714 返回数据 row 行数 = "+str(daily_20100714.shape[0]))
daily_20100714_addname_dataframe.to_excel(daily_201007_excel_writer,'14_3',index=False)
daily_201007_excel_writer.save()
daily_20100715 = pro.daily(start_date='',end_date='',trade_date='20100715', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20100715_tscode_list = list() 
for ts_code_sh in daily_20100715['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20100715_tscode_list.append(stock_name)
daily_20100715_addname_dataframe=pd.DataFrame()
daily_20100715_addname_dataframe['cname'] = daily_20100715_tscode_list
for table_name in daily_20100715.columns.values.tolist():
    daily_20100715_addname_dataframe[table_name] = daily_20100715[table_name]
print("日线行情-时间为序  daily_20100715 返回数据 row 行数 = "+str(daily_20100715.shape[0]))
daily_20100715_addname_dataframe.to_excel(daily_201007_excel_writer,'15_4',index=False)
daily_201007_excel_writer.save()
daily_20100716 = pro.daily(start_date='',end_date='',trade_date='20100716', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20100716_tscode_list = list() 
for ts_code_sh in daily_20100716['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20100716_tscode_list.append(stock_name)
daily_20100716_addname_dataframe=pd.DataFrame()
daily_20100716_addname_dataframe['cname'] = daily_20100716_tscode_list
for table_name in daily_20100716.columns.values.tolist():
    daily_20100716_addname_dataframe[table_name] = daily_20100716[table_name]
print("日线行情-时间为序  daily_20100716 返回数据 row 行数 = "+str(daily_20100716.shape[0]))
daily_20100716_addname_dataframe.to_excel(daily_201007_excel_writer,'16_5',index=False)
daily_201007_excel_writer.save()
daily_20100719 = pro.daily(start_date='',end_date='',trade_date='20100719', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20100719_tscode_list = list() 
for ts_code_sh in daily_20100719['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20100719_tscode_list.append(stock_name)
daily_20100719_addname_dataframe=pd.DataFrame()
daily_20100719_addname_dataframe['cname'] = daily_20100719_tscode_list
for table_name in daily_20100719.columns.values.tolist():
    daily_20100719_addname_dataframe[table_name] = daily_20100719[table_name]
print("日线行情-时间为序  daily_20100719 返回数据 row 行数 = "+str(daily_20100719.shape[0]))
daily_20100719_addname_dataframe.to_excel(daily_201007_excel_writer,'19_1',index=False)
daily_201007_excel_writer.save()
daily_20100720 = pro.daily(start_date='',end_date='',trade_date='20100720', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20100720_tscode_list = list() 
for ts_code_sh in daily_20100720['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20100720_tscode_list.append(stock_name)
daily_20100720_addname_dataframe=pd.DataFrame()
daily_20100720_addname_dataframe['cname'] = daily_20100720_tscode_list
for table_name in daily_20100720.columns.values.tolist():
    daily_20100720_addname_dataframe[table_name] = daily_20100720[table_name]
print("日线行情-时间为序  daily_20100720 返回数据 row 行数 = "+str(daily_20100720.shape[0]))
daily_20100720_addname_dataframe.to_excel(daily_201007_excel_writer,'20_2',index=False)
daily_201007_excel_writer.save()
daily_20100721 = pro.daily(start_date='',end_date='',trade_date='20100721', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20100721_tscode_list = list() 
for ts_code_sh in daily_20100721['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20100721_tscode_list.append(stock_name)
daily_20100721_addname_dataframe=pd.DataFrame()
daily_20100721_addname_dataframe['cname'] = daily_20100721_tscode_list
for table_name in daily_20100721.columns.values.tolist():
    daily_20100721_addname_dataframe[table_name] = daily_20100721[table_name]
print("日线行情-时间为序  daily_20100721 返回数据 row 行数 = "+str(daily_20100721.shape[0]))
daily_20100721_addname_dataframe.to_excel(daily_201007_excel_writer,'21_3',index=False)
daily_201007_excel_writer.save()
daily_20100722 = pro.daily(start_date='',end_date='',trade_date='20100722', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20100722_tscode_list = list() 
for ts_code_sh in daily_20100722['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20100722_tscode_list.append(stock_name)
daily_20100722_addname_dataframe=pd.DataFrame()
daily_20100722_addname_dataframe['cname'] = daily_20100722_tscode_list
for table_name in daily_20100722.columns.values.tolist():
    daily_20100722_addname_dataframe[table_name] = daily_20100722[table_name]
print("日线行情-时间为序  daily_20100722 返回数据 row 行数 = "+str(daily_20100722.shape[0]))
daily_20100722_addname_dataframe.to_excel(daily_201007_excel_writer,'22_4',index=False)
daily_201007_excel_writer.save()
daily_20100723 = pro.daily(start_date='',end_date='',trade_date='20100723', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20100723_tscode_list = list() 
for ts_code_sh in daily_20100723['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20100723_tscode_list.append(stock_name)
daily_20100723_addname_dataframe=pd.DataFrame()
daily_20100723_addname_dataframe['cname'] = daily_20100723_tscode_list
for table_name in daily_20100723.columns.values.tolist():
    daily_20100723_addname_dataframe[table_name] = daily_20100723[table_name]
print("日线行情-时间为序  daily_20100723 返回数据 row 行数 = "+str(daily_20100723.shape[0]))
daily_20100723_addname_dataframe.to_excel(daily_201007_excel_writer,'23_5',index=False)
daily_201007_excel_writer.save()
daily_20100726 = pro.daily(start_date='',end_date='',trade_date='20100726', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20100726_tscode_list = list() 
for ts_code_sh in daily_20100726['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20100726_tscode_list.append(stock_name)
daily_20100726_addname_dataframe=pd.DataFrame()
daily_20100726_addname_dataframe['cname'] = daily_20100726_tscode_list
for table_name in daily_20100726.columns.values.tolist():
    daily_20100726_addname_dataframe[table_name] = daily_20100726[table_name]
print("日线行情-时间为序  daily_20100726 返回数据 row 行数 = "+str(daily_20100726.shape[0]))
daily_20100726_addname_dataframe.to_excel(daily_201007_excel_writer,'26_1',index=False)
daily_201007_excel_writer.save()
daily_20100727 = pro.daily(start_date='',end_date='',trade_date='20100727', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20100727_tscode_list = list() 
for ts_code_sh in daily_20100727['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20100727_tscode_list.append(stock_name)
daily_20100727_addname_dataframe=pd.DataFrame()
daily_20100727_addname_dataframe['cname'] = daily_20100727_tscode_list
for table_name in daily_20100727.columns.values.tolist():
    daily_20100727_addname_dataframe[table_name] = daily_20100727[table_name]
print("日线行情-时间为序  daily_20100727 返回数据 row 行数 = "+str(daily_20100727.shape[0]))
daily_20100727_addname_dataframe.to_excel(daily_201007_excel_writer,'27_2',index=False)
daily_201007_excel_writer.save()
daily_20100728 = pro.daily(start_date='',end_date='',trade_date='20100728', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20100728_tscode_list = list() 
for ts_code_sh in daily_20100728['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20100728_tscode_list.append(stock_name)
daily_20100728_addname_dataframe=pd.DataFrame()
daily_20100728_addname_dataframe['cname'] = daily_20100728_tscode_list
for table_name in daily_20100728.columns.values.tolist():
    daily_20100728_addname_dataframe[table_name] = daily_20100728[table_name]
print("日线行情-时间为序  daily_20100728 返回数据 row 行数 = "+str(daily_20100728.shape[0]))
daily_20100728_addname_dataframe.to_excel(daily_201007_excel_writer,'28_3',index=False)
daily_201007_excel_writer.save()
daily_20100729 = pro.daily(start_date='',end_date='',trade_date='20100729', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20100729_tscode_list = list() 
for ts_code_sh in daily_20100729['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20100729_tscode_list.append(stock_name)
daily_20100729_addname_dataframe=pd.DataFrame()
daily_20100729_addname_dataframe['cname'] = daily_20100729_tscode_list
for table_name in daily_20100729.columns.values.tolist():
    daily_20100729_addname_dataframe[table_name] = daily_20100729[table_name]
print("日线行情-时间为序  daily_20100729 返回数据 row 行数 = "+str(daily_20100729.shape[0]))
daily_20100729_addname_dataframe.to_excel(daily_201007_excel_writer,'29_4',index=False)
daily_201007_excel_writer.save()
daily_20100730 = pro.daily(start_date='',end_date='',trade_date='20100730', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20100730_tscode_list = list() 
for ts_code_sh in daily_20100730['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20100730_tscode_list.append(stock_name)
daily_20100730_addname_dataframe=pd.DataFrame()
daily_20100730_addname_dataframe['cname'] = daily_20100730_tscode_list
for table_name in daily_20100730.columns.values.tolist():
    daily_20100730_addname_dataframe[table_name] = daily_20100730[table_name]
print("日线行情-时间为序  daily_20100730 返回数据 row 行数 = "+str(daily_20100730.shape[0]))
daily_20100730_addname_dataframe.to_excel(daily_201007_excel_writer,'30_5',index=False)
daily_201007_excel_writer.save()




createexcel('daily_201008.xlsx')
daily_201008_book = load_workbook('C:\\Users\\zhuzj5\\Desktop\\zbin\\J0_Data\\daily_201008.xlsx')
daily_201008_excel_writer = pd.ExcelWriter('C:\\Users\\zhuzj5\\Desktop\\zbin\\J0_Data\\daily_201008.xlsx', engine='openpyxl')
daily_201008_excel_writer.book = daily_201008_book
daily_201008_excel_writer.sheets = dict((ws.title, ws) for ws in daily_201008_book.worksheets)
J0_PROPS.put(tree_node_name+"record_date", "20100801")       ###  更新 记录日期
daily_20100802 = pro.daily(start_date='',end_date='',trade_date='20100802', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20100802_tscode_list = list() 
for ts_code_sh in daily_20100802['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20100802_tscode_list.append(stock_name)
daily_20100802_addname_dataframe=pd.DataFrame()
daily_20100802_addname_dataframe['cname'] = daily_20100802_tscode_list
for table_name in daily_20100802.columns.values.tolist():
    daily_20100802_addname_dataframe[table_name] = daily_20100802[table_name]
print("日线行情-时间为序  daily_20100802 返回数据 row 行数 = "+str(daily_20100802.shape[0]))
daily_20100802_addname_dataframe.to_excel(daily_201008_excel_writer,'2_1',index=False)
daily_201008_excel_writer.save()
daily_20100803 = pro.daily(start_date='',end_date='',trade_date='20100803', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20100803_tscode_list = list() 
for ts_code_sh in daily_20100803['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20100803_tscode_list.append(stock_name)
daily_20100803_addname_dataframe=pd.DataFrame()
daily_20100803_addname_dataframe['cname'] = daily_20100803_tscode_list
for table_name in daily_20100803.columns.values.tolist():
    daily_20100803_addname_dataframe[table_name] = daily_20100803[table_name]
print("日线行情-时间为序  daily_20100803 返回数据 row 行数 = "+str(daily_20100803.shape[0]))
daily_20100803_addname_dataframe.to_excel(daily_201008_excel_writer,'3_2',index=False)
daily_201008_excel_writer.save()
daily_20100804 = pro.daily(start_date='',end_date='',trade_date='20100804', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20100804_tscode_list = list() 
for ts_code_sh in daily_20100804['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20100804_tscode_list.append(stock_name)
daily_20100804_addname_dataframe=pd.DataFrame()
daily_20100804_addname_dataframe['cname'] = daily_20100804_tscode_list
for table_name in daily_20100804.columns.values.tolist():
    daily_20100804_addname_dataframe[table_name] = daily_20100804[table_name]
print("日线行情-时间为序  daily_20100804 返回数据 row 行数 = "+str(daily_20100804.shape[0]))
daily_20100804_addname_dataframe.to_excel(daily_201008_excel_writer,'4_3',index=False)
daily_201008_excel_writer.save()
daily_20100805 = pro.daily(start_date='',end_date='',trade_date='20100805', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20100805_tscode_list = list() 
for ts_code_sh in daily_20100805['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20100805_tscode_list.append(stock_name)
daily_20100805_addname_dataframe=pd.DataFrame()
daily_20100805_addname_dataframe['cname'] = daily_20100805_tscode_list
for table_name in daily_20100805.columns.values.tolist():
    daily_20100805_addname_dataframe[table_name] = daily_20100805[table_name]
print("日线行情-时间为序  daily_20100805 返回数据 row 行数 = "+str(daily_20100805.shape[0]))
daily_20100805_addname_dataframe.to_excel(daily_201008_excel_writer,'5_4',index=False)
daily_201008_excel_writer.save()
daily_20100806 = pro.daily(start_date='',end_date='',trade_date='20100806', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20100806_tscode_list = list() 
for ts_code_sh in daily_20100806['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20100806_tscode_list.append(stock_name)
daily_20100806_addname_dataframe=pd.DataFrame()
daily_20100806_addname_dataframe['cname'] = daily_20100806_tscode_list
for table_name in daily_20100806.columns.values.tolist():
    daily_20100806_addname_dataframe[table_name] = daily_20100806[table_name]
print("日线行情-时间为序  daily_20100806 返回数据 row 行数 = "+str(daily_20100806.shape[0]))
daily_20100806_addname_dataframe.to_excel(daily_201008_excel_writer,'6_5',index=False)
daily_201008_excel_writer.save()
daily_20100809 = pro.daily(start_date='',end_date='',trade_date='20100809', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20100809_tscode_list = list() 
for ts_code_sh in daily_20100809['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20100809_tscode_list.append(stock_name)
daily_20100809_addname_dataframe=pd.DataFrame()
daily_20100809_addname_dataframe['cname'] = daily_20100809_tscode_list
for table_name in daily_20100809.columns.values.tolist():
    daily_20100809_addname_dataframe[table_name] = daily_20100809[table_name]
print("日线行情-时间为序  daily_20100809 返回数据 row 行数 = "+str(daily_20100809.shape[0]))
daily_20100809_addname_dataframe.to_excel(daily_201008_excel_writer,'9_1',index=False)
daily_201008_excel_writer.save()
daily_20100810 = pro.daily(start_date='',end_date='',trade_date='20100810', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20100810_tscode_list = list() 
for ts_code_sh in daily_20100810['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20100810_tscode_list.append(stock_name)
daily_20100810_addname_dataframe=pd.DataFrame()
daily_20100810_addname_dataframe['cname'] = daily_20100810_tscode_list
for table_name in daily_20100810.columns.values.tolist():
    daily_20100810_addname_dataframe[table_name] = daily_20100810[table_name]
print("日线行情-时间为序  daily_20100810 返回数据 row 行数 = "+str(daily_20100810.shape[0]))
daily_20100810_addname_dataframe.to_excel(daily_201008_excel_writer,'10_2',index=False)
daily_201008_excel_writer.save()
daily_20100811 = pro.daily(start_date='',end_date='',trade_date='20100811', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20100811_tscode_list = list() 
for ts_code_sh in daily_20100811['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20100811_tscode_list.append(stock_name)
daily_20100811_addname_dataframe=pd.DataFrame()
daily_20100811_addname_dataframe['cname'] = daily_20100811_tscode_list
for table_name in daily_20100811.columns.values.tolist():
    daily_20100811_addname_dataframe[table_name] = daily_20100811[table_name]
print("日线行情-时间为序  daily_20100811 返回数据 row 行数 = "+str(daily_20100811.shape[0]))
daily_20100811_addname_dataframe.to_excel(daily_201008_excel_writer,'11_3',index=False)
daily_201008_excel_writer.save()
daily_20100812 = pro.daily(start_date='',end_date='',trade_date='20100812', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20100812_tscode_list = list() 
for ts_code_sh in daily_20100812['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20100812_tscode_list.append(stock_name)
daily_20100812_addname_dataframe=pd.DataFrame()
daily_20100812_addname_dataframe['cname'] = daily_20100812_tscode_list
for table_name in daily_20100812.columns.values.tolist():
    daily_20100812_addname_dataframe[table_name] = daily_20100812[table_name]
print("日线行情-时间为序  daily_20100812 返回数据 row 行数 = "+str(daily_20100812.shape[0]))
daily_20100812_addname_dataframe.to_excel(daily_201008_excel_writer,'12_4',index=False)
daily_201008_excel_writer.save()
daily_20100813 = pro.daily(start_date='',end_date='',trade_date='20100813', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20100813_tscode_list = list() 
for ts_code_sh in daily_20100813['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20100813_tscode_list.append(stock_name)
daily_20100813_addname_dataframe=pd.DataFrame()
daily_20100813_addname_dataframe['cname'] = daily_20100813_tscode_list
for table_name in daily_20100813.columns.values.tolist():
    daily_20100813_addname_dataframe[table_name] = daily_20100813[table_name]
print("日线行情-时间为序  daily_20100813 返回数据 row 行数 = "+str(daily_20100813.shape[0]))
daily_20100813_addname_dataframe.to_excel(daily_201008_excel_writer,'13_5',index=False)
daily_201008_excel_writer.save()
daily_20100816 = pro.daily(start_date='',end_date='',trade_date='20100816', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20100816_tscode_list = list() 
for ts_code_sh in daily_20100816['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20100816_tscode_list.append(stock_name)
daily_20100816_addname_dataframe=pd.DataFrame()
daily_20100816_addname_dataframe['cname'] = daily_20100816_tscode_list
for table_name in daily_20100816.columns.values.tolist():
    daily_20100816_addname_dataframe[table_name] = daily_20100816[table_name]
print("日线行情-时间为序  daily_20100816 返回数据 row 行数 = "+str(daily_20100816.shape[0]))
daily_20100816_addname_dataframe.to_excel(daily_201008_excel_writer,'16_1',index=False)
daily_201008_excel_writer.save()
daily_20100817 = pro.daily(start_date='',end_date='',trade_date='20100817', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20100817_tscode_list = list() 
for ts_code_sh in daily_20100817['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20100817_tscode_list.append(stock_name)
daily_20100817_addname_dataframe=pd.DataFrame()
daily_20100817_addname_dataframe['cname'] = daily_20100817_tscode_list
for table_name in daily_20100817.columns.values.tolist():
    daily_20100817_addname_dataframe[table_name] = daily_20100817[table_name]
print("日线行情-时间为序  daily_20100817 返回数据 row 行数 = "+str(daily_20100817.shape[0]))
daily_20100817_addname_dataframe.to_excel(daily_201008_excel_writer,'17_2',index=False)
daily_201008_excel_writer.save()
daily_20100818 = pro.daily(start_date='',end_date='',trade_date='20100818', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20100818_tscode_list = list() 
for ts_code_sh in daily_20100818['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20100818_tscode_list.append(stock_name)
daily_20100818_addname_dataframe=pd.DataFrame()
daily_20100818_addname_dataframe['cname'] = daily_20100818_tscode_list
for table_name in daily_20100818.columns.values.tolist():
    daily_20100818_addname_dataframe[table_name] = daily_20100818[table_name]
print("日线行情-时间为序  daily_20100818 返回数据 row 行数 = "+str(daily_20100818.shape[0]))
daily_20100818_addname_dataframe.to_excel(daily_201008_excel_writer,'18_3',index=False)
daily_201008_excel_writer.save()
daily_20100819 = pro.daily(start_date='',end_date='',trade_date='20100819', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20100819_tscode_list = list() 
for ts_code_sh in daily_20100819['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20100819_tscode_list.append(stock_name)
daily_20100819_addname_dataframe=pd.DataFrame()
daily_20100819_addname_dataframe['cname'] = daily_20100819_tscode_list
for table_name in daily_20100819.columns.values.tolist():
    daily_20100819_addname_dataframe[table_name] = daily_20100819[table_name]
print("日线行情-时间为序  daily_20100819 返回数据 row 行数 = "+str(daily_20100819.shape[0]))
daily_20100819_addname_dataframe.to_excel(daily_201008_excel_writer,'19_4',index=False)
daily_201008_excel_writer.save()
daily_20100820 = pro.daily(start_date='',end_date='',trade_date='20100820', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20100820_tscode_list = list() 
for ts_code_sh in daily_20100820['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20100820_tscode_list.append(stock_name)
daily_20100820_addname_dataframe=pd.DataFrame()
daily_20100820_addname_dataframe['cname'] = daily_20100820_tscode_list
for table_name in daily_20100820.columns.values.tolist():
    daily_20100820_addname_dataframe[table_name] = daily_20100820[table_name]
print("日线行情-时间为序  daily_20100820 返回数据 row 行数 = "+str(daily_20100820.shape[0]))
daily_20100820_addname_dataframe.to_excel(daily_201008_excel_writer,'20_5',index=False)
daily_201008_excel_writer.save()
daily_20100823 = pro.daily(start_date='',end_date='',trade_date='20100823', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20100823_tscode_list = list() 
for ts_code_sh in daily_20100823['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20100823_tscode_list.append(stock_name)
daily_20100823_addname_dataframe=pd.DataFrame()
daily_20100823_addname_dataframe['cname'] = daily_20100823_tscode_list
for table_name in daily_20100823.columns.values.tolist():
    daily_20100823_addname_dataframe[table_name] = daily_20100823[table_name]
print("日线行情-时间为序  daily_20100823 返回数据 row 行数 = "+str(daily_20100823.shape[0]))
daily_20100823_addname_dataframe.to_excel(daily_201008_excel_writer,'23_1',index=False)
daily_201008_excel_writer.save()
daily_20100824 = pro.daily(start_date='',end_date='',trade_date='20100824', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20100824_tscode_list = list() 
for ts_code_sh in daily_20100824['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20100824_tscode_list.append(stock_name)
daily_20100824_addname_dataframe=pd.DataFrame()
daily_20100824_addname_dataframe['cname'] = daily_20100824_tscode_list
for table_name in daily_20100824.columns.values.tolist():
    daily_20100824_addname_dataframe[table_name] = daily_20100824[table_name]
print("日线行情-时间为序  daily_20100824 返回数据 row 行数 = "+str(daily_20100824.shape[0]))
daily_20100824_addname_dataframe.to_excel(daily_201008_excel_writer,'24_2',index=False)
daily_201008_excel_writer.save()
daily_20100825 = pro.daily(start_date='',end_date='',trade_date='20100825', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20100825_tscode_list = list() 
for ts_code_sh in daily_20100825['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20100825_tscode_list.append(stock_name)
daily_20100825_addname_dataframe=pd.DataFrame()
daily_20100825_addname_dataframe['cname'] = daily_20100825_tscode_list
for table_name in daily_20100825.columns.values.tolist():
    daily_20100825_addname_dataframe[table_name] = daily_20100825[table_name]
print("日线行情-时间为序  daily_20100825 返回数据 row 行数 = "+str(daily_20100825.shape[0]))
daily_20100825_addname_dataframe.to_excel(daily_201008_excel_writer,'25_3',index=False)
daily_201008_excel_writer.save()
daily_20100826 = pro.daily(start_date='',end_date='',trade_date='20100826', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20100826_tscode_list = list() 
for ts_code_sh in daily_20100826['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20100826_tscode_list.append(stock_name)
daily_20100826_addname_dataframe=pd.DataFrame()
daily_20100826_addname_dataframe['cname'] = daily_20100826_tscode_list
for table_name in daily_20100826.columns.values.tolist():
    daily_20100826_addname_dataframe[table_name] = daily_20100826[table_name]
print("日线行情-时间为序  daily_20100826 返回数据 row 行数 = "+str(daily_20100826.shape[0]))
daily_20100826_addname_dataframe.to_excel(daily_201008_excel_writer,'26_4',index=False)
daily_201008_excel_writer.save()
daily_20100827 = pro.daily(start_date='',end_date='',trade_date='20100827', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20100827_tscode_list = list() 
for ts_code_sh in daily_20100827['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20100827_tscode_list.append(stock_name)
daily_20100827_addname_dataframe=pd.DataFrame()
daily_20100827_addname_dataframe['cname'] = daily_20100827_tscode_list
for table_name in daily_20100827.columns.values.tolist():
    daily_20100827_addname_dataframe[table_name] = daily_20100827[table_name]
print("日线行情-时间为序  daily_20100827 返回数据 row 行数 = "+str(daily_20100827.shape[0]))
daily_20100827_addname_dataframe.to_excel(daily_201008_excel_writer,'27_5',index=False)
daily_201008_excel_writer.save()
daily_20100830 = pro.daily(start_date='',end_date='',trade_date='20100830', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20100830_tscode_list = list() 
for ts_code_sh in daily_20100830['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20100830_tscode_list.append(stock_name)
daily_20100830_addname_dataframe=pd.DataFrame()
daily_20100830_addname_dataframe['cname'] = daily_20100830_tscode_list
for table_name in daily_20100830.columns.values.tolist():
    daily_20100830_addname_dataframe[table_name] = daily_20100830[table_name]
print("日线行情-时间为序  daily_20100830 返回数据 row 行数 = "+str(daily_20100830.shape[0]))
daily_20100830_addname_dataframe.to_excel(daily_201008_excel_writer,'30_1',index=False)
daily_201008_excel_writer.save()
daily_20100831 = pro.daily(start_date='',end_date='',trade_date='20100831', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20100831_tscode_list = list() 
for ts_code_sh in daily_20100831['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20100831_tscode_list.append(stock_name)
daily_20100831_addname_dataframe=pd.DataFrame()
daily_20100831_addname_dataframe['cname'] = daily_20100831_tscode_list
for table_name in daily_20100831.columns.values.tolist():
    daily_20100831_addname_dataframe[table_name] = daily_20100831[table_name]
print("日线行情-时间为序  daily_20100831 返回数据 row 行数 = "+str(daily_20100831.shape[0]))
daily_20100831_addname_dataframe.to_excel(daily_201008_excel_writer,'31_2',index=False)
daily_201008_excel_writer.save()




createexcel('daily_201009.xlsx')
daily_201009_book = load_workbook('C:\\Users\\zhuzj5\\Desktop\\zbin\\J0_Data\\daily_201009.xlsx')
daily_201009_excel_writer = pd.ExcelWriter('C:\\Users\\zhuzj5\\Desktop\\zbin\\J0_Data\\daily_201009.xlsx', engine='openpyxl')
daily_201009_excel_writer.book = daily_201009_book
daily_201009_excel_writer.sheets = dict((ws.title, ws) for ws in daily_201009_book.worksheets)
J0_PROPS.put(tree_node_name+"record_date", "20100901")       ###  更新 记录日期
daily_20100901 = pro.daily(start_date='',end_date='',trade_date='20100901', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20100901_tscode_list = list() 
for ts_code_sh in daily_20100901['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20100901_tscode_list.append(stock_name)
daily_20100901_addname_dataframe=pd.DataFrame()
daily_20100901_addname_dataframe['cname'] = daily_20100901_tscode_list
for table_name in daily_20100901.columns.values.tolist():
    daily_20100901_addname_dataframe[table_name] = daily_20100901[table_name]
print("日线行情-时间为序  daily_20100901 返回数据 row 行数 = "+str(daily_20100901.shape[0]))
daily_20100901_addname_dataframe.to_excel(daily_201009_excel_writer,'1_3',index=False)
daily_201009_excel_writer.save()
daily_20100902 = pro.daily(start_date='',end_date='',trade_date='20100902', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20100902_tscode_list = list() 
for ts_code_sh in daily_20100902['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20100902_tscode_list.append(stock_name)
daily_20100902_addname_dataframe=pd.DataFrame()
daily_20100902_addname_dataframe['cname'] = daily_20100902_tscode_list
for table_name in daily_20100902.columns.values.tolist():
    daily_20100902_addname_dataframe[table_name] = daily_20100902[table_name]
print("日线行情-时间为序  daily_20100902 返回数据 row 行数 = "+str(daily_20100902.shape[0]))
daily_20100902_addname_dataframe.to_excel(daily_201009_excel_writer,'2_4',index=False)
daily_201009_excel_writer.save()
daily_20100903 = pro.daily(start_date='',end_date='',trade_date='20100903', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20100903_tscode_list = list() 
for ts_code_sh in daily_20100903['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20100903_tscode_list.append(stock_name)
daily_20100903_addname_dataframe=pd.DataFrame()
daily_20100903_addname_dataframe['cname'] = daily_20100903_tscode_list
for table_name in daily_20100903.columns.values.tolist():
    daily_20100903_addname_dataframe[table_name] = daily_20100903[table_name]
print("日线行情-时间为序  daily_20100903 返回数据 row 行数 = "+str(daily_20100903.shape[0]))
daily_20100903_addname_dataframe.to_excel(daily_201009_excel_writer,'3_5',index=False)
daily_201009_excel_writer.save()
daily_20100906 = pro.daily(start_date='',end_date='',trade_date='20100906', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20100906_tscode_list = list() 
for ts_code_sh in daily_20100906['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20100906_tscode_list.append(stock_name)
daily_20100906_addname_dataframe=pd.DataFrame()
daily_20100906_addname_dataframe['cname'] = daily_20100906_tscode_list
for table_name in daily_20100906.columns.values.tolist():
    daily_20100906_addname_dataframe[table_name] = daily_20100906[table_name]
print("日线行情-时间为序  daily_20100906 返回数据 row 行数 = "+str(daily_20100906.shape[0]))
daily_20100906_addname_dataframe.to_excel(daily_201009_excel_writer,'6_1',index=False)
daily_201009_excel_writer.save()
daily_20100907 = pro.daily(start_date='',end_date='',trade_date='20100907', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20100907_tscode_list = list() 
for ts_code_sh in daily_20100907['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20100907_tscode_list.append(stock_name)
daily_20100907_addname_dataframe=pd.DataFrame()
daily_20100907_addname_dataframe['cname'] = daily_20100907_tscode_list
for table_name in daily_20100907.columns.values.tolist():
    daily_20100907_addname_dataframe[table_name] = daily_20100907[table_name]
print("日线行情-时间为序  daily_20100907 返回数据 row 行数 = "+str(daily_20100907.shape[0]))
daily_20100907_addname_dataframe.to_excel(daily_201009_excel_writer,'7_2',index=False)
daily_201009_excel_writer.save()
daily_20100908 = pro.daily(start_date='',end_date='',trade_date='20100908', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20100908_tscode_list = list() 
for ts_code_sh in daily_20100908['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20100908_tscode_list.append(stock_name)
daily_20100908_addname_dataframe=pd.DataFrame()
daily_20100908_addname_dataframe['cname'] = daily_20100908_tscode_list
for table_name in daily_20100908.columns.values.tolist():
    daily_20100908_addname_dataframe[table_name] = daily_20100908[table_name]
print("日线行情-时间为序  daily_20100908 返回数据 row 行数 = "+str(daily_20100908.shape[0]))
daily_20100908_addname_dataframe.to_excel(daily_201009_excel_writer,'8_3',index=False)
daily_201009_excel_writer.save()
daily_20100909 = pro.daily(start_date='',end_date='',trade_date='20100909', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20100909_tscode_list = list() 
for ts_code_sh in daily_20100909['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20100909_tscode_list.append(stock_name)
daily_20100909_addname_dataframe=pd.DataFrame()
daily_20100909_addname_dataframe['cname'] = daily_20100909_tscode_list
for table_name in daily_20100909.columns.values.tolist():
    daily_20100909_addname_dataframe[table_name] = daily_20100909[table_name]
print("日线行情-时间为序  daily_20100909 返回数据 row 行数 = "+str(daily_20100909.shape[0]))
daily_20100909_addname_dataframe.to_excel(daily_201009_excel_writer,'9_4',index=False)
daily_201009_excel_writer.save()
daily_20100910 = pro.daily(start_date='',end_date='',trade_date='20100910', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20100910_tscode_list = list() 
for ts_code_sh in daily_20100910['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20100910_tscode_list.append(stock_name)
daily_20100910_addname_dataframe=pd.DataFrame()
daily_20100910_addname_dataframe['cname'] = daily_20100910_tscode_list
for table_name in daily_20100910.columns.values.tolist():
    daily_20100910_addname_dataframe[table_name] = daily_20100910[table_name]
print("日线行情-时间为序  daily_20100910 返回数据 row 行数 = "+str(daily_20100910.shape[0]))
daily_20100910_addname_dataframe.to_excel(daily_201009_excel_writer,'10_5',index=False)
daily_201009_excel_writer.save()
daily_20100913 = pro.daily(start_date='',end_date='',trade_date='20100913', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20100913_tscode_list = list() 
for ts_code_sh in daily_20100913['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20100913_tscode_list.append(stock_name)
daily_20100913_addname_dataframe=pd.DataFrame()
daily_20100913_addname_dataframe['cname'] = daily_20100913_tscode_list
for table_name in daily_20100913.columns.values.tolist():
    daily_20100913_addname_dataframe[table_name] = daily_20100913[table_name]
print("日线行情-时间为序  daily_20100913 返回数据 row 行数 = "+str(daily_20100913.shape[0]))
daily_20100913_addname_dataframe.to_excel(daily_201009_excel_writer,'13_1',index=False)
daily_201009_excel_writer.save()
daily_20100914 = pro.daily(start_date='',end_date='',trade_date='20100914', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20100914_tscode_list = list() 
for ts_code_sh in daily_20100914['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20100914_tscode_list.append(stock_name)
daily_20100914_addname_dataframe=pd.DataFrame()
daily_20100914_addname_dataframe['cname'] = daily_20100914_tscode_list
for table_name in daily_20100914.columns.values.tolist():
    daily_20100914_addname_dataframe[table_name] = daily_20100914[table_name]
print("日线行情-时间为序  daily_20100914 返回数据 row 行数 = "+str(daily_20100914.shape[0]))
daily_20100914_addname_dataframe.to_excel(daily_201009_excel_writer,'14_2',index=False)
daily_201009_excel_writer.save()
daily_20100915 = pro.daily(start_date='',end_date='',trade_date='20100915', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20100915_tscode_list = list() 
for ts_code_sh in daily_20100915['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20100915_tscode_list.append(stock_name)
daily_20100915_addname_dataframe=pd.DataFrame()
daily_20100915_addname_dataframe['cname'] = daily_20100915_tscode_list
for table_name in daily_20100915.columns.values.tolist():
    daily_20100915_addname_dataframe[table_name] = daily_20100915[table_name]
print("日线行情-时间为序  daily_20100915 返回数据 row 行数 = "+str(daily_20100915.shape[0]))
daily_20100915_addname_dataframe.to_excel(daily_201009_excel_writer,'15_3',index=False)
daily_201009_excel_writer.save()
daily_20100916 = pro.daily(start_date='',end_date='',trade_date='20100916', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20100916_tscode_list = list() 
for ts_code_sh in daily_20100916['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20100916_tscode_list.append(stock_name)
daily_20100916_addname_dataframe=pd.DataFrame()
daily_20100916_addname_dataframe['cname'] = daily_20100916_tscode_list
for table_name in daily_20100916.columns.values.tolist():
    daily_20100916_addname_dataframe[table_name] = daily_20100916[table_name]
print("日线行情-时间为序  daily_20100916 返回数据 row 行数 = "+str(daily_20100916.shape[0]))
daily_20100916_addname_dataframe.to_excel(daily_201009_excel_writer,'16_4',index=False)
daily_201009_excel_writer.save()
daily_20100917 = pro.daily(start_date='',end_date='',trade_date='20100917', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20100917_tscode_list = list() 
for ts_code_sh in daily_20100917['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20100917_tscode_list.append(stock_name)
daily_20100917_addname_dataframe=pd.DataFrame()
daily_20100917_addname_dataframe['cname'] = daily_20100917_tscode_list
for table_name in daily_20100917.columns.values.tolist():
    daily_20100917_addname_dataframe[table_name] = daily_20100917[table_name]
print("日线行情-时间为序  daily_20100917 返回数据 row 行数 = "+str(daily_20100917.shape[0]))
daily_20100917_addname_dataframe.to_excel(daily_201009_excel_writer,'17_5',index=False)
daily_201009_excel_writer.save()
daily_20100920 = pro.daily(start_date='',end_date='',trade_date='20100920', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20100920_tscode_list = list() 
for ts_code_sh in daily_20100920['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20100920_tscode_list.append(stock_name)
daily_20100920_addname_dataframe=pd.DataFrame()
daily_20100920_addname_dataframe['cname'] = daily_20100920_tscode_list
for table_name in daily_20100920.columns.values.tolist():
    daily_20100920_addname_dataframe[table_name] = daily_20100920[table_name]
print("日线行情-时间为序  daily_20100920 返回数据 row 行数 = "+str(daily_20100920.shape[0]))
daily_20100920_addname_dataframe.to_excel(daily_201009_excel_writer,'20_1',index=False)
daily_201009_excel_writer.save()
daily_20100921 = pro.daily(start_date='',end_date='',trade_date='20100921', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20100921_tscode_list = list() 
for ts_code_sh in daily_20100921['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20100921_tscode_list.append(stock_name)
daily_20100921_addname_dataframe=pd.DataFrame()
daily_20100921_addname_dataframe['cname'] = daily_20100921_tscode_list
for table_name in daily_20100921.columns.values.tolist():
    daily_20100921_addname_dataframe[table_name] = daily_20100921[table_name]
print("日线行情-时间为序  daily_20100921 返回数据 row 行数 = "+str(daily_20100921.shape[0]))
daily_20100921_addname_dataframe.to_excel(daily_201009_excel_writer,'21_2',index=False)
daily_201009_excel_writer.save()
daily_20100927 = pro.daily(start_date='',end_date='',trade_date='20100927', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20100927_tscode_list = list() 
for ts_code_sh in daily_20100927['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20100927_tscode_list.append(stock_name)
daily_20100927_addname_dataframe=pd.DataFrame()
daily_20100927_addname_dataframe['cname'] = daily_20100927_tscode_list
for table_name in daily_20100927.columns.values.tolist():
    daily_20100927_addname_dataframe[table_name] = daily_20100927[table_name]
print("日线行情-时间为序  daily_20100927 返回数据 row 行数 = "+str(daily_20100927.shape[0]))
daily_20100927_addname_dataframe.to_excel(daily_201009_excel_writer,'27_1',index=False)
daily_201009_excel_writer.save()
daily_20100928 = pro.daily(start_date='',end_date='',trade_date='20100928', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20100928_tscode_list = list() 
for ts_code_sh in daily_20100928['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20100928_tscode_list.append(stock_name)
daily_20100928_addname_dataframe=pd.DataFrame()
daily_20100928_addname_dataframe['cname'] = daily_20100928_tscode_list
for table_name in daily_20100928.columns.values.tolist():
    daily_20100928_addname_dataframe[table_name] = daily_20100928[table_name]
print("日线行情-时间为序  daily_20100928 返回数据 row 行数 = "+str(daily_20100928.shape[0]))
daily_20100928_addname_dataframe.to_excel(daily_201009_excel_writer,'28_2',index=False)
daily_201009_excel_writer.save()
daily_20100929 = pro.daily(start_date='',end_date='',trade_date='20100929', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20100929_tscode_list = list() 
for ts_code_sh in daily_20100929['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20100929_tscode_list.append(stock_name)
daily_20100929_addname_dataframe=pd.DataFrame()
daily_20100929_addname_dataframe['cname'] = daily_20100929_tscode_list
for table_name in daily_20100929.columns.values.tolist():
    daily_20100929_addname_dataframe[table_name] = daily_20100929[table_name]
print("日线行情-时间为序  daily_20100929 返回数据 row 行数 = "+str(daily_20100929.shape[0]))
daily_20100929_addname_dataframe.to_excel(daily_201009_excel_writer,'29_3',index=False)
daily_201009_excel_writer.save()
daily_20100930 = pro.daily(start_date='',end_date='',trade_date='20100930', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20100930_tscode_list = list() 
for ts_code_sh in daily_20100930['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20100930_tscode_list.append(stock_name)
daily_20100930_addname_dataframe=pd.DataFrame()
daily_20100930_addname_dataframe['cname'] = daily_20100930_tscode_list
for table_name in daily_20100930.columns.values.tolist():
    daily_20100930_addname_dataframe[table_name] = daily_20100930[table_name]
print("日线行情-时间为序  daily_20100930 返回数据 row 行数 = "+str(daily_20100930.shape[0]))
daily_20100930_addname_dataframe.to_excel(daily_201009_excel_writer,'30_4',index=False)
daily_201009_excel_writer.save()




createexcel('daily_201010.xlsx')
daily_201010_book = load_workbook('C:\\Users\\zhuzj5\\Desktop\\zbin\\J0_Data\\daily_201010.xlsx')
daily_201010_excel_writer = pd.ExcelWriter('C:\\Users\\zhuzj5\\Desktop\\zbin\\J0_Data\\daily_201010.xlsx', engine='openpyxl')
daily_201010_excel_writer.book = daily_201010_book
daily_201010_excel_writer.sheets = dict((ws.title, ws) for ws in daily_201010_book.worksheets)
J0_PROPS.put(tree_node_name+"record_date", "20101001")       ###  更新 记录日期
daily_20101008 = pro.daily(start_date='',end_date='',trade_date='20101008', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20101008_tscode_list = list() 
for ts_code_sh in daily_20101008['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20101008_tscode_list.append(stock_name)
daily_20101008_addname_dataframe=pd.DataFrame()
daily_20101008_addname_dataframe['cname'] = daily_20101008_tscode_list
for table_name in daily_20101008.columns.values.tolist():
    daily_20101008_addname_dataframe[table_name] = daily_20101008[table_name]
print("日线行情-时间为序  daily_20101008 返回数据 row 行数 = "+str(daily_20101008.shape[0]))
daily_20101008_addname_dataframe.to_excel(daily_201010_excel_writer,'8_5',index=False)
daily_201010_excel_writer.save()
daily_20101011 = pro.daily(start_date='',end_date='',trade_date='20101011', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20101011_tscode_list = list() 
for ts_code_sh in daily_20101011['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20101011_tscode_list.append(stock_name)
daily_20101011_addname_dataframe=pd.DataFrame()
daily_20101011_addname_dataframe['cname'] = daily_20101011_tscode_list
for table_name in daily_20101011.columns.values.tolist():
    daily_20101011_addname_dataframe[table_name] = daily_20101011[table_name]
print("日线行情-时间为序  daily_20101011 返回数据 row 行数 = "+str(daily_20101011.shape[0]))
daily_20101011_addname_dataframe.to_excel(daily_201010_excel_writer,'11_1',index=False)
daily_201010_excel_writer.save()
daily_20101012 = pro.daily(start_date='',end_date='',trade_date='20101012', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20101012_tscode_list = list() 
for ts_code_sh in daily_20101012['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20101012_tscode_list.append(stock_name)
daily_20101012_addname_dataframe=pd.DataFrame()
daily_20101012_addname_dataframe['cname'] = daily_20101012_tscode_list
for table_name in daily_20101012.columns.values.tolist():
    daily_20101012_addname_dataframe[table_name] = daily_20101012[table_name]
print("日线行情-时间为序  daily_20101012 返回数据 row 行数 = "+str(daily_20101012.shape[0]))
daily_20101012_addname_dataframe.to_excel(daily_201010_excel_writer,'12_2',index=False)
daily_201010_excel_writer.save()
daily_20101013 = pro.daily(start_date='',end_date='',trade_date='20101013', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20101013_tscode_list = list() 
for ts_code_sh in daily_20101013['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20101013_tscode_list.append(stock_name)
daily_20101013_addname_dataframe=pd.DataFrame()
daily_20101013_addname_dataframe['cname'] = daily_20101013_tscode_list
for table_name in daily_20101013.columns.values.tolist():
    daily_20101013_addname_dataframe[table_name] = daily_20101013[table_name]
print("日线行情-时间为序  daily_20101013 返回数据 row 行数 = "+str(daily_20101013.shape[0]))
daily_20101013_addname_dataframe.to_excel(daily_201010_excel_writer,'13_3',index=False)
daily_201010_excel_writer.save()
daily_20101014 = pro.daily(start_date='',end_date='',trade_date='20101014', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20101014_tscode_list = list() 
for ts_code_sh in daily_20101014['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20101014_tscode_list.append(stock_name)
daily_20101014_addname_dataframe=pd.DataFrame()
daily_20101014_addname_dataframe['cname'] = daily_20101014_tscode_list
for table_name in daily_20101014.columns.values.tolist():
    daily_20101014_addname_dataframe[table_name] = daily_20101014[table_name]
print("日线行情-时间为序  daily_20101014 返回数据 row 行数 = "+str(daily_20101014.shape[0]))
daily_20101014_addname_dataframe.to_excel(daily_201010_excel_writer,'14_4',index=False)
daily_201010_excel_writer.save()
daily_20101015 = pro.daily(start_date='',end_date='',trade_date='20101015', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20101015_tscode_list = list() 
for ts_code_sh in daily_20101015['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20101015_tscode_list.append(stock_name)
daily_20101015_addname_dataframe=pd.DataFrame()
daily_20101015_addname_dataframe['cname'] = daily_20101015_tscode_list
for table_name in daily_20101015.columns.values.tolist():
    daily_20101015_addname_dataframe[table_name] = daily_20101015[table_name]
print("日线行情-时间为序  daily_20101015 返回数据 row 行数 = "+str(daily_20101015.shape[0]))
daily_20101015_addname_dataframe.to_excel(daily_201010_excel_writer,'15_5',index=False)
daily_201010_excel_writer.save()
daily_20101018 = pro.daily(start_date='',end_date='',trade_date='20101018', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20101018_tscode_list = list() 
for ts_code_sh in daily_20101018['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20101018_tscode_list.append(stock_name)
daily_20101018_addname_dataframe=pd.DataFrame()
daily_20101018_addname_dataframe['cname'] = daily_20101018_tscode_list
for table_name in daily_20101018.columns.values.tolist():
    daily_20101018_addname_dataframe[table_name] = daily_20101018[table_name]
print("日线行情-时间为序  daily_20101018 返回数据 row 行数 = "+str(daily_20101018.shape[0]))
daily_20101018_addname_dataframe.to_excel(daily_201010_excel_writer,'18_1',index=False)
daily_201010_excel_writer.save()
daily_20101019 = pro.daily(start_date='',end_date='',trade_date='20101019', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20101019_tscode_list = list() 
for ts_code_sh in daily_20101019['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20101019_tscode_list.append(stock_name)
daily_20101019_addname_dataframe=pd.DataFrame()
daily_20101019_addname_dataframe['cname'] = daily_20101019_tscode_list
for table_name in daily_20101019.columns.values.tolist():
    daily_20101019_addname_dataframe[table_name] = daily_20101019[table_name]
print("日线行情-时间为序  daily_20101019 返回数据 row 行数 = "+str(daily_20101019.shape[0]))
daily_20101019_addname_dataframe.to_excel(daily_201010_excel_writer,'19_2',index=False)
daily_201010_excel_writer.save()
daily_20101020 = pro.daily(start_date='',end_date='',trade_date='20101020', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20101020_tscode_list = list() 
for ts_code_sh in daily_20101020['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20101020_tscode_list.append(stock_name)
daily_20101020_addname_dataframe=pd.DataFrame()
daily_20101020_addname_dataframe['cname'] = daily_20101020_tscode_list
for table_name in daily_20101020.columns.values.tolist():
    daily_20101020_addname_dataframe[table_name] = daily_20101020[table_name]
print("日线行情-时间为序  daily_20101020 返回数据 row 行数 = "+str(daily_20101020.shape[0]))
daily_20101020_addname_dataframe.to_excel(daily_201010_excel_writer,'20_3',index=False)
daily_201010_excel_writer.save()
daily_20101021 = pro.daily(start_date='',end_date='',trade_date='20101021', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20101021_tscode_list = list() 
for ts_code_sh in daily_20101021['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20101021_tscode_list.append(stock_name)
daily_20101021_addname_dataframe=pd.DataFrame()
daily_20101021_addname_dataframe['cname'] = daily_20101021_tscode_list
for table_name in daily_20101021.columns.values.tolist():
    daily_20101021_addname_dataframe[table_name] = daily_20101021[table_name]
print("日线行情-时间为序  daily_20101021 返回数据 row 行数 = "+str(daily_20101021.shape[0]))
daily_20101021_addname_dataframe.to_excel(daily_201010_excel_writer,'21_4',index=False)
daily_201010_excel_writer.save()
daily_20101022 = pro.daily(start_date='',end_date='',trade_date='20101022', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20101022_tscode_list = list() 
for ts_code_sh in daily_20101022['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20101022_tscode_list.append(stock_name)
daily_20101022_addname_dataframe=pd.DataFrame()
daily_20101022_addname_dataframe['cname'] = daily_20101022_tscode_list
for table_name in daily_20101022.columns.values.tolist():
    daily_20101022_addname_dataframe[table_name] = daily_20101022[table_name]
print("日线行情-时间为序  daily_20101022 返回数据 row 行数 = "+str(daily_20101022.shape[0]))
daily_20101022_addname_dataframe.to_excel(daily_201010_excel_writer,'22_5',index=False)
daily_201010_excel_writer.save()
daily_20101025 = pro.daily(start_date='',end_date='',trade_date='20101025', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20101025_tscode_list = list() 
for ts_code_sh in daily_20101025['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20101025_tscode_list.append(stock_name)
daily_20101025_addname_dataframe=pd.DataFrame()
daily_20101025_addname_dataframe['cname'] = daily_20101025_tscode_list
for table_name in daily_20101025.columns.values.tolist():
    daily_20101025_addname_dataframe[table_name] = daily_20101025[table_name]
print("日线行情-时间为序  daily_20101025 返回数据 row 行数 = "+str(daily_20101025.shape[0]))
daily_20101025_addname_dataframe.to_excel(daily_201010_excel_writer,'25_1',index=False)
daily_201010_excel_writer.save()
daily_20101026 = pro.daily(start_date='',end_date='',trade_date='20101026', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20101026_tscode_list = list() 
for ts_code_sh in daily_20101026['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20101026_tscode_list.append(stock_name)
daily_20101026_addname_dataframe=pd.DataFrame()
daily_20101026_addname_dataframe['cname'] = daily_20101026_tscode_list
for table_name in daily_20101026.columns.values.tolist():
    daily_20101026_addname_dataframe[table_name] = daily_20101026[table_name]
print("日线行情-时间为序  daily_20101026 返回数据 row 行数 = "+str(daily_20101026.shape[0]))
daily_20101026_addname_dataframe.to_excel(daily_201010_excel_writer,'26_2',index=False)
daily_201010_excel_writer.save()
daily_20101027 = pro.daily(start_date='',end_date='',trade_date='20101027', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20101027_tscode_list = list() 
for ts_code_sh in daily_20101027['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20101027_tscode_list.append(stock_name)
daily_20101027_addname_dataframe=pd.DataFrame()
daily_20101027_addname_dataframe['cname'] = daily_20101027_tscode_list
for table_name in daily_20101027.columns.values.tolist():
    daily_20101027_addname_dataframe[table_name] = daily_20101027[table_name]
print("日线行情-时间为序  daily_20101027 返回数据 row 行数 = "+str(daily_20101027.shape[0]))
daily_20101027_addname_dataframe.to_excel(daily_201010_excel_writer,'27_3',index=False)
daily_201010_excel_writer.save()
daily_20101028 = pro.daily(start_date='',end_date='',trade_date='20101028', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20101028_tscode_list = list() 
for ts_code_sh in daily_20101028['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20101028_tscode_list.append(stock_name)
daily_20101028_addname_dataframe=pd.DataFrame()
daily_20101028_addname_dataframe['cname'] = daily_20101028_tscode_list
for table_name in daily_20101028.columns.values.tolist():
    daily_20101028_addname_dataframe[table_name] = daily_20101028[table_name]
print("日线行情-时间为序  daily_20101028 返回数据 row 行数 = "+str(daily_20101028.shape[0]))
daily_20101028_addname_dataframe.to_excel(daily_201010_excel_writer,'28_4',index=False)
daily_201010_excel_writer.save()
daily_20101029 = pro.daily(start_date='',end_date='',trade_date='20101029', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20101029_tscode_list = list() 
for ts_code_sh in daily_20101029['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20101029_tscode_list.append(stock_name)
daily_20101029_addname_dataframe=pd.DataFrame()
daily_20101029_addname_dataframe['cname'] = daily_20101029_tscode_list
for table_name in daily_20101029.columns.values.tolist():
    daily_20101029_addname_dataframe[table_name] = daily_20101029[table_name]
print("日线行情-时间为序  daily_20101029 返回数据 row 行数 = "+str(daily_20101029.shape[0]))
daily_20101029_addname_dataframe.to_excel(daily_201010_excel_writer,'29_5',index=False)
daily_201010_excel_writer.save()




createexcel('daily_201011.xlsx')
daily_201011_book = load_workbook('C:\\Users\\zhuzj5\\Desktop\\zbin\\J0_Data\\daily_201011.xlsx')
daily_201011_excel_writer = pd.ExcelWriter('C:\\Users\\zhuzj5\\Desktop\\zbin\\J0_Data\\daily_201011.xlsx', engine='openpyxl')
daily_201011_excel_writer.book = daily_201011_book
daily_201011_excel_writer.sheets = dict((ws.title, ws) for ws in daily_201011_book.worksheets)
J0_PROPS.put(tree_node_name+"record_date", "20101101")       ###  更新 记录日期
daily_20101101 = pro.daily(start_date='',end_date='',trade_date='20101101', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20101101_tscode_list = list() 
for ts_code_sh in daily_20101101['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20101101_tscode_list.append(stock_name)
daily_20101101_addname_dataframe=pd.DataFrame()
daily_20101101_addname_dataframe['cname'] = daily_20101101_tscode_list
for table_name in daily_20101101.columns.values.tolist():
    daily_20101101_addname_dataframe[table_name] = daily_20101101[table_name]
print("日线行情-时间为序  daily_20101101 返回数据 row 行数 = "+str(daily_20101101.shape[0]))
daily_20101101_addname_dataframe.to_excel(daily_201011_excel_writer,'1_1',index=False)
daily_201011_excel_writer.save()
daily_20101102 = pro.daily(start_date='',end_date='',trade_date='20101102', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20101102_tscode_list = list() 
for ts_code_sh in daily_20101102['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20101102_tscode_list.append(stock_name)
daily_20101102_addname_dataframe=pd.DataFrame()
daily_20101102_addname_dataframe['cname'] = daily_20101102_tscode_list
for table_name in daily_20101102.columns.values.tolist():
    daily_20101102_addname_dataframe[table_name] = daily_20101102[table_name]
print("日线行情-时间为序  daily_20101102 返回数据 row 行数 = "+str(daily_20101102.shape[0]))
daily_20101102_addname_dataframe.to_excel(daily_201011_excel_writer,'2_2',index=False)
daily_201011_excel_writer.save()
daily_20101103 = pro.daily(start_date='',end_date='',trade_date='20101103', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20101103_tscode_list = list() 
for ts_code_sh in daily_20101103['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20101103_tscode_list.append(stock_name)
daily_20101103_addname_dataframe=pd.DataFrame()
daily_20101103_addname_dataframe['cname'] = daily_20101103_tscode_list
for table_name in daily_20101103.columns.values.tolist():
    daily_20101103_addname_dataframe[table_name] = daily_20101103[table_name]
print("日线行情-时间为序  daily_20101103 返回数据 row 行数 = "+str(daily_20101103.shape[0]))
daily_20101103_addname_dataframe.to_excel(daily_201011_excel_writer,'3_3',index=False)
daily_201011_excel_writer.save()
daily_20101104 = pro.daily(start_date='',end_date='',trade_date='20101104', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20101104_tscode_list = list() 
for ts_code_sh in daily_20101104['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20101104_tscode_list.append(stock_name)
daily_20101104_addname_dataframe=pd.DataFrame()
daily_20101104_addname_dataframe['cname'] = daily_20101104_tscode_list
for table_name in daily_20101104.columns.values.tolist():
    daily_20101104_addname_dataframe[table_name] = daily_20101104[table_name]
print("日线行情-时间为序  daily_20101104 返回数据 row 行数 = "+str(daily_20101104.shape[0]))
daily_20101104_addname_dataframe.to_excel(daily_201011_excel_writer,'4_4',index=False)
daily_201011_excel_writer.save()
daily_20101105 = pro.daily(start_date='',end_date='',trade_date='20101105', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20101105_tscode_list = list() 
for ts_code_sh in daily_20101105['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20101105_tscode_list.append(stock_name)
daily_20101105_addname_dataframe=pd.DataFrame()
daily_20101105_addname_dataframe['cname'] = daily_20101105_tscode_list
for table_name in daily_20101105.columns.values.tolist():
    daily_20101105_addname_dataframe[table_name] = daily_20101105[table_name]
print("日线行情-时间为序  daily_20101105 返回数据 row 行数 = "+str(daily_20101105.shape[0]))
daily_20101105_addname_dataframe.to_excel(daily_201011_excel_writer,'5_5',index=False)
daily_201011_excel_writer.save()
daily_20101108 = pro.daily(start_date='',end_date='',trade_date='20101108', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20101108_tscode_list = list() 
for ts_code_sh in daily_20101108['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20101108_tscode_list.append(stock_name)
daily_20101108_addname_dataframe=pd.DataFrame()
daily_20101108_addname_dataframe['cname'] = daily_20101108_tscode_list
for table_name in daily_20101108.columns.values.tolist():
    daily_20101108_addname_dataframe[table_name] = daily_20101108[table_name]
print("日线行情-时间为序  daily_20101108 返回数据 row 行数 = "+str(daily_20101108.shape[0]))
daily_20101108_addname_dataframe.to_excel(daily_201011_excel_writer,'8_1',index=False)
daily_201011_excel_writer.save()
daily_20101109 = pro.daily(start_date='',end_date='',trade_date='20101109', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20101109_tscode_list = list() 
for ts_code_sh in daily_20101109['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20101109_tscode_list.append(stock_name)
daily_20101109_addname_dataframe=pd.DataFrame()
daily_20101109_addname_dataframe['cname'] = daily_20101109_tscode_list
for table_name in daily_20101109.columns.values.tolist():
    daily_20101109_addname_dataframe[table_name] = daily_20101109[table_name]
print("日线行情-时间为序  daily_20101109 返回数据 row 行数 = "+str(daily_20101109.shape[0]))
daily_20101109_addname_dataframe.to_excel(daily_201011_excel_writer,'9_2',index=False)
daily_201011_excel_writer.save()
daily_20101110 = pro.daily(start_date='',end_date='',trade_date='20101110', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20101110_tscode_list = list() 
for ts_code_sh in daily_20101110['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20101110_tscode_list.append(stock_name)
daily_20101110_addname_dataframe=pd.DataFrame()
daily_20101110_addname_dataframe['cname'] = daily_20101110_tscode_list
for table_name in daily_20101110.columns.values.tolist():
    daily_20101110_addname_dataframe[table_name] = daily_20101110[table_name]
print("日线行情-时间为序  daily_20101110 返回数据 row 行数 = "+str(daily_20101110.shape[0]))
daily_20101110_addname_dataframe.to_excel(daily_201011_excel_writer,'10_3',index=False)
daily_201011_excel_writer.save()
daily_20101111 = pro.daily(start_date='',end_date='',trade_date='20101111', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20101111_tscode_list = list() 
for ts_code_sh in daily_20101111['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20101111_tscode_list.append(stock_name)
daily_20101111_addname_dataframe=pd.DataFrame()
daily_20101111_addname_dataframe['cname'] = daily_20101111_tscode_list
for table_name in daily_20101111.columns.values.tolist():
    daily_20101111_addname_dataframe[table_name] = daily_20101111[table_name]
print("日线行情-时间为序  daily_20101111 返回数据 row 行数 = "+str(daily_20101111.shape[0]))
daily_20101111_addname_dataframe.to_excel(daily_201011_excel_writer,'11_4',index=False)
daily_201011_excel_writer.save()
daily_20101112 = pro.daily(start_date='',end_date='',trade_date='20101112', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20101112_tscode_list = list() 
for ts_code_sh in daily_20101112['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20101112_tscode_list.append(stock_name)
daily_20101112_addname_dataframe=pd.DataFrame()
daily_20101112_addname_dataframe['cname'] = daily_20101112_tscode_list
for table_name in daily_20101112.columns.values.tolist():
    daily_20101112_addname_dataframe[table_name] = daily_20101112[table_name]
print("日线行情-时间为序  daily_20101112 返回数据 row 行数 = "+str(daily_20101112.shape[0]))
daily_20101112_addname_dataframe.to_excel(daily_201011_excel_writer,'12_5',index=False)
daily_201011_excel_writer.save()
daily_20101115 = pro.daily(start_date='',end_date='',trade_date='20101115', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20101115_tscode_list = list() 
for ts_code_sh in daily_20101115['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20101115_tscode_list.append(stock_name)
daily_20101115_addname_dataframe=pd.DataFrame()
daily_20101115_addname_dataframe['cname'] = daily_20101115_tscode_list
for table_name in daily_20101115.columns.values.tolist():
    daily_20101115_addname_dataframe[table_name] = daily_20101115[table_name]
print("日线行情-时间为序  daily_20101115 返回数据 row 行数 = "+str(daily_20101115.shape[0]))
daily_20101115_addname_dataframe.to_excel(daily_201011_excel_writer,'15_1',index=False)
daily_201011_excel_writer.save()
daily_20101116 = pro.daily(start_date='',end_date='',trade_date='20101116', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20101116_tscode_list = list() 
for ts_code_sh in daily_20101116['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20101116_tscode_list.append(stock_name)
daily_20101116_addname_dataframe=pd.DataFrame()
daily_20101116_addname_dataframe['cname'] = daily_20101116_tscode_list
for table_name in daily_20101116.columns.values.tolist():
    daily_20101116_addname_dataframe[table_name] = daily_20101116[table_name]
print("日线行情-时间为序  daily_20101116 返回数据 row 行数 = "+str(daily_20101116.shape[0]))
daily_20101116_addname_dataframe.to_excel(daily_201011_excel_writer,'16_2',index=False)
daily_201011_excel_writer.save()
daily_20101117 = pro.daily(start_date='',end_date='',trade_date='20101117', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20101117_tscode_list = list() 
for ts_code_sh in daily_20101117['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20101117_tscode_list.append(stock_name)
daily_20101117_addname_dataframe=pd.DataFrame()
daily_20101117_addname_dataframe['cname'] = daily_20101117_tscode_list
for table_name in daily_20101117.columns.values.tolist():
    daily_20101117_addname_dataframe[table_name] = daily_20101117[table_name]
print("日线行情-时间为序  daily_20101117 返回数据 row 行数 = "+str(daily_20101117.shape[0]))
daily_20101117_addname_dataframe.to_excel(daily_201011_excel_writer,'17_3',index=False)
daily_201011_excel_writer.save()
daily_20101118 = pro.daily(start_date='',end_date='',trade_date='20101118', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20101118_tscode_list = list() 
for ts_code_sh in daily_20101118['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20101118_tscode_list.append(stock_name)
daily_20101118_addname_dataframe=pd.DataFrame()
daily_20101118_addname_dataframe['cname'] = daily_20101118_tscode_list
for table_name in daily_20101118.columns.values.tolist():
    daily_20101118_addname_dataframe[table_name] = daily_20101118[table_name]
print("日线行情-时间为序  daily_20101118 返回数据 row 行数 = "+str(daily_20101118.shape[0]))
daily_20101118_addname_dataframe.to_excel(daily_201011_excel_writer,'18_4',index=False)
daily_201011_excel_writer.save()
daily_20101119 = pro.daily(start_date='',end_date='',trade_date='20101119', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20101119_tscode_list = list() 
for ts_code_sh in daily_20101119['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20101119_tscode_list.append(stock_name)
daily_20101119_addname_dataframe=pd.DataFrame()
daily_20101119_addname_dataframe['cname'] = daily_20101119_tscode_list
for table_name in daily_20101119.columns.values.tolist():
    daily_20101119_addname_dataframe[table_name] = daily_20101119[table_name]
print("日线行情-时间为序  daily_20101119 返回数据 row 行数 = "+str(daily_20101119.shape[0]))
daily_20101119_addname_dataframe.to_excel(daily_201011_excel_writer,'19_5',index=False)
daily_201011_excel_writer.save()
daily_20101122 = pro.daily(start_date='',end_date='',trade_date='20101122', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20101122_tscode_list = list() 
for ts_code_sh in daily_20101122['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20101122_tscode_list.append(stock_name)
daily_20101122_addname_dataframe=pd.DataFrame()
daily_20101122_addname_dataframe['cname'] = daily_20101122_tscode_list
for table_name in daily_20101122.columns.values.tolist():
    daily_20101122_addname_dataframe[table_name] = daily_20101122[table_name]
print("日线行情-时间为序  daily_20101122 返回数据 row 行数 = "+str(daily_20101122.shape[0]))
daily_20101122_addname_dataframe.to_excel(daily_201011_excel_writer,'22_1',index=False)
daily_201011_excel_writer.save()
daily_20101123 = pro.daily(start_date='',end_date='',trade_date='20101123', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20101123_tscode_list = list() 
for ts_code_sh in daily_20101123['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20101123_tscode_list.append(stock_name)
daily_20101123_addname_dataframe=pd.DataFrame()
daily_20101123_addname_dataframe['cname'] = daily_20101123_tscode_list
for table_name in daily_20101123.columns.values.tolist():
    daily_20101123_addname_dataframe[table_name] = daily_20101123[table_name]
print("日线行情-时间为序  daily_20101123 返回数据 row 行数 = "+str(daily_20101123.shape[0]))
daily_20101123_addname_dataframe.to_excel(daily_201011_excel_writer,'23_2',index=False)
daily_201011_excel_writer.save()
daily_20101124 = pro.daily(start_date='',end_date='',trade_date='20101124', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20101124_tscode_list = list() 
for ts_code_sh in daily_20101124['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20101124_tscode_list.append(stock_name)
daily_20101124_addname_dataframe=pd.DataFrame()
daily_20101124_addname_dataframe['cname'] = daily_20101124_tscode_list
for table_name in daily_20101124.columns.values.tolist():
    daily_20101124_addname_dataframe[table_name] = daily_20101124[table_name]
print("日线行情-时间为序  daily_20101124 返回数据 row 行数 = "+str(daily_20101124.shape[0]))
daily_20101124_addname_dataframe.to_excel(daily_201011_excel_writer,'24_3',index=False)
daily_201011_excel_writer.save()
daily_20101125 = pro.daily(start_date='',end_date='',trade_date='20101125', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20101125_tscode_list = list() 
for ts_code_sh in daily_20101125['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20101125_tscode_list.append(stock_name)
daily_20101125_addname_dataframe=pd.DataFrame()
daily_20101125_addname_dataframe['cname'] = daily_20101125_tscode_list
for table_name in daily_20101125.columns.values.tolist():
    daily_20101125_addname_dataframe[table_name] = daily_20101125[table_name]
print("日线行情-时间为序  daily_20101125 返回数据 row 行数 = "+str(daily_20101125.shape[0]))
daily_20101125_addname_dataframe.to_excel(daily_201011_excel_writer,'25_4',index=False)
daily_201011_excel_writer.save()
daily_20101126 = pro.daily(start_date='',end_date='',trade_date='20101126', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20101126_tscode_list = list() 
for ts_code_sh in daily_20101126['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20101126_tscode_list.append(stock_name)
daily_20101126_addname_dataframe=pd.DataFrame()
daily_20101126_addname_dataframe['cname'] = daily_20101126_tscode_list
for table_name in daily_20101126.columns.values.tolist():
    daily_20101126_addname_dataframe[table_name] = daily_20101126[table_name]
print("日线行情-时间为序  daily_20101126 返回数据 row 行数 = "+str(daily_20101126.shape[0]))
daily_20101126_addname_dataframe.to_excel(daily_201011_excel_writer,'26_5',index=False)
daily_201011_excel_writer.save()
daily_20101129 = pro.daily(start_date='',end_date='',trade_date='20101129', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20101129_tscode_list = list() 
for ts_code_sh in daily_20101129['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20101129_tscode_list.append(stock_name)
daily_20101129_addname_dataframe=pd.DataFrame()
daily_20101129_addname_dataframe['cname'] = daily_20101129_tscode_list
for table_name in daily_20101129.columns.values.tolist():
    daily_20101129_addname_dataframe[table_name] = daily_20101129[table_name]
print("日线行情-时间为序  daily_20101129 返回数据 row 行数 = "+str(daily_20101129.shape[0]))
daily_20101129_addname_dataframe.to_excel(daily_201011_excel_writer,'29_1',index=False)
daily_201011_excel_writer.save()
daily_20101130 = pro.daily(start_date='',end_date='',trade_date='20101130', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20101130_tscode_list = list() 
for ts_code_sh in daily_20101130['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20101130_tscode_list.append(stock_name)
daily_20101130_addname_dataframe=pd.DataFrame()
daily_20101130_addname_dataframe['cname'] = daily_20101130_tscode_list
for table_name in daily_20101130.columns.values.tolist():
    daily_20101130_addname_dataframe[table_name] = daily_20101130[table_name]
print("日线行情-时间为序  daily_20101130 返回数据 row 行数 = "+str(daily_20101130.shape[0]))
daily_20101130_addname_dataframe.to_excel(daily_201011_excel_writer,'30_2',index=False)
daily_201011_excel_writer.save()




createexcel('daily_201012.xlsx')
daily_201012_book = load_workbook('C:\\Users\\zhuzj5\\Desktop\\zbin\\J0_Data\\daily_201012.xlsx')
daily_201012_excel_writer = pd.ExcelWriter('C:\\Users\\zhuzj5\\Desktop\\zbin\\J0_Data\\daily_201012.xlsx', engine='openpyxl')
daily_201012_excel_writer.book = daily_201012_book
daily_201012_excel_writer.sheets = dict((ws.title, ws) for ws in daily_201012_book.worksheets)
J0_PROPS.put(tree_node_name+"record_date", "20101201")       ###  更新 记录日期
daily_20101201 = pro.daily(start_date='',end_date='',trade_date='20101201', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20101201_tscode_list = list() 
for ts_code_sh in daily_20101201['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20101201_tscode_list.append(stock_name)
daily_20101201_addname_dataframe=pd.DataFrame()
daily_20101201_addname_dataframe['cname'] = daily_20101201_tscode_list
for table_name in daily_20101201.columns.values.tolist():
    daily_20101201_addname_dataframe[table_name] = daily_20101201[table_name]
print("日线行情-时间为序  daily_20101201 返回数据 row 行数 = "+str(daily_20101201.shape[0]))
daily_20101201_addname_dataframe.to_excel(daily_201012_excel_writer,'1_3',index=False)
daily_201012_excel_writer.save()
daily_20101202 = pro.daily(start_date='',end_date='',trade_date='20101202', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20101202_tscode_list = list() 
for ts_code_sh in daily_20101202['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20101202_tscode_list.append(stock_name)
daily_20101202_addname_dataframe=pd.DataFrame()
daily_20101202_addname_dataframe['cname'] = daily_20101202_tscode_list
for table_name in daily_20101202.columns.values.tolist():
    daily_20101202_addname_dataframe[table_name] = daily_20101202[table_name]
print("日线行情-时间为序  daily_20101202 返回数据 row 行数 = "+str(daily_20101202.shape[0]))
daily_20101202_addname_dataframe.to_excel(daily_201012_excel_writer,'2_4',index=False)
daily_201012_excel_writer.save()
daily_20101203 = pro.daily(start_date='',end_date='',trade_date='20101203', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20101203_tscode_list = list() 
for ts_code_sh in daily_20101203['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20101203_tscode_list.append(stock_name)
daily_20101203_addname_dataframe=pd.DataFrame()
daily_20101203_addname_dataframe['cname'] = daily_20101203_tscode_list
for table_name in daily_20101203.columns.values.tolist():
    daily_20101203_addname_dataframe[table_name] = daily_20101203[table_name]
print("日线行情-时间为序  daily_20101203 返回数据 row 行数 = "+str(daily_20101203.shape[0]))
daily_20101203_addname_dataframe.to_excel(daily_201012_excel_writer,'3_5',index=False)
daily_201012_excel_writer.save()
daily_20101206 = pro.daily(start_date='',end_date='',trade_date='20101206', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20101206_tscode_list = list() 
for ts_code_sh in daily_20101206['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20101206_tscode_list.append(stock_name)
daily_20101206_addname_dataframe=pd.DataFrame()
daily_20101206_addname_dataframe['cname'] = daily_20101206_tscode_list
for table_name in daily_20101206.columns.values.tolist():
    daily_20101206_addname_dataframe[table_name] = daily_20101206[table_name]
print("日线行情-时间为序  daily_20101206 返回数据 row 行数 = "+str(daily_20101206.shape[0]))
daily_20101206_addname_dataframe.to_excel(daily_201012_excel_writer,'6_1',index=False)
daily_201012_excel_writer.save()
daily_20101207 = pro.daily(start_date='',end_date='',trade_date='20101207', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20101207_tscode_list = list() 
for ts_code_sh in daily_20101207['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20101207_tscode_list.append(stock_name)
daily_20101207_addname_dataframe=pd.DataFrame()
daily_20101207_addname_dataframe['cname'] = daily_20101207_tscode_list
for table_name in daily_20101207.columns.values.tolist():
    daily_20101207_addname_dataframe[table_name] = daily_20101207[table_name]
print("日线行情-时间为序  daily_20101207 返回数据 row 行数 = "+str(daily_20101207.shape[0]))
daily_20101207_addname_dataframe.to_excel(daily_201012_excel_writer,'7_2',index=False)
daily_201012_excel_writer.save()
daily_20101208 = pro.daily(start_date='',end_date='',trade_date='20101208', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20101208_tscode_list = list() 
for ts_code_sh in daily_20101208['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20101208_tscode_list.append(stock_name)
daily_20101208_addname_dataframe=pd.DataFrame()
daily_20101208_addname_dataframe['cname'] = daily_20101208_tscode_list
for table_name in daily_20101208.columns.values.tolist():
    daily_20101208_addname_dataframe[table_name] = daily_20101208[table_name]
print("日线行情-时间为序  daily_20101208 返回数据 row 行数 = "+str(daily_20101208.shape[0]))
daily_20101208_addname_dataframe.to_excel(daily_201012_excel_writer,'8_3',index=False)
daily_201012_excel_writer.save()
daily_20101209 = pro.daily(start_date='',end_date='',trade_date='20101209', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20101209_tscode_list = list() 
for ts_code_sh in daily_20101209['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20101209_tscode_list.append(stock_name)
daily_20101209_addname_dataframe=pd.DataFrame()
daily_20101209_addname_dataframe['cname'] = daily_20101209_tscode_list
for table_name in daily_20101209.columns.values.tolist():
    daily_20101209_addname_dataframe[table_name] = daily_20101209[table_name]
print("日线行情-时间为序  daily_20101209 返回数据 row 行数 = "+str(daily_20101209.shape[0]))
daily_20101209_addname_dataframe.to_excel(daily_201012_excel_writer,'9_4',index=False)
daily_201012_excel_writer.save()
daily_20101210 = pro.daily(start_date='',end_date='',trade_date='20101210', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20101210_tscode_list = list() 
for ts_code_sh in daily_20101210['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20101210_tscode_list.append(stock_name)
daily_20101210_addname_dataframe=pd.DataFrame()
daily_20101210_addname_dataframe['cname'] = daily_20101210_tscode_list
for table_name in daily_20101210.columns.values.tolist():
    daily_20101210_addname_dataframe[table_name] = daily_20101210[table_name]
print("日线行情-时间为序  daily_20101210 返回数据 row 行数 = "+str(daily_20101210.shape[0]))
daily_20101210_addname_dataframe.to_excel(daily_201012_excel_writer,'10_5',index=False)
daily_201012_excel_writer.save()
daily_20101213 = pro.daily(start_date='',end_date='',trade_date='20101213', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20101213_tscode_list = list() 
for ts_code_sh in daily_20101213['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20101213_tscode_list.append(stock_name)
daily_20101213_addname_dataframe=pd.DataFrame()
daily_20101213_addname_dataframe['cname'] = daily_20101213_tscode_list
for table_name in daily_20101213.columns.values.tolist():
    daily_20101213_addname_dataframe[table_name] = daily_20101213[table_name]
print("日线行情-时间为序  daily_20101213 返回数据 row 行数 = "+str(daily_20101213.shape[0]))
daily_20101213_addname_dataframe.to_excel(daily_201012_excel_writer,'13_1',index=False)
daily_201012_excel_writer.save()
daily_20101214 = pro.daily(start_date='',end_date='',trade_date='20101214', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20101214_tscode_list = list() 
for ts_code_sh in daily_20101214['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20101214_tscode_list.append(stock_name)
daily_20101214_addname_dataframe=pd.DataFrame()
daily_20101214_addname_dataframe['cname'] = daily_20101214_tscode_list
for table_name in daily_20101214.columns.values.tolist():
    daily_20101214_addname_dataframe[table_name] = daily_20101214[table_name]
print("日线行情-时间为序  daily_20101214 返回数据 row 行数 = "+str(daily_20101214.shape[0]))
daily_20101214_addname_dataframe.to_excel(daily_201012_excel_writer,'14_2',index=False)
daily_201012_excel_writer.save()
daily_20101215 = pro.daily(start_date='',end_date='',trade_date='20101215', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20101215_tscode_list = list() 
for ts_code_sh in daily_20101215['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20101215_tscode_list.append(stock_name)
daily_20101215_addname_dataframe=pd.DataFrame()
daily_20101215_addname_dataframe['cname'] = daily_20101215_tscode_list
for table_name in daily_20101215.columns.values.tolist():
    daily_20101215_addname_dataframe[table_name] = daily_20101215[table_name]
print("日线行情-时间为序  daily_20101215 返回数据 row 行数 = "+str(daily_20101215.shape[0]))
daily_20101215_addname_dataframe.to_excel(daily_201012_excel_writer,'15_3',index=False)
daily_201012_excel_writer.save()
daily_20101216 = pro.daily(start_date='',end_date='',trade_date='20101216', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20101216_tscode_list = list() 
for ts_code_sh in daily_20101216['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20101216_tscode_list.append(stock_name)
daily_20101216_addname_dataframe=pd.DataFrame()
daily_20101216_addname_dataframe['cname'] = daily_20101216_tscode_list
for table_name in daily_20101216.columns.values.tolist():
    daily_20101216_addname_dataframe[table_name] = daily_20101216[table_name]
print("日线行情-时间为序  daily_20101216 返回数据 row 行数 = "+str(daily_20101216.shape[0]))
daily_20101216_addname_dataframe.to_excel(daily_201012_excel_writer,'16_4',index=False)
daily_201012_excel_writer.save()
daily_20101217 = pro.daily(start_date='',end_date='',trade_date='20101217', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20101217_tscode_list = list() 
for ts_code_sh in daily_20101217['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20101217_tscode_list.append(stock_name)
daily_20101217_addname_dataframe=pd.DataFrame()
daily_20101217_addname_dataframe['cname'] = daily_20101217_tscode_list
for table_name in daily_20101217.columns.values.tolist():
    daily_20101217_addname_dataframe[table_name] = daily_20101217[table_name]
print("日线行情-时间为序  daily_20101217 返回数据 row 行数 = "+str(daily_20101217.shape[0]))
daily_20101217_addname_dataframe.to_excel(daily_201012_excel_writer,'17_5',index=False)
daily_201012_excel_writer.save()
daily_20101220 = pro.daily(start_date='',end_date='',trade_date='20101220', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20101220_tscode_list = list() 
for ts_code_sh in daily_20101220['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20101220_tscode_list.append(stock_name)
daily_20101220_addname_dataframe=pd.DataFrame()
daily_20101220_addname_dataframe['cname'] = daily_20101220_tscode_list
for table_name in daily_20101220.columns.values.tolist():
    daily_20101220_addname_dataframe[table_name] = daily_20101220[table_name]
print("日线行情-时间为序  daily_20101220 返回数据 row 行数 = "+str(daily_20101220.shape[0]))
daily_20101220_addname_dataframe.to_excel(daily_201012_excel_writer,'20_1',index=False)
daily_201012_excel_writer.save()
daily_20101221 = pro.daily(start_date='',end_date='',trade_date='20101221', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20101221_tscode_list = list() 
for ts_code_sh in daily_20101221['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20101221_tscode_list.append(stock_name)
daily_20101221_addname_dataframe=pd.DataFrame()
daily_20101221_addname_dataframe['cname'] = daily_20101221_tscode_list
for table_name in daily_20101221.columns.values.tolist():
    daily_20101221_addname_dataframe[table_name] = daily_20101221[table_name]
print("日线行情-时间为序  daily_20101221 返回数据 row 行数 = "+str(daily_20101221.shape[0]))
daily_20101221_addname_dataframe.to_excel(daily_201012_excel_writer,'21_2',index=False)
daily_201012_excel_writer.save()
daily_20101222 = pro.daily(start_date='',end_date='',trade_date='20101222', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20101222_tscode_list = list() 
for ts_code_sh in daily_20101222['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20101222_tscode_list.append(stock_name)
daily_20101222_addname_dataframe=pd.DataFrame()
daily_20101222_addname_dataframe['cname'] = daily_20101222_tscode_list
for table_name in daily_20101222.columns.values.tolist():
    daily_20101222_addname_dataframe[table_name] = daily_20101222[table_name]
print("日线行情-时间为序  daily_20101222 返回数据 row 行数 = "+str(daily_20101222.shape[0]))
daily_20101222_addname_dataframe.to_excel(daily_201012_excel_writer,'22_3',index=False)
daily_201012_excel_writer.save()
daily_20101223 = pro.daily(start_date='',end_date='',trade_date='20101223', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20101223_tscode_list = list() 
for ts_code_sh in daily_20101223['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20101223_tscode_list.append(stock_name)
daily_20101223_addname_dataframe=pd.DataFrame()
daily_20101223_addname_dataframe['cname'] = daily_20101223_tscode_list
for table_name in daily_20101223.columns.values.tolist():
    daily_20101223_addname_dataframe[table_name] = daily_20101223[table_name]
print("日线行情-时间为序  daily_20101223 返回数据 row 行数 = "+str(daily_20101223.shape[0]))
daily_20101223_addname_dataframe.to_excel(daily_201012_excel_writer,'23_4',index=False)
daily_201012_excel_writer.save()
daily_20101224 = pro.daily(start_date='',end_date='',trade_date='20101224', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20101224_tscode_list = list() 
for ts_code_sh in daily_20101224['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20101224_tscode_list.append(stock_name)
daily_20101224_addname_dataframe=pd.DataFrame()
daily_20101224_addname_dataframe['cname'] = daily_20101224_tscode_list
for table_name in daily_20101224.columns.values.tolist():
    daily_20101224_addname_dataframe[table_name] = daily_20101224[table_name]
print("日线行情-时间为序  daily_20101224 返回数据 row 行数 = "+str(daily_20101224.shape[0]))
daily_20101224_addname_dataframe.to_excel(daily_201012_excel_writer,'24_5',index=False)
daily_201012_excel_writer.save()
daily_20101227 = pro.daily(start_date='',end_date='',trade_date='20101227', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20101227_tscode_list = list() 
for ts_code_sh in daily_20101227['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20101227_tscode_list.append(stock_name)
daily_20101227_addname_dataframe=pd.DataFrame()
daily_20101227_addname_dataframe['cname'] = daily_20101227_tscode_list
for table_name in daily_20101227.columns.values.tolist():
    daily_20101227_addname_dataframe[table_name] = daily_20101227[table_name]
print("日线行情-时间为序  daily_20101227 返回数据 row 行数 = "+str(daily_20101227.shape[0]))
daily_20101227_addname_dataframe.to_excel(daily_201012_excel_writer,'27_1',index=False)
daily_201012_excel_writer.save()
daily_20101228 = pro.daily(start_date='',end_date='',trade_date='20101228', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20101228_tscode_list = list() 
for ts_code_sh in daily_20101228['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20101228_tscode_list.append(stock_name)
daily_20101228_addname_dataframe=pd.DataFrame()
daily_20101228_addname_dataframe['cname'] = daily_20101228_tscode_list
for table_name in daily_20101228.columns.values.tolist():
    daily_20101228_addname_dataframe[table_name] = daily_20101228[table_name]
print("日线行情-时间为序  daily_20101228 返回数据 row 行数 = "+str(daily_20101228.shape[0]))
daily_20101228_addname_dataframe.to_excel(daily_201012_excel_writer,'28_2',index=False)
daily_201012_excel_writer.save()
daily_20101229 = pro.daily(start_date='',end_date='',trade_date='20101229', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20101229_tscode_list = list() 
for ts_code_sh in daily_20101229['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20101229_tscode_list.append(stock_name)
daily_20101229_addname_dataframe=pd.DataFrame()
daily_20101229_addname_dataframe['cname'] = daily_20101229_tscode_list
for table_name in daily_20101229.columns.values.tolist():
    daily_20101229_addname_dataframe[table_name] = daily_20101229[table_name]
print("日线行情-时间为序  daily_20101229 返回数据 row 行数 = "+str(daily_20101229.shape[0]))
daily_20101229_addname_dataframe.to_excel(daily_201012_excel_writer,'29_3',index=False)
daily_201012_excel_writer.save()
daily_20101230 = pro.daily(start_date='',end_date='',trade_date='20101230', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20101230_tscode_list = list() 
for ts_code_sh in daily_20101230['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20101230_tscode_list.append(stock_name)
daily_20101230_addname_dataframe=pd.DataFrame()
daily_20101230_addname_dataframe['cname'] = daily_20101230_tscode_list
for table_name in daily_20101230.columns.values.tolist():
    daily_20101230_addname_dataframe[table_name] = daily_20101230[table_name]
print("日线行情-时间为序  daily_20101230 返回数据 row 行数 = "+str(daily_20101230.shape[0]))
daily_20101230_addname_dataframe.to_excel(daily_201012_excel_writer,'30_4',index=False)
daily_201012_excel_writer.save()
daily_20101231 = pro.daily(start_date='',end_date='',trade_date='20101231', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20101231_tscode_list = list() 
for ts_code_sh in daily_20101231['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20101231_tscode_list.append(stock_name)
daily_20101231_addname_dataframe=pd.DataFrame()
daily_20101231_addname_dataframe['cname'] = daily_20101231_tscode_list
for table_name in daily_20101231.columns.values.tolist():
    daily_20101231_addname_dataframe[table_name] = daily_20101231[table_name]
print("日线行情-时间为序  daily_20101231 返回数据 row 行数 = "+str(daily_20101231.shape[0]))
daily_20101231_addname_dataframe.to_excel(daily_201012_excel_writer,'31_5',index=False)
daily_201012_excel_writer.save()




createexcel('daily_201101.xlsx')
daily_201101_book = load_workbook('C:\\Users\\zhuzj5\\Desktop\\zbin\\J0_Data\\daily_201101.xlsx')
daily_201101_excel_writer = pd.ExcelWriter('C:\\Users\\zhuzj5\\Desktop\\zbin\\J0_Data\\daily_201101.xlsx', engine='openpyxl')
daily_201101_excel_writer.book = daily_201101_book
daily_201101_excel_writer.sheets = dict((ws.title, ws) for ws in daily_201101_book.worksheets)
J0_PROPS.put(tree_node_name+"record_date", "20110101")       ###  更新 记录日期
daily_20110104 = pro.daily(start_date='',end_date='',trade_date='20110104', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20110104_tscode_list = list() 
for ts_code_sh in daily_20110104['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20110104_tscode_list.append(stock_name)
daily_20110104_addname_dataframe=pd.DataFrame()
daily_20110104_addname_dataframe['cname'] = daily_20110104_tscode_list
for table_name in daily_20110104.columns.values.tolist():
    daily_20110104_addname_dataframe[table_name] = daily_20110104[table_name]
print("日线行情-时间为序  daily_20110104 返回数据 row 行数 = "+str(daily_20110104.shape[0]))
daily_20110104_addname_dataframe.to_excel(daily_201101_excel_writer,'4_2',index=False)
daily_201101_excel_writer.save()
daily_20110105 = pro.daily(start_date='',end_date='',trade_date='20110105', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20110105_tscode_list = list() 
for ts_code_sh in daily_20110105['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20110105_tscode_list.append(stock_name)
daily_20110105_addname_dataframe=pd.DataFrame()
daily_20110105_addname_dataframe['cname'] = daily_20110105_tscode_list
for table_name in daily_20110105.columns.values.tolist():
    daily_20110105_addname_dataframe[table_name] = daily_20110105[table_name]
print("日线行情-时间为序  daily_20110105 返回数据 row 行数 = "+str(daily_20110105.shape[0]))
daily_20110105_addname_dataframe.to_excel(daily_201101_excel_writer,'5_3',index=False)
daily_201101_excel_writer.save()
daily_20110106 = pro.daily(start_date='',end_date='',trade_date='20110106', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20110106_tscode_list = list() 
for ts_code_sh in daily_20110106['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20110106_tscode_list.append(stock_name)
daily_20110106_addname_dataframe=pd.DataFrame()
daily_20110106_addname_dataframe['cname'] = daily_20110106_tscode_list
for table_name in daily_20110106.columns.values.tolist():
    daily_20110106_addname_dataframe[table_name] = daily_20110106[table_name]
print("日线行情-时间为序  daily_20110106 返回数据 row 行数 = "+str(daily_20110106.shape[0]))
daily_20110106_addname_dataframe.to_excel(daily_201101_excel_writer,'6_4',index=False)
daily_201101_excel_writer.save()
daily_20110107 = pro.daily(start_date='',end_date='',trade_date='20110107', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20110107_tscode_list = list() 
for ts_code_sh in daily_20110107['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20110107_tscode_list.append(stock_name)
daily_20110107_addname_dataframe=pd.DataFrame()
daily_20110107_addname_dataframe['cname'] = daily_20110107_tscode_list
for table_name in daily_20110107.columns.values.tolist():
    daily_20110107_addname_dataframe[table_name] = daily_20110107[table_name]
print("日线行情-时间为序  daily_20110107 返回数据 row 行数 = "+str(daily_20110107.shape[0]))
daily_20110107_addname_dataframe.to_excel(daily_201101_excel_writer,'7_5',index=False)
daily_201101_excel_writer.save()
daily_20110110 = pro.daily(start_date='',end_date='',trade_date='20110110', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20110110_tscode_list = list() 
for ts_code_sh in daily_20110110['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20110110_tscode_list.append(stock_name)
daily_20110110_addname_dataframe=pd.DataFrame()
daily_20110110_addname_dataframe['cname'] = daily_20110110_tscode_list
for table_name in daily_20110110.columns.values.tolist():
    daily_20110110_addname_dataframe[table_name] = daily_20110110[table_name]
print("日线行情-时间为序  daily_20110110 返回数据 row 行数 = "+str(daily_20110110.shape[0]))
daily_20110110_addname_dataframe.to_excel(daily_201101_excel_writer,'10_1',index=False)
daily_201101_excel_writer.save()
daily_20110111 = pro.daily(start_date='',end_date='',trade_date='20110111', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20110111_tscode_list = list() 
for ts_code_sh in daily_20110111['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20110111_tscode_list.append(stock_name)
daily_20110111_addname_dataframe=pd.DataFrame()
daily_20110111_addname_dataframe['cname'] = daily_20110111_tscode_list
for table_name in daily_20110111.columns.values.tolist():
    daily_20110111_addname_dataframe[table_name] = daily_20110111[table_name]
print("日线行情-时间为序  daily_20110111 返回数据 row 行数 = "+str(daily_20110111.shape[0]))
daily_20110111_addname_dataframe.to_excel(daily_201101_excel_writer,'11_2',index=False)
daily_201101_excel_writer.save()
daily_20110112 = pro.daily(start_date='',end_date='',trade_date='20110112', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20110112_tscode_list = list() 
for ts_code_sh in daily_20110112['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20110112_tscode_list.append(stock_name)
daily_20110112_addname_dataframe=pd.DataFrame()
daily_20110112_addname_dataframe['cname'] = daily_20110112_tscode_list
for table_name in daily_20110112.columns.values.tolist():
    daily_20110112_addname_dataframe[table_name] = daily_20110112[table_name]
print("日线行情-时间为序  daily_20110112 返回数据 row 行数 = "+str(daily_20110112.shape[0]))
daily_20110112_addname_dataframe.to_excel(daily_201101_excel_writer,'12_3',index=False)
daily_201101_excel_writer.save()
daily_20110113 = pro.daily(start_date='',end_date='',trade_date='20110113', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20110113_tscode_list = list() 
for ts_code_sh in daily_20110113['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20110113_tscode_list.append(stock_name)
daily_20110113_addname_dataframe=pd.DataFrame()
daily_20110113_addname_dataframe['cname'] = daily_20110113_tscode_list
for table_name in daily_20110113.columns.values.tolist():
    daily_20110113_addname_dataframe[table_name] = daily_20110113[table_name]
print("日线行情-时间为序  daily_20110113 返回数据 row 行数 = "+str(daily_20110113.shape[0]))
daily_20110113_addname_dataframe.to_excel(daily_201101_excel_writer,'13_4',index=False)
daily_201101_excel_writer.save()
daily_20110114 = pro.daily(start_date='',end_date='',trade_date='20110114', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20110114_tscode_list = list() 
for ts_code_sh in daily_20110114['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20110114_tscode_list.append(stock_name)
daily_20110114_addname_dataframe=pd.DataFrame()
daily_20110114_addname_dataframe['cname'] = daily_20110114_tscode_list
for table_name in daily_20110114.columns.values.tolist():
    daily_20110114_addname_dataframe[table_name] = daily_20110114[table_name]
print("日线行情-时间为序  daily_20110114 返回数据 row 行数 = "+str(daily_20110114.shape[0]))
daily_20110114_addname_dataframe.to_excel(daily_201101_excel_writer,'14_5',index=False)
daily_201101_excel_writer.save()
daily_20110117 = pro.daily(start_date='',end_date='',trade_date='20110117', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20110117_tscode_list = list() 
for ts_code_sh in daily_20110117['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20110117_tscode_list.append(stock_name)
daily_20110117_addname_dataframe=pd.DataFrame()
daily_20110117_addname_dataframe['cname'] = daily_20110117_tscode_list
for table_name in daily_20110117.columns.values.tolist():
    daily_20110117_addname_dataframe[table_name] = daily_20110117[table_name]
print("日线行情-时间为序  daily_20110117 返回数据 row 行数 = "+str(daily_20110117.shape[0]))
daily_20110117_addname_dataframe.to_excel(daily_201101_excel_writer,'17_1',index=False)
daily_201101_excel_writer.save()
daily_20110118 = pro.daily(start_date='',end_date='',trade_date='20110118', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20110118_tscode_list = list() 
for ts_code_sh in daily_20110118['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20110118_tscode_list.append(stock_name)
daily_20110118_addname_dataframe=pd.DataFrame()
daily_20110118_addname_dataframe['cname'] = daily_20110118_tscode_list
for table_name in daily_20110118.columns.values.tolist():
    daily_20110118_addname_dataframe[table_name] = daily_20110118[table_name]
print("日线行情-时间为序  daily_20110118 返回数据 row 行数 = "+str(daily_20110118.shape[0]))
daily_20110118_addname_dataframe.to_excel(daily_201101_excel_writer,'18_2',index=False)
daily_201101_excel_writer.save()
daily_20110119 = pro.daily(start_date='',end_date='',trade_date='20110119', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20110119_tscode_list = list() 
for ts_code_sh in daily_20110119['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20110119_tscode_list.append(stock_name)
daily_20110119_addname_dataframe=pd.DataFrame()
daily_20110119_addname_dataframe['cname'] = daily_20110119_tscode_list
for table_name in daily_20110119.columns.values.tolist():
    daily_20110119_addname_dataframe[table_name] = daily_20110119[table_name]
print("日线行情-时间为序  daily_20110119 返回数据 row 行数 = "+str(daily_20110119.shape[0]))
daily_20110119_addname_dataframe.to_excel(daily_201101_excel_writer,'19_3',index=False)
daily_201101_excel_writer.save()
daily_20110120 = pro.daily(start_date='',end_date='',trade_date='20110120', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20110120_tscode_list = list() 
for ts_code_sh in daily_20110120['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20110120_tscode_list.append(stock_name)
daily_20110120_addname_dataframe=pd.DataFrame()
daily_20110120_addname_dataframe['cname'] = daily_20110120_tscode_list
for table_name in daily_20110120.columns.values.tolist():
    daily_20110120_addname_dataframe[table_name] = daily_20110120[table_name]
print("日线行情-时间为序  daily_20110120 返回数据 row 行数 = "+str(daily_20110120.shape[0]))
daily_20110120_addname_dataframe.to_excel(daily_201101_excel_writer,'20_4',index=False)
daily_201101_excel_writer.save()
daily_20110121 = pro.daily(start_date='',end_date='',trade_date='20110121', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20110121_tscode_list = list() 
for ts_code_sh in daily_20110121['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20110121_tscode_list.append(stock_name)
daily_20110121_addname_dataframe=pd.DataFrame()
daily_20110121_addname_dataframe['cname'] = daily_20110121_tscode_list
for table_name in daily_20110121.columns.values.tolist():
    daily_20110121_addname_dataframe[table_name] = daily_20110121[table_name]
print("日线行情-时间为序  daily_20110121 返回数据 row 行数 = "+str(daily_20110121.shape[0]))
daily_20110121_addname_dataframe.to_excel(daily_201101_excel_writer,'21_5',index=False)
daily_201101_excel_writer.save()
daily_20110124 = pro.daily(start_date='',end_date='',trade_date='20110124', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20110124_tscode_list = list() 
for ts_code_sh in daily_20110124['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20110124_tscode_list.append(stock_name)
daily_20110124_addname_dataframe=pd.DataFrame()
daily_20110124_addname_dataframe['cname'] = daily_20110124_tscode_list
for table_name in daily_20110124.columns.values.tolist():
    daily_20110124_addname_dataframe[table_name] = daily_20110124[table_name]
print("日线行情-时间为序  daily_20110124 返回数据 row 行数 = "+str(daily_20110124.shape[0]))
daily_20110124_addname_dataframe.to_excel(daily_201101_excel_writer,'24_1',index=False)
daily_201101_excel_writer.save()
daily_20110125 = pro.daily(start_date='',end_date='',trade_date='20110125', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20110125_tscode_list = list() 
for ts_code_sh in daily_20110125['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20110125_tscode_list.append(stock_name)
daily_20110125_addname_dataframe=pd.DataFrame()
daily_20110125_addname_dataframe['cname'] = daily_20110125_tscode_list
for table_name in daily_20110125.columns.values.tolist():
    daily_20110125_addname_dataframe[table_name] = daily_20110125[table_name]
print("日线行情-时间为序  daily_20110125 返回数据 row 行数 = "+str(daily_20110125.shape[0]))
daily_20110125_addname_dataframe.to_excel(daily_201101_excel_writer,'25_2',index=False)
daily_201101_excel_writer.save()
daily_20110126 = pro.daily(start_date='',end_date='',trade_date='20110126', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20110126_tscode_list = list() 
for ts_code_sh in daily_20110126['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20110126_tscode_list.append(stock_name)
daily_20110126_addname_dataframe=pd.DataFrame()
daily_20110126_addname_dataframe['cname'] = daily_20110126_tscode_list
for table_name in daily_20110126.columns.values.tolist():
    daily_20110126_addname_dataframe[table_name] = daily_20110126[table_name]
print("日线行情-时间为序  daily_20110126 返回数据 row 行数 = "+str(daily_20110126.shape[0]))
daily_20110126_addname_dataframe.to_excel(daily_201101_excel_writer,'26_3',index=False)
daily_201101_excel_writer.save()
daily_20110127 = pro.daily(start_date='',end_date='',trade_date='20110127', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20110127_tscode_list = list() 
for ts_code_sh in daily_20110127['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20110127_tscode_list.append(stock_name)
daily_20110127_addname_dataframe=pd.DataFrame()
daily_20110127_addname_dataframe['cname'] = daily_20110127_tscode_list
for table_name in daily_20110127.columns.values.tolist():
    daily_20110127_addname_dataframe[table_name] = daily_20110127[table_name]
print("日线行情-时间为序  daily_20110127 返回数据 row 行数 = "+str(daily_20110127.shape[0]))
daily_20110127_addname_dataframe.to_excel(daily_201101_excel_writer,'27_4',index=False)
daily_201101_excel_writer.save()
daily_20110128 = pro.daily(start_date='',end_date='',trade_date='20110128', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20110128_tscode_list = list() 
for ts_code_sh in daily_20110128['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20110128_tscode_list.append(stock_name)
daily_20110128_addname_dataframe=pd.DataFrame()
daily_20110128_addname_dataframe['cname'] = daily_20110128_tscode_list
for table_name in daily_20110128.columns.values.tolist():
    daily_20110128_addname_dataframe[table_name] = daily_20110128[table_name]
print("日线行情-时间为序  daily_20110128 返回数据 row 行数 = "+str(daily_20110128.shape[0]))
daily_20110128_addname_dataframe.to_excel(daily_201101_excel_writer,'28_5',index=False)
daily_201101_excel_writer.save()
daily_20110131 = pro.daily(start_date='',end_date='',trade_date='20110131', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20110131_tscode_list = list() 
for ts_code_sh in daily_20110131['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20110131_tscode_list.append(stock_name)
daily_20110131_addname_dataframe=pd.DataFrame()
daily_20110131_addname_dataframe['cname'] = daily_20110131_tscode_list
for table_name in daily_20110131.columns.values.tolist():
    daily_20110131_addname_dataframe[table_name] = daily_20110131[table_name]
print("日线行情-时间为序  daily_20110131 返回数据 row 行数 = "+str(daily_20110131.shape[0]))
daily_20110131_addname_dataframe.to_excel(daily_201101_excel_writer,'31_1',index=False)
daily_201101_excel_writer.save()




createexcel('daily_201102.xlsx')
daily_201102_book = load_workbook('C:\\Users\\zhuzj5\\Desktop\\zbin\\J0_Data\\daily_201102.xlsx')
daily_201102_excel_writer = pd.ExcelWriter('C:\\Users\\zhuzj5\\Desktop\\zbin\\J0_Data\\daily_201102.xlsx', engine='openpyxl')
daily_201102_excel_writer.book = daily_201102_book
daily_201102_excel_writer.sheets = dict((ws.title, ws) for ws in daily_201102_book.worksheets)
J0_PROPS.put(tree_node_name+"record_date", "20110201")       ###  更新 记录日期
daily_20110201 = pro.daily(start_date='',end_date='',trade_date='20110201', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20110201_tscode_list = list() 
for ts_code_sh in daily_20110201['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20110201_tscode_list.append(stock_name)
daily_20110201_addname_dataframe=pd.DataFrame()
daily_20110201_addname_dataframe['cname'] = daily_20110201_tscode_list
for table_name in daily_20110201.columns.values.tolist():
    daily_20110201_addname_dataframe[table_name] = daily_20110201[table_name]
print("日线行情-时间为序  daily_20110201 返回数据 row 行数 = "+str(daily_20110201.shape[0]))
daily_20110201_addname_dataframe.to_excel(daily_201102_excel_writer,'1_2',index=False)
daily_201102_excel_writer.save()
daily_20110209 = pro.daily(start_date='',end_date='',trade_date='20110209', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20110209_tscode_list = list() 
for ts_code_sh in daily_20110209['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20110209_tscode_list.append(stock_name)
daily_20110209_addname_dataframe=pd.DataFrame()
daily_20110209_addname_dataframe['cname'] = daily_20110209_tscode_list
for table_name in daily_20110209.columns.values.tolist():
    daily_20110209_addname_dataframe[table_name] = daily_20110209[table_name]
print("日线行情-时间为序  daily_20110209 返回数据 row 行数 = "+str(daily_20110209.shape[0]))
daily_20110209_addname_dataframe.to_excel(daily_201102_excel_writer,'9_3',index=False)
daily_201102_excel_writer.save()
daily_20110210 = pro.daily(start_date='',end_date='',trade_date='20110210', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20110210_tscode_list = list() 
for ts_code_sh in daily_20110210['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20110210_tscode_list.append(stock_name)
daily_20110210_addname_dataframe=pd.DataFrame()
daily_20110210_addname_dataframe['cname'] = daily_20110210_tscode_list
for table_name in daily_20110210.columns.values.tolist():
    daily_20110210_addname_dataframe[table_name] = daily_20110210[table_name]
print("日线行情-时间为序  daily_20110210 返回数据 row 行数 = "+str(daily_20110210.shape[0]))
daily_20110210_addname_dataframe.to_excel(daily_201102_excel_writer,'10_4',index=False)
daily_201102_excel_writer.save()
daily_20110211 = pro.daily(start_date='',end_date='',trade_date='20110211', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20110211_tscode_list = list() 
for ts_code_sh in daily_20110211['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20110211_tscode_list.append(stock_name)
daily_20110211_addname_dataframe=pd.DataFrame()
daily_20110211_addname_dataframe['cname'] = daily_20110211_tscode_list
for table_name in daily_20110211.columns.values.tolist():
    daily_20110211_addname_dataframe[table_name] = daily_20110211[table_name]
print("日线行情-时间为序  daily_20110211 返回数据 row 行数 = "+str(daily_20110211.shape[0]))
daily_20110211_addname_dataframe.to_excel(daily_201102_excel_writer,'11_5',index=False)
daily_201102_excel_writer.save()
daily_20110214 = pro.daily(start_date='',end_date='',trade_date='20110214', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20110214_tscode_list = list() 
for ts_code_sh in daily_20110214['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20110214_tscode_list.append(stock_name)
daily_20110214_addname_dataframe=pd.DataFrame()
daily_20110214_addname_dataframe['cname'] = daily_20110214_tscode_list
for table_name in daily_20110214.columns.values.tolist():
    daily_20110214_addname_dataframe[table_name] = daily_20110214[table_name]
print("日线行情-时间为序  daily_20110214 返回数据 row 行数 = "+str(daily_20110214.shape[0]))
daily_20110214_addname_dataframe.to_excel(daily_201102_excel_writer,'14_1',index=False)
daily_201102_excel_writer.save()
daily_20110215 = pro.daily(start_date='',end_date='',trade_date='20110215', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20110215_tscode_list = list() 
for ts_code_sh in daily_20110215['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20110215_tscode_list.append(stock_name)
daily_20110215_addname_dataframe=pd.DataFrame()
daily_20110215_addname_dataframe['cname'] = daily_20110215_tscode_list
for table_name in daily_20110215.columns.values.tolist():
    daily_20110215_addname_dataframe[table_name] = daily_20110215[table_name]
print("日线行情-时间为序  daily_20110215 返回数据 row 行数 = "+str(daily_20110215.shape[0]))
daily_20110215_addname_dataframe.to_excel(daily_201102_excel_writer,'15_2',index=False)
daily_201102_excel_writer.save()
daily_20110216 = pro.daily(start_date='',end_date='',trade_date='20110216', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20110216_tscode_list = list() 
for ts_code_sh in daily_20110216['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20110216_tscode_list.append(stock_name)
daily_20110216_addname_dataframe=pd.DataFrame()
daily_20110216_addname_dataframe['cname'] = daily_20110216_tscode_list
for table_name in daily_20110216.columns.values.tolist():
    daily_20110216_addname_dataframe[table_name] = daily_20110216[table_name]
print("日线行情-时间为序  daily_20110216 返回数据 row 行数 = "+str(daily_20110216.shape[0]))
daily_20110216_addname_dataframe.to_excel(daily_201102_excel_writer,'16_3',index=False)
daily_201102_excel_writer.save()
daily_20110217 = pro.daily(start_date='',end_date='',trade_date='20110217', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20110217_tscode_list = list() 
for ts_code_sh in daily_20110217['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20110217_tscode_list.append(stock_name)
daily_20110217_addname_dataframe=pd.DataFrame()
daily_20110217_addname_dataframe['cname'] = daily_20110217_tscode_list
for table_name in daily_20110217.columns.values.tolist():
    daily_20110217_addname_dataframe[table_name] = daily_20110217[table_name]
print("日线行情-时间为序  daily_20110217 返回数据 row 行数 = "+str(daily_20110217.shape[0]))
daily_20110217_addname_dataframe.to_excel(daily_201102_excel_writer,'17_4',index=False)
daily_201102_excel_writer.save()
daily_20110218 = pro.daily(start_date='',end_date='',trade_date='20110218', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20110218_tscode_list = list() 
for ts_code_sh in daily_20110218['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20110218_tscode_list.append(stock_name)
daily_20110218_addname_dataframe=pd.DataFrame()
daily_20110218_addname_dataframe['cname'] = daily_20110218_tscode_list
for table_name in daily_20110218.columns.values.tolist():
    daily_20110218_addname_dataframe[table_name] = daily_20110218[table_name]
print("日线行情-时间为序  daily_20110218 返回数据 row 行数 = "+str(daily_20110218.shape[0]))
daily_20110218_addname_dataframe.to_excel(daily_201102_excel_writer,'18_5',index=False)
daily_201102_excel_writer.save()
daily_20110221 = pro.daily(start_date='',end_date='',trade_date='20110221', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20110221_tscode_list = list() 
for ts_code_sh in daily_20110221['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20110221_tscode_list.append(stock_name)
daily_20110221_addname_dataframe=pd.DataFrame()
daily_20110221_addname_dataframe['cname'] = daily_20110221_tscode_list
for table_name in daily_20110221.columns.values.tolist():
    daily_20110221_addname_dataframe[table_name] = daily_20110221[table_name]
print("日线行情-时间为序  daily_20110221 返回数据 row 行数 = "+str(daily_20110221.shape[0]))
daily_20110221_addname_dataframe.to_excel(daily_201102_excel_writer,'21_1',index=False)
daily_201102_excel_writer.save()
daily_20110222 = pro.daily(start_date='',end_date='',trade_date='20110222', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20110222_tscode_list = list() 
for ts_code_sh in daily_20110222['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20110222_tscode_list.append(stock_name)
daily_20110222_addname_dataframe=pd.DataFrame()
daily_20110222_addname_dataframe['cname'] = daily_20110222_tscode_list
for table_name in daily_20110222.columns.values.tolist():
    daily_20110222_addname_dataframe[table_name] = daily_20110222[table_name]
print("日线行情-时间为序  daily_20110222 返回数据 row 行数 = "+str(daily_20110222.shape[0]))
daily_20110222_addname_dataframe.to_excel(daily_201102_excel_writer,'22_2',index=False)
daily_201102_excel_writer.save()
daily_20110223 = pro.daily(start_date='',end_date='',trade_date='20110223', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20110223_tscode_list = list() 
for ts_code_sh in daily_20110223['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20110223_tscode_list.append(stock_name)
daily_20110223_addname_dataframe=pd.DataFrame()
daily_20110223_addname_dataframe['cname'] = daily_20110223_tscode_list
for table_name in daily_20110223.columns.values.tolist():
    daily_20110223_addname_dataframe[table_name] = daily_20110223[table_name]
print("日线行情-时间为序  daily_20110223 返回数据 row 行数 = "+str(daily_20110223.shape[0]))
daily_20110223_addname_dataframe.to_excel(daily_201102_excel_writer,'23_3',index=False)
daily_201102_excel_writer.save()
daily_20110224 = pro.daily(start_date='',end_date='',trade_date='20110224', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20110224_tscode_list = list() 
for ts_code_sh in daily_20110224['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20110224_tscode_list.append(stock_name)
daily_20110224_addname_dataframe=pd.DataFrame()
daily_20110224_addname_dataframe['cname'] = daily_20110224_tscode_list
for table_name in daily_20110224.columns.values.tolist():
    daily_20110224_addname_dataframe[table_name] = daily_20110224[table_name]
print("日线行情-时间为序  daily_20110224 返回数据 row 行数 = "+str(daily_20110224.shape[0]))
daily_20110224_addname_dataframe.to_excel(daily_201102_excel_writer,'24_4',index=False)
daily_201102_excel_writer.save()
daily_20110225 = pro.daily(start_date='',end_date='',trade_date='20110225', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20110225_tscode_list = list() 
for ts_code_sh in daily_20110225['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20110225_tscode_list.append(stock_name)
daily_20110225_addname_dataframe=pd.DataFrame()
daily_20110225_addname_dataframe['cname'] = daily_20110225_tscode_list
for table_name in daily_20110225.columns.values.tolist():
    daily_20110225_addname_dataframe[table_name] = daily_20110225[table_name]
print("日线行情-时间为序  daily_20110225 返回数据 row 行数 = "+str(daily_20110225.shape[0]))
daily_20110225_addname_dataframe.to_excel(daily_201102_excel_writer,'25_5',index=False)
daily_201102_excel_writer.save()
daily_20110228 = pro.daily(start_date='',end_date='',trade_date='20110228', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20110228_tscode_list = list() 
for ts_code_sh in daily_20110228['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20110228_tscode_list.append(stock_name)
daily_20110228_addname_dataframe=pd.DataFrame()
daily_20110228_addname_dataframe['cname'] = daily_20110228_tscode_list
for table_name in daily_20110228.columns.values.tolist():
    daily_20110228_addname_dataframe[table_name] = daily_20110228[table_name]
print("日线行情-时间为序  daily_20110228 返回数据 row 行数 = "+str(daily_20110228.shape[0]))
daily_20110228_addname_dataframe.to_excel(daily_201102_excel_writer,'28_1',index=False)
daily_201102_excel_writer.save()




createexcel('daily_201103.xlsx')
daily_201103_book = load_workbook('C:\\Users\\zhuzj5\\Desktop\\zbin\\J0_Data\\daily_201103.xlsx')
daily_201103_excel_writer = pd.ExcelWriter('C:\\Users\\zhuzj5\\Desktop\\zbin\\J0_Data\\daily_201103.xlsx', engine='openpyxl')
daily_201103_excel_writer.book = daily_201103_book
daily_201103_excel_writer.sheets = dict((ws.title, ws) for ws in daily_201103_book.worksheets)
J0_PROPS.put(tree_node_name+"record_date", "20110301")       ###  更新 记录日期
daily_20110301 = pro.daily(start_date='',end_date='',trade_date='20110301', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20110301_tscode_list = list() 
for ts_code_sh in daily_20110301['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20110301_tscode_list.append(stock_name)
daily_20110301_addname_dataframe=pd.DataFrame()
daily_20110301_addname_dataframe['cname'] = daily_20110301_tscode_list
for table_name in daily_20110301.columns.values.tolist():
    daily_20110301_addname_dataframe[table_name] = daily_20110301[table_name]
print("日线行情-时间为序  daily_20110301 返回数据 row 行数 = "+str(daily_20110301.shape[0]))
daily_20110301_addname_dataframe.to_excel(daily_201103_excel_writer,'1_2',index=False)
daily_201103_excel_writer.save()
daily_20110302 = pro.daily(start_date='',end_date='',trade_date='20110302', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20110302_tscode_list = list() 
for ts_code_sh in daily_20110302['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20110302_tscode_list.append(stock_name)
daily_20110302_addname_dataframe=pd.DataFrame()
daily_20110302_addname_dataframe['cname'] = daily_20110302_tscode_list
for table_name in daily_20110302.columns.values.tolist():
    daily_20110302_addname_dataframe[table_name] = daily_20110302[table_name]
print("日线行情-时间为序  daily_20110302 返回数据 row 行数 = "+str(daily_20110302.shape[0]))
daily_20110302_addname_dataframe.to_excel(daily_201103_excel_writer,'2_3',index=False)
daily_201103_excel_writer.save()
daily_20110303 = pro.daily(start_date='',end_date='',trade_date='20110303', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20110303_tscode_list = list() 
for ts_code_sh in daily_20110303['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20110303_tscode_list.append(stock_name)
daily_20110303_addname_dataframe=pd.DataFrame()
daily_20110303_addname_dataframe['cname'] = daily_20110303_tscode_list
for table_name in daily_20110303.columns.values.tolist():
    daily_20110303_addname_dataframe[table_name] = daily_20110303[table_name]
print("日线行情-时间为序  daily_20110303 返回数据 row 行数 = "+str(daily_20110303.shape[0]))
daily_20110303_addname_dataframe.to_excel(daily_201103_excel_writer,'3_4',index=False)
daily_201103_excel_writer.save()
daily_20110304 = pro.daily(start_date='',end_date='',trade_date='20110304', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20110304_tscode_list = list() 
for ts_code_sh in daily_20110304['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20110304_tscode_list.append(stock_name)
daily_20110304_addname_dataframe=pd.DataFrame()
daily_20110304_addname_dataframe['cname'] = daily_20110304_tscode_list
for table_name in daily_20110304.columns.values.tolist():
    daily_20110304_addname_dataframe[table_name] = daily_20110304[table_name]
print("日线行情-时间为序  daily_20110304 返回数据 row 行数 = "+str(daily_20110304.shape[0]))
daily_20110304_addname_dataframe.to_excel(daily_201103_excel_writer,'4_5',index=False)
daily_201103_excel_writer.save()
daily_20110307 = pro.daily(start_date='',end_date='',trade_date='20110307', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20110307_tscode_list = list() 
for ts_code_sh in daily_20110307['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20110307_tscode_list.append(stock_name)
daily_20110307_addname_dataframe=pd.DataFrame()
daily_20110307_addname_dataframe['cname'] = daily_20110307_tscode_list
for table_name in daily_20110307.columns.values.tolist():
    daily_20110307_addname_dataframe[table_name] = daily_20110307[table_name]
print("日线行情-时间为序  daily_20110307 返回数据 row 行数 = "+str(daily_20110307.shape[0]))
daily_20110307_addname_dataframe.to_excel(daily_201103_excel_writer,'7_1',index=False)
daily_201103_excel_writer.save()
daily_20110308 = pro.daily(start_date='',end_date='',trade_date='20110308', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20110308_tscode_list = list() 
for ts_code_sh in daily_20110308['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20110308_tscode_list.append(stock_name)
daily_20110308_addname_dataframe=pd.DataFrame()
daily_20110308_addname_dataframe['cname'] = daily_20110308_tscode_list
for table_name in daily_20110308.columns.values.tolist():
    daily_20110308_addname_dataframe[table_name] = daily_20110308[table_name]
print("日线行情-时间为序  daily_20110308 返回数据 row 行数 = "+str(daily_20110308.shape[0]))
daily_20110308_addname_dataframe.to_excel(daily_201103_excel_writer,'8_2',index=False)
daily_201103_excel_writer.save()
daily_20110309 = pro.daily(start_date='',end_date='',trade_date='20110309', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20110309_tscode_list = list() 
for ts_code_sh in daily_20110309['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20110309_tscode_list.append(stock_name)
daily_20110309_addname_dataframe=pd.DataFrame()
daily_20110309_addname_dataframe['cname'] = daily_20110309_tscode_list
for table_name in daily_20110309.columns.values.tolist():
    daily_20110309_addname_dataframe[table_name] = daily_20110309[table_name]
print("日线行情-时间为序  daily_20110309 返回数据 row 行数 = "+str(daily_20110309.shape[0]))
daily_20110309_addname_dataframe.to_excel(daily_201103_excel_writer,'9_3',index=False)
daily_201103_excel_writer.save()
daily_20110310 = pro.daily(start_date='',end_date='',trade_date='20110310', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20110310_tscode_list = list() 
for ts_code_sh in daily_20110310['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20110310_tscode_list.append(stock_name)
daily_20110310_addname_dataframe=pd.DataFrame()
daily_20110310_addname_dataframe['cname'] = daily_20110310_tscode_list
for table_name in daily_20110310.columns.values.tolist():
    daily_20110310_addname_dataframe[table_name] = daily_20110310[table_name]
print("日线行情-时间为序  daily_20110310 返回数据 row 行数 = "+str(daily_20110310.shape[0]))
daily_20110310_addname_dataframe.to_excel(daily_201103_excel_writer,'10_4',index=False)
daily_201103_excel_writer.save()
daily_20110311 = pro.daily(start_date='',end_date='',trade_date='20110311', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20110311_tscode_list = list() 
for ts_code_sh in daily_20110311['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20110311_tscode_list.append(stock_name)
daily_20110311_addname_dataframe=pd.DataFrame()
daily_20110311_addname_dataframe['cname'] = daily_20110311_tscode_list
for table_name in daily_20110311.columns.values.tolist():
    daily_20110311_addname_dataframe[table_name] = daily_20110311[table_name]
print("日线行情-时间为序  daily_20110311 返回数据 row 行数 = "+str(daily_20110311.shape[0]))
daily_20110311_addname_dataframe.to_excel(daily_201103_excel_writer,'11_5',index=False)
daily_201103_excel_writer.save()
daily_20110314 = pro.daily(start_date='',end_date='',trade_date='20110314', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20110314_tscode_list = list() 
for ts_code_sh in daily_20110314['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20110314_tscode_list.append(stock_name)
daily_20110314_addname_dataframe=pd.DataFrame()
daily_20110314_addname_dataframe['cname'] = daily_20110314_tscode_list
for table_name in daily_20110314.columns.values.tolist():
    daily_20110314_addname_dataframe[table_name] = daily_20110314[table_name]
print("日线行情-时间为序  daily_20110314 返回数据 row 行数 = "+str(daily_20110314.shape[0]))
daily_20110314_addname_dataframe.to_excel(daily_201103_excel_writer,'14_1',index=False)
daily_201103_excel_writer.save()
daily_20110315 = pro.daily(start_date='',end_date='',trade_date='20110315', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20110315_tscode_list = list() 
for ts_code_sh in daily_20110315['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20110315_tscode_list.append(stock_name)
daily_20110315_addname_dataframe=pd.DataFrame()
daily_20110315_addname_dataframe['cname'] = daily_20110315_tscode_list
for table_name in daily_20110315.columns.values.tolist():
    daily_20110315_addname_dataframe[table_name] = daily_20110315[table_name]
print("日线行情-时间为序  daily_20110315 返回数据 row 行数 = "+str(daily_20110315.shape[0]))
daily_20110315_addname_dataframe.to_excel(daily_201103_excel_writer,'15_2',index=False)
daily_201103_excel_writer.save()
daily_20110316 = pro.daily(start_date='',end_date='',trade_date='20110316', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20110316_tscode_list = list() 
for ts_code_sh in daily_20110316['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20110316_tscode_list.append(stock_name)
daily_20110316_addname_dataframe=pd.DataFrame()
daily_20110316_addname_dataframe['cname'] = daily_20110316_tscode_list
for table_name in daily_20110316.columns.values.tolist():
    daily_20110316_addname_dataframe[table_name] = daily_20110316[table_name]
print("日线行情-时间为序  daily_20110316 返回数据 row 行数 = "+str(daily_20110316.shape[0]))
daily_20110316_addname_dataframe.to_excel(daily_201103_excel_writer,'16_3',index=False)
daily_201103_excel_writer.save()
daily_20110317 = pro.daily(start_date='',end_date='',trade_date='20110317', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20110317_tscode_list = list() 
for ts_code_sh in daily_20110317['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20110317_tscode_list.append(stock_name)
daily_20110317_addname_dataframe=pd.DataFrame()
daily_20110317_addname_dataframe['cname'] = daily_20110317_tscode_list
for table_name in daily_20110317.columns.values.tolist():
    daily_20110317_addname_dataframe[table_name] = daily_20110317[table_name]
print("日线行情-时间为序  daily_20110317 返回数据 row 行数 = "+str(daily_20110317.shape[0]))
daily_20110317_addname_dataframe.to_excel(daily_201103_excel_writer,'17_4',index=False)
daily_201103_excel_writer.save()
daily_20110318 = pro.daily(start_date='',end_date='',trade_date='20110318', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20110318_tscode_list = list() 
for ts_code_sh in daily_20110318['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20110318_tscode_list.append(stock_name)
daily_20110318_addname_dataframe=pd.DataFrame()
daily_20110318_addname_dataframe['cname'] = daily_20110318_tscode_list
for table_name in daily_20110318.columns.values.tolist():
    daily_20110318_addname_dataframe[table_name] = daily_20110318[table_name]
print("日线行情-时间为序  daily_20110318 返回数据 row 行数 = "+str(daily_20110318.shape[0]))
daily_20110318_addname_dataframe.to_excel(daily_201103_excel_writer,'18_5',index=False)
daily_201103_excel_writer.save()
daily_20110321 = pro.daily(start_date='',end_date='',trade_date='20110321', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20110321_tscode_list = list() 
for ts_code_sh in daily_20110321['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20110321_tscode_list.append(stock_name)
daily_20110321_addname_dataframe=pd.DataFrame()
daily_20110321_addname_dataframe['cname'] = daily_20110321_tscode_list
for table_name in daily_20110321.columns.values.tolist():
    daily_20110321_addname_dataframe[table_name] = daily_20110321[table_name]
print("日线行情-时间为序  daily_20110321 返回数据 row 行数 = "+str(daily_20110321.shape[0]))
daily_20110321_addname_dataframe.to_excel(daily_201103_excel_writer,'21_1',index=False)
daily_201103_excel_writer.save()
daily_20110322 = pro.daily(start_date='',end_date='',trade_date='20110322', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20110322_tscode_list = list() 
for ts_code_sh in daily_20110322['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20110322_tscode_list.append(stock_name)
daily_20110322_addname_dataframe=pd.DataFrame()
daily_20110322_addname_dataframe['cname'] = daily_20110322_tscode_list
for table_name in daily_20110322.columns.values.tolist():
    daily_20110322_addname_dataframe[table_name] = daily_20110322[table_name]
print("日线行情-时间为序  daily_20110322 返回数据 row 行数 = "+str(daily_20110322.shape[0]))
daily_20110322_addname_dataframe.to_excel(daily_201103_excel_writer,'22_2',index=False)
daily_201103_excel_writer.save()
daily_20110323 = pro.daily(start_date='',end_date='',trade_date='20110323', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20110323_tscode_list = list() 
for ts_code_sh in daily_20110323['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20110323_tscode_list.append(stock_name)
daily_20110323_addname_dataframe=pd.DataFrame()
daily_20110323_addname_dataframe['cname'] = daily_20110323_tscode_list
for table_name in daily_20110323.columns.values.tolist():
    daily_20110323_addname_dataframe[table_name] = daily_20110323[table_name]
print("日线行情-时间为序  daily_20110323 返回数据 row 行数 = "+str(daily_20110323.shape[0]))
daily_20110323_addname_dataframe.to_excel(daily_201103_excel_writer,'23_3',index=False)
daily_201103_excel_writer.save()
daily_20110324 = pro.daily(start_date='',end_date='',trade_date='20110324', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20110324_tscode_list = list() 
for ts_code_sh in daily_20110324['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20110324_tscode_list.append(stock_name)
daily_20110324_addname_dataframe=pd.DataFrame()
daily_20110324_addname_dataframe['cname'] = daily_20110324_tscode_list
for table_name in daily_20110324.columns.values.tolist():
    daily_20110324_addname_dataframe[table_name] = daily_20110324[table_name]
print("日线行情-时间为序  daily_20110324 返回数据 row 行数 = "+str(daily_20110324.shape[0]))
daily_20110324_addname_dataframe.to_excel(daily_201103_excel_writer,'24_4',index=False)
daily_201103_excel_writer.save()
daily_20110325 = pro.daily(start_date='',end_date='',trade_date='20110325', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20110325_tscode_list = list() 
for ts_code_sh in daily_20110325['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20110325_tscode_list.append(stock_name)
daily_20110325_addname_dataframe=pd.DataFrame()
daily_20110325_addname_dataframe['cname'] = daily_20110325_tscode_list
for table_name in daily_20110325.columns.values.tolist():
    daily_20110325_addname_dataframe[table_name] = daily_20110325[table_name]
print("日线行情-时间为序  daily_20110325 返回数据 row 行数 = "+str(daily_20110325.shape[0]))
daily_20110325_addname_dataframe.to_excel(daily_201103_excel_writer,'25_5',index=False)
daily_201103_excel_writer.save()
daily_20110328 = pro.daily(start_date='',end_date='',trade_date='20110328', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20110328_tscode_list = list() 
for ts_code_sh in daily_20110328['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20110328_tscode_list.append(stock_name)
daily_20110328_addname_dataframe=pd.DataFrame()
daily_20110328_addname_dataframe['cname'] = daily_20110328_tscode_list
for table_name in daily_20110328.columns.values.tolist():
    daily_20110328_addname_dataframe[table_name] = daily_20110328[table_name]
print("日线行情-时间为序  daily_20110328 返回数据 row 行数 = "+str(daily_20110328.shape[0]))
daily_20110328_addname_dataframe.to_excel(daily_201103_excel_writer,'28_1',index=False)
daily_201103_excel_writer.save()
daily_20110329 = pro.daily(start_date='',end_date='',trade_date='20110329', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20110329_tscode_list = list() 
for ts_code_sh in daily_20110329['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20110329_tscode_list.append(stock_name)
daily_20110329_addname_dataframe=pd.DataFrame()
daily_20110329_addname_dataframe['cname'] = daily_20110329_tscode_list
for table_name in daily_20110329.columns.values.tolist():
    daily_20110329_addname_dataframe[table_name] = daily_20110329[table_name]
print("日线行情-时间为序  daily_20110329 返回数据 row 行数 = "+str(daily_20110329.shape[0]))
daily_20110329_addname_dataframe.to_excel(daily_201103_excel_writer,'29_2',index=False)
daily_201103_excel_writer.save()
daily_20110330 = pro.daily(start_date='',end_date='',trade_date='20110330', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20110330_tscode_list = list() 
for ts_code_sh in daily_20110330['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20110330_tscode_list.append(stock_name)
daily_20110330_addname_dataframe=pd.DataFrame()
daily_20110330_addname_dataframe['cname'] = daily_20110330_tscode_list
for table_name in daily_20110330.columns.values.tolist():
    daily_20110330_addname_dataframe[table_name] = daily_20110330[table_name]
print("日线行情-时间为序  daily_20110330 返回数据 row 行数 = "+str(daily_20110330.shape[0]))
daily_20110330_addname_dataframe.to_excel(daily_201103_excel_writer,'30_3',index=False)
daily_201103_excel_writer.save()
daily_20110331 = pro.daily(start_date='',end_date='',trade_date='20110331', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20110331_tscode_list = list() 
for ts_code_sh in daily_20110331['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20110331_tscode_list.append(stock_name)
daily_20110331_addname_dataframe=pd.DataFrame()
daily_20110331_addname_dataframe['cname'] = daily_20110331_tscode_list
for table_name in daily_20110331.columns.values.tolist():
    daily_20110331_addname_dataframe[table_name] = daily_20110331[table_name]
print("日线行情-时间为序  daily_20110331 返回数据 row 行数 = "+str(daily_20110331.shape[0]))
daily_20110331_addname_dataframe.to_excel(daily_201103_excel_writer,'31_4',index=False)
daily_201103_excel_writer.save()




createexcel('daily_201104.xlsx')
daily_201104_book = load_workbook('C:\\Users\\zhuzj5\\Desktop\\zbin\\J0_Data\\daily_201104.xlsx')
daily_201104_excel_writer = pd.ExcelWriter('C:\\Users\\zhuzj5\\Desktop\\zbin\\J0_Data\\daily_201104.xlsx', engine='openpyxl')
daily_201104_excel_writer.book = daily_201104_book
daily_201104_excel_writer.sheets = dict((ws.title, ws) for ws in daily_201104_book.worksheets)
J0_PROPS.put(tree_node_name+"record_date", "20110401")       ###  更新 记录日期
daily_20110401 = pro.daily(start_date='',end_date='',trade_date='20110401', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20110401_tscode_list = list() 
for ts_code_sh in daily_20110401['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20110401_tscode_list.append(stock_name)
daily_20110401_addname_dataframe=pd.DataFrame()
daily_20110401_addname_dataframe['cname'] = daily_20110401_tscode_list
for table_name in daily_20110401.columns.values.tolist():
    daily_20110401_addname_dataframe[table_name] = daily_20110401[table_name]
print("日线行情-时间为序  daily_20110401 返回数据 row 行数 = "+str(daily_20110401.shape[0]))
daily_20110401_addname_dataframe.to_excel(daily_201104_excel_writer,'1_5',index=False)
daily_201104_excel_writer.save()
daily_20110406 = pro.daily(start_date='',end_date='',trade_date='20110406', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20110406_tscode_list = list() 
for ts_code_sh in daily_20110406['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20110406_tscode_list.append(stock_name)
daily_20110406_addname_dataframe=pd.DataFrame()
daily_20110406_addname_dataframe['cname'] = daily_20110406_tscode_list
for table_name in daily_20110406.columns.values.tolist():
    daily_20110406_addname_dataframe[table_name] = daily_20110406[table_name]
print("日线行情-时间为序  daily_20110406 返回数据 row 行数 = "+str(daily_20110406.shape[0]))
daily_20110406_addname_dataframe.to_excel(daily_201104_excel_writer,'6_3',index=False)
daily_201104_excel_writer.save()
daily_20110407 = pro.daily(start_date='',end_date='',trade_date='20110407', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20110407_tscode_list = list() 
for ts_code_sh in daily_20110407['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20110407_tscode_list.append(stock_name)
daily_20110407_addname_dataframe=pd.DataFrame()
daily_20110407_addname_dataframe['cname'] = daily_20110407_tscode_list
for table_name in daily_20110407.columns.values.tolist():
    daily_20110407_addname_dataframe[table_name] = daily_20110407[table_name]
print("日线行情-时间为序  daily_20110407 返回数据 row 行数 = "+str(daily_20110407.shape[0]))
daily_20110407_addname_dataframe.to_excel(daily_201104_excel_writer,'7_4',index=False)
daily_201104_excel_writer.save()
daily_20110408 = pro.daily(start_date='',end_date='',trade_date='20110408', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20110408_tscode_list = list() 
for ts_code_sh in daily_20110408['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20110408_tscode_list.append(stock_name)
daily_20110408_addname_dataframe=pd.DataFrame()
daily_20110408_addname_dataframe['cname'] = daily_20110408_tscode_list
for table_name in daily_20110408.columns.values.tolist():
    daily_20110408_addname_dataframe[table_name] = daily_20110408[table_name]
print("日线行情-时间为序  daily_20110408 返回数据 row 行数 = "+str(daily_20110408.shape[0]))
daily_20110408_addname_dataframe.to_excel(daily_201104_excel_writer,'8_5',index=False)
daily_201104_excel_writer.save()
daily_20110411 = pro.daily(start_date='',end_date='',trade_date='20110411', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20110411_tscode_list = list() 
for ts_code_sh in daily_20110411['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20110411_tscode_list.append(stock_name)
daily_20110411_addname_dataframe=pd.DataFrame()
daily_20110411_addname_dataframe['cname'] = daily_20110411_tscode_list
for table_name in daily_20110411.columns.values.tolist():
    daily_20110411_addname_dataframe[table_name] = daily_20110411[table_name]
print("日线行情-时间为序  daily_20110411 返回数据 row 行数 = "+str(daily_20110411.shape[0]))
daily_20110411_addname_dataframe.to_excel(daily_201104_excel_writer,'11_1',index=False)
daily_201104_excel_writer.save()
daily_20110412 = pro.daily(start_date='',end_date='',trade_date='20110412', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20110412_tscode_list = list() 
for ts_code_sh in daily_20110412['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20110412_tscode_list.append(stock_name)
daily_20110412_addname_dataframe=pd.DataFrame()
daily_20110412_addname_dataframe['cname'] = daily_20110412_tscode_list
for table_name in daily_20110412.columns.values.tolist():
    daily_20110412_addname_dataframe[table_name] = daily_20110412[table_name]
print("日线行情-时间为序  daily_20110412 返回数据 row 行数 = "+str(daily_20110412.shape[0]))
daily_20110412_addname_dataframe.to_excel(daily_201104_excel_writer,'12_2',index=False)
daily_201104_excel_writer.save()
daily_20110413 = pro.daily(start_date='',end_date='',trade_date='20110413', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20110413_tscode_list = list() 
for ts_code_sh in daily_20110413['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20110413_tscode_list.append(stock_name)
daily_20110413_addname_dataframe=pd.DataFrame()
daily_20110413_addname_dataframe['cname'] = daily_20110413_tscode_list
for table_name in daily_20110413.columns.values.tolist():
    daily_20110413_addname_dataframe[table_name] = daily_20110413[table_name]
print("日线行情-时间为序  daily_20110413 返回数据 row 行数 = "+str(daily_20110413.shape[0]))
daily_20110413_addname_dataframe.to_excel(daily_201104_excel_writer,'13_3',index=False)
daily_201104_excel_writer.save()
daily_20110414 = pro.daily(start_date='',end_date='',trade_date='20110414', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20110414_tscode_list = list() 
for ts_code_sh in daily_20110414['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20110414_tscode_list.append(stock_name)
daily_20110414_addname_dataframe=pd.DataFrame()
daily_20110414_addname_dataframe['cname'] = daily_20110414_tscode_list
for table_name in daily_20110414.columns.values.tolist():
    daily_20110414_addname_dataframe[table_name] = daily_20110414[table_name]
print("日线行情-时间为序  daily_20110414 返回数据 row 行数 = "+str(daily_20110414.shape[0]))
daily_20110414_addname_dataframe.to_excel(daily_201104_excel_writer,'14_4',index=False)
daily_201104_excel_writer.save()
daily_20110415 = pro.daily(start_date='',end_date='',trade_date='20110415', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20110415_tscode_list = list() 
for ts_code_sh in daily_20110415['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20110415_tscode_list.append(stock_name)
daily_20110415_addname_dataframe=pd.DataFrame()
daily_20110415_addname_dataframe['cname'] = daily_20110415_tscode_list
for table_name in daily_20110415.columns.values.tolist():
    daily_20110415_addname_dataframe[table_name] = daily_20110415[table_name]
print("日线行情-时间为序  daily_20110415 返回数据 row 行数 = "+str(daily_20110415.shape[0]))
daily_20110415_addname_dataframe.to_excel(daily_201104_excel_writer,'15_5',index=False)
daily_201104_excel_writer.save()
daily_20110418 = pro.daily(start_date='',end_date='',trade_date='20110418', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20110418_tscode_list = list() 
for ts_code_sh in daily_20110418['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20110418_tscode_list.append(stock_name)
daily_20110418_addname_dataframe=pd.DataFrame()
daily_20110418_addname_dataframe['cname'] = daily_20110418_tscode_list
for table_name in daily_20110418.columns.values.tolist():
    daily_20110418_addname_dataframe[table_name] = daily_20110418[table_name]
print("日线行情-时间为序  daily_20110418 返回数据 row 行数 = "+str(daily_20110418.shape[0]))
daily_20110418_addname_dataframe.to_excel(daily_201104_excel_writer,'18_1',index=False)
daily_201104_excel_writer.save()
daily_20110419 = pro.daily(start_date='',end_date='',trade_date='20110419', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20110419_tscode_list = list() 
for ts_code_sh in daily_20110419['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20110419_tscode_list.append(stock_name)
daily_20110419_addname_dataframe=pd.DataFrame()
daily_20110419_addname_dataframe['cname'] = daily_20110419_tscode_list
for table_name in daily_20110419.columns.values.tolist():
    daily_20110419_addname_dataframe[table_name] = daily_20110419[table_name]
print("日线行情-时间为序  daily_20110419 返回数据 row 行数 = "+str(daily_20110419.shape[0]))
daily_20110419_addname_dataframe.to_excel(daily_201104_excel_writer,'19_2',index=False)
daily_201104_excel_writer.save()
daily_20110420 = pro.daily(start_date='',end_date='',trade_date='20110420', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20110420_tscode_list = list() 
for ts_code_sh in daily_20110420['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20110420_tscode_list.append(stock_name)
daily_20110420_addname_dataframe=pd.DataFrame()
daily_20110420_addname_dataframe['cname'] = daily_20110420_tscode_list
for table_name in daily_20110420.columns.values.tolist():
    daily_20110420_addname_dataframe[table_name] = daily_20110420[table_name]
print("日线行情-时间为序  daily_20110420 返回数据 row 行数 = "+str(daily_20110420.shape[0]))
daily_20110420_addname_dataframe.to_excel(daily_201104_excel_writer,'20_3',index=False)
daily_201104_excel_writer.save()
daily_20110421 = pro.daily(start_date='',end_date='',trade_date='20110421', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20110421_tscode_list = list() 
for ts_code_sh in daily_20110421['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20110421_tscode_list.append(stock_name)
daily_20110421_addname_dataframe=pd.DataFrame()
daily_20110421_addname_dataframe['cname'] = daily_20110421_tscode_list
for table_name in daily_20110421.columns.values.tolist():
    daily_20110421_addname_dataframe[table_name] = daily_20110421[table_name]
print("日线行情-时间为序  daily_20110421 返回数据 row 行数 = "+str(daily_20110421.shape[0]))
daily_20110421_addname_dataframe.to_excel(daily_201104_excel_writer,'21_4',index=False)
daily_201104_excel_writer.save()
daily_20110422 = pro.daily(start_date='',end_date='',trade_date='20110422', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20110422_tscode_list = list() 
for ts_code_sh in daily_20110422['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20110422_tscode_list.append(stock_name)
daily_20110422_addname_dataframe=pd.DataFrame()
daily_20110422_addname_dataframe['cname'] = daily_20110422_tscode_list
for table_name in daily_20110422.columns.values.tolist():
    daily_20110422_addname_dataframe[table_name] = daily_20110422[table_name]
print("日线行情-时间为序  daily_20110422 返回数据 row 行数 = "+str(daily_20110422.shape[0]))
daily_20110422_addname_dataframe.to_excel(daily_201104_excel_writer,'22_5',index=False)
daily_201104_excel_writer.save()
daily_20110425 = pro.daily(start_date='',end_date='',trade_date='20110425', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20110425_tscode_list = list() 
for ts_code_sh in daily_20110425['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20110425_tscode_list.append(stock_name)
daily_20110425_addname_dataframe=pd.DataFrame()
daily_20110425_addname_dataframe['cname'] = daily_20110425_tscode_list
for table_name in daily_20110425.columns.values.tolist():
    daily_20110425_addname_dataframe[table_name] = daily_20110425[table_name]
print("日线行情-时间为序  daily_20110425 返回数据 row 行数 = "+str(daily_20110425.shape[0]))
daily_20110425_addname_dataframe.to_excel(daily_201104_excel_writer,'25_1',index=False)
daily_201104_excel_writer.save()
daily_20110426 = pro.daily(start_date='',end_date='',trade_date='20110426', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20110426_tscode_list = list() 
for ts_code_sh in daily_20110426['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20110426_tscode_list.append(stock_name)
daily_20110426_addname_dataframe=pd.DataFrame()
daily_20110426_addname_dataframe['cname'] = daily_20110426_tscode_list
for table_name in daily_20110426.columns.values.tolist():
    daily_20110426_addname_dataframe[table_name] = daily_20110426[table_name]
print("日线行情-时间为序  daily_20110426 返回数据 row 行数 = "+str(daily_20110426.shape[0]))
daily_20110426_addname_dataframe.to_excel(daily_201104_excel_writer,'26_2',index=False)
daily_201104_excel_writer.save()
daily_20110427 = pro.daily(start_date='',end_date='',trade_date='20110427', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20110427_tscode_list = list() 
for ts_code_sh in daily_20110427['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20110427_tscode_list.append(stock_name)
daily_20110427_addname_dataframe=pd.DataFrame()
daily_20110427_addname_dataframe['cname'] = daily_20110427_tscode_list
for table_name in daily_20110427.columns.values.tolist():
    daily_20110427_addname_dataframe[table_name] = daily_20110427[table_name]
print("日线行情-时间为序  daily_20110427 返回数据 row 行数 = "+str(daily_20110427.shape[0]))
daily_20110427_addname_dataframe.to_excel(daily_201104_excel_writer,'27_3',index=False)
daily_201104_excel_writer.save()
daily_20110428 = pro.daily(start_date='',end_date='',trade_date='20110428', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20110428_tscode_list = list() 
for ts_code_sh in daily_20110428['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20110428_tscode_list.append(stock_name)
daily_20110428_addname_dataframe=pd.DataFrame()
daily_20110428_addname_dataframe['cname'] = daily_20110428_tscode_list
for table_name in daily_20110428.columns.values.tolist():
    daily_20110428_addname_dataframe[table_name] = daily_20110428[table_name]
print("日线行情-时间为序  daily_20110428 返回数据 row 行数 = "+str(daily_20110428.shape[0]))
daily_20110428_addname_dataframe.to_excel(daily_201104_excel_writer,'28_4',index=False)
daily_201104_excel_writer.save()
daily_20110429 = pro.daily(start_date='',end_date='',trade_date='20110429', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20110429_tscode_list = list() 
for ts_code_sh in daily_20110429['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20110429_tscode_list.append(stock_name)
daily_20110429_addname_dataframe=pd.DataFrame()
daily_20110429_addname_dataframe['cname'] = daily_20110429_tscode_list
for table_name in daily_20110429.columns.values.tolist():
    daily_20110429_addname_dataframe[table_name] = daily_20110429[table_name]
print("日线行情-时间为序  daily_20110429 返回数据 row 行数 = "+str(daily_20110429.shape[0]))
daily_20110429_addname_dataframe.to_excel(daily_201104_excel_writer,'29_5',index=False)
daily_201104_excel_writer.save()




createexcel('daily_201105.xlsx')
daily_201105_book = load_workbook('C:\\Users\\zhuzj5\\Desktop\\zbin\\J0_Data\\daily_201105.xlsx')
daily_201105_excel_writer = pd.ExcelWriter('C:\\Users\\zhuzj5\\Desktop\\zbin\\J0_Data\\daily_201105.xlsx', engine='openpyxl')
daily_201105_excel_writer.book = daily_201105_book
daily_201105_excel_writer.sheets = dict((ws.title, ws) for ws in daily_201105_book.worksheets)
J0_PROPS.put(tree_node_name+"record_date", "20110501")       ###  更新 记录日期
daily_20110503 = pro.daily(start_date='',end_date='',trade_date='20110503', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20110503_tscode_list = list() 
for ts_code_sh in daily_20110503['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20110503_tscode_list.append(stock_name)
daily_20110503_addname_dataframe=pd.DataFrame()
daily_20110503_addname_dataframe['cname'] = daily_20110503_tscode_list
for table_name in daily_20110503.columns.values.tolist():
    daily_20110503_addname_dataframe[table_name] = daily_20110503[table_name]
print("日线行情-时间为序  daily_20110503 返回数据 row 行数 = "+str(daily_20110503.shape[0]))
daily_20110503_addname_dataframe.to_excel(daily_201105_excel_writer,'3_2',index=False)
daily_201105_excel_writer.save()
daily_20110504 = pro.daily(start_date='',end_date='',trade_date='20110504', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20110504_tscode_list = list() 
for ts_code_sh in daily_20110504['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20110504_tscode_list.append(stock_name)
daily_20110504_addname_dataframe=pd.DataFrame()
daily_20110504_addname_dataframe['cname'] = daily_20110504_tscode_list
for table_name in daily_20110504.columns.values.tolist():
    daily_20110504_addname_dataframe[table_name] = daily_20110504[table_name]
print("日线行情-时间为序  daily_20110504 返回数据 row 行数 = "+str(daily_20110504.shape[0]))
daily_20110504_addname_dataframe.to_excel(daily_201105_excel_writer,'4_3',index=False)
daily_201105_excel_writer.save()
daily_20110505 = pro.daily(start_date='',end_date='',trade_date='20110505', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20110505_tscode_list = list() 
for ts_code_sh in daily_20110505['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20110505_tscode_list.append(stock_name)
daily_20110505_addname_dataframe=pd.DataFrame()
daily_20110505_addname_dataframe['cname'] = daily_20110505_tscode_list
for table_name in daily_20110505.columns.values.tolist():
    daily_20110505_addname_dataframe[table_name] = daily_20110505[table_name]
print("日线行情-时间为序  daily_20110505 返回数据 row 行数 = "+str(daily_20110505.shape[0]))
daily_20110505_addname_dataframe.to_excel(daily_201105_excel_writer,'5_4',index=False)
daily_201105_excel_writer.save()
daily_20110506 = pro.daily(start_date='',end_date='',trade_date='20110506', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20110506_tscode_list = list() 
for ts_code_sh in daily_20110506['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20110506_tscode_list.append(stock_name)
daily_20110506_addname_dataframe=pd.DataFrame()
daily_20110506_addname_dataframe['cname'] = daily_20110506_tscode_list
for table_name in daily_20110506.columns.values.tolist():
    daily_20110506_addname_dataframe[table_name] = daily_20110506[table_name]
print("日线行情-时间为序  daily_20110506 返回数据 row 行数 = "+str(daily_20110506.shape[0]))
daily_20110506_addname_dataframe.to_excel(daily_201105_excel_writer,'6_5',index=False)
daily_201105_excel_writer.save()
daily_20110509 = pro.daily(start_date='',end_date='',trade_date='20110509', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20110509_tscode_list = list() 
for ts_code_sh in daily_20110509['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20110509_tscode_list.append(stock_name)
daily_20110509_addname_dataframe=pd.DataFrame()
daily_20110509_addname_dataframe['cname'] = daily_20110509_tscode_list
for table_name in daily_20110509.columns.values.tolist():
    daily_20110509_addname_dataframe[table_name] = daily_20110509[table_name]
print("日线行情-时间为序  daily_20110509 返回数据 row 行数 = "+str(daily_20110509.shape[0]))
daily_20110509_addname_dataframe.to_excel(daily_201105_excel_writer,'9_1',index=False)
daily_201105_excel_writer.save()
daily_20110510 = pro.daily(start_date='',end_date='',trade_date='20110510', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20110510_tscode_list = list() 
for ts_code_sh in daily_20110510['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20110510_tscode_list.append(stock_name)
daily_20110510_addname_dataframe=pd.DataFrame()
daily_20110510_addname_dataframe['cname'] = daily_20110510_tscode_list
for table_name in daily_20110510.columns.values.tolist():
    daily_20110510_addname_dataframe[table_name] = daily_20110510[table_name]
print("日线行情-时间为序  daily_20110510 返回数据 row 行数 = "+str(daily_20110510.shape[0]))
daily_20110510_addname_dataframe.to_excel(daily_201105_excel_writer,'10_2',index=False)
daily_201105_excel_writer.save()
daily_20110511 = pro.daily(start_date='',end_date='',trade_date='20110511', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20110511_tscode_list = list() 
for ts_code_sh in daily_20110511['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20110511_tscode_list.append(stock_name)
daily_20110511_addname_dataframe=pd.DataFrame()
daily_20110511_addname_dataframe['cname'] = daily_20110511_tscode_list
for table_name in daily_20110511.columns.values.tolist():
    daily_20110511_addname_dataframe[table_name] = daily_20110511[table_name]
print("日线行情-时间为序  daily_20110511 返回数据 row 行数 = "+str(daily_20110511.shape[0]))
daily_20110511_addname_dataframe.to_excel(daily_201105_excel_writer,'11_3',index=False)
daily_201105_excel_writer.save()
daily_20110512 = pro.daily(start_date='',end_date='',trade_date='20110512', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20110512_tscode_list = list() 
for ts_code_sh in daily_20110512['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20110512_tscode_list.append(stock_name)
daily_20110512_addname_dataframe=pd.DataFrame()
daily_20110512_addname_dataframe['cname'] = daily_20110512_tscode_list
for table_name in daily_20110512.columns.values.tolist():
    daily_20110512_addname_dataframe[table_name] = daily_20110512[table_name]
print("日线行情-时间为序  daily_20110512 返回数据 row 行数 = "+str(daily_20110512.shape[0]))
daily_20110512_addname_dataframe.to_excel(daily_201105_excel_writer,'12_4',index=False)
daily_201105_excel_writer.save()
daily_20110513 = pro.daily(start_date='',end_date='',trade_date='20110513', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20110513_tscode_list = list() 
for ts_code_sh in daily_20110513['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20110513_tscode_list.append(stock_name)
daily_20110513_addname_dataframe=pd.DataFrame()
daily_20110513_addname_dataframe['cname'] = daily_20110513_tscode_list
for table_name in daily_20110513.columns.values.tolist():
    daily_20110513_addname_dataframe[table_name] = daily_20110513[table_name]
print("日线行情-时间为序  daily_20110513 返回数据 row 行数 = "+str(daily_20110513.shape[0]))
daily_20110513_addname_dataframe.to_excel(daily_201105_excel_writer,'13_5',index=False)
daily_201105_excel_writer.save()
daily_20110516 = pro.daily(start_date='',end_date='',trade_date='20110516', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20110516_tscode_list = list() 
for ts_code_sh in daily_20110516['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20110516_tscode_list.append(stock_name)
daily_20110516_addname_dataframe=pd.DataFrame()
daily_20110516_addname_dataframe['cname'] = daily_20110516_tscode_list
for table_name in daily_20110516.columns.values.tolist():
    daily_20110516_addname_dataframe[table_name] = daily_20110516[table_name]
print("日线行情-时间为序  daily_20110516 返回数据 row 行数 = "+str(daily_20110516.shape[0]))
daily_20110516_addname_dataframe.to_excel(daily_201105_excel_writer,'16_1',index=False)
daily_201105_excel_writer.save()
daily_20110517 = pro.daily(start_date='',end_date='',trade_date='20110517', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20110517_tscode_list = list() 
for ts_code_sh in daily_20110517['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20110517_tscode_list.append(stock_name)
daily_20110517_addname_dataframe=pd.DataFrame()
daily_20110517_addname_dataframe['cname'] = daily_20110517_tscode_list
for table_name in daily_20110517.columns.values.tolist():
    daily_20110517_addname_dataframe[table_name] = daily_20110517[table_name]
print("日线行情-时间为序  daily_20110517 返回数据 row 行数 = "+str(daily_20110517.shape[0]))
daily_20110517_addname_dataframe.to_excel(daily_201105_excel_writer,'17_2',index=False)
daily_201105_excel_writer.save()
daily_20110518 = pro.daily(start_date='',end_date='',trade_date='20110518', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20110518_tscode_list = list() 
for ts_code_sh in daily_20110518['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20110518_tscode_list.append(stock_name)
daily_20110518_addname_dataframe=pd.DataFrame()
daily_20110518_addname_dataframe['cname'] = daily_20110518_tscode_list
for table_name in daily_20110518.columns.values.tolist():
    daily_20110518_addname_dataframe[table_name] = daily_20110518[table_name]
print("日线行情-时间为序  daily_20110518 返回数据 row 行数 = "+str(daily_20110518.shape[0]))
daily_20110518_addname_dataframe.to_excel(daily_201105_excel_writer,'18_3',index=False)
daily_201105_excel_writer.save()
daily_20110519 = pro.daily(start_date='',end_date='',trade_date='20110519', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20110519_tscode_list = list() 
for ts_code_sh in daily_20110519['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20110519_tscode_list.append(stock_name)
daily_20110519_addname_dataframe=pd.DataFrame()
daily_20110519_addname_dataframe['cname'] = daily_20110519_tscode_list
for table_name in daily_20110519.columns.values.tolist():
    daily_20110519_addname_dataframe[table_name] = daily_20110519[table_name]
print("日线行情-时间为序  daily_20110519 返回数据 row 行数 = "+str(daily_20110519.shape[0]))
daily_20110519_addname_dataframe.to_excel(daily_201105_excel_writer,'19_4',index=False)
daily_201105_excel_writer.save()
daily_20110520 = pro.daily(start_date='',end_date='',trade_date='20110520', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20110520_tscode_list = list() 
for ts_code_sh in daily_20110520['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20110520_tscode_list.append(stock_name)
daily_20110520_addname_dataframe=pd.DataFrame()
daily_20110520_addname_dataframe['cname'] = daily_20110520_tscode_list
for table_name in daily_20110520.columns.values.tolist():
    daily_20110520_addname_dataframe[table_name] = daily_20110520[table_name]
print("日线行情-时间为序  daily_20110520 返回数据 row 行数 = "+str(daily_20110520.shape[0]))
daily_20110520_addname_dataframe.to_excel(daily_201105_excel_writer,'20_5',index=False)
daily_201105_excel_writer.save()
daily_20110523 = pro.daily(start_date='',end_date='',trade_date='20110523', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20110523_tscode_list = list() 
for ts_code_sh in daily_20110523['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20110523_tscode_list.append(stock_name)
daily_20110523_addname_dataframe=pd.DataFrame()
daily_20110523_addname_dataframe['cname'] = daily_20110523_tscode_list
for table_name in daily_20110523.columns.values.tolist():
    daily_20110523_addname_dataframe[table_name] = daily_20110523[table_name]
print("日线行情-时间为序  daily_20110523 返回数据 row 行数 = "+str(daily_20110523.shape[0]))
daily_20110523_addname_dataframe.to_excel(daily_201105_excel_writer,'23_1',index=False)
daily_201105_excel_writer.save()
daily_20110524 = pro.daily(start_date='',end_date='',trade_date='20110524', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20110524_tscode_list = list() 
for ts_code_sh in daily_20110524['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20110524_tscode_list.append(stock_name)
daily_20110524_addname_dataframe=pd.DataFrame()
daily_20110524_addname_dataframe['cname'] = daily_20110524_tscode_list
for table_name in daily_20110524.columns.values.tolist():
    daily_20110524_addname_dataframe[table_name] = daily_20110524[table_name]
print("日线行情-时间为序  daily_20110524 返回数据 row 行数 = "+str(daily_20110524.shape[0]))
daily_20110524_addname_dataframe.to_excel(daily_201105_excel_writer,'24_2',index=False)
daily_201105_excel_writer.save()
daily_20110525 = pro.daily(start_date='',end_date='',trade_date='20110525', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20110525_tscode_list = list() 
for ts_code_sh in daily_20110525['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20110525_tscode_list.append(stock_name)
daily_20110525_addname_dataframe=pd.DataFrame()
daily_20110525_addname_dataframe['cname'] = daily_20110525_tscode_list
for table_name in daily_20110525.columns.values.tolist():
    daily_20110525_addname_dataframe[table_name] = daily_20110525[table_name]
print("日线行情-时间为序  daily_20110525 返回数据 row 行数 = "+str(daily_20110525.shape[0]))
daily_20110525_addname_dataframe.to_excel(daily_201105_excel_writer,'25_3',index=False)
daily_201105_excel_writer.save()
daily_20110526 = pro.daily(start_date='',end_date='',trade_date='20110526', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20110526_tscode_list = list() 
for ts_code_sh in daily_20110526['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20110526_tscode_list.append(stock_name)
daily_20110526_addname_dataframe=pd.DataFrame()
daily_20110526_addname_dataframe['cname'] = daily_20110526_tscode_list
for table_name in daily_20110526.columns.values.tolist():
    daily_20110526_addname_dataframe[table_name] = daily_20110526[table_name]
print("日线行情-时间为序  daily_20110526 返回数据 row 行数 = "+str(daily_20110526.shape[0]))
daily_20110526_addname_dataframe.to_excel(daily_201105_excel_writer,'26_4',index=False)
daily_201105_excel_writer.save()
daily_20110527 = pro.daily(start_date='',end_date='',trade_date='20110527', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20110527_tscode_list = list() 
for ts_code_sh in daily_20110527['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20110527_tscode_list.append(stock_name)
daily_20110527_addname_dataframe=pd.DataFrame()
daily_20110527_addname_dataframe['cname'] = daily_20110527_tscode_list
for table_name in daily_20110527.columns.values.tolist():
    daily_20110527_addname_dataframe[table_name] = daily_20110527[table_name]
print("日线行情-时间为序  daily_20110527 返回数据 row 行数 = "+str(daily_20110527.shape[0]))
daily_20110527_addname_dataframe.to_excel(daily_201105_excel_writer,'27_5',index=False)
daily_201105_excel_writer.save()
daily_20110530 = pro.daily(start_date='',end_date='',trade_date='20110530', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20110530_tscode_list = list() 
for ts_code_sh in daily_20110530['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20110530_tscode_list.append(stock_name)
daily_20110530_addname_dataframe=pd.DataFrame()
daily_20110530_addname_dataframe['cname'] = daily_20110530_tscode_list
for table_name in daily_20110530.columns.values.tolist():
    daily_20110530_addname_dataframe[table_name] = daily_20110530[table_name]
print("日线行情-时间为序  daily_20110530 返回数据 row 行数 = "+str(daily_20110530.shape[0]))
daily_20110530_addname_dataframe.to_excel(daily_201105_excel_writer,'30_1',index=False)
daily_201105_excel_writer.save()
daily_20110531 = pro.daily(start_date='',end_date='',trade_date='20110531', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20110531_tscode_list = list() 
for ts_code_sh in daily_20110531['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20110531_tscode_list.append(stock_name)
daily_20110531_addname_dataframe=pd.DataFrame()
daily_20110531_addname_dataframe['cname'] = daily_20110531_tscode_list
for table_name in daily_20110531.columns.values.tolist():
    daily_20110531_addname_dataframe[table_name] = daily_20110531[table_name]
print("日线行情-时间为序  daily_20110531 返回数据 row 行数 = "+str(daily_20110531.shape[0]))
daily_20110531_addname_dataframe.to_excel(daily_201105_excel_writer,'31_2',index=False)
daily_201105_excel_writer.save()




createexcel('daily_201106.xlsx')
daily_201106_book = load_workbook('C:\\Users\\zhuzj5\\Desktop\\zbin\\J0_Data\\daily_201106.xlsx')
daily_201106_excel_writer = pd.ExcelWriter('C:\\Users\\zhuzj5\\Desktop\\zbin\\J0_Data\\daily_201106.xlsx', engine='openpyxl')
daily_201106_excel_writer.book = daily_201106_book
daily_201106_excel_writer.sheets = dict((ws.title, ws) for ws in daily_201106_book.worksheets)
J0_PROPS.put(tree_node_name+"record_date", "20110601")       ###  更新 记录日期
daily_20110601 = pro.daily(start_date='',end_date='',trade_date='20110601', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20110601_tscode_list = list() 
for ts_code_sh in daily_20110601['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20110601_tscode_list.append(stock_name)
daily_20110601_addname_dataframe=pd.DataFrame()
daily_20110601_addname_dataframe['cname'] = daily_20110601_tscode_list
for table_name in daily_20110601.columns.values.tolist():
    daily_20110601_addname_dataframe[table_name] = daily_20110601[table_name]
print("日线行情-时间为序  daily_20110601 返回数据 row 行数 = "+str(daily_20110601.shape[0]))
daily_20110601_addname_dataframe.to_excel(daily_201106_excel_writer,'1_3',index=False)
daily_201106_excel_writer.save()
daily_20110602 = pro.daily(start_date='',end_date='',trade_date='20110602', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20110602_tscode_list = list() 
for ts_code_sh in daily_20110602['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20110602_tscode_list.append(stock_name)
daily_20110602_addname_dataframe=pd.DataFrame()
daily_20110602_addname_dataframe['cname'] = daily_20110602_tscode_list
for table_name in daily_20110602.columns.values.tolist():
    daily_20110602_addname_dataframe[table_name] = daily_20110602[table_name]
print("日线行情-时间为序  daily_20110602 返回数据 row 行数 = "+str(daily_20110602.shape[0]))
daily_20110602_addname_dataframe.to_excel(daily_201106_excel_writer,'2_4',index=False)
daily_201106_excel_writer.save()
daily_20110603 = pro.daily(start_date='',end_date='',trade_date='20110603', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20110603_tscode_list = list() 
for ts_code_sh in daily_20110603['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20110603_tscode_list.append(stock_name)
daily_20110603_addname_dataframe=pd.DataFrame()
daily_20110603_addname_dataframe['cname'] = daily_20110603_tscode_list
for table_name in daily_20110603.columns.values.tolist():
    daily_20110603_addname_dataframe[table_name] = daily_20110603[table_name]
print("日线行情-时间为序  daily_20110603 返回数据 row 行数 = "+str(daily_20110603.shape[0]))
daily_20110603_addname_dataframe.to_excel(daily_201106_excel_writer,'3_5',index=False)
daily_201106_excel_writer.save()
daily_20110607 = pro.daily(start_date='',end_date='',trade_date='20110607', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20110607_tscode_list = list() 
for ts_code_sh in daily_20110607['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20110607_tscode_list.append(stock_name)
daily_20110607_addname_dataframe=pd.DataFrame()
daily_20110607_addname_dataframe['cname'] = daily_20110607_tscode_list
for table_name in daily_20110607.columns.values.tolist():
    daily_20110607_addname_dataframe[table_name] = daily_20110607[table_name]
print("日线行情-时间为序  daily_20110607 返回数据 row 行数 = "+str(daily_20110607.shape[0]))
daily_20110607_addname_dataframe.to_excel(daily_201106_excel_writer,'7_2',index=False)
daily_201106_excel_writer.save()
daily_20110608 = pro.daily(start_date='',end_date='',trade_date='20110608', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20110608_tscode_list = list() 
for ts_code_sh in daily_20110608['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20110608_tscode_list.append(stock_name)
daily_20110608_addname_dataframe=pd.DataFrame()
daily_20110608_addname_dataframe['cname'] = daily_20110608_tscode_list
for table_name in daily_20110608.columns.values.tolist():
    daily_20110608_addname_dataframe[table_name] = daily_20110608[table_name]
print("日线行情-时间为序  daily_20110608 返回数据 row 行数 = "+str(daily_20110608.shape[0]))
daily_20110608_addname_dataframe.to_excel(daily_201106_excel_writer,'8_3',index=False)
daily_201106_excel_writer.save()
daily_20110609 = pro.daily(start_date='',end_date='',trade_date='20110609', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20110609_tscode_list = list() 
for ts_code_sh in daily_20110609['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20110609_tscode_list.append(stock_name)
daily_20110609_addname_dataframe=pd.DataFrame()
daily_20110609_addname_dataframe['cname'] = daily_20110609_tscode_list
for table_name in daily_20110609.columns.values.tolist():
    daily_20110609_addname_dataframe[table_name] = daily_20110609[table_name]
print("日线行情-时间为序  daily_20110609 返回数据 row 行数 = "+str(daily_20110609.shape[0]))
daily_20110609_addname_dataframe.to_excel(daily_201106_excel_writer,'9_4',index=False)
daily_201106_excel_writer.save()
daily_20110610 = pro.daily(start_date='',end_date='',trade_date='20110610', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20110610_tscode_list = list() 
for ts_code_sh in daily_20110610['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20110610_tscode_list.append(stock_name)
daily_20110610_addname_dataframe=pd.DataFrame()
daily_20110610_addname_dataframe['cname'] = daily_20110610_tscode_list
for table_name in daily_20110610.columns.values.tolist():
    daily_20110610_addname_dataframe[table_name] = daily_20110610[table_name]
print("日线行情-时间为序  daily_20110610 返回数据 row 行数 = "+str(daily_20110610.shape[0]))
daily_20110610_addname_dataframe.to_excel(daily_201106_excel_writer,'10_5',index=False)
daily_201106_excel_writer.save()
daily_20110613 = pro.daily(start_date='',end_date='',trade_date='20110613', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20110613_tscode_list = list() 
for ts_code_sh in daily_20110613['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20110613_tscode_list.append(stock_name)
daily_20110613_addname_dataframe=pd.DataFrame()
daily_20110613_addname_dataframe['cname'] = daily_20110613_tscode_list
for table_name in daily_20110613.columns.values.tolist():
    daily_20110613_addname_dataframe[table_name] = daily_20110613[table_name]
print("日线行情-时间为序  daily_20110613 返回数据 row 行数 = "+str(daily_20110613.shape[0]))
daily_20110613_addname_dataframe.to_excel(daily_201106_excel_writer,'13_1',index=False)
daily_201106_excel_writer.save()
daily_20110614 = pro.daily(start_date='',end_date='',trade_date='20110614', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20110614_tscode_list = list() 
for ts_code_sh in daily_20110614['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20110614_tscode_list.append(stock_name)
daily_20110614_addname_dataframe=pd.DataFrame()
daily_20110614_addname_dataframe['cname'] = daily_20110614_tscode_list
for table_name in daily_20110614.columns.values.tolist():
    daily_20110614_addname_dataframe[table_name] = daily_20110614[table_name]
print("日线行情-时间为序  daily_20110614 返回数据 row 行数 = "+str(daily_20110614.shape[0]))
daily_20110614_addname_dataframe.to_excel(daily_201106_excel_writer,'14_2',index=False)
daily_201106_excel_writer.save()
daily_20110615 = pro.daily(start_date='',end_date='',trade_date='20110615', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20110615_tscode_list = list() 
for ts_code_sh in daily_20110615['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20110615_tscode_list.append(stock_name)
daily_20110615_addname_dataframe=pd.DataFrame()
daily_20110615_addname_dataframe['cname'] = daily_20110615_tscode_list
for table_name in daily_20110615.columns.values.tolist():
    daily_20110615_addname_dataframe[table_name] = daily_20110615[table_name]
print("日线行情-时间为序  daily_20110615 返回数据 row 行数 = "+str(daily_20110615.shape[0]))
daily_20110615_addname_dataframe.to_excel(daily_201106_excel_writer,'15_3',index=False)
daily_201106_excel_writer.save()
daily_20110616 = pro.daily(start_date='',end_date='',trade_date='20110616', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20110616_tscode_list = list() 
for ts_code_sh in daily_20110616['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20110616_tscode_list.append(stock_name)
daily_20110616_addname_dataframe=pd.DataFrame()
daily_20110616_addname_dataframe['cname'] = daily_20110616_tscode_list
for table_name in daily_20110616.columns.values.tolist():
    daily_20110616_addname_dataframe[table_name] = daily_20110616[table_name]
print("日线行情-时间为序  daily_20110616 返回数据 row 行数 = "+str(daily_20110616.shape[0]))
daily_20110616_addname_dataframe.to_excel(daily_201106_excel_writer,'16_4',index=False)
daily_201106_excel_writer.save()
daily_20110617 = pro.daily(start_date='',end_date='',trade_date='20110617', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20110617_tscode_list = list() 
for ts_code_sh in daily_20110617['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20110617_tscode_list.append(stock_name)
daily_20110617_addname_dataframe=pd.DataFrame()
daily_20110617_addname_dataframe['cname'] = daily_20110617_tscode_list
for table_name in daily_20110617.columns.values.tolist():
    daily_20110617_addname_dataframe[table_name] = daily_20110617[table_name]
print("日线行情-时间为序  daily_20110617 返回数据 row 行数 = "+str(daily_20110617.shape[0]))
daily_20110617_addname_dataframe.to_excel(daily_201106_excel_writer,'17_5',index=False)
daily_201106_excel_writer.save()
daily_20110620 = pro.daily(start_date='',end_date='',trade_date='20110620', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20110620_tscode_list = list() 
for ts_code_sh in daily_20110620['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20110620_tscode_list.append(stock_name)
daily_20110620_addname_dataframe=pd.DataFrame()
daily_20110620_addname_dataframe['cname'] = daily_20110620_tscode_list
for table_name in daily_20110620.columns.values.tolist():
    daily_20110620_addname_dataframe[table_name] = daily_20110620[table_name]
print("日线行情-时间为序  daily_20110620 返回数据 row 行数 = "+str(daily_20110620.shape[0]))
daily_20110620_addname_dataframe.to_excel(daily_201106_excel_writer,'20_1',index=False)
daily_201106_excel_writer.save()
daily_20110621 = pro.daily(start_date='',end_date='',trade_date='20110621', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20110621_tscode_list = list() 
for ts_code_sh in daily_20110621['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20110621_tscode_list.append(stock_name)
daily_20110621_addname_dataframe=pd.DataFrame()
daily_20110621_addname_dataframe['cname'] = daily_20110621_tscode_list
for table_name in daily_20110621.columns.values.tolist():
    daily_20110621_addname_dataframe[table_name] = daily_20110621[table_name]
print("日线行情-时间为序  daily_20110621 返回数据 row 行数 = "+str(daily_20110621.shape[0]))
daily_20110621_addname_dataframe.to_excel(daily_201106_excel_writer,'21_2',index=False)
daily_201106_excel_writer.save()
daily_20110622 = pro.daily(start_date='',end_date='',trade_date='20110622', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20110622_tscode_list = list() 
for ts_code_sh in daily_20110622['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20110622_tscode_list.append(stock_name)
daily_20110622_addname_dataframe=pd.DataFrame()
daily_20110622_addname_dataframe['cname'] = daily_20110622_tscode_list
for table_name in daily_20110622.columns.values.tolist():
    daily_20110622_addname_dataframe[table_name] = daily_20110622[table_name]
print("日线行情-时间为序  daily_20110622 返回数据 row 行数 = "+str(daily_20110622.shape[0]))
daily_20110622_addname_dataframe.to_excel(daily_201106_excel_writer,'22_3',index=False)
daily_201106_excel_writer.save()
daily_20110623 = pro.daily(start_date='',end_date='',trade_date='20110623', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20110623_tscode_list = list() 
for ts_code_sh in daily_20110623['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20110623_tscode_list.append(stock_name)
daily_20110623_addname_dataframe=pd.DataFrame()
daily_20110623_addname_dataframe['cname'] = daily_20110623_tscode_list
for table_name in daily_20110623.columns.values.tolist():
    daily_20110623_addname_dataframe[table_name] = daily_20110623[table_name]
print("日线行情-时间为序  daily_20110623 返回数据 row 行数 = "+str(daily_20110623.shape[0]))
daily_20110623_addname_dataframe.to_excel(daily_201106_excel_writer,'23_4',index=False)
daily_201106_excel_writer.save()
daily_20110624 = pro.daily(start_date='',end_date='',trade_date='20110624', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20110624_tscode_list = list() 
for ts_code_sh in daily_20110624['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20110624_tscode_list.append(stock_name)
daily_20110624_addname_dataframe=pd.DataFrame()
daily_20110624_addname_dataframe['cname'] = daily_20110624_tscode_list
for table_name in daily_20110624.columns.values.tolist():
    daily_20110624_addname_dataframe[table_name] = daily_20110624[table_name]
print("日线行情-时间为序  daily_20110624 返回数据 row 行数 = "+str(daily_20110624.shape[0]))
daily_20110624_addname_dataframe.to_excel(daily_201106_excel_writer,'24_5',index=False)
daily_201106_excel_writer.save()
daily_20110627 = pro.daily(start_date='',end_date='',trade_date='20110627', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20110627_tscode_list = list() 
for ts_code_sh in daily_20110627['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20110627_tscode_list.append(stock_name)
daily_20110627_addname_dataframe=pd.DataFrame()
daily_20110627_addname_dataframe['cname'] = daily_20110627_tscode_list
for table_name in daily_20110627.columns.values.tolist():
    daily_20110627_addname_dataframe[table_name] = daily_20110627[table_name]
print("日线行情-时间为序  daily_20110627 返回数据 row 行数 = "+str(daily_20110627.shape[0]))
daily_20110627_addname_dataframe.to_excel(daily_201106_excel_writer,'27_1',index=False)
daily_201106_excel_writer.save()
daily_20110628 = pro.daily(start_date='',end_date='',trade_date='20110628', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20110628_tscode_list = list() 
for ts_code_sh in daily_20110628['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20110628_tscode_list.append(stock_name)
daily_20110628_addname_dataframe=pd.DataFrame()
daily_20110628_addname_dataframe['cname'] = daily_20110628_tscode_list
for table_name in daily_20110628.columns.values.tolist():
    daily_20110628_addname_dataframe[table_name] = daily_20110628[table_name]
print("日线行情-时间为序  daily_20110628 返回数据 row 行数 = "+str(daily_20110628.shape[0]))
daily_20110628_addname_dataframe.to_excel(daily_201106_excel_writer,'28_2',index=False)
daily_201106_excel_writer.save()
daily_20110629 = pro.daily(start_date='',end_date='',trade_date='20110629', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20110629_tscode_list = list() 
for ts_code_sh in daily_20110629['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20110629_tscode_list.append(stock_name)
daily_20110629_addname_dataframe=pd.DataFrame()
daily_20110629_addname_dataframe['cname'] = daily_20110629_tscode_list
for table_name in daily_20110629.columns.values.tolist():
    daily_20110629_addname_dataframe[table_name] = daily_20110629[table_name]
print("日线行情-时间为序  daily_20110629 返回数据 row 行数 = "+str(daily_20110629.shape[0]))
daily_20110629_addname_dataframe.to_excel(daily_201106_excel_writer,'29_3',index=False)
daily_201106_excel_writer.save()
daily_20110630 = pro.daily(start_date='',end_date='',trade_date='20110630', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20110630_tscode_list = list() 
for ts_code_sh in daily_20110630['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20110630_tscode_list.append(stock_name)
daily_20110630_addname_dataframe=pd.DataFrame()
daily_20110630_addname_dataframe['cname'] = daily_20110630_tscode_list
for table_name in daily_20110630.columns.values.tolist():
    daily_20110630_addname_dataframe[table_name] = daily_20110630[table_name]
print("日线行情-时间为序  daily_20110630 返回数据 row 行数 = "+str(daily_20110630.shape[0]))
daily_20110630_addname_dataframe.to_excel(daily_201106_excel_writer,'30_4',index=False)
daily_201106_excel_writer.save()




createexcel('daily_201107.xlsx')
daily_201107_book = load_workbook('C:\\Users\\zhuzj5\\Desktop\\zbin\\J0_Data\\daily_201107.xlsx')
daily_201107_excel_writer = pd.ExcelWriter('C:\\Users\\zhuzj5\\Desktop\\zbin\\J0_Data\\daily_201107.xlsx', engine='openpyxl')
daily_201107_excel_writer.book = daily_201107_book
daily_201107_excel_writer.sheets = dict((ws.title, ws) for ws in daily_201107_book.worksheets)
J0_PROPS.put(tree_node_name+"record_date", "20110701")       ###  更新 记录日期
daily_20110701 = pro.daily(start_date='',end_date='',trade_date='20110701', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20110701_tscode_list = list() 
for ts_code_sh in daily_20110701['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20110701_tscode_list.append(stock_name)
daily_20110701_addname_dataframe=pd.DataFrame()
daily_20110701_addname_dataframe['cname'] = daily_20110701_tscode_list
for table_name in daily_20110701.columns.values.tolist():
    daily_20110701_addname_dataframe[table_name] = daily_20110701[table_name]
print("日线行情-时间为序  daily_20110701 返回数据 row 行数 = "+str(daily_20110701.shape[0]))
daily_20110701_addname_dataframe.to_excel(daily_201107_excel_writer,'1_5',index=False)
daily_201107_excel_writer.save()
daily_20110704 = pro.daily(start_date='',end_date='',trade_date='20110704', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20110704_tscode_list = list() 
for ts_code_sh in daily_20110704['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20110704_tscode_list.append(stock_name)
daily_20110704_addname_dataframe=pd.DataFrame()
daily_20110704_addname_dataframe['cname'] = daily_20110704_tscode_list
for table_name in daily_20110704.columns.values.tolist():
    daily_20110704_addname_dataframe[table_name] = daily_20110704[table_name]
print("日线行情-时间为序  daily_20110704 返回数据 row 行数 = "+str(daily_20110704.shape[0]))
daily_20110704_addname_dataframe.to_excel(daily_201107_excel_writer,'4_1',index=False)
daily_201107_excel_writer.save()
daily_20110705 = pro.daily(start_date='',end_date='',trade_date='20110705', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20110705_tscode_list = list() 
for ts_code_sh in daily_20110705['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20110705_tscode_list.append(stock_name)
daily_20110705_addname_dataframe=pd.DataFrame()
daily_20110705_addname_dataframe['cname'] = daily_20110705_tscode_list
for table_name in daily_20110705.columns.values.tolist():
    daily_20110705_addname_dataframe[table_name] = daily_20110705[table_name]
print("日线行情-时间为序  daily_20110705 返回数据 row 行数 = "+str(daily_20110705.shape[0]))
daily_20110705_addname_dataframe.to_excel(daily_201107_excel_writer,'5_2',index=False)
daily_201107_excel_writer.save()
daily_20110706 = pro.daily(start_date='',end_date='',trade_date='20110706', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20110706_tscode_list = list() 
for ts_code_sh in daily_20110706['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20110706_tscode_list.append(stock_name)
daily_20110706_addname_dataframe=pd.DataFrame()
daily_20110706_addname_dataframe['cname'] = daily_20110706_tscode_list
for table_name in daily_20110706.columns.values.tolist():
    daily_20110706_addname_dataframe[table_name] = daily_20110706[table_name]
print("日线行情-时间为序  daily_20110706 返回数据 row 行数 = "+str(daily_20110706.shape[0]))
daily_20110706_addname_dataframe.to_excel(daily_201107_excel_writer,'6_3',index=False)
daily_201107_excel_writer.save()
daily_20110707 = pro.daily(start_date='',end_date='',trade_date='20110707', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20110707_tscode_list = list() 
for ts_code_sh in daily_20110707['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20110707_tscode_list.append(stock_name)
daily_20110707_addname_dataframe=pd.DataFrame()
daily_20110707_addname_dataframe['cname'] = daily_20110707_tscode_list
for table_name in daily_20110707.columns.values.tolist():
    daily_20110707_addname_dataframe[table_name] = daily_20110707[table_name]
print("日线行情-时间为序  daily_20110707 返回数据 row 行数 = "+str(daily_20110707.shape[0]))
daily_20110707_addname_dataframe.to_excel(daily_201107_excel_writer,'7_4',index=False)
daily_201107_excel_writer.save()
daily_20110708 = pro.daily(start_date='',end_date='',trade_date='20110708', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20110708_tscode_list = list() 
for ts_code_sh in daily_20110708['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20110708_tscode_list.append(stock_name)
daily_20110708_addname_dataframe=pd.DataFrame()
daily_20110708_addname_dataframe['cname'] = daily_20110708_tscode_list
for table_name in daily_20110708.columns.values.tolist():
    daily_20110708_addname_dataframe[table_name] = daily_20110708[table_name]
print("日线行情-时间为序  daily_20110708 返回数据 row 行数 = "+str(daily_20110708.shape[0]))
daily_20110708_addname_dataframe.to_excel(daily_201107_excel_writer,'8_5',index=False)
daily_201107_excel_writer.save()
daily_20110711 = pro.daily(start_date='',end_date='',trade_date='20110711', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20110711_tscode_list = list() 
for ts_code_sh in daily_20110711['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20110711_tscode_list.append(stock_name)
daily_20110711_addname_dataframe=pd.DataFrame()
daily_20110711_addname_dataframe['cname'] = daily_20110711_tscode_list
for table_name in daily_20110711.columns.values.tolist():
    daily_20110711_addname_dataframe[table_name] = daily_20110711[table_name]
print("日线行情-时间为序  daily_20110711 返回数据 row 行数 = "+str(daily_20110711.shape[0]))
daily_20110711_addname_dataframe.to_excel(daily_201107_excel_writer,'11_1',index=False)
daily_201107_excel_writer.save()
daily_20110712 = pro.daily(start_date='',end_date='',trade_date='20110712', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20110712_tscode_list = list() 
for ts_code_sh in daily_20110712['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20110712_tscode_list.append(stock_name)
daily_20110712_addname_dataframe=pd.DataFrame()
daily_20110712_addname_dataframe['cname'] = daily_20110712_tscode_list
for table_name in daily_20110712.columns.values.tolist():
    daily_20110712_addname_dataframe[table_name] = daily_20110712[table_name]
print("日线行情-时间为序  daily_20110712 返回数据 row 行数 = "+str(daily_20110712.shape[0]))
daily_20110712_addname_dataframe.to_excel(daily_201107_excel_writer,'12_2',index=False)
daily_201107_excel_writer.save()
daily_20110713 = pro.daily(start_date='',end_date='',trade_date='20110713', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20110713_tscode_list = list() 
for ts_code_sh in daily_20110713['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20110713_tscode_list.append(stock_name)
daily_20110713_addname_dataframe=pd.DataFrame()
daily_20110713_addname_dataframe['cname'] = daily_20110713_tscode_list
for table_name in daily_20110713.columns.values.tolist():
    daily_20110713_addname_dataframe[table_name] = daily_20110713[table_name]
print("日线行情-时间为序  daily_20110713 返回数据 row 行数 = "+str(daily_20110713.shape[0]))
daily_20110713_addname_dataframe.to_excel(daily_201107_excel_writer,'13_3',index=False)
daily_201107_excel_writer.save()
daily_20110714 = pro.daily(start_date='',end_date='',trade_date='20110714', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20110714_tscode_list = list() 
for ts_code_sh in daily_20110714['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20110714_tscode_list.append(stock_name)
daily_20110714_addname_dataframe=pd.DataFrame()
daily_20110714_addname_dataframe['cname'] = daily_20110714_tscode_list
for table_name in daily_20110714.columns.values.tolist():
    daily_20110714_addname_dataframe[table_name] = daily_20110714[table_name]
print("日线行情-时间为序  daily_20110714 返回数据 row 行数 = "+str(daily_20110714.shape[0]))
daily_20110714_addname_dataframe.to_excel(daily_201107_excel_writer,'14_4',index=False)
daily_201107_excel_writer.save()
daily_20110715 = pro.daily(start_date='',end_date='',trade_date='20110715', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20110715_tscode_list = list() 
for ts_code_sh in daily_20110715['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20110715_tscode_list.append(stock_name)
daily_20110715_addname_dataframe=pd.DataFrame()
daily_20110715_addname_dataframe['cname'] = daily_20110715_tscode_list
for table_name in daily_20110715.columns.values.tolist():
    daily_20110715_addname_dataframe[table_name] = daily_20110715[table_name]
print("日线行情-时间为序  daily_20110715 返回数据 row 行数 = "+str(daily_20110715.shape[0]))
daily_20110715_addname_dataframe.to_excel(daily_201107_excel_writer,'15_5',index=False)
daily_201107_excel_writer.save()
daily_20110718 = pro.daily(start_date='',end_date='',trade_date='20110718', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20110718_tscode_list = list() 
for ts_code_sh in daily_20110718['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20110718_tscode_list.append(stock_name)
daily_20110718_addname_dataframe=pd.DataFrame()
daily_20110718_addname_dataframe['cname'] = daily_20110718_tscode_list
for table_name in daily_20110718.columns.values.tolist():
    daily_20110718_addname_dataframe[table_name] = daily_20110718[table_name]
print("日线行情-时间为序  daily_20110718 返回数据 row 行数 = "+str(daily_20110718.shape[0]))
daily_20110718_addname_dataframe.to_excel(daily_201107_excel_writer,'18_1',index=False)
daily_201107_excel_writer.save()
daily_20110719 = pro.daily(start_date='',end_date='',trade_date='20110719', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20110719_tscode_list = list() 
for ts_code_sh in daily_20110719['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20110719_tscode_list.append(stock_name)
daily_20110719_addname_dataframe=pd.DataFrame()
daily_20110719_addname_dataframe['cname'] = daily_20110719_tscode_list
for table_name in daily_20110719.columns.values.tolist():
    daily_20110719_addname_dataframe[table_name] = daily_20110719[table_name]
print("日线行情-时间为序  daily_20110719 返回数据 row 行数 = "+str(daily_20110719.shape[0]))
daily_20110719_addname_dataframe.to_excel(daily_201107_excel_writer,'19_2',index=False)
daily_201107_excel_writer.save()
daily_20110720 = pro.daily(start_date='',end_date='',trade_date='20110720', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20110720_tscode_list = list() 
for ts_code_sh in daily_20110720['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20110720_tscode_list.append(stock_name)
daily_20110720_addname_dataframe=pd.DataFrame()
daily_20110720_addname_dataframe['cname'] = daily_20110720_tscode_list
for table_name in daily_20110720.columns.values.tolist():
    daily_20110720_addname_dataframe[table_name] = daily_20110720[table_name]
print("日线行情-时间为序  daily_20110720 返回数据 row 行数 = "+str(daily_20110720.shape[0]))
daily_20110720_addname_dataframe.to_excel(daily_201107_excel_writer,'20_3',index=False)
daily_201107_excel_writer.save()
daily_20110721 = pro.daily(start_date='',end_date='',trade_date='20110721', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20110721_tscode_list = list() 
for ts_code_sh in daily_20110721['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20110721_tscode_list.append(stock_name)
daily_20110721_addname_dataframe=pd.DataFrame()
daily_20110721_addname_dataframe['cname'] = daily_20110721_tscode_list
for table_name in daily_20110721.columns.values.tolist():
    daily_20110721_addname_dataframe[table_name] = daily_20110721[table_name]
print("日线行情-时间为序  daily_20110721 返回数据 row 行数 = "+str(daily_20110721.shape[0]))
daily_20110721_addname_dataframe.to_excel(daily_201107_excel_writer,'21_4',index=False)
daily_201107_excel_writer.save()
daily_20110722 = pro.daily(start_date='',end_date='',trade_date='20110722', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20110722_tscode_list = list() 
for ts_code_sh in daily_20110722['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20110722_tscode_list.append(stock_name)
daily_20110722_addname_dataframe=pd.DataFrame()
daily_20110722_addname_dataframe['cname'] = daily_20110722_tscode_list
for table_name in daily_20110722.columns.values.tolist():
    daily_20110722_addname_dataframe[table_name] = daily_20110722[table_name]
print("日线行情-时间为序  daily_20110722 返回数据 row 行数 = "+str(daily_20110722.shape[0]))
daily_20110722_addname_dataframe.to_excel(daily_201107_excel_writer,'22_5',index=False)
daily_201107_excel_writer.save()
daily_20110725 = pro.daily(start_date='',end_date='',trade_date='20110725', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20110725_tscode_list = list() 
for ts_code_sh in daily_20110725['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20110725_tscode_list.append(stock_name)
daily_20110725_addname_dataframe=pd.DataFrame()
daily_20110725_addname_dataframe['cname'] = daily_20110725_tscode_list
for table_name in daily_20110725.columns.values.tolist():
    daily_20110725_addname_dataframe[table_name] = daily_20110725[table_name]
print("日线行情-时间为序  daily_20110725 返回数据 row 行数 = "+str(daily_20110725.shape[0]))
daily_20110725_addname_dataframe.to_excel(daily_201107_excel_writer,'25_1',index=False)
daily_201107_excel_writer.save()
daily_20110726 = pro.daily(start_date='',end_date='',trade_date='20110726', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20110726_tscode_list = list() 
for ts_code_sh in daily_20110726['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20110726_tscode_list.append(stock_name)
daily_20110726_addname_dataframe=pd.DataFrame()
daily_20110726_addname_dataframe['cname'] = daily_20110726_tscode_list
for table_name in daily_20110726.columns.values.tolist():
    daily_20110726_addname_dataframe[table_name] = daily_20110726[table_name]
print("日线行情-时间为序  daily_20110726 返回数据 row 行数 = "+str(daily_20110726.shape[0]))
daily_20110726_addname_dataframe.to_excel(daily_201107_excel_writer,'26_2',index=False)
daily_201107_excel_writer.save()
daily_20110727 = pro.daily(start_date='',end_date='',trade_date='20110727', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20110727_tscode_list = list() 
for ts_code_sh in daily_20110727['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20110727_tscode_list.append(stock_name)
daily_20110727_addname_dataframe=pd.DataFrame()
daily_20110727_addname_dataframe['cname'] = daily_20110727_tscode_list
for table_name in daily_20110727.columns.values.tolist():
    daily_20110727_addname_dataframe[table_name] = daily_20110727[table_name]
print("日线行情-时间为序  daily_20110727 返回数据 row 行数 = "+str(daily_20110727.shape[0]))
daily_20110727_addname_dataframe.to_excel(daily_201107_excel_writer,'27_3',index=False)
daily_201107_excel_writer.save()
daily_20110728 = pro.daily(start_date='',end_date='',trade_date='20110728', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20110728_tscode_list = list() 
for ts_code_sh in daily_20110728['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20110728_tscode_list.append(stock_name)
daily_20110728_addname_dataframe=pd.DataFrame()
daily_20110728_addname_dataframe['cname'] = daily_20110728_tscode_list
for table_name in daily_20110728.columns.values.tolist():
    daily_20110728_addname_dataframe[table_name] = daily_20110728[table_name]
print("日线行情-时间为序  daily_20110728 返回数据 row 行数 = "+str(daily_20110728.shape[0]))
daily_20110728_addname_dataframe.to_excel(daily_201107_excel_writer,'28_4',index=False)
daily_201107_excel_writer.save()
daily_20110729 = pro.daily(start_date='',end_date='',trade_date='20110729', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20110729_tscode_list = list() 
for ts_code_sh in daily_20110729['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20110729_tscode_list.append(stock_name)
daily_20110729_addname_dataframe=pd.DataFrame()
daily_20110729_addname_dataframe['cname'] = daily_20110729_tscode_list
for table_name in daily_20110729.columns.values.tolist():
    daily_20110729_addname_dataframe[table_name] = daily_20110729[table_name]
print("日线行情-时间为序  daily_20110729 返回数据 row 行数 = "+str(daily_20110729.shape[0]))
daily_20110729_addname_dataframe.to_excel(daily_201107_excel_writer,'29_5',index=False)
daily_201107_excel_writer.save()




createexcel('daily_201108.xlsx')
daily_201108_book = load_workbook('C:\\Users\\zhuzj5\\Desktop\\zbin\\J0_Data\\daily_201108.xlsx')
daily_201108_excel_writer = pd.ExcelWriter('C:\\Users\\zhuzj5\\Desktop\\zbin\\J0_Data\\daily_201108.xlsx', engine='openpyxl')
daily_201108_excel_writer.book = daily_201108_book
daily_201108_excel_writer.sheets = dict((ws.title, ws) for ws in daily_201108_book.worksheets)
J0_PROPS.put(tree_node_name+"record_date", "20110801")       ###  更新 记录日期
daily_20110801 = pro.daily(start_date='',end_date='',trade_date='20110801', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20110801_tscode_list = list() 
for ts_code_sh in daily_20110801['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20110801_tscode_list.append(stock_name)
daily_20110801_addname_dataframe=pd.DataFrame()
daily_20110801_addname_dataframe['cname'] = daily_20110801_tscode_list
for table_name in daily_20110801.columns.values.tolist():
    daily_20110801_addname_dataframe[table_name] = daily_20110801[table_name]
print("日线行情-时间为序  daily_20110801 返回数据 row 行数 = "+str(daily_20110801.shape[0]))
daily_20110801_addname_dataframe.to_excel(daily_201108_excel_writer,'1_1',index=False)
daily_201108_excel_writer.save()
daily_20110802 = pro.daily(start_date='',end_date='',trade_date='20110802', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20110802_tscode_list = list() 
for ts_code_sh in daily_20110802['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20110802_tscode_list.append(stock_name)
daily_20110802_addname_dataframe=pd.DataFrame()
daily_20110802_addname_dataframe['cname'] = daily_20110802_tscode_list
for table_name in daily_20110802.columns.values.tolist():
    daily_20110802_addname_dataframe[table_name] = daily_20110802[table_name]
print("日线行情-时间为序  daily_20110802 返回数据 row 行数 = "+str(daily_20110802.shape[0]))
daily_20110802_addname_dataframe.to_excel(daily_201108_excel_writer,'2_2',index=False)
daily_201108_excel_writer.save()
daily_20110803 = pro.daily(start_date='',end_date='',trade_date='20110803', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20110803_tscode_list = list() 
for ts_code_sh in daily_20110803['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20110803_tscode_list.append(stock_name)
daily_20110803_addname_dataframe=pd.DataFrame()
daily_20110803_addname_dataframe['cname'] = daily_20110803_tscode_list
for table_name in daily_20110803.columns.values.tolist():
    daily_20110803_addname_dataframe[table_name] = daily_20110803[table_name]
print("日线行情-时间为序  daily_20110803 返回数据 row 行数 = "+str(daily_20110803.shape[0]))
daily_20110803_addname_dataframe.to_excel(daily_201108_excel_writer,'3_3',index=False)
daily_201108_excel_writer.save()
daily_20110804 = pro.daily(start_date='',end_date='',trade_date='20110804', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20110804_tscode_list = list() 
for ts_code_sh in daily_20110804['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20110804_tscode_list.append(stock_name)
daily_20110804_addname_dataframe=pd.DataFrame()
daily_20110804_addname_dataframe['cname'] = daily_20110804_tscode_list
for table_name in daily_20110804.columns.values.tolist():
    daily_20110804_addname_dataframe[table_name] = daily_20110804[table_name]
print("日线行情-时间为序  daily_20110804 返回数据 row 行数 = "+str(daily_20110804.shape[0]))
daily_20110804_addname_dataframe.to_excel(daily_201108_excel_writer,'4_4',index=False)
daily_201108_excel_writer.save()
daily_20110805 = pro.daily(start_date='',end_date='',trade_date='20110805', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20110805_tscode_list = list() 
for ts_code_sh in daily_20110805['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20110805_tscode_list.append(stock_name)
daily_20110805_addname_dataframe=pd.DataFrame()
daily_20110805_addname_dataframe['cname'] = daily_20110805_tscode_list
for table_name in daily_20110805.columns.values.tolist():
    daily_20110805_addname_dataframe[table_name] = daily_20110805[table_name]
print("日线行情-时间为序  daily_20110805 返回数据 row 行数 = "+str(daily_20110805.shape[0]))
daily_20110805_addname_dataframe.to_excel(daily_201108_excel_writer,'5_5',index=False)
daily_201108_excel_writer.save()
daily_20110808 = pro.daily(start_date='',end_date='',trade_date='20110808', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20110808_tscode_list = list() 
for ts_code_sh in daily_20110808['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20110808_tscode_list.append(stock_name)
daily_20110808_addname_dataframe=pd.DataFrame()
daily_20110808_addname_dataframe['cname'] = daily_20110808_tscode_list
for table_name in daily_20110808.columns.values.tolist():
    daily_20110808_addname_dataframe[table_name] = daily_20110808[table_name]
print("日线行情-时间为序  daily_20110808 返回数据 row 行数 = "+str(daily_20110808.shape[0]))
daily_20110808_addname_dataframe.to_excel(daily_201108_excel_writer,'8_1',index=False)
daily_201108_excel_writer.save()
daily_20110809 = pro.daily(start_date='',end_date='',trade_date='20110809', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20110809_tscode_list = list() 
for ts_code_sh in daily_20110809['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20110809_tscode_list.append(stock_name)
daily_20110809_addname_dataframe=pd.DataFrame()
daily_20110809_addname_dataframe['cname'] = daily_20110809_tscode_list
for table_name in daily_20110809.columns.values.tolist():
    daily_20110809_addname_dataframe[table_name] = daily_20110809[table_name]
print("日线行情-时间为序  daily_20110809 返回数据 row 行数 = "+str(daily_20110809.shape[0]))
daily_20110809_addname_dataframe.to_excel(daily_201108_excel_writer,'9_2',index=False)
daily_201108_excel_writer.save()
daily_20110810 = pro.daily(start_date='',end_date='',trade_date='20110810', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20110810_tscode_list = list() 
for ts_code_sh in daily_20110810['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20110810_tscode_list.append(stock_name)
daily_20110810_addname_dataframe=pd.DataFrame()
daily_20110810_addname_dataframe['cname'] = daily_20110810_tscode_list
for table_name in daily_20110810.columns.values.tolist():
    daily_20110810_addname_dataframe[table_name] = daily_20110810[table_name]
print("日线行情-时间为序  daily_20110810 返回数据 row 行数 = "+str(daily_20110810.shape[0]))
daily_20110810_addname_dataframe.to_excel(daily_201108_excel_writer,'10_3',index=False)
daily_201108_excel_writer.save()
daily_20110811 = pro.daily(start_date='',end_date='',trade_date='20110811', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20110811_tscode_list = list() 
for ts_code_sh in daily_20110811['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20110811_tscode_list.append(stock_name)
daily_20110811_addname_dataframe=pd.DataFrame()
daily_20110811_addname_dataframe['cname'] = daily_20110811_tscode_list
for table_name in daily_20110811.columns.values.tolist():
    daily_20110811_addname_dataframe[table_name] = daily_20110811[table_name]
print("日线行情-时间为序  daily_20110811 返回数据 row 行数 = "+str(daily_20110811.shape[0]))
daily_20110811_addname_dataframe.to_excel(daily_201108_excel_writer,'11_4',index=False)
daily_201108_excel_writer.save()
daily_20110812 = pro.daily(start_date='',end_date='',trade_date='20110812', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20110812_tscode_list = list() 
for ts_code_sh in daily_20110812['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20110812_tscode_list.append(stock_name)
daily_20110812_addname_dataframe=pd.DataFrame()
daily_20110812_addname_dataframe['cname'] = daily_20110812_tscode_list
for table_name in daily_20110812.columns.values.tolist():
    daily_20110812_addname_dataframe[table_name] = daily_20110812[table_name]
print("日线行情-时间为序  daily_20110812 返回数据 row 行数 = "+str(daily_20110812.shape[0]))
daily_20110812_addname_dataframe.to_excel(daily_201108_excel_writer,'12_5',index=False)
daily_201108_excel_writer.save()
daily_20110815 = pro.daily(start_date='',end_date='',trade_date='20110815', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20110815_tscode_list = list() 
for ts_code_sh in daily_20110815['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20110815_tscode_list.append(stock_name)
daily_20110815_addname_dataframe=pd.DataFrame()
daily_20110815_addname_dataframe['cname'] = daily_20110815_tscode_list
for table_name in daily_20110815.columns.values.tolist():
    daily_20110815_addname_dataframe[table_name] = daily_20110815[table_name]
print("日线行情-时间为序  daily_20110815 返回数据 row 行数 = "+str(daily_20110815.shape[0]))
daily_20110815_addname_dataframe.to_excel(daily_201108_excel_writer,'15_1',index=False)
daily_201108_excel_writer.save()
daily_20110816 = pro.daily(start_date='',end_date='',trade_date='20110816', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20110816_tscode_list = list() 
for ts_code_sh in daily_20110816['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20110816_tscode_list.append(stock_name)
daily_20110816_addname_dataframe=pd.DataFrame()
daily_20110816_addname_dataframe['cname'] = daily_20110816_tscode_list
for table_name in daily_20110816.columns.values.tolist():
    daily_20110816_addname_dataframe[table_name] = daily_20110816[table_name]
print("日线行情-时间为序  daily_20110816 返回数据 row 行数 = "+str(daily_20110816.shape[0]))
daily_20110816_addname_dataframe.to_excel(daily_201108_excel_writer,'16_2',index=False)
daily_201108_excel_writer.save()
daily_20110817 = pro.daily(start_date='',end_date='',trade_date='20110817', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20110817_tscode_list = list() 
for ts_code_sh in daily_20110817['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20110817_tscode_list.append(stock_name)
daily_20110817_addname_dataframe=pd.DataFrame()
daily_20110817_addname_dataframe['cname'] = daily_20110817_tscode_list
for table_name in daily_20110817.columns.values.tolist():
    daily_20110817_addname_dataframe[table_name] = daily_20110817[table_name]
print("日线行情-时间为序  daily_20110817 返回数据 row 行数 = "+str(daily_20110817.shape[0]))
daily_20110817_addname_dataframe.to_excel(daily_201108_excel_writer,'17_3',index=False)
daily_201108_excel_writer.save()
daily_20110818 = pro.daily(start_date='',end_date='',trade_date='20110818', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20110818_tscode_list = list() 
for ts_code_sh in daily_20110818['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20110818_tscode_list.append(stock_name)
daily_20110818_addname_dataframe=pd.DataFrame()
daily_20110818_addname_dataframe['cname'] = daily_20110818_tscode_list
for table_name in daily_20110818.columns.values.tolist():
    daily_20110818_addname_dataframe[table_name] = daily_20110818[table_name]
print("日线行情-时间为序  daily_20110818 返回数据 row 行数 = "+str(daily_20110818.shape[0]))
daily_20110818_addname_dataframe.to_excel(daily_201108_excel_writer,'18_4',index=False)
daily_201108_excel_writer.save()
daily_20110819 = pro.daily(start_date='',end_date='',trade_date='20110819', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20110819_tscode_list = list() 
for ts_code_sh in daily_20110819['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20110819_tscode_list.append(stock_name)
daily_20110819_addname_dataframe=pd.DataFrame()
daily_20110819_addname_dataframe['cname'] = daily_20110819_tscode_list
for table_name in daily_20110819.columns.values.tolist():
    daily_20110819_addname_dataframe[table_name] = daily_20110819[table_name]
print("日线行情-时间为序  daily_20110819 返回数据 row 行数 = "+str(daily_20110819.shape[0]))
daily_20110819_addname_dataframe.to_excel(daily_201108_excel_writer,'19_5',index=False)
daily_201108_excel_writer.save()
daily_20110822 = pro.daily(start_date='',end_date='',trade_date='20110822', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20110822_tscode_list = list() 
for ts_code_sh in daily_20110822['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20110822_tscode_list.append(stock_name)
daily_20110822_addname_dataframe=pd.DataFrame()
daily_20110822_addname_dataframe['cname'] = daily_20110822_tscode_list
for table_name in daily_20110822.columns.values.tolist():
    daily_20110822_addname_dataframe[table_name] = daily_20110822[table_name]
print("日线行情-时间为序  daily_20110822 返回数据 row 行数 = "+str(daily_20110822.shape[0]))
daily_20110822_addname_dataframe.to_excel(daily_201108_excel_writer,'22_1',index=False)
daily_201108_excel_writer.save()
daily_20110823 = pro.daily(start_date='',end_date='',trade_date='20110823', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20110823_tscode_list = list() 
for ts_code_sh in daily_20110823['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20110823_tscode_list.append(stock_name)
daily_20110823_addname_dataframe=pd.DataFrame()
daily_20110823_addname_dataframe['cname'] = daily_20110823_tscode_list
for table_name in daily_20110823.columns.values.tolist():
    daily_20110823_addname_dataframe[table_name] = daily_20110823[table_name]
print("日线行情-时间为序  daily_20110823 返回数据 row 行数 = "+str(daily_20110823.shape[0]))
daily_20110823_addname_dataframe.to_excel(daily_201108_excel_writer,'23_2',index=False)
daily_201108_excel_writer.save()
daily_20110824 = pro.daily(start_date='',end_date='',trade_date='20110824', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20110824_tscode_list = list() 
for ts_code_sh in daily_20110824['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20110824_tscode_list.append(stock_name)
daily_20110824_addname_dataframe=pd.DataFrame()
daily_20110824_addname_dataframe['cname'] = daily_20110824_tscode_list
for table_name in daily_20110824.columns.values.tolist():
    daily_20110824_addname_dataframe[table_name] = daily_20110824[table_name]
print("日线行情-时间为序  daily_20110824 返回数据 row 行数 = "+str(daily_20110824.shape[0]))
daily_20110824_addname_dataframe.to_excel(daily_201108_excel_writer,'24_3',index=False)
daily_201108_excel_writer.save()
daily_20110825 = pro.daily(start_date='',end_date='',trade_date='20110825', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20110825_tscode_list = list() 
for ts_code_sh in daily_20110825['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20110825_tscode_list.append(stock_name)
daily_20110825_addname_dataframe=pd.DataFrame()
daily_20110825_addname_dataframe['cname'] = daily_20110825_tscode_list
for table_name in daily_20110825.columns.values.tolist():
    daily_20110825_addname_dataframe[table_name] = daily_20110825[table_name]
print("日线行情-时间为序  daily_20110825 返回数据 row 行数 = "+str(daily_20110825.shape[0]))
daily_20110825_addname_dataframe.to_excel(daily_201108_excel_writer,'25_4',index=False)
daily_201108_excel_writer.save()
daily_20110826 = pro.daily(start_date='',end_date='',trade_date='20110826', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20110826_tscode_list = list() 
for ts_code_sh in daily_20110826['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20110826_tscode_list.append(stock_name)
daily_20110826_addname_dataframe=pd.DataFrame()
daily_20110826_addname_dataframe['cname'] = daily_20110826_tscode_list
for table_name in daily_20110826.columns.values.tolist():
    daily_20110826_addname_dataframe[table_name] = daily_20110826[table_name]
print("日线行情-时间为序  daily_20110826 返回数据 row 行数 = "+str(daily_20110826.shape[0]))
daily_20110826_addname_dataframe.to_excel(daily_201108_excel_writer,'26_5',index=False)
daily_201108_excel_writer.save()
daily_20110829 = pro.daily(start_date='',end_date='',trade_date='20110829', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20110829_tscode_list = list() 
for ts_code_sh in daily_20110829['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20110829_tscode_list.append(stock_name)
daily_20110829_addname_dataframe=pd.DataFrame()
daily_20110829_addname_dataframe['cname'] = daily_20110829_tscode_list
for table_name in daily_20110829.columns.values.tolist():
    daily_20110829_addname_dataframe[table_name] = daily_20110829[table_name]
print("日线行情-时间为序  daily_20110829 返回数据 row 行数 = "+str(daily_20110829.shape[0]))
daily_20110829_addname_dataframe.to_excel(daily_201108_excel_writer,'29_1',index=False)
daily_201108_excel_writer.save()
daily_20110830 = pro.daily(start_date='',end_date='',trade_date='20110830', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20110830_tscode_list = list() 
for ts_code_sh in daily_20110830['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20110830_tscode_list.append(stock_name)
daily_20110830_addname_dataframe=pd.DataFrame()
daily_20110830_addname_dataframe['cname'] = daily_20110830_tscode_list
for table_name in daily_20110830.columns.values.tolist():
    daily_20110830_addname_dataframe[table_name] = daily_20110830[table_name]
print("日线行情-时间为序  daily_20110830 返回数据 row 行数 = "+str(daily_20110830.shape[0]))
daily_20110830_addname_dataframe.to_excel(daily_201108_excel_writer,'30_2',index=False)
daily_201108_excel_writer.save()
daily_20110831 = pro.daily(start_date='',end_date='',trade_date='20110831', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20110831_tscode_list = list() 
for ts_code_sh in daily_20110831['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20110831_tscode_list.append(stock_name)
daily_20110831_addname_dataframe=pd.DataFrame()
daily_20110831_addname_dataframe['cname'] = daily_20110831_tscode_list
for table_name in daily_20110831.columns.values.tolist():
    daily_20110831_addname_dataframe[table_name] = daily_20110831[table_name]
print("日线行情-时间为序  daily_20110831 返回数据 row 行数 = "+str(daily_20110831.shape[0]))
daily_20110831_addname_dataframe.to_excel(daily_201108_excel_writer,'31_3',index=False)
daily_201108_excel_writer.save()




createexcel('daily_201109.xlsx')
daily_201109_book = load_workbook('C:\\Users\\zhuzj5\\Desktop\\zbin\\J0_Data\\daily_201109.xlsx')
daily_201109_excel_writer = pd.ExcelWriter('C:\\Users\\zhuzj5\\Desktop\\zbin\\J0_Data\\daily_201109.xlsx', engine='openpyxl')
daily_201109_excel_writer.book = daily_201109_book
daily_201109_excel_writer.sheets = dict((ws.title, ws) for ws in daily_201109_book.worksheets)
J0_PROPS.put(tree_node_name+"record_date", "20110901")       ###  更新 记录日期
daily_20110901 = pro.daily(start_date='',end_date='',trade_date='20110901', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20110901_tscode_list = list() 
for ts_code_sh in daily_20110901['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20110901_tscode_list.append(stock_name)
daily_20110901_addname_dataframe=pd.DataFrame()
daily_20110901_addname_dataframe['cname'] = daily_20110901_tscode_list
for table_name in daily_20110901.columns.values.tolist():
    daily_20110901_addname_dataframe[table_name] = daily_20110901[table_name]
print("日线行情-时间为序  daily_20110901 返回数据 row 行数 = "+str(daily_20110901.shape[0]))
daily_20110901_addname_dataframe.to_excel(daily_201109_excel_writer,'1_4',index=False)
daily_201109_excel_writer.save()
daily_20110902 = pro.daily(start_date='',end_date='',trade_date='20110902', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20110902_tscode_list = list() 
for ts_code_sh in daily_20110902['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20110902_tscode_list.append(stock_name)
daily_20110902_addname_dataframe=pd.DataFrame()
daily_20110902_addname_dataframe['cname'] = daily_20110902_tscode_list
for table_name in daily_20110902.columns.values.tolist():
    daily_20110902_addname_dataframe[table_name] = daily_20110902[table_name]
print("日线行情-时间为序  daily_20110902 返回数据 row 行数 = "+str(daily_20110902.shape[0]))
daily_20110902_addname_dataframe.to_excel(daily_201109_excel_writer,'2_5',index=False)
daily_201109_excel_writer.save()
daily_20110905 = pro.daily(start_date='',end_date='',trade_date='20110905', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20110905_tscode_list = list() 
for ts_code_sh in daily_20110905['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20110905_tscode_list.append(stock_name)
daily_20110905_addname_dataframe=pd.DataFrame()
daily_20110905_addname_dataframe['cname'] = daily_20110905_tscode_list
for table_name in daily_20110905.columns.values.tolist():
    daily_20110905_addname_dataframe[table_name] = daily_20110905[table_name]
print("日线行情-时间为序  daily_20110905 返回数据 row 行数 = "+str(daily_20110905.shape[0]))
daily_20110905_addname_dataframe.to_excel(daily_201109_excel_writer,'5_1',index=False)
daily_201109_excel_writer.save()
daily_20110906 = pro.daily(start_date='',end_date='',trade_date='20110906', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20110906_tscode_list = list() 
for ts_code_sh in daily_20110906['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20110906_tscode_list.append(stock_name)
daily_20110906_addname_dataframe=pd.DataFrame()
daily_20110906_addname_dataframe['cname'] = daily_20110906_tscode_list
for table_name in daily_20110906.columns.values.tolist():
    daily_20110906_addname_dataframe[table_name] = daily_20110906[table_name]
print("日线行情-时间为序  daily_20110906 返回数据 row 行数 = "+str(daily_20110906.shape[0]))
daily_20110906_addname_dataframe.to_excel(daily_201109_excel_writer,'6_2',index=False)
daily_201109_excel_writer.save()
daily_20110907 = pro.daily(start_date='',end_date='',trade_date='20110907', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20110907_tscode_list = list() 
for ts_code_sh in daily_20110907['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20110907_tscode_list.append(stock_name)
daily_20110907_addname_dataframe=pd.DataFrame()
daily_20110907_addname_dataframe['cname'] = daily_20110907_tscode_list
for table_name in daily_20110907.columns.values.tolist():
    daily_20110907_addname_dataframe[table_name] = daily_20110907[table_name]
print("日线行情-时间为序  daily_20110907 返回数据 row 行数 = "+str(daily_20110907.shape[0]))
daily_20110907_addname_dataframe.to_excel(daily_201109_excel_writer,'7_3',index=False)
daily_201109_excel_writer.save()
daily_20110908 = pro.daily(start_date='',end_date='',trade_date='20110908', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20110908_tscode_list = list() 
for ts_code_sh in daily_20110908['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20110908_tscode_list.append(stock_name)
daily_20110908_addname_dataframe=pd.DataFrame()
daily_20110908_addname_dataframe['cname'] = daily_20110908_tscode_list
for table_name in daily_20110908.columns.values.tolist():
    daily_20110908_addname_dataframe[table_name] = daily_20110908[table_name]
print("日线行情-时间为序  daily_20110908 返回数据 row 行数 = "+str(daily_20110908.shape[0]))
daily_20110908_addname_dataframe.to_excel(daily_201109_excel_writer,'8_4',index=False)
daily_201109_excel_writer.save()
daily_20110909 = pro.daily(start_date='',end_date='',trade_date='20110909', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20110909_tscode_list = list() 
for ts_code_sh in daily_20110909['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20110909_tscode_list.append(stock_name)
daily_20110909_addname_dataframe=pd.DataFrame()
daily_20110909_addname_dataframe['cname'] = daily_20110909_tscode_list
for table_name in daily_20110909.columns.values.tolist():
    daily_20110909_addname_dataframe[table_name] = daily_20110909[table_name]
print("日线行情-时间为序  daily_20110909 返回数据 row 行数 = "+str(daily_20110909.shape[0]))
daily_20110909_addname_dataframe.to_excel(daily_201109_excel_writer,'9_5',index=False)
daily_201109_excel_writer.save()
daily_20110913 = pro.daily(start_date='',end_date='',trade_date='20110913', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20110913_tscode_list = list() 
for ts_code_sh in daily_20110913['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20110913_tscode_list.append(stock_name)
daily_20110913_addname_dataframe=pd.DataFrame()
daily_20110913_addname_dataframe['cname'] = daily_20110913_tscode_list
for table_name in daily_20110913.columns.values.tolist():
    daily_20110913_addname_dataframe[table_name] = daily_20110913[table_name]
print("日线行情-时间为序  daily_20110913 返回数据 row 行数 = "+str(daily_20110913.shape[0]))
daily_20110913_addname_dataframe.to_excel(daily_201109_excel_writer,'13_2',index=False)
daily_201109_excel_writer.save()
daily_20110914 = pro.daily(start_date='',end_date='',trade_date='20110914', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20110914_tscode_list = list() 
for ts_code_sh in daily_20110914['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20110914_tscode_list.append(stock_name)
daily_20110914_addname_dataframe=pd.DataFrame()
daily_20110914_addname_dataframe['cname'] = daily_20110914_tscode_list
for table_name in daily_20110914.columns.values.tolist():
    daily_20110914_addname_dataframe[table_name] = daily_20110914[table_name]
print("日线行情-时间为序  daily_20110914 返回数据 row 行数 = "+str(daily_20110914.shape[0]))
daily_20110914_addname_dataframe.to_excel(daily_201109_excel_writer,'14_3',index=False)
daily_201109_excel_writer.save()
daily_20110915 = pro.daily(start_date='',end_date='',trade_date='20110915', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20110915_tscode_list = list() 
for ts_code_sh in daily_20110915['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20110915_tscode_list.append(stock_name)
daily_20110915_addname_dataframe=pd.DataFrame()
daily_20110915_addname_dataframe['cname'] = daily_20110915_tscode_list
for table_name in daily_20110915.columns.values.tolist():
    daily_20110915_addname_dataframe[table_name] = daily_20110915[table_name]
print("日线行情-时间为序  daily_20110915 返回数据 row 行数 = "+str(daily_20110915.shape[0]))
daily_20110915_addname_dataframe.to_excel(daily_201109_excel_writer,'15_4',index=False)
daily_201109_excel_writer.save()
daily_20110916 = pro.daily(start_date='',end_date='',trade_date='20110916', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20110916_tscode_list = list() 
for ts_code_sh in daily_20110916['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20110916_tscode_list.append(stock_name)
daily_20110916_addname_dataframe=pd.DataFrame()
daily_20110916_addname_dataframe['cname'] = daily_20110916_tscode_list
for table_name in daily_20110916.columns.values.tolist():
    daily_20110916_addname_dataframe[table_name] = daily_20110916[table_name]
print("日线行情-时间为序  daily_20110916 返回数据 row 行数 = "+str(daily_20110916.shape[0]))
daily_20110916_addname_dataframe.to_excel(daily_201109_excel_writer,'16_5',index=False)
daily_201109_excel_writer.save()
daily_20110919 = pro.daily(start_date='',end_date='',trade_date='20110919', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20110919_tscode_list = list() 
for ts_code_sh in daily_20110919['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20110919_tscode_list.append(stock_name)
daily_20110919_addname_dataframe=pd.DataFrame()
daily_20110919_addname_dataframe['cname'] = daily_20110919_tscode_list
for table_name in daily_20110919.columns.values.tolist():
    daily_20110919_addname_dataframe[table_name] = daily_20110919[table_name]
print("日线行情-时间为序  daily_20110919 返回数据 row 行数 = "+str(daily_20110919.shape[0]))
daily_20110919_addname_dataframe.to_excel(daily_201109_excel_writer,'19_1',index=False)
daily_201109_excel_writer.save()
daily_20110920 = pro.daily(start_date='',end_date='',trade_date='20110920', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20110920_tscode_list = list() 
for ts_code_sh in daily_20110920['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20110920_tscode_list.append(stock_name)
daily_20110920_addname_dataframe=pd.DataFrame()
daily_20110920_addname_dataframe['cname'] = daily_20110920_tscode_list
for table_name in daily_20110920.columns.values.tolist():
    daily_20110920_addname_dataframe[table_name] = daily_20110920[table_name]
print("日线行情-时间为序  daily_20110920 返回数据 row 行数 = "+str(daily_20110920.shape[0]))
daily_20110920_addname_dataframe.to_excel(daily_201109_excel_writer,'20_2',index=False)
daily_201109_excel_writer.save()
daily_20110921 = pro.daily(start_date='',end_date='',trade_date='20110921', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20110921_tscode_list = list() 
for ts_code_sh in daily_20110921['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20110921_tscode_list.append(stock_name)
daily_20110921_addname_dataframe=pd.DataFrame()
daily_20110921_addname_dataframe['cname'] = daily_20110921_tscode_list
for table_name in daily_20110921.columns.values.tolist():
    daily_20110921_addname_dataframe[table_name] = daily_20110921[table_name]
print("日线行情-时间为序  daily_20110921 返回数据 row 行数 = "+str(daily_20110921.shape[0]))
daily_20110921_addname_dataframe.to_excel(daily_201109_excel_writer,'21_3',index=False)
daily_201109_excel_writer.save()
daily_20110922 = pro.daily(start_date='',end_date='',trade_date='20110922', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20110922_tscode_list = list() 
for ts_code_sh in daily_20110922['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20110922_tscode_list.append(stock_name)
daily_20110922_addname_dataframe=pd.DataFrame()
daily_20110922_addname_dataframe['cname'] = daily_20110922_tscode_list
for table_name in daily_20110922.columns.values.tolist():
    daily_20110922_addname_dataframe[table_name] = daily_20110922[table_name]
print("日线行情-时间为序  daily_20110922 返回数据 row 行数 = "+str(daily_20110922.shape[0]))
daily_20110922_addname_dataframe.to_excel(daily_201109_excel_writer,'22_4',index=False)
daily_201109_excel_writer.save()
daily_20110923 = pro.daily(start_date='',end_date='',trade_date='20110923', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20110923_tscode_list = list() 
for ts_code_sh in daily_20110923['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20110923_tscode_list.append(stock_name)
daily_20110923_addname_dataframe=pd.DataFrame()
daily_20110923_addname_dataframe['cname'] = daily_20110923_tscode_list
for table_name in daily_20110923.columns.values.tolist():
    daily_20110923_addname_dataframe[table_name] = daily_20110923[table_name]
print("日线行情-时间为序  daily_20110923 返回数据 row 行数 = "+str(daily_20110923.shape[0]))
daily_20110923_addname_dataframe.to_excel(daily_201109_excel_writer,'23_5',index=False)
daily_201109_excel_writer.save()
daily_20110926 = pro.daily(start_date='',end_date='',trade_date='20110926', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20110926_tscode_list = list() 
for ts_code_sh in daily_20110926['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20110926_tscode_list.append(stock_name)
daily_20110926_addname_dataframe=pd.DataFrame()
daily_20110926_addname_dataframe['cname'] = daily_20110926_tscode_list
for table_name in daily_20110926.columns.values.tolist():
    daily_20110926_addname_dataframe[table_name] = daily_20110926[table_name]
print("日线行情-时间为序  daily_20110926 返回数据 row 行数 = "+str(daily_20110926.shape[0]))
daily_20110926_addname_dataframe.to_excel(daily_201109_excel_writer,'26_1',index=False)
daily_201109_excel_writer.save()
daily_20110927 = pro.daily(start_date='',end_date='',trade_date='20110927', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20110927_tscode_list = list() 
for ts_code_sh in daily_20110927['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20110927_tscode_list.append(stock_name)
daily_20110927_addname_dataframe=pd.DataFrame()
daily_20110927_addname_dataframe['cname'] = daily_20110927_tscode_list
for table_name in daily_20110927.columns.values.tolist():
    daily_20110927_addname_dataframe[table_name] = daily_20110927[table_name]
print("日线行情-时间为序  daily_20110927 返回数据 row 行数 = "+str(daily_20110927.shape[0]))
daily_20110927_addname_dataframe.to_excel(daily_201109_excel_writer,'27_2',index=False)
daily_201109_excel_writer.save()
daily_20110928 = pro.daily(start_date='',end_date='',trade_date='20110928', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20110928_tscode_list = list() 
for ts_code_sh in daily_20110928['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20110928_tscode_list.append(stock_name)
daily_20110928_addname_dataframe=pd.DataFrame()
daily_20110928_addname_dataframe['cname'] = daily_20110928_tscode_list
for table_name in daily_20110928.columns.values.tolist():
    daily_20110928_addname_dataframe[table_name] = daily_20110928[table_name]
print("日线行情-时间为序  daily_20110928 返回数据 row 行数 = "+str(daily_20110928.shape[0]))
daily_20110928_addname_dataframe.to_excel(daily_201109_excel_writer,'28_3',index=False)
daily_201109_excel_writer.save()
daily_20110929 = pro.daily(start_date='',end_date='',trade_date='20110929', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20110929_tscode_list = list() 
for ts_code_sh in daily_20110929['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20110929_tscode_list.append(stock_name)
daily_20110929_addname_dataframe=pd.DataFrame()
daily_20110929_addname_dataframe['cname'] = daily_20110929_tscode_list
for table_name in daily_20110929.columns.values.tolist():
    daily_20110929_addname_dataframe[table_name] = daily_20110929[table_name]
print("日线行情-时间为序  daily_20110929 返回数据 row 行数 = "+str(daily_20110929.shape[0]))
daily_20110929_addname_dataframe.to_excel(daily_201109_excel_writer,'29_4',index=False)
daily_201109_excel_writer.save()
daily_20110930 = pro.daily(start_date='',end_date='',trade_date='20110930', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20110930_tscode_list = list() 
for ts_code_sh in daily_20110930['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20110930_tscode_list.append(stock_name)
daily_20110930_addname_dataframe=pd.DataFrame()
daily_20110930_addname_dataframe['cname'] = daily_20110930_tscode_list
for table_name in daily_20110930.columns.values.tolist():
    daily_20110930_addname_dataframe[table_name] = daily_20110930[table_name]
print("日线行情-时间为序  daily_20110930 返回数据 row 行数 = "+str(daily_20110930.shape[0]))
daily_20110930_addname_dataframe.to_excel(daily_201109_excel_writer,'30_5',index=False)
daily_201109_excel_writer.save()




createexcel('daily_201110.xlsx')
daily_201110_book = load_workbook('C:\\Users\\zhuzj5\\Desktop\\zbin\\J0_Data\\daily_201110.xlsx')
daily_201110_excel_writer = pd.ExcelWriter('C:\\Users\\zhuzj5\\Desktop\\zbin\\J0_Data\\daily_201110.xlsx', engine='openpyxl')
daily_201110_excel_writer.book = daily_201110_book
daily_201110_excel_writer.sheets = dict((ws.title, ws) for ws in daily_201110_book.worksheets)
J0_PROPS.put(tree_node_name+"record_date", "20111001")       ###  更新 记录日期
daily_20111010 = pro.daily(start_date='',end_date='',trade_date='20111010', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20111010_tscode_list = list() 
for ts_code_sh in daily_20111010['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20111010_tscode_list.append(stock_name)
daily_20111010_addname_dataframe=pd.DataFrame()
daily_20111010_addname_dataframe['cname'] = daily_20111010_tscode_list
for table_name in daily_20111010.columns.values.tolist():
    daily_20111010_addname_dataframe[table_name] = daily_20111010[table_name]
print("日线行情-时间为序  daily_20111010 返回数据 row 行数 = "+str(daily_20111010.shape[0]))
daily_20111010_addname_dataframe.to_excel(daily_201110_excel_writer,'10_1',index=False)
daily_201110_excel_writer.save()
daily_20111011 = pro.daily(start_date='',end_date='',trade_date='20111011', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20111011_tscode_list = list() 
for ts_code_sh in daily_20111011['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20111011_tscode_list.append(stock_name)
daily_20111011_addname_dataframe=pd.DataFrame()
daily_20111011_addname_dataframe['cname'] = daily_20111011_tscode_list
for table_name in daily_20111011.columns.values.tolist():
    daily_20111011_addname_dataframe[table_name] = daily_20111011[table_name]
print("日线行情-时间为序  daily_20111011 返回数据 row 行数 = "+str(daily_20111011.shape[0]))
daily_20111011_addname_dataframe.to_excel(daily_201110_excel_writer,'11_2',index=False)
daily_201110_excel_writer.save()
daily_20111012 = pro.daily(start_date='',end_date='',trade_date='20111012', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20111012_tscode_list = list() 
for ts_code_sh in daily_20111012['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20111012_tscode_list.append(stock_name)
daily_20111012_addname_dataframe=pd.DataFrame()
daily_20111012_addname_dataframe['cname'] = daily_20111012_tscode_list
for table_name in daily_20111012.columns.values.tolist():
    daily_20111012_addname_dataframe[table_name] = daily_20111012[table_name]
print("日线行情-时间为序  daily_20111012 返回数据 row 行数 = "+str(daily_20111012.shape[0]))
daily_20111012_addname_dataframe.to_excel(daily_201110_excel_writer,'12_3',index=False)
daily_201110_excel_writer.save()
daily_20111013 = pro.daily(start_date='',end_date='',trade_date='20111013', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20111013_tscode_list = list() 
for ts_code_sh in daily_20111013['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20111013_tscode_list.append(stock_name)
daily_20111013_addname_dataframe=pd.DataFrame()
daily_20111013_addname_dataframe['cname'] = daily_20111013_tscode_list
for table_name in daily_20111013.columns.values.tolist():
    daily_20111013_addname_dataframe[table_name] = daily_20111013[table_name]
print("日线行情-时间为序  daily_20111013 返回数据 row 行数 = "+str(daily_20111013.shape[0]))
daily_20111013_addname_dataframe.to_excel(daily_201110_excel_writer,'13_4',index=False)
daily_201110_excel_writer.save()
daily_20111014 = pro.daily(start_date='',end_date='',trade_date='20111014', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20111014_tscode_list = list() 
for ts_code_sh in daily_20111014['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20111014_tscode_list.append(stock_name)
daily_20111014_addname_dataframe=pd.DataFrame()
daily_20111014_addname_dataframe['cname'] = daily_20111014_tscode_list
for table_name in daily_20111014.columns.values.tolist():
    daily_20111014_addname_dataframe[table_name] = daily_20111014[table_name]
print("日线行情-时间为序  daily_20111014 返回数据 row 行数 = "+str(daily_20111014.shape[0]))
daily_20111014_addname_dataframe.to_excel(daily_201110_excel_writer,'14_5',index=False)
daily_201110_excel_writer.save()
daily_20111017 = pro.daily(start_date='',end_date='',trade_date='20111017', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20111017_tscode_list = list() 
for ts_code_sh in daily_20111017['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20111017_tscode_list.append(stock_name)
daily_20111017_addname_dataframe=pd.DataFrame()
daily_20111017_addname_dataframe['cname'] = daily_20111017_tscode_list
for table_name in daily_20111017.columns.values.tolist():
    daily_20111017_addname_dataframe[table_name] = daily_20111017[table_name]
print("日线行情-时间为序  daily_20111017 返回数据 row 行数 = "+str(daily_20111017.shape[0]))
daily_20111017_addname_dataframe.to_excel(daily_201110_excel_writer,'17_1',index=False)
daily_201110_excel_writer.save()
daily_20111018 = pro.daily(start_date='',end_date='',trade_date='20111018', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20111018_tscode_list = list() 
for ts_code_sh in daily_20111018['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20111018_tscode_list.append(stock_name)
daily_20111018_addname_dataframe=pd.DataFrame()
daily_20111018_addname_dataframe['cname'] = daily_20111018_tscode_list
for table_name in daily_20111018.columns.values.tolist():
    daily_20111018_addname_dataframe[table_name] = daily_20111018[table_name]
print("日线行情-时间为序  daily_20111018 返回数据 row 行数 = "+str(daily_20111018.shape[0]))
daily_20111018_addname_dataframe.to_excel(daily_201110_excel_writer,'18_2',index=False)
daily_201110_excel_writer.save()
daily_20111019 = pro.daily(start_date='',end_date='',trade_date='20111019', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20111019_tscode_list = list() 
for ts_code_sh in daily_20111019['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20111019_tscode_list.append(stock_name)
daily_20111019_addname_dataframe=pd.DataFrame()
daily_20111019_addname_dataframe['cname'] = daily_20111019_tscode_list
for table_name in daily_20111019.columns.values.tolist():
    daily_20111019_addname_dataframe[table_name] = daily_20111019[table_name]
print("日线行情-时间为序  daily_20111019 返回数据 row 行数 = "+str(daily_20111019.shape[0]))
daily_20111019_addname_dataframe.to_excel(daily_201110_excel_writer,'19_3',index=False)
daily_201110_excel_writer.save()
daily_20111020 = pro.daily(start_date='',end_date='',trade_date='20111020', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20111020_tscode_list = list() 
for ts_code_sh in daily_20111020['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20111020_tscode_list.append(stock_name)
daily_20111020_addname_dataframe=pd.DataFrame()
daily_20111020_addname_dataframe['cname'] = daily_20111020_tscode_list
for table_name in daily_20111020.columns.values.tolist():
    daily_20111020_addname_dataframe[table_name] = daily_20111020[table_name]
print("日线行情-时间为序  daily_20111020 返回数据 row 行数 = "+str(daily_20111020.shape[0]))
daily_20111020_addname_dataframe.to_excel(daily_201110_excel_writer,'20_4',index=False)
daily_201110_excel_writer.save()
daily_20111021 = pro.daily(start_date='',end_date='',trade_date='20111021', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20111021_tscode_list = list() 
for ts_code_sh in daily_20111021['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20111021_tscode_list.append(stock_name)
daily_20111021_addname_dataframe=pd.DataFrame()
daily_20111021_addname_dataframe['cname'] = daily_20111021_tscode_list
for table_name in daily_20111021.columns.values.tolist():
    daily_20111021_addname_dataframe[table_name] = daily_20111021[table_name]
print("日线行情-时间为序  daily_20111021 返回数据 row 行数 = "+str(daily_20111021.shape[0]))
daily_20111021_addname_dataframe.to_excel(daily_201110_excel_writer,'21_5',index=False)
daily_201110_excel_writer.save()
daily_20111024 = pro.daily(start_date='',end_date='',trade_date='20111024', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20111024_tscode_list = list() 
for ts_code_sh in daily_20111024['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20111024_tscode_list.append(stock_name)
daily_20111024_addname_dataframe=pd.DataFrame()
daily_20111024_addname_dataframe['cname'] = daily_20111024_tscode_list
for table_name in daily_20111024.columns.values.tolist():
    daily_20111024_addname_dataframe[table_name] = daily_20111024[table_name]
print("日线行情-时间为序  daily_20111024 返回数据 row 行数 = "+str(daily_20111024.shape[0]))
daily_20111024_addname_dataframe.to_excel(daily_201110_excel_writer,'24_1',index=False)
daily_201110_excel_writer.save()
daily_20111025 = pro.daily(start_date='',end_date='',trade_date='20111025', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20111025_tscode_list = list() 
for ts_code_sh in daily_20111025['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20111025_tscode_list.append(stock_name)
daily_20111025_addname_dataframe=pd.DataFrame()
daily_20111025_addname_dataframe['cname'] = daily_20111025_tscode_list
for table_name in daily_20111025.columns.values.tolist():
    daily_20111025_addname_dataframe[table_name] = daily_20111025[table_name]
print("日线行情-时间为序  daily_20111025 返回数据 row 行数 = "+str(daily_20111025.shape[0]))
daily_20111025_addname_dataframe.to_excel(daily_201110_excel_writer,'25_2',index=False)
daily_201110_excel_writer.save()
daily_20111026 = pro.daily(start_date='',end_date='',trade_date='20111026', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20111026_tscode_list = list() 
for ts_code_sh in daily_20111026['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20111026_tscode_list.append(stock_name)
daily_20111026_addname_dataframe=pd.DataFrame()
daily_20111026_addname_dataframe['cname'] = daily_20111026_tscode_list
for table_name in daily_20111026.columns.values.tolist():
    daily_20111026_addname_dataframe[table_name] = daily_20111026[table_name]
print("日线行情-时间为序  daily_20111026 返回数据 row 行数 = "+str(daily_20111026.shape[0]))
daily_20111026_addname_dataframe.to_excel(daily_201110_excel_writer,'26_3',index=False)
daily_201110_excel_writer.save()
daily_20111027 = pro.daily(start_date='',end_date='',trade_date='20111027', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20111027_tscode_list = list() 
for ts_code_sh in daily_20111027['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20111027_tscode_list.append(stock_name)
daily_20111027_addname_dataframe=pd.DataFrame()
daily_20111027_addname_dataframe['cname'] = daily_20111027_tscode_list
for table_name in daily_20111027.columns.values.tolist():
    daily_20111027_addname_dataframe[table_name] = daily_20111027[table_name]
print("日线行情-时间为序  daily_20111027 返回数据 row 行数 = "+str(daily_20111027.shape[0]))
daily_20111027_addname_dataframe.to_excel(daily_201110_excel_writer,'27_4',index=False)
daily_201110_excel_writer.save()
daily_20111028 = pro.daily(start_date='',end_date='',trade_date='20111028', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20111028_tscode_list = list() 
for ts_code_sh in daily_20111028['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20111028_tscode_list.append(stock_name)
daily_20111028_addname_dataframe=pd.DataFrame()
daily_20111028_addname_dataframe['cname'] = daily_20111028_tscode_list
for table_name in daily_20111028.columns.values.tolist():
    daily_20111028_addname_dataframe[table_name] = daily_20111028[table_name]
print("日线行情-时间为序  daily_20111028 返回数据 row 行数 = "+str(daily_20111028.shape[0]))
daily_20111028_addname_dataframe.to_excel(daily_201110_excel_writer,'28_5',index=False)
daily_201110_excel_writer.save()
daily_20111031 = pro.daily(start_date='',end_date='',trade_date='20111031', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20111031_tscode_list = list() 
for ts_code_sh in daily_20111031['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20111031_tscode_list.append(stock_name)
daily_20111031_addname_dataframe=pd.DataFrame()
daily_20111031_addname_dataframe['cname'] = daily_20111031_tscode_list
for table_name in daily_20111031.columns.values.tolist():
    daily_20111031_addname_dataframe[table_name] = daily_20111031[table_name]
print("日线行情-时间为序  daily_20111031 返回数据 row 行数 = "+str(daily_20111031.shape[0]))
daily_20111031_addname_dataframe.to_excel(daily_201110_excel_writer,'31_1',index=False)
daily_201110_excel_writer.save()




createexcel('daily_201111.xlsx')
daily_201111_book = load_workbook('C:\\Users\\zhuzj5\\Desktop\\zbin\\J0_Data\\daily_201111.xlsx')
daily_201111_excel_writer = pd.ExcelWriter('C:\\Users\\zhuzj5\\Desktop\\zbin\\J0_Data\\daily_201111.xlsx', engine='openpyxl')
daily_201111_excel_writer.book = daily_201111_book
daily_201111_excel_writer.sheets = dict((ws.title, ws) for ws in daily_201111_book.worksheets)
J0_PROPS.put(tree_node_name+"record_date", "20111101")       ###  更新 记录日期
daily_20111101 = pro.daily(start_date='',end_date='',trade_date='20111101', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20111101_tscode_list = list() 
for ts_code_sh in daily_20111101['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20111101_tscode_list.append(stock_name)
daily_20111101_addname_dataframe=pd.DataFrame()
daily_20111101_addname_dataframe['cname'] = daily_20111101_tscode_list
for table_name in daily_20111101.columns.values.tolist():
    daily_20111101_addname_dataframe[table_name] = daily_20111101[table_name]
print("日线行情-时间为序  daily_20111101 返回数据 row 行数 = "+str(daily_20111101.shape[0]))
daily_20111101_addname_dataframe.to_excel(daily_201111_excel_writer,'1_2',index=False)
daily_201111_excel_writer.save()
daily_20111102 = pro.daily(start_date='',end_date='',trade_date='20111102', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20111102_tscode_list = list() 
for ts_code_sh in daily_20111102['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20111102_tscode_list.append(stock_name)
daily_20111102_addname_dataframe=pd.DataFrame()
daily_20111102_addname_dataframe['cname'] = daily_20111102_tscode_list
for table_name in daily_20111102.columns.values.tolist():
    daily_20111102_addname_dataframe[table_name] = daily_20111102[table_name]
print("日线行情-时间为序  daily_20111102 返回数据 row 行数 = "+str(daily_20111102.shape[0]))
daily_20111102_addname_dataframe.to_excel(daily_201111_excel_writer,'2_3',index=False)
daily_201111_excel_writer.save()
daily_20111103 = pro.daily(start_date='',end_date='',trade_date='20111103', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20111103_tscode_list = list() 
for ts_code_sh in daily_20111103['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20111103_tscode_list.append(stock_name)
daily_20111103_addname_dataframe=pd.DataFrame()
daily_20111103_addname_dataframe['cname'] = daily_20111103_tscode_list
for table_name in daily_20111103.columns.values.tolist():
    daily_20111103_addname_dataframe[table_name] = daily_20111103[table_name]
print("日线行情-时间为序  daily_20111103 返回数据 row 行数 = "+str(daily_20111103.shape[0]))
daily_20111103_addname_dataframe.to_excel(daily_201111_excel_writer,'3_4',index=False)
daily_201111_excel_writer.save()
daily_20111104 = pro.daily(start_date='',end_date='',trade_date='20111104', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20111104_tscode_list = list() 
for ts_code_sh in daily_20111104['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20111104_tscode_list.append(stock_name)
daily_20111104_addname_dataframe=pd.DataFrame()
daily_20111104_addname_dataframe['cname'] = daily_20111104_tscode_list
for table_name in daily_20111104.columns.values.tolist():
    daily_20111104_addname_dataframe[table_name] = daily_20111104[table_name]
print("日线行情-时间为序  daily_20111104 返回数据 row 行数 = "+str(daily_20111104.shape[0]))
daily_20111104_addname_dataframe.to_excel(daily_201111_excel_writer,'4_5',index=False)
daily_201111_excel_writer.save()
daily_20111107 = pro.daily(start_date='',end_date='',trade_date='20111107', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20111107_tscode_list = list() 
for ts_code_sh in daily_20111107['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20111107_tscode_list.append(stock_name)
daily_20111107_addname_dataframe=pd.DataFrame()
daily_20111107_addname_dataframe['cname'] = daily_20111107_tscode_list
for table_name in daily_20111107.columns.values.tolist():
    daily_20111107_addname_dataframe[table_name] = daily_20111107[table_name]
print("日线行情-时间为序  daily_20111107 返回数据 row 行数 = "+str(daily_20111107.shape[0]))
daily_20111107_addname_dataframe.to_excel(daily_201111_excel_writer,'7_1',index=False)
daily_201111_excel_writer.save()
daily_20111108 = pro.daily(start_date='',end_date='',trade_date='20111108', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20111108_tscode_list = list() 
for ts_code_sh in daily_20111108['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20111108_tscode_list.append(stock_name)
daily_20111108_addname_dataframe=pd.DataFrame()
daily_20111108_addname_dataframe['cname'] = daily_20111108_tscode_list
for table_name in daily_20111108.columns.values.tolist():
    daily_20111108_addname_dataframe[table_name] = daily_20111108[table_name]
print("日线行情-时间为序  daily_20111108 返回数据 row 行数 = "+str(daily_20111108.shape[0]))
daily_20111108_addname_dataframe.to_excel(daily_201111_excel_writer,'8_2',index=False)
daily_201111_excel_writer.save()
daily_20111109 = pro.daily(start_date='',end_date='',trade_date='20111109', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20111109_tscode_list = list() 
for ts_code_sh in daily_20111109['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20111109_tscode_list.append(stock_name)
daily_20111109_addname_dataframe=pd.DataFrame()
daily_20111109_addname_dataframe['cname'] = daily_20111109_tscode_list
for table_name in daily_20111109.columns.values.tolist():
    daily_20111109_addname_dataframe[table_name] = daily_20111109[table_name]
print("日线行情-时间为序  daily_20111109 返回数据 row 行数 = "+str(daily_20111109.shape[0]))
daily_20111109_addname_dataframe.to_excel(daily_201111_excel_writer,'9_3',index=False)
daily_201111_excel_writer.save()
daily_20111110 = pro.daily(start_date='',end_date='',trade_date='20111110', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20111110_tscode_list = list() 
for ts_code_sh in daily_20111110['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20111110_tscode_list.append(stock_name)
daily_20111110_addname_dataframe=pd.DataFrame()
daily_20111110_addname_dataframe['cname'] = daily_20111110_tscode_list
for table_name in daily_20111110.columns.values.tolist():
    daily_20111110_addname_dataframe[table_name] = daily_20111110[table_name]
print("日线行情-时间为序  daily_20111110 返回数据 row 行数 = "+str(daily_20111110.shape[0]))
daily_20111110_addname_dataframe.to_excel(daily_201111_excel_writer,'10_4',index=False)
daily_201111_excel_writer.save()
daily_20111111 = pro.daily(start_date='',end_date='',trade_date='20111111', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20111111_tscode_list = list() 
for ts_code_sh in daily_20111111['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20111111_tscode_list.append(stock_name)
daily_20111111_addname_dataframe=pd.DataFrame()
daily_20111111_addname_dataframe['cname'] = daily_20111111_tscode_list
for table_name in daily_20111111.columns.values.tolist():
    daily_20111111_addname_dataframe[table_name] = daily_20111111[table_name]
print("日线行情-时间为序  daily_20111111 返回数据 row 行数 = "+str(daily_20111111.shape[0]))
daily_20111111_addname_dataframe.to_excel(daily_201111_excel_writer,'11_5',index=False)
daily_201111_excel_writer.save()
daily_20111114 = pro.daily(start_date='',end_date='',trade_date='20111114', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20111114_tscode_list = list() 
for ts_code_sh in daily_20111114['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20111114_tscode_list.append(stock_name)
daily_20111114_addname_dataframe=pd.DataFrame()
daily_20111114_addname_dataframe['cname'] = daily_20111114_tscode_list
for table_name in daily_20111114.columns.values.tolist():
    daily_20111114_addname_dataframe[table_name] = daily_20111114[table_name]
print("日线行情-时间为序  daily_20111114 返回数据 row 行数 = "+str(daily_20111114.shape[0]))
daily_20111114_addname_dataframe.to_excel(daily_201111_excel_writer,'14_1',index=False)
daily_201111_excel_writer.save()
daily_20111115 = pro.daily(start_date='',end_date='',trade_date='20111115', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20111115_tscode_list = list() 
for ts_code_sh in daily_20111115['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20111115_tscode_list.append(stock_name)
daily_20111115_addname_dataframe=pd.DataFrame()
daily_20111115_addname_dataframe['cname'] = daily_20111115_tscode_list
for table_name in daily_20111115.columns.values.tolist():
    daily_20111115_addname_dataframe[table_name] = daily_20111115[table_name]
print("日线行情-时间为序  daily_20111115 返回数据 row 行数 = "+str(daily_20111115.shape[0]))
daily_20111115_addname_dataframe.to_excel(daily_201111_excel_writer,'15_2',index=False)
daily_201111_excel_writer.save()
daily_20111116 = pro.daily(start_date='',end_date='',trade_date='20111116', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20111116_tscode_list = list() 
for ts_code_sh in daily_20111116['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20111116_tscode_list.append(stock_name)
daily_20111116_addname_dataframe=pd.DataFrame()
daily_20111116_addname_dataframe['cname'] = daily_20111116_tscode_list
for table_name in daily_20111116.columns.values.tolist():
    daily_20111116_addname_dataframe[table_name] = daily_20111116[table_name]
print("日线行情-时间为序  daily_20111116 返回数据 row 行数 = "+str(daily_20111116.shape[0]))
daily_20111116_addname_dataframe.to_excel(daily_201111_excel_writer,'16_3',index=False)
daily_201111_excel_writer.save()
daily_20111117 = pro.daily(start_date='',end_date='',trade_date='20111117', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20111117_tscode_list = list() 
for ts_code_sh in daily_20111117['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20111117_tscode_list.append(stock_name)
daily_20111117_addname_dataframe=pd.DataFrame()
daily_20111117_addname_dataframe['cname'] = daily_20111117_tscode_list
for table_name in daily_20111117.columns.values.tolist():
    daily_20111117_addname_dataframe[table_name] = daily_20111117[table_name]
print("日线行情-时间为序  daily_20111117 返回数据 row 行数 = "+str(daily_20111117.shape[0]))
daily_20111117_addname_dataframe.to_excel(daily_201111_excel_writer,'17_4',index=False)
daily_201111_excel_writer.save()
daily_20111118 = pro.daily(start_date='',end_date='',trade_date='20111118', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20111118_tscode_list = list() 
for ts_code_sh in daily_20111118['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20111118_tscode_list.append(stock_name)
daily_20111118_addname_dataframe=pd.DataFrame()
daily_20111118_addname_dataframe['cname'] = daily_20111118_tscode_list
for table_name in daily_20111118.columns.values.tolist():
    daily_20111118_addname_dataframe[table_name] = daily_20111118[table_name]
print("日线行情-时间为序  daily_20111118 返回数据 row 行数 = "+str(daily_20111118.shape[0]))
daily_20111118_addname_dataframe.to_excel(daily_201111_excel_writer,'18_5',index=False)
daily_201111_excel_writer.save()
daily_20111121 = pro.daily(start_date='',end_date='',trade_date='20111121', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20111121_tscode_list = list() 
for ts_code_sh in daily_20111121['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20111121_tscode_list.append(stock_name)
daily_20111121_addname_dataframe=pd.DataFrame()
daily_20111121_addname_dataframe['cname'] = daily_20111121_tscode_list
for table_name in daily_20111121.columns.values.tolist():
    daily_20111121_addname_dataframe[table_name] = daily_20111121[table_name]
print("日线行情-时间为序  daily_20111121 返回数据 row 行数 = "+str(daily_20111121.shape[0]))
daily_20111121_addname_dataframe.to_excel(daily_201111_excel_writer,'21_1',index=False)
daily_201111_excel_writer.save()
daily_20111122 = pro.daily(start_date='',end_date='',trade_date='20111122', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20111122_tscode_list = list() 
for ts_code_sh in daily_20111122['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20111122_tscode_list.append(stock_name)
daily_20111122_addname_dataframe=pd.DataFrame()
daily_20111122_addname_dataframe['cname'] = daily_20111122_tscode_list
for table_name in daily_20111122.columns.values.tolist():
    daily_20111122_addname_dataframe[table_name] = daily_20111122[table_name]
print("日线行情-时间为序  daily_20111122 返回数据 row 行数 = "+str(daily_20111122.shape[0]))
daily_20111122_addname_dataframe.to_excel(daily_201111_excel_writer,'22_2',index=False)
daily_201111_excel_writer.save()
daily_20111123 = pro.daily(start_date='',end_date='',trade_date='20111123', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20111123_tscode_list = list() 
for ts_code_sh in daily_20111123['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20111123_tscode_list.append(stock_name)
daily_20111123_addname_dataframe=pd.DataFrame()
daily_20111123_addname_dataframe['cname'] = daily_20111123_tscode_list
for table_name in daily_20111123.columns.values.tolist():
    daily_20111123_addname_dataframe[table_name] = daily_20111123[table_name]
print("日线行情-时间为序  daily_20111123 返回数据 row 行数 = "+str(daily_20111123.shape[0]))
daily_20111123_addname_dataframe.to_excel(daily_201111_excel_writer,'23_3',index=False)
daily_201111_excel_writer.save()
daily_20111124 = pro.daily(start_date='',end_date='',trade_date='20111124', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20111124_tscode_list = list() 
for ts_code_sh in daily_20111124['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20111124_tscode_list.append(stock_name)
daily_20111124_addname_dataframe=pd.DataFrame()
daily_20111124_addname_dataframe['cname'] = daily_20111124_tscode_list
for table_name in daily_20111124.columns.values.tolist():
    daily_20111124_addname_dataframe[table_name] = daily_20111124[table_name]
print("日线行情-时间为序  daily_20111124 返回数据 row 行数 = "+str(daily_20111124.shape[0]))
daily_20111124_addname_dataframe.to_excel(daily_201111_excel_writer,'24_4',index=False)
daily_201111_excel_writer.save()
daily_20111125 = pro.daily(start_date='',end_date='',trade_date='20111125', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20111125_tscode_list = list() 
for ts_code_sh in daily_20111125['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20111125_tscode_list.append(stock_name)
daily_20111125_addname_dataframe=pd.DataFrame()
daily_20111125_addname_dataframe['cname'] = daily_20111125_tscode_list
for table_name in daily_20111125.columns.values.tolist():
    daily_20111125_addname_dataframe[table_name] = daily_20111125[table_name]
print("日线行情-时间为序  daily_20111125 返回数据 row 行数 = "+str(daily_20111125.shape[0]))
daily_20111125_addname_dataframe.to_excel(daily_201111_excel_writer,'25_5',index=False)
daily_201111_excel_writer.save()
daily_20111128 = pro.daily(start_date='',end_date='',trade_date='20111128', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20111128_tscode_list = list() 
for ts_code_sh in daily_20111128['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20111128_tscode_list.append(stock_name)
daily_20111128_addname_dataframe=pd.DataFrame()
daily_20111128_addname_dataframe['cname'] = daily_20111128_tscode_list
for table_name in daily_20111128.columns.values.tolist():
    daily_20111128_addname_dataframe[table_name] = daily_20111128[table_name]
print("日线行情-时间为序  daily_20111128 返回数据 row 行数 = "+str(daily_20111128.shape[0]))
daily_20111128_addname_dataframe.to_excel(daily_201111_excel_writer,'28_1',index=False)
daily_201111_excel_writer.save()
daily_20111129 = pro.daily(start_date='',end_date='',trade_date='20111129', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20111129_tscode_list = list() 
for ts_code_sh in daily_20111129['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20111129_tscode_list.append(stock_name)
daily_20111129_addname_dataframe=pd.DataFrame()
daily_20111129_addname_dataframe['cname'] = daily_20111129_tscode_list
for table_name in daily_20111129.columns.values.tolist():
    daily_20111129_addname_dataframe[table_name] = daily_20111129[table_name]
print("日线行情-时间为序  daily_20111129 返回数据 row 行数 = "+str(daily_20111129.shape[0]))
daily_20111129_addname_dataframe.to_excel(daily_201111_excel_writer,'29_2',index=False)
daily_201111_excel_writer.save()
daily_20111130 = pro.daily(start_date='',end_date='',trade_date='20111130', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20111130_tscode_list = list() 
for ts_code_sh in daily_20111130['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20111130_tscode_list.append(stock_name)
daily_20111130_addname_dataframe=pd.DataFrame()
daily_20111130_addname_dataframe['cname'] = daily_20111130_tscode_list
for table_name in daily_20111130.columns.values.tolist():
    daily_20111130_addname_dataframe[table_name] = daily_20111130[table_name]
print("日线行情-时间为序  daily_20111130 返回数据 row 行数 = "+str(daily_20111130.shape[0]))
daily_20111130_addname_dataframe.to_excel(daily_201111_excel_writer,'30_3',index=False)
daily_201111_excel_writer.save()




createexcel('daily_201112.xlsx')
daily_201112_book = load_workbook('C:\\Users\\zhuzj5\\Desktop\\zbin\\J0_Data\\daily_201112.xlsx')
daily_201112_excel_writer = pd.ExcelWriter('C:\\Users\\zhuzj5\\Desktop\\zbin\\J0_Data\\daily_201112.xlsx', engine='openpyxl')
daily_201112_excel_writer.book = daily_201112_book
daily_201112_excel_writer.sheets = dict((ws.title, ws) for ws in daily_201112_book.worksheets)
J0_PROPS.put(tree_node_name+"record_date", "20111201")       ###  更新 记录日期
daily_20111201 = pro.daily(start_date='',end_date='',trade_date='20111201', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20111201_tscode_list = list() 
for ts_code_sh in daily_20111201['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20111201_tscode_list.append(stock_name)
daily_20111201_addname_dataframe=pd.DataFrame()
daily_20111201_addname_dataframe['cname'] = daily_20111201_tscode_list
for table_name in daily_20111201.columns.values.tolist():
    daily_20111201_addname_dataframe[table_name] = daily_20111201[table_name]
print("日线行情-时间为序  daily_20111201 返回数据 row 行数 = "+str(daily_20111201.shape[0]))
daily_20111201_addname_dataframe.to_excel(daily_201112_excel_writer,'1_4',index=False)
daily_201112_excel_writer.save()
daily_20111202 = pro.daily(start_date='',end_date='',trade_date='20111202', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20111202_tscode_list = list() 
for ts_code_sh in daily_20111202['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20111202_tscode_list.append(stock_name)
daily_20111202_addname_dataframe=pd.DataFrame()
daily_20111202_addname_dataframe['cname'] = daily_20111202_tscode_list
for table_name in daily_20111202.columns.values.tolist():
    daily_20111202_addname_dataframe[table_name] = daily_20111202[table_name]
print("日线行情-时间为序  daily_20111202 返回数据 row 行数 = "+str(daily_20111202.shape[0]))
daily_20111202_addname_dataframe.to_excel(daily_201112_excel_writer,'2_5',index=False)
daily_201112_excel_writer.save()
daily_20111205 = pro.daily(start_date='',end_date='',trade_date='20111205', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20111205_tscode_list = list() 
for ts_code_sh in daily_20111205['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20111205_tscode_list.append(stock_name)
daily_20111205_addname_dataframe=pd.DataFrame()
daily_20111205_addname_dataframe['cname'] = daily_20111205_tscode_list
for table_name in daily_20111205.columns.values.tolist():
    daily_20111205_addname_dataframe[table_name] = daily_20111205[table_name]
print("日线行情-时间为序  daily_20111205 返回数据 row 行数 = "+str(daily_20111205.shape[0]))
daily_20111205_addname_dataframe.to_excel(daily_201112_excel_writer,'5_1',index=False)
daily_201112_excel_writer.save()
daily_20111206 = pro.daily(start_date='',end_date='',trade_date='20111206', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20111206_tscode_list = list() 
for ts_code_sh in daily_20111206['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20111206_tscode_list.append(stock_name)
daily_20111206_addname_dataframe=pd.DataFrame()
daily_20111206_addname_dataframe['cname'] = daily_20111206_tscode_list
for table_name in daily_20111206.columns.values.tolist():
    daily_20111206_addname_dataframe[table_name] = daily_20111206[table_name]
print("日线行情-时间为序  daily_20111206 返回数据 row 行数 = "+str(daily_20111206.shape[0]))
daily_20111206_addname_dataframe.to_excel(daily_201112_excel_writer,'6_2',index=False)
daily_201112_excel_writer.save()
daily_20111207 = pro.daily(start_date='',end_date='',trade_date='20111207', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20111207_tscode_list = list() 
for ts_code_sh in daily_20111207['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20111207_tscode_list.append(stock_name)
daily_20111207_addname_dataframe=pd.DataFrame()
daily_20111207_addname_dataframe['cname'] = daily_20111207_tscode_list
for table_name in daily_20111207.columns.values.tolist():
    daily_20111207_addname_dataframe[table_name] = daily_20111207[table_name]
print("日线行情-时间为序  daily_20111207 返回数据 row 行数 = "+str(daily_20111207.shape[0]))
daily_20111207_addname_dataframe.to_excel(daily_201112_excel_writer,'7_3',index=False)
daily_201112_excel_writer.save()
daily_20111208 = pro.daily(start_date='',end_date='',trade_date='20111208', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20111208_tscode_list = list() 
for ts_code_sh in daily_20111208['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20111208_tscode_list.append(stock_name)
daily_20111208_addname_dataframe=pd.DataFrame()
daily_20111208_addname_dataframe['cname'] = daily_20111208_tscode_list
for table_name in daily_20111208.columns.values.tolist():
    daily_20111208_addname_dataframe[table_name] = daily_20111208[table_name]
print("日线行情-时间为序  daily_20111208 返回数据 row 行数 = "+str(daily_20111208.shape[0]))
daily_20111208_addname_dataframe.to_excel(daily_201112_excel_writer,'8_4',index=False)
daily_201112_excel_writer.save()
daily_20111209 = pro.daily(start_date='',end_date='',trade_date='20111209', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20111209_tscode_list = list() 
for ts_code_sh in daily_20111209['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20111209_tscode_list.append(stock_name)
daily_20111209_addname_dataframe=pd.DataFrame()
daily_20111209_addname_dataframe['cname'] = daily_20111209_tscode_list
for table_name in daily_20111209.columns.values.tolist():
    daily_20111209_addname_dataframe[table_name] = daily_20111209[table_name]
print("日线行情-时间为序  daily_20111209 返回数据 row 行数 = "+str(daily_20111209.shape[0]))
daily_20111209_addname_dataframe.to_excel(daily_201112_excel_writer,'9_5',index=False)
daily_201112_excel_writer.save()
daily_20111212 = pro.daily(start_date='',end_date='',trade_date='20111212', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20111212_tscode_list = list() 
for ts_code_sh in daily_20111212['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20111212_tscode_list.append(stock_name)
daily_20111212_addname_dataframe=pd.DataFrame()
daily_20111212_addname_dataframe['cname'] = daily_20111212_tscode_list
for table_name in daily_20111212.columns.values.tolist():
    daily_20111212_addname_dataframe[table_name] = daily_20111212[table_name]
print("日线行情-时间为序  daily_20111212 返回数据 row 行数 = "+str(daily_20111212.shape[0]))
daily_20111212_addname_dataframe.to_excel(daily_201112_excel_writer,'12_1',index=False)
daily_201112_excel_writer.save()
daily_20111213 = pro.daily(start_date='',end_date='',trade_date='20111213', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20111213_tscode_list = list() 
for ts_code_sh in daily_20111213['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20111213_tscode_list.append(stock_name)
daily_20111213_addname_dataframe=pd.DataFrame()
daily_20111213_addname_dataframe['cname'] = daily_20111213_tscode_list
for table_name in daily_20111213.columns.values.tolist():
    daily_20111213_addname_dataframe[table_name] = daily_20111213[table_name]
print("日线行情-时间为序  daily_20111213 返回数据 row 行数 = "+str(daily_20111213.shape[0]))
daily_20111213_addname_dataframe.to_excel(daily_201112_excel_writer,'13_2',index=False)
daily_201112_excel_writer.save()
daily_20111214 = pro.daily(start_date='',end_date='',trade_date='20111214', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20111214_tscode_list = list() 
for ts_code_sh in daily_20111214['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20111214_tscode_list.append(stock_name)
daily_20111214_addname_dataframe=pd.DataFrame()
daily_20111214_addname_dataframe['cname'] = daily_20111214_tscode_list
for table_name in daily_20111214.columns.values.tolist():
    daily_20111214_addname_dataframe[table_name] = daily_20111214[table_name]
print("日线行情-时间为序  daily_20111214 返回数据 row 行数 = "+str(daily_20111214.shape[0]))
daily_20111214_addname_dataframe.to_excel(daily_201112_excel_writer,'14_3',index=False)
daily_201112_excel_writer.save()
daily_20111215 = pro.daily(start_date='',end_date='',trade_date='20111215', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20111215_tscode_list = list() 
for ts_code_sh in daily_20111215['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20111215_tscode_list.append(stock_name)
daily_20111215_addname_dataframe=pd.DataFrame()
daily_20111215_addname_dataframe['cname'] = daily_20111215_tscode_list
for table_name in daily_20111215.columns.values.tolist():
    daily_20111215_addname_dataframe[table_name] = daily_20111215[table_name]
print("日线行情-时间为序  daily_20111215 返回数据 row 行数 = "+str(daily_20111215.shape[0]))
daily_20111215_addname_dataframe.to_excel(daily_201112_excel_writer,'15_4',index=False)
daily_201112_excel_writer.save()
daily_20111216 = pro.daily(start_date='',end_date='',trade_date='20111216', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20111216_tscode_list = list() 
for ts_code_sh in daily_20111216['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20111216_tscode_list.append(stock_name)
daily_20111216_addname_dataframe=pd.DataFrame()
daily_20111216_addname_dataframe['cname'] = daily_20111216_tscode_list
for table_name in daily_20111216.columns.values.tolist():
    daily_20111216_addname_dataframe[table_name] = daily_20111216[table_name]
print("日线行情-时间为序  daily_20111216 返回数据 row 行数 = "+str(daily_20111216.shape[0]))
daily_20111216_addname_dataframe.to_excel(daily_201112_excel_writer,'16_5',index=False)
daily_201112_excel_writer.save()
daily_20111219 = pro.daily(start_date='',end_date='',trade_date='20111219', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20111219_tscode_list = list() 
for ts_code_sh in daily_20111219['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20111219_tscode_list.append(stock_name)
daily_20111219_addname_dataframe=pd.DataFrame()
daily_20111219_addname_dataframe['cname'] = daily_20111219_tscode_list
for table_name in daily_20111219.columns.values.tolist():
    daily_20111219_addname_dataframe[table_name] = daily_20111219[table_name]
print("日线行情-时间为序  daily_20111219 返回数据 row 行数 = "+str(daily_20111219.shape[0]))
daily_20111219_addname_dataframe.to_excel(daily_201112_excel_writer,'19_1',index=False)
daily_201112_excel_writer.save()
daily_20111220 = pro.daily(start_date='',end_date='',trade_date='20111220', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20111220_tscode_list = list() 
for ts_code_sh in daily_20111220['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20111220_tscode_list.append(stock_name)
daily_20111220_addname_dataframe=pd.DataFrame()
daily_20111220_addname_dataframe['cname'] = daily_20111220_tscode_list
for table_name in daily_20111220.columns.values.tolist():
    daily_20111220_addname_dataframe[table_name] = daily_20111220[table_name]
print("日线行情-时间为序  daily_20111220 返回数据 row 行数 = "+str(daily_20111220.shape[0]))
daily_20111220_addname_dataframe.to_excel(daily_201112_excel_writer,'20_2',index=False)
daily_201112_excel_writer.save()
daily_20111221 = pro.daily(start_date='',end_date='',trade_date='20111221', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20111221_tscode_list = list() 
for ts_code_sh in daily_20111221['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20111221_tscode_list.append(stock_name)
daily_20111221_addname_dataframe=pd.DataFrame()
daily_20111221_addname_dataframe['cname'] = daily_20111221_tscode_list
for table_name in daily_20111221.columns.values.tolist():
    daily_20111221_addname_dataframe[table_name] = daily_20111221[table_name]
print("日线行情-时间为序  daily_20111221 返回数据 row 行数 = "+str(daily_20111221.shape[0]))
daily_20111221_addname_dataframe.to_excel(daily_201112_excel_writer,'21_3',index=False)
daily_201112_excel_writer.save()
daily_20111222 = pro.daily(start_date='',end_date='',trade_date='20111222', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20111222_tscode_list = list() 
for ts_code_sh in daily_20111222['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20111222_tscode_list.append(stock_name)
daily_20111222_addname_dataframe=pd.DataFrame()
daily_20111222_addname_dataframe['cname'] = daily_20111222_tscode_list
for table_name in daily_20111222.columns.values.tolist():
    daily_20111222_addname_dataframe[table_name] = daily_20111222[table_name]
print("日线行情-时间为序  daily_20111222 返回数据 row 行数 = "+str(daily_20111222.shape[0]))
daily_20111222_addname_dataframe.to_excel(daily_201112_excel_writer,'22_4',index=False)
daily_201112_excel_writer.save()
daily_20111223 = pro.daily(start_date='',end_date='',trade_date='20111223', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20111223_tscode_list = list() 
for ts_code_sh in daily_20111223['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20111223_tscode_list.append(stock_name)
daily_20111223_addname_dataframe=pd.DataFrame()
daily_20111223_addname_dataframe['cname'] = daily_20111223_tscode_list
for table_name in daily_20111223.columns.values.tolist():
    daily_20111223_addname_dataframe[table_name] = daily_20111223[table_name]
print("日线行情-时间为序  daily_20111223 返回数据 row 行数 = "+str(daily_20111223.shape[0]))
daily_20111223_addname_dataframe.to_excel(daily_201112_excel_writer,'23_5',index=False)
daily_201112_excel_writer.save()
daily_20111226 = pro.daily(start_date='',end_date='',trade_date='20111226', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20111226_tscode_list = list() 
for ts_code_sh in daily_20111226['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20111226_tscode_list.append(stock_name)
daily_20111226_addname_dataframe=pd.DataFrame()
daily_20111226_addname_dataframe['cname'] = daily_20111226_tscode_list
for table_name in daily_20111226.columns.values.tolist():
    daily_20111226_addname_dataframe[table_name] = daily_20111226[table_name]
print("日线行情-时间为序  daily_20111226 返回数据 row 行数 = "+str(daily_20111226.shape[0]))
daily_20111226_addname_dataframe.to_excel(daily_201112_excel_writer,'26_1',index=False)
daily_201112_excel_writer.save()
daily_20111227 = pro.daily(start_date='',end_date='',trade_date='20111227', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20111227_tscode_list = list() 
for ts_code_sh in daily_20111227['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20111227_tscode_list.append(stock_name)
daily_20111227_addname_dataframe=pd.DataFrame()
daily_20111227_addname_dataframe['cname'] = daily_20111227_tscode_list
for table_name in daily_20111227.columns.values.tolist():
    daily_20111227_addname_dataframe[table_name] = daily_20111227[table_name]
print("日线行情-时间为序  daily_20111227 返回数据 row 行数 = "+str(daily_20111227.shape[0]))
daily_20111227_addname_dataframe.to_excel(daily_201112_excel_writer,'27_2',index=False)
daily_201112_excel_writer.save()
daily_20111228 = pro.daily(start_date='',end_date='',trade_date='20111228', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20111228_tscode_list = list() 
for ts_code_sh in daily_20111228['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20111228_tscode_list.append(stock_name)
daily_20111228_addname_dataframe=pd.DataFrame()
daily_20111228_addname_dataframe['cname'] = daily_20111228_tscode_list
for table_name in daily_20111228.columns.values.tolist():
    daily_20111228_addname_dataframe[table_name] = daily_20111228[table_name]
print("日线行情-时间为序  daily_20111228 返回数据 row 行数 = "+str(daily_20111228.shape[0]))
daily_20111228_addname_dataframe.to_excel(daily_201112_excel_writer,'28_3',index=False)
daily_201112_excel_writer.save()
daily_20111229 = pro.daily(start_date='',end_date='',trade_date='20111229', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20111229_tscode_list = list() 
for ts_code_sh in daily_20111229['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20111229_tscode_list.append(stock_name)
daily_20111229_addname_dataframe=pd.DataFrame()
daily_20111229_addname_dataframe['cname'] = daily_20111229_tscode_list
for table_name in daily_20111229.columns.values.tolist():
    daily_20111229_addname_dataframe[table_name] = daily_20111229[table_name]
print("日线行情-时间为序  daily_20111229 返回数据 row 行数 = "+str(daily_20111229.shape[0]))
daily_20111229_addname_dataframe.to_excel(daily_201112_excel_writer,'29_4',index=False)
daily_201112_excel_writer.save()
daily_20111230 = pro.daily(start_date='',end_date='',trade_date='20111230', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20111230_tscode_list = list() 
for ts_code_sh in daily_20111230['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20111230_tscode_list.append(stock_name)
daily_20111230_addname_dataframe=pd.DataFrame()
daily_20111230_addname_dataframe['cname'] = daily_20111230_tscode_list
for table_name in daily_20111230.columns.values.tolist():
    daily_20111230_addname_dataframe[table_name] = daily_20111230[table_name]
print("日线行情-时间为序  daily_20111230 返回数据 row 行数 = "+str(daily_20111230.shape[0]))
daily_20111230_addname_dataframe.to_excel(daily_201112_excel_writer,'30_5',index=False)
daily_201112_excel_writer.save()




createexcel('daily_201201.xlsx')
daily_201201_book = load_workbook('C:\\Users\\zhuzj5\\Desktop\\zbin\\J0_Data\\daily_201201.xlsx')
daily_201201_excel_writer = pd.ExcelWriter('C:\\Users\\zhuzj5\\Desktop\\zbin\\J0_Data\\daily_201201.xlsx', engine='openpyxl')
daily_201201_excel_writer.book = daily_201201_book
daily_201201_excel_writer.sheets = dict((ws.title, ws) for ws in daily_201201_book.worksheets)
J0_PROPS.put(tree_node_name+"record_date", "20120101")       ###  更新 记录日期
daily_20120104 = pro.daily(start_date='',end_date='',trade_date='20120104', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20120104_tscode_list = list() 
for ts_code_sh in daily_20120104['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20120104_tscode_list.append(stock_name)
daily_20120104_addname_dataframe=pd.DataFrame()
daily_20120104_addname_dataframe['cname'] = daily_20120104_tscode_list
for table_name in daily_20120104.columns.values.tolist():
    daily_20120104_addname_dataframe[table_name] = daily_20120104[table_name]
print("日线行情-时间为序  daily_20120104 返回数据 row 行数 = "+str(daily_20120104.shape[0]))
daily_20120104_addname_dataframe.to_excel(daily_201201_excel_writer,'4_3',index=False)
daily_201201_excel_writer.save()
daily_20120105 = pro.daily(start_date='',end_date='',trade_date='20120105', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20120105_tscode_list = list() 
for ts_code_sh in daily_20120105['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20120105_tscode_list.append(stock_name)
daily_20120105_addname_dataframe=pd.DataFrame()
daily_20120105_addname_dataframe['cname'] = daily_20120105_tscode_list
for table_name in daily_20120105.columns.values.tolist():
    daily_20120105_addname_dataframe[table_name] = daily_20120105[table_name]
print("日线行情-时间为序  daily_20120105 返回数据 row 行数 = "+str(daily_20120105.shape[0]))
daily_20120105_addname_dataframe.to_excel(daily_201201_excel_writer,'5_4',index=False)
daily_201201_excel_writer.save()
daily_20120106 = pro.daily(start_date='',end_date='',trade_date='20120106', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20120106_tscode_list = list() 
for ts_code_sh in daily_20120106['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20120106_tscode_list.append(stock_name)
daily_20120106_addname_dataframe=pd.DataFrame()
daily_20120106_addname_dataframe['cname'] = daily_20120106_tscode_list
for table_name in daily_20120106.columns.values.tolist():
    daily_20120106_addname_dataframe[table_name] = daily_20120106[table_name]
print("日线行情-时间为序  daily_20120106 返回数据 row 行数 = "+str(daily_20120106.shape[0]))
daily_20120106_addname_dataframe.to_excel(daily_201201_excel_writer,'6_5',index=False)
daily_201201_excel_writer.save()
daily_20120109 = pro.daily(start_date='',end_date='',trade_date='20120109', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20120109_tscode_list = list() 
for ts_code_sh in daily_20120109['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20120109_tscode_list.append(stock_name)
daily_20120109_addname_dataframe=pd.DataFrame()
daily_20120109_addname_dataframe['cname'] = daily_20120109_tscode_list
for table_name in daily_20120109.columns.values.tolist():
    daily_20120109_addname_dataframe[table_name] = daily_20120109[table_name]
print("日线行情-时间为序  daily_20120109 返回数据 row 行数 = "+str(daily_20120109.shape[0]))
daily_20120109_addname_dataframe.to_excel(daily_201201_excel_writer,'9_1',index=False)
daily_201201_excel_writer.save()
daily_20120110 = pro.daily(start_date='',end_date='',trade_date='20120110', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20120110_tscode_list = list() 
for ts_code_sh in daily_20120110['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20120110_tscode_list.append(stock_name)
daily_20120110_addname_dataframe=pd.DataFrame()
daily_20120110_addname_dataframe['cname'] = daily_20120110_tscode_list
for table_name in daily_20120110.columns.values.tolist():
    daily_20120110_addname_dataframe[table_name] = daily_20120110[table_name]
print("日线行情-时间为序  daily_20120110 返回数据 row 行数 = "+str(daily_20120110.shape[0]))
daily_20120110_addname_dataframe.to_excel(daily_201201_excel_writer,'10_2',index=False)
daily_201201_excel_writer.save()
daily_20120111 = pro.daily(start_date='',end_date='',trade_date='20120111', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20120111_tscode_list = list() 
for ts_code_sh in daily_20120111['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20120111_tscode_list.append(stock_name)
daily_20120111_addname_dataframe=pd.DataFrame()
daily_20120111_addname_dataframe['cname'] = daily_20120111_tscode_list
for table_name in daily_20120111.columns.values.tolist():
    daily_20120111_addname_dataframe[table_name] = daily_20120111[table_name]
print("日线行情-时间为序  daily_20120111 返回数据 row 行数 = "+str(daily_20120111.shape[0]))
daily_20120111_addname_dataframe.to_excel(daily_201201_excel_writer,'11_3',index=False)
daily_201201_excel_writer.save()
daily_20120112 = pro.daily(start_date='',end_date='',trade_date='20120112', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20120112_tscode_list = list() 
for ts_code_sh in daily_20120112['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20120112_tscode_list.append(stock_name)
daily_20120112_addname_dataframe=pd.DataFrame()
daily_20120112_addname_dataframe['cname'] = daily_20120112_tscode_list
for table_name in daily_20120112.columns.values.tolist():
    daily_20120112_addname_dataframe[table_name] = daily_20120112[table_name]
print("日线行情-时间为序  daily_20120112 返回数据 row 行数 = "+str(daily_20120112.shape[0]))
daily_20120112_addname_dataframe.to_excel(daily_201201_excel_writer,'12_4',index=False)
daily_201201_excel_writer.save()
daily_20120113 = pro.daily(start_date='',end_date='',trade_date='20120113', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20120113_tscode_list = list() 
for ts_code_sh in daily_20120113['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20120113_tscode_list.append(stock_name)
daily_20120113_addname_dataframe=pd.DataFrame()
daily_20120113_addname_dataframe['cname'] = daily_20120113_tscode_list
for table_name in daily_20120113.columns.values.tolist():
    daily_20120113_addname_dataframe[table_name] = daily_20120113[table_name]
print("日线行情-时间为序  daily_20120113 返回数据 row 行数 = "+str(daily_20120113.shape[0]))
daily_20120113_addname_dataframe.to_excel(daily_201201_excel_writer,'13_5',index=False)
daily_201201_excel_writer.save()
daily_20120116 = pro.daily(start_date='',end_date='',trade_date='20120116', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20120116_tscode_list = list() 
for ts_code_sh in daily_20120116['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20120116_tscode_list.append(stock_name)
daily_20120116_addname_dataframe=pd.DataFrame()
daily_20120116_addname_dataframe['cname'] = daily_20120116_tscode_list
for table_name in daily_20120116.columns.values.tolist():
    daily_20120116_addname_dataframe[table_name] = daily_20120116[table_name]
print("日线行情-时间为序  daily_20120116 返回数据 row 行数 = "+str(daily_20120116.shape[0]))
daily_20120116_addname_dataframe.to_excel(daily_201201_excel_writer,'16_1',index=False)
daily_201201_excel_writer.save()
daily_20120117 = pro.daily(start_date='',end_date='',trade_date='20120117', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20120117_tscode_list = list() 
for ts_code_sh in daily_20120117['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20120117_tscode_list.append(stock_name)
daily_20120117_addname_dataframe=pd.DataFrame()
daily_20120117_addname_dataframe['cname'] = daily_20120117_tscode_list
for table_name in daily_20120117.columns.values.tolist():
    daily_20120117_addname_dataframe[table_name] = daily_20120117[table_name]
print("日线行情-时间为序  daily_20120117 返回数据 row 行数 = "+str(daily_20120117.shape[0]))
daily_20120117_addname_dataframe.to_excel(daily_201201_excel_writer,'17_2',index=False)
daily_201201_excel_writer.save()
daily_20120118 = pro.daily(start_date='',end_date='',trade_date='20120118', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20120118_tscode_list = list() 
for ts_code_sh in daily_20120118['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20120118_tscode_list.append(stock_name)
daily_20120118_addname_dataframe=pd.DataFrame()
daily_20120118_addname_dataframe['cname'] = daily_20120118_tscode_list
for table_name in daily_20120118.columns.values.tolist():
    daily_20120118_addname_dataframe[table_name] = daily_20120118[table_name]
print("日线行情-时间为序  daily_20120118 返回数据 row 行数 = "+str(daily_20120118.shape[0]))
daily_20120118_addname_dataframe.to_excel(daily_201201_excel_writer,'18_3',index=False)
daily_201201_excel_writer.save()
daily_20120119 = pro.daily(start_date='',end_date='',trade_date='20120119', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20120119_tscode_list = list() 
for ts_code_sh in daily_20120119['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20120119_tscode_list.append(stock_name)
daily_20120119_addname_dataframe=pd.DataFrame()
daily_20120119_addname_dataframe['cname'] = daily_20120119_tscode_list
for table_name in daily_20120119.columns.values.tolist():
    daily_20120119_addname_dataframe[table_name] = daily_20120119[table_name]
print("日线行情-时间为序  daily_20120119 返回数据 row 行数 = "+str(daily_20120119.shape[0]))
daily_20120119_addname_dataframe.to_excel(daily_201201_excel_writer,'19_4',index=False)
daily_201201_excel_writer.save()
daily_20120120 = pro.daily(start_date='',end_date='',trade_date='20120120', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20120120_tscode_list = list() 
for ts_code_sh in daily_20120120['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20120120_tscode_list.append(stock_name)
daily_20120120_addname_dataframe=pd.DataFrame()
daily_20120120_addname_dataframe['cname'] = daily_20120120_tscode_list
for table_name in daily_20120120.columns.values.tolist():
    daily_20120120_addname_dataframe[table_name] = daily_20120120[table_name]
print("日线行情-时间为序  daily_20120120 返回数据 row 行数 = "+str(daily_20120120.shape[0]))
daily_20120120_addname_dataframe.to_excel(daily_201201_excel_writer,'20_5',index=False)
daily_201201_excel_writer.save()
daily_20120130 = pro.daily(start_date='',end_date='',trade_date='20120130', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20120130_tscode_list = list() 
for ts_code_sh in daily_20120130['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20120130_tscode_list.append(stock_name)
daily_20120130_addname_dataframe=pd.DataFrame()
daily_20120130_addname_dataframe['cname'] = daily_20120130_tscode_list
for table_name in daily_20120130.columns.values.tolist():
    daily_20120130_addname_dataframe[table_name] = daily_20120130[table_name]
print("日线行情-时间为序  daily_20120130 返回数据 row 行数 = "+str(daily_20120130.shape[0]))
daily_20120130_addname_dataframe.to_excel(daily_201201_excel_writer,'30_1',index=False)
daily_201201_excel_writer.save()
daily_20120131 = pro.daily(start_date='',end_date='',trade_date='20120131', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20120131_tscode_list = list() 
for ts_code_sh in daily_20120131['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20120131_tscode_list.append(stock_name)
daily_20120131_addname_dataframe=pd.DataFrame()
daily_20120131_addname_dataframe['cname'] = daily_20120131_tscode_list
for table_name in daily_20120131.columns.values.tolist():
    daily_20120131_addname_dataframe[table_name] = daily_20120131[table_name]
print("日线行情-时间为序  daily_20120131 返回数据 row 行数 = "+str(daily_20120131.shape[0]))
daily_20120131_addname_dataframe.to_excel(daily_201201_excel_writer,'31_2',index=False)
daily_201201_excel_writer.save()




createexcel('daily_201202.xlsx')
daily_201202_book = load_workbook('C:\\Users\\zhuzj5\\Desktop\\zbin\\J0_Data\\daily_201202.xlsx')
daily_201202_excel_writer = pd.ExcelWriter('C:\\Users\\zhuzj5\\Desktop\\zbin\\J0_Data\\daily_201202.xlsx', engine='openpyxl')
daily_201202_excel_writer.book = daily_201202_book
daily_201202_excel_writer.sheets = dict((ws.title, ws) for ws in daily_201202_book.worksheets)
J0_PROPS.put(tree_node_name+"record_date", "20120201")       ###  更新 记录日期
daily_20120201 = pro.daily(start_date='',end_date='',trade_date='20120201', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20120201_tscode_list = list() 
for ts_code_sh in daily_20120201['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20120201_tscode_list.append(stock_name)
daily_20120201_addname_dataframe=pd.DataFrame()
daily_20120201_addname_dataframe['cname'] = daily_20120201_tscode_list
for table_name in daily_20120201.columns.values.tolist():
    daily_20120201_addname_dataframe[table_name] = daily_20120201[table_name]
print("日线行情-时间为序  daily_20120201 返回数据 row 行数 = "+str(daily_20120201.shape[0]))
daily_20120201_addname_dataframe.to_excel(daily_201202_excel_writer,'1_3',index=False)
daily_201202_excel_writer.save()
daily_20120202 = pro.daily(start_date='',end_date='',trade_date='20120202', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20120202_tscode_list = list() 
for ts_code_sh in daily_20120202['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20120202_tscode_list.append(stock_name)
daily_20120202_addname_dataframe=pd.DataFrame()
daily_20120202_addname_dataframe['cname'] = daily_20120202_tscode_list
for table_name in daily_20120202.columns.values.tolist():
    daily_20120202_addname_dataframe[table_name] = daily_20120202[table_name]
print("日线行情-时间为序  daily_20120202 返回数据 row 行数 = "+str(daily_20120202.shape[0]))
daily_20120202_addname_dataframe.to_excel(daily_201202_excel_writer,'2_4',index=False)
daily_201202_excel_writer.save()
daily_20120203 = pro.daily(start_date='',end_date='',trade_date='20120203', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20120203_tscode_list = list() 
for ts_code_sh in daily_20120203['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20120203_tscode_list.append(stock_name)
daily_20120203_addname_dataframe=pd.DataFrame()
daily_20120203_addname_dataframe['cname'] = daily_20120203_tscode_list
for table_name in daily_20120203.columns.values.tolist():
    daily_20120203_addname_dataframe[table_name] = daily_20120203[table_name]
print("日线行情-时间为序  daily_20120203 返回数据 row 行数 = "+str(daily_20120203.shape[0]))
daily_20120203_addname_dataframe.to_excel(daily_201202_excel_writer,'3_5',index=False)
daily_201202_excel_writer.save()
daily_20120206 = pro.daily(start_date='',end_date='',trade_date='20120206', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20120206_tscode_list = list() 
for ts_code_sh in daily_20120206['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20120206_tscode_list.append(stock_name)
daily_20120206_addname_dataframe=pd.DataFrame()
daily_20120206_addname_dataframe['cname'] = daily_20120206_tscode_list
for table_name in daily_20120206.columns.values.tolist():
    daily_20120206_addname_dataframe[table_name] = daily_20120206[table_name]
print("日线行情-时间为序  daily_20120206 返回数据 row 行数 = "+str(daily_20120206.shape[0]))
daily_20120206_addname_dataframe.to_excel(daily_201202_excel_writer,'6_1',index=False)
daily_201202_excel_writer.save()
daily_20120207 = pro.daily(start_date='',end_date='',trade_date='20120207', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20120207_tscode_list = list() 
for ts_code_sh in daily_20120207['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20120207_tscode_list.append(stock_name)
daily_20120207_addname_dataframe=pd.DataFrame()
daily_20120207_addname_dataframe['cname'] = daily_20120207_tscode_list
for table_name in daily_20120207.columns.values.tolist():
    daily_20120207_addname_dataframe[table_name] = daily_20120207[table_name]
print("日线行情-时间为序  daily_20120207 返回数据 row 行数 = "+str(daily_20120207.shape[0]))
daily_20120207_addname_dataframe.to_excel(daily_201202_excel_writer,'7_2',index=False)
daily_201202_excel_writer.save()
daily_20120208 = pro.daily(start_date='',end_date='',trade_date='20120208', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20120208_tscode_list = list() 
for ts_code_sh in daily_20120208['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20120208_tscode_list.append(stock_name)
daily_20120208_addname_dataframe=pd.DataFrame()
daily_20120208_addname_dataframe['cname'] = daily_20120208_tscode_list
for table_name in daily_20120208.columns.values.tolist():
    daily_20120208_addname_dataframe[table_name] = daily_20120208[table_name]
print("日线行情-时间为序  daily_20120208 返回数据 row 行数 = "+str(daily_20120208.shape[0]))
daily_20120208_addname_dataframe.to_excel(daily_201202_excel_writer,'8_3',index=False)
daily_201202_excel_writer.save()
daily_20120209 = pro.daily(start_date='',end_date='',trade_date='20120209', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20120209_tscode_list = list() 
for ts_code_sh in daily_20120209['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20120209_tscode_list.append(stock_name)
daily_20120209_addname_dataframe=pd.DataFrame()
daily_20120209_addname_dataframe['cname'] = daily_20120209_tscode_list
for table_name in daily_20120209.columns.values.tolist():
    daily_20120209_addname_dataframe[table_name] = daily_20120209[table_name]
print("日线行情-时间为序  daily_20120209 返回数据 row 行数 = "+str(daily_20120209.shape[0]))
daily_20120209_addname_dataframe.to_excel(daily_201202_excel_writer,'9_4',index=False)
daily_201202_excel_writer.save()
daily_20120210 = pro.daily(start_date='',end_date='',trade_date='20120210', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20120210_tscode_list = list() 
for ts_code_sh in daily_20120210['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20120210_tscode_list.append(stock_name)
daily_20120210_addname_dataframe=pd.DataFrame()
daily_20120210_addname_dataframe['cname'] = daily_20120210_tscode_list
for table_name in daily_20120210.columns.values.tolist():
    daily_20120210_addname_dataframe[table_name] = daily_20120210[table_name]
print("日线行情-时间为序  daily_20120210 返回数据 row 行数 = "+str(daily_20120210.shape[0]))
daily_20120210_addname_dataframe.to_excel(daily_201202_excel_writer,'10_5',index=False)
daily_201202_excel_writer.save()
daily_20120213 = pro.daily(start_date='',end_date='',trade_date='20120213', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20120213_tscode_list = list() 
for ts_code_sh in daily_20120213['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20120213_tscode_list.append(stock_name)
daily_20120213_addname_dataframe=pd.DataFrame()
daily_20120213_addname_dataframe['cname'] = daily_20120213_tscode_list
for table_name in daily_20120213.columns.values.tolist():
    daily_20120213_addname_dataframe[table_name] = daily_20120213[table_name]
print("日线行情-时间为序  daily_20120213 返回数据 row 行数 = "+str(daily_20120213.shape[0]))
daily_20120213_addname_dataframe.to_excel(daily_201202_excel_writer,'13_1',index=False)
daily_201202_excel_writer.save()
daily_20120214 = pro.daily(start_date='',end_date='',trade_date='20120214', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20120214_tscode_list = list() 
for ts_code_sh in daily_20120214['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20120214_tscode_list.append(stock_name)
daily_20120214_addname_dataframe=pd.DataFrame()
daily_20120214_addname_dataframe['cname'] = daily_20120214_tscode_list
for table_name in daily_20120214.columns.values.tolist():
    daily_20120214_addname_dataframe[table_name] = daily_20120214[table_name]
print("日线行情-时间为序  daily_20120214 返回数据 row 行数 = "+str(daily_20120214.shape[0]))
daily_20120214_addname_dataframe.to_excel(daily_201202_excel_writer,'14_2',index=False)
daily_201202_excel_writer.save()
daily_20120215 = pro.daily(start_date='',end_date='',trade_date='20120215', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20120215_tscode_list = list() 
for ts_code_sh in daily_20120215['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20120215_tscode_list.append(stock_name)
daily_20120215_addname_dataframe=pd.DataFrame()
daily_20120215_addname_dataframe['cname'] = daily_20120215_tscode_list
for table_name in daily_20120215.columns.values.tolist():
    daily_20120215_addname_dataframe[table_name] = daily_20120215[table_name]
print("日线行情-时间为序  daily_20120215 返回数据 row 行数 = "+str(daily_20120215.shape[0]))
daily_20120215_addname_dataframe.to_excel(daily_201202_excel_writer,'15_3',index=False)
daily_201202_excel_writer.save()
daily_20120216 = pro.daily(start_date='',end_date='',trade_date='20120216', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20120216_tscode_list = list() 
for ts_code_sh in daily_20120216['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20120216_tscode_list.append(stock_name)
daily_20120216_addname_dataframe=pd.DataFrame()
daily_20120216_addname_dataframe['cname'] = daily_20120216_tscode_list
for table_name in daily_20120216.columns.values.tolist():
    daily_20120216_addname_dataframe[table_name] = daily_20120216[table_name]
print("日线行情-时间为序  daily_20120216 返回数据 row 行数 = "+str(daily_20120216.shape[0]))
daily_20120216_addname_dataframe.to_excel(daily_201202_excel_writer,'16_4',index=False)
daily_201202_excel_writer.save()
daily_20120217 = pro.daily(start_date='',end_date='',trade_date='20120217', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20120217_tscode_list = list() 
for ts_code_sh in daily_20120217['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20120217_tscode_list.append(stock_name)
daily_20120217_addname_dataframe=pd.DataFrame()
daily_20120217_addname_dataframe['cname'] = daily_20120217_tscode_list
for table_name in daily_20120217.columns.values.tolist():
    daily_20120217_addname_dataframe[table_name] = daily_20120217[table_name]
print("日线行情-时间为序  daily_20120217 返回数据 row 行数 = "+str(daily_20120217.shape[0]))
daily_20120217_addname_dataframe.to_excel(daily_201202_excel_writer,'17_5',index=False)
daily_201202_excel_writer.save()
daily_20120220 = pro.daily(start_date='',end_date='',trade_date='20120220', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20120220_tscode_list = list() 
for ts_code_sh in daily_20120220['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20120220_tscode_list.append(stock_name)
daily_20120220_addname_dataframe=pd.DataFrame()
daily_20120220_addname_dataframe['cname'] = daily_20120220_tscode_list
for table_name in daily_20120220.columns.values.tolist():
    daily_20120220_addname_dataframe[table_name] = daily_20120220[table_name]
print("日线行情-时间为序  daily_20120220 返回数据 row 行数 = "+str(daily_20120220.shape[0]))
daily_20120220_addname_dataframe.to_excel(daily_201202_excel_writer,'20_1',index=False)
daily_201202_excel_writer.save()
daily_20120221 = pro.daily(start_date='',end_date='',trade_date='20120221', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20120221_tscode_list = list() 
for ts_code_sh in daily_20120221['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20120221_tscode_list.append(stock_name)
daily_20120221_addname_dataframe=pd.DataFrame()
daily_20120221_addname_dataframe['cname'] = daily_20120221_tscode_list
for table_name in daily_20120221.columns.values.tolist():
    daily_20120221_addname_dataframe[table_name] = daily_20120221[table_name]
print("日线行情-时间为序  daily_20120221 返回数据 row 行数 = "+str(daily_20120221.shape[0]))
daily_20120221_addname_dataframe.to_excel(daily_201202_excel_writer,'21_2',index=False)
daily_201202_excel_writer.save()
daily_20120222 = pro.daily(start_date='',end_date='',trade_date='20120222', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20120222_tscode_list = list() 
for ts_code_sh in daily_20120222['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20120222_tscode_list.append(stock_name)
daily_20120222_addname_dataframe=pd.DataFrame()
daily_20120222_addname_dataframe['cname'] = daily_20120222_tscode_list
for table_name in daily_20120222.columns.values.tolist():
    daily_20120222_addname_dataframe[table_name] = daily_20120222[table_name]
print("日线行情-时间为序  daily_20120222 返回数据 row 行数 = "+str(daily_20120222.shape[0]))
daily_20120222_addname_dataframe.to_excel(daily_201202_excel_writer,'22_3',index=False)
daily_201202_excel_writer.save()
daily_20120223 = pro.daily(start_date='',end_date='',trade_date='20120223', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20120223_tscode_list = list() 
for ts_code_sh in daily_20120223['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20120223_tscode_list.append(stock_name)
daily_20120223_addname_dataframe=pd.DataFrame()
daily_20120223_addname_dataframe['cname'] = daily_20120223_tscode_list
for table_name in daily_20120223.columns.values.tolist():
    daily_20120223_addname_dataframe[table_name] = daily_20120223[table_name]
print("日线行情-时间为序  daily_20120223 返回数据 row 行数 = "+str(daily_20120223.shape[0]))
daily_20120223_addname_dataframe.to_excel(daily_201202_excel_writer,'23_4',index=False)
daily_201202_excel_writer.save()
daily_20120224 = pro.daily(start_date='',end_date='',trade_date='20120224', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20120224_tscode_list = list() 
for ts_code_sh in daily_20120224['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20120224_tscode_list.append(stock_name)
daily_20120224_addname_dataframe=pd.DataFrame()
daily_20120224_addname_dataframe['cname'] = daily_20120224_tscode_list
for table_name in daily_20120224.columns.values.tolist():
    daily_20120224_addname_dataframe[table_name] = daily_20120224[table_name]
print("日线行情-时间为序  daily_20120224 返回数据 row 行数 = "+str(daily_20120224.shape[0]))
daily_20120224_addname_dataframe.to_excel(daily_201202_excel_writer,'24_5',index=False)
daily_201202_excel_writer.save()
daily_20120227 = pro.daily(start_date='',end_date='',trade_date='20120227', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20120227_tscode_list = list() 
for ts_code_sh in daily_20120227['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20120227_tscode_list.append(stock_name)
daily_20120227_addname_dataframe=pd.DataFrame()
daily_20120227_addname_dataframe['cname'] = daily_20120227_tscode_list
for table_name in daily_20120227.columns.values.tolist():
    daily_20120227_addname_dataframe[table_name] = daily_20120227[table_name]
print("日线行情-时间为序  daily_20120227 返回数据 row 行数 = "+str(daily_20120227.shape[0]))
daily_20120227_addname_dataframe.to_excel(daily_201202_excel_writer,'27_1',index=False)
daily_201202_excel_writer.save()
daily_20120228 = pro.daily(start_date='',end_date='',trade_date='20120228', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20120228_tscode_list = list() 
for ts_code_sh in daily_20120228['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20120228_tscode_list.append(stock_name)
daily_20120228_addname_dataframe=pd.DataFrame()
daily_20120228_addname_dataframe['cname'] = daily_20120228_tscode_list
for table_name in daily_20120228.columns.values.tolist():
    daily_20120228_addname_dataframe[table_name] = daily_20120228[table_name]
print("日线行情-时间为序  daily_20120228 返回数据 row 行数 = "+str(daily_20120228.shape[0]))
daily_20120228_addname_dataframe.to_excel(daily_201202_excel_writer,'28_2',index=False)
daily_201202_excel_writer.save()
daily_20120229 = pro.daily(start_date='',end_date='',trade_date='20120229', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20120229_tscode_list = list() 
for ts_code_sh in daily_20120229['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20120229_tscode_list.append(stock_name)
daily_20120229_addname_dataframe=pd.DataFrame()
daily_20120229_addname_dataframe['cname'] = daily_20120229_tscode_list
for table_name in daily_20120229.columns.values.tolist():
    daily_20120229_addname_dataframe[table_name] = daily_20120229[table_name]
print("日线行情-时间为序  daily_20120229 返回数据 row 行数 = "+str(daily_20120229.shape[0]))
daily_20120229_addname_dataframe.to_excel(daily_201202_excel_writer,'29_3',index=False)
daily_201202_excel_writer.save()




createexcel('daily_201203.xlsx')
daily_201203_book = load_workbook('C:\\Users\\zhuzj5\\Desktop\\zbin\\J0_Data\\daily_201203.xlsx')
daily_201203_excel_writer = pd.ExcelWriter('C:\\Users\\zhuzj5\\Desktop\\zbin\\J0_Data\\daily_201203.xlsx', engine='openpyxl')
daily_201203_excel_writer.book = daily_201203_book
daily_201203_excel_writer.sheets = dict((ws.title, ws) for ws in daily_201203_book.worksheets)
J0_PROPS.put(tree_node_name+"record_date", "20120301")       ###  更新 记录日期
daily_20120301 = pro.daily(start_date='',end_date='',trade_date='20120301', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20120301_tscode_list = list() 
for ts_code_sh in daily_20120301['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20120301_tscode_list.append(stock_name)
daily_20120301_addname_dataframe=pd.DataFrame()
daily_20120301_addname_dataframe['cname'] = daily_20120301_tscode_list
for table_name in daily_20120301.columns.values.tolist():
    daily_20120301_addname_dataframe[table_name] = daily_20120301[table_name]
print("日线行情-时间为序  daily_20120301 返回数据 row 行数 = "+str(daily_20120301.shape[0]))
daily_20120301_addname_dataframe.to_excel(daily_201203_excel_writer,'1_4',index=False)
daily_201203_excel_writer.save()
daily_20120302 = pro.daily(start_date='',end_date='',trade_date='20120302', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20120302_tscode_list = list() 
for ts_code_sh in daily_20120302['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20120302_tscode_list.append(stock_name)
daily_20120302_addname_dataframe=pd.DataFrame()
daily_20120302_addname_dataframe['cname'] = daily_20120302_tscode_list
for table_name in daily_20120302.columns.values.tolist():
    daily_20120302_addname_dataframe[table_name] = daily_20120302[table_name]
print("日线行情-时间为序  daily_20120302 返回数据 row 行数 = "+str(daily_20120302.shape[0]))
daily_20120302_addname_dataframe.to_excel(daily_201203_excel_writer,'2_5',index=False)
daily_201203_excel_writer.save()
daily_20120305 = pro.daily(start_date='',end_date='',trade_date='20120305', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20120305_tscode_list = list() 
for ts_code_sh in daily_20120305['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20120305_tscode_list.append(stock_name)
daily_20120305_addname_dataframe=pd.DataFrame()
daily_20120305_addname_dataframe['cname'] = daily_20120305_tscode_list
for table_name in daily_20120305.columns.values.tolist():
    daily_20120305_addname_dataframe[table_name] = daily_20120305[table_name]
print("日线行情-时间为序  daily_20120305 返回数据 row 行数 = "+str(daily_20120305.shape[0]))
daily_20120305_addname_dataframe.to_excel(daily_201203_excel_writer,'5_1',index=False)
daily_201203_excel_writer.save()
daily_20120306 = pro.daily(start_date='',end_date='',trade_date='20120306', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20120306_tscode_list = list() 
for ts_code_sh in daily_20120306['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20120306_tscode_list.append(stock_name)
daily_20120306_addname_dataframe=pd.DataFrame()
daily_20120306_addname_dataframe['cname'] = daily_20120306_tscode_list
for table_name in daily_20120306.columns.values.tolist():
    daily_20120306_addname_dataframe[table_name] = daily_20120306[table_name]
print("日线行情-时间为序  daily_20120306 返回数据 row 行数 = "+str(daily_20120306.shape[0]))
daily_20120306_addname_dataframe.to_excel(daily_201203_excel_writer,'6_2',index=False)
daily_201203_excel_writer.save()
daily_20120307 = pro.daily(start_date='',end_date='',trade_date='20120307', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20120307_tscode_list = list() 
for ts_code_sh in daily_20120307['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20120307_tscode_list.append(stock_name)
daily_20120307_addname_dataframe=pd.DataFrame()
daily_20120307_addname_dataframe['cname'] = daily_20120307_tscode_list
for table_name in daily_20120307.columns.values.tolist():
    daily_20120307_addname_dataframe[table_name] = daily_20120307[table_name]
print("日线行情-时间为序  daily_20120307 返回数据 row 行数 = "+str(daily_20120307.shape[0]))
daily_20120307_addname_dataframe.to_excel(daily_201203_excel_writer,'7_3',index=False)
daily_201203_excel_writer.save()
daily_20120308 = pro.daily(start_date='',end_date='',trade_date='20120308', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20120308_tscode_list = list() 
for ts_code_sh in daily_20120308['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20120308_tscode_list.append(stock_name)
daily_20120308_addname_dataframe=pd.DataFrame()
daily_20120308_addname_dataframe['cname'] = daily_20120308_tscode_list
for table_name in daily_20120308.columns.values.tolist():
    daily_20120308_addname_dataframe[table_name] = daily_20120308[table_name]
print("日线行情-时间为序  daily_20120308 返回数据 row 行数 = "+str(daily_20120308.shape[0]))
daily_20120308_addname_dataframe.to_excel(daily_201203_excel_writer,'8_4',index=False)
daily_201203_excel_writer.save()
daily_20120309 = pro.daily(start_date='',end_date='',trade_date='20120309', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20120309_tscode_list = list() 
for ts_code_sh in daily_20120309['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20120309_tscode_list.append(stock_name)
daily_20120309_addname_dataframe=pd.DataFrame()
daily_20120309_addname_dataframe['cname'] = daily_20120309_tscode_list
for table_name in daily_20120309.columns.values.tolist():
    daily_20120309_addname_dataframe[table_name] = daily_20120309[table_name]
print("日线行情-时间为序  daily_20120309 返回数据 row 行数 = "+str(daily_20120309.shape[0]))
daily_20120309_addname_dataframe.to_excel(daily_201203_excel_writer,'9_5',index=False)
daily_201203_excel_writer.save()
daily_20120312 = pro.daily(start_date='',end_date='',trade_date='20120312', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20120312_tscode_list = list() 
for ts_code_sh in daily_20120312['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20120312_tscode_list.append(stock_name)
daily_20120312_addname_dataframe=pd.DataFrame()
daily_20120312_addname_dataframe['cname'] = daily_20120312_tscode_list
for table_name in daily_20120312.columns.values.tolist():
    daily_20120312_addname_dataframe[table_name] = daily_20120312[table_name]
print("日线行情-时间为序  daily_20120312 返回数据 row 行数 = "+str(daily_20120312.shape[0]))
daily_20120312_addname_dataframe.to_excel(daily_201203_excel_writer,'12_1',index=False)
daily_201203_excel_writer.save()
daily_20120313 = pro.daily(start_date='',end_date='',trade_date='20120313', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20120313_tscode_list = list() 
for ts_code_sh in daily_20120313['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20120313_tscode_list.append(stock_name)
daily_20120313_addname_dataframe=pd.DataFrame()
daily_20120313_addname_dataframe['cname'] = daily_20120313_tscode_list
for table_name in daily_20120313.columns.values.tolist():
    daily_20120313_addname_dataframe[table_name] = daily_20120313[table_name]
print("日线行情-时间为序  daily_20120313 返回数据 row 行数 = "+str(daily_20120313.shape[0]))
daily_20120313_addname_dataframe.to_excel(daily_201203_excel_writer,'13_2',index=False)
daily_201203_excel_writer.save()
daily_20120314 = pro.daily(start_date='',end_date='',trade_date='20120314', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20120314_tscode_list = list() 
for ts_code_sh in daily_20120314['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20120314_tscode_list.append(stock_name)
daily_20120314_addname_dataframe=pd.DataFrame()
daily_20120314_addname_dataframe['cname'] = daily_20120314_tscode_list
for table_name in daily_20120314.columns.values.tolist():
    daily_20120314_addname_dataframe[table_name] = daily_20120314[table_name]
print("日线行情-时间为序  daily_20120314 返回数据 row 行数 = "+str(daily_20120314.shape[0]))
daily_20120314_addname_dataframe.to_excel(daily_201203_excel_writer,'14_3',index=False)
daily_201203_excel_writer.save()
daily_20120315 = pro.daily(start_date='',end_date='',trade_date='20120315', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20120315_tscode_list = list() 
for ts_code_sh in daily_20120315['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20120315_tscode_list.append(stock_name)
daily_20120315_addname_dataframe=pd.DataFrame()
daily_20120315_addname_dataframe['cname'] = daily_20120315_tscode_list
for table_name in daily_20120315.columns.values.tolist():
    daily_20120315_addname_dataframe[table_name] = daily_20120315[table_name]
print("日线行情-时间为序  daily_20120315 返回数据 row 行数 = "+str(daily_20120315.shape[0]))
daily_20120315_addname_dataframe.to_excel(daily_201203_excel_writer,'15_4',index=False)
daily_201203_excel_writer.save()
daily_20120316 = pro.daily(start_date='',end_date='',trade_date='20120316', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20120316_tscode_list = list() 
for ts_code_sh in daily_20120316['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20120316_tscode_list.append(stock_name)
daily_20120316_addname_dataframe=pd.DataFrame()
daily_20120316_addname_dataframe['cname'] = daily_20120316_tscode_list
for table_name in daily_20120316.columns.values.tolist():
    daily_20120316_addname_dataframe[table_name] = daily_20120316[table_name]
print("日线行情-时间为序  daily_20120316 返回数据 row 行数 = "+str(daily_20120316.shape[0]))
daily_20120316_addname_dataframe.to_excel(daily_201203_excel_writer,'16_5',index=False)
daily_201203_excel_writer.save()
daily_20120319 = pro.daily(start_date='',end_date='',trade_date='20120319', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20120319_tscode_list = list() 
for ts_code_sh in daily_20120319['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20120319_tscode_list.append(stock_name)
daily_20120319_addname_dataframe=pd.DataFrame()
daily_20120319_addname_dataframe['cname'] = daily_20120319_tscode_list
for table_name in daily_20120319.columns.values.tolist():
    daily_20120319_addname_dataframe[table_name] = daily_20120319[table_name]
print("日线行情-时间为序  daily_20120319 返回数据 row 行数 = "+str(daily_20120319.shape[0]))
daily_20120319_addname_dataframe.to_excel(daily_201203_excel_writer,'19_1',index=False)
daily_201203_excel_writer.save()
daily_20120320 = pro.daily(start_date='',end_date='',trade_date='20120320', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20120320_tscode_list = list() 
for ts_code_sh in daily_20120320['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20120320_tscode_list.append(stock_name)
daily_20120320_addname_dataframe=pd.DataFrame()
daily_20120320_addname_dataframe['cname'] = daily_20120320_tscode_list
for table_name in daily_20120320.columns.values.tolist():
    daily_20120320_addname_dataframe[table_name] = daily_20120320[table_name]
print("日线行情-时间为序  daily_20120320 返回数据 row 行数 = "+str(daily_20120320.shape[0]))
daily_20120320_addname_dataframe.to_excel(daily_201203_excel_writer,'20_2',index=False)
daily_201203_excel_writer.save()
daily_20120321 = pro.daily(start_date='',end_date='',trade_date='20120321', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20120321_tscode_list = list() 
for ts_code_sh in daily_20120321['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20120321_tscode_list.append(stock_name)
daily_20120321_addname_dataframe=pd.DataFrame()
daily_20120321_addname_dataframe['cname'] = daily_20120321_tscode_list
for table_name in daily_20120321.columns.values.tolist():
    daily_20120321_addname_dataframe[table_name] = daily_20120321[table_name]
print("日线行情-时间为序  daily_20120321 返回数据 row 行数 = "+str(daily_20120321.shape[0]))
daily_20120321_addname_dataframe.to_excel(daily_201203_excel_writer,'21_3',index=False)
daily_201203_excel_writer.save()
daily_20120322 = pro.daily(start_date='',end_date='',trade_date='20120322', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20120322_tscode_list = list() 
for ts_code_sh in daily_20120322['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20120322_tscode_list.append(stock_name)
daily_20120322_addname_dataframe=pd.DataFrame()
daily_20120322_addname_dataframe['cname'] = daily_20120322_tscode_list
for table_name in daily_20120322.columns.values.tolist():
    daily_20120322_addname_dataframe[table_name] = daily_20120322[table_name]
print("日线行情-时间为序  daily_20120322 返回数据 row 行数 = "+str(daily_20120322.shape[0]))
daily_20120322_addname_dataframe.to_excel(daily_201203_excel_writer,'22_4',index=False)
daily_201203_excel_writer.save()
daily_20120323 = pro.daily(start_date='',end_date='',trade_date='20120323', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20120323_tscode_list = list() 
for ts_code_sh in daily_20120323['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20120323_tscode_list.append(stock_name)
daily_20120323_addname_dataframe=pd.DataFrame()
daily_20120323_addname_dataframe['cname'] = daily_20120323_tscode_list
for table_name in daily_20120323.columns.values.tolist():
    daily_20120323_addname_dataframe[table_name] = daily_20120323[table_name]
print("日线行情-时间为序  daily_20120323 返回数据 row 行数 = "+str(daily_20120323.shape[0]))
daily_20120323_addname_dataframe.to_excel(daily_201203_excel_writer,'23_5',index=False)
daily_201203_excel_writer.save()
daily_20120326 = pro.daily(start_date='',end_date='',trade_date='20120326', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20120326_tscode_list = list() 
for ts_code_sh in daily_20120326['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20120326_tscode_list.append(stock_name)
daily_20120326_addname_dataframe=pd.DataFrame()
daily_20120326_addname_dataframe['cname'] = daily_20120326_tscode_list
for table_name in daily_20120326.columns.values.tolist():
    daily_20120326_addname_dataframe[table_name] = daily_20120326[table_name]
print("日线行情-时间为序  daily_20120326 返回数据 row 行数 = "+str(daily_20120326.shape[0]))
daily_20120326_addname_dataframe.to_excel(daily_201203_excel_writer,'26_1',index=False)
daily_201203_excel_writer.save()
daily_20120327 = pro.daily(start_date='',end_date='',trade_date='20120327', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20120327_tscode_list = list() 
for ts_code_sh in daily_20120327['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20120327_tscode_list.append(stock_name)
daily_20120327_addname_dataframe=pd.DataFrame()
daily_20120327_addname_dataframe['cname'] = daily_20120327_tscode_list
for table_name in daily_20120327.columns.values.tolist():
    daily_20120327_addname_dataframe[table_name] = daily_20120327[table_name]
print("日线行情-时间为序  daily_20120327 返回数据 row 行数 = "+str(daily_20120327.shape[0]))
daily_20120327_addname_dataframe.to_excel(daily_201203_excel_writer,'27_2',index=False)
daily_201203_excel_writer.save()
daily_20120328 = pro.daily(start_date='',end_date='',trade_date='20120328', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20120328_tscode_list = list() 
for ts_code_sh in daily_20120328['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20120328_tscode_list.append(stock_name)
daily_20120328_addname_dataframe=pd.DataFrame()
daily_20120328_addname_dataframe['cname'] = daily_20120328_tscode_list
for table_name in daily_20120328.columns.values.tolist():
    daily_20120328_addname_dataframe[table_name] = daily_20120328[table_name]
print("日线行情-时间为序  daily_20120328 返回数据 row 行数 = "+str(daily_20120328.shape[0]))
daily_20120328_addname_dataframe.to_excel(daily_201203_excel_writer,'28_3',index=False)
daily_201203_excel_writer.save()
daily_20120329 = pro.daily(start_date='',end_date='',trade_date='20120329', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20120329_tscode_list = list() 
for ts_code_sh in daily_20120329['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20120329_tscode_list.append(stock_name)
daily_20120329_addname_dataframe=pd.DataFrame()
daily_20120329_addname_dataframe['cname'] = daily_20120329_tscode_list
for table_name in daily_20120329.columns.values.tolist():
    daily_20120329_addname_dataframe[table_name] = daily_20120329[table_name]
print("日线行情-时间为序  daily_20120329 返回数据 row 行数 = "+str(daily_20120329.shape[0]))
daily_20120329_addname_dataframe.to_excel(daily_201203_excel_writer,'29_4',index=False)
daily_201203_excel_writer.save()
daily_20120330 = pro.daily(start_date='',end_date='',trade_date='20120330', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20120330_tscode_list = list() 
for ts_code_sh in daily_20120330['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20120330_tscode_list.append(stock_name)
daily_20120330_addname_dataframe=pd.DataFrame()
daily_20120330_addname_dataframe['cname'] = daily_20120330_tscode_list
for table_name in daily_20120330.columns.values.tolist():
    daily_20120330_addname_dataframe[table_name] = daily_20120330[table_name]
print("日线行情-时间为序  daily_20120330 返回数据 row 行数 = "+str(daily_20120330.shape[0]))
daily_20120330_addname_dataframe.to_excel(daily_201203_excel_writer,'30_5',index=False)
daily_201203_excel_writer.save()




createexcel('daily_201204.xlsx')
daily_201204_book = load_workbook('C:\\Users\\zhuzj5\\Desktop\\zbin\\J0_Data\\daily_201204.xlsx')
daily_201204_excel_writer = pd.ExcelWriter('C:\\Users\\zhuzj5\\Desktop\\zbin\\J0_Data\\daily_201204.xlsx', engine='openpyxl')
daily_201204_excel_writer.book = daily_201204_book
daily_201204_excel_writer.sheets = dict((ws.title, ws) for ws in daily_201204_book.worksheets)
J0_PROPS.put(tree_node_name+"record_date", "20120401")       ###  更新 记录日期
daily_20120405 = pro.daily(start_date='',end_date='',trade_date='20120405', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20120405_tscode_list = list() 
for ts_code_sh in daily_20120405['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20120405_tscode_list.append(stock_name)
daily_20120405_addname_dataframe=pd.DataFrame()
daily_20120405_addname_dataframe['cname'] = daily_20120405_tscode_list
for table_name in daily_20120405.columns.values.tolist():
    daily_20120405_addname_dataframe[table_name] = daily_20120405[table_name]
print("日线行情-时间为序  daily_20120405 返回数据 row 行数 = "+str(daily_20120405.shape[0]))
daily_20120405_addname_dataframe.to_excel(daily_201204_excel_writer,'5_4',index=False)
daily_201204_excel_writer.save()
daily_20120406 = pro.daily(start_date='',end_date='',trade_date='20120406', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20120406_tscode_list = list() 
for ts_code_sh in daily_20120406['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20120406_tscode_list.append(stock_name)
daily_20120406_addname_dataframe=pd.DataFrame()
daily_20120406_addname_dataframe['cname'] = daily_20120406_tscode_list
for table_name in daily_20120406.columns.values.tolist():
    daily_20120406_addname_dataframe[table_name] = daily_20120406[table_name]
print("日线行情-时间为序  daily_20120406 返回数据 row 行数 = "+str(daily_20120406.shape[0]))
daily_20120406_addname_dataframe.to_excel(daily_201204_excel_writer,'6_5',index=False)
daily_201204_excel_writer.save()
daily_20120409 = pro.daily(start_date='',end_date='',trade_date='20120409', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20120409_tscode_list = list() 
for ts_code_sh in daily_20120409['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20120409_tscode_list.append(stock_name)
daily_20120409_addname_dataframe=pd.DataFrame()
daily_20120409_addname_dataframe['cname'] = daily_20120409_tscode_list
for table_name in daily_20120409.columns.values.tolist():
    daily_20120409_addname_dataframe[table_name] = daily_20120409[table_name]
print("日线行情-时间为序  daily_20120409 返回数据 row 行数 = "+str(daily_20120409.shape[0]))
daily_20120409_addname_dataframe.to_excel(daily_201204_excel_writer,'9_1',index=False)
daily_201204_excel_writer.save()
daily_20120410 = pro.daily(start_date='',end_date='',trade_date='20120410', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20120410_tscode_list = list() 
for ts_code_sh in daily_20120410['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20120410_tscode_list.append(stock_name)
daily_20120410_addname_dataframe=pd.DataFrame()
daily_20120410_addname_dataframe['cname'] = daily_20120410_tscode_list
for table_name in daily_20120410.columns.values.tolist():
    daily_20120410_addname_dataframe[table_name] = daily_20120410[table_name]
print("日线行情-时间为序  daily_20120410 返回数据 row 行数 = "+str(daily_20120410.shape[0]))
daily_20120410_addname_dataframe.to_excel(daily_201204_excel_writer,'10_2',index=False)
daily_201204_excel_writer.save()
daily_20120411 = pro.daily(start_date='',end_date='',trade_date='20120411', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20120411_tscode_list = list() 
for ts_code_sh in daily_20120411['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20120411_tscode_list.append(stock_name)
daily_20120411_addname_dataframe=pd.DataFrame()
daily_20120411_addname_dataframe['cname'] = daily_20120411_tscode_list
for table_name in daily_20120411.columns.values.tolist():
    daily_20120411_addname_dataframe[table_name] = daily_20120411[table_name]
print("日线行情-时间为序  daily_20120411 返回数据 row 行数 = "+str(daily_20120411.shape[0]))
daily_20120411_addname_dataframe.to_excel(daily_201204_excel_writer,'11_3',index=False)
daily_201204_excel_writer.save()
daily_20120412 = pro.daily(start_date='',end_date='',trade_date='20120412', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20120412_tscode_list = list() 
for ts_code_sh in daily_20120412['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20120412_tscode_list.append(stock_name)
daily_20120412_addname_dataframe=pd.DataFrame()
daily_20120412_addname_dataframe['cname'] = daily_20120412_tscode_list
for table_name in daily_20120412.columns.values.tolist():
    daily_20120412_addname_dataframe[table_name] = daily_20120412[table_name]
print("日线行情-时间为序  daily_20120412 返回数据 row 行数 = "+str(daily_20120412.shape[0]))
daily_20120412_addname_dataframe.to_excel(daily_201204_excel_writer,'12_4',index=False)
daily_201204_excel_writer.save()
daily_20120413 = pro.daily(start_date='',end_date='',trade_date='20120413', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20120413_tscode_list = list() 
for ts_code_sh in daily_20120413['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20120413_tscode_list.append(stock_name)
daily_20120413_addname_dataframe=pd.DataFrame()
daily_20120413_addname_dataframe['cname'] = daily_20120413_tscode_list
for table_name in daily_20120413.columns.values.tolist():
    daily_20120413_addname_dataframe[table_name] = daily_20120413[table_name]
print("日线行情-时间为序  daily_20120413 返回数据 row 行数 = "+str(daily_20120413.shape[0]))
daily_20120413_addname_dataframe.to_excel(daily_201204_excel_writer,'13_5',index=False)
daily_201204_excel_writer.save()
daily_20120416 = pro.daily(start_date='',end_date='',trade_date='20120416', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20120416_tscode_list = list() 
for ts_code_sh in daily_20120416['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20120416_tscode_list.append(stock_name)
daily_20120416_addname_dataframe=pd.DataFrame()
daily_20120416_addname_dataframe['cname'] = daily_20120416_tscode_list
for table_name in daily_20120416.columns.values.tolist():
    daily_20120416_addname_dataframe[table_name] = daily_20120416[table_name]
print("日线行情-时间为序  daily_20120416 返回数据 row 行数 = "+str(daily_20120416.shape[0]))
daily_20120416_addname_dataframe.to_excel(daily_201204_excel_writer,'16_1',index=False)
daily_201204_excel_writer.save()
daily_20120417 = pro.daily(start_date='',end_date='',trade_date='20120417', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20120417_tscode_list = list() 
for ts_code_sh in daily_20120417['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20120417_tscode_list.append(stock_name)
daily_20120417_addname_dataframe=pd.DataFrame()
daily_20120417_addname_dataframe['cname'] = daily_20120417_tscode_list
for table_name in daily_20120417.columns.values.tolist():
    daily_20120417_addname_dataframe[table_name] = daily_20120417[table_name]
print("日线行情-时间为序  daily_20120417 返回数据 row 行数 = "+str(daily_20120417.shape[0]))
daily_20120417_addname_dataframe.to_excel(daily_201204_excel_writer,'17_2',index=False)
daily_201204_excel_writer.save()
daily_20120418 = pro.daily(start_date='',end_date='',trade_date='20120418', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20120418_tscode_list = list() 
for ts_code_sh in daily_20120418['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20120418_tscode_list.append(stock_name)
daily_20120418_addname_dataframe=pd.DataFrame()
daily_20120418_addname_dataframe['cname'] = daily_20120418_tscode_list
for table_name in daily_20120418.columns.values.tolist():
    daily_20120418_addname_dataframe[table_name] = daily_20120418[table_name]
print("日线行情-时间为序  daily_20120418 返回数据 row 行数 = "+str(daily_20120418.shape[0]))
daily_20120418_addname_dataframe.to_excel(daily_201204_excel_writer,'18_3',index=False)
daily_201204_excel_writer.save()
daily_20120419 = pro.daily(start_date='',end_date='',trade_date='20120419', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20120419_tscode_list = list() 
for ts_code_sh in daily_20120419['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20120419_tscode_list.append(stock_name)
daily_20120419_addname_dataframe=pd.DataFrame()
daily_20120419_addname_dataframe['cname'] = daily_20120419_tscode_list
for table_name in daily_20120419.columns.values.tolist():
    daily_20120419_addname_dataframe[table_name] = daily_20120419[table_name]
print("日线行情-时间为序  daily_20120419 返回数据 row 行数 = "+str(daily_20120419.shape[0]))
daily_20120419_addname_dataframe.to_excel(daily_201204_excel_writer,'19_4',index=False)
daily_201204_excel_writer.save()
daily_20120420 = pro.daily(start_date='',end_date='',trade_date='20120420', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20120420_tscode_list = list() 
for ts_code_sh in daily_20120420['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20120420_tscode_list.append(stock_name)
daily_20120420_addname_dataframe=pd.DataFrame()
daily_20120420_addname_dataframe['cname'] = daily_20120420_tscode_list
for table_name in daily_20120420.columns.values.tolist():
    daily_20120420_addname_dataframe[table_name] = daily_20120420[table_name]
print("日线行情-时间为序  daily_20120420 返回数据 row 行数 = "+str(daily_20120420.shape[0]))
daily_20120420_addname_dataframe.to_excel(daily_201204_excel_writer,'20_5',index=False)
daily_201204_excel_writer.save()
daily_20120423 = pro.daily(start_date='',end_date='',trade_date='20120423', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20120423_tscode_list = list() 
for ts_code_sh in daily_20120423['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20120423_tscode_list.append(stock_name)
daily_20120423_addname_dataframe=pd.DataFrame()
daily_20120423_addname_dataframe['cname'] = daily_20120423_tscode_list
for table_name in daily_20120423.columns.values.tolist():
    daily_20120423_addname_dataframe[table_name] = daily_20120423[table_name]
print("日线行情-时间为序  daily_20120423 返回数据 row 行数 = "+str(daily_20120423.shape[0]))
daily_20120423_addname_dataframe.to_excel(daily_201204_excel_writer,'23_1',index=False)
daily_201204_excel_writer.save()
daily_20120424 = pro.daily(start_date='',end_date='',trade_date='20120424', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20120424_tscode_list = list() 
for ts_code_sh in daily_20120424['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20120424_tscode_list.append(stock_name)
daily_20120424_addname_dataframe=pd.DataFrame()
daily_20120424_addname_dataframe['cname'] = daily_20120424_tscode_list
for table_name in daily_20120424.columns.values.tolist():
    daily_20120424_addname_dataframe[table_name] = daily_20120424[table_name]
print("日线行情-时间为序  daily_20120424 返回数据 row 行数 = "+str(daily_20120424.shape[0]))
daily_20120424_addname_dataframe.to_excel(daily_201204_excel_writer,'24_2',index=False)
daily_201204_excel_writer.save()
daily_20120425 = pro.daily(start_date='',end_date='',trade_date='20120425', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20120425_tscode_list = list() 
for ts_code_sh in daily_20120425['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20120425_tscode_list.append(stock_name)
daily_20120425_addname_dataframe=pd.DataFrame()
daily_20120425_addname_dataframe['cname'] = daily_20120425_tscode_list
for table_name in daily_20120425.columns.values.tolist():
    daily_20120425_addname_dataframe[table_name] = daily_20120425[table_name]
print("日线行情-时间为序  daily_20120425 返回数据 row 行数 = "+str(daily_20120425.shape[0]))
daily_20120425_addname_dataframe.to_excel(daily_201204_excel_writer,'25_3',index=False)
daily_201204_excel_writer.save()
daily_20120426 = pro.daily(start_date='',end_date='',trade_date='20120426', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20120426_tscode_list = list() 
for ts_code_sh in daily_20120426['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20120426_tscode_list.append(stock_name)
daily_20120426_addname_dataframe=pd.DataFrame()
daily_20120426_addname_dataframe['cname'] = daily_20120426_tscode_list
for table_name in daily_20120426.columns.values.tolist():
    daily_20120426_addname_dataframe[table_name] = daily_20120426[table_name]
print("日线行情-时间为序  daily_20120426 返回数据 row 行数 = "+str(daily_20120426.shape[0]))
daily_20120426_addname_dataframe.to_excel(daily_201204_excel_writer,'26_4',index=False)
daily_201204_excel_writer.save()
daily_20120427 = pro.daily(start_date='',end_date='',trade_date='20120427', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20120427_tscode_list = list() 
for ts_code_sh in daily_20120427['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20120427_tscode_list.append(stock_name)
daily_20120427_addname_dataframe=pd.DataFrame()
daily_20120427_addname_dataframe['cname'] = daily_20120427_tscode_list
for table_name in daily_20120427.columns.values.tolist():
    daily_20120427_addname_dataframe[table_name] = daily_20120427[table_name]
print("日线行情-时间为序  daily_20120427 返回数据 row 行数 = "+str(daily_20120427.shape[0]))
daily_20120427_addname_dataframe.to_excel(daily_201204_excel_writer,'27_5',index=False)
daily_201204_excel_writer.save()




createexcel('daily_201205.xlsx')
daily_201205_book = load_workbook('C:\\Users\\zhuzj5\\Desktop\\zbin\\J0_Data\\daily_201205.xlsx')
daily_201205_excel_writer = pd.ExcelWriter('C:\\Users\\zhuzj5\\Desktop\\zbin\\J0_Data\\daily_201205.xlsx', engine='openpyxl')
daily_201205_excel_writer.book = daily_201205_book
daily_201205_excel_writer.sheets = dict((ws.title, ws) for ws in daily_201205_book.worksheets)
J0_PROPS.put(tree_node_name+"record_date", "20120501")       ###  更新 记录日期
daily_20120502 = pro.daily(start_date='',end_date='',trade_date='20120502', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20120502_tscode_list = list() 
for ts_code_sh in daily_20120502['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20120502_tscode_list.append(stock_name)
daily_20120502_addname_dataframe=pd.DataFrame()
daily_20120502_addname_dataframe['cname'] = daily_20120502_tscode_list
for table_name in daily_20120502.columns.values.tolist():
    daily_20120502_addname_dataframe[table_name] = daily_20120502[table_name]
print("日线行情-时间为序  daily_20120502 返回数据 row 行数 = "+str(daily_20120502.shape[0]))
daily_20120502_addname_dataframe.to_excel(daily_201205_excel_writer,'2_3',index=False)
daily_201205_excel_writer.save()
daily_20120503 = pro.daily(start_date='',end_date='',trade_date='20120503', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20120503_tscode_list = list() 
for ts_code_sh in daily_20120503['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20120503_tscode_list.append(stock_name)
daily_20120503_addname_dataframe=pd.DataFrame()
daily_20120503_addname_dataframe['cname'] = daily_20120503_tscode_list
for table_name in daily_20120503.columns.values.tolist():
    daily_20120503_addname_dataframe[table_name] = daily_20120503[table_name]
print("日线行情-时间为序  daily_20120503 返回数据 row 行数 = "+str(daily_20120503.shape[0]))
daily_20120503_addname_dataframe.to_excel(daily_201205_excel_writer,'3_4',index=False)
daily_201205_excel_writer.save()
daily_20120504 = pro.daily(start_date='',end_date='',trade_date='20120504', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20120504_tscode_list = list() 
for ts_code_sh in daily_20120504['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20120504_tscode_list.append(stock_name)
daily_20120504_addname_dataframe=pd.DataFrame()
daily_20120504_addname_dataframe['cname'] = daily_20120504_tscode_list
for table_name in daily_20120504.columns.values.tolist():
    daily_20120504_addname_dataframe[table_name] = daily_20120504[table_name]
print("日线行情-时间为序  daily_20120504 返回数据 row 行数 = "+str(daily_20120504.shape[0]))
daily_20120504_addname_dataframe.to_excel(daily_201205_excel_writer,'4_5',index=False)
daily_201205_excel_writer.save()
daily_20120507 = pro.daily(start_date='',end_date='',trade_date='20120507', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20120507_tscode_list = list() 
for ts_code_sh in daily_20120507['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20120507_tscode_list.append(stock_name)
daily_20120507_addname_dataframe=pd.DataFrame()
daily_20120507_addname_dataframe['cname'] = daily_20120507_tscode_list
for table_name in daily_20120507.columns.values.tolist():
    daily_20120507_addname_dataframe[table_name] = daily_20120507[table_name]
print("日线行情-时间为序  daily_20120507 返回数据 row 行数 = "+str(daily_20120507.shape[0]))
daily_20120507_addname_dataframe.to_excel(daily_201205_excel_writer,'7_1',index=False)
daily_201205_excel_writer.save()
daily_20120508 = pro.daily(start_date='',end_date='',trade_date='20120508', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20120508_tscode_list = list() 
for ts_code_sh in daily_20120508['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20120508_tscode_list.append(stock_name)
daily_20120508_addname_dataframe=pd.DataFrame()
daily_20120508_addname_dataframe['cname'] = daily_20120508_tscode_list
for table_name in daily_20120508.columns.values.tolist():
    daily_20120508_addname_dataframe[table_name] = daily_20120508[table_name]
print("日线行情-时间为序  daily_20120508 返回数据 row 行数 = "+str(daily_20120508.shape[0]))
daily_20120508_addname_dataframe.to_excel(daily_201205_excel_writer,'8_2',index=False)
daily_201205_excel_writer.save()
daily_20120509 = pro.daily(start_date='',end_date='',trade_date='20120509', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20120509_tscode_list = list() 
for ts_code_sh in daily_20120509['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20120509_tscode_list.append(stock_name)
daily_20120509_addname_dataframe=pd.DataFrame()
daily_20120509_addname_dataframe['cname'] = daily_20120509_tscode_list
for table_name in daily_20120509.columns.values.tolist():
    daily_20120509_addname_dataframe[table_name] = daily_20120509[table_name]
print("日线行情-时间为序  daily_20120509 返回数据 row 行数 = "+str(daily_20120509.shape[0]))
daily_20120509_addname_dataframe.to_excel(daily_201205_excel_writer,'9_3',index=False)
daily_201205_excel_writer.save()
daily_20120510 = pro.daily(start_date='',end_date='',trade_date='20120510', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20120510_tscode_list = list() 
for ts_code_sh in daily_20120510['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20120510_tscode_list.append(stock_name)
daily_20120510_addname_dataframe=pd.DataFrame()
daily_20120510_addname_dataframe['cname'] = daily_20120510_tscode_list
for table_name in daily_20120510.columns.values.tolist():
    daily_20120510_addname_dataframe[table_name] = daily_20120510[table_name]
print("日线行情-时间为序  daily_20120510 返回数据 row 行数 = "+str(daily_20120510.shape[0]))
daily_20120510_addname_dataframe.to_excel(daily_201205_excel_writer,'10_4',index=False)
daily_201205_excel_writer.save()
daily_20120511 = pro.daily(start_date='',end_date='',trade_date='20120511', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20120511_tscode_list = list() 
for ts_code_sh in daily_20120511['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20120511_tscode_list.append(stock_name)
daily_20120511_addname_dataframe=pd.DataFrame()
daily_20120511_addname_dataframe['cname'] = daily_20120511_tscode_list
for table_name in daily_20120511.columns.values.tolist():
    daily_20120511_addname_dataframe[table_name] = daily_20120511[table_name]
print("日线行情-时间为序  daily_20120511 返回数据 row 行数 = "+str(daily_20120511.shape[0]))
daily_20120511_addname_dataframe.to_excel(daily_201205_excel_writer,'11_5',index=False)
daily_201205_excel_writer.save()
daily_20120514 = pro.daily(start_date='',end_date='',trade_date='20120514', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20120514_tscode_list = list() 
for ts_code_sh in daily_20120514['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20120514_tscode_list.append(stock_name)
daily_20120514_addname_dataframe=pd.DataFrame()
daily_20120514_addname_dataframe['cname'] = daily_20120514_tscode_list
for table_name in daily_20120514.columns.values.tolist():
    daily_20120514_addname_dataframe[table_name] = daily_20120514[table_name]
print("日线行情-时间为序  daily_20120514 返回数据 row 行数 = "+str(daily_20120514.shape[0]))
daily_20120514_addname_dataframe.to_excel(daily_201205_excel_writer,'14_1',index=False)
daily_201205_excel_writer.save()
daily_20120515 = pro.daily(start_date='',end_date='',trade_date='20120515', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20120515_tscode_list = list() 
for ts_code_sh in daily_20120515['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20120515_tscode_list.append(stock_name)
daily_20120515_addname_dataframe=pd.DataFrame()
daily_20120515_addname_dataframe['cname'] = daily_20120515_tscode_list
for table_name in daily_20120515.columns.values.tolist():
    daily_20120515_addname_dataframe[table_name] = daily_20120515[table_name]
print("日线行情-时间为序  daily_20120515 返回数据 row 行数 = "+str(daily_20120515.shape[0]))
daily_20120515_addname_dataframe.to_excel(daily_201205_excel_writer,'15_2',index=False)
daily_201205_excel_writer.save()
daily_20120516 = pro.daily(start_date='',end_date='',trade_date='20120516', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20120516_tscode_list = list() 
for ts_code_sh in daily_20120516['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20120516_tscode_list.append(stock_name)
daily_20120516_addname_dataframe=pd.DataFrame()
daily_20120516_addname_dataframe['cname'] = daily_20120516_tscode_list
for table_name in daily_20120516.columns.values.tolist():
    daily_20120516_addname_dataframe[table_name] = daily_20120516[table_name]
print("日线行情-时间为序  daily_20120516 返回数据 row 行数 = "+str(daily_20120516.shape[0]))
daily_20120516_addname_dataframe.to_excel(daily_201205_excel_writer,'16_3',index=False)
daily_201205_excel_writer.save()
daily_20120517 = pro.daily(start_date='',end_date='',trade_date='20120517', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20120517_tscode_list = list() 
for ts_code_sh in daily_20120517['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20120517_tscode_list.append(stock_name)
daily_20120517_addname_dataframe=pd.DataFrame()
daily_20120517_addname_dataframe['cname'] = daily_20120517_tscode_list
for table_name in daily_20120517.columns.values.tolist():
    daily_20120517_addname_dataframe[table_name] = daily_20120517[table_name]
print("日线行情-时间为序  daily_20120517 返回数据 row 行数 = "+str(daily_20120517.shape[0]))
daily_20120517_addname_dataframe.to_excel(daily_201205_excel_writer,'17_4',index=False)
daily_201205_excel_writer.save()
daily_20120518 = pro.daily(start_date='',end_date='',trade_date='20120518', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20120518_tscode_list = list() 
for ts_code_sh in daily_20120518['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20120518_tscode_list.append(stock_name)
daily_20120518_addname_dataframe=pd.DataFrame()
daily_20120518_addname_dataframe['cname'] = daily_20120518_tscode_list
for table_name in daily_20120518.columns.values.tolist():
    daily_20120518_addname_dataframe[table_name] = daily_20120518[table_name]
print("日线行情-时间为序  daily_20120518 返回数据 row 行数 = "+str(daily_20120518.shape[0]))
daily_20120518_addname_dataframe.to_excel(daily_201205_excel_writer,'18_5',index=False)
daily_201205_excel_writer.save()
daily_20120521 = pro.daily(start_date='',end_date='',trade_date='20120521', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20120521_tscode_list = list() 
for ts_code_sh in daily_20120521['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20120521_tscode_list.append(stock_name)
daily_20120521_addname_dataframe=pd.DataFrame()
daily_20120521_addname_dataframe['cname'] = daily_20120521_tscode_list
for table_name in daily_20120521.columns.values.tolist():
    daily_20120521_addname_dataframe[table_name] = daily_20120521[table_name]
print("日线行情-时间为序  daily_20120521 返回数据 row 行数 = "+str(daily_20120521.shape[0]))
daily_20120521_addname_dataframe.to_excel(daily_201205_excel_writer,'21_1',index=False)
daily_201205_excel_writer.save()
daily_20120522 = pro.daily(start_date='',end_date='',trade_date='20120522', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20120522_tscode_list = list() 
for ts_code_sh in daily_20120522['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20120522_tscode_list.append(stock_name)
daily_20120522_addname_dataframe=pd.DataFrame()
daily_20120522_addname_dataframe['cname'] = daily_20120522_tscode_list
for table_name in daily_20120522.columns.values.tolist():
    daily_20120522_addname_dataframe[table_name] = daily_20120522[table_name]
print("日线行情-时间为序  daily_20120522 返回数据 row 行数 = "+str(daily_20120522.shape[0]))
daily_20120522_addname_dataframe.to_excel(daily_201205_excel_writer,'22_2',index=False)
daily_201205_excel_writer.save()
daily_20120523 = pro.daily(start_date='',end_date='',trade_date='20120523', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20120523_tscode_list = list() 
for ts_code_sh in daily_20120523['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20120523_tscode_list.append(stock_name)
daily_20120523_addname_dataframe=pd.DataFrame()
daily_20120523_addname_dataframe['cname'] = daily_20120523_tscode_list
for table_name in daily_20120523.columns.values.tolist():
    daily_20120523_addname_dataframe[table_name] = daily_20120523[table_name]
print("日线行情-时间为序  daily_20120523 返回数据 row 行数 = "+str(daily_20120523.shape[0]))
daily_20120523_addname_dataframe.to_excel(daily_201205_excel_writer,'23_3',index=False)
daily_201205_excel_writer.save()
daily_20120524 = pro.daily(start_date='',end_date='',trade_date='20120524', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20120524_tscode_list = list() 
for ts_code_sh in daily_20120524['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20120524_tscode_list.append(stock_name)
daily_20120524_addname_dataframe=pd.DataFrame()
daily_20120524_addname_dataframe['cname'] = daily_20120524_tscode_list
for table_name in daily_20120524.columns.values.tolist():
    daily_20120524_addname_dataframe[table_name] = daily_20120524[table_name]
print("日线行情-时间为序  daily_20120524 返回数据 row 行数 = "+str(daily_20120524.shape[0]))
daily_20120524_addname_dataframe.to_excel(daily_201205_excel_writer,'24_4',index=False)
daily_201205_excel_writer.save()
daily_20120525 = pro.daily(start_date='',end_date='',trade_date='20120525', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20120525_tscode_list = list() 
for ts_code_sh in daily_20120525['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20120525_tscode_list.append(stock_name)
daily_20120525_addname_dataframe=pd.DataFrame()
daily_20120525_addname_dataframe['cname'] = daily_20120525_tscode_list
for table_name in daily_20120525.columns.values.tolist():
    daily_20120525_addname_dataframe[table_name] = daily_20120525[table_name]
print("日线行情-时间为序  daily_20120525 返回数据 row 行数 = "+str(daily_20120525.shape[0]))
daily_20120525_addname_dataframe.to_excel(daily_201205_excel_writer,'25_5',index=False)
daily_201205_excel_writer.save()
daily_20120528 = pro.daily(start_date='',end_date='',trade_date='20120528', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20120528_tscode_list = list() 
for ts_code_sh in daily_20120528['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20120528_tscode_list.append(stock_name)
daily_20120528_addname_dataframe=pd.DataFrame()
daily_20120528_addname_dataframe['cname'] = daily_20120528_tscode_list
for table_name in daily_20120528.columns.values.tolist():
    daily_20120528_addname_dataframe[table_name] = daily_20120528[table_name]
print("日线行情-时间为序  daily_20120528 返回数据 row 行数 = "+str(daily_20120528.shape[0]))
daily_20120528_addname_dataframe.to_excel(daily_201205_excel_writer,'28_1',index=False)
daily_201205_excel_writer.save()
daily_20120529 = pro.daily(start_date='',end_date='',trade_date='20120529', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20120529_tscode_list = list() 
for ts_code_sh in daily_20120529['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20120529_tscode_list.append(stock_name)
daily_20120529_addname_dataframe=pd.DataFrame()
daily_20120529_addname_dataframe['cname'] = daily_20120529_tscode_list
for table_name in daily_20120529.columns.values.tolist():
    daily_20120529_addname_dataframe[table_name] = daily_20120529[table_name]
print("日线行情-时间为序  daily_20120529 返回数据 row 行数 = "+str(daily_20120529.shape[0]))
daily_20120529_addname_dataframe.to_excel(daily_201205_excel_writer,'29_2',index=False)
daily_201205_excel_writer.save()
daily_20120530 = pro.daily(start_date='',end_date='',trade_date='20120530', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20120530_tscode_list = list() 
for ts_code_sh in daily_20120530['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20120530_tscode_list.append(stock_name)
daily_20120530_addname_dataframe=pd.DataFrame()
daily_20120530_addname_dataframe['cname'] = daily_20120530_tscode_list
for table_name in daily_20120530.columns.values.tolist():
    daily_20120530_addname_dataframe[table_name] = daily_20120530[table_name]
print("日线行情-时间为序  daily_20120530 返回数据 row 行数 = "+str(daily_20120530.shape[0]))
daily_20120530_addname_dataframe.to_excel(daily_201205_excel_writer,'30_3',index=False)
daily_201205_excel_writer.save()
daily_20120531 = pro.daily(start_date='',end_date='',trade_date='20120531', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20120531_tscode_list = list() 
for ts_code_sh in daily_20120531['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20120531_tscode_list.append(stock_name)
daily_20120531_addname_dataframe=pd.DataFrame()
daily_20120531_addname_dataframe['cname'] = daily_20120531_tscode_list
for table_name in daily_20120531.columns.values.tolist():
    daily_20120531_addname_dataframe[table_name] = daily_20120531[table_name]
print("日线行情-时间为序  daily_20120531 返回数据 row 行数 = "+str(daily_20120531.shape[0]))
daily_20120531_addname_dataframe.to_excel(daily_201205_excel_writer,'31_4',index=False)
daily_201205_excel_writer.save()




createexcel('daily_201206.xlsx')
daily_201206_book = load_workbook('C:\\Users\\zhuzj5\\Desktop\\zbin\\J0_Data\\daily_201206.xlsx')
daily_201206_excel_writer = pd.ExcelWriter('C:\\Users\\zhuzj5\\Desktop\\zbin\\J0_Data\\daily_201206.xlsx', engine='openpyxl')
daily_201206_excel_writer.book = daily_201206_book
daily_201206_excel_writer.sheets = dict((ws.title, ws) for ws in daily_201206_book.worksheets)
J0_PROPS.put(tree_node_name+"record_date", "20120601")       ###  更新 记录日期
daily_20120601 = pro.daily(start_date='',end_date='',trade_date='20120601', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20120601_tscode_list = list() 
for ts_code_sh in daily_20120601['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20120601_tscode_list.append(stock_name)
daily_20120601_addname_dataframe=pd.DataFrame()
daily_20120601_addname_dataframe['cname'] = daily_20120601_tscode_list
for table_name in daily_20120601.columns.values.tolist():
    daily_20120601_addname_dataframe[table_name] = daily_20120601[table_name]
print("日线行情-时间为序  daily_20120601 返回数据 row 行数 = "+str(daily_20120601.shape[0]))
daily_20120601_addname_dataframe.to_excel(daily_201206_excel_writer,'1_5',index=False)
daily_201206_excel_writer.save()
daily_20120604 = pro.daily(start_date='',end_date='',trade_date='20120604', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20120604_tscode_list = list() 
for ts_code_sh in daily_20120604['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20120604_tscode_list.append(stock_name)
daily_20120604_addname_dataframe=pd.DataFrame()
daily_20120604_addname_dataframe['cname'] = daily_20120604_tscode_list
for table_name in daily_20120604.columns.values.tolist():
    daily_20120604_addname_dataframe[table_name] = daily_20120604[table_name]
print("日线行情-时间为序  daily_20120604 返回数据 row 行数 = "+str(daily_20120604.shape[0]))
daily_20120604_addname_dataframe.to_excel(daily_201206_excel_writer,'4_1',index=False)
daily_201206_excel_writer.save()
daily_20120605 = pro.daily(start_date='',end_date='',trade_date='20120605', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20120605_tscode_list = list() 
for ts_code_sh in daily_20120605['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20120605_tscode_list.append(stock_name)
daily_20120605_addname_dataframe=pd.DataFrame()
daily_20120605_addname_dataframe['cname'] = daily_20120605_tscode_list
for table_name in daily_20120605.columns.values.tolist():
    daily_20120605_addname_dataframe[table_name] = daily_20120605[table_name]
print("日线行情-时间为序  daily_20120605 返回数据 row 行数 = "+str(daily_20120605.shape[0]))
daily_20120605_addname_dataframe.to_excel(daily_201206_excel_writer,'5_2',index=False)
daily_201206_excel_writer.save()
daily_20120606 = pro.daily(start_date='',end_date='',trade_date='20120606', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20120606_tscode_list = list() 
for ts_code_sh in daily_20120606['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20120606_tscode_list.append(stock_name)
daily_20120606_addname_dataframe=pd.DataFrame()
daily_20120606_addname_dataframe['cname'] = daily_20120606_tscode_list
for table_name in daily_20120606.columns.values.tolist():
    daily_20120606_addname_dataframe[table_name] = daily_20120606[table_name]
print("日线行情-时间为序  daily_20120606 返回数据 row 行数 = "+str(daily_20120606.shape[0]))
daily_20120606_addname_dataframe.to_excel(daily_201206_excel_writer,'6_3',index=False)
daily_201206_excel_writer.save()
daily_20120607 = pro.daily(start_date='',end_date='',trade_date='20120607', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20120607_tscode_list = list() 
for ts_code_sh in daily_20120607['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20120607_tscode_list.append(stock_name)
daily_20120607_addname_dataframe=pd.DataFrame()
daily_20120607_addname_dataframe['cname'] = daily_20120607_tscode_list
for table_name in daily_20120607.columns.values.tolist():
    daily_20120607_addname_dataframe[table_name] = daily_20120607[table_name]
print("日线行情-时间为序  daily_20120607 返回数据 row 行数 = "+str(daily_20120607.shape[0]))
daily_20120607_addname_dataframe.to_excel(daily_201206_excel_writer,'7_4',index=False)
daily_201206_excel_writer.save()
daily_20120608 = pro.daily(start_date='',end_date='',trade_date='20120608', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20120608_tscode_list = list() 
for ts_code_sh in daily_20120608['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20120608_tscode_list.append(stock_name)
daily_20120608_addname_dataframe=pd.DataFrame()
daily_20120608_addname_dataframe['cname'] = daily_20120608_tscode_list
for table_name in daily_20120608.columns.values.tolist():
    daily_20120608_addname_dataframe[table_name] = daily_20120608[table_name]
print("日线行情-时间为序  daily_20120608 返回数据 row 行数 = "+str(daily_20120608.shape[0]))
daily_20120608_addname_dataframe.to_excel(daily_201206_excel_writer,'8_5',index=False)
daily_201206_excel_writer.save()
daily_20120611 = pro.daily(start_date='',end_date='',trade_date='20120611', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20120611_tscode_list = list() 
for ts_code_sh in daily_20120611['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20120611_tscode_list.append(stock_name)
daily_20120611_addname_dataframe=pd.DataFrame()
daily_20120611_addname_dataframe['cname'] = daily_20120611_tscode_list
for table_name in daily_20120611.columns.values.tolist():
    daily_20120611_addname_dataframe[table_name] = daily_20120611[table_name]
print("日线行情-时间为序  daily_20120611 返回数据 row 行数 = "+str(daily_20120611.shape[0]))
daily_20120611_addname_dataframe.to_excel(daily_201206_excel_writer,'11_1',index=False)
daily_201206_excel_writer.save()
daily_20120612 = pro.daily(start_date='',end_date='',trade_date='20120612', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20120612_tscode_list = list() 
for ts_code_sh in daily_20120612['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20120612_tscode_list.append(stock_name)
daily_20120612_addname_dataframe=pd.DataFrame()
daily_20120612_addname_dataframe['cname'] = daily_20120612_tscode_list
for table_name in daily_20120612.columns.values.tolist():
    daily_20120612_addname_dataframe[table_name] = daily_20120612[table_name]
print("日线行情-时间为序  daily_20120612 返回数据 row 行数 = "+str(daily_20120612.shape[0]))
daily_20120612_addname_dataframe.to_excel(daily_201206_excel_writer,'12_2',index=False)
daily_201206_excel_writer.save()
daily_20120613 = pro.daily(start_date='',end_date='',trade_date='20120613', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20120613_tscode_list = list() 
for ts_code_sh in daily_20120613['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20120613_tscode_list.append(stock_name)
daily_20120613_addname_dataframe=pd.DataFrame()
daily_20120613_addname_dataframe['cname'] = daily_20120613_tscode_list
for table_name in daily_20120613.columns.values.tolist():
    daily_20120613_addname_dataframe[table_name] = daily_20120613[table_name]
print("日线行情-时间为序  daily_20120613 返回数据 row 行数 = "+str(daily_20120613.shape[0]))
daily_20120613_addname_dataframe.to_excel(daily_201206_excel_writer,'13_3',index=False)
daily_201206_excel_writer.save()
daily_20120614 = pro.daily(start_date='',end_date='',trade_date='20120614', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20120614_tscode_list = list() 
for ts_code_sh in daily_20120614['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20120614_tscode_list.append(stock_name)
daily_20120614_addname_dataframe=pd.DataFrame()
daily_20120614_addname_dataframe['cname'] = daily_20120614_tscode_list
for table_name in daily_20120614.columns.values.tolist():
    daily_20120614_addname_dataframe[table_name] = daily_20120614[table_name]
print("日线行情-时间为序  daily_20120614 返回数据 row 行数 = "+str(daily_20120614.shape[0]))
daily_20120614_addname_dataframe.to_excel(daily_201206_excel_writer,'14_4',index=False)
daily_201206_excel_writer.save()
daily_20120615 = pro.daily(start_date='',end_date='',trade_date='20120615', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20120615_tscode_list = list() 
for ts_code_sh in daily_20120615['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20120615_tscode_list.append(stock_name)
daily_20120615_addname_dataframe=pd.DataFrame()
daily_20120615_addname_dataframe['cname'] = daily_20120615_tscode_list
for table_name in daily_20120615.columns.values.tolist():
    daily_20120615_addname_dataframe[table_name] = daily_20120615[table_name]
print("日线行情-时间为序  daily_20120615 返回数据 row 行数 = "+str(daily_20120615.shape[0]))
daily_20120615_addname_dataframe.to_excel(daily_201206_excel_writer,'15_5',index=False)
daily_201206_excel_writer.save()
daily_20120618 = pro.daily(start_date='',end_date='',trade_date='20120618', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20120618_tscode_list = list() 
for ts_code_sh in daily_20120618['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20120618_tscode_list.append(stock_name)
daily_20120618_addname_dataframe=pd.DataFrame()
daily_20120618_addname_dataframe['cname'] = daily_20120618_tscode_list
for table_name in daily_20120618.columns.values.tolist():
    daily_20120618_addname_dataframe[table_name] = daily_20120618[table_name]
print("日线行情-时间为序  daily_20120618 返回数据 row 行数 = "+str(daily_20120618.shape[0]))
daily_20120618_addname_dataframe.to_excel(daily_201206_excel_writer,'18_1',index=False)
daily_201206_excel_writer.save()
daily_20120619 = pro.daily(start_date='',end_date='',trade_date='20120619', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20120619_tscode_list = list() 
for ts_code_sh in daily_20120619['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20120619_tscode_list.append(stock_name)
daily_20120619_addname_dataframe=pd.DataFrame()
daily_20120619_addname_dataframe['cname'] = daily_20120619_tscode_list
for table_name in daily_20120619.columns.values.tolist():
    daily_20120619_addname_dataframe[table_name] = daily_20120619[table_name]
print("日线行情-时间为序  daily_20120619 返回数据 row 行数 = "+str(daily_20120619.shape[0]))
daily_20120619_addname_dataframe.to_excel(daily_201206_excel_writer,'19_2',index=False)
daily_201206_excel_writer.save()
daily_20120620 = pro.daily(start_date='',end_date='',trade_date='20120620', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20120620_tscode_list = list() 
for ts_code_sh in daily_20120620['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20120620_tscode_list.append(stock_name)
daily_20120620_addname_dataframe=pd.DataFrame()
daily_20120620_addname_dataframe['cname'] = daily_20120620_tscode_list
for table_name in daily_20120620.columns.values.tolist():
    daily_20120620_addname_dataframe[table_name] = daily_20120620[table_name]
print("日线行情-时间为序  daily_20120620 返回数据 row 行数 = "+str(daily_20120620.shape[0]))
daily_20120620_addname_dataframe.to_excel(daily_201206_excel_writer,'20_3',index=False)
daily_201206_excel_writer.save()
daily_20120621 = pro.daily(start_date='',end_date='',trade_date='20120621', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20120621_tscode_list = list() 
for ts_code_sh in daily_20120621['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20120621_tscode_list.append(stock_name)
daily_20120621_addname_dataframe=pd.DataFrame()
daily_20120621_addname_dataframe['cname'] = daily_20120621_tscode_list
for table_name in daily_20120621.columns.values.tolist():
    daily_20120621_addname_dataframe[table_name] = daily_20120621[table_name]
print("日线行情-时间为序  daily_20120621 返回数据 row 行数 = "+str(daily_20120621.shape[0]))
daily_20120621_addname_dataframe.to_excel(daily_201206_excel_writer,'21_4',index=False)
daily_201206_excel_writer.save()
daily_20120625 = pro.daily(start_date='',end_date='',trade_date='20120625', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20120625_tscode_list = list() 
for ts_code_sh in daily_20120625['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20120625_tscode_list.append(stock_name)
daily_20120625_addname_dataframe=pd.DataFrame()
daily_20120625_addname_dataframe['cname'] = daily_20120625_tscode_list
for table_name in daily_20120625.columns.values.tolist():
    daily_20120625_addname_dataframe[table_name] = daily_20120625[table_name]
print("日线行情-时间为序  daily_20120625 返回数据 row 行数 = "+str(daily_20120625.shape[0]))
daily_20120625_addname_dataframe.to_excel(daily_201206_excel_writer,'25_1',index=False)
daily_201206_excel_writer.save()
daily_20120626 = pro.daily(start_date='',end_date='',trade_date='20120626', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20120626_tscode_list = list() 
for ts_code_sh in daily_20120626['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20120626_tscode_list.append(stock_name)
daily_20120626_addname_dataframe=pd.DataFrame()
daily_20120626_addname_dataframe['cname'] = daily_20120626_tscode_list
for table_name in daily_20120626.columns.values.tolist():
    daily_20120626_addname_dataframe[table_name] = daily_20120626[table_name]
print("日线行情-时间为序  daily_20120626 返回数据 row 行数 = "+str(daily_20120626.shape[0]))
daily_20120626_addname_dataframe.to_excel(daily_201206_excel_writer,'26_2',index=False)
daily_201206_excel_writer.save()
daily_20120627 = pro.daily(start_date='',end_date='',trade_date='20120627', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20120627_tscode_list = list() 
for ts_code_sh in daily_20120627['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20120627_tscode_list.append(stock_name)
daily_20120627_addname_dataframe=pd.DataFrame()
daily_20120627_addname_dataframe['cname'] = daily_20120627_tscode_list
for table_name in daily_20120627.columns.values.tolist():
    daily_20120627_addname_dataframe[table_name] = daily_20120627[table_name]
print("日线行情-时间为序  daily_20120627 返回数据 row 行数 = "+str(daily_20120627.shape[0]))
daily_20120627_addname_dataframe.to_excel(daily_201206_excel_writer,'27_3',index=False)
daily_201206_excel_writer.save()
daily_20120628 = pro.daily(start_date='',end_date='',trade_date='20120628', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20120628_tscode_list = list() 
for ts_code_sh in daily_20120628['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20120628_tscode_list.append(stock_name)
daily_20120628_addname_dataframe=pd.DataFrame()
daily_20120628_addname_dataframe['cname'] = daily_20120628_tscode_list
for table_name in daily_20120628.columns.values.tolist():
    daily_20120628_addname_dataframe[table_name] = daily_20120628[table_name]
print("日线行情-时间为序  daily_20120628 返回数据 row 行数 = "+str(daily_20120628.shape[0]))
daily_20120628_addname_dataframe.to_excel(daily_201206_excel_writer,'28_4',index=False)
daily_201206_excel_writer.save()
daily_20120629 = pro.daily(start_date='',end_date='',trade_date='20120629', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20120629_tscode_list = list() 
for ts_code_sh in daily_20120629['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20120629_tscode_list.append(stock_name)
daily_20120629_addname_dataframe=pd.DataFrame()
daily_20120629_addname_dataframe['cname'] = daily_20120629_tscode_list
for table_name in daily_20120629.columns.values.tolist():
    daily_20120629_addname_dataframe[table_name] = daily_20120629[table_name]
print("日线行情-时间为序  daily_20120629 返回数据 row 行数 = "+str(daily_20120629.shape[0]))
daily_20120629_addname_dataframe.to_excel(daily_201206_excel_writer,'29_5',index=False)
daily_201206_excel_writer.save()




createexcel('daily_201207.xlsx')
daily_201207_book = load_workbook('C:\\Users\\zhuzj5\\Desktop\\zbin\\J0_Data\\daily_201207.xlsx')
daily_201207_excel_writer = pd.ExcelWriter('C:\\Users\\zhuzj5\\Desktop\\zbin\\J0_Data\\daily_201207.xlsx', engine='openpyxl')
daily_201207_excel_writer.book = daily_201207_book
daily_201207_excel_writer.sheets = dict((ws.title, ws) for ws in daily_201207_book.worksheets)
J0_PROPS.put(tree_node_name+"record_date", "20120701")       ###  更新 记录日期
daily_20120702 = pro.daily(start_date='',end_date='',trade_date='20120702', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20120702_tscode_list = list() 
for ts_code_sh in daily_20120702['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20120702_tscode_list.append(stock_name)
daily_20120702_addname_dataframe=pd.DataFrame()
daily_20120702_addname_dataframe['cname'] = daily_20120702_tscode_list
for table_name in daily_20120702.columns.values.tolist():
    daily_20120702_addname_dataframe[table_name] = daily_20120702[table_name]
print("日线行情-时间为序  daily_20120702 返回数据 row 行数 = "+str(daily_20120702.shape[0]))
daily_20120702_addname_dataframe.to_excel(daily_201207_excel_writer,'2_1',index=False)
daily_201207_excel_writer.save()
daily_20120703 = pro.daily(start_date='',end_date='',trade_date='20120703', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20120703_tscode_list = list() 
for ts_code_sh in daily_20120703['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20120703_tscode_list.append(stock_name)
daily_20120703_addname_dataframe=pd.DataFrame()
daily_20120703_addname_dataframe['cname'] = daily_20120703_tscode_list
for table_name in daily_20120703.columns.values.tolist():
    daily_20120703_addname_dataframe[table_name] = daily_20120703[table_name]
print("日线行情-时间为序  daily_20120703 返回数据 row 行数 = "+str(daily_20120703.shape[0]))
daily_20120703_addname_dataframe.to_excel(daily_201207_excel_writer,'3_2',index=False)
daily_201207_excel_writer.save()
daily_20120704 = pro.daily(start_date='',end_date='',trade_date='20120704', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20120704_tscode_list = list() 
for ts_code_sh in daily_20120704['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20120704_tscode_list.append(stock_name)
daily_20120704_addname_dataframe=pd.DataFrame()
daily_20120704_addname_dataframe['cname'] = daily_20120704_tscode_list
for table_name in daily_20120704.columns.values.tolist():
    daily_20120704_addname_dataframe[table_name] = daily_20120704[table_name]
print("日线行情-时间为序  daily_20120704 返回数据 row 行数 = "+str(daily_20120704.shape[0]))
daily_20120704_addname_dataframe.to_excel(daily_201207_excel_writer,'4_3',index=False)
daily_201207_excel_writer.save()
daily_20120705 = pro.daily(start_date='',end_date='',trade_date='20120705', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20120705_tscode_list = list() 
for ts_code_sh in daily_20120705['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20120705_tscode_list.append(stock_name)
daily_20120705_addname_dataframe=pd.DataFrame()
daily_20120705_addname_dataframe['cname'] = daily_20120705_tscode_list
for table_name in daily_20120705.columns.values.tolist():
    daily_20120705_addname_dataframe[table_name] = daily_20120705[table_name]
print("日线行情-时间为序  daily_20120705 返回数据 row 行数 = "+str(daily_20120705.shape[0]))
daily_20120705_addname_dataframe.to_excel(daily_201207_excel_writer,'5_4',index=False)
daily_201207_excel_writer.save()
daily_20120706 = pro.daily(start_date='',end_date='',trade_date='20120706', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20120706_tscode_list = list() 
for ts_code_sh in daily_20120706['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20120706_tscode_list.append(stock_name)
daily_20120706_addname_dataframe=pd.DataFrame()
daily_20120706_addname_dataframe['cname'] = daily_20120706_tscode_list
for table_name in daily_20120706.columns.values.tolist():
    daily_20120706_addname_dataframe[table_name] = daily_20120706[table_name]
print("日线行情-时间为序  daily_20120706 返回数据 row 行数 = "+str(daily_20120706.shape[0]))
daily_20120706_addname_dataframe.to_excel(daily_201207_excel_writer,'6_5',index=False)
daily_201207_excel_writer.save()
daily_20120709 = pro.daily(start_date='',end_date='',trade_date='20120709', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20120709_tscode_list = list() 
for ts_code_sh in daily_20120709['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20120709_tscode_list.append(stock_name)
daily_20120709_addname_dataframe=pd.DataFrame()
daily_20120709_addname_dataframe['cname'] = daily_20120709_tscode_list
for table_name in daily_20120709.columns.values.tolist():
    daily_20120709_addname_dataframe[table_name] = daily_20120709[table_name]
print("日线行情-时间为序  daily_20120709 返回数据 row 行数 = "+str(daily_20120709.shape[0]))
daily_20120709_addname_dataframe.to_excel(daily_201207_excel_writer,'9_1',index=False)
daily_201207_excel_writer.save()
daily_20120710 = pro.daily(start_date='',end_date='',trade_date='20120710', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20120710_tscode_list = list() 
for ts_code_sh in daily_20120710['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20120710_tscode_list.append(stock_name)
daily_20120710_addname_dataframe=pd.DataFrame()
daily_20120710_addname_dataframe['cname'] = daily_20120710_tscode_list
for table_name in daily_20120710.columns.values.tolist():
    daily_20120710_addname_dataframe[table_name] = daily_20120710[table_name]
print("日线行情-时间为序  daily_20120710 返回数据 row 行数 = "+str(daily_20120710.shape[0]))
daily_20120710_addname_dataframe.to_excel(daily_201207_excel_writer,'10_2',index=False)
daily_201207_excel_writer.save()
daily_20120711 = pro.daily(start_date='',end_date='',trade_date='20120711', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20120711_tscode_list = list() 
for ts_code_sh in daily_20120711['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20120711_tscode_list.append(stock_name)
daily_20120711_addname_dataframe=pd.DataFrame()
daily_20120711_addname_dataframe['cname'] = daily_20120711_tscode_list
for table_name in daily_20120711.columns.values.tolist():
    daily_20120711_addname_dataframe[table_name] = daily_20120711[table_name]
print("日线行情-时间为序  daily_20120711 返回数据 row 行数 = "+str(daily_20120711.shape[0]))
daily_20120711_addname_dataframe.to_excel(daily_201207_excel_writer,'11_3',index=False)
daily_201207_excel_writer.save()
daily_20120712 = pro.daily(start_date='',end_date='',trade_date='20120712', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20120712_tscode_list = list() 
for ts_code_sh in daily_20120712['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20120712_tscode_list.append(stock_name)
daily_20120712_addname_dataframe=pd.DataFrame()
daily_20120712_addname_dataframe['cname'] = daily_20120712_tscode_list
for table_name in daily_20120712.columns.values.tolist():
    daily_20120712_addname_dataframe[table_name] = daily_20120712[table_name]
print("日线行情-时间为序  daily_20120712 返回数据 row 行数 = "+str(daily_20120712.shape[0]))
daily_20120712_addname_dataframe.to_excel(daily_201207_excel_writer,'12_4',index=False)
daily_201207_excel_writer.save()
daily_20120713 = pro.daily(start_date='',end_date='',trade_date='20120713', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20120713_tscode_list = list() 
for ts_code_sh in daily_20120713['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20120713_tscode_list.append(stock_name)
daily_20120713_addname_dataframe=pd.DataFrame()
daily_20120713_addname_dataframe['cname'] = daily_20120713_tscode_list
for table_name in daily_20120713.columns.values.tolist():
    daily_20120713_addname_dataframe[table_name] = daily_20120713[table_name]
print("日线行情-时间为序  daily_20120713 返回数据 row 行数 = "+str(daily_20120713.shape[0]))
daily_20120713_addname_dataframe.to_excel(daily_201207_excel_writer,'13_5',index=False)
daily_201207_excel_writer.save()
daily_20120716 = pro.daily(start_date='',end_date='',trade_date='20120716', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20120716_tscode_list = list() 
for ts_code_sh in daily_20120716['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20120716_tscode_list.append(stock_name)
daily_20120716_addname_dataframe=pd.DataFrame()
daily_20120716_addname_dataframe['cname'] = daily_20120716_tscode_list
for table_name in daily_20120716.columns.values.tolist():
    daily_20120716_addname_dataframe[table_name] = daily_20120716[table_name]
print("日线行情-时间为序  daily_20120716 返回数据 row 行数 = "+str(daily_20120716.shape[0]))
daily_20120716_addname_dataframe.to_excel(daily_201207_excel_writer,'16_1',index=False)
daily_201207_excel_writer.save()
daily_20120717 = pro.daily(start_date='',end_date='',trade_date='20120717', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20120717_tscode_list = list() 
for ts_code_sh in daily_20120717['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20120717_tscode_list.append(stock_name)
daily_20120717_addname_dataframe=pd.DataFrame()
daily_20120717_addname_dataframe['cname'] = daily_20120717_tscode_list
for table_name in daily_20120717.columns.values.tolist():
    daily_20120717_addname_dataframe[table_name] = daily_20120717[table_name]
print("日线行情-时间为序  daily_20120717 返回数据 row 行数 = "+str(daily_20120717.shape[0]))
daily_20120717_addname_dataframe.to_excel(daily_201207_excel_writer,'17_2',index=False)
daily_201207_excel_writer.save()
daily_20120718 = pro.daily(start_date='',end_date='',trade_date='20120718', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20120718_tscode_list = list() 
for ts_code_sh in daily_20120718['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20120718_tscode_list.append(stock_name)
daily_20120718_addname_dataframe=pd.DataFrame()
daily_20120718_addname_dataframe['cname'] = daily_20120718_tscode_list
for table_name in daily_20120718.columns.values.tolist():
    daily_20120718_addname_dataframe[table_name] = daily_20120718[table_name]
print("日线行情-时间为序  daily_20120718 返回数据 row 行数 = "+str(daily_20120718.shape[0]))
daily_20120718_addname_dataframe.to_excel(daily_201207_excel_writer,'18_3',index=False)
daily_201207_excel_writer.save()
daily_20120719 = pro.daily(start_date='',end_date='',trade_date='20120719', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20120719_tscode_list = list() 
for ts_code_sh in daily_20120719['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20120719_tscode_list.append(stock_name)
daily_20120719_addname_dataframe=pd.DataFrame()
daily_20120719_addname_dataframe['cname'] = daily_20120719_tscode_list
for table_name in daily_20120719.columns.values.tolist():
    daily_20120719_addname_dataframe[table_name] = daily_20120719[table_name]
print("日线行情-时间为序  daily_20120719 返回数据 row 行数 = "+str(daily_20120719.shape[0]))
daily_20120719_addname_dataframe.to_excel(daily_201207_excel_writer,'19_4',index=False)
daily_201207_excel_writer.save()
daily_20120720 = pro.daily(start_date='',end_date='',trade_date='20120720', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20120720_tscode_list = list() 
for ts_code_sh in daily_20120720['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20120720_tscode_list.append(stock_name)
daily_20120720_addname_dataframe=pd.DataFrame()
daily_20120720_addname_dataframe['cname'] = daily_20120720_tscode_list
for table_name in daily_20120720.columns.values.tolist():
    daily_20120720_addname_dataframe[table_name] = daily_20120720[table_name]
print("日线行情-时间为序  daily_20120720 返回数据 row 行数 = "+str(daily_20120720.shape[0]))
daily_20120720_addname_dataframe.to_excel(daily_201207_excel_writer,'20_5',index=False)
daily_201207_excel_writer.save()
daily_20120723 = pro.daily(start_date='',end_date='',trade_date='20120723', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20120723_tscode_list = list() 
for ts_code_sh in daily_20120723['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20120723_tscode_list.append(stock_name)
daily_20120723_addname_dataframe=pd.DataFrame()
daily_20120723_addname_dataframe['cname'] = daily_20120723_tscode_list
for table_name in daily_20120723.columns.values.tolist():
    daily_20120723_addname_dataframe[table_name] = daily_20120723[table_name]
print("日线行情-时间为序  daily_20120723 返回数据 row 行数 = "+str(daily_20120723.shape[0]))
daily_20120723_addname_dataframe.to_excel(daily_201207_excel_writer,'23_1',index=False)
daily_201207_excel_writer.save()
daily_20120724 = pro.daily(start_date='',end_date='',trade_date='20120724', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20120724_tscode_list = list() 
for ts_code_sh in daily_20120724['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20120724_tscode_list.append(stock_name)
daily_20120724_addname_dataframe=pd.DataFrame()
daily_20120724_addname_dataframe['cname'] = daily_20120724_tscode_list
for table_name in daily_20120724.columns.values.tolist():
    daily_20120724_addname_dataframe[table_name] = daily_20120724[table_name]
print("日线行情-时间为序  daily_20120724 返回数据 row 行数 = "+str(daily_20120724.shape[0]))
daily_20120724_addname_dataframe.to_excel(daily_201207_excel_writer,'24_2',index=False)
daily_201207_excel_writer.save()
daily_20120725 = pro.daily(start_date='',end_date='',trade_date='20120725', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20120725_tscode_list = list() 
for ts_code_sh in daily_20120725['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20120725_tscode_list.append(stock_name)
daily_20120725_addname_dataframe=pd.DataFrame()
daily_20120725_addname_dataframe['cname'] = daily_20120725_tscode_list
for table_name in daily_20120725.columns.values.tolist():
    daily_20120725_addname_dataframe[table_name] = daily_20120725[table_name]
print("日线行情-时间为序  daily_20120725 返回数据 row 行数 = "+str(daily_20120725.shape[0]))
daily_20120725_addname_dataframe.to_excel(daily_201207_excel_writer,'25_3',index=False)
daily_201207_excel_writer.save()
daily_20120726 = pro.daily(start_date='',end_date='',trade_date='20120726', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20120726_tscode_list = list() 
for ts_code_sh in daily_20120726['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20120726_tscode_list.append(stock_name)
daily_20120726_addname_dataframe=pd.DataFrame()
daily_20120726_addname_dataframe['cname'] = daily_20120726_tscode_list
for table_name in daily_20120726.columns.values.tolist():
    daily_20120726_addname_dataframe[table_name] = daily_20120726[table_name]
print("日线行情-时间为序  daily_20120726 返回数据 row 行数 = "+str(daily_20120726.shape[0]))
daily_20120726_addname_dataframe.to_excel(daily_201207_excel_writer,'26_4',index=False)
daily_201207_excel_writer.save()
daily_20120727 = pro.daily(start_date='',end_date='',trade_date='20120727', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20120727_tscode_list = list() 
for ts_code_sh in daily_20120727['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20120727_tscode_list.append(stock_name)
daily_20120727_addname_dataframe=pd.DataFrame()
daily_20120727_addname_dataframe['cname'] = daily_20120727_tscode_list
for table_name in daily_20120727.columns.values.tolist():
    daily_20120727_addname_dataframe[table_name] = daily_20120727[table_name]
print("日线行情-时间为序  daily_20120727 返回数据 row 行数 = "+str(daily_20120727.shape[0]))
daily_20120727_addname_dataframe.to_excel(daily_201207_excel_writer,'27_5',index=False)
daily_201207_excel_writer.save()
daily_20120730 = pro.daily(start_date='',end_date='',trade_date='20120730', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20120730_tscode_list = list() 
for ts_code_sh in daily_20120730['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20120730_tscode_list.append(stock_name)
daily_20120730_addname_dataframe=pd.DataFrame()
daily_20120730_addname_dataframe['cname'] = daily_20120730_tscode_list
for table_name in daily_20120730.columns.values.tolist():
    daily_20120730_addname_dataframe[table_name] = daily_20120730[table_name]
print("日线行情-时间为序  daily_20120730 返回数据 row 行数 = "+str(daily_20120730.shape[0]))
daily_20120730_addname_dataframe.to_excel(daily_201207_excel_writer,'30_1',index=False)
daily_201207_excel_writer.save()
daily_20120731 = pro.daily(start_date='',end_date='',trade_date='20120731', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20120731_tscode_list = list() 
for ts_code_sh in daily_20120731['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20120731_tscode_list.append(stock_name)
daily_20120731_addname_dataframe=pd.DataFrame()
daily_20120731_addname_dataframe['cname'] = daily_20120731_tscode_list
for table_name in daily_20120731.columns.values.tolist():
    daily_20120731_addname_dataframe[table_name] = daily_20120731[table_name]
print("日线行情-时间为序  daily_20120731 返回数据 row 行数 = "+str(daily_20120731.shape[0]))
daily_20120731_addname_dataframe.to_excel(daily_201207_excel_writer,'31_2',index=False)
daily_201207_excel_writer.save()




createexcel('daily_201208.xlsx')
daily_201208_book = load_workbook('C:\\Users\\zhuzj5\\Desktop\\zbin\\J0_Data\\daily_201208.xlsx')
daily_201208_excel_writer = pd.ExcelWriter('C:\\Users\\zhuzj5\\Desktop\\zbin\\J0_Data\\daily_201208.xlsx', engine='openpyxl')
daily_201208_excel_writer.book = daily_201208_book
daily_201208_excel_writer.sheets = dict((ws.title, ws) for ws in daily_201208_book.worksheets)
J0_PROPS.put(tree_node_name+"record_date", "20120801")       ###  更新 记录日期
daily_20120801 = pro.daily(start_date='',end_date='',trade_date='20120801', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20120801_tscode_list = list() 
for ts_code_sh in daily_20120801['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20120801_tscode_list.append(stock_name)
daily_20120801_addname_dataframe=pd.DataFrame()
daily_20120801_addname_dataframe['cname'] = daily_20120801_tscode_list
for table_name in daily_20120801.columns.values.tolist():
    daily_20120801_addname_dataframe[table_name] = daily_20120801[table_name]
print("日线行情-时间为序  daily_20120801 返回数据 row 行数 = "+str(daily_20120801.shape[0]))
daily_20120801_addname_dataframe.to_excel(daily_201208_excel_writer,'1_3',index=False)
daily_201208_excel_writer.save()
daily_20120802 = pro.daily(start_date='',end_date='',trade_date='20120802', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20120802_tscode_list = list() 
for ts_code_sh in daily_20120802['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20120802_tscode_list.append(stock_name)
daily_20120802_addname_dataframe=pd.DataFrame()
daily_20120802_addname_dataframe['cname'] = daily_20120802_tscode_list
for table_name in daily_20120802.columns.values.tolist():
    daily_20120802_addname_dataframe[table_name] = daily_20120802[table_name]
print("日线行情-时间为序  daily_20120802 返回数据 row 行数 = "+str(daily_20120802.shape[0]))
daily_20120802_addname_dataframe.to_excel(daily_201208_excel_writer,'2_4',index=False)
daily_201208_excel_writer.save()
daily_20120803 = pro.daily(start_date='',end_date='',trade_date='20120803', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20120803_tscode_list = list() 
for ts_code_sh in daily_20120803['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20120803_tscode_list.append(stock_name)
daily_20120803_addname_dataframe=pd.DataFrame()
daily_20120803_addname_dataframe['cname'] = daily_20120803_tscode_list
for table_name in daily_20120803.columns.values.tolist():
    daily_20120803_addname_dataframe[table_name] = daily_20120803[table_name]
print("日线行情-时间为序  daily_20120803 返回数据 row 行数 = "+str(daily_20120803.shape[0]))
daily_20120803_addname_dataframe.to_excel(daily_201208_excel_writer,'3_5',index=False)
daily_201208_excel_writer.save()
daily_20120806 = pro.daily(start_date='',end_date='',trade_date='20120806', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20120806_tscode_list = list() 
for ts_code_sh in daily_20120806['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20120806_tscode_list.append(stock_name)
daily_20120806_addname_dataframe=pd.DataFrame()
daily_20120806_addname_dataframe['cname'] = daily_20120806_tscode_list
for table_name in daily_20120806.columns.values.tolist():
    daily_20120806_addname_dataframe[table_name] = daily_20120806[table_name]
print("日线行情-时间为序  daily_20120806 返回数据 row 行数 = "+str(daily_20120806.shape[0]))
daily_20120806_addname_dataframe.to_excel(daily_201208_excel_writer,'6_1',index=False)
daily_201208_excel_writer.save()
daily_20120807 = pro.daily(start_date='',end_date='',trade_date='20120807', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20120807_tscode_list = list() 
for ts_code_sh in daily_20120807['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20120807_tscode_list.append(stock_name)
daily_20120807_addname_dataframe=pd.DataFrame()
daily_20120807_addname_dataframe['cname'] = daily_20120807_tscode_list
for table_name in daily_20120807.columns.values.tolist():
    daily_20120807_addname_dataframe[table_name] = daily_20120807[table_name]
print("日线行情-时间为序  daily_20120807 返回数据 row 行数 = "+str(daily_20120807.shape[0]))
daily_20120807_addname_dataframe.to_excel(daily_201208_excel_writer,'7_2',index=False)
daily_201208_excel_writer.save()
daily_20120808 = pro.daily(start_date='',end_date='',trade_date='20120808', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20120808_tscode_list = list() 
for ts_code_sh in daily_20120808['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20120808_tscode_list.append(stock_name)
daily_20120808_addname_dataframe=pd.DataFrame()
daily_20120808_addname_dataframe['cname'] = daily_20120808_tscode_list
for table_name in daily_20120808.columns.values.tolist():
    daily_20120808_addname_dataframe[table_name] = daily_20120808[table_name]
print("日线行情-时间为序  daily_20120808 返回数据 row 行数 = "+str(daily_20120808.shape[0]))
daily_20120808_addname_dataframe.to_excel(daily_201208_excel_writer,'8_3',index=False)
daily_201208_excel_writer.save()
daily_20120809 = pro.daily(start_date='',end_date='',trade_date='20120809', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20120809_tscode_list = list() 
for ts_code_sh in daily_20120809['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20120809_tscode_list.append(stock_name)
daily_20120809_addname_dataframe=pd.DataFrame()
daily_20120809_addname_dataframe['cname'] = daily_20120809_tscode_list
for table_name in daily_20120809.columns.values.tolist():
    daily_20120809_addname_dataframe[table_name] = daily_20120809[table_name]
print("日线行情-时间为序  daily_20120809 返回数据 row 行数 = "+str(daily_20120809.shape[0]))
daily_20120809_addname_dataframe.to_excel(daily_201208_excel_writer,'9_4',index=False)
daily_201208_excel_writer.save()
daily_20120810 = pro.daily(start_date='',end_date='',trade_date='20120810', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20120810_tscode_list = list() 
for ts_code_sh in daily_20120810['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20120810_tscode_list.append(stock_name)
daily_20120810_addname_dataframe=pd.DataFrame()
daily_20120810_addname_dataframe['cname'] = daily_20120810_tscode_list
for table_name in daily_20120810.columns.values.tolist():
    daily_20120810_addname_dataframe[table_name] = daily_20120810[table_name]
print("日线行情-时间为序  daily_20120810 返回数据 row 行数 = "+str(daily_20120810.shape[0]))
daily_20120810_addname_dataframe.to_excel(daily_201208_excel_writer,'10_5',index=False)
daily_201208_excel_writer.save()
daily_20120813 = pro.daily(start_date='',end_date='',trade_date='20120813', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20120813_tscode_list = list() 
for ts_code_sh in daily_20120813['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20120813_tscode_list.append(stock_name)
daily_20120813_addname_dataframe=pd.DataFrame()
daily_20120813_addname_dataframe['cname'] = daily_20120813_tscode_list
for table_name in daily_20120813.columns.values.tolist():
    daily_20120813_addname_dataframe[table_name] = daily_20120813[table_name]
print("日线行情-时间为序  daily_20120813 返回数据 row 行数 = "+str(daily_20120813.shape[0]))
daily_20120813_addname_dataframe.to_excel(daily_201208_excel_writer,'13_1',index=False)
daily_201208_excel_writer.save()
daily_20120814 = pro.daily(start_date='',end_date='',trade_date='20120814', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20120814_tscode_list = list() 
for ts_code_sh in daily_20120814['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20120814_tscode_list.append(stock_name)
daily_20120814_addname_dataframe=pd.DataFrame()
daily_20120814_addname_dataframe['cname'] = daily_20120814_tscode_list
for table_name in daily_20120814.columns.values.tolist():
    daily_20120814_addname_dataframe[table_name] = daily_20120814[table_name]
print("日线行情-时间为序  daily_20120814 返回数据 row 行数 = "+str(daily_20120814.shape[0]))
daily_20120814_addname_dataframe.to_excel(daily_201208_excel_writer,'14_2',index=False)
daily_201208_excel_writer.save()
daily_20120815 = pro.daily(start_date='',end_date='',trade_date='20120815', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20120815_tscode_list = list() 
for ts_code_sh in daily_20120815['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20120815_tscode_list.append(stock_name)
daily_20120815_addname_dataframe=pd.DataFrame()
daily_20120815_addname_dataframe['cname'] = daily_20120815_tscode_list
for table_name in daily_20120815.columns.values.tolist():
    daily_20120815_addname_dataframe[table_name] = daily_20120815[table_name]
print("日线行情-时间为序  daily_20120815 返回数据 row 行数 = "+str(daily_20120815.shape[0]))
daily_20120815_addname_dataframe.to_excel(daily_201208_excel_writer,'15_3',index=False)
daily_201208_excel_writer.save()
daily_20120816 = pro.daily(start_date='',end_date='',trade_date='20120816', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20120816_tscode_list = list() 
for ts_code_sh in daily_20120816['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20120816_tscode_list.append(stock_name)
daily_20120816_addname_dataframe=pd.DataFrame()
daily_20120816_addname_dataframe['cname'] = daily_20120816_tscode_list
for table_name in daily_20120816.columns.values.tolist():
    daily_20120816_addname_dataframe[table_name] = daily_20120816[table_name]
print("日线行情-时间为序  daily_20120816 返回数据 row 行数 = "+str(daily_20120816.shape[0]))
daily_20120816_addname_dataframe.to_excel(daily_201208_excel_writer,'16_4',index=False)
daily_201208_excel_writer.save()
daily_20120817 = pro.daily(start_date='',end_date='',trade_date='20120817', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20120817_tscode_list = list() 
for ts_code_sh in daily_20120817['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20120817_tscode_list.append(stock_name)
daily_20120817_addname_dataframe=pd.DataFrame()
daily_20120817_addname_dataframe['cname'] = daily_20120817_tscode_list
for table_name in daily_20120817.columns.values.tolist():
    daily_20120817_addname_dataframe[table_name] = daily_20120817[table_name]
print("日线行情-时间为序  daily_20120817 返回数据 row 行数 = "+str(daily_20120817.shape[0]))
daily_20120817_addname_dataframe.to_excel(daily_201208_excel_writer,'17_5',index=False)
daily_201208_excel_writer.save()
daily_20120820 = pro.daily(start_date='',end_date='',trade_date='20120820', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20120820_tscode_list = list() 
for ts_code_sh in daily_20120820['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20120820_tscode_list.append(stock_name)
daily_20120820_addname_dataframe=pd.DataFrame()
daily_20120820_addname_dataframe['cname'] = daily_20120820_tscode_list
for table_name in daily_20120820.columns.values.tolist():
    daily_20120820_addname_dataframe[table_name] = daily_20120820[table_name]
print("日线行情-时间为序  daily_20120820 返回数据 row 行数 = "+str(daily_20120820.shape[0]))
daily_20120820_addname_dataframe.to_excel(daily_201208_excel_writer,'20_1',index=False)
daily_201208_excel_writer.save()
daily_20120821 = pro.daily(start_date='',end_date='',trade_date='20120821', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20120821_tscode_list = list() 
for ts_code_sh in daily_20120821['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20120821_tscode_list.append(stock_name)
daily_20120821_addname_dataframe=pd.DataFrame()
daily_20120821_addname_dataframe['cname'] = daily_20120821_tscode_list
for table_name in daily_20120821.columns.values.tolist():
    daily_20120821_addname_dataframe[table_name] = daily_20120821[table_name]
print("日线行情-时间为序  daily_20120821 返回数据 row 行数 = "+str(daily_20120821.shape[0]))
daily_20120821_addname_dataframe.to_excel(daily_201208_excel_writer,'21_2',index=False)
daily_201208_excel_writer.save()
daily_20120822 = pro.daily(start_date='',end_date='',trade_date='20120822', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20120822_tscode_list = list() 
for ts_code_sh in daily_20120822['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20120822_tscode_list.append(stock_name)
daily_20120822_addname_dataframe=pd.DataFrame()
daily_20120822_addname_dataframe['cname'] = daily_20120822_tscode_list
for table_name in daily_20120822.columns.values.tolist():
    daily_20120822_addname_dataframe[table_name] = daily_20120822[table_name]
print("日线行情-时间为序  daily_20120822 返回数据 row 行数 = "+str(daily_20120822.shape[0]))
daily_20120822_addname_dataframe.to_excel(daily_201208_excel_writer,'22_3',index=False)
daily_201208_excel_writer.save()
daily_20120823 = pro.daily(start_date='',end_date='',trade_date='20120823', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20120823_tscode_list = list() 
for ts_code_sh in daily_20120823['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20120823_tscode_list.append(stock_name)
daily_20120823_addname_dataframe=pd.DataFrame()
daily_20120823_addname_dataframe['cname'] = daily_20120823_tscode_list
for table_name in daily_20120823.columns.values.tolist():
    daily_20120823_addname_dataframe[table_name] = daily_20120823[table_name]
print("日线行情-时间为序  daily_20120823 返回数据 row 行数 = "+str(daily_20120823.shape[0]))
daily_20120823_addname_dataframe.to_excel(daily_201208_excel_writer,'23_4',index=False)
daily_201208_excel_writer.save()
daily_20120824 = pro.daily(start_date='',end_date='',trade_date='20120824', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20120824_tscode_list = list() 
for ts_code_sh in daily_20120824['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20120824_tscode_list.append(stock_name)
daily_20120824_addname_dataframe=pd.DataFrame()
daily_20120824_addname_dataframe['cname'] = daily_20120824_tscode_list
for table_name in daily_20120824.columns.values.tolist():
    daily_20120824_addname_dataframe[table_name] = daily_20120824[table_name]
print("日线行情-时间为序  daily_20120824 返回数据 row 行数 = "+str(daily_20120824.shape[0]))
daily_20120824_addname_dataframe.to_excel(daily_201208_excel_writer,'24_5',index=False)
daily_201208_excel_writer.save()
daily_20120827 = pro.daily(start_date='',end_date='',trade_date='20120827', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20120827_tscode_list = list() 
for ts_code_sh in daily_20120827['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20120827_tscode_list.append(stock_name)
daily_20120827_addname_dataframe=pd.DataFrame()
daily_20120827_addname_dataframe['cname'] = daily_20120827_tscode_list
for table_name in daily_20120827.columns.values.tolist():
    daily_20120827_addname_dataframe[table_name] = daily_20120827[table_name]
print("日线行情-时间为序  daily_20120827 返回数据 row 行数 = "+str(daily_20120827.shape[0]))
daily_20120827_addname_dataframe.to_excel(daily_201208_excel_writer,'27_1',index=False)
daily_201208_excel_writer.save()
daily_20120828 = pro.daily(start_date='',end_date='',trade_date='20120828', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20120828_tscode_list = list() 
for ts_code_sh in daily_20120828['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20120828_tscode_list.append(stock_name)
daily_20120828_addname_dataframe=pd.DataFrame()
daily_20120828_addname_dataframe['cname'] = daily_20120828_tscode_list
for table_name in daily_20120828.columns.values.tolist():
    daily_20120828_addname_dataframe[table_name] = daily_20120828[table_name]
print("日线行情-时间为序  daily_20120828 返回数据 row 行数 = "+str(daily_20120828.shape[0]))
daily_20120828_addname_dataframe.to_excel(daily_201208_excel_writer,'28_2',index=False)
daily_201208_excel_writer.save()
daily_20120829 = pro.daily(start_date='',end_date='',trade_date='20120829', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20120829_tscode_list = list() 
for ts_code_sh in daily_20120829['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20120829_tscode_list.append(stock_name)
daily_20120829_addname_dataframe=pd.DataFrame()
daily_20120829_addname_dataframe['cname'] = daily_20120829_tscode_list
for table_name in daily_20120829.columns.values.tolist():
    daily_20120829_addname_dataframe[table_name] = daily_20120829[table_name]
print("日线行情-时间为序  daily_20120829 返回数据 row 行数 = "+str(daily_20120829.shape[0]))
daily_20120829_addname_dataframe.to_excel(daily_201208_excel_writer,'29_3',index=False)
daily_201208_excel_writer.save()
daily_20120830 = pro.daily(start_date='',end_date='',trade_date='20120830', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20120830_tscode_list = list() 
for ts_code_sh in daily_20120830['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20120830_tscode_list.append(stock_name)
daily_20120830_addname_dataframe=pd.DataFrame()
daily_20120830_addname_dataframe['cname'] = daily_20120830_tscode_list
for table_name in daily_20120830.columns.values.tolist():
    daily_20120830_addname_dataframe[table_name] = daily_20120830[table_name]
print("日线行情-时间为序  daily_20120830 返回数据 row 行数 = "+str(daily_20120830.shape[0]))
daily_20120830_addname_dataframe.to_excel(daily_201208_excel_writer,'30_4',index=False)
daily_201208_excel_writer.save()
daily_20120831 = pro.daily(start_date='',end_date='',trade_date='20120831', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20120831_tscode_list = list() 
for ts_code_sh in daily_20120831['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20120831_tscode_list.append(stock_name)
daily_20120831_addname_dataframe=pd.DataFrame()
daily_20120831_addname_dataframe['cname'] = daily_20120831_tscode_list
for table_name in daily_20120831.columns.values.tolist():
    daily_20120831_addname_dataframe[table_name] = daily_20120831[table_name]
print("日线行情-时间为序  daily_20120831 返回数据 row 行数 = "+str(daily_20120831.shape[0]))
daily_20120831_addname_dataframe.to_excel(daily_201208_excel_writer,'31_5',index=False)
daily_201208_excel_writer.save()




createexcel('daily_201209.xlsx')
daily_201209_book = load_workbook('C:\\Users\\zhuzj5\\Desktop\\zbin\\J0_Data\\daily_201209.xlsx')
daily_201209_excel_writer = pd.ExcelWriter('C:\\Users\\zhuzj5\\Desktop\\zbin\\J0_Data\\daily_201209.xlsx', engine='openpyxl')
daily_201209_excel_writer.book = daily_201209_book
daily_201209_excel_writer.sheets = dict((ws.title, ws) for ws in daily_201209_book.worksheets)
J0_PROPS.put(tree_node_name+"record_date", "20120901")       ###  更新 记录日期
daily_20120903 = pro.daily(start_date='',end_date='',trade_date='20120903', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20120903_tscode_list = list() 
for ts_code_sh in daily_20120903['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20120903_tscode_list.append(stock_name)
daily_20120903_addname_dataframe=pd.DataFrame()
daily_20120903_addname_dataframe['cname'] = daily_20120903_tscode_list
for table_name in daily_20120903.columns.values.tolist():
    daily_20120903_addname_dataframe[table_name] = daily_20120903[table_name]
print("日线行情-时间为序  daily_20120903 返回数据 row 行数 = "+str(daily_20120903.shape[0]))
daily_20120903_addname_dataframe.to_excel(daily_201209_excel_writer,'3_1',index=False)
daily_201209_excel_writer.save()
daily_20120904 = pro.daily(start_date='',end_date='',trade_date='20120904', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20120904_tscode_list = list() 
for ts_code_sh in daily_20120904['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20120904_tscode_list.append(stock_name)
daily_20120904_addname_dataframe=pd.DataFrame()
daily_20120904_addname_dataframe['cname'] = daily_20120904_tscode_list
for table_name in daily_20120904.columns.values.tolist():
    daily_20120904_addname_dataframe[table_name] = daily_20120904[table_name]
print("日线行情-时间为序  daily_20120904 返回数据 row 行数 = "+str(daily_20120904.shape[0]))
daily_20120904_addname_dataframe.to_excel(daily_201209_excel_writer,'4_2',index=False)
daily_201209_excel_writer.save()
daily_20120905 = pro.daily(start_date='',end_date='',trade_date='20120905', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20120905_tscode_list = list() 
for ts_code_sh in daily_20120905['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20120905_tscode_list.append(stock_name)
daily_20120905_addname_dataframe=pd.DataFrame()
daily_20120905_addname_dataframe['cname'] = daily_20120905_tscode_list
for table_name in daily_20120905.columns.values.tolist():
    daily_20120905_addname_dataframe[table_name] = daily_20120905[table_name]
print("日线行情-时间为序  daily_20120905 返回数据 row 行数 = "+str(daily_20120905.shape[0]))
daily_20120905_addname_dataframe.to_excel(daily_201209_excel_writer,'5_3',index=False)
daily_201209_excel_writer.save()
daily_20120906 = pro.daily(start_date='',end_date='',trade_date='20120906', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20120906_tscode_list = list() 
for ts_code_sh in daily_20120906['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20120906_tscode_list.append(stock_name)
daily_20120906_addname_dataframe=pd.DataFrame()
daily_20120906_addname_dataframe['cname'] = daily_20120906_tscode_list
for table_name in daily_20120906.columns.values.tolist():
    daily_20120906_addname_dataframe[table_name] = daily_20120906[table_name]
print("日线行情-时间为序  daily_20120906 返回数据 row 行数 = "+str(daily_20120906.shape[0]))
daily_20120906_addname_dataframe.to_excel(daily_201209_excel_writer,'6_4',index=False)
daily_201209_excel_writer.save()
daily_20120907 = pro.daily(start_date='',end_date='',trade_date='20120907', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20120907_tscode_list = list() 
for ts_code_sh in daily_20120907['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20120907_tscode_list.append(stock_name)
daily_20120907_addname_dataframe=pd.DataFrame()
daily_20120907_addname_dataframe['cname'] = daily_20120907_tscode_list
for table_name in daily_20120907.columns.values.tolist():
    daily_20120907_addname_dataframe[table_name] = daily_20120907[table_name]
print("日线行情-时间为序  daily_20120907 返回数据 row 行数 = "+str(daily_20120907.shape[0]))
daily_20120907_addname_dataframe.to_excel(daily_201209_excel_writer,'7_5',index=False)
daily_201209_excel_writer.save()
daily_20120910 = pro.daily(start_date='',end_date='',trade_date='20120910', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20120910_tscode_list = list() 
for ts_code_sh in daily_20120910['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20120910_tscode_list.append(stock_name)
daily_20120910_addname_dataframe=pd.DataFrame()
daily_20120910_addname_dataframe['cname'] = daily_20120910_tscode_list
for table_name in daily_20120910.columns.values.tolist():
    daily_20120910_addname_dataframe[table_name] = daily_20120910[table_name]
print("日线行情-时间为序  daily_20120910 返回数据 row 行数 = "+str(daily_20120910.shape[0]))
daily_20120910_addname_dataframe.to_excel(daily_201209_excel_writer,'10_1',index=False)
daily_201209_excel_writer.save()
daily_20120911 = pro.daily(start_date='',end_date='',trade_date='20120911', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20120911_tscode_list = list() 
for ts_code_sh in daily_20120911['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20120911_tscode_list.append(stock_name)
daily_20120911_addname_dataframe=pd.DataFrame()
daily_20120911_addname_dataframe['cname'] = daily_20120911_tscode_list
for table_name in daily_20120911.columns.values.tolist():
    daily_20120911_addname_dataframe[table_name] = daily_20120911[table_name]
print("日线行情-时间为序  daily_20120911 返回数据 row 行数 = "+str(daily_20120911.shape[0]))
daily_20120911_addname_dataframe.to_excel(daily_201209_excel_writer,'11_2',index=False)
daily_201209_excel_writer.save()
daily_20120912 = pro.daily(start_date='',end_date='',trade_date='20120912', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20120912_tscode_list = list() 
for ts_code_sh in daily_20120912['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20120912_tscode_list.append(stock_name)
daily_20120912_addname_dataframe=pd.DataFrame()
daily_20120912_addname_dataframe['cname'] = daily_20120912_tscode_list
for table_name in daily_20120912.columns.values.tolist():
    daily_20120912_addname_dataframe[table_name] = daily_20120912[table_name]
print("日线行情-时间为序  daily_20120912 返回数据 row 行数 = "+str(daily_20120912.shape[0]))
daily_20120912_addname_dataframe.to_excel(daily_201209_excel_writer,'12_3',index=False)
daily_201209_excel_writer.save()
daily_20120913 = pro.daily(start_date='',end_date='',trade_date='20120913', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20120913_tscode_list = list() 
for ts_code_sh in daily_20120913['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20120913_tscode_list.append(stock_name)
daily_20120913_addname_dataframe=pd.DataFrame()
daily_20120913_addname_dataframe['cname'] = daily_20120913_tscode_list
for table_name in daily_20120913.columns.values.tolist():
    daily_20120913_addname_dataframe[table_name] = daily_20120913[table_name]
print("日线行情-时间为序  daily_20120913 返回数据 row 行数 = "+str(daily_20120913.shape[0]))
daily_20120913_addname_dataframe.to_excel(daily_201209_excel_writer,'13_4',index=False)
daily_201209_excel_writer.save()
daily_20120914 = pro.daily(start_date='',end_date='',trade_date='20120914', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20120914_tscode_list = list() 
for ts_code_sh in daily_20120914['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20120914_tscode_list.append(stock_name)
daily_20120914_addname_dataframe=pd.DataFrame()
daily_20120914_addname_dataframe['cname'] = daily_20120914_tscode_list
for table_name in daily_20120914.columns.values.tolist():
    daily_20120914_addname_dataframe[table_name] = daily_20120914[table_name]
print("日线行情-时间为序  daily_20120914 返回数据 row 行数 = "+str(daily_20120914.shape[0]))
daily_20120914_addname_dataframe.to_excel(daily_201209_excel_writer,'14_5',index=False)
daily_201209_excel_writer.save()
daily_20120917 = pro.daily(start_date='',end_date='',trade_date='20120917', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20120917_tscode_list = list() 
for ts_code_sh in daily_20120917['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20120917_tscode_list.append(stock_name)
daily_20120917_addname_dataframe=pd.DataFrame()
daily_20120917_addname_dataframe['cname'] = daily_20120917_tscode_list
for table_name in daily_20120917.columns.values.tolist():
    daily_20120917_addname_dataframe[table_name] = daily_20120917[table_name]
print("日线行情-时间为序  daily_20120917 返回数据 row 行数 = "+str(daily_20120917.shape[0]))
daily_20120917_addname_dataframe.to_excel(daily_201209_excel_writer,'17_1',index=False)
daily_201209_excel_writer.save()
daily_20120918 = pro.daily(start_date='',end_date='',trade_date='20120918', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20120918_tscode_list = list() 
for ts_code_sh in daily_20120918['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20120918_tscode_list.append(stock_name)
daily_20120918_addname_dataframe=pd.DataFrame()
daily_20120918_addname_dataframe['cname'] = daily_20120918_tscode_list
for table_name in daily_20120918.columns.values.tolist():
    daily_20120918_addname_dataframe[table_name] = daily_20120918[table_name]
print("日线行情-时间为序  daily_20120918 返回数据 row 行数 = "+str(daily_20120918.shape[0]))
daily_20120918_addname_dataframe.to_excel(daily_201209_excel_writer,'18_2',index=False)
daily_201209_excel_writer.save()
daily_20120919 = pro.daily(start_date='',end_date='',trade_date='20120919', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20120919_tscode_list = list() 
for ts_code_sh in daily_20120919['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20120919_tscode_list.append(stock_name)
daily_20120919_addname_dataframe=pd.DataFrame()
daily_20120919_addname_dataframe['cname'] = daily_20120919_tscode_list
for table_name in daily_20120919.columns.values.tolist():
    daily_20120919_addname_dataframe[table_name] = daily_20120919[table_name]
print("日线行情-时间为序  daily_20120919 返回数据 row 行数 = "+str(daily_20120919.shape[0]))
daily_20120919_addname_dataframe.to_excel(daily_201209_excel_writer,'19_3',index=False)
daily_201209_excel_writer.save()
daily_20120920 = pro.daily(start_date='',end_date='',trade_date='20120920', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20120920_tscode_list = list() 
for ts_code_sh in daily_20120920['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20120920_tscode_list.append(stock_name)
daily_20120920_addname_dataframe=pd.DataFrame()
daily_20120920_addname_dataframe['cname'] = daily_20120920_tscode_list
for table_name in daily_20120920.columns.values.tolist():
    daily_20120920_addname_dataframe[table_name] = daily_20120920[table_name]
print("日线行情-时间为序  daily_20120920 返回数据 row 行数 = "+str(daily_20120920.shape[0]))
daily_20120920_addname_dataframe.to_excel(daily_201209_excel_writer,'20_4',index=False)
daily_201209_excel_writer.save()
daily_20120921 = pro.daily(start_date='',end_date='',trade_date='20120921', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20120921_tscode_list = list() 
for ts_code_sh in daily_20120921['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20120921_tscode_list.append(stock_name)
daily_20120921_addname_dataframe=pd.DataFrame()
daily_20120921_addname_dataframe['cname'] = daily_20120921_tscode_list
for table_name in daily_20120921.columns.values.tolist():
    daily_20120921_addname_dataframe[table_name] = daily_20120921[table_name]
print("日线行情-时间为序  daily_20120921 返回数据 row 行数 = "+str(daily_20120921.shape[0]))
daily_20120921_addname_dataframe.to_excel(daily_201209_excel_writer,'21_5',index=False)
daily_201209_excel_writer.save()
daily_20120924 = pro.daily(start_date='',end_date='',trade_date='20120924', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20120924_tscode_list = list() 
for ts_code_sh in daily_20120924['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20120924_tscode_list.append(stock_name)
daily_20120924_addname_dataframe=pd.DataFrame()
daily_20120924_addname_dataframe['cname'] = daily_20120924_tscode_list
for table_name in daily_20120924.columns.values.tolist():
    daily_20120924_addname_dataframe[table_name] = daily_20120924[table_name]
print("日线行情-时间为序  daily_20120924 返回数据 row 行数 = "+str(daily_20120924.shape[0]))
daily_20120924_addname_dataframe.to_excel(daily_201209_excel_writer,'24_1',index=False)
daily_201209_excel_writer.save()
daily_20120925 = pro.daily(start_date='',end_date='',trade_date='20120925', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20120925_tscode_list = list() 
for ts_code_sh in daily_20120925['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20120925_tscode_list.append(stock_name)
daily_20120925_addname_dataframe=pd.DataFrame()
daily_20120925_addname_dataframe['cname'] = daily_20120925_tscode_list
for table_name in daily_20120925.columns.values.tolist():
    daily_20120925_addname_dataframe[table_name] = daily_20120925[table_name]
print("日线行情-时间为序  daily_20120925 返回数据 row 行数 = "+str(daily_20120925.shape[0]))
daily_20120925_addname_dataframe.to_excel(daily_201209_excel_writer,'25_2',index=False)
daily_201209_excel_writer.save()
daily_20120926 = pro.daily(start_date='',end_date='',trade_date='20120926', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20120926_tscode_list = list() 
for ts_code_sh in daily_20120926['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20120926_tscode_list.append(stock_name)
daily_20120926_addname_dataframe=pd.DataFrame()
daily_20120926_addname_dataframe['cname'] = daily_20120926_tscode_list
for table_name in daily_20120926.columns.values.tolist():
    daily_20120926_addname_dataframe[table_name] = daily_20120926[table_name]
print("日线行情-时间为序  daily_20120926 返回数据 row 行数 = "+str(daily_20120926.shape[0]))
daily_20120926_addname_dataframe.to_excel(daily_201209_excel_writer,'26_3',index=False)
daily_201209_excel_writer.save()
daily_20120927 = pro.daily(start_date='',end_date='',trade_date='20120927', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20120927_tscode_list = list() 
for ts_code_sh in daily_20120927['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20120927_tscode_list.append(stock_name)
daily_20120927_addname_dataframe=pd.DataFrame()
daily_20120927_addname_dataframe['cname'] = daily_20120927_tscode_list
for table_name in daily_20120927.columns.values.tolist():
    daily_20120927_addname_dataframe[table_name] = daily_20120927[table_name]
print("日线行情-时间为序  daily_20120927 返回数据 row 行数 = "+str(daily_20120927.shape[0]))
daily_20120927_addname_dataframe.to_excel(daily_201209_excel_writer,'27_4',index=False)
daily_201209_excel_writer.save()
daily_20120928 = pro.daily(start_date='',end_date='',trade_date='20120928', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20120928_tscode_list = list() 
for ts_code_sh in daily_20120928['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20120928_tscode_list.append(stock_name)
daily_20120928_addname_dataframe=pd.DataFrame()
daily_20120928_addname_dataframe['cname'] = daily_20120928_tscode_list
for table_name in daily_20120928.columns.values.tolist():
    daily_20120928_addname_dataframe[table_name] = daily_20120928[table_name]
print("日线行情-时间为序  daily_20120928 返回数据 row 行数 = "+str(daily_20120928.shape[0]))
daily_20120928_addname_dataframe.to_excel(daily_201209_excel_writer,'28_5',index=False)
daily_201209_excel_writer.save()




createexcel('daily_201210.xlsx')
daily_201210_book = load_workbook('C:\\Users\\zhuzj5\\Desktop\\zbin\\J0_Data\\daily_201210.xlsx')
daily_201210_excel_writer = pd.ExcelWriter('C:\\Users\\zhuzj5\\Desktop\\zbin\\J0_Data\\daily_201210.xlsx', engine='openpyxl')
daily_201210_excel_writer.book = daily_201210_book
daily_201210_excel_writer.sheets = dict((ws.title, ws) for ws in daily_201210_book.worksheets)
J0_PROPS.put(tree_node_name+"record_date", "20121001")       ###  更新 记录日期
daily_20121008 = pro.daily(start_date='',end_date='',trade_date='20121008', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20121008_tscode_list = list() 
for ts_code_sh in daily_20121008['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20121008_tscode_list.append(stock_name)
daily_20121008_addname_dataframe=pd.DataFrame()
daily_20121008_addname_dataframe['cname'] = daily_20121008_tscode_list
for table_name in daily_20121008.columns.values.tolist():
    daily_20121008_addname_dataframe[table_name] = daily_20121008[table_name]
print("日线行情-时间为序  daily_20121008 返回数据 row 行数 = "+str(daily_20121008.shape[0]))
daily_20121008_addname_dataframe.to_excel(daily_201210_excel_writer,'8_1',index=False)
daily_201210_excel_writer.save()
daily_20121009 = pro.daily(start_date='',end_date='',trade_date='20121009', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20121009_tscode_list = list() 
for ts_code_sh in daily_20121009['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20121009_tscode_list.append(stock_name)
daily_20121009_addname_dataframe=pd.DataFrame()
daily_20121009_addname_dataframe['cname'] = daily_20121009_tscode_list
for table_name in daily_20121009.columns.values.tolist():
    daily_20121009_addname_dataframe[table_name] = daily_20121009[table_name]
print("日线行情-时间为序  daily_20121009 返回数据 row 行数 = "+str(daily_20121009.shape[0]))
daily_20121009_addname_dataframe.to_excel(daily_201210_excel_writer,'9_2',index=False)
daily_201210_excel_writer.save()
daily_20121010 = pro.daily(start_date='',end_date='',trade_date='20121010', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20121010_tscode_list = list() 
for ts_code_sh in daily_20121010['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20121010_tscode_list.append(stock_name)
daily_20121010_addname_dataframe=pd.DataFrame()
daily_20121010_addname_dataframe['cname'] = daily_20121010_tscode_list
for table_name in daily_20121010.columns.values.tolist():
    daily_20121010_addname_dataframe[table_name] = daily_20121010[table_name]
print("日线行情-时间为序  daily_20121010 返回数据 row 行数 = "+str(daily_20121010.shape[0]))
daily_20121010_addname_dataframe.to_excel(daily_201210_excel_writer,'10_3',index=False)
daily_201210_excel_writer.save()
daily_20121011 = pro.daily(start_date='',end_date='',trade_date='20121011', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20121011_tscode_list = list() 
for ts_code_sh in daily_20121011['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20121011_tscode_list.append(stock_name)
daily_20121011_addname_dataframe=pd.DataFrame()
daily_20121011_addname_dataframe['cname'] = daily_20121011_tscode_list
for table_name in daily_20121011.columns.values.tolist():
    daily_20121011_addname_dataframe[table_name] = daily_20121011[table_name]
print("日线行情-时间为序  daily_20121011 返回数据 row 行数 = "+str(daily_20121011.shape[0]))
daily_20121011_addname_dataframe.to_excel(daily_201210_excel_writer,'11_4',index=False)
daily_201210_excel_writer.save()
daily_20121012 = pro.daily(start_date='',end_date='',trade_date='20121012', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20121012_tscode_list = list() 
for ts_code_sh in daily_20121012['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20121012_tscode_list.append(stock_name)
daily_20121012_addname_dataframe=pd.DataFrame()
daily_20121012_addname_dataframe['cname'] = daily_20121012_tscode_list
for table_name in daily_20121012.columns.values.tolist():
    daily_20121012_addname_dataframe[table_name] = daily_20121012[table_name]
print("日线行情-时间为序  daily_20121012 返回数据 row 行数 = "+str(daily_20121012.shape[0]))
daily_20121012_addname_dataframe.to_excel(daily_201210_excel_writer,'12_5',index=False)
daily_201210_excel_writer.save()
daily_20121015 = pro.daily(start_date='',end_date='',trade_date='20121015', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20121015_tscode_list = list() 
for ts_code_sh in daily_20121015['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20121015_tscode_list.append(stock_name)
daily_20121015_addname_dataframe=pd.DataFrame()
daily_20121015_addname_dataframe['cname'] = daily_20121015_tscode_list
for table_name in daily_20121015.columns.values.tolist():
    daily_20121015_addname_dataframe[table_name] = daily_20121015[table_name]
print("日线行情-时间为序  daily_20121015 返回数据 row 行数 = "+str(daily_20121015.shape[0]))
daily_20121015_addname_dataframe.to_excel(daily_201210_excel_writer,'15_1',index=False)
daily_201210_excel_writer.save()
daily_20121016 = pro.daily(start_date='',end_date='',trade_date='20121016', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20121016_tscode_list = list() 
for ts_code_sh in daily_20121016['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20121016_tscode_list.append(stock_name)
daily_20121016_addname_dataframe=pd.DataFrame()
daily_20121016_addname_dataframe['cname'] = daily_20121016_tscode_list
for table_name in daily_20121016.columns.values.tolist():
    daily_20121016_addname_dataframe[table_name] = daily_20121016[table_name]
print("日线行情-时间为序  daily_20121016 返回数据 row 行数 = "+str(daily_20121016.shape[0]))
daily_20121016_addname_dataframe.to_excel(daily_201210_excel_writer,'16_2',index=False)
daily_201210_excel_writer.save()
daily_20121017 = pro.daily(start_date='',end_date='',trade_date='20121017', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20121017_tscode_list = list() 
for ts_code_sh in daily_20121017['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20121017_tscode_list.append(stock_name)
daily_20121017_addname_dataframe=pd.DataFrame()
daily_20121017_addname_dataframe['cname'] = daily_20121017_tscode_list
for table_name in daily_20121017.columns.values.tolist():
    daily_20121017_addname_dataframe[table_name] = daily_20121017[table_name]
print("日线行情-时间为序  daily_20121017 返回数据 row 行数 = "+str(daily_20121017.shape[0]))
daily_20121017_addname_dataframe.to_excel(daily_201210_excel_writer,'17_3',index=False)
daily_201210_excel_writer.save()
daily_20121018 = pro.daily(start_date='',end_date='',trade_date='20121018', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20121018_tscode_list = list() 
for ts_code_sh in daily_20121018['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20121018_tscode_list.append(stock_name)
daily_20121018_addname_dataframe=pd.DataFrame()
daily_20121018_addname_dataframe['cname'] = daily_20121018_tscode_list
for table_name in daily_20121018.columns.values.tolist():
    daily_20121018_addname_dataframe[table_name] = daily_20121018[table_name]
print("日线行情-时间为序  daily_20121018 返回数据 row 行数 = "+str(daily_20121018.shape[0]))
daily_20121018_addname_dataframe.to_excel(daily_201210_excel_writer,'18_4',index=False)
daily_201210_excel_writer.save()
daily_20121019 = pro.daily(start_date='',end_date='',trade_date='20121019', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20121019_tscode_list = list() 
for ts_code_sh in daily_20121019['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20121019_tscode_list.append(stock_name)
daily_20121019_addname_dataframe=pd.DataFrame()
daily_20121019_addname_dataframe['cname'] = daily_20121019_tscode_list
for table_name in daily_20121019.columns.values.tolist():
    daily_20121019_addname_dataframe[table_name] = daily_20121019[table_name]
print("日线行情-时间为序  daily_20121019 返回数据 row 行数 = "+str(daily_20121019.shape[0]))
daily_20121019_addname_dataframe.to_excel(daily_201210_excel_writer,'19_5',index=False)
daily_201210_excel_writer.save()
daily_20121022 = pro.daily(start_date='',end_date='',trade_date='20121022', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20121022_tscode_list = list() 
for ts_code_sh in daily_20121022['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20121022_tscode_list.append(stock_name)
daily_20121022_addname_dataframe=pd.DataFrame()
daily_20121022_addname_dataframe['cname'] = daily_20121022_tscode_list
for table_name in daily_20121022.columns.values.tolist():
    daily_20121022_addname_dataframe[table_name] = daily_20121022[table_name]
print("日线行情-时间为序  daily_20121022 返回数据 row 行数 = "+str(daily_20121022.shape[0]))
daily_20121022_addname_dataframe.to_excel(daily_201210_excel_writer,'22_1',index=False)
daily_201210_excel_writer.save()
daily_20121023 = pro.daily(start_date='',end_date='',trade_date='20121023', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20121023_tscode_list = list() 
for ts_code_sh in daily_20121023['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20121023_tscode_list.append(stock_name)
daily_20121023_addname_dataframe=pd.DataFrame()
daily_20121023_addname_dataframe['cname'] = daily_20121023_tscode_list
for table_name in daily_20121023.columns.values.tolist():
    daily_20121023_addname_dataframe[table_name] = daily_20121023[table_name]
print("日线行情-时间为序  daily_20121023 返回数据 row 行数 = "+str(daily_20121023.shape[0]))
daily_20121023_addname_dataframe.to_excel(daily_201210_excel_writer,'23_2',index=False)
daily_201210_excel_writer.save()
daily_20121024 = pro.daily(start_date='',end_date='',trade_date='20121024', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20121024_tscode_list = list() 
for ts_code_sh in daily_20121024['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20121024_tscode_list.append(stock_name)
daily_20121024_addname_dataframe=pd.DataFrame()
daily_20121024_addname_dataframe['cname'] = daily_20121024_tscode_list
for table_name in daily_20121024.columns.values.tolist():
    daily_20121024_addname_dataframe[table_name] = daily_20121024[table_name]
print("日线行情-时间为序  daily_20121024 返回数据 row 行数 = "+str(daily_20121024.shape[0]))
daily_20121024_addname_dataframe.to_excel(daily_201210_excel_writer,'24_3',index=False)
daily_201210_excel_writer.save()
daily_20121025 = pro.daily(start_date='',end_date='',trade_date='20121025', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20121025_tscode_list = list() 
for ts_code_sh in daily_20121025['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20121025_tscode_list.append(stock_name)
daily_20121025_addname_dataframe=pd.DataFrame()
daily_20121025_addname_dataframe['cname'] = daily_20121025_tscode_list
for table_name in daily_20121025.columns.values.tolist():
    daily_20121025_addname_dataframe[table_name] = daily_20121025[table_name]
print("日线行情-时间为序  daily_20121025 返回数据 row 行数 = "+str(daily_20121025.shape[0]))
daily_20121025_addname_dataframe.to_excel(daily_201210_excel_writer,'25_4',index=False)
daily_201210_excel_writer.save()
daily_20121026 = pro.daily(start_date='',end_date='',trade_date='20121026', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20121026_tscode_list = list() 
for ts_code_sh in daily_20121026['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20121026_tscode_list.append(stock_name)
daily_20121026_addname_dataframe=pd.DataFrame()
daily_20121026_addname_dataframe['cname'] = daily_20121026_tscode_list
for table_name in daily_20121026.columns.values.tolist():
    daily_20121026_addname_dataframe[table_name] = daily_20121026[table_name]
print("日线行情-时间为序  daily_20121026 返回数据 row 行数 = "+str(daily_20121026.shape[0]))
daily_20121026_addname_dataframe.to_excel(daily_201210_excel_writer,'26_5',index=False)
daily_201210_excel_writer.save()
daily_20121029 = pro.daily(start_date='',end_date='',trade_date='20121029', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20121029_tscode_list = list() 
for ts_code_sh in daily_20121029['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20121029_tscode_list.append(stock_name)
daily_20121029_addname_dataframe=pd.DataFrame()
daily_20121029_addname_dataframe['cname'] = daily_20121029_tscode_list
for table_name in daily_20121029.columns.values.tolist():
    daily_20121029_addname_dataframe[table_name] = daily_20121029[table_name]
print("日线行情-时间为序  daily_20121029 返回数据 row 行数 = "+str(daily_20121029.shape[0]))
daily_20121029_addname_dataframe.to_excel(daily_201210_excel_writer,'29_1',index=False)
daily_201210_excel_writer.save()
daily_20121030 = pro.daily(start_date='',end_date='',trade_date='20121030', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20121030_tscode_list = list() 
for ts_code_sh in daily_20121030['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20121030_tscode_list.append(stock_name)
daily_20121030_addname_dataframe=pd.DataFrame()
daily_20121030_addname_dataframe['cname'] = daily_20121030_tscode_list
for table_name in daily_20121030.columns.values.tolist():
    daily_20121030_addname_dataframe[table_name] = daily_20121030[table_name]
print("日线行情-时间为序  daily_20121030 返回数据 row 行数 = "+str(daily_20121030.shape[0]))
daily_20121030_addname_dataframe.to_excel(daily_201210_excel_writer,'30_2',index=False)
daily_201210_excel_writer.save()
daily_20121031 = pro.daily(start_date='',end_date='',trade_date='20121031', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20121031_tscode_list = list() 
for ts_code_sh in daily_20121031['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20121031_tscode_list.append(stock_name)
daily_20121031_addname_dataframe=pd.DataFrame()
daily_20121031_addname_dataframe['cname'] = daily_20121031_tscode_list
for table_name in daily_20121031.columns.values.tolist():
    daily_20121031_addname_dataframe[table_name] = daily_20121031[table_name]
print("日线行情-时间为序  daily_20121031 返回数据 row 行数 = "+str(daily_20121031.shape[0]))
daily_20121031_addname_dataframe.to_excel(daily_201210_excel_writer,'31_3',index=False)
daily_201210_excel_writer.save()




createexcel('daily_201211.xlsx')
daily_201211_book = load_workbook('C:\\Users\\zhuzj5\\Desktop\\zbin\\J0_Data\\daily_201211.xlsx')
daily_201211_excel_writer = pd.ExcelWriter('C:\\Users\\zhuzj5\\Desktop\\zbin\\J0_Data\\daily_201211.xlsx', engine='openpyxl')
daily_201211_excel_writer.book = daily_201211_book
daily_201211_excel_writer.sheets = dict((ws.title, ws) for ws in daily_201211_book.worksheets)
J0_PROPS.put(tree_node_name+"record_date", "20121101")       ###  更新 记录日期
daily_20121101 = pro.daily(start_date='',end_date='',trade_date='20121101', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20121101_tscode_list = list() 
for ts_code_sh in daily_20121101['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20121101_tscode_list.append(stock_name)
daily_20121101_addname_dataframe=pd.DataFrame()
daily_20121101_addname_dataframe['cname'] = daily_20121101_tscode_list
for table_name in daily_20121101.columns.values.tolist():
    daily_20121101_addname_dataframe[table_name] = daily_20121101[table_name]
print("日线行情-时间为序  daily_20121101 返回数据 row 行数 = "+str(daily_20121101.shape[0]))
daily_20121101_addname_dataframe.to_excel(daily_201211_excel_writer,'1_4',index=False)
daily_201211_excel_writer.save()
daily_20121102 = pro.daily(start_date='',end_date='',trade_date='20121102', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20121102_tscode_list = list() 
for ts_code_sh in daily_20121102['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20121102_tscode_list.append(stock_name)
daily_20121102_addname_dataframe=pd.DataFrame()
daily_20121102_addname_dataframe['cname'] = daily_20121102_tscode_list
for table_name in daily_20121102.columns.values.tolist():
    daily_20121102_addname_dataframe[table_name] = daily_20121102[table_name]
print("日线行情-时间为序  daily_20121102 返回数据 row 行数 = "+str(daily_20121102.shape[0]))
daily_20121102_addname_dataframe.to_excel(daily_201211_excel_writer,'2_5',index=False)
daily_201211_excel_writer.save()
daily_20121105 = pro.daily(start_date='',end_date='',trade_date='20121105', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20121105_tscode_list = list() 
for ts_code_sh in daily_20121105['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20121105_tscode_list.append(stock_name)
daily_20121105_addname_dataframe=pd.DataFrame()
daily_20121105_addname_dataframe['cname'] = daily_20121105_tscode_list
for table_name in daily_20121105.columns.values.tolist():
    daily_20121105_addname_dataframe[table_name] = daily_20121105[table_name]
print("日线行情-时间为序  daily_20121105 返回数据 row 行数 = "+str(daily_20121105.shape[0]))
daily_20121105_addname_dataframe.to_excel(daily_201211_excel_writer,'5_1',index=False)
daily_201211_excel_writer.save()
daily_20121106 = pro.daily(start_date='',end_date='',trade_date='20121106', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20121106_tscode_list = list() 
for ts_code_sh in daily_20121106['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20121106_tscode_list.append(stock_name)
daily_20121106_addname_dataframe=pd.DataFrame()
daily_20121106_addname_dataframe['cname'] = daily_20121106_tscode_list
for table_name in daily_20121106.columns.values.tolist():
    daily_20121106_addname_dataframe[table_name] = daily_20121106[table_name]
print("日线行情-时间为序  daily_20121106 返回数据 row 行数 = "+str(daily_20121106.shape[0]))
daily_20121106_addname_dataframe.to_excel(daily_201211_excel_writer,'6_2',index=False)
daily_201211_excel_writer.save()
daily_20121107 = pro.daily(start_date='',end_date='',trade_date='20121107', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20121107_tscode_list = list() 
for ts_code_sh in daily_20121107['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20121107_tscode_list.append(stock_name)
daily_20121107_addname_dataframe=pd.DataFrame()
daily_20121107_addname_dataframe['cname'] = daily_20121107_tscode_list
for table_name in daily_20121107.columns.values.tolist():
    daily_20121107_addname_dataframe[table_name] = daily_20121107[table_name]
print("日线行情-时间为序  daily_20121107 返回数据 row 行数 = "+str(daily_20121107.shape[0]))
daily_20121107_addname_dataframe.to_excel(daily_201211_excel_writer,'7_3',index=False)
daily_201211_excel_writer.save()
daily_20121108 = pro.daily(start_date='',end_date='',trade_date='20121108', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20121108_tscode_list = list() 
for ts_code_sh in daily_20121108['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20121108_tscode_list.append(stock_name)
daily_20121108_addname_dataframe=pd.DataFrame()
daily_20121108_addname_dataframe['cname'] = daily_20121108_tscode_list
for table_name in daily_20121108.columns.values.tolist():
    daily_20121108_addname_dataframe[table_name] = daily_20121108[table_name]
print("日线行情-时间为序  daily_20121108 返回数据 row 行数 = "+str(daily_20121108.shape[0]))
daily_20121108_addname_dataframe.to_excel(daily_201211_excel_writer,'8_4',index=False)
daily_201211_excel_writer.save()
daily_20121109 = pro.daily(start_date='',end_date='',trade_date='20121109', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20121109_tscode_list = list() 
for ts_code_sh in daily_20121109['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20121109_tscode_list.append(stock_name)
daily_20121109_addname_dataframe=pd.DataFrame()
daily_20121109_addname_dataframe['cname'] = daily_20121109_tscode_list
for table_name in daily_20121109.columns.values.tolist():
    daily_20121109_addname_dataframe[table_name] = daily_20121109[table_name]
print("日线行情-时间为序  daily_20121109 返回数据 row 行数 = "+str(daily_20121109.shape[0]))
daily_20121109_addname_dataframe.to_excel(daily_201211_excel_writer,'9_5',index=False)
daily_201211_excel_writer.save()
daily_20121112 = pro.daily(start_date='',end_date='',trade_date='20121112', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20121112_tscode_list = list() 
for ts_code_sh in daily_20121112['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20121112_tscode_list.append(stock_name)
daily_20121112_addname_dataframe=pd.DataFrame()
daily_20121112_addname_dataframe['cname'] = daily_20121112_tscode_list
for table_name in daily_20121112.columns.values.tolist():
    daily_20121112_addname_dataframe[table_name] = daily_20121112[table_name]
print("日线行情-时间为序  daily_20121112 返回数据 row 行数 = "+str(daily_20121112.shape[0]))
daily_20121112_addname_dataframe.to_excel(daily_201211_excel_writer,'12_1',index=False)
daily_201211_excel_writer.save()
daily_20121113 = pro.daily(start_date='',end_date='',trade_date='20121113', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20121113_tscode_list = list() 
for ts_code_sh in daily_20121113['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20121113_tscode_list.append(stock_name)
daily_20121113_addname_dataframe=pd.DataFrame()
daily_20121113_addname_dataframe['cname'] = daily_20121113_tscode_list
for table_name in daily_20121113.columns.values.tolist():
    daily_20121113_addname_dataframe[table_name] = daily_20121113[table_name]
print("日线行情-时间为序  daily_20121113 返回数据 row 行数 = "+str(daily_20121113.shape[0]))
daily_20121113_addname_dataframe.to_excel(daily_201211_excel_writer,'13_2',index=False)
daily_201211_excel_writer.save()
daily_20121114 = pro.daily(start_date='',end_date='',trade_date='20121114', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20121114_tscode_list = list() 
for ts_code_sh in daily_20121114['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20121114_tscode_list.append(stock_name)
daily_20121114_addname_dataframe=pd.DataFrame()
daily_20121114_addname_dataframe['cname'] = daily_20121114_tscode_list
for table_name in daily_20121114.columns.values.tolist():
    daily_20121114_addname_dataframe[table_name] = daily_20121114[table_name]
print("日线行情-时间为序  daily_20121114 返回数据 row 行数 = "+str(daily_20121114.shape[0]))
daily_20121114_addname_dataframe.to_excel(daily_201211_excel_writer,'14_3',index=False)
daily_201211_excel_writer.save()
daily_20121115 = pro.daily(start_date='',end_date='',trade_date='20121115', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20121115_tscode_list = list() 
for ts_code_sh in daily_20121115['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20121115_tscode_list.append(stock_name)
daily_20121115_addname_dataframe=pd.DataFrame()
daily_20121115_addname_dataframe['cname'] = daily_20121115_tscode_list
for table_name in daily_20121115.columns.values.tolist():
    daily_20121115_addname_dataframe[table_name] = daily_20121115[table_name]
print("日线行情-时间为序  daily_20121115 返回数据 row 行数 = "+str(daily_20121115.shape[0]))
daily_20121115_addname_dataframe.to_excel(daily_201211_excel_writer,'15_4',index=False)
daily_201211_excel_writer.save()
daily_20121116 = pro.daily(start_date='',end_date='',trade_date='20121116', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20121116_tscode_list = list() 
for ts_code_sh in daily_20121116['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20121116_tscode_list.append(stock_name)
daily_20121116_addname_dataframe=pd.DataFrame()
daily_20121116_addname_dataframe['cname'] = daily_20121116_tscode_list
for table_name in daily_20121116.columns.values.tolist():
    daily_20121116_addname_dataframe[table_name] = daily_20121116[table_name]
print("日线行情-时间为序  daily_20121116 返回数据 row 行数 = "+str(daily_20121116.shape[0]))
daily_20121116_addname_dataframe.to_excel(daily_201211_excel_writer,'16_5',index=False)
daily_201211_excel_writer.save()
daily_20121119 = pro.daily(start_date='',end_date='',trade_date='20121119', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20121119_tscode_list = list() 
for ts_code_sh in daily_20121119['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20121119_tscode_list.append(stock_name)
daily_20121119_addname_dataframe=pd.DataFrame()
daily_20121119_addname_dataframe['cname'] = daily_20121119_tscode_list
for table_name in daily_20121119.columns.values.tolist():
    daily_20121119_addname_dataframe[table_name] = daily_20121119[table_name]
print("日线行情-时间为序  daily_20121119 返回数据 row 行数 = "+str(daily_20121119.shape[0]))
daily_20121119_addname_dataframe.to_excel(daily_201211_excel_writer,'19_1',index=False)
daily_201211_excel_writer.save()
daily_20121120 = pro.daily(start_date='',end_date='',trade_date='20121120', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20121120_tscode_list = list() 
for ts_code_sh in daily_20121120['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20121120_tscode_list.append(stock_name)
daily_20121120_addname_dataframe=pd.DataFrame()
daily_20121120_addname_dataframe['cname'] = daily_20121120_tscode_list
for table_name in daily_20121120.columns.values.tolist():
    daily_20121120_addname_dataframe[table_name] = daily_20121120[table_name]
print("日线行情-时间为序  daily_20121120 返回数据 row 行数 = "+str(daily_20121120.shape[0]))
daily_20121120_addname_dataframe.to_excel(daily_201211_excel_writer,'20_2',index=False)
daily_201211_excel_writer.save()
daily_20121121 = pro.daily(start_date='',end_date='',trade_date='20121121', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20121121_tscode_list = list() 
for ts_code_sh in daily_20121121['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20121121_tscode_list.append(stock_name)
daily_20121121_addname_dataframe=pd.DataFrame()
daily_20121121_addname_dataframe['cname'] = daily_20121121_tscode_list
for table_name in daily_20121121.columns.values.tolist():
    daily_20121121_addname_dataframe[table_name] = daily_20121121[table_name]
print("日线行情-时间为序  daily_20121121 返回数据 row 行数 = "+str(daily_20121121.shape[0]))
daily_20121121_addname_dataframe.to_excel(daily_201211_excel_writer,'21_3',index=False)
daily_201211_excel_writer.save()
daily_20121122 = pro.daily(start_date='',end_date='',trade_date='20121122', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20121122_tscode_list = list() 
for ts_code_sh in daily_20121122['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20121122_tscode_list.append(stock_name)
daily_20121122_addname_dataframe=pd.DataFrame()
daily_20121122_addname_dataframe['cname'] = daily_20121122_tscode_list
for table_name in daily_20121122.columns.values.tolist():
    daily_20121122_addname_dataframe[table_name] = daily_20121122[table_name]
print("日线行情-时间为序  daily_20121122 返回数据 row 行数 = "+str(daily_20121122.shape[0]))
daily_20121122_addname_dataframe.to_excel(daily_201211_excel_writer,'22_4',index=False)
daily_201211_excel_writer.save()
daily_20121123 = pro.daily(start_date='',end_date='',trade_date='20121123', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20121123_tscode_list = list() 
for ts_code_sh in daily_20121123['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20121123_tscode_list.append(stock_name)
daily_20121123_addname_dataframe=pd.DataFrame()
daily_20121123_addname_dataframe['cname'] = daily_20121123_tscode_list
for table_name in daily_20121123.columns.values.tolist():
    daily_20121123_addname_dataframe[table_name] = daily_20121123[table_name]
print("日线行情-时间为序  daily_20121123 返回数据 row 行数 = "+str(daily_20121123.shape[0]))
daily_20121123_addname_dataframe.to_excel(daily_201211_excel_writer,'23_5',index=False)
daily_201211_excel_writer.save()
daily_20121126 = pro.daily(start_date='',end_date='',trade_date='20121126', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20121126_tscode_list = list() 
for ts_code_sh in daily_20121126['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20121126_tscode_list.append(stock_name)
daily_20121126_addname_dataframe=pd.DataFrame()
daily_20121126_addname_dataframe['cname'] = daily_20121126_tscode_list
for table_name in daily_20121126.columns.values.tolist():
    daily_20121126_addname_dataframe[table_name] = daily_20121126[table_name]
print("日线行情-时间为序  daily_20121126 返回数据 row 行数 = "+str(daily_20121126.shape[0]))
daily_20121126_addname_dataframe.to_excel(daily_201211_excel_writer,'26_1',index=False)
daily_201211_excel_writer.save()
daily_20121127 = pro.daily(start_date='',end_date='',trade_date='20121127', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20121127_tscode_list = list() 
for ts_code_sh in daily_20121127['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20121127_tscode_list.append(stock_name)
daily_20121127_addname_dataframe=pd.DataFrame()
daily_20121127_addname_dataframe['cname'] = daily_20121127_tscode_list
for table_name in daily_20121127.columns.values.tolist():
    daily_20121127_addname_dataframe[table_name] = daily_20121127[table_name]
print("日线行情-时间为序  daily_20121127 返回数据 row 行数 = "+str(daily_20121127.shape[0]))
daily_20121127_addname_dataframe.to_excel(daily_201211_excel_writer,'27_2',index=False)
daily_201211_excel_writer.save()
daily_20121128 = pro.daily(start_date='',end_date='',trade_date='20121128', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20121128_tscode_list = list() 
for ts_code_sh in daily_20121128['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20121128_tscode_list.append(stock_name)
daily_20121128_addname_dataframe=pd.DataFrame()
daily_20121128_addname_dataframe['cname'] = daily_20121128_tscode_list
for table_name in daily_20121128.columns.values.tolist():
    daily_20121128_addname_dataframe[table_name] = daily_20121128[table_name]
print("日线行情-时间为序  daily_20121128 返回数据 row 行数 = "+str(daily_20121128.shape[0]))
daily_20121128_addname_dataframe.to_excel(daily_201211_excel_writer,'28_3',index=False)
daily_201211_excel_writer.save()
daily_20121129 = pro.daily(start_date='',end_date='',trade_date='20121129', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20121129_tscode_list = list() 
for ts_code_sh in daily_20121129['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20121129_tscode_list.append(stock_name)
daily_20121129_addname_dataframe=pd.DataFrame()
daily_20121129_addname_dataframe['cname'] = daily_20121129_tscode_list
for table_name in daily_20121129.columns.values.tolist():
    daily_20121129_addname_dataframe[table_name] = daily_20121129[table_name]
print("日线行情-时间为序  daily_20121129 返回数据 row 行数 = "+str(daily_20121129.shape[0]))
daily_20121129_addname_dataframe.to_excel(daily_201211_excel_writer,'29_4',index=False)
daily_201211_excel_writer.save()
daily_20121130 = pro.daily(start_date='',end_date='',trade_date='20121130', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20121130_tscode_list = list() 
for ts_code_sh in daily_20121130['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20121130_tscode_list.append(stock_name)
daily_20121130_addname_dataframe=pd.DataFrame()
daily_20121130_addname_dataframe['cname'] = daily_20121130_tscode_list
for table_name in daily_20121130.columns.values.tolist():
    daily_20121130_addname_dataframe[table_name] = daily_20121130[table_name]
print("日线行情-时间为序  daily_20121130 返回数据 row 行数 = "+str(daily_20121130.shape[0]))
daily_20121130_addname_dataframe.to_excel(daily_201211_excel_writer,'30_5',index=False)
daily_201211_excel_writer.save()




createexcel('daily_201212.xlsx')
daily_201212_book = load_workbook('C:\\Users\\zhuzj5\\Desktop\\zbin\\J0_Data\\daily_201212.xlsx')
daily_201212_excel_writer = pd.ExcelWriter('C:\\Users\\zhuzj5\\Desktop\\zbin\\J0_Data\\daily_201212.xlsx', engine='openpyxl')
daily_201212_excel_writer.book = daily_201212_book
daily_201212_excel_writer.sheets = dict((ws.title, ws) for ws in daily_201212_book.worksheets)
J0_PROPS.put(tree_node_name+"record_date", "20121201")       ###  更新 记录日期
daily_20121203 = pro.daily(start_date='',end_date='',trade_date='20121203', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20121203_tscode_list = list() 
for ts_code_sh in daily_20121203['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20121203_tscode_list.append(stock_name)
daily_20121203_addname_dataframe=pd.DataFrame()
daily_20121203_addname_dataframe['cname'] = daily_20121203_tscode_list
for table_name in daily_20121203.columns.values.tolist():
    daily_20121203_addname_dataframe[table_name] = daily_20121203[table_name]
print("日线行情-时间为序  daily_20121203 返回数据 row 行数 = "+str(daily_20121203.shape[0]))
daily_20121203_addname_dataframe.to_excel(daily_201212_excel_writer,'3_1',index=False)
daily_201212_excel_writer.save()
daily_20121204 = pro.daily(start_date='',end_date='',trade_date='20121204', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20121204_tscode_list = list() 
for ts_code_sh in daily_20121204['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20121204_tscode_list.append(stock_name)
daily_20121204_addname_dataframe=pd.DataFrame()
daily_20121204_addname_dataframe['cname'] = daily_20121204_tscode_list
for table_name in daily_20121204.columns.values.tolist():
    daily_20121204_addname_dataframe[table_name] = daily_20121204[table_name]
print("日线行情-时间为序  daily_20121204 返回数据 row 行数 = "+str(daily_20121204.shape[0]))
daily_20121204_addname_dataframe.to_excel(daily_201212_excel_writer,'4_2',index=False)
daily_201212_excel_writer.save()
daily_20121205 = pro.daily(start_date='',end_date='',trade_date='20121205', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20121205_tscode_list = list() 
for ts_code_sh in daily_20121205['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20121205_tscode_list.append(stock_name)
daily_20121205_addname_dataframe=pd.DataFrame()
daily_20121205_addname_dataframe['cname'] = daily_20121205_tscode_list
for table_name in daily_20121205.columns.values.tolist():
    daily_20121205_addname_dataframe[table_name] = daily_20121205[table_name]
print("日线行情-时间为序  daily_20121205 返回数据 row 行数 = "+str(daily_20121205.shape[0]))
daily_20121205_addname_dataframe.to_excel(daily_201212_excel_writer,'5_3',index=False)
daily_201212_excel_writer.save()
daily_20121206 = pro.daily(start_date='',end_date='',trade_date='20121206', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20121206_tscode_list = list() 
for ts_code_sh in daily_20121206['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20121206_tscode_list.append(stock_name)
daily_20121206_addname_dataframe=pd.DataFrame()
daily_20121206_addname_dataframe['cname'] = daily_20121206_tscode_list
for table_name in daily_20121206.columns.values.tolist():
    daily_20121206_addname_dataframe[table_name] = daily_20121206[table_name]
print("日线行情-时间为序  daily_20121206 返回数据 row 行数 = "+str(daily_20121206.shape[0]))
daily_20121206_addname_dataframe.to_excel(daily_201212_excel_writer,'6_4',index=False)
daily_201212_excel_writer.save()
daily_20121207 = pro.daily(start_date='',end_date='',trade_date='20121207', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20121207_tscode_list = list() 
for ts_code_sh in daily_20121207['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20121207_tscode_list.append(stock_name)
daily_20121207_addname_dataframe=pd.DataFrame()
daily_20121207_addname_dataframe['cname'] = daily_20121207_tscode_list
for table_name in daily_20121207.columns.values.tolist():
    daily_20121207_addname_dataframe[table_name] = daily_20121207[table_name]
print("日线行情-时间为序  daily_20121207 返回数据 row 行数 = "+str(daily_20121207.shape[0]))
daily_20121207_addname_dataframe.to_excel(daily_201212_excel_writer,'7_5',index=False)
daily_201212_excel_writer.save()
daily_20121210 = pro.daily(start_date='',end_date='',trade_date='20121210', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20121210_tscode_list = list() 
for ts_code_sh in daily_20121210['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20121210_tscode_list.append(stock_name)
daily_20121210_addname_dataframe=pd.DataFrame()
daily_20121210_addname_dataframe['cname'] = daily_20121210_tscode_list
for table_name in daily_20121210.columns.values.tolist():
    daily_20121210_addname_dataframe[table_name] = daily_20121210[table_name]
print("日线行情-时间为序  daily_20121210 返回数据 row 行数 = "+str(daily_20121210.shape[0]))
daily_20121210_addname_dataframe.to_excel(daily_201212_excel_writer,'10_1',index=False)
daily_201212_excel_writer.save()
daily_20121211 = pro.daily(start_date='',end_date='',trade_date='20121211', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20121211_tscode_list = list() 
for ts_code_sh in daily_20121211['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20121211_tscode_list.append(stock_name)
daily_20121211_addname_dataframe=pd.DataFrame()
daily_20121211_addname_dataframe['cname'] = daily_20121211_tscode_list
for table_name in daily_20121211.columns.values.tolist():
    daily_20121211_addname_dataframe[table_name] = daily_20121211[table_name]
print("日线行情-时间为序  daily_20121211 返回数据 row 行数 = "+str(daily_20121211.shape[0]))
daily_20121211_addname_dataframe.to_excel(daily_201212_excel_writer,'11_2',index=False)
daily_201212_excel_writer.save()
daily_20121212 = pro.daily(start_date='',end_date='',trade_date='20121212', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20121212_tscode_list = list() 
for ts_code_sh in daily_20121212['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20121212_tscode_list.append(stock_name)
daily_20121212_addname_dataframe=pd.DataFrame()
daily_20121212_addname_dataframe['cname'] = daily_20121212_tscode_list
for table_name in daily_20121212.columns.values.tolist():
    daily_20121212_addname_dataframe[table_name] = daily_20121212[table_name]
print("日线行情-时间为序  daily_20121212 返回数据 row 行数 = "+str(daily_20121212.shape[0]))
daily_20121212_addname_dataframe.to_excel(daily_201212_excel_writer,'12_3',index=False)
daily_201212_excel_writer.save()
daily_20121213 = pro.daily(start_date='',end_date='',trade_date='20121213', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20121213_tscode_list = list() 
for ts_code_sh in daily_20121213['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20121213_tscode_list.append(stock_name)
daily_20121213_addname_dataframe=pd.DataFrame()
daily_20121213_addname_dataframe['cname'] = daily_20121213_tscode_list
for table_name in daily_20121213.columns.values.tolist():
    daily_20121213_addname_dataframe[table_name] = daily_20121213[table_name]
print("日线行情-时间为序  daily_20121213 返回数据 row 行数 = "+str(daily_20121213.shape[0]))
daily_20121213_addname_dataframe.to_excel(daily_201212_excel_writer,'13_4',index=False)
daily_201212_excel_writer.save()
daily_20121214 = pro.daily(start_date='',end_date='',trade_date='20121214', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20121214_tscode_list = list() 
for ts_code_sh in daily_20121214['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20121214_tscode_list.append(stock_name)
daily_20121214_addname_dataframe=pd.DataFrame()
daily_20121214_addname_dataframe['cname'] = daily_20121214_tscode_list
for table_name in daily_20121214.columns.values.tolist():
    daily_20121214_addname_dataframe[table_name] = daily_20121214[table_name]
print("日线行情-时间为序  daily_20121214 返回数据 row 行数 = "+str(daily_20121214.shape[0]))
daily_20121214_addname_dataframe.to_excel(daily_201212_excel_writer,'14_5',index=False)
daily_201212_excel_writer.save()
daily_20121217 = pro.daily(start_date='',end_date='',trade_date='20121217', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20121217_tscode_list = list() 
for ts_code_sh in daily_20121217['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20121217_tscode_list.append(stock_name)
daily_20121217_addname_dataframe=pd.DataFrame()
daily_20121217_addname_dataframe['cname'] = daily_20121217_tscode_list
for table_name in daily_20121217.columns.values.tolist():
    daily_20121217_addname_dataframe[table_name] = daily_20121217[table_name]
print("日线行情-时间为序  daily_20121217 返回数据 row 行数 = "+str(daily_20121217.shape[0]))
daily_20121217_addname_dataframe.to_excel(daily_201212_excel_writer,'17_1',index=False)
daily_201212_excel_writer.save()
daily_20121218 = pro.daily(start_date='',end_date='',trade_date='20121218', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20121218_tscode_list = list() 
for ts_code_sh in daily_20121218['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20121218_tscode_list.append(stock_name)
daily_20121218_addname_dataframe=pd.DataFrame()
daily_20121218_addname_dataframe['cname'] = daily_20121218_tscode_list
for table_name in daily_20121218.columns.values.tolist():
    daily_20121218_addname_dataframe[table_name] = daily_20121218[table_name]
print("日线行情-时间为序  daily_20121218 返回数据 row 行数 = "+str(daily_20121218.shape[0]))
daily_20121218_addname_dataframe.to_excel(daily_201212_excel_writer,'18_2',index=False)
daily_201212_excel_writer.save()
daily_20121219 = pro.daily(start_date='',end_date='',trade_date='20121219', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20121219_tscode_list = list() 
for ts_code_sh in daily_20121219['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20121219_tscode_list.append(stock_name)
daily_20121219_addname_dataframe=pd.DataFrame()
daily_20121219_addname_dataframe['cname'] = daily_20121219_tscode_list
for table_name in daily_20121219.columns.values.tolist():
    daily_20121219_addname_dataframe[table_name] = daily_20121219[table_name]
print("日线行情-时间为序  daily_20121219 返回数据 row 行数 = "+str(daily_20121219.shape[0]))
daily_20121219_addname_dataframe.to_excel(daily_201212_excel_writer,'19_3',index=False)
daily_201212_excel_writer.save()
daily_20121220 = pro.daily(start_date='',end_date='',trade_date='20121220', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20121220_tscode_list = list() 
for ts_code_sh in daily_20121220['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20121220_tscode_list.append(stock_name)
daily_20121220_addname_dataframe=pd.DataFrame()
daily_20121220_addname_dataframe['cname'] = daily_20121220_tscode_list
for table_name in daily_20121220.columns.values.tolist():
    daily_20121220_addname_dataframe[table_name] = daily_20121220[table_name]
print("日线行情-时间为序  daily_20121220 返回数据 row 行数 = "+str(daily_20121220.shape[0]))
daily_20121220_addname_dataframe.to_excel(daily_201212_excel_writer,'20_4',index=False)
daily_201212_excel_writer.save()
daily_20121221 = pro.daily(start_date='',end_date='',trade_date='20121221', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20121221_tscode_list = list() 
for ts_code_sh in daily_20121221['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20121221_tscode_list.append(stock_name)
daily_20121221_addname_dataframe=pd.DataFrame()
daily_20121221_addname_dataframe['cname'] = daily_20121221_tscode_list
for table_name in daily_20121221.columns.values.tolist():
    daily_20121221_addname_dataframe[table_name] = daily_20121221[table_name]
print("日线行情-时间为序  daily_20121221 返回数据 row 行数 = "+str(daily_20121221.shape[0]))
daily_20121221_addname_dataframe.to_excel(daily_201212_excel_writer,'21_5',index=False)
daily_201212_excel_writer.save()
daily_20121224 = pro.daily(start_date='',end_date='',trade_date='20121224', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20121224_tscode_list = list() 
for ts_code_sh in daily_20121224['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20121224_tscode_list.append(stock_name)
daily_20121224_addname_dataframe=pd.DataFrame()
daily_20121224_addname_dataframe['cname'] = daily_20121224_tscode_list
for table_name in daily_20121224.columns.values.tolist():
    daily_20121224_addname_dataframe[table_name] = daily_20121224[table_name]
print("日线行情-时间为序  daily_20121224 返回数据 row 行数 = "+str(daily_20121224.shape[0]))
daily_20121224_addname_dataframe.to_excel(daily_201212_excel_writer,'24_1',index=False)
daily_201212_excel_writer.save()
daily_20121225 = pro.daily(start_date='',end_date='',trade_date='20121225', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20121225_tscode_list = list() 
for ts_code_sh in daily_20121225['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20121225_tscode_list.append(stock_name)
daily_20121225_addname_dataframe=pd.DataFrame()
daily_20121225_addname_dataframe['cname'] = daily_20121225_tscode_list
for table_name in daily_20121225.columns.values.tolist():
    daily_20121225_addname_dataframe[table_name] = daily_20121225[table_name]
print("日线行情-时间为序  daily_20121225 返回数据 row 行数 = "+str(daily_20121225.shape[0]))
daily_20121225_addname_dataframe.to_excel(daily_201212_excel_writer,'25_2',index=False)
daily_201212_excel_writer.save()
daily_20121226 = pro.daily(start_date='',end_date='',trade_date='20121226', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20121226_tscode_list = list() 
for ts_code_sh in daily_20121226['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20121226_tscode_list.append(stock_name)
daily_20121226_addname_dataframe=pd.DataFrame()
daily_20121226_addname_dataframe['cname'] = daily_20121226_tscode_list
for table_name in daily_20121226.columns.values.tolist():
    daily_20121226_addname_dataframe[table_name] = daily_20121226[table_name]
print("日线行情-时间为序  daily_20121226 返回数据 row 行数 = "+str(daily_20121226.shape[0]))
daily_20121226_addname_dataframe.to_excel(daily_201212_excel_writer,'26_3',index=False)
daily_201212_excel_writer.save()
daily_20121227 = pro.daily(start_date='',end_date='',trade_date='20121227', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20121227_tscode_list = list() 
for ts_code_sh in daily_20121227['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20121227_tscode_list.append(stock_name)
daily_20121227_addname_dataframe=pd.DataFrame()
daily_20121227_addname_dataframe['cname'] = daily_20121227_tscode_list
for table_name in daily_20121227.columns.values.tolist():
    daily_20121227_addname_dataframe[table_name] = daily_20121227[table_name]
print("日线行情-时间为序  daily_20121227 返回数据 row 行数 = "+str(daily_20121227.shape[0]))
daily_20121227_addname_dataframe.to_excel(daily_201212_excel_writer,'27_4',index=False)
daily_201212_excel_writer.save()
daily_20121228 = pro.daily(start_date='',end_date='',trade_date='20121228', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20121228_tscode_list = list() 
for ts_code_sh in daily_20121228['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20121228_tscode_list.append(stock_name)
daily_20121228_addname_dataframe=pd.DataFrame()
daily_20121228_addname_dataframe['cname'] = daily_20121228_tscode_list
for table_name in daily_20121228.columns.values.tolist():
    daily_20121228_addname_dataframe[table_name] = daily_20121228[table_name]
print("日线行情-时间为序  daily_20121228 返回数据 row 行数 = "+str(daily_20121228.shape[0]))
daily_20121228_addname_dataframe.to_excel(daily_201212_excel_writer,'28_5',index=False)
daily_201212_excel_writer.save()
daily_20121231 = pro.daily(start_date='',end_date='',trade_date='20121231', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20121231_tscode_list = list() 
for ts_code_sh in daily_20121231['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20121231_tscode_list.append(stock_name)
daily_20121231_addname_dataframe=pd.DataFrame()
daily_20121231_addname_dataframe['cname'] = daily_20121231_tscode_list
for table_name in daily_20121231.columns.values.tolist():
    daily_20121231_addname_dataframe[table_name] = daily_20121231[table_name]
print("日线行情-时间为序  daily_20121231 返回数据 row 行数 = "+str(daily_20121231.shape[0]))
daily_20121231_addname_dataframe.to_excel(daily_201212_excel_writer,'31_1',index=False)
daily_201212_excel_writer.save()




createexcel('daily_201301.xlsx')
daily_201301_book = load_workbook('C:\\Users\\zhuzj5\\Desktop\\zbin\\J0_Data\\daily_201301.xlsx')
daily_201301_excel_writer = pd.ExcelWriter('C:\\Users\\zhuzj5\\Desktop\\zbin\\J0_Data\\daily_201301.xlsx', engine='openpyxl')
daily_201301_excel_writer.book = daily_201301_book
daily_201301_excel_writer.sheets = dict((ws.title, ws) for ws in daily_201301_book.worksheets)
J0_PROPS.put(tree_node_name+"record_date", "20130101")       ###  更新 记录日期
daily_20130104 = pro.daily(start_date='',end_date='',trade_date='20130104', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20130104_tscode_list = list() 
for ts_code_sh in daily_20130104['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20130104_tscode_list.append(stock_name)
daily_20130104_addname_dataframe=pd.DataFrame()
daily_20130104_addname_dataframe['cname'] = daily_20130104_tscode_list
for table_name in daily_20130104.columns.values.tolist():
    daily_20130104_addname_dataframe[table_name] = daily_20130104[table_name]
print("日线行情-时间为序  daily_20130104 返回数据 row 行数 = "+str(daily_20130104.shape[0]))
daily_20130104_addname_dataframe.to_excel(daily_201301_excel_writer,'4_5',index=False)
daily_201301_excel_writer.save()
daily_20130107 = pro.daily(start_date='',end_date='',trade_date='20130107', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20130107_tscode_list = list() 
for ts_code_sh in daily_20130107['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20130107_tscode_list.append(stock_name)
daily_20130107_addname_dataframe=pd.DataFrame()
daily_20130107_addname_dataframe['cname'] = daily_20130107_tscode_list
for table_name in daily_20130107.columns.values.tolist():
    daily_20130107_addname_dataframe[table_name] = daily_20130107[table_name]
print("日线行情-时间为序  daily_20130107 返回数据 row 行数 = "+str(daily_20130107.shape[0]))
daily_20130107_addname_dataframe.to_excel(daily_201301_excel_writer,'7_1',index=False)
daily_201301_excel_writer.save()
daily_20130108 = pro.daily(start_date='',end_date='',trade_date='20130108', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20130108_tscode_list = list() 
for ts_code_sh in daily_20130108['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20130108_tscode_list.append(stock_name)
daily_20130108_addname_dataframe=pd.DataFrame()
daily_20130108_addname_dataframe['cname'] = daily_20130108_tscode_list
for table_name in daily_20130108.columns.values.tolist():
    daily_20130108_addname_dataframe[table_name] = daily_20130108[table_name]
print("日线行情-时间为序  daily_20130108 返回数据 row 行数 = "+str(daily_20130108.shape[0]))
daily_20130108_addname_dataframe.to_excel(daily_201301_excel_writer,'8_2',index=False)
daily_201301_excel_writer.save()
daily_20130109 = pro.daily(start_date='',end_date='',trade_date='20130109', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20130109_tscode_list = list() 
for ts_code_sh in daily_20130109['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20130109_tscode_list.append(stock_name)
daily_20130109_addname_dataframe=pd.DataFrame()
daily_20130109_addname_dataframe['cname'] = daily_20130109_tscode_list
for table_name in daily_20130109.columns.values.tolist():
    daily_20130109_addname_dataframe[table_name] = daily_20130109[table_name]
print("日线行情-时间为序  daily_20130109 返回数据 row 行数 = "+str(daily_20130109.shape[0]))
daily_20130109_addname_dataframe.to_excel(daily_201301_excel_writer,'9_3',index=False)
daily_201301_excel_writer.save()
daily_20130110 = pro.daily(start_date='',end_date='',trade_date='20130110', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20130110_tscode_list = list() 
for ts_code_sh in daily_20130110['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20130110_tscode_list.append(stock_name)
daily_20130110_addname_dataframe=pd.DataFrame()
daily_20130110_addname_dataframe['cname'] = daily_20130110_tscode_list
for table_name in daily_20130110.columns.values.tolist():
    daily_20130110_addname_dataframe[table_name] = daily_20130110[table_name]
print("日线行情-时间为序  daily_20130110 返回数据 row 行数 = "+str(daily_20130110.shape[0]))
daily_20130110_addname_dataframe.to_excel(daily_201301_excel_writer,'10_4',index=False)
daily_201301_excel_writer.save()
daily_20130111 = pro.daily(start_date='',end_date='',trade_date='20130111', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20130111_tscode_list = list() 
for ts_code_sh in daily_20130111['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20130111_tscode_list.append(stock_name)
daily_20130111_addname_dataframe=pd.DataFrame()
daily_20130111_addname_dataframe['cname'] = daily_20130111_tscode_list
for table_name in daily_20130111.columns.values.tolist():
    daily_20130111_addname_dataframe[table_name] = daily_20130111[table_name]
print("日线行情-时间为序  daily_20130111 返回数据 row 行数 = "+str(daily_20130111.shape[0]))
daily_20130111_addname_dataframe.to_excel(daily_201301_excel_writer,'11_5',index=False)
daily_201301_excel_writer.save()
daily_20130114 = pro.daily(start_date='',end_date='',trade_date='20130114', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20130114_tscode_list = list() 
for ts_code_sh in daily_20130114['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20130114_tscode_list.append(stock_name)
daily_20130114_addname_dataframe=pd.DataFrame()
daily_20130114_addname_dataframe['cname'] = daily_20130114_tscode_list
for table_name in daily_20130114.columns.values.tolist():
    daily_20130114_addname_dataframe[table_name] = daily_20130114[table_name]
print("日线行情-时间为序  daily_20130114 返回数据 row 行数 = "+str(daily_20130114.shape[0]))
daily_20130114_addname_dataframe.to_excel(daily_201301_excel_writer,'14_1',index=False)
daily_201301_excel_writer.save()
daily_20130115 = pro.daily(start_date='',end_date='',trade_date='20130115', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20130115_tscode_list = list() 
for ts_code_sh in daily_20130115['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20130115_tscode_list.append(stock_name)
daily_20130115_addname_dataframe=pd.DataFrame()
daily_20130115_addname_dataframe['cname'] = daily_20130115_tscode_list
for table_name in daily_20130115.columns.values.tolist():
    daily_20130115_addname_dataframe[table_name] = daily_20130115[table_name]
print("日线行情-时间为序  daily_20130115 返回数据 row 行数 = "+str(daily_20130115.shape[0]))
daily_20130115_addname_dataframe.to_excel(daily_201301_excel_writer,'15_2',index=False)
daily_201301_excel_writer.save()
daily_20130116 = pro.daily(start_date='',end_date='',trade_date='20130116', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20130116_tscode_list = list() 
for ts_code_sh in daily_20130116['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20130116_tscode_list.append(stock_name)
daily_20130116_addname_dataframe=pd.DataFrame()
daily_20130116_addname_dataframe['cname'] = daily_20130116_tscode_list
for table_name in daily_20130116.columns.values.tolist():
    daily_20130116_addname_dataframe[table_name] = daily_20130116[table_name]
print("日线行情-时间为序  daily_20130116 返回数据 row 行数 = "+str(daily_20130116.shape[0]))
daily_20130116_addname_dataframe.to_excel(daily_201301_excel_writer,'16_3',index=False)
daily_201301_excel_writer.save()
daily_20130117 = pro.daily(start_date='',end_date='',trade_date='20130117', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20130117_tscode_list = list() 
for ts_code_sh in daily_20130117['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20130117_tscode_list.append(stock_name)
daily_20130117_addname_dataframe=pd.DataFrame()
daily_20130117_addname_dataframe['cname'] = daily_20130117_tscode_list
for table_name in daily_20130117.columns.values.tolist():
    daily_20130117_addname_dataframe[table_name] = daily_20130117[table_name]
print("日线行情-时间为序  daily_20130117 返回数据 row 行数 = "+str(daily_20130117.shape[0]))
daily_20130117_addname_dataframe.to_excel(daily_201301_excel_writer,'17_4',index=False)
daily_201301_excel_writer.save()
daily_20130118 = pro.daily(start_date='',end_date='',trade_date='20130118', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20130118_tscode_list = list() 
for ts_code_sh in daily_20130118['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20130118_tscode_list.append(stock_name)
daily_20130118_addname_dataframe=pd.DataFrame()
daily_20130118_addname_dataframe['cname'] = daily_20130118_tscode_list
for table_name in daily_20130118.columns.values.tolist():
    daily_20130118_addname_dataframe[table_name] = daily_20130118[table_name]
print("日线行情-时间为序  daily_20130118 返回数据 row 行数 = "+str(daily_20130118.shape[0]))
daily_20130118_addname_dataframe.to_excel(daily_201301_excel_writer,'18_5',index=False)
daily_201301_excel_writer.save()
daily_20130121 = pro.daily(start_date='',end_date='',trade_date='20130121', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20130121_tscode_list = list() 
for ts_code_sh in daily_20130121['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20130121_tscode_list.append(stock_name)
daily_20130121_addname_dataframe=pd.DataFrame()
daily_20130121_addname_dataframe['cname'] = daily_20130121_tscode_list
for table_name in daily_20130121.columns.values.tolist():
    daily_20130121_addname_dataframe[table_name] = daily_20130121[table_name]
print("日线行情-时间为序  daily_20130121 返回数据 row 行数 = "+str(daily_20130121.shape[0]))
daily_20130121_addname_dataframe.to_excel(daily_201301_excel_writer,'21_1',index=False)
daily_201301_excel_writer.save()
daily_20130122 = pro.daily(start_date='',end_date='',trade_date='20130122', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20130122_tscode_list = list() 
for ts_code_sh in daily_20130122['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20130122_tscode_list.append(stock_name)
daily_20130122_addname_dataframe=pd.DataFrame()
daily_20130122_addname_dataframe['cname'] = daily_20130122_tscode_list
for table_name in daily_20130122.columns.values.tolist():
    daily_20130122_addname_dataframe[table_name] = daily_20130122[table_name]
print("日线行情-时间为序  daily_20130122 返回数据 row 行数 = "+str(daily_20130122.shape[0]))
daily_20130122_addname_dataframe.to_excel(daily_201301_excel_writer,'22_2',index=False)
daily_201301_excel_writer.save()
daily_20130123 = pro.daily(start_date='',end_date='',trade_date='20130123', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20130123_tscode_list = list() 
for ts_code_sh in daily_20130123['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20130123_tscode_list.append(stock_name)
daily_20130123_addname_dataframe=pd.DataFrame()
daily_20130123_addname_dataframe['cname'] = daily_20130123_tscode_list
for table_name in daily_20130123.columns.values.tolist():
    daily_20130123_addname_dataframe[table_name] = daily_20130123[table_name]
print("日线行情-时间为序  daily_20130123 返回数据 row 行数 = "+str(daily_20130123.shape[0]))
daily_20130123_addname_dataframe.to_excel(daily_201301_excel_writer,'23_3',index=False)
daily_201301_excel_writer.save()
daily_20130124 = pro.daily(start_date='',end_date='',trade_date='20130124', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20130124_tscode_list = list() 
for ts_code_sh in daily_20130124['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20130124_tscode_list.append(stock_name)
daily_20130124_addname_dataframe=pd.DataFrame()
daily_20130124_addname_dataframe['cname'] = daily_20130124_tscode_list
for table_name in daily_20130124.columns.values.tolist():
    daily_20130124_addname_dataframe[table_name] = daily_20130124[table_name]
print("日线行情-时间为序  daily_20130124 返回数据 row 行数 = "+str(daily_20130124.shape[0]))
daily_20130124_addname_dataframe.to_excel(daily_201301_excel_writer,'24_4',index=False)
daily_201301_excel_writer.save()
daily_20130125 = pro.daily(start_date='',end_date='',trade_date='20130125', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20130125_tscode_list = list() 
for ts_code_sh in daily_20130125['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20130125_tscode_list.append(stock_name)
daily_20130125_addname_dataframe=pd.DataFrame()
daily_20130125_addname_dataframe['cname'] = daily_20130125_tscode_list
for table_name in daily_20130125.columns.values.tolist():
    daily_20130125_addname_dataframe[table_name] = daily_20130125[table_name]
print("日线行情-时间为序  daily_20130125 返回数据 row 行数 = "+str(daily_20130125.shape[0]))
daily_20130125_addname_dataframe.to_excel(daily_201301_excel_writer,'25_5',index=False)
daily_201301_excel_writer.save()
daily_20130128 = pro.daily(start_date='',end_date='',trade_date='20130128', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20130128_tscode_list = list() 
for ts_code_sh in daily_20130128['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20130128_tscode_list.append(stock_name)
daily_20130128_addname_dataframe=pd.DataFrame()
daily_20130128_addname_dataframe['cname'] = daily_20130128_tscode_list
for table_name in daily_20130128.columns.values.tolist():
    daily_20130128_addname_dataframe[table_name] = daily_20130128[table_name]
print("日线行情-时间为序  daily_20130128 返回数据 row 行数 = "+str(daily_20130128.shape[0]))
daily_20130128_addname_dataframe.to_excel(daily_201301_excel_writer,'28_1',index=False)
daily_201301_excel_writer.save()
daily_20130129 = pro.daily(start_date='',end_date='',trade_date='20130129', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20130129_tscode_list = list() 
for ts_code_sh in daily_20130129['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20130129_tscode_list.append(stock_name)
daily_20130129_addname_dataframe=pd.DataFrame()
daily_20130129_addname_dataframe['cname'] = daily_20130129_tscode_list
for table_name in daily_20130129.columns.values.tolist():
    daily_20130129_addname_dataframe[table_name] = daily_20130129[table_name]
print("日线行情-时间为序  daily_20130129 返回数据 row 行数 = "+str(daily_20130129.shape[0]))
daily_20130129_addname_dataframe.to_excel(daily_201301_excel_writer,'29_2',index=False)
daily_201301_excel_writer.save()
daily_20130130 = pro.daily(start_date='',end_date='',trade_date='20130130', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20130130_tscode_list = list() 
for ts_code_sh in daily_20130130['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20130130_tscode_list.append(stock_name)
daily_20130130_addname_dataframe=pd.DataFrame()
daily_20130130_addname_dataframe['cname'] = daily_20130130_tscode_list
for table_name in daily_20130130.columns.values.tolist():
    daily_20130130_addname_dataframe[table_name] = daily_20130130[table_name]
print("日线行情-时间为序  daily_20130130 返回数据 row 行数 = "+str(daily_20130130.shape[0]))
daily_20130130_addname_dataframe.to_excel(daily_201301_excel_writer,'30_3',index=False)
daily_201301_excel_writer.save()
daily_20130131 = pro.daily(start_date='',end_date='',trade_date='20130131', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20130131_tscode_list = list() 
for ts_code_sh in daily_20130131['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20130131_tscode_list.append(stock_name)
daily_20130131_addname_dataframe=pd.DataFrame()
daily_20130131_addname_dataframe['cname'] = daily_20130131_tscode_list
for table_name in daily_20130131.columns.values.tolist():
    daily_20130131_addname_dataframe[table_name] = daily_20130131[table_name]
print("日线行情-时间为序  daily_20130131 返回数据 row 行数 = "+str(daily_20130131.shape[0]))
daily_20130131_addname_dataframe.to_excel(daily_201301_excel_writer,'31_4',index=False)
daily_201301_excel_writer.save()




createexcel('daily_201302.xlsx')
daily_201302_book = load_workbook('C:\\Users\\zhuzj5\\Desktop\\zbin\\J0_Data\\daily_201302.xlsx')
daily_201302_excel_writer = pd.ExcelWriter('C:\\Users\\zhuzj5\\Desktop\\zbin\\J0_Data\\daily_201302.xlsx', engine='openpyxl')
daily_201302_excel_writer.book = daily_201302_book
daily_201302_excel_writer.sheets = dict((ws.title, ws) for ws in daily_201302_book.worksheets)
J0_PROPS.put(tree_node_name+"record_date", "20130201")       ###  更新 记录日期
daily_20130201 = pro.daily(start_date='',end_date='',trade_date='20130201', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20130201_tscode_list = list() 
for ts_code_sh in daily_20130201['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20130201_tscode_list.append(stock_name)
daily_20130201_addname_dataframe=pd.DataFrame()
daily_20130201_addname_dataframe['cname'] = daily_20130201_tscode_list
for table_name in daily_20130201.columns.values.tolist():
    daily_20130201_addname_dataframe[table_name] = daily_20130201[table_name]
print("日线行情-时间为序  daily_20130201 返回数据 row 行数 = "+str(daily_20130201.shape[0]))
daily_20130201_addname_dataframe.to_excel(daily_201302_excel_writer,'1_5',index=False)
daily_201302_excel_writer.save()
daily_20130204 = pro.daily(start_date='',end_date='',trade_date='20130204', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20130204_tscode_list = list() 
for ts_code_sh in daily_20130204['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20130204_tscode_list.append(stock_name)
daily_20130204_addname_dataframe=pd.DataFrame()
daily_20130204_addname_dataframe['cname'] = daily_20130204_tscode_list
for table_name in daily_20130204.columns.values.tolist():
    daily_20130204_addname_dataframe[table_name] = daily_20130204[table_name]
print("日线行情-时间为序  daily_20130204 返回数据 row 行数 = "+str(daily_20130204.shape[0]))
daily_20130204_addname_dataframe.to_excel(daily_201302_excel_writer,'4_1',index=False)
daily_201302_excel_writer.save()
daily_20130205 = pro.daily(start_date='',end_date='',trade_date='20130205', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20130205_tscode_list = list() 
for ts_code_sh in daily_20130205['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20130205_tscode_list.append(stock_name)
daily_20130205_addname_dataframe=pd.DataFrame()
daily_20130205_addname_dataframe['cname'] = daily_20130205_tscode_list
for table_name in daily_20130205.columns.values.tolist():
    daily_20130205_addname_dataframe[table_name] = daily_20130205[table_name]
print("日线行情-时间为序  daily_20130205 返回数据 row 行数 = "+str(daily_20130205.shape[0]))
daily_20130205_addname_dataframe.to_excel(daily_201302_excel_writer,'5_2',index=False)
daily_201302_excel_writer.save()
daily_20130206 = pro.daily(start_date='',end_date='',trade_date='20130206', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20130206_tscode_list = list() 
for ts_code_sh in daily_20130206['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20130206_tscode_list.append(stock_name)
daily_20130206_addname_dataframe=pd.DataFrame()
daily_20130206_addname_dataframe['cname'] = daily_20130206_tscode_list
for table_name in daily_20130206.columns.values.tolist():
    daily_20130206_addname_dataframe[table_name] = daily_20130206[table_name]
print("日线行情-时间为序  daily_20130206 返回数据 row 行数 = "+str(daily_20130206.shape[0]))
daily_20130206_addname_dataframe.to_excel(daily_201302_excel_writer,'6_3',index=False)
daily_201302_excel_writer.save()
daily_20130207 = pro.daily(start_date='',end_date='',trade_date='20130207', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20130207_tscode_list = list() 
for ts_code_sh in daily_20130207['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20130207_tscode_list.append(stock_name)
daily_20130207_addname_dataframe=pd.DataFrame()
daily_20130207_addname_dataframe['cname'] = daily_20130207_tscode_list
for table_name in daily_20130207.columns.values.tolist():
    daily_20130207_addname_dataframe[table_name] = daily_20130207[table_name]
print("日线行情-时间为序  daily_20130207 返回数据 row 行数 = "+str(daily_20130207.shape[0]))
daily_20130207_addname_dataframe.to_excel(daily_201302_excel_writer,'7_4',index=False)
daily_201302_excel_writer.save()
daily_20130208 = pro.daily(start_date='',end_date='',trade_date='20130208', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20130208_tscode_list = list() 
for ts_code_sh in daily_20130208['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20130208_tscode_list.append(stock_name)
daily_20130208_addname_dataframe=pd.DataFrame()
daily_20130208_addname_dataframe['cname'] = daily_20130208_tscode_list
for table_name in daily_20130208.columns.values.tolist():
    daily_20130208_addname_dataframe[table_name] = daily_20130208[table_name]
print("日线行情-时间为序  daily_20130208 返回数据 row 行数 = "+str(daily_20130208.shape[0]))
daily_20130208_addname_dataframe.to_excel(daily_201302_excel_writer,'8_5',index=False)
daily_201302_excel_writer.save()
daily_20130218 = pro.daily(start_date='',end_date='',trade_date='20130218', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20130218_tscode_list = list() 
for ts_code_sh in daily_20130218['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20130218_tscode_list.append(stock_name)
daily_20130218_addname_dataframe=pd.DataFrame()
daily_20130218_addname_dataframe['cname'] = daily_20130218_tscode_list
for table_name in daily_20130218.columns.values.tolist():
    daily_20130218_addname_dataframe[table_name] = daily_20130218[table_name]
print("日线行情-时间为序  daily_20130218 返回数据 row 行数 = "+str(daily_20130218.shape[0]))
daily_20130218_addname_dataframe.to_excel(daily_201302_excel_writer,'18_1',index=False)
daily_201302_excel_writer.save()
daily_20130219 = pro.daily(start_date='',end_date='',trade_date='20130219', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20130219_tscode_list = list() 
for ts_code_sh in daily_20130219['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20130219_tscode_list.append(stock_name)
daily_20130219_addname_dataframe=pd.DataFrame()
daily_20130219_addname_dataframe['cname'] = daily_20130219_tscode_list
for table_name in daily_20130219.columns.values.tolist():
    daily_20130219_addname_dataframe[table_name] = daily_20130219[table_name]
print("日线行情-时间为序  daily_20130219 返回数据 row 行数 = "+str(daily_20130219.shape[0]))
daily_20130219_addname_dataframe.to_excel(daily_201302_excel_writer,'19_2',index=False)
daily_201302_excel_writer.save()
daily_20130220 = pro.daily(start_date='',end_date='',trade_date='20130220', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20130220_tscode_list = list() 
for ts_code_sh in daily_20130220['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20130220_tscode_list.append(stock_name)
daily_20130220_addname_dataframe=pd.DataFrame()
daily_20130220_addname_dataframe['cname'] = daily_20130220_tscode_list
for table_name in daily_20130220.columns.values.tolist():
    daily_20130220_addname_dataframe[table_name] = daily_20130220[table_name]
print("日线行情-时间为序  daily_20130220 返回数据 row 行数 = "+str(daily_20130220.shape[0]))
daily_20130220_addname_dataframe.to_excel(daily_201302_excel_writer,'20_3',index=False)
daily_201302_excel_writer.save()
daily_20130221 = pro.daily(start_date='',end_date='',trade_date='20130221', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20130221_tscode_list = list() 
for ts_code_sh in daily_20130221['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20130221_tscode_list.append(stock_name)
daily_20130221_addname_dataframe=pd.DataFrame()
daily_20130221_addname_dataframe['cname'] = daily_20130221_tscode_list
for table_name in daily_20130221.columns.values.tolist():
    daily_20130221_addname_dataframe[table_name] = daily_20130221[table_name]
print("日线行情-时间为序  daily_20130221 返回数据 row 行数 = "+str(daily_20130221.shape[0]))
daily_20130221_addname_dataframe.to_excel(daily_201302_excel_writer,'21_4',index=False)
daily_201302_excel_writer.save()
daily_20130222 = pro.daily(start_date='',end_date='',trade_date='20130222', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20130222_tscode_list = list() 
for ts_code_sh in daily_20130222['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20130222_tscode_list.append(stock_name)
daily_20130222_addname_dataframe=pd.DataFrame()
daily_20130222_addname_dataframe['cname'] = daily_20130222_tscode_list
for table_name in daily_20130222.columns.values.tolist():
    daily_20130222_addname_dataframe[table_name] = daily_20130222[table_name]
print("日线行情-时间为序  daily_20130222 返回数据 row 行数 = "+str(daily_20130222.shape[0]))
daily_20130222_addname_dataframe.to_excel(daily_201302_excel_writer,'22_5',index=False)
daily_201302_excel_writer.save()
daily_20130225 = pro.daily(start_date='',end_date='',trade_date='20130225', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20130225_tscode_list = list() 
for ts_code_sh in daily_20130225['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20130225_tscode_list.append(stock_name)
daily_20130225_addname_dataframe=pd.DataFrame()
daily_20130225_addname_dataframe['cname'] = daily_20130225_tscode_list
for table_name in daily_20130225.columns.values.tolist():
    daily_20130225_addname_dataframe[table_name] = daily_20130225[table_name]
print("日线行情-时间为序  daily_20130225 返回数据 row 行数 = "+str(daily_20130225.shape[0]))
daily_20130225_addname_dataframe.to_excel(daily_201302_excel_writer,'25_1',index=False)
daily_201302_excel_writer.save()
daily_20130226 = pro.daily(start_date='',end_date='',trade_date='20130226', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20130226_tscode_list = list() 
for ts_code_sh in daily_20130226['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20130226_tscode_list.append(stock_name)
daily_20130226_addname_dataframe=pd.DataFrame()
daily_20130226_addname_dataframe['cname'] = daily_20130226_tscode_list
for table_name in daily_20130226.columns.values.tolist():
    daily_20130226_addname_dataframe[table_name] = daily_20130226[table_name]
print("日线行情-时间为序  daily_20130226 返回数据 row 行数 = "+str(daily_20130226.shape[0]))
daily_20130226_addname_dataframe.to_excel(daily_201302_excel_writer,'26_2',index=False)
daily_201302_excel_writer.save()
daily_20130227 = pro.daily(start_date='',end_date='',trade_date='20130227', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20130227_tscode_list = list() 
for ts_code_sh in daily_20130227['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20130227_tscode_list.append(stock_name)
daily_20130227_addname_dataframe=pd.DataFrame()
daily_20130227_addname_dataframe['cname'] = daily_20130227_tscode_list
for table_name in daily_20130227.columns.values.tolist():
    daily_20130227_addname_dataframe[table_name] = daily_20130227[table_name]
print("日线行情-时间为序  daily_20130227 返回数据 row 行数 = "+str(daily_20130227.shape[0]))
daily_20130227_addname_dataframe.to_excel(daily_201302_excel_writer,'27_3',index=False)
daily_201302_excel_writer.save()
daily_20130228 = pro.daily(start_date='',end_date='',trade_date='20130228', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20130228_tscode_list = list() 
for ts_code_sh in daily_20130228['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20130228_tscode_list.append(stock_name)
daily_20130228_addname_dataframe=pd.DataFrame()
daily_20130228_addname_dataframe['cname'] = daily_20130228_tscode_list
for table_name in daily_20130228.columns.values.tolist():
    daily_20130228_addname_dataframe[table_name] = daily_20130228[table_name]
print("日线行情-时间为序  daily_20130228 返回数据 row 行数 = "+str(daily_20130228.shape[0]))
daily_20130228_addname_dataframe.to_excel(daily_201302_excel_writer,'28_4',index=False)
daily_201302_excel_writer.save()




createexcel('daily_201303.xlsx')
daily_201303_book = load_workbook('C:\\Users\\zhuzj5\\Desktop\\zbin\\J0_Data\\daily_201303.xlsx')
daily_201303_excel_writer = pd.ExcelWriter('C:\\Users\\zhuzj5\\Desktop\\zbin\\J0_Data\\daily_201303.xlsx', engine='openpyxl')
daily_201303_excel_writer.book = daily_201303_book
daily_201303_excel_writer.sheets = dict((ws.title, ws) for ws in daily_201303_book.worksheets)
J0_PROPS.put(tree_node_name+"record_date", "20130301")       ###  更新 记录日期
daily_20130301 = pro.daily(start_date='',end_date='',trade_date='20130301', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20130301_tscode_list = list() 
for ts_code_sh in daily_20130301['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20130301_tscode_list.append(stock_name)
daily_20130301_addname_dataframe=pd.DataFrame()
daily_20130301_addname_dataframe['cname'] = daily_20130301_tscode_list
for table_name in daily_20130301.columns.values.tolist():
    daily_20130301_addname_dataframe[table_name] = daily_20130301[table_name]
print("日线行情-时间为序  daily_20130301 返回数据 row 行数 = "+str(daily_20130301.shape[0]))
daily_20130301_addname_dataframe.to_excel(daily_201303_excel_writer,'1_5',index=False)
daily_201303_excel_writer.save()
daily_20130304 = pro.daily(start_date='',end_date='',trade_date='20130304', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20130304_tscode_list = list() 
for ts_code_sh in daily_20130304['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20130304_tscode_list.append(stock_name)
daily_20130304_addname_dataframe=pd.DataFrame()
daily_20130304_addname_dataframe['cname'] = daily_20130304_tscode_list
for table_name in daily_20130304.columns.values.tolist():
    daily_20130304_addname_dataframe[table_name] = daily_20130304[table_name]
print("日线行情-时间为序  daily_20130304 返回数据 row 行数 = "+str(daily_20130304.shape[0]))
daily_20130304_addname_dataframe.to_excel(daily_201303_excel_writer,'4_1',index=False)
daily_201303_excel_writer.save()
daily_20130305 = pro.daily(start_date='',end_date='',trade_date='20130305', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20130305_tscode_list = list() 
for ts_code_sh in daily_20130305['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20130305_tscode_list.append(stock_name)
daily_20130305_addname_dataframe=pd.DataFrame()
daily_20130305_addname_dataframe['cname'] = daily_20130305_tscode_list
for table_name in daily_20130305.columns.values.tolist():
    daily_20130305_addname_dataframe[table_name] = daily_20130305[table_name]
print("日线行情-时间为序  daily_20130305 返回数据 row 行数 = "+str(daily_20130305.shape[0]))
daily_20130305_addname_dataframe.to_excel(daily_201303_excel_writer,'5_2',index=False)
daily_201303_excel_writer.save()
daily_20130306 = pro.daily(start_date='',end_date='',trade_date='20130306', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20130306_tscode_list = list() 
for ts_code_sh in daily_20130306['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20130306_tscode_list.append(stock_name)
daily_20130306_addname_dataframe=pd.DataFrame()
daily_20130306_addname_dataframe['cname'] = daily_20130306_tscode_list
for table_name in daily_20130306.columns.values.tolist():
    daily_20130306_addname_dataframe[table_name] = daily_20130306[table_name]
print("日线行情-时间为序  daily_20130306 返回数据 row 行数 = "+str(daily_20130306.shape[0]))
daily_20130306_addname_dataframe.to_excel(daily_201303_excel_writer,'6_3',index=False)
daily_201303_excel_writer.save()
daily_20130307 = pro.daily(start_date='',end_date='',trade_date='20130307', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20130307_tscode_list = list() 
for ts_code_sh in daily_20130307['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20130307_tscode_list.append(stock_name)
daily_20130307_addname_dataframe=pd.DataFrame()
daily_20130307_addname_dataframe['cname'] = daily_20130307_tscode_list
for table_name in daily_20130307.columns.values.tolist():
    daily_20130307_addname_dataframe[table_name] = daily_20130307[table_name]
print("日线行情-时间为序  daily_20130307 返回数据 row 行数 = "+str(daily_20130307.shape[0]))
daily_20130307_addname_dataframe.to_excel(daily_201303_excel_writer,'7_4',index=False)
daily_201303_excel_writer.save()
daily_20130308 = pro.daily(start_date='',end_date='',trade_date='20130308', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20130308_tscode_list = list() 
for ts_code_sh in daily_20130308['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20130308_tscode_list.append(stock_name)
daily_20130308_addname_dataframe=pd.DataFrame()
daily_20130308_addname_dataframe['cname'] = daily_20130308_tscode_list
for table_name in daily_20130308.columns.values.tolist():
    daily_20130308_addname_dataframe[table_name] = daily_20130308[table_name]
print("日线行情-时间为序  daily_20130308 返回数据 row 行数 = "+str(daily_20130308.shape[0]))
daily_20130308_addname_dataframe.to_excel(daily_201303_excel_writer,'8_5',index=False)
daily_201303_excel_writer.save()
daily_20130311 = pro.daily(start_date='',end_date='',trade_date='20130311', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20130311_tscode_list = list() 
for ts_code_sh in daily_20130311['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20130311_tscode_list.append(stock_name)
daily_20130311_addname_dataframe=pd.DataFrame()
daily_20130311_addname_dataframe['cname'] = daily_20130311_tscode_list
for table_name in daily_20130311.columns.values.tolist():
    daily_20130311_addname_dataframe[table_name] = daily_20130311[table_name]
print("日线行情-时间为序  daily_20130311 返回数据 row 行数 = "+str(daily_20130311.shape[0]))
daily_20130311_addname_dataframe.to_excel(daily_201303_excel_writer,'11_1',index=False)
daily_201303_excel_writer.save()
daily_20130312 = pro.daily(start_date='',end_date='',trade_date='20130312', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20130312_tscode_list = list() 
for ts_code_sh in daily_20130312['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20130312_tscode_list.append(stock_name)
daily_20130312_addname_dataframe=pd.DataFrame()
daily_20130312_addname_dataframe['cname'] = daily_20130312_tscode_list
for table_name in daily_20130312.columns.values.tolist():
    daily_20130312_addname_dataframe[table_name] = daily_20130312[table_name]
print("日线行情-时间为序  daily_20130312 返回数据 row 行数 = "+str(daily_20130312.shape[0]))
daily_20130312_addname_dataframe.to_excel(daily_201303_excel_writer,'12_2',index=False)
daily_201303_excel_writer.save()
daily_20130313 = pro.daily(start_date='',end_date='',trade_date='20130313', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20130313_tscode_list = list() 
for ts_code_sh in daily_20130313['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20130313_tscode_list.append(stock_name)
daily_20130313_addname_dataframe=pd.DataFrame()
daily_20130313_addname_dataframe['cname'] = daily_20130313_tscode_list
for table_name in daily_20130313.columns.values.tolist():
    daily_20130313_addname_dataframe[table_name] = daily_20130313[table_name]
print("日线行情-时间为序  daily_20130313 返回数据 row 行数 = "+str(daily_20130313.shape[0]))
daily_20130313_addname_dataframe.to_excel(daily_201303_excel_writer,'13_3',index=False)
daily_201303_excel_writer.save()
daily_20130314 = pro.daily(start_date='',end_date='',trade_date='20130314', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20130314_tscode_list = list() 
for ts_code_sh in daily_20130314['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20130314_tscode_list.append(stock_name)
daily_20130314_addname_dataframe=pd.DataFrame()
daily_20130314_addname_dataframe['cname'] = daily_20130314_tscode_list
for table_name in daily_20130314.columns.values.tolist():
    daily_20130314_addname_dataframe[table_name] = daily_20130314[table_name]
print("日线行情-时间为序  daily_20130314 返回数据 row 行数 = "+str(daily_20130314.shape[0]))
daily_20130314_addname_dataframe.to_excel(daily_201303_excel_writer,'14_4',index=False)
daily_201303_excel_writer.save()
daily_20130315 = pro.daily(start_date='',end_date='',trade_date='20130315', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20130315_tscode_list = list() 
for ts_code_sh in daily_20130315['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20130315_tscode_list.append(stock_name)
daily_20130315_addname_dataframe=pd.DataFrame()
daily_20130315_addname_dataframe['cname'] = daily_20130315_tscode_list
for table_name in daily_20130315.columns.values.tolist():
    daily_20130315_addname_dataframe[table_name] = daily_20130315[table_name]
print("日线行情-时间为序  daily_20130315 返回数据 row 行数 = "+str(daily_20130315.shape[0]))
daily_20130315_addname_dataframe.to_excel(daily_201303_excel_writer,'15_5',index=False)
daily_201303_excel_writer.save()
daily_20130318 = pro.daily(start_date='',end_date='',trade_date='20130318', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20130318_tscode_list = list() 
for ts_code_sh in daily_20130318['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20130318_tscode_list.append(stock_name)
daily_20130318_addname_dataframe=pd.DataFrame()
daily_20130318_addname_dataframe['cname'] = daily_20130318_tscode_list
for table_name in daily_20130318.columns.values.tolist():
    daily_20130318_addname_dataframe[table_name] = daily_20130318[table_name]
print("日线行情-时间为序  daily_20130318 返回数据 row 行数 = "+str(daily_20130318.shape[0]))
daily_20130318_addname_dataframe.to_excel(daily_201303_excel_writer,'18_1',index=False)
daily_201303_excel_writer.save()
daily_20130319 = pro.daily(start_date='',end_date='',trade_date='20130319', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20130319_tscode_list = list() 
for ts_code_sh in daily_20130319['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20130319_tscode_list.append(stock_name)
daily_20130319_addname_dataframe=pd.DataFrame()
daily_20130319_addname_dataframe['cname'] = daily_20130319_tscode_list
for table_name in daily_20130319.columns.values.tolist():
    daily_20130319_addname_dataframe[table_name] = daily_20130319[table_name]
print("日线行情-时间为序  daily_20130319 返回数据 row 行数 = "+str(daily_20130319.shape[0]))
daily_20130319_addname_dataframe.to_excel(daily_201303_excel_writer,'19_2',index=False)
daily_201303_excel_writer.save()
daily_20130320 = pro.daily(start_date='',end_date='',trade_date='20130320', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20130320_tscode_list = list() 
for ts_code_sh in daily_20130320['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20130320_tscode_list.append(stock_name)
daily_20130320_addname_dataframe=pd.DataFrame()
daily_20130320_addname_dataframe['cname'] = daily_20130320_tscode_list
for table_name in daily_20130320.columns.values.tolist():
    daily_20130320_addname_dataframe[table_name] = daily_20130320[table_name]
print("日线行情-时间为序  daily_20130320 返回数据 row 行数 = "+str(daily_20130320.shape[0]))
daily_20130320_addname_dataframe.to_excel(daily_201303_excel_writer,'20_3',index=False)
daily_201303_excel_writer.save()
daily_20130321 = pro.daily(start_date='',end_date='',trade_date='20130321', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20130321_tscode_list = list() 
for ts_code_sh in daily_20130321['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20130321_tscode_list.append(stock_name)
daily_20130321_addname_dataframe=pd.DataFrame()
daily_20130321_addname_dataframe['cname'] = daily_20130321_tscode_list
for table_name in daily_20130321.columns.values.tolist():
    daily_20130321_addname_dataframe[table_name] = daily_20130321[table_name]
print("日线行情-时间为序  daily_20130321 返回数据 row 行数 = "+str(daily_20130321.shape[0]))
daily_20130321_addname_dataframe.to_excel(daily_201303_excel_writer,'21_4',index=False)
daily_201303_excel_writer.save()
daily_20130322 = pro.daily(start_date='',end_date='',trade_date='20130322', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20130322_tscode_list = list() 
for ts_code_sh in daily_20130322['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20130322_tscode_list.append(stock_name)
daily_20130322_addname_dataframe=pd.DataFrame()
daily_20130322_addname_dataframe['cname'] = daily_20130322_tscode_list
for table_name in daily_20130322.columns.values.tolist():
    daily_20130322_addname_dataframe[table_name] = daily_20130322[table_name]
print("日线行情-时间为序  daily_20130322 返回数据 row 行数 = "+str(daily_20130322.shape[0]))
daily_20130322_addname_dataframe.to_excel(daily_201303_excel_writer,'22_5',index=False)
daily_201303_excel_writer.save()
daily_20130325 = pro.daily(start_date='',end_date='',trade_date='20130325', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20130325_tscode_list = list() 
for ts_code_sh in daily_20130325['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20130325_tscode_list.append(stock_name)
daily_20130325_addname_dataframe=pd.DataFrame()
daily_20130325_addname_dataframe['cname'] = daily_20130325_tscode_list
for table_name in daily_20130325.columns.values.tolist():
    daily_20130325_addname_dataframe[table_name] = daily_20130325[table_name]
print("日线行情-时间为序  daily_20130325 返回数据 row 行数 = "+str(daily_20130325.shape[0]))
daily_20130325_addname_dataframe.to_excel(daily_201303_excel_writer,'25_1',index=False)
daily_201303_excel_writer.save()
daily_20130326 = pro.daily(start_date='',end_date='',trade_date='20130326', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20130326_tscode_list = list() 
for ts_code_sh in daily_20130326['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20130326_tscode_list.append(stock_name)
daily_20130326_addname_dataframe=pd.DataFrame()
daily_20130326_addname_dataframe['cname'] = daily_20130326_tscode_list
for table_name in daily_20130326.columns.values.tolist():
    daily_20130326_addname_dataframe[table_name] = daily_20130326[table_name]
print("日线行情-时间为序  daily_20130326 返回数据 row 行数 = "+str(daily_20130326.shape[0]))
daily_20130326_addname_dataframe.to_excel(daily_201303_excel_writer,'26_2',index=False)
daily_201303_excel_writer.save()
daily_20130327 = pro.daily(start_date='',end_date='',trade_date='20130327', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20130327_tscode_list = list() 
for ts_code_sh in daily_20130327['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20130327_tscode_list.append(stock_name)
daily_20130327_addname_dataframe=pd.DataFrame()
daily_20130327_addname_dataframe['cname'] = daily_20130327_tscode_list
for table_name in daily_20130327.columns.values.tolist():
    daily_20130327_addname_dataframe[table_name] = daily_20130327[table_name]
print("日线行情-时间为序  daily_20130327 返回数据 row 行数 = "+str(daily_20130327.shape[0]))
daily_20130327_addname_dataframe.to_excel(daily_201303_excel_writer,'27_3',index=False)
daily_201303_excel_writer.save()
daily_20130328 = pro.daily(start_date='',end_date='',trade_date='20130328', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20130328_tscode_list = list() 
for ts_code_sh in daily_20130328['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20130328_tscode_list.append(stock_name)
daily_20130328_addname_dataframe=pd.DataFrame()
daily_20130328_addname_dataframe['cname'] = daily_20130328_tscode_list
for table_name in daily_20130328.columns.values.tolist():
    daily_20130328_addname_dataframe[table_name] = daily_20130328[table_name]
print("日线行情-时间为序  daily_20130328 返回数据 row 行数 = "+str(daily_20130328.shape[0]))
daily_20130328_addname_dataframe.to_excel(daily_201303_excel_writer,'28_4',index=False)
daily_201303_excel_writer.save()
daily_20130329 = pro.daily(start_date='',end_date='',trade_date='20130329', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20130329_tscode_list = list() 
for ts_code_sh in daily_20130329['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20130329_tscode_list.append(stock_name)
daily_20130329_addname_dataframe=pd.DataFrame()
daily_20130329_addname_dataframe['cname'] = daily_20130329_tscode_list
for table_name in daily_20130329.columns.values.tolist():
    daily_20130329_addname_dataframe[table_name] = daily_20130329[table_name]
print("日线行情-时间为序  daily_20130329 返回数据 row 行数 = "+str(daily_20130329.shape[0]))
daily_20130329_addname_dataframe.to_excel(daily_201303_excel_writer,'29_5',index=False)
daily_201303_excel_writer.save()




createexcel('daily_201304.xlsx')
daily_201304_book = load_workbook('C:\\Users\\zhuzj5\\Desktop\\zbin\\J0_Data\\daily_201304.xlsx')
daily_201304_excel_writer = pd.ExcelWriter('C:\\Users\\zhuzj5\\Desktop\\zbin\\J0_Data\\daily_201304.xlsx', engine='openpyxl')
daily_201304_excel_writer.book = daily_201304_book
daily_201304_excel_writer.sheets = dict((ws.title, ws) for ws in daily_201304_book.worksheets)
J0_PROPS.put(tree_node_name+"record_date", "20130401")       ###  更新 记录日期
daily_20130401 = pro.daily(start_date='',end_date='',trade_date='20130401', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20130401_tscode_list = list() 
for ts_code_sh in daily_20130401['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20130401_tscode_list.append(stock_name)
daily_20130401_addname_dataframe=pd.DataFrame()
daily_20130401_addname_dataframe['cname'] = daily_20130401_tscode_list
for table_name in daily_20130401.columns.values.tolist():
    daily_20130401_addname_dataframe[table_name] = daily_20130401[table_name]
print("日线行情-时间为序  daily_20130401 返回数据 row 行数 = "+str(daily_20130401.shape[0]))
daily_20130401_addname_dataframe.to_excel(daily_201304_excel_writer,'1_1',index=False)
daily_201304_excel_writer.save()
daily_20130402 = pro.daily(start_date='',end_date='',trade_date='20130402', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20130402_tscode_list = list() 
for ts_code_sh in daily_20130402['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20130402_tscode_list.append(stock_name)
daily_20130402_addname_dataframe=pd.DataFrame()
daily_20130402_addname_dataframe['cname'] = daily_20130402_tscode_list
for table_name in daily_20130402.columns.values.tolist():
    daily_20130402_addname_dataframe[table_name] = daily_20130402[table_name]
print("日线行情-时间为序  daily_20130402 返回数据 row 行数 = "+str(daily_20130402.shape[0]))
daily_20130402_addname_dataframe.to_excel(daily_201304_excel_writer,'2_2',index=False)
daily_201304_excel_writer.save()
daily_20130403 = pro.daily(start_date='',end_date='',trade_date='20130403', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20130403_tscode_list = list() 
for ts_code_sh in daily_20130403['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20130403_tscode_list.append(stock_name)
daily_20130403_addname_dataframe=pd.DataFrame()
daily_20130403_addname_dataframe['cname'] = daily_20130403_tscode_list
for table_name in daily_20130403.columns.values.tolist():
    daily_20130403_addname_dataframe[table_name] = daily_20130403[table_name]
print("日线行情-时间为序  daily_20130403 返回数据 row 行数 = "+str(daily_20130403.shape[0]))
daily_20130403_addname_dataframe.to_excel(daily_201304_excel_writer,'3_3',index=False)
daily_201304_excel_writer.save()
daily_20130408 = pro.daily(start_date='',end_date='',trade_date='20130408', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20130408_tscode_list = list() 
for ts_code_sh in daily_20130408['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20130408_tscode_list.append(stock_name)
daily_20130408_addname_dataframe=pd.DataFrame()
daily_20130408_addname_dataframe['cname'] = daily_20130408_tscode_list
for table_name in daily_20130408.columns.values.tolist():
    daily_20130408_addname_dataframe[table_name] = daily_20130408[table_name]
print("日线行情-时间为序  daily_20130408 返回数据 row 行数 = "+str(daily_20130408.shape[0]))
daily_20130408_addname_dataframe.to_excel(daily_201304_excel_writer,'8_1',index=False)
daily_201304_excel_writer.save()
daily_20130409 = pro.daily(start_date='',end_date='',trade_date='20130409', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20130409_tscode_list = list() 
for ts_code_sh in daily_20130409['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20130409_tscode_list.append(stock_name)
daily_20130409_addname_dataframe=pd.DataFrame()
daily_20130409_addname_dataframe['cname'] = daily_20130409_tscode_list
for table_name in daily_20130409.columns.values.tolist():
    daily_20130409_addname_dataframe[table_name] = daily_20130409[table_name]
print("日线行情-时间为序  daily_20130409 返回数据 row 行数 = "+str(daily_20130409.shape[0]))
daily_20130409_addname_dataframe.to_excel(daily_201304_excel_writer,'9_2',index=False)
daily_201304_excel_writer.save()
daily_20130410 = pro.daily(start_date='',end_date='',trade_date='20130410', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20130410_tscode_list = list() 
for ts_code_sh in daily_20130410['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20130410_tscode_list.append(stock_name)
daily_20130410_addname_dataframe=pd.DataFrame()
daily_20130410_addname_dataframe['cname'] = daily_20130410_tscode_list
for table_name in daily_20130410.columns.values.tolist():
    daily_20130410_addname_dataframe[table_name] = daily_20130410[table_name]
print("日线行情-时间为序  daily_20130410 返回数据 row 行数 = "+str(daily_20130410.shape[0]))
daily_20130410_addname_dataframe.to_excel(daily_201304_excel_writer,'10_3',index=False)
daily_201304_excel_writer.save()
daily_20130411 = pro.daily(start_date='',end_date='',trade_date='20130411', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20130411_tscode_list = list() 
for ts_code_sh in daily_20130411['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20130411_tscode_list.append(stock_name)
daily_20130411_addname_dataframe=pd.DataFrame()
daily_20130411_addname_dataframe['cname'] = daily_20130411_tscode_list
for table_name in daily_20130411.columns.values.tolist():
    daily_20130411_addname_dataframe[table_name] = daily_20130411[table_name]
print("日线行情-时间为序  daily_20130411 返回数据 row 行数 = "+str(daily_20130411.shape[0]))
daily_20130411_addname_dataframe.to_excel(daily_201304_excel_writer,'11_4',index=False)
daily_201304_excel_writer.save()
daily_20130412 = pro.daily(start_date='',end_date='',trade_date='20130412', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20130412_tscode_list = list() 
for ts_code_sh in daily_20130412['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20130412_tscode_list.append(stock_name)
daily_20130412_addname_dataframe=pd.DataFrame()
daily_20130412_addname_dataframe['cname'] = daily_20130412_tscode_list
for table_name in daily_20130412.columns.values.tolist():
    daily_20130412_addname_dataframe[table_name] = daily_20130412[table_name]
print("日线行情-时间为序  daily_20130412 返回数据 row 行数 = "+str(daily_20130412.shape[0]))
daily_20130412_addname_dataframe.to_excel(daily_201304_excel_writer,'12_5',index=False)
daily_201304_excel_writer.save()
daily_20130415 = pro.daily(start_date='',end_date='',trade_date='20130415', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20130415_tscode_list = list() 
for ts_code_sh in daily_20130415['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20130415_tscode_list.append(stock_name)
daily_20130415_addname_dataframe=pd.DataFrame()
daily_20130415_addname_dataframe['cname'] = daily_20130415_tscode_list
for table_name in daily_20130415.columns.values.tolist():
    daily_20130415_addname_dataframe[table_name] = daily_20130415[table_name]
print("日线行情-时间为序  daily_20130415 返回数据 row 行数 = "+str(daily_20130415.shape[0]))
daily_20130415_addname_dataframe.to_excel(daily_201304_excel_writer,'15_1',index=False)
daily_201304_excel_writer.save()
daily_20130416 = pro.daily(start_date='',end_date='',trade_date='20130416', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20130416_tscode_list = list() 
for ts_code_sh in daily_20130416['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20130416_tscode_list.append(stock_name)
daily_20130416_addname_dataframe=pd.DataFrame()
daily_20130416_addname_dataframe['cname'] = daily_20130416_tscode_list
for table_name in daily_20130416.columns.values.tolist():
    daily_20130416_addname_dataframe[table_name] = daily_20130416[table_name]
print("日线行情-时间为序  daily_20130416 返回数据 row 行数 = "+str(daily_20130416.shape[0]))
daily_20130416_addname_dataframe.to_excel(daily_201304_excel_writer,'16_2',index=False)
daily_201304_excel_writer.save()
daily_20130417 = pro.daily(start_date='',end_date='',trade_date='20130417', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20130417_tscode_list = list() 
for ts_code_sh in daily_20130417['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20130417_tscode_list.append(stock_name)
daily_20130417_addname_dataframe=pd.DataFrame()
daily_20130417_addname_dataframe['cname'] = daily_20130417_tscode_list
for table_name in daily_20130417.columns.values.tolist():
    daily_20130417_addname_dataframe[table_name] = daily_20130417[table_name]
print("日线行情-时间为序  daily_20130417 返回数据 row 行数 = "+str(daily_20130417.shape[0]))
daily_20130417_addname_dataframe.to_excel(daily_201304_excel_writer,'17_3',index=False)
daily_201304_excel_writer.save()
daily_20130418 = pro.daily(start_date='',end_date='',trade_date='20130418', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20130418_tscode_list = list() 
for ts_code_sh in daily_20130418['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20130418_tscode_list.append(stock_name)
daily_20130418_addname_dataframe=pd.DataFrame()
daily_20130418_addname_dataframe['cname'] = daily_20130418_tscode_list
for table_name in daily_20130418.columns.values.tolist():
    daily_20130418_addname_dataframe[table_name] = daily_20130418[table_name]
print("日线行情-时间为序  daily_20130418 返回数据 row 行数 = "+str(daily_20130418.shape[0]))
daily_20130418_addname_dataframe.to_excel(daily_201304_excel_writer,'18_4',index=False)
daily_201304_excel_writer.save()
daily_20130419 = pro.daily(start_date='',end_date='',trade_date='20130419', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20130419_tscode_list = list() 
for ts_code_sh in daily_20130419['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20130419_tscode_list.append(stock_name)
daily_20130419_addname_dataframe=pd.DataFrame()
daily_20130419_addname_dataframe['cname'] = daily_20130419_tscode_list
for table_name in daily_20130419.columns.values.tolist():
    daily_20130419_addname_dataframe[table_name] = daily_20130419[table_name]
print("日线行情-时间为序  daily_20130419 返回数据 row 行数 = "+str(daily_20130419.shape[0]))
daily_20130419_addname_dataframe.to_excel(daily_201304_excel_writer,'19_5',index=False)
daily_201304_excel_writer.save()
daily_20130422 = pro.daily(start_date='',end_date='',trade_date='20130422', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20130422_tscode_list = list() 
for ts_code_sh in daily_20130422['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20130422_tscode_list.append(stock_name)
daily_20130422_addname_dataframe=pd.DataFrame()
daily_20130422_addname_dataframe['cname'] = daily_20130422_tscode_list
for table_name in daily_20130422.columns.values.tolist():
    daily_20130422_addname_dataframe[table_name] = daily_20130422[table_name]
print("日线行情-时间为序  daily_20130422 返回数据 row 行数 = "+str(daily_20130422.shape[0]))
daily_20130422_addname_dataframe.to_excel(daily_201304_excel_writer,'22_1',index=False)
daily_201304_excel_writer.save()
daily_20130423 = pro.daily(start_date='',end_date='',trade_date='20130423', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20130423_tscode_list = list() 
for ts_code_sh in daily_20130423['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20130423_tscode_list.append(stock_name)
daily_20130423_addname_dataframe=pd.DataFrame()
daily_20130423_addname_dataframe['cname'] = daily_20130423_tscode_list
for table_name in daily_20130423.columns.values.tolist():
    daily_20130423_addname_dataframe[table_name] = daily_20130423[table_name]
print("日线行情-时间为序  daily_20130423 返回数据 row 行数 = "+str(daily_20130423.shape[0]))
daily_20130423_addname_dataframe.to_excel(daily_201304_excel_writer,'23_2',index=False)
daily_201304_excel_writer.save()
daily_20130424 = pro.daily(start_date='',end_date='',trade_date='20130424', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20130424_tscode_list = list() 
for ts_code_sh in daily_20130424['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20130424_tscode_list.append(stock_name)
daily_20130424_addname_dataframe=pd.DataFrame()
daily_20130424_addname_dataframe['cname'] = daily_20130424_tscode_list
for table_name in daily_20130424.columns.values.tolist():
    daily_20130424_addname_dataframe[table_name] = daily_20130424[table_name]
print("日线行情-时间为序  daily_20130424 返回数据 row 行数 = "+str(daily_20130424.shape[0]))
daily_20130424_addname_dataframe.to_excel(daily_201304_excel_writer,'24_3',index=False)
daily_201304_excel_writer.save()
daily_20130425 = pro.daily(start_date='',end_date='',trade_date='20130425', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20130425_tscode_list = list() 
for ts_code_sh in daily_20130425['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20130425_tscode_list.append(stock_name)
daily_20130425_addname_dataframe=pd.DataFrame()
daily_20130425_addname_dataframe['cname'] = daily_20130425_tscode_list
for table_name in daily_20130425.columns.values.tolist():
    daily_20130425_addname_dataframe[table_name] = daily_20130425[table_name]
print("日线行情-时间为序  daily_20130425 返回数据 row 行数 = "+str(daily_20130425.shape[0]))
daily_20130425_addname_dataframe.to_excel(daily_201304_excel_writer,'25_4',index=False)
daily_201304_excel_writer.save()
daily_20130426 = pro.daily(start_date='',end_date='',trade_date='20130426', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20130426_tscode_list = list() 
for ts_code_sh in daily_20130426['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20130426_tscode_list.append(stock_name)
daily_20130426_addname_dataframe=pd.DataFrame()
daily_20130426_addname_dataframe['cname'] = daily_20130426_tscode_list
for table_name in daily_20130426.columns.values.tolist():
    daily_20130426_addname_dataframe[table_name] = daily_20130426[table_name]
print("日线行情-时间为序  daily_20130426 返回数据 row 行数 = "+str(daily_20130426.shape[0]))
daily_20130426_addname_dataframe.to_excel(daily_201304_excel_writer,'26_5',index=False)
daily_201304_excel_writer.save()




createexcel('daily_201305.xlsx')
daily_201305_book = load_workbook('C:\\Users\\zhuzj5\\Desktop\\zbin\\J0_Data\\daily_201305.xlsx')
daily_201305_excel_writer = pd.ExcelWriter('C:\\Users\\zhuzj5\\Desktop\\zbin\\J0_Data\\daily_201305.xlsx', engine='openpyxl')
daily_201305_excel_writer.book = daily_201305_book
daily_201305_excel_writer.sheets = dict((ws.title, ws) for ws in daily_201305_book.worksheets)
J0_PROPS.put(tree_node_name+"record_date", "20130501")       ###  更新 记录日期
daily_20130502 = pro.daily(start_date='',end_date='',trade_date='20130502', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20130502_tscode_list = list() 
for ts_code_sh in daily_20130502['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20130502_tscode_list.append(stock_name)
daily_20130502_addname_dataframe=pd.DataFrame()
daily_20130502_addname_dataframe['cname'] = daily_20130502_tscode_list
for table_name in daily_20130502.columns.values.tolist():
    daily_20130502_addname_dataframe[table_name] = daily_20130502[table_name]
print("日线行情-时间为序  daily_20130502 返回数据 row 行数 = "+str(daily_20130502.shape[0]))
daily_20130502_addname_dataframe.to_excel(daily_201305_excel_writer,'2_4',index=False)
daily_201305_excel_writer.save()
daily_20130503 = pro.daily(start_date='',end_date='',trade_date='20130503', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20130503_tscode_list = list() 
for ts_code_sh in daily_20130503['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20130503_tscode_list.append(stock_name)
daily_20130503_addname_dataframe=pd.DataFrame()
daily_20130503_addname_dataframe['cname'] = daily_20130503_tscode_list
for table_name in daily_20130503.columns.values.tolist():
    daily_20130503_addname_dataframe[table_name] = daily_20130503[table_name]
print("日线行情-时间为序  daily_20130503 返回数据 row 行数 = "+str(daily_20130503.shape[0]))
daily_20130503_addname_dataframe.to_excel(daily_201305_excel_writer,'3_5',index=False)
daily_201305_excel_writer.save()
daily_20130506 = pro.daily(start_date='',end_date='',trade_date='20130506', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20130506_tscode_list = list() 
for ts_code_sh in daily_20130506['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20130506_tscode_list.append(stock_name)
daily_20130506_addname_dataframe=pd.DataFrame()
daily_20130506_addname_dataframe['cname'] = daily_20130506_tscode_list
for table_name in daily_20130506.columns.values.tolist():
    daily_20130506_addname_dataframe[table_name] = daily_20130506[table_name]
print("日线行情-时间为序  daily_20130506 返回数据 row 行数 = "+str(daily_20130506.shape[0]))
daily_20130506_addname_dataframe.to_excel(daily_201305_excel_writer,'6_1',index=False)
daily_201305_excel_writer.save()
daily_20130507 = pro.daily(start_date='',end_date='',trade_date='20130507', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20130507_tscode_list = list() 
for ts_code_sh in daily_20130507['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20130507_tscode_list.append(stock_name)
daily_20130507_addname_dataframe=pd.DataFrame()
daily_20130507_addname_dataframe['cname'] = daily_20130507_tscode_list
for table_name in daily_20130507.columns.values.tolist():
    daily_20130507_addname_dataframe[table_name] = daily_20130507[table_name]
print("日线行情-时间为序  daily_20130507 返回数据 row 行数 = "+str(daily_20130507.shape[0]))
daily_20130507_addname_dataframe.to_excel(daily_201305_excel_writer,'7_2',index=False)
daily_201305_excel_writer.save()
daily_20130508 = pro.daily(start_date='',end_date='',trade_date='20130508', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20130508_tscode_list = list() 
for ts_code_sh in daily_20130508['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20130508_tscode_list.append(stock_name)
daily_20130508_addname_dataframe=pd.DataFrame()
daily_20130508_addname_dataframe['cname'] = daily_20130508_tscode_list
for table_name in daily_20130508.columns.values.tolist():
    daily_20130508_addname_dataframe[table_name] = daily_20130508[table_name]
print("日线行情-时间为序  daily_20130508 返回数据 row 行数 = "+str(daily_20130508.shape[0]))
daily_20130508_addname_dataframe.to_excel(daily_201305_excel_writer,'8_3',index=False)
daily_201305_excel_writer.save()
daily_20130509 = pro.daily(start_date='',end_date='',trade_date='20130509', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20130509_tscode_list = list() 
for ts_code_sh in daily_20130509['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20130509_tscode_list.append(stock_name)
daily_20130509_addname_dataframe=pd.DataFrame()
daily_20130509_addname_dataframe['cname'] = daily_20130509_tscode_list
for table_name in daily_20130509.columns.values.tolist():
    daily_20130509_addname_dataframe[table_name] = daily_20130509[table_name]
print("日线行情-时间为序  daily_20130509 返回数据 row 行数 = "+str(daily_20130509.shape[0]))
daily_20130509_addname_dataframe.to_excel(daily_201305_excel_writer,'9_4',index=False)
daily_201305_excel_writer.save()
daily_20130510 = pro.daily(start_date='',end_date='',trade_date='20130510', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20130510_tscode_list = list() 
for ts_code_sh in daily_20130510['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20130510_tscode_list.append(stock_name)
daily_20130510_addname_dataframe=pd.DataFrame()
daily_20130510_addname_dataframe['cname'] = daily_20130510_tscode_list
for table_name in daily_20130510.columns.values.tolist():
    daily_20130510_addname_dataframe[table_name] = daily_20130510[table_name]
print("日线行情-时间为序  daily_20130510 返回数据 row 行数 = "+str(daily_20130510.shape[0]))
daily_20130510_addname_dataframe.to_excel(daily_201305_excel_writer,'10_5',index=False)
daily_201305_excel_writer.save()
daily_20130513 = pro.daily(start_date='',end_date='',trade_date='20130513', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20130513_tscode_list = list() 
for ts_code_sh in daily_20130513['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20130513_tscode_list.append(stock_name)
daily_20130513_addname_dataframe=pd.DataFrame()
daily_20130513_addname_dataframe['cname'] = daily_20130513_tscode_list
for table_name in daily_20130513.columns.values.tolist():
    daily_20130513_addname_dataframe[table_name] = daily_20130513[table_name]
print("日线行情-时间为序  daily_20130513 返回数据 row 行数 = "+str(daily_20130513.shape[0]))
daily_20130513_addname_dataframe.to_excel(daily_201305_excel_writer,'13_1',index=False)
daily_201305_excel_writer.save()
daily_20130514 = pro.daily(start_date='',end_date='',trade_date='20130514', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20130514_tscode_list = list() 
for ts_code_sh in daily_20130514['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20130514_tscode_list.append(stock_name)
daily_20130514_addname_dataframe=pd.DataFrame()
daily_20130514_addname_dataframe['cname'] = daily_20130514_tscode_list
for table_name in daily_20130514.columns.values.tolist():
    daily_20130514_addname_dataframe[table_name] = daily_20130514[table_name]
print("日线行情-时间为序  daily_20130514 返回数据 row 行数 = "+str(daily_20130514.shape[0]))
daily_20130514_addname_dataframe.to_excel(daily_201305_excel_writer,'14_2',index=False)
daily_201305_excel_writer.save()
daily_20130515 = pro.daily(start_date='',end_date='',trade_date='20130515', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20130515_tscode_list = list() 
for ts_code_sh in daily_20130515['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20130515_tscode_list.append(stock_name)
daily_20130515_addname_dataframe=pd.DataFrame()
daily_20130515_addname_dataframe['cname'] = daily_20130515_tscode_list
for table_name in daily_20130515.columns.values.tolist():
    daily_20130515_addname_dataframe[table_name] = daily_20130515[table_name]
print("日线行情-时间为序  daily_20130515 返回数据 row 行数 = "+str(daily_20130515.shape[0]))
daily_20130515_addname_dataframe.to_excel(daily_201305_excel_writer,'15_3',index=False)
daily_201305_excel_writer.save()
daily_20130516 = pro.daily(start_date='',end_date='',trade_date='20130516', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20130516_tscode_list = list() 
for ts_code_sh in daily_20130516['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20130516_tscode_list.append(stock_name)
daily_20130516_addname_dataframe=pd.DataFrame()
daily_20130516_addname_dataframe['cname'] = daily_20130516_tscode_list
for table_name in daily_20130516.columns.values.tolist():
    daily_20130516_addname_dataframe[table_name] = daily_20130516[table_name]
print("日线行情-时间为序  daily_20130516 返回数据 row 行数 = "+str(daily_20130516.shape[0]))
daily_20130516_addname_dataframe.to_excel(daily_201305_excel_writer,'16_4',index=False)
daily_201305_excel_writer.save()
daily_20130517 = pro.daily(start_date='',end_date='',trade_date='20130517', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20130517_tscode_list = list() 
for ts_code_sh in daily_20130517['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20130517_tscode_list.append(stock_name)
daily_20130517_addname_dataframe=pd.DataFrame()
daily_20130517_addname_dataframe['cname'] = daily_20130517_tscode_list
for table_name in daily_20130517.columns.values.tolist():
    daily_20130517_addname_dataframe[table_name] = daily_20130517[table_name]
print("日线行情-时间为序  daily_20130517 返回数据 row 行数 = "+str(daily_20130517.shape[0]))
daily_20130517_addname_dataframe.to_excel(daily_201305_excel_writer,'17_5',index=False)
daily_201305_excel_writer.save()
daily_20130520 = pro.daily(start_date='',end_date='',trade_date='20130520', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20130520_tscode_list = list() 
for ts_code_sh in daily_20130520['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20130520_tscode_list.append(stock_name)
daily_20130520_addname_dataframe=pd.DataFrame()
daily_20130520_addname_dataframe['cname'] = daily_20130520_tscode_list
for table_name in daily_20130520.columns.values.tolist():
    daily_20130520_addname_dataframe[table_name] = daily_20130520[table_name]
print("日线行情-时间为序  daily_20130520 返回数据 row 行数 = "+str(daily_20130520.shape[0]))
daily_20130520_addname_dataframe.to_excel(daily_201305_excel_writer,'20_1',index=False)
daily_201305_excel_writer.save()
daily_20130521 = pro.daily(start_date='',end_date='',trade_date='20130521', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20130521_tscode_list = list() 
for ts_code_sh in daily_20130521['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20130521_tscode_list.append(stock_name)
daily_20130521_addname_dataframe=pd.DataFrame()
daily_20130521_addname_dataframe['cname'] = daily_20130521_tscode_list
for table_name in daily_20130521.columns.values.tolist():
    daily_20130521_addname_dataframe[table_name] = daily_20130521[table_name]
print("日线行情-时间为序  daily_20130521 返回数据 row 行数 = "+str(daily_20130521.shape[0]))
daily_20130521_addname_dataframe.to_excel(daily_201305_excel_writer,'21_2',index=False)
daily_201305_excel_writer.save()
daily_20130522 = pro.daily(start_date='',end_date='',trade_date='20130522', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20130522_tscode_list = list() 
for ts_code_sh in daily_20130522['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20130522_tscode_list.append(stock_name)
daily_20130522_addname_dataframe=pd.DataFrame()
daily_20130522_addname_dataframe['cname'] = daily_20130522_tscode_list
for table_name in daily_20130522.columns.values.tolist():
    daily_20130522_addname_dataframe[table_name] = daily_20130522[table_name]
print("日线行情-时间为序  daily_20130522 返回数据 row 行数 = "+str(daily_20130522.shape[0]))
daily_20130522_addname_dataframe.to_excel(daily_201305_excel_writer,'22_3',index=False)
daily_201305_excel_writer.save()
daily_20130523 = pro.daily(start_date='',end_date='',trade_date='20130523', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20130523_tscode_list = list() 
for ts_code_sh in daily_20130523['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20130523_tscode_list.append(stock_name)
daily_20130523_addname_dataframe=pd.DataFrame()
daily_20130523_addname_dataframe['cname'] = daily_20130523_tscode_list
for table_name in daily_20130523.columns.values.tolist():
    daily_20130523_addname_dataframe[table_name] = daily_20130523[table_name]
print("日线行情-时间为序  daily_20130523 返回数据 row 行数 = "+str(daily_20130523.shape[0]))
daily_20130523_addname_dataframe.to_excel(daily_201305_excel_writer,'23_4',index=False)
daily_201305_excel_writer.save()
daily_20130524 = pro.daily(start_date='',end_date='',trade_date='20130524', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20130524_tscode_list = list() 
for ts_code_sh in daily_20130524['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20130524_tscode_list.append(stock_name)
daily_20130524_addname_dataframe=pd.DataFrame()
daily_20130524_addname_dataframe['cname'] = daily_20130524_tscode_list
for table_name in daily_20130524.columns.values.tolist():
    daily_20130524_addname_dataframe[table_name] = daily_20130524[table_name]
print("日线行情-时间为序  daily_20130524 返回数据 row 行数 = "+str(daily_20130524.shape[0]))
daily_20130524_addname_dataframe.to_excel(daily_201305_excel_writer,'24_5',index=False)
daily_201305_excel_writer.save()
daily_20130527 = pro.daily(start_date='',end_date='',trade_date='20130527', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20130527_tscode_list = list() 
for ts_code_sh in daily_20130527['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20130527_tscode_list.append(stock_name)
daily_20130527_addname_dataframe=pd.DataFrame()
daily_20130527_addname_dataframe['cname'] = daily_20130527_tscode_list
for table_name in daily_20130527.columns.values.tolist():
    daily_20130527_addname_dataframe[table_name] = daily_20130527[table_name]
print("日线行情-时间为序  daily_20130527 返回数据 row 行数 = "+str(daily_20130527.shape[0]))
daily_20130527_addname_dataframe.to_excel(daily_201305_excel_writer,'27_1',index=False)
daily_201305_excel_writer.save()
daily_20130528 = pro.daily(start_date='',end_date='',trade_date='20130528', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20130528_tscode_list = list() 
for ts_code_sh in daily_20130528['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20130528_tscode_list.append(stock_name)
daily_20130528_addname_dataframe=pd.DataFrame()
daily_20130528_addname_dataframe['cname'] = daily_20130528_tscode_list
for table_name in daily_20130528.columns.values.tolist():
    daily_20130528_addname_dataframe[table_name] = daily_20130528[table_name]
print("日线行情-时间为序  daily_20130528 返回数据 row 行数 = "+str(daily_20130528.shape[0]))
daily_20130528_addname_dataframe.to_excel(daily_201305_excel_writer,'28_2',index=False)
daily_201305_excel_writer.save()
daily_20130529 = pro.daily(start_date='',end_date='',trade_date='20130529', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20130529_tscode_list = list() 
for ts_code_sh in daily_20130529['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20130529_tscode_list.append(stock_name)
daily_20130529_addname_dataframe=pd.DataFrame()
daily_20130529_addname_dataframe['cname'] = daily_20130529_tscode_list
for table_name in daily_20130529.columns.values.tolist():
    daily_20130529_addname_dataframe[table_name] = daily_20130529[table_name]
print("日线行情-时间为序  daily_20130529 返回数据 row 行数 = "+str(daily_20130529.shape[0]))
daily_20130529_addname_dataframe.to_excel(daily_201305_excel_writer,'29_3',index=False)
daily_201305_excel_writer.save()
daily_20130530 = pro.daily(start_date='',end_date='',trade_date='20130530', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20130530_tscode_list = list() 
for ts_code_sh in daily_20130530['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20130530_tscode_list.append(stock_name)
daily_20130530_addname_dataframe=pd.DataFrame()
daily_20130530_addname_dataframe['cname'] = daily_20130530_tscode_list
for table_name in daily_20130530.columns.values.tolist():
    daily_20130530_addname_dataframe[table_name] = daily_20130530[table_name]
print("日线行情-时间为序  daily_20130530 返回数据 row 行数 = "+str(daily_20130530.shape[0]))
daily_20130530_addname_dataframe.to_excel(daily_201305_excel_writer,'30_4',index=False)
daily_201305_excel_writer.save()
daily_20130531 = pro.daily(start_date='',end_date='',trade_date='20130531', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20130531_tscode_list = list() 
for ts_code_sh in daily_20130531['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20130531_tscode_list.append(stock_name)
daily_20130531_addname_dataframe=pd.DataFrame()
daily_20130531_addname_dataframe['cname'] = daily_20130531_tscode_list
for table_name in daily_20130531.columns.values.tolist():
    daily_20130531_addname_dataframe[table_name] = daily_20130531[table_name]
print("日线行情-时间为序  daily_20130531 返回数据 row 行数 = "+str(daily_20130531.shape[0]))
daily_20130531_addname_dataframe.to_excel(daily_201305_excel_writer,'31_5',index=False)
daily_201305_excel_writer.save()




createexcel('daily_201306.xlsx')
daily_201306_book = load_workbook('C:\\Users\\zhuzj5\\Desktop\\zbin\\J0_Data\\daily_201306.xlsx')
daily_201306_excel_writer = pd.ExcelWriter('C:\\Users\\zhuzj5\\Desktop\\zbin\\J0_Data\\daily_201306.xlsx', engine='openpyxl')
daily_201306_excel_writer.book = daily_201306_book
daily_201306_excel_writer.sheets = dict((ws.title, ws) for ws in daily_201306_book.worksheets)
J0_PROPS.put(tree_node_name+"record_date", "20130601")       ###  更新 记录日期
daily_20130603 = pro.daily(start_date='',end_date='',trade_date='20130603', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20130603_tscode_list = list() 
for ts_code_sh in daily_20130603['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20130603_tscode_list.append(stock_name)
daily_20130603_addname_dataframe=pd.DataFrame()
daily_20130603_addname_dataframe['cname'] = daily_20130603_tscode_list
for table_name in daily_20130603.columns.values.tolist():
    daily_20130603_addname_dataframe[table_name] = daily_20130603[table_name]
print("日线行情-时间为序  daily_20130603 返回数据 row 行数 = "+str(daily_20130603.shape[0]))
daily_20130603_addname_dataframe.to_excel(daily_201306_excel_writer,'3_1',index=False)
daily_201306_excel_writer.save()
daily_20130604 = pro.daily(start_date='',end_date='',trade_date='20130604', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20130604_tscode_list = list() 
for ts_code_sh in daily_20130604['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20130604_tscode_list.append(stock_name)
daily_20130604_addname_dataframe=pd.DataFrame()
daily_20130604_addname_dataframe['cname'] = daily_20130604_tscode_list
for table_name in daily_20130604.columns.values.tolist():
    daily_20130604_addname_dataframe[table_name] = daily_20130604[table_name]
print("日线行情-时间为序  daily_20130604 返回数据 row 行数 = "+str(daily_20130604.shape[0]))
daily_20130604_addname_dataframe.to_excel(daily_201306_excel_writer,'4_2',index=False)
daily_201306_excel_writer.save()
daily_20130605 = pro.daily(start_date='',end_date='',trade_date='20130605', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20130605_tscode_list = list() 
for ts_code_sh in daily_20130605['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20130605_tscode_list.append(stock_name)
daily_20130605_addname_dataframe=pd.DataFrame()
daily_20130605_addname_dataframe['cname'] = daily_20130605_tscode_list
for table_name in daily_20130605.columns.values.tolist():
    daily_20130605_addname_dataframe[table_name] = daily_20130605[table_name]
print("日线行情-时间为序  daily_20130605 返回数据 row 行数 = "+str(daily_20130605.shape[0]))
daily_20130605_addname_dataframe.to_excel(daily_201306_excel_writer,'5_3',index=False)
daily_201306_excel_writer.save()
daily_20130606 = pro.daily(start_date='',end_date='',trade_date='20130606', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20130606_tscode_list = list() 
for ts_code_sh in daily_20130606['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20130606_tscode_list.append(stock_name)
daily_20130606_addname_dataframe=pd.DataFrame()
daily_20130606_addname_dataframe['cname'] = daily_20130606_tscode_list
for table_name in daily_20130606.columns.values.tolist():
    daily_20130606_addname_dataframe[table_name] = daily_20130606[table_name]
print("日线行情-时间为序  daily_20130606 返回数据 row 行数 = "+str(daily_20130606.shape[0]))
daily_20130606_addname_dataframe.to_excel(daily_201306_excel_writer,'6_4',index=False)
daily_201306_excel_writer.save()
daily_20130607 = pro.daily(start_date='',end_date='',trade_date='20130607', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20130607_tscode_list = list() 
for ts_code_sh in daily_20130607['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20130607_tscode_list.append(stock_name)
daily_20130607_addname_dataframe=pd.DataFrame()
daily_20130607_addname_dataframe['cname'] = daily_20130607_tscode_list
for table_name in daily_20130607.columns.values.tolist():
    daily_20130607_addname_dataframe[table_name] = daily_20130607[table_name]
print("日线行情-时间为序  daily_20130607 返回数据 row 行数 = "+str(daily_20130607.shape[0]))
daily_20130607_addname_dataframe.to_excel(daily_201306_excel_writer,'7_5',index=False)
daily_201306_excel_writer.save()
daily_20130613 = pro.daily(start_date='',end_date='',trade_date='20130613', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20130613_tscode_list = list() 
for ts_code_sh in daily_20130613['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20130613_tscode_list.append(stock_name)
daily_20130613_addname_dataframe=pd.DataFrame()
daily_20130613_addname_dataframe['cname'] = daily_20130613_tscode_list
for table_name in daily_20130613.columns.values.tolist():
    daily_20130613_addname_dataframe[table_name] = daily_20130613[table_name]
print("日线行情-时间为序  daily_20130613 返回数据 row 行数 = "+str(daily_20130613.shape[0]))
daily_20130613_addname_dataframe.to_excel(daily_201306_excel_writer,'13_4',index=False)
daily_201306_excel_writer.save()
daily_20130614 = pro.daily(start_date='',end_date='',trade_date='20130614', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20130614_tscode_list = list() 
for ts_code_sh in daily_20130614['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20130614_tscode_list.append(stock_name)
daily_20130614_addname_dataframe=pd.DataFrame()
daily_20130614_addname_dataframe['cname'] = daily_20130614_tscode_list
for table_name in daily_20130614.columns.values.tolist():
    daily_20130614_addname_dataframe[table_name] = daily_20130614[table_name]
print("日线行情-时间为序  daily_20130614 返回数据 row 行数 = "+str(daily_20130614.shape[0]))
daily_20130614_addname_dataframe.to_excel(daily_201306_excel_writer,'14_5',index=False)
daily_201306_excel_writer.save()
daily_20130617 = pro.daily(start_date='',end_date='',trade_date='20130617', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20130617_tscode_list = list() 
for ts_code_sh in daily_20130617['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20130617_tscode_list.append(stock_name)
daily_20130617_addname_dataframe=pd.DataFrame()
daily_20130617_addname_dataframe['cname'] = daily_20130617_tscode_list
for table_name in daily_20130617.columns.values.tolist():
    daily_20130617_addname_dataframe[table_name] = daily_20130617[table_name]
print("日线行情-时间为序  daily_20130617 返回数据 row 行数 = "+str(daily_20130617.shape[0]))
daily_20130617_addname_dataframe.to_excel(daily_201306_excel_writer,'17_1',index=False)
daily_201306_excel_writer.save()
daily_20130618 = pro.daily(start_date='',end_date='',trade_date='20130618', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20130618_tscode_list = list() 
for ts_code_sh in daily_20130618['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20130618_tscode_list.append(stock_name)
daily_20130618_addname_dataframe=pd.DataFrame()
daily_20130618_addname_dataframe['cname'] = daily_20130618_tscode_list
for table_name in daily_20130618.columns.values.tolist():
    daily_20130618_addname_dataframe[table_name] = daily_20130618[table_name]
print("日线行情-时间为序  daily_20130618 返回数据 row 行数 = "+str(daily_20130618.shape[0]))
daily_20130618_addname_dataframe.to_excel(daily_201306_excel_writer,'18_2',index=False)
daily_201306_excel_writer.save()
daily_20130619 = pro.daily(start_date='',end_date='',trade_date='20130619', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20130619_tscode_list = list() 
for ts_code_sh in daily_20130619['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20130619_tscode_list.append(stock_name)
daily_20130619_addname_dataframe=pd.DataFrame()
daily_20130619_addname_dataframe['cname'] = daily_20130619_tscode_list
for table_name in daily_20130619.columns.values.tolist():
    daily_20130619_addname_dataframe[table_name] = daily_20130619[table_name]
print("日线行情-时间为序  daily_20130619 返回数据 row 行数 = "+str(daily_20130619.shape[0]))
daily_20130619_addname_dataframe.to_excel(daily_201306_excel_writer,'19_3',index=False)
daily_201306_excel_writer.save()
daily_20130620 = pro.daily(start_date='',end_date='',trade_date='20130620', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20130620_tscode_list = list() 
for ts_code_sh in daily_20130620['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20130620_tscode_list.append(stock_name)
daily_20130620_addname_dataframe=pd.DataFrame()
daily_20130620_addname_dataframe['cname'] = daily_20130620_tscode_list
for table_name in daily_20130620.columns.values.tolist():
    daily_20130620_addname_dataframe[table_name] = daily_20130620[table_name]
print("日线行情-时间为序  daily_20130620 返回数据 row 行数 = "+str(daily_20130620.shape[0]))
daily_20130620_addname_dataframe.to_excel(daily_201306_excel_writer,'20_4',index=False)
daily_201306_excel_writer.save()
daily_20130621 = pro.daily(start_date='',end_date='',trade_date='20130621', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20130621_tscode_list = list() 
for ts_code_sh in daily_20130621['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20130621_tscode_list.append(stock_name)
daily_20130621_addname_dataframe=pd.DataFrame()
daily_20130621_addname_dataframe['cname'] = daily_20130621_tscode_list
for table_name in daily_20130621.columns.values.tolist():
    daily_20130621_addname_dataframe[table_name] = daily_20130621[table_name]
print("日线行情-时间为序  daily_20130621 返回数据 row 行数 = "+str(daily_20130621.shape[0]))
daily_20130621_addname_dataframe.to_excel(daily_201306_excel_writer,'21_5',index=False)
daily_201306_excel_writer.save()
daily_20130624 = pro.daily(start_date='',end_date='',trade_date='20130624', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20130624_tscode_list = list() 
for ts_code_sh in daily_20130624['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20130624_tscode_list.append(stock_name)
daily_20130624_addname_dataframe=pd.DataFrame()
daily_20130624_addname_dataframe['cname'] = daily_20130624_tscode_list
for table_name in daily_20130624.columns.values.tolist():
    daily_20130624_addname_dataframe[table_name] = daily_20130624[table_name]
print("日线行情-时间为序  daily_20130624 返回数据 row 行数 = "+str(daily_20130624.shape[0]))
daily_20130624_addname_dataframe.to_excel(daily_201306_excel_writer,'24_1',index=False)
daily_201306_excel_writer.save()
daily_20130625 = pro.daily(start_date='',end_date='',trade_date='20130625', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20130625_tscode_list = list() 
for ts_code_sh in daily_20130625['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20130625_tscode_list.append(stock_name)
daily_20130625_addname_dataframe=pd.DataFrame()
daily_20130625_addname_dataframe['cname'] = daily_20130625_tscode_list
for table_name in daily_20130625.columns.values.tolist():
    daily_20130625_addname_dataframe[table_name] = daily_20130625[table_name]
print("日线行情-时间为序  daily_20130625 返回数据 row 行数 = "+str(daily_20130625.shape[0]))
daily_20130625_addname_dataframe.to_excel(daily_201306_excel_writer,'25_2',index=False)
daily_201306_excel_writer.save()
daily_20130626 = pro.daily(start_date='',end_date='',trade_date='20130626', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20130626_tscode_list = list() 
for ts_code_sh in daily_20130626['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20130626_tscode_list.append(stock_name)
daily_20130626_addname_dataframe=pd.DataFrame()
daily_20130626_addname_dataframe['cname'] = daily_20130626_tscode_list
for table_name in daily_20130626.columns.values.tolist():
    daily_20130626_addname_dataframe[table_name] = daily_20130626[table_name]
print("日线行情-时间为序  daily_20130626 返回数据 row 行数 = "+str(daily_20130626.shape[0]))
daily_20130626_addname_dataframe.to_excel(daily_201306_excel_writer,'26_3',index=False)
daily_201306_excel_writer.save()
daily_20130627 = pro.daily(start_date='',end_date='',trade_date='20130627', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20130627_tscode_list = list() 
for ts_code_sh in daily_20130627['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20130627_tscode_list.append(stock_name)
daily_20130627_addname_dataframe=pd.DataFrame()
daily_20130627_addname_dataframe['cname'] = daily_20130627_tscode_list
for table_name in daily_20130627.columns.values.tolist():
    daily_20130627_addname_dataframe[table_name] = daily_20130627[table_name]
print("日线行情-时间为序  daily_20130627 返回数据 row 行数 = "+str(daily_20130627.shape[0]))
daily_20130627_addname_dataframe.to_excel(daily_201306_excel_writer,'27_4',index=False)
daily_201306_excel_writer.save()
daily_20130628 = pro.daily(start_date='',end_date='',trade_date='20130628', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20130628_tscode_list = list() 
for ts_code_sh in daily_20130628['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20130628_tscode_list.append(stock_name)
daily_20130628_addname_dataframe=pd.DataFrame()
daily_20130628_addname_dataframe['cname'] = daily_20130628_tscode_list
for table_name in daily_20130628.columns.values.tolist():
    daily_20130628_addname_dataframe[table_name] = daily_20130628[table_name]
print("日线行情-时间为序  daily_20130628 返回数据 row 行数 = "+str(daily_20130628.shape[0]))
daily_20130628_addname_dataframe.to_excel(daily_201306_excel_writer,'28_5',index=False)
daily_201306_excel_writer.save()




createexcel('daily_201307.xlsx')
daily_201307_book = load_workbook('C:\\Users\\zhuzj5\\Desktop\\zbin\\J0_Data\\daily_201307.xlsx')
daily_201307_excel_writer = pd.ExcelWriter('C:\\Users\\zhuzj5\\Desktop\\zbin\\J0_Data\\daily_201307.xlsx', engine='openpyxl')
daily_201307_excel_writer.book = daily_201307_book
daily_201307_excel_writer.sheets = dict((ws.title, ws) for ws in daily_201307_book.worksheets)
J0_PROPS.put(tree_node_name+"record_date", "20130701")       ###  更新 记录日期
daily_20130701 = pro.daily(start_date='',end_date='',trade_date='20130701', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20130701_tscode_list = list() 
for ts_code_sh in daily_20130701['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20130701_tscode_list.append(stock_name)
daily_20130701_addname_dataframe=pd.DataFrame()
daily_20130701_addname_dataframe['cname'] = daily_20130701_tscode_list
for table_name in daily_20130701.columns.values.tolist():
    daily_20130701_addname_dataframe[table_name] = daily_20130701[table_name]
print("日线行情-时间为序  daily_20130701 返回数据 row 行数 = "+str(daily_20130701.shape[0]))
daily_20130701_addname_dataframe.to_excel(daily_201307_excel_writer,'1_1',index=False)
daily_201307_excel_writer.save()
daily_20130702 = pro.daily(start_date='',end_date='',trade_date='20130702', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20130702_tscode_list = list() 
for ts_code_sh in daily_20130702['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20130702_tscode_list.append(stock_name)
daily_20130702_addname_dataframe=pd.DataFrame()
daily_20130702_addname_dataframe['cname'] = daily_20130702_tscode_list
for table_name in daily_20130702.columns.values.tolist():
    daily_20130702_addname_dataframe[table_name] = daily_20130702[table_name]
print("日线行情-时间为序  daily_20130702 返回数据 row 行数 = "+str(daily_20130702.shape[0]))
daily_20130702_addname_dataframe.to_excel(daily_201307_excel_writer,'2_2',index=False)
daily_201307_excel_writer.save()
daily_20130703 = pro.daily(start_date='',end_date='',trade_date='20130703', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20130703_tscode_list = list() 
for ts_code_sh in daily_20130703['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20130703_tscode_list.append(stock_name)
daily_20130703_addname_dataframe=pd.DataFrame()
daily_20130703_addname_dataframe['cname'] = daily_20130703_tscode_list
for table_name in daily_20130703.columns.values.tolist():
    daily_20130703_addname_dataframe[table_name] = daily_20130703[table_name]
print("日线行情-时间为序  daily_20130703 返回数据 row 行数 = "+str(daily_20130703.shape[0]))
daily_20130703_addname_dataframe.to_excel(daily_201307_excel_writer,'3_3',index=False)
daily_201307_excel_writer.save()
daily_20130704 = pro.daily(start_date='',end_date='',trade_date='20130704', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20130704_tscode_list = list() 
for ts_code_sh in daily_20130704['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20130704_tscode_list.append(stock_name)
daily_20130704_addname_dataframe=pd.DataFrame()
daily_20130704_addname_dataframe['cname'] = daily_20130704_tscode_list
for table_name in daily_20130704.columns.values.tolist():
    daily_20130704_addname_dataframe[table_name] = daily_20130704[table_name]
print("日线行情-时间为序  daily_20130704 返回数据 row 行数 = "+str(daily_20130704.shape[0]))
daily_20130704_addname_dataframe.to_excel(daily_201307_excel_writer,'4_4',index=False)
daily_201307_excel_writer.save()
daily_20130705 = pro.daily(start_date='',end_date='',trade_date='20130705', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20130705_tscode_list = list() 
for ts_code_sh in daily_20130705['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20130705_tscode_list.append(stock_name)
daily_20130705_addname_dataframe=pd.DataFrame()
daily_20130705_addname_dataframe['cname'] = daily_20130705_tscode_list
for table_name in daily_20130705.columns.values.tolist():
    daily_20130705_addname_dataframe[table_name] = daily_20130705[table_name]
print("日线行情-时间为序  daily_20130705 返回数据 row 行数 = "+str(daily_20130705.shape[0]))
daily_20130705_addname_dataframe.to_excel(daily_201307_excel_writer,'5_5',index=False)
daily_201307_excel_writer.save()
daily_20130708 = pro.daily(start_date='',end_date='',trade_date='20130708', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20130708_tscode_list = list() 
for ts_code_sh in daily_20130708['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20130708_tscode_list.append(stock_name)
daily_20130708_addname_dataframe=pd.DataFrame()
daily_20130708_addname_dataframe['cname'] = daily_20130708_tscode_list
for table_name in daily_20130708.columns.values.tolist():
    daily_20130708_addname_dataframe[table_name] = daily_20130708[table_name]
print("日线行情-时间为序  daily_20130708 返回数据 row 行数 = "+str(daily_20130708.shape[0]))
daily_20130708_addname_dataframe.to_excel(daily_201307_excel_writer,'8_1',index=False)
daily_201307_excel_writer.save()
daily_20130709 = pro.daily(start_date='',end_date='',trade_date='20130709', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20130709_tscode_list = list() 
for ts_code_sh in daily_20130709['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20130709_tscode_list.append(stock_name)
daily_20130709_addname_dataframe=pd.DataFrame()
daily_20130709_addname_dataframe['cname'] = daily_20130709_tscode_list
for table_name in daily_20130709.columns.values.tolist():
    daily_20130709_addname_dataframe[table_name] = daily_20130709[table_name]
print("日线行情-时间为序  daily_20130709 返回数据 row 行数 = "+str(daily_20130709.shape[0]))
daily_20130709_addname_dataframe.to_excel(daily_201307_excel_writer,'9_2',index=False)
daily_201307_excel_writer.save()
daily_20130710 = pro.daily(start_date='',end_date='',trade_date='20130710', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20130710_tscode_list = list() 
for ts_code_sh in daily_20130710['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20130710_tscode_list.append(stock_name)
daily_20130710_addname_dataframe=pd.DataFrame()
daily_20130710_addname_dataframe['cname'] = daily_20130710_tscode_list
for table_name in daily_20130710.columns.values.tolist():
    daily_20130710_addname_dataframe[table_name] = daily_20130710[table_name]
print("日线行情-时间为序  daily_20130710 返回数据 row 行数 = "+str(daily_20130710.shape[0]))
daily_20130710_addname_dataframe.to_excel(daily_201307_excel_writer,'10_3',index=False)
daily_201307_excel_writer.save()
daily_20130711 = pro.daily(start_date='',end_date='',trade_date='20130711', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20130711_tscode_list = list() 
for ts_code_sh in daily_20130711['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20130711_tscode_list.append(stock_name)
daily_20130711_addname_dataframe=pd.DataFrame()
daily_20130711_addname_dataframe['cname'] = daily_20130711_tscode_list
for table_name in daily_20130711.columns.values.tolist():
    daily_20130711_addname_dataframe[table_name] = daily_20130711[table_name]
print("日线行情-时间为序  daily_20130711 返回数据 row 行数 = "+str(daily_20130711.shape[0]))
daily_20130711_addname_dataframe.to_excel(daily_201307_excel_writer,'11_4',index=False)
daily_201307_excel_writer.save()
daily_20130712 = pro.daily(start_date='',end_date='',trade_date='20130712', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20130712_tscode_list = list() 
for ts_code_sh in daily_20130712['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20130712_tscode_list.append(stock_name)
daily_20130712_addname_dataframe=pd.DataFrame()
daily_20130712_addname_dataframe['cname'] = daily_20130712_tscode_list
for table_name in daily_20130712.columns.values.tolist():
    daily_20130712_addname_dataframe[table_name] = daily_20130712[table_name]
print("日线行情-时间为序  daily_20130712 返回数据 row 行数 = "+str(daily_20130712.shape[0]))
daily_20130712_addname_dataframe.to_excel(daily_201307_excel_writer,'12_5',index=False)
daily_201307_excel_writer.save()
daily_20130715 = pro.daily(start_date='',end_date='',trade_date='20130715', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20130715_tscode_list = list() 
for ts_code_sh in daily_20130715['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20130715_tscode_list.append(stock_name)
daily_20130715_addname_dataframe=pd.DataFrame()
daily_20130715_addname_dataframe['cname'] = daily_20130715_tscode_list
for table_name in daily_20130715.columns.values.tolist():
    daily_20130715_addname_dataframe[table_name] = daily_20130715[table_name]
print("日线行情-时间为序  daily_20130715 返回数据 row 行数 = "+str(daily_20130715.shape[0]))
daily_20130715_addname_dataframe.to_excel(daily_201307_excel_writer,'15_1',index=False)
daily_201307_excel_writer.save()
daily_20130716 = pro.daily(start_date='',end_date='',trade_date='20130716', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20130716_tscode_list = list() 
for ts_code_sh in daily_20130716['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20130716_tscode_list.append(stock_name)
daily_20130716_addname_dataframe=pd.DataFrame()
daily_20130716_addname_dataframe['cname'] = daily_20130716_tscode_list
for table_name in daily_20130716.columns.values.tolist():
    daily_20130716_addname_dataframe[table_name] = daily_20130716[table_name]
print("日线行情-时间为序  daily_20130716 返回数据 row 行数 = "+str(daily_20130716.shape[0]))
daily_20130716_addname_dataframe.to_excel(daily_201307_excel_writer,'16_2',index=False)
daily_201307_excel_writer.save()
daily_20130717 = pro.daily(start_date='',end_date='',trade_date='20130717', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20130717_tscode_list = list() 
for ts_code_sh in daily_20130717['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20130717_tscode_list.append(stock_name)
daily_20130717_addname_dataframe=pd.DataFrame()
daily_20130717_addname_dataframe['cname'] = daily_20130717_tscode_list
for table_name in daily_20130717.columns.values.tolist():
    daily_20130717_addname_dataframe[table_name] = daily_20130717[table_name]
print("日线行情-时间为序  daily_20130717 返回数据 row 行数 = "+str(daily_20130717.shape[0]))
daily_20130717_addname_dataframe.to_excel(daily_201307_excel_writer,'17_3',index=False)
daily_201307_excel_writer.save()
daily_20130718 = pro.daily(start_date='',end_date='',trade_date='20130718', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20130718_tscode_list = list() 
for ts_code_sh in daily_20130718['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20130718_tscode_list.append(stock_name)
daily_20130718_addname_dataframe=pd.DataFrame()
daily_20130718_addname_dataframe['cname'] = daily_20130718_tscode_list
for table_name in daily_20130718.columns.values.tolist():
    daily_20130718_addname_dataframe[table_name] = daily_20130718[table_name]
print("日线行情-时间为序  daily_20130718 返回数据 row 行数 = "+str(daily_20130718.shape[0]))
daily_20130718_addname_dataframe.to_excel(daily_201307_excel_writer,'18_4',index=False)
daily_201307_excel_writer.save()
daily_20130719 = pro.daily(start_date='',end_date='',trade_date='20130719', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20130719_tscode_list = list() 
for ts_code_sh in daily_20130719['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20130719_tscode_list.append(stock_name)
daily_20130719_addname_dataframe=pd.DataFrame()
daily_20130719_addname_dataframe['cname'] = daily_20130719_tscode_list
for table_name in daily_20130719.columns.values.tolist():
    daily_20130719_addname_dataframe[table_name] = daily_20130719[table_name]
print("日线行情-时间为序  daily_20130719 返回数据 row 行数 = "+str(daily_20130719.shape[0]))
daily_20130719_addname_dataframe.to_excel(daily_201307_excel_writer,'19_5',index=False)
daily_201307_excel_writer.save()
daily_20130722 = pro.daily(start_date='',end_date='',trade_date='20130722', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20130722_tscode_list = list() 
for ts_code_sh in daily_20130722['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20130722_tscode_list.append(stock_name)
daily_20130722_addname_dataframe=pd.DataFrame()
daily_20130722_addname_dataframe['cname'] = daily_20130722_tscode_list
for table_name in daily_20130722.columns.values.tolist():
    daily_20130722_addname_dataframe[table_name] = daily_20130722[table_name]
print("日线行情-时间为序  daily_20130722 返回数据 row 行数 = "+str(daily_20130722.shape[0]))
daily_20130722_addname_dataframe.to_excel(daily_201307_excel_writer,'22_1',index=False)
daily_201307_excel_writer.save()
daily_20130723 = pro.daily(start_date='',end_date='',trade_date='20130723', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20130723_tscode_list = list() 
for ts_code_sh in daily_20130723['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20130723_tscode_list.append(stock_name)
daily_20130723_addname_dataframe=pd.DataFrame()
daily_20130723_addname_dataframe['cname'] = daily_20130723_tscode_list
for table_name in daily_20130723.columns.values.tolist():
    daily_20130723_addname_dataframe[table_name] = daily_20130723[table_name]
print("日线行情-时间为序  daily_20130723 返回数据 row 行数 = "+str(daily_20130723.shape[0]))
daily_20130723_addname_dataframe.to_excel(daily_201307_excel_writer,'23_2',index=False)
daily_201307_excel_writer.save()
daily_20130724 = pro.daily(start_date='',end_date='',trade_date='20130724', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20130724_tscode_list = list() 
for ts_code_sh in daily_20130724['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20130724_tscode_list.append(stock_name)
daily_20130724_addname_dataframe=pd.DataFrame()
daily_20130724_addname_dataframe['cname'] = daily_20130724_tscode_list
for table_name in daily_20130724.columns.values.tolist():
    daily_20130724_addname_dataframe[table_name] = daily_20130724[table_name]
print("日线行情-时间为序  daily_20130724 返回数据 row 行数 = "+str(daily_20130724.shape[0]))
daily_20130724_addname_dataframe.to_excel(daily_201307_excel_writer,'24_3',index=False)
daily_201307_excel_writer.save()
daily_20130725 = pro.daily(start_date='',end_date='',trade_date='20130725', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20130725_tscode_list = list() 
for ts_code_sh in daily_20130725['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20130725_tscode_list.append(stock_name)
daily_20130725_addname_dataframe=pd.DataFrame()
daily_20130725_addname_dataframe['cname'] = daily_20130725_tscode_list
for table_name in daily_20130725.columns.values.tolist():
    daily_20130725_addname_dataframe[table_name] = daily_20130725[table_name]
print("日线行情-时间为序  daily_20130725 返回数据 row 行数 = "+str(daily_20130725.shape[0]))
daily_20130725_addname_dataframe.to_excel(daily_201307_excel_writer,'25_4',index=False)
daily_201307_excel_writer.save()
daily_20130726 = pro.daily(start_date='',end_date='',trade_date='20130726', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20130726_tscode_list = list() 
for ts_code_sh in daily_20130726['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20130726_tscode_list.append(stock_name)
daily_20130726_addname_dataframe=pd.DataFrame()
daily_20130726_addname_dataframe['cname'] = daily_20130726_tscode_list
for table_name in daily_20130726.columns.values.tolist():
    daily_20130726_addname_dataframe[table_name] = daily_20130726[table_name]
print("日线行情-时间为序  daily_20130726 返回数据 row 行数 = "+str(daily_20130726.shape[0]))
daily_20130726_addname_dataframe.to_excel(daily_201307_excel_writer,'26_5',index=False)
daily_201307_excel_writer.save()
daily_20130729 = pro.daily(start_date='',end_date='',trade_date='20130729', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20130729_tscode_list = list() 
for ts_code_sh in daily_20130729['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20130729_tscode_list.append(stock_name)
daily_20130729_addname_dataframe=pd.DataFrame()
daily_20130729_addname_dataframe['cname'] = daily_20130729_tscode_list
for table_name in daily_20130729.columns.values.tolist():
    daily_20130729_addname_dataframe[table_name] = daily_20130729[table_name]
print("日线行情-时间为序  daily_20130729 返回数据 row 行数 = "+str(daily_20130729.shape[0]))
daily_20130729_addname_dataframe.to_excel(daily_201307_excel_writer,'29_1',index=False)
daily_201307_excel_writer.save()
daily_20130730 = pro.daily(start_date='',end_date='',trade_date='20130730', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20130730_tscode_list = list() 
for ts_code_sh in daily_20130730['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20130730_tscode_list.append(stock_name)
daily_20130730_addname_dataframe=pd.DataFrame()
daily_20130730_addname_dataframe['cname'] = daily_20130730_tscode_list
for table_name in daily_20130730.columns.values.tolist():
    daily_20130730_addname_dataframe[table_name] = daily_20130730[table_name]
print("日线行情-时间为序  daily_20130730 返回数据 row 行数 = "+str(daily_20130730.shape[0]))
daily_20130730_addname_dataframe.to_excel(daily_201307_excel_writer,'30_2',index=False)
daily_201307_excel_writer.save()
daily_20130731 = pro.daily(start_date='',end_date='',trade_date='20130731', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20130731_tscode_list = list() 
for ts_code_sh in daily_20130731['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20130731_tscode_list.append(stock_name)
daily_20130731_addname_dataframe=pd.DataFrame()
daily_20130731_addname_dataframe['cname'] = daily_20130731_tscode_list
for table_name in daily_20130731.columns.values.tolist():
    daily_20130731_addname_dataframe[table_name] = daily_20130731[table_name]
print("日线行情-时间为序  daily_20130731 返回数据 row 行数 = "+str(daily_20130731.shape[0]))
daily_20130731_addname_dataframe.to_excel(daily_201307_excel_writer,'31_3',index=False)
daily_201307_excel_writer.save()




createexcel('daily_201308.xlsx')
daily_201308_book = load_workbook('C:\\Users\\zhuzj5\\Desktop\\zbin\\J0_Data\\daily_201308.xlsx')
daily_201308_excel_writer = pd.ExcelWriter('C:\\Users\\zhuzj5\\Desktop\\zbin\\J0_Data\\daily_201308.xlsx', engine='openpyxl')
daily_201308_excel_writer.book = daily_201308_book
daily_201308_excel_writer.sheets = dict((ws.title, ws) for ws in daily_201308_book.worksheets)
J0_PROPS.put(tree_node_name+"record_date", "20130801")       ###  更新 记录日期
daily_20130801 = pro.daily(start_date='',end_date='',trade_date='20130801', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20130801_tscode_list = list() 
for ts_code_sh in daily_20130801['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20130801_tscode_list.append(stock_name)
daily_20130801_addname_dataframe=pd.DataFrame()
daily_20130801_addname_dataframe['cname'] = daily_20130801_tscode_list
for table_name in daily_20130801.columns.values.tolist():
    daily_20130801_addname_dataframe[table_name] = daily_20130801[table_name]
print("日线行情-时间为序  daily_20130801 返回数据 row 行数 = "+str(daily_20130801.shape[0]))
daily_20130801_addname_dataframe.to_excel(daily_201308_excel_writer,'1_4',index=False)
daily_201308_excel_writer.save()
daily_20130802 = pro.daily(start_date='',end_date='',trade_date='20130802', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20130802_tscode_list = list() 
for ts_code_sh in daily_20130802['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20130802_tscode_list.append(stock_name)
daily_20130802_addname_dataframe=pd.DataFrame()
daily_20130802_addname_dataframe['cname'] = daily_20130802_tscode_list
for table_name in daily_20130802.columns.values.tolist():
    daily_20130802_addname_dataframe[table_name] = daily_20130802[table_name]
print("日线行情-时间为序  daily_20130802 返回数据 row 行数 = "+str(daily_20130802.shape[0]))
daily_20130802_addname_dataframe.to_excel(daily_201308_excel_writer,'2_5',index=False)
daily_201308_excel_writer.save()
daily_20130805 = pro.daily(start_date='',end_date='',trade_date='20130805', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20130805_tscode_list = list() 
for ts_code_sh in daily_20130805['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20130805_tscode_list.append(stock_name)
daily_20130805_addname_dataframe=pd.DataFrame()
daily_20130805_addname_dataframe['cname'] = daily_20130805_tscode_list
for table_name in daily_20130805.columns.values.tolist():
    daily_20130805_addname_dataframe[table_name] = daily_20130805[table_name]
print("日线行情-时间为序  daily_20130805 返回数据 row 行数 = "+str(daily_20130805.shape[0]))
daily_20130805_addname_dataframe.to_excel(daily_201308_excel_writer,'5_1',index=False)
daily_201308_excel_writer.save()
daily_20130806 = pro.daily(start_date='',end_date='',trade_date='20130806', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20130806_tscode_list = list() 
for ts_code_sh in daily_20130806['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20130806_tscode_list.append(stock_name)
daily_20130806_addname_dataframe=pd.DataFrame()
daily_20130806_addname_dataframe['cname'] = daily_20130806_tscode_list
for table_name in daily_20130806.columns.values.tolist():
    daily_20130806_addname_dataframe[table_name] = daily_20130806[table_name]
print("日线行情-时间为序  daily_20130806 返回数据 row 行数 = "+str(daily_20130806.shape[0]))
daily_20130806_addname_dataframe.to_excel(daily_201308_excel_writer,'6_2',index=False)
daily_201308_excel_writer.save()
daily_20130807 = pro.daily(start_date='',end_date='',trade_date='20130807', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20130807_tscode_list = list() 
for ts_code_sh in daily_20130807['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20130807_tscode_list.append(stock_name)
daily_20130807_addname_dataframe=pd.DataFrame()
daily_20130807_addname_dataframe['cname'] = daily_20130807_tscode_list
for table_name in daily_20130807.columns.values.tolist():
    daily_20130807_addname_dataframe[table_name] = daily_20130807[table_name]
print("日线行情-时间为序  daily_20130807 返回数据 row 行数 = "+str(daily_20130807.shape[0]))
daily_20130807_addname_dataframe.to_excel(daily_201308_excel_writer,'7_3',index=False)
daily_201308_excel_writer.save()
daily_20130808 = pro.daily(start_date='',end_date='',trade_date='20130808', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20130808_tscode_list = list() 
for ts_code_sh in daily_20130808['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20130808_tscode_list.append(stock_name)
daily_20130808_addname_dataframe=pd.DataFrame()
daily_20130808_addname_dataframe['cname'] = daily_20130808_tscode_list
for table_name in daily_20130808.columns.values.tolist():
    daily_20130808_addname_dataframe[table_name] = daily_20130808[table_name]
print("日线行情-时间为序  daily_20130808 返回数据 row 行数 = "+str(daily_20130808.shape[0]))
daily_20130808_addname_dataframe.to_excel(daily_201308_excel_writer,'8_4',index=False)
daily_201308_excel_writer.save()
daily_20130809 = pro.daily(start_date='',end_date='',trade_date='20130809', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20130809_tscode_list = list() 
for ts_code_sh in daily_20130809['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20130809_tscode_list.append(stock_name)
daily_20130809_addname_dataframe=pd.DataFrame()
daily_20130809_addname_dataframe['cname'] = daily_20130809_tscode_list
for table_name in daily_20130809.columns.values.tolist():
    daily_20130809_addname_dataframe[table_name] = daily_20130809[table_name]
print("日线行情-时间为序  daily_20130809 返回数据 row 行数 = "+str(daily_20130809.shape[0]))
daily_20130809_addname_dataframe.to_excel(daily_201308_excel_writer,'9_5',index=False)
daily_201308_excel_writer.save()
daily_20130812 = pro.daily(start_date='',end_date='',trade_date='20130812', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20130812_tscode_list = list() 
for ts_code_sh in daily_20130812['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20130812_tscode_list.append(stock_name)
daily_20130812_addname_dataframe=pd.DataFrame()
daily_20130812_addname_dataframe['cname'] = daily_20130812_tscode_list
for table_name in daily_20130812.columns.values.tolist():
    daily_20130812_addname_dataframe[table_name] = daily_20130812[table_name]
print("日线行情-时间为序  daily_20130812 返回数据 row 行数 = "+str(daily_20130812.shape[0]))
daily_20130812_addname_dataframe.to_excel(daily_201308_excel_writer,'12_1',index=False)
daily_201308_excel_writer.save()
daily_20130813 = pro.daily(start_date='',end_date='',trade_date='20130813', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20130813_tscode_list = list() 
for ts_code_sh in daily_20130813['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20130813_tscode_list.append(stock_name)
daily_20130813_addname_dataframe=pd.DataFrame()
daily_20130813_addname_dataframe['cname'] = daily_20130813_tscode_list
for table_name in daily_20130813.columns.values.tolist():
    daily_20130813_addname_dataframe[table_name] = daily_20130813[table_name]
print("日线行情-时间为序  daily_20130813 返回数据 row 行数 = "+str(daily_20130813.shape[0]))
daily_20130813_addname_dataframe.to_excel(daily_201308_excel_writer,'13_2',index=False)
daily_201308_excel_writer.save()
daily_20130814 = pro.daily(start_date='',end_date='',trade_date='20130814', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20130814_tscode_list = list() 
for ts_code_sh in daily_20130814['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20130814_tscode_list.append(stock_name)
daily_20130814_addname_dataframe=pd.DataFrame()
daily_20130814_addname_dataframe['cname'] = daily_20130814_tscode_list
for table_name in daily_20130814.columns.values.tolist():
    daily_20130814_addname_dataframe[table_name] = daily_20130814[table_name]
print("日线行情-时间为序  daily_20130814 返回数据 row 行数 = "+str(daily_20130814.shape[0]))
daily_20130814_addname_dataframe.to_excel(daily_201308_excel_writer,'14_3',index=False)
daily_201308_excel_writer.save()
daily_20130815 = pro.daily(start_date='',end_date='',trade_date='20130815', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20130815_tscode_list = list() 
for ts_code_sh in daily_20130815['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20130815_tscode_list.append(stock_name)
daily_20130815_addname_dataframe=pd.DataFrame()
daily_20130815_addname_dataframe['cname'] = daily_20130815_tscode_list
for table_name in daily_20130815.columns.values.tolist():
    daily_20130815_addname_dataframe[table_name] = daily_20130815[table_name]
print("日线行情-时间为序  daily_20130815 返回数据 row 行数 = "+str(daily_20130815.shape[0]))
daily_20130815_addname_dataframe.to_excel(daily_201308_excel_writer,'15_4',index=False)
daily_201308_excel_writer.save()
daily_20130816 = pro.daily(start_date='',end_date='',trade_date='20130816', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20130816_tscode_list = list() 
for ts_code_sh in daily_20130816['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20130816_tscode_list.append(stock_name)
daily_20130816_addname_dataframe=pd.DataFrame()
daily_20130816_addname_dataframe['cname'] = daily_20130816_tscode_list
for table_name in daily_20130816.columns.values.tolist():
    daily_20130816_addname_dataframe[table_name] = daily_20130816[table_name]
print("日线行情-时间为序  daily_20130816 返回数据 row 行数 = "+str(daily_20130816.shape[0]))
daily_20130816_addname_dataframe.to_excel(daily_201308_excel_writer,'16_5',index=False)
daily_201308_excel_writer.save()
daily_20130819 = pro.daily(start_date='',end_date='',trade_date='20130819', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20130819_tscode_list = list() 
for ts_code_sh in daily_20130819['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20130819_tscode_list.append(stock_name)
daily_20130819_addname_dataframe=pd.DataFrame()
daily_20130819_addname_dataframe['cname'] = daily_20130819_tscode_list
for table_name in daily_20130819.columns.values.tolist():
    daily_20130819_addname_dataframe[table_name] = daily_20130819[table_name]
print("日线行情-时间为序  daily_20130819 返回数据 row 行数 = "+str(daily_20130819.shape[0]))
daily_20130819_addname_dataframe.to_excel(daily_201308_excel_writer,'19_1',index=False)
daily_201308_excel_writer.save()
daily_20130820 = pro.daily(start_date='',end_date='',trade_date='20130820', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20130820_tscode_list = list() 
for ts_code_sh in daily_20130820['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20130820_tscode_list.append(stock_name)
daily_20130820_addname_dataframe=pd.DataFrame()
daily_20130820_addname_dataframe['cname'] = daily_20130820_tscode_list
for table_name in daily_20130820.columns.values.tolist():
    daily_20130820_addname_dataframe[table_name] = daily_20130820[table_name]
print("日线行情-时间为序  daily_20130820 返回数据 row 行数 = "+str(daily_20130820.shape[0]))
daily_20130820_addname_dataframe.to_excel(daily_201308_excel_writer,'20_2',index=False)
daily_201308_excel_writer.save()
daily_20130821 = pro.daily(start_date='',end_date='',trade_date='20130821', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20130821_tscode_list = list() 
for ts_code_sh in daily_20130821['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20130821_tscode_list.append(stock_name)
daily_20130821_addname_dataframe=pd.DataFrame()
daily_20130821_addname_dataframe['cname'] = daily_20130821_tscode_list
for table_name in daily_20130821.columns.values.tolist():
    daily_20130821_addname_dataframe[table_name] = daily_20130821[table_name]
print("日线行情-时间为序  daily_20130821 返回数据 row 行数 = "+str(daily_20130821.shape[0]))
daily_20130821_addname_dataframe.to_excel(daily_201308_excel_writer,'21_3',index=False)
daily_201308_excel_writer.save()
daily_20130822 = pro.daily(start_date='',end_date='',trade_date='20130822', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20130822_tscode_list = list() 
for ts_code_sh in daily_20130822['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20130822_tscode_list.append(stock_name)
daily_20130822_addname_dataframe=pd.DataFrame()
daily_20130822_addname_dataframe['cname'] = daily_20130822_tscode_list
for table_name in daily_20130822.columns.values.tolist():
    daily_20130822_addname_dataframe[table_name] = daily_20130822[table_name]
print("日线行情-时间为序  daily_20130822 返回数据 row 行数 = "+str(daily_20130822.shape[0]))
daily_20130822_addname_dataframe.to_excel(daily_201308_excel_writer,'22_4',index=False)
daily_201308_excel_writer.save()
daily_20130823 = pro.daily(start_date='',end_date='',trade_date='20130823', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20130823_tscode_list = list() 
for ts_code_sh in daily_20130823['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20130823_tscode_list.append(stock_name)
daily_20130823_addname_dataframe=pd.DataFrame()
daily_20130823_addname_dataframe['cname'] = daily_20130823_tscode_list
for table_name in daily_20130823.columns.values.tolist():
    daily_20130823_addname_dataframe[table_name] = daily_20130823[table_name]
print("日线行情-时间为序  daily_20130823 返回数据 row 行数 = "+str(daily_20130823.shape[0]))
daily_20130823_addname_dataframe.to_excel(daily_201308_excel_writer,'23_5',index=False)
daily_201308_excel_writer.save()
daily_20130826 = pro.daily(start_date='',end_date='',trade_date='20130826', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20130826_tscode_list = list() 
for ts_code_sh in daily_20130826['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20130826_tscode_list.append(stock_name)
daily_20130826_addname_dataframe=pd.DataFrame()
daily_20130826_addname_dataframe['cname'] = daily_20130826_tscode_list
for table_name in daily_20130826.columns.values.tolist():
    daily_20130826_addname_dataframe[table_name] = daily_20130826[table_name]
print("日线行情-时间为序  daily_20130826 返回数据 row 行数 = "+str(daily_20130826.shape[0]))
daily_20130826_addname_dataframe.to_excel(daily_201308_excel_writer,'26_1',index=False)
daily_201308_excel_writer.save()
daily_20130827 = pro.daily(start_date='',end_date='',trade_date='20130827', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20130827_tscode_list = list() 
for ts_code_sh in daily_20130827['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20130827_tscode_list.append(stock_name)
daily_20130827_addname_dataframe=pd.DataFrame()
daily_20130827_addname_dataframe['cname'] = daily_20130827_tscode_list
for table_name in daily_20130827.columns.values.tolist():
    daily_20130827_addname_dataframe[table_name] = daily_20130827[table_name]
print("日线行情-时间为序  daily_20130827 返回数据 row 行数 = "+str(daily_20130827.shape[0]))
daily_20130827_addname_dataframe.to_excel(daily_201308_excel_writer,'27_2',index=False)
daily_201308_excel_writer.save()
daily_20130828 = pro.daily(start_date='',end_date='',trade_date='20130828', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20130828_tscode_list = list() 
for ts_code_sh in daily_20130828['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20130828_tscode_list.append(stock_name)
daily_20130828_addname_dataframe=pd.DataFrame()
daily_20130828_addname_dataframe['cname'] = daily_20130828_tscode_list
for table_name in daily_20130828.columns.values.tolist():
    daily_20130828_addname_dataframe[table_name] = daily_20130828[table_name]
print("日线行情-时间为序  daily_20130828 返回数据 row 行数 = "+str(daily_20130828.shape[0]))
daily_20130828_addname_dataframe.to_excel(daily_201308_excel_writer,'28_3',index=False)
daily_201308_excel_writer.save()
daily_20130829 = pro.daily(start_date='',end_date='',trade_date='20130829', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20130829_tscode_list = list() 
for ts_code_sh in daily_20130829['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20130829_tscode_list.append(stock_name)
daily_20130829_addname_dataframe=pd.DataFrame()
daily_20130829_addname_dataframe['cname'] = daily_20130829_tscode_list
for table_name in daily_20130829.columns.values.tolist():
    daily_20130829_addname_dataframe[table_name] = daily_20130829[table_name]
print("日线行情-时间为序  daily_20130829 返回数据 row 行数 = "+str(daily_20130829.shape[0]))
daily_20130829_addname_dataframe.to_excel(daily_201308_excel_writer,'29_4',index=False)
daily_201308_excel_writer.save()
daily_20130830 = pro.daily(start_date='',end_date='',trade_date='20130830', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20130830_tscode_list = list() 
for ts_code_sh in daily_20130830['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20130830_tscode_list.append(stock_name)
daily_20130830_addname_dataframe=pd.DataFrame()
daily_20130830_addname_dataframe['cname'] = daily_20130830_tscode_list
for table_name in daily_20130830.columns.values.tolist():
    daily_20130830_addname_dataframe[table_name] = daily_20130830[table_name]
print("日线行情-时间为序  daily_20130830 返回数据 row 行数 = "+str(daily_20130830.shape[0]))
daily_20130830_addname_dataframe.to_excel(daily_201308_excel_writer,'30_5',index=False)
daily_201308_excel_writer.save()




createexcel('daily_201309.xlsx')
daily_201309_book = load_workbook('C:\\Users\\zhuzj5\\Desktop\\zbin\\J0_Data\\daily_201309.xlsx')
daily_201309_excel_writer = pd.ExcelWriter('C:\\Users\\zhuzj5\\Desktop\\zbin\\J0_Data\\daily_201309.xlsx', engine='openpyxl')
daily_201309_excel_writer.book = daily_201309_book
daily_201309_excel_writer.sheets = dict((ws.title, ws) for ws in daily_201309_book.worksheets)
J0_PROPS.put(tree_node_name+"record_date", "20130901")       ###  更新 记录日期
daily_20130902 = pro.daily(start_date='',end_date='',trade_date='20130902', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20130902_tscode_list = list() 
for ts_code_sh in daily_20130902['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20130902_tscode_list.append(stock_name)
daily_20130902_addname_dataframe=pd.DataFrame()
daily_20130902_addname_dataframe['cname'] = daily_20130902_tscode_list
for table_name in daily_20130902.columns.values.tolist():
    daily_20130902_addname_dataframe[table_name] = daily_20130902[table_name]
print("日线行情-时间为序  daily_20130902 返回数据 row 行数 = "+str(daily_20130902.shape[0]))
daily_20130902_addname_dataframe.to_excel(daily_201309_excel_writer,'2_1',index=False)
daily_201309_excel_writer.save()
daily_20130903 = pro.daily(start_date='',end_date='',trade_date='20130903', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20130903_tscode_list = list() 
for ts_code_sh in daily_20130903['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20130903_tscode_list.append(stock_name)
daily_20130903_addname_dataframe=pd.DataFrame()
daily_20130903_addname_dataframe['cname'] = daily_20130903_tscode_list
for table_name in daily_20130903.columns.values.tolist():
    daily_20130903_addname_dataframe[table_name] = daily_20130903[table_name]
print("日线行情-时间为序  daily_20130903 返回数据 row 行数 = "+str(daily_20130903.shape[0]))
daily_20130903_addname_dataframe.to_excel(daily_201309_excel_writer,'3_2',index=False)
daily_201309_excel_writer.save()
daily_20130904 = pro.daily(start_date='',end_date='',trade_date='20130904', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20130904_tscode_list = list() 
for ts_code_sh in daily_20130904['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20130904_tscode_list.append(stock_name)
daily_20130904_addname_dataframe=pd.DataFrame()
daily_20130904_addname_dataframe['cname'] = daily_20130904_tscode_list
for table_name in daily_20130904.columns.values.tolist():
    daily_20130904_addname_dataframe[table_name] = daily_20130904[table_name]
print("日线行情-时间为序  daily_20130904 返回数据 row 行数 = "+str(daily_20130904.shape[0]))
daily_20130904_addname_dataframe.to_excel(daily_201309_excel_writer,'4_3',index=False)
daily_201309_excel_writer.save()
daily_20130905 = pro.daily(start_date='',end_date='',trade_date='20130905', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20130905_tscode_list = list() 
for ts_code_sh in daily_20130905['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20130905_tscode_list.append(stock_name)
daily_20130905_addname_dataframe=pd.DataFrame()
daily_20130905_addname_dataframe['cname'] = daily_20130905_tscode_list
for table_name in daily_20130905.columns.values.tolist():
    daily_20130905_addname_dataframe[table_name] = daily_20130905[table_name]
print("日线行情-时间为序  daily_20130905 返回数据 row 行数 = "+str(daily_20130905.shape[0]))
daily_20130905_addname_dataframe.to_excel(daily_201309_excel_writer,'5_4',index=False)
daily_201309_excel_writer.save()
daily_20130906 = pro.daily(start_date='',end_date='',trade_date='20130906', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20130906_tscode_list = list() 
for ts_code_sh in daily_20130906['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20130906_tscode_list.append(stock_name)
daily_20130906_addname_dataframe=pd.DataFrame()
daily_20130906_addname_dataframe['cname'] = daily_20130906_tscode_list
for table_name in daily_20130906.columns.values.tolist():
    daily_20130906_addname_dataframe[table_name] = daily_20130906[table_name]
print("日线行情-时间为序  daily_20130906 返回数据 row 行数 = "+str(daily_20130906.shape[0]))
daily_20130906_addname_dataframe.to_excel(daily_201309_excel_writer,'6_5',index=False)
daily_201309_excel_writer.save()
daily_20130909 = pro.daily(start_date='',end_date='',trade_date='20130909', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20130909_tscode_list = list() 
for ts_code_sh in daily_20130909['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20130909_tscode_list.append(stock_name)
daily_20130909_addname_dataframe=pd.DataFrame()
daily_20130909_addname_dataframe['cname'] = daily_20130909_tscode_list
for table_name in daily_20130909.columns.values.tolist():
    daily_20130909_addname_dataframe[table_name] = daily_20130909[table_name]
print("日线行情-时间为序  daily_20130909 返回数据 row 行数 = "+str(daily_20130909.shape[0]))
daily_20130909_addname_dataframe.to_excel(daily_201309_excel_writer,'9_1',index=False)
daily_201309_excel_writer.save()
daily_20130910 = pro.daily(start_date='',end_date='',trade_date='20130910', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20130910_tscode_list = list() 
for ts_code_sh in daily_20130910['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20130910_tscode_list.append(stock_name)
daily_20130910_addname_dataframe=pd.DataFrame()
daily_20130910_addname_dataframe['cname'] = daily_20130910_tscode_list
for table_name in daily_20130910.columns.values.tolist():
    daily_20130910_addname_dataframe[table_name] = daily_20130910[table_name]
print("日线行情-时间为序  daily_20130910 返回数据 row 行数 = "+str(daily_20130910.shape[0]))
daily_20130910_addname_dataframe.to_excel(daily_201309_excel_writer,'10_2',index=False)
daily_201309_excel_writer.save()
daily_20130911 = pro.daily(start_date='',end_date='',trade_date='20130911', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20130911_tscode_list = list() 
for ts_code_sh in daily_20130911['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20130911_tscode_list.append(stock_name)
daily_20130911_addname_dataframe=pd.DataFrame()
daily_20130911_addname_dataframe['cname'] = daily_20130911_tscode_list
for table_name in daily_20130911.columns.values.tolist():
    daily_20130911_addname_dataframe[table_name] = daily_20130911[table_name]
print("日线行情-时间为序  daily_20130911 返回数据 row 行数 = "+str(daily_20130911.shape[0]))
daily_20130911_addname_dataframe.to_excel(daily_201309_excel_writer,'11_3',index=False)
daily_201309_excel_writer.save()
daily_20130912 = pro.daily(start_date='',end_date='',trade_date='20130912', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20130912_tscode_list = list() 
for ts_code_sh in daily_20130912['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20130912_tscode_list.append(stock_name)
daily_20130912_addname_dataframe=pd.DataFrame()
daily_20130912_addname_dataframe['cname'] = daily_20130912_tscode_list
for table_name in daily_20130912.columns.values.tolist():
    daily_20130912_addname_dataframe[table_name] = daily_20130912[table_name]
print("日线行情-时间为序  daily_20130912 返回数据 row 行数 = "+str(daily_20130912.shape[0]))
daily_20130912_addname_dataframe.to_excel(daily_201309_excel_writer,'12_4',index=False)
daily_201309_excel_writer.save()
daily_20130913 = pro.daily(start_date='',end_date='',trade_date='20130913', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20130913_tscode_list = list() 
for ts_code_sh in daily_20130913['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20130913_tscode_list.append(stock_name)
daily_20130913_addname_dataframe=pd.DataFrame()
daily_20130913_addname_dataframe['cname'] = daily_20130913_tscode_list
for table_name in daily_20130913.columns.values.tolist():
    daily_20130913_addname_dataframe[table_name] = daily_20130913[table_name]
print("日线行情-时间为序  daily_20130913 返回数据 row 行数 = "+str(daily_20130913.shape[0]))
daily_20130913_addname_dataframe.to_excel(daily_201309_excel_writer,'13_5',index=False)
daily_201309_excel_writer.save()
daily_20130916 = pro.daily(start_date='',end_date='',trade_date='20130916', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20130916_tscode_list = list() 
for ts_code_sh in daily_20130916['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20130916_tscode_list.append(stock_name)
daily_20130916_addname_dataframe=pd.DataFrame()
daily_20130916_addname_dataframe['cname'] = daily_20130916_tscode_list
for table_name in daily_20130916.columns.values.tolist():
    daily_20130916_addname_dataframe[table_name] = daily_20130916[table_name]
print("日线行情-时间为序  daily_20130916 返回数据 row 行数 = "+str(daily_20130916.shape[0]))
daily_20130916_addname_dataframe.to_excel(daily_201309_excel_writer,'16_1',index=False)
daily_201309_excel_writer.save()
daily_20130917 = pro.daily(start_date='',end_date='',trade_date='20130917', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20130917_tscode_list = list() 
for ts_code_sh in daily_20130917['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20130917_tscode_list.append(stock_name)
daily_20130917_addname_dataframe=pd.DataFrame()
daily_20130917_addname_dataframe['cname'] = daily_20130917_tscode_list
for table_name in daily_20130917.columns.values.tolist():
    daily_20130917_addname_dataframe[table_name] = daily_20130917[table_name]
print("日线行情-时间为序  daily_20130917 返回数据 row 行数 = "+str(daily_20130917.shape[0]))
daily_20130917_addname_dataframe.to_excel(daily_201309_excel_writer,'17_2',index=False)
daily_201309_excel_writer.save()
daily_20130918 = pro.daily(start_date='',end_date='',trade_date='20130918', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20130918_tscode_list = list() 
for ts_code_sh in daily_20130918['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20130918_tscode_list.append(stock_name)
daily_20130918_addname_dataframe=pd.DataFrame()
daily_20130918_addname_dataframe['cname'] = daily_20130918_tscode_list
for table_name in daily_20130918.columns.values.tolist():
    daily_20130918_addname_dataframe[table_name] = daily_20130918[table_name]
print("日线行情-时间为序  daily_20130918 返回数据 row 行数 = "+str(daily_20130918.shape[0]))
daily_20130918_addname_dataframe.to_excel(daily_201309_excel_writer,'18_3',index=False)
daily_201309_excel_writer.save()
daily_20130923 = pro.daily(start_date='',end_date='',trade_date='20130923', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20130923_tscode_list = list() 
for ts_code_sh in daily_20130923['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20130923_tscode_list.append(stock_name)
daily_20130923_addname_dataframe=pd.DataFrame()
daily_20130923_addname_dataframe['cname'] = daily_20130923_tscode_list
for table_name in daily_20130923.columns.values.tolist():
    daily_20130923_addname_dataframe[table_name] = daily_20130923[table_name]
print("日线行情-时间为序  daily_20130923 返回数据 row 行数 = "+str(daily_20130923.shape[0]))
daily_20130923_addname_dataframe.to_excel(daily_201309_excel_writer,'23_1',index=False)
daily_201309_excel_writer.save()
daily_20130924 = pro.daily(start_date='',end_date='',trade_date='20130924', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20130924_tscode_list = list() 
for ts_code_sh in daily_20130924['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20130924_tscode_list.append(stock_name)
daily_20130924_addname_dataframe=pd.DataFrame()
daily_20130924_addname_dataframe['cname'] = daily_20130924_tscode_list
for table_name in daily_20130924.columns.values.tolist():
    daily_20130924_addname_dataframe[table_name] = daily_20130924[table_name]
print("日线行情-时间为序  daily_20130924 返回数据 row 行数 = "+str(daily_20130924.shape[0]))
daily_20130924_addname_dataframe.to_excel(daily_201309_excel_writer,'24_2',index=False)
daily_201309_excel_writer.save()
daily_20130925 = pro.daily(start_date='',end_date='',trade_date='20130925', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20130925_tscode_list = list() 
for ts_code_sh in daily_20130925['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20130925_tscode_list.append(stock_name)
daily_20130925_addname_dataframe=pd.DataFrame()
daily_20130925_addname_dataframe['cname'] = daily_20130925_tscode_list
for table_name in daily_20130925.columns.values.tolist():
    daily_20130925_addname_dataframe[table_name] = daily_20130925[table_name]
print("日线行情-时间为序  daily_20130925 返回数据 row 行数 = "+str(daily_20130925.shape[0]))
daily_20130925_addname_dataframe.to_excel(daily_201309_excel_writer,'25_3',index=False)
daily_201309_excel_writer.save()
daily_20130926 = pro.daily(start_date='',end_date='',trade_date='20130926', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20130926_tscode_list = list() 
for ts_code_sh in daily_20130926['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20130926_tscode_list.append(stock_name)
daily_20130926_addname_dataframe=pd.DataFrame()
daily_20130926_addname_dataframe['cname'] = daily_20130926_tscode_list
for table_name in daily_20130926.columns.values.tolist():
    daily_20130926_addname_dataframe[table_name] = daily_20130926[table_name]
print("日线行情-时间为序  daily_20130926 返回数据 row 行数 = "+str(daily_20130926.shape[0]))
daily_20130926_addname_dataframe.to_excel(daily_201309_excel_writer,'26_4',index=False)
daily_201309_excel_writer.save()
daily_20130927 = pro.daily(start_date='',end_date='',trade_date='20130927', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20130927_tscode_list = list() 
for ts_code_sh in daily_20130927['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20130927_tscode_list.append(stock_name)
daily_20130927_addname_dataframe=pd.DataFrame()
daily_20130927_addname_dataframe['cname'] = daily_20130927_tscode_list
for table_name in daily_20130927.columns.values.tolist():
    daily_20130927_addname_dataframe[table_name] = daily_20130927[table_name]
print("日线行情-时间为序  daily_20130927 返回数据 row 行数 = "+str(daily_20130927.shape[0]))
daily_20130927_addname_dataframe.to_excel(daily_201309_excel_writer,'27_5',index=False)
daily_201309_excel_writer.save()
daily_20130930 = pro.daily(start_date='',end_date='',trade_date='20130930', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20130930_tscode_list = list() 
for ts_code_sh in daily_20130930['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20130930_tscode_list.append(stock_name)
daily_20130930_addname_dataframe=pd.DataFrame()
daily_20130930_addname_dataframe['cname'] = daily_20130930_tscode_list
for table_name in daily_20130930.columns.values.tolist():
    daily_20130930_addname_dataframe[table_name] = daily_20130930[table_name]
print("日线行情-时间为序  daily_20130930 返回数据 row 行数 = "+str(daily_20130930.shape[0]))
daily_20130930_addname_dataframe.to_excel(daily_201309_excel_writer,'30_1',index=False)
daily_201309_excel_writer.save()




createexcel('daily_201310.xlsx')
daily_201310_book = load_workbook('C:\\Users\\zhuzj5\\Desktop\\zbin\\J0_Data\\daily_201310.xlsx')
daily_201310_excel_writer = pd.ExcelWriter('C:\\Users\\zhuzj5\\Desktop\\zbin\\J0_Data\\daily_201310.xlsx', engine='openpyxl')
daily_201310_excel_writer.book = daily_201310_book
daily_201310_excel_writer.sheets = dict((ws.title, ws) for ws in daily_201310_book.worksheets)
J0_PROPS.put(tree_node_name+"record_date", "20131001")       ###  更新 记录日期
daily_20131008 = pro.daily(start_date='',end_date='',trade_date='20131008', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20131008_tscode_list = list() 
for ts_code_sh in daily_20131008['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20131008_tscode_list.append(stock_name)
daily_20131008_addname_dataframe=pd.DataFrame()
daily_20131008_addname_dataframe['cname'] = daily_20131008_tscode_list
for table_name in daily_20131008.columns.values.tolist():
    daily_20131008_addname_dataframe[table_name] = daily_20131008[table_name]
print("日线行情-时间为序  daily_20131008 返回数据 row 行数 = "+str(daily_20131008.shape[0]))
daily_20131008_addname_dataframe.to_excel(daily_201310_excel_writer,'8_2',index=False)
daily_201310_excel_writer.save()
daily_20131009 = pro.daily(start_date='',end_date='',trade_date='20131009', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20131009_tscode_list = list() 
for ts_code_sh in daily_20131009['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20131009_tscode_list.append(stock_name)
daily_20131009_addname_dataframe=pd.DataFrame()
daily_20131009_addname_dataframe['cname'] = daily_20131009_tscode_list
for table_name in daily_20131009.columns.values.tolist():
    daily_20131009_addname_dataframe[table_name] = daily_20131009[table_name]
print("日线行情-时间为序  daily_20131009 返回数据 row 行数 = "+str(daily_20131009.shape[0]))
daily_20131009_addname_dataframe.to_excel(daily_201310_excel_writer,'9_3',index=False)
daily_201310_excel_writer.save()
daily_20131010 = pro.daily(start_date='',end_date='',trade_date='20131010', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20131010_tscode_list = list() 
for ts_code_sh in daily_20131010['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20131010_tscode_list.append(stock_name)
daily_20131010_addname_dataframe=pd.DataFrame()
daily_20131010_addname_dataframe['cname'] = daily_20131010_tscode_list
for table_name in daily_20131010.columns.values.tolist():
    daily_20131010_addname_dataframe[table_name] = daily_20131010[table_name]
print("日线行情-时间为序  daily_20131010 返回数据 row 行数 = "+str(daily_20131010.shape[0]))
daily_20131010_addname_dataframe.to_excel(daily_201310_excel_writer,'10_4',index=False)
daily_201310_excel_writer.save()
daily_20131011 = pro.daily(start_date='',end_date='',trade_date='20131011', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20131011_tscode_list = list() 
for ts_code_sh in daily_20131011['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20131011_tscode_list.append(stock_name)
daily_20131011_addname_dataframe=pd.DataFrame()
daily_20131011_addname_dataframe['cname'] = daily_20131011_tscode_list
for table_name in daily_20131011.columns.values.tolist():
    daily_20131011_addname_dataframe[table_name] = daily_20131011[table_name]
print("日线行情-时间为序  daily_20131011 返回数据 row 行数 = "+str(daily_20131011.shape[0]))
daily_20131011_addname_dataframe.to_excel(daily_201310_excel_writer,'11_5',index=False)
daily_201310_excel_writer.save()
daily_20131014 = pro.daily(start_date='',end_date='',trade_date='20131014', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20131014_tscode_list = list() 
for ts_code_sh in daily_20131014['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20131014_tscode_list.append(stock_name)
daily_20131014_addname_dataframe=pd.DataFrame()
daily_20131014_addname_dataframe['cname'] = daily_20131014_tscode_list
for table_name in daily_20131014.columns.values.tolist():
    daily_20131014_addname_dataframe[table_name] = daily_20131014[table_name]
print("日线行情-时间为序  daily_20131014 返回数据 row 行数 = "+str(daily_20131014.shape[0]))
daily_20131014_addname_dataframe.to_excel(daily_201310_excel_writer,'14_1',index=False)
daily_201310_excel_writer.save()
daily_20131015 = pro.daily(start_date='',end_date='',trade_date='20131015', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20131015_tscode_list = list() 
for ts_code_sh in daily_20131015['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20131015_tscode_list.append(stock_name)
daily_20131015_addname_dataframe=pd.DataFrame()
daily_20131015_addname_dataframe['cname'] = daily_20131015_tscode_list
for table_name in daily_20131015.columns.values.tolist():
    daily_20131015_addname_dataframe[table_name] = daily_20131015[table_name]
print("日线行情-时间为序  daily_20131015 返回数据 row 行数 = "+str(daily_20131015.shape[0]))
daily_20131015_addname_dataframe.to_excel(daily_201310_excel_writer,'15_2',index=False)
daily_201310_excel_writer.save()
daily_20131016 = pro.daily(start_date='',end_date='',trade_date='20131016', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20131016_tscode_list = list() 
for ts_code_sh in daily_20131016['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20131016_tscode_list.append(stock_name)
daily_20131016_addname_dataframe=pd.DataFrame()
daily_20131016_addname_dataframe['cname'] = daily_20131016_tscode_list
for table_name in daily_20131016.columns.values.tolist():
    daily_20131016_addname_dataframe[table_name] = daily_20131016[table_name]
print("日线行情-时间为序  daily_20131016 返回数据 row 行数 = "+str(daily_20131016.shape[0]))
daily_20131016_addname_dataframe.to_excel(daily_201310_excel_writer,'16_3',index=False)
daily_201310_excel_writer.save()
daily_20131017 = pro.daily(start_date='',end_date='',trade_date='20131017', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20131017_tscode_list = list() 
for ts_code_sh in daily_20131017['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20131017_tscode_list.append(stock_name)
daily_20131017_addname_dataframe=pd.DataFrame()
daily_20131017_addname_dataframe['cname'] = daily_20131017_tscode_list
for table_name in daily_20131017.columns.values.tolist():
    daily_20131017_addname_dataframe[table_name] = daily_20131017[table_name]
print("日线行情-时间为序  daily_20131017 返回数据 row 行数 = "+str(daily_20131017.shape[0]))
daily_20131017_addname_dataframe.to_excel(daily_201310_excel_writer,'17_4',index=False)
daily_201310_excel_writer.save()
daily_20131018 = pro.daily(start_date='',end_date='',trade_date='20131018', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20131018_tscode_list = list() 
for ts_code_sh in daily_20131018['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20131018_tscode_list.append(stock_name)
daily_20131018_addname_dataframe=pd.DataFrame()
daily_20131018_addname_dataframe['cname'] = daily_20131018_tscode_list
for table_name in daily_20131018.columns.values.tolist():
    daily_20131018_addname_dataframe[table_name] = daily_20131018[table_name]
print("日线行情-时间为序  daily_20131018 返回数据 row 行数 = "+str(daily_20131018.shape[0]))
daily_20131018_addname_dataframe.to_excel(daily_201310_excel_writer,'18_5',index=False)
daily_201310_excel_writer.save()
daily_20131021 = pro.daily(start_date='',end_date='',trade_date='20131021', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20131021_tscode_list = list() 
for ts_code_sh in daily_20131021['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20131021_tscode_list.append(stock_name)
daily_20131021_addname_dataframe=pd.DataFrame()
daily_20131021_addname_dataframe['cname'] = daily_20131021_tscode_list
for table_name in daily_20131021.columns.values.tolist():
    daily_20131021_addname_dataframe[table_name] = daily_20131021[table_name]
print("日线行情-时间为序  daily_20131021 返回数据 row 行数 = "+str(daily_20131021.shape[0]))
daily_20131021_addname_dataframe.to_excel(daily_201310_excel_writer,'21_1',index=False)
daily_201310_excel_writer.save()
daily_20131022 = pro.daily(start_date='',end_date='',trade_date='20131022', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20131022_tscode_list = list() 
for ts_code_sh in daily_20131022['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20131022_tscode_list.append(stock_name)
daily_20131022_addname_dataframe=pd.DataFrame()
daily_20131022_addname_dataframe['cname'] = daily_20131022_tscode_list
for table_name in daily_20131022.columns.values.tolist():
    daily_20131022_addname_dataframe[table_name] = daily_20131022[table_name]
print("日线行情-时间为序  daily_20131022 返回数据 row 行数 = "+str(daily_20131022.shape[0]))
daily_20131022_addname_dataframe.to_excel(daily_201310_excel_writer,'22_2',index=False)
daily_201310_excel_writer.save()
daily_20131023 = pro.daily(start_date='',end_date='',trade_date='20131023', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20131023_tscode_list = list() 
for ts_code_sh in daily_20131023['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20131023_tscode_list.append(stock_name)
daily_20131023_addname_dataframe=pd.DataFrame()
daily_20131023_addname_dataframe['cname'] = daily_20131023_tscode_list
for table_name in daily_20131023.columns.values.tolist():
    daily_20131023_addname_dataframe[table_name] = daily_20131023[table_name]
print("日线行情-时间为序  daily_20131023 返回数据 row 行数 = "+str(daily_20131023.shape[0]))
daily_20131023_addname_dataframe.to_excel(daily_201310_excel_writer,'23_3',index=False)
daily_201310_excel_writer.save()
daily_20131024 = pro.daily(start_date='',end_date='',trade_date='20131024', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20131024_tscode_list = list() 
for ts_code_sh in daily_20131024['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20131024_tscode_list.append(stock_name)
daily_20131024_addname_dataframe=pd.DataFrame()
daily_20131024_addname_dataframe['cname'] = daily_20131024_tscode_list
for table_name in daily_20131024.columns.values.tolist():
    daily_20131024_addname_dataframe[table_name] = daily_20131024[table_name]
print("日线行情-时间为序  daily_20131024 返回数据 row 行数 = "+str(daily_20131024.shape[0]))
daily_20131024_addname_dataframe.to_excel(daily_201310_excel_writer,'24_4',index=False)
daily_201310_excel_writer.save()
daily_20131025 = pro.daily(start_date='',end_date='',trade_date='20131025', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20131025_tscode_list = list() 
for ts_code_sh in daily_20131025['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20131025_tscode_list.append(stock_name)
daily_20131025_addname_dataframe=pd.DataFrame()
daily_20131025_addname_dataframe['cname'] = daily_20131025_tscode_list
for table_name in daily_20131025.columns.values.tolist():
    daily_20131025_addname_dataframe[table_name] = daily_20131025[table_name]
print("日线行情-时间为序  daily_20131025 返回数据 row 行数 = "+str(daily_20131025.shape[0]))
daily_20131025_addname_dataframe.to_excel(daily_201310_excel_writer,'25_5',index=False)
daily_201310_excel_writer.save()
daily_20131028 = pro.daily(start_date='',end_date='',trade_date='20131028', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20131028_tscode_list = list() 
for ts_code_sh in daily_20131028['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20131028_tscode_list.append(stock_name)
daily_20131028_addname_dataframe=pd.DataFrame()
daily_20131028_addname_dataframe['cname'] = daily_20131028_tscode_list
for table_name in daily_20131028.columns.values.tolist():
    daily_20131028_addname_dataframe[table_name] = daily_20131028[table_name]
print("日线行情-时间为序  daily_20131028 返回数据 row 行数 = "+str(daily_20131028.shape[0]))
daily_20131028_addname_dataframe.to_excel(daily_201310_excel_writer,'28_1',index=False)
daily_201310_excel_writer.save()
daily_20131029 = pro.daily(start_date='',end_date='',trade_date='20131029', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20131029_tscode_list = list() 
for ts_code_sh in daily_20131029['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20131029_tscode_list.append(stock_name)
daily_20131029_addname_dataframe=pd.DataFrame()
daily_20131029_addname_dataframe['cname'] = daily_20131029_tscode_list
for table_name in daily_20131029.columns.values.tolist():
    daily_20131029_addname_dataframe[table_name] = daily_20131029[table_name]
print("日线行情-时间为序  daily_20131029 返回数据 row 行数 = "+str(daily_20131029.shape[0]))
daily_20131029_addname_dataframe.to_excel(daily_201310_excel_writer,'29_2',index=False)
daily_201310_excel_writer.save()
daily_20131030 = pro.daily(start_date='',end_date='',trade_date='20131030', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20131030_tscode_list = list() 
for ts_code_sh in daily_20131030['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20131030_tscode_list.append(stock_name)
daily_20131030_addname_dataframe=pd.DataFrame()
daily_20131030_addname_dataframe['cname'] = daily_20131030_tscode_list
for table_name in daily_20131030.columns.values.tolist():
    daily_20131030_addname_dataframe[table_name] = daily_20131030[table_name]
print("日线行情-时间为序  daily_20131030 返回数据 row 行数 = "+str(daily_20131030.shape[0]))
daily_20131030_addname_dataframe.to_excel(daily_201310_excel_writer,'30_3',index=False)
daily_201310_excel_writer.save()
daily_20131031 = pro.daily(start_date='',end_date='',trade_date='20131031', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20131031_tscode_list = list() 
for ts_code_sh in daily_20131031['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20131031_tscode_list.append(stock_name)
daily_20131031_addname_dataframe=pd.DataFrame()
daily_20131031_addname_dataframe['cname'] = daily_20131031_tscode_list
for table_name in daily_20131031.columns.values.tolist():
    daily_20131031_addname_dataframe[table_name] = daily_20131031[table_name]
print("日线行情-时间为序  daily_20131031 返回数据 row 行数 = "+str(daily_20131031.shape[0]))
daily_20131031_addname_dataframe.to_excel(daily_201310_excel_writer,'31_4',index=False)
daily_201310_excel_writer.save()




createexcel('daily_201311.xlsx')
daily_201311_book = load_workbook('C:\\Users\\zhuzj5\\Desktop\\zbin\\J0_Data\\daily_201311.xlsx')
daily_201311_excel_writer = pd.ExcelWriter('C:\\Users\\zhuzj5\\Desktop\\zbin\\J0_Data\\daily_201311.xlsx', engine='openpyxl')
daily_201311_excel_writer.book = daily_201311_book
daily_201311_excel_writer.sheets = dict((ws.title, ws) for ws in daily_201311_book.worksheets)
J0_PROPS.put(tree_node_name+"record_date", "20131101")       ###  更新 记录日期
daily_20131101 = pro.daily(start_date='',end_date='',trade_date='20131101', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20131101_tscode_list = list() 
for ts_code_sh in daily_20131101['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20131101_tscode_list.append(stock_name)
daily_20131101_addname_dataframe=pd.DataFrame()
daily_20131101_addname_dataframe['cname'] = daily_20131101_tscode_list
for table_name in daily_20131101.columns.values.tolist():
    daily_20131101_addname_dataframe[table_name] = daily_20131101[table_name]
print("日线行情-时间为序  daily_20131101 返回数据 row 行数 = "+str(daily_20131101.shape[0]))
daily_20131101_addname_dataframe.to_excel(daily_201311_excel_writer,'1_5',index=False)
daily_201311_excel_writer.save()
daily_20131104 = pro.daily(start_date='',end_date='',trade_date='20131104', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20131104_tscode_list = list() 
for ts_code_sh in daily_20131104['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20131104_tscode_list.append(stock_name)
daily_20131104_addname_dataframe=pd.DataFrame()
daily_20131104_addname_dataframe['cname'] = daily_20131104_tscode_list
for table_name in daily_20131104.columns.values.tolist():
    daily_20131104_addname_dataframe[table_name] = daily_20131104[table_name]
print("日线行情-时间为序  daily_20131104 返回数据 row 行数 = "+str(daily_20131104.shape[0]))
daily_20131104_addname_dataframe.to_excel(daily_201311_excel_writer,'4_1',index=False)
daily_201311_excel_writer.save()
daily_20131105 = pro.daily(start_date='',end_date='',trade_date='20131105', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20131105_tscode_list = list() 
for ts_code_sh in daily_20131105['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20131105_tscode_list.append(stock_name)
daily_20131105_addname_dataframe=pd.DataFrame()
daily_20131105_addname_dataframe['cname'] = daily_20131105_tscode_list
for table_name in daily_20131105.columns.values.tolist():
    daily_20131105_addname_dataframe[table_name] = daily_20131105[table_name]
print("日线行情-时间为序  daily_20131105 返回数据 row 行数 = "+str(daily_20131105.shape[0]))
daily_20131105_addname_dataframe.to_excel(daily_201311_excel_writer,'5_2',index=False)
daily_201311_excel_writer.save()
daily_20131106 = pro.daily(start_date='',end_date='',trade_date='20131106', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20131106_tscode_list = list() 
for ts_code_sh in daily_20131106['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20131106_tscode_list.append(stock_name)
daily_20131106_addname_dataframe=pd.DataFrame()
daily_20131106_addname_dataframe['cname'] = daily_20131106_tscode_list
for table_name in daily_20131106.columns.values.tolist():
    daily_20131106_addname_dataframe[table_name] = daily_20131106[table_name]
print("日线行情-时间为序  daily_20131106 返回数据 row 行数 = "+str(daily_20131106.shape[0]))
daily_20131106_addname_dataframe.to_excel(daily_201311_excel_writer,'6_3',index=False)
daily_201311_excel_writer.save()
daily_20131107 = pro.daily(start_date='',end_date='',trade_date='20131107', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20131107_tscode_list = list() 
for ts_code_sh in daily_20131107['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20131107_tscode_list.append(stock_name)
daily_20131107_addname_dataframe=pd.DataFrame()
daily_20131107_addname_dataframe['cname'] = daily_20131107_tscode_list
for table_name in daily_20131107.columns.values.tolist():
    daily_20131107_addname_dataframe[table_name] = daily_20131107[table_name]
print("日线行情-时间为序  daily_20131107 返回数据 row 行数 = "+str(daily_20131107.shape[0]))
daily_20131107_addname_dataframe.to_excel(daily_201311_excel_writer,'7_4',index=False)
daily_201311_excel_writer.save()
daily_20131108 = pro.daily(start_date='',end_date='',trade_date='20131108', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20131108_tscode_list = list() 
for ts_code_sh in daily_20131108['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20131108_tscode_list.append(stock_name)
daily_20131108_addname_dataframe=pd.DataFrame()
daily_20131108_addname_dataframe['cname'] = daily_20131108_tscode_list
for table_name in daily_20131108.columns.values.tolist():
    daily_20131108_addname_dataframe[table_name] = daily_20131108[table_name]
print("日线行情-时间为序  daily_20131108 返回数据 row 行数 = "+str(daily_20131108.shape[0]))
daily_20131108_addname_dataframe.to_excel(daily_201311_excel_writer,'8_5',index=False)
daily_201311_excel_writer.save()
daily_20131111 = pro.daily(start_date='',end_date='',trade_date='20131111', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20131111_tscode_list = list() 
for ts_code_sh in daily_20131111['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20131111_tscode_list.append(stock_name)
daily_20131111_addname_dataframe=pd.DataFrame()
daily_20131111_addname_dataframe['cname'] = daily_20131111_tscode_list
for table_name in daily_20131111.columns.values.tolist():
    daily_20131111_addname_dataframe[table_name] = daily_20131111[table_name]
print("日线行情-时间为序  daily_20131111 返回数据 row 行数 = "+str(daily_20131111.shape[0]))
daily_20131111_addname_dataframe.to_excel(daily_201311_excel_writer,'11_1',index=False)
daily_201311_excel_writer.save()
daily_20131112 = pro.daily(start_date='',end_date='',trade_date='20131112', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20131112_tscode_list = list() 
for ts_code_sh in daily_20131112['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20131112_tscode_list.append(stock_name)
daily_20131112_addname_dataframe=pd.DataFrame()
daily_20131112_addname_dataframe['cname'] = daily_20131112_tscode_list
for table_name in daily_20131112.columns.values.tolist():
    daily_20131112_addname_dataframe[table_name] = daily_20131112[table_name]
print("日线行情-时间为序  daily_20131112 返回数据 row 行数 = "+str(daily_20131112.shape[0]))
daily_20131112_addname_dataframe.to_excel(daily_201311_excel_writer,'12_2',index=False)
daily_201311_excel_writer.save()
daily_20131113 = pro.daily(start_date='',end_date='',trade_date='20131113', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20131113_tscode_list = list() 
for ts_code_sh in daily_20131113['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20131113_tscode_list.append(stock_name)
daily_20131113_addname_dataframe=pd.DataFrame()
daily_20131113_addname_dataframe['cname'] = daily_20131113_tscode_list
for table_name in daily_20131113.columns.values.tolist():
    daily_20131113_addname_dataframe[table_name] = daily_20131113[table_name]
print("日线行情-时间为序  daily_20131113 返回数据 row 行数 = "+str(daily_20131113.shape[0]))
daily_20131113_addname_dataframe.to_excel(daily_201311_excel_writer,'13_3',index=False)
daily_201311_excel_writer.save()
daily_20131114 = pro.daily(start_date='',end_date='',trade_date='20131114', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20131114_tscode_list = list() 
for ts_code_sh in daily_20131114['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20131114_tscode_list.append(stock_name)
daily_20131114_addname_dataframe=pd.DataFrame()
daily_20131114_addname_dataframe['cname'] = daily_20131114_tscode_list
for table_name in daily_20131114.columns.values.tolist():
    daily_20131114_addname_dataframe[table_name] = daily_20131114[table_name]
print("日线行情-时间为序  daily_20131114 返回数据 row 行数 = "+str(daily_20131114.shape[0]))
daily_20131114_addname_dataframe.to_excel(daily_201311_excel_writer,'14_4',index=False)
daily_201311_excel_writer.save()
daily_20131115 = pro.daily(start_date='',end_date='',trade_date='20131115', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20131115_tscode_list = list() 
for ts_code_sh in daily_20131115['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20131115_tscode_list.append(stock_name)
daily_20131115_addname_dataframe=pd.DataFrame()
daily_20131115_addname_dataframe['cname'] = daily_20131115_tscode_list
for table_name in daily_20131115.columns.values.tolist():
    daily_20131115_addname_dataframe[table_name] = daily_20131115[table_name]
print("日线行情-时间为序  daily_20131115 返回数据 row 行数 = "+str(daily_20131115.shape[0]))
daily_20131115_addname_dataframe.to_excel(daily_201311_excel_writer,'15_5',index=False)
daily_201311_excel_writer.save()
daily_20131118 = pro.daily(start_date='',end_date='',trade_date='20131118', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20131118_tscode_list = list() 
for ts_code_sh in daily_20131118['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20131118_tscode_list.append(stock_name)
daily_20131118_addname_dataframe=pd.DataFrame()
daily_20131118_addname_dataframe['cname'] = daily_20131118_tscode_list
for table_name in daily_20131118.columns.values.tolist():
    daily_20131118_addname_dataframe[table_name] = daily_20131118[table_name]
print("日线行情-时间为序  daily_20131118 返回数据 row 行数 = "+str(daily_20131118.shape[0]))
daily_20131118_addname_dataframe.to_excel(daily_201311_excel_writer,'18_1',index=False)
daily_201311_excel_writer.save()
daily_20131119 = pro.daily(start_date='',end_date='',trade_date='20131119', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20131119_tscode_list = list() 
for ts_code_sh in daily_20131119['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20131119_tscode_list.append(stock_name)
daily_20131119_addname_dataframe=pd.DataFrame()
daily_20131119_addname_dataframe['cname'] = daily_20131119_tscode_list
for table_name in daily_20131119.columns.values.tolist():
    daily_20131119_addname_dataframe[table_name] = daily_20131119[table_name]
print("日线行情-时间为序  daily_20131119 返回数据 row 行数 = "+str(daily_20131119.shape[0]))
daily_20131119_addname_dataframe.to_excel(daily_201311_excel_writer,'19_2',index=False)
daily_201311_excel_writer.save()
daily_20131120 = pro.daily(start_date='',end_date='',trade_date='20131120', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20131120_tscode_list = list() 
for ts_code_sh in daily_20131120['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20131120_tscode_list.append(stock_name)
daily_20131120_addname_dataframe=pd.DataFrame()
daily_20131120_addname_dataframe['cname'] = daily_20131120_tscode_list
for table_name in daily_20131120.columns.values.tolist():
    daily_20131120_addname_dataframe[table_name] = daily_20131120[table_name]
print("日线行情-时间为序  daily_20131120 返回数据 row 行数 = "+str(daily_20131120.shape[0]))
daily_20131120_addname_dataframe.to_excel(daily_201311_excel_writer,'20_3',index=False)
daily_201311_excel_writer.save()
daily_20131121 = pro.daily(start_date='',end_date='',trade_date='20131121', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20131121_tscode_list = list() 
for ts_code_sh in daily_20131121['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20131121_tscode_list.append(stock_name)
daily_20131121_addname_dataframe=pd.DataFrame()
daily_20131121_addname_dataframe['cname'] = daily_20131121_tscode_list
for table_name in daily_20131121.columns.values.tolist():
    daily_20131121_addname_dataframe[table_name] = daily_20131121[table_name]
print("日线行情-时间为序  daily_20131121 返回数据 row 行数 = "+str(daily_20131121.shape[0]))
daily_20131121_addname_dataframe.to_excel(daily_201311_excel_writer,'21_4',index=False)
daily_201311_excel_writer.save()
daily_20131122 = pro.daily(start_date='',end_date='',trade_date='20131122', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20131122_tscode_list = list() 
for ts_code_sh in daily_20131122['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20131122_tscode_list.append(stock_name)
daily_20131122_addname_dataframe=pd.DataFrame()
daily_20131122_addname_dataframe['cname'] = daily_20131122_tscode_list
for table_name in daily_20131122.columns.values.tolist():
    daily_20131122_addname_dataframe[table_name] = daily_20131122[table_name]
print("日线行情-时间为序  daily_20131122 返回数据 row 行数 = "+str(daily_20131122.shape[0]))
daily_20131122_addname_dataframe.to_excel(daily_201311_excel_writer,'22_5',index=False)
daily_201311_excel_writer.save()
daily_20131125 = pro.daily(start_date='',end_date='',trade_date='20131125', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20131125_tscode_list = list() 
for ts_code_sh in daily_20131125['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20131125_tscode_list.append(stock_name)
daily_20131125_addname_dataframe=pd.DataFrame()
daily_20131125_addname_dataframe['cname'] = daily_20131125_tscode_list
for table_name in daily_20131125.columns.values.tolist():
    daily_20131125_addname_dataframe[table_name] = daily_20131125[table_name]
print("日线行情-时间为序  daily_20131125 返回数据 row 行数 = "+str(daily_20131125.shape[0]))
daily_20131125_addname_dataframe.to_excel(daily_201311_excel_writer,'25_1',index=False)
daily_201311_excel_writer.save()
daily_20131126 = pro.daily(start_date='',end_date='',trade_date='20131126', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20131126_tscode_list = list() 
for ts_code_sh in daily_20131126['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20131126_tscode_list.append(stock_name)
daily_20131126_addname_dataframe=pd.DataFrame()
daily_20131126_addname_dataframe['cname'] = daily_20131126_tscode_list
for table_name in daily_20131126.columns.values.tolist():
    daily_20131126_addname_dataframe[table_name] = daily_20131126[table_name]
print("日线行情-时间为序  daily_20131126 返回数据 row 行数 = "+str(daily_20131126.shape[0]))
daily_20131126_addname_dataframe.to_excel(daily_201311_excel_writer,'26_2',index=False)
daily_201311_excel_writer.save()
daily_20131127 = pro.daily(start_date='',end_date='',trade_date='20131127', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20131127_tscode_list = list() 
for ts_code_sh in daily_20131127['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20131127_tscode_list.append(stock_name)
daily_20131127_addname_dataframe=pd.DataFrame()
daily_20131127_addname_dataframe['cname'] = daily_20131127_tscode_list
for table_name in daily_20131127.columns.values.tolist():
    daily_20131127_addname_dataframe[table_name] = daily_20131127[table_name]
print("日线行情-时间为序  daily_20131127 返回数据 row 行数 = "+str(daily_20131127.shape[0]))
daily_20131127_addname_dataframe.to_excel(daily_201311_excel_writer,'27_3',index=False)
daily_201311_excel_writer.save()
daily_20131128 = pro.daily(start_date='',end_date='',trade_date='20131128', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20131128_tscode_list = list() 
for ts_code_sh in daily_20131128['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20131128_tscode_list.append(stock_name)
daily_20131128_addname_dataframe=pd.DataFrame()
daily_20131128_addname_dataframe['cname'] = daily_20131128_tscode_list
for table_name in daily_20131128.columns.values.tolist():
    daily_20131128_addname_dataframe[table_name] = daily_20131128[table_name]
print("日线行情-时间为序  daily_20131128 返回数据 row 行数 = "+str(daily_20131128.shape[0]))
daily_20131128_addname_dataframe.to_excel(daily_201311_excel_writer,'28_4',index=False)
daily_201311_excel_writer.save()
daily_20131129 = pro.daily(start_date='',end_date='',trade_date='20131129', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20131129_tscode_list = list() 
for ts_code_sh in daily_20131129['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20131129_tscode_list.append(stock_name)
daily_20131129_addname_dataframe=pd.DataFrame()
daily_20131129_addname_dataframe['cname'] = daily_20131129_tscode_list
for table_name in daily_20131129.columns.values.tolist():
    daily_20131129_addname_dataframe[table_name] = daily_20131129[table_name]
print("日线行情-时间为序  daily_20131129 返回数据 row 行数 = "+str(daily_20131129.shape[0]))
daily_20131129_addname_dataframe.to_excel(daily_201311_excel_writer,'29_5',index=False)
daily_201311_excel_writer.save()




createexcel('daily_201312.xlsx')
daily_201312_book = load_workbook('C:\\Users\\zhuzj5\\Desktop\\zbin\\J0_Data\\daily_201312.xlsx')
daily_201312_excel_writer = pd.ExcelWriter('C:\\Users\\zhuzj5\\Desktop\\zbin\\J0_Data\\daily_201312.xlsx', engine='openpyxl')
daily_201312_excel_writer.book = daily_201312_book
daily_201312_excel_writer.sheets = dict((ws.title, ws) for ws in daily_201312_book.worksheets)
J0_PROPS.put(tree_node_name+"record_date", "20131201")       ###  更新 记录日期
daily_20131202 = pro.daily(start_date='',end_date='',trade_date='20131202', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20131202_tscode_list = list() 
for ts_code_sh in daily_20131202['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20131202_tscode_list.append(stock_name)
daily_20131202_addname_dataframe=pd.DataFrame()
daily_20131202_addname_dataframe['cname'] = daily_20131202_tscode_list
for table_name in daily_20131202.columns.values.tolist():
    daily_20131202_addname_dataframe[table_name] = daily_20131202[table_name]
print("日线行情-时间为序  daily_20131202 返回数据 row 行数 = "+str(daily_20131202.shape[0]))
daily_20131202_addname_dataframe.to_excel(daily_201312_excel_writer,'2_1',index=False)
daily_201312_excel_writer.save()
daily_20131203 = pro.daily(start_date='',end_date='',trade_date='20131203', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20131203_tscode_list = list() 
for ts_code_sh in daily_20131203['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20131203_tscode_list.append(stock_name)
daily_20131203_addname_dataframe=pd.DataFrame()
daily_20131203_addname_dataframe['cname'] = daily_20131203_tscode_list
for table_name in daily_20131203.columns.values.tolist():
    daily_20131203_addname_dataframe[table_name] = daily_20131203[table_name]
print("日线行情-时间为序  daily_20131203 返回数据 row 行数 = "+str(daily_20131203.shape[0]))
daily_20131203_addname_dataframe.to_excel(daily_201312_excel_writer,'3_2',index=False)
daily_201312_excel_writer.save()
daily_20131204 = pro.daily(start_date='',end_date='',trade_date='20131204', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20131204_tscode_list = list() 
for ts_code_sh in daily_20131204['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20131204_tscode_list.append(stock_name)
daily_20131204_addname_dataframe=pd.DataFrame()
daily_20131204_addname_dataframe['cname'] = daily_20131204_tscode_list
for table_name in daily_20131204.columns.values.tolist():
    daily_20131204_addname_dataframe[table_name] = daily_20131204[table_name]
print("日线行情-时间为序  daily_20131204 返回数据 row 行数 = "+str(daily_20131204.shape[0]))
daily_20131204_addname_dataframe.to_excel(daily_201312_excel_writer,'4_3',index=False)
daily_201312_excel_writer.save()
daily_20131205 = pro.daily(start_date='',end_date='',trade_date='20131205', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20131205_tscode_list = list() 
for ts_code_sh in daily_20131205['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20131205_tscode_list.append(stock_name)
daily_20131205_addname_dataframe=pd.DataFrame()
daily_20131205_addname_dataframe['cname'] = daily_20131205_tscode_list
for table_name in daily_20131205.columns.values.tolist():
    daily_20131205_addname_dataframe[table_name] = daily_20131205[table_name]
print("日线行情-时间为序  daily_20131205 返回数据 row 行数 = "+str(daily_20131205.shape[0]))
daily_20131205_addname_dataframe.to_excel(daily_201312_excel_writer,'5_4',index=False)
daily_201312_excel_writer.save()
daily_20131206 = pro.daily(start_date='',end_date='',trade_date='20131206', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20131206_tscode_list = list() 
for ts_code_sh in daily_20131206['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20131206_tscode_list.append(stock_name)
daily_20131206_addname_dataframe=pd.DataFrame()
daily_20131206_addname_dataframe['cname'] = daily_20131206_tscode_list
for table_name in daily_20131206.columns.values.tolist():
    daily_20131206_addname_dataframe[table_name] = daily_20131206[table_name]
print("日线行情-时间为序  daily_20131206 返回数据 row 行数 = "+str(daily_20131206.shape[0]))
daily_20131206_addname_dataframe.to_excel(daily_201312_excel_writer,'6_5',index=False)
daily_201312_excel_writer.save()
daily_20131209 = pro.daily(start_date='',end_date='',trade_date='20131209', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20131209_tscode_list = list() 
for ts_code_sh in daily_20131209['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20131209_tscode_list.append(stock_name)
daily_20131209_addname_dataframe=pd.DataFrame()
daily_20131209_addname_dataframe['cname'] = daily_20131209_tscode_list
for table_name in daily_20131209.columns.values.tolist():
    daily_20131209_addname_dataframe[table_name] = daily_20131209[table_name]
print("日线行情-时间为序  daily_20131209 返回数据 row 行数 = "+str(daily_20131209.shape[0]))
daily_20131209_addname_dataframe.to_excel(daily_201312_excel_writer,'9_1',index=False)
daily_201312_excel_writer.save()
daily_20131210 = pro.daily(start_date='',end_date='',trade_date='20131210', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20131210_tscode_list = list() 
for ts_code_sh in daily_20131210['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20131210_tscode_list.append(stock_name)
daily_20131210_addname_dataframe=pd.DataFrame()
daily_20131210_addname_dataframe['cname'] = daily_20131210_tscode_list
for table_name in daily_20131210.columns.values.tolist():
    daily_20131210_addname_dataframe[table_name] = daily_20131210[table_name]
print("日线行情-时间为序  daily_20131210 返回数据 row 行数 = "+str(daily_20131210.shape[0]))
daily_20131210_addname_dataframe.to_excel(daily_201312_excel_writer,'10_2',index=False)
daily_201312_excel_writer.save()
daily_20131211 = pro.daily(start_date='',end_date='',trade_date='20131211', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20131211_tscode_list = list() 
for ts_code_sh in daily_20131211['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20131211_tscode_list.append(stock_name)
daily_20131211_addname_dataframe=pd.DataFrame()
daily_20131211_addname_dataframe['cname'] = daily_20131211_tscode_list
for table_name in daily_20131211.columns.values.tolist():
    daily_20131211_addname_dataframe[table_name] = daily_20131211[table_name]
print("日线行情-时间为序  daily_20131211 返回数据 row 行数 = "+str(daily_20131211.shape[0]))
daily_20131211_addname_dataframe.to_excel(daily_201312_excel_writer,'11_3',index=False)
daily_201312_excel_writer.save()
daily_20131212 = pro.daily(start_date='',end_date='',trade_date='20131212', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20131212_tscode_list = list() 
for ts_code_sh in daily_20131212['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20131212_tscode_list.append(stock_name)
daily_20131212_addname_dataframe=pd.DataFrame()
daily_20131212_addname_dataframe['cname'] = daily_20131212_tscode_list
for table_name in daily_20131212.columns.values.tolist():
    daily_20131212_addname_dataframe[table_name] = daily_20131212[table_name]
print("日线行情-时间为序  daily_20131212 返回数据 row 行数 = "+str(daily_20131212.shape[0]))
daily_20131212_addname_dataframe.to_excel(daily_201312_excel_writer,'12_4',index=False)
daily_201312_excel_writer.save()
daily_20131213 = pro.daily(start_date='',end_date='',trade_date='20131213', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20131213_tscode_list = list() 
for ts_code_sh in daily_20131213['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20131213_tscode_list.append(stock_name)
daily_20131213_addname_dataframe=pd.DataFrame()
daily_20131213_addname_dataframe['cname'] = daily_20131213_tscode_list
for table_name in daily_20131213.columns.values.tolist():
    daily_20131213_addname_dataframe[table_name] = daily_20131213[table_name]
print("日线行情-时间为序  daily_20131213 返回数据 row 行数 = "+str(daily_20131213.shape[0]))
daily_20131213_addname_dataframe.to_excel(daily_201312_excel_writer,'13_5',index=False)
daily_201312_excel_writer.save()
daily_20131216 = pro.daily(start_date='',end_date='',trade_date='20131216', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20131216_tscode_list = list() 
for ts_code_sh in daily_20131216['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20131216_tscode_list.append(stock_name)
daily_20131216_addname_dataframe=pd.DataFrame()
daily_20131216_addname_dataframe['cname'] = daily_20131216_tscode_list
for table_name in daily_20131216.columns.values.tolist():
    daily_20131216_addname_dataframe[table_name] = daily_20131216[table_name]
print("日线行情-时间为序  daily_20131216 返回数据 row 行数 = "+str(daily_20131216.shape[0]))
daily_20131216_addname_dataframe.to_excel(daily_201312_excel_writer,'16_1',index=False)
daily_201312_excel_writer.save()
daily_20131217 = pro.daily(start_date='',end_date='',trade_date='20131217', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20131217_tscode_list = list() 
for ts_code_sh in daily_20131217['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20131217_tscode_list.append(stock_name)
daily_20131217_addname_dataframe=pd.DataFrame()
daily_20131217_addname_dataframe['cname'] = daily_20131217_tscode_list
for table_name in daily_20131217.columns.values.tolist():
    daily_20131217_addname_dataframe[table_name] = daily_20131217[table_name]
print("日线行情-时间为序  daily_20131217 返回数据 row 行数 = "+str(daily_20131217.shape[0]))
daily_20131217_addname_dataframe.to_excel(daily_201312_excel_writer,'17_2',index=False)
daily_201312_excel_writer.save()
daily_20131218 = pro.daily(start_date='',end_date='',trade_date='20131218', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20131218_tscode_list = list() 
for ts_code_sh in daily_20131218['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20131218_tscode_list.append(stock_name)
daily_20131218_addname_dataframe=pd.DataFrame()
daily_20131218_addname_dataframe['cname'] = daily_20131218_tscode_list
for table_name in daily_20131218.columns.values.tolist():
    daily_20131218_addname_dataframe[table_name] = daily_20131218[table_name]
print("日线行情-时间为序  daily_20131218 返回数据 row 行数 = "+str(daily_20131218.shape[0]))
daily_20131218_addname_dataframe.to_excel(daily_201312_excel_writer,'18_3',index=False)
daily_201312_excel_writer.save()
daily_20131219 = pro.daily(start_date='',end_date='',trade_date='20131219', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20131219_tscode_list = list() 
for ts_code_sh in daily_20131219['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20131219_tscode_list.append(stock_name)
daily_20131219_addname_dataframe=pd.DataFrame()
daily_20131219_addname_dataframe['cname'] = daily_20131219_tscode_list
for table_name in daily_20131219.columns.values.tolist():
    daily_20131219_addname_dataframe[table_name] = daily_20131219[table_name]
print("日线行情-时间为序  daily_20131219 返回数据 row 行数 = "+str(daily_20131219.shape[0]))
daily_20131219_addname_dataframe.to_excel(daily_201312_excel_writer,'19_4',index=False)
daily_201312_excel_writer.save()
daily_20131220 = pro.daily(start_date='',end_date='',trade_date='20131220', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20131220_tscode_list = list() 
for ts_code_sh in daily_20131220['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20131220_tscode_list.append(stock_name)
daily_20131220_addname_dataframe=pd.DataFrame()
daily_20131220_addname_dataframe['cname'] = daily_20131220_tscode_list
for table_name in daily_20131220.columns.values.tolist():
    daily_20131220_addname_dataframe[table_name] = daily_20131220[table_name]
print("日线行情-时间为序  daily_20131220 返回数据 row 行数 = "+str(daily_20131220.shape[0]))
daily_20131220_addname_dataframe.to_excel(daily_201312_excel_writer,'20_5',index=False)
daily_201312_excel_writer.save()
daily_20131223 = pro.daily(start_date='',end_date='',trade_date='20131223', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20131223_tscode_list = list() 
for ts_code_sh in daily_20131223['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20131223_tscode_list.append(stock_name)
daily_20131223_addname_dataframe=pd.DataFrame()
daily_20131223_addname_dataframe['cname'] = daily_20131223_tscode_list
for table_name in daily_20131223.columns.values.tolist():
    daily_20131223_addname_dataframe[table_name] = daily_20131223[table_name]
print("日线行情-时间为序  daily_20131223 返回数据 row 行数 = "+str(daily_20131223.shape[0]))
daily_20131223_addname_dataframe.to_excel(daily_201312_excel_writer,'23_1',index=False)
daily_201312_excel_writer.save()
daily_20131224 = pro.daily(start_date='',end_date='',trade_date='20131224', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20131224_tscode_list = list() 
for ts_code_sh in daily_20131224['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20131224_tscode_list.append(stock_name)
daily_20131224_addname_dataframe=pd.DataFrame()
daily_20131224_addname_dataframe['cname'] = daily_20131224_tscode_list
for table_name in daily_20131224.columns.values.tolist():
    daily_20131224_addname_dataframe[table_name] = daily_20131224[table_name]
print("日线行情-时间为序  daily_20131224 返回数据 row 行数 = "+str(daily_20131224.shape[0]))
daily_20131224_addname_dataframe.to_excel(daily_201312_excel_writer,'24_2',index=False)
daily_201312_excel_writer.save()
daily_20131225 = pro.daily(start_date='',end_date='',trade_date='20131225', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20131225_tscode_list = list() 
for ts_code_sh in daily_20131225['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20131225_tscode_list.append(stock_name)
daily_20131225_addname_dataframe=pd.DataFrame()
daily_20131225_addname_dataframe['cname'] = daily_20131225_tscode_list
for table_name in daily_20131225.columns.values.tolist():
    daily_20131225_addname_dataframe[table_name] = daily_20131225[table_name]
print("日线行情-时间为序  daily_20131225 返回数据 row 行数 = "+str(daily_20131225.shape[0]))
daily_20131225_addname_dataframe.to_excel(daily_201312_excel_writer,'25_3',index=False)
daily_201312_excel_writer.save()
daily_20131226 = pro.daily(start_date='',end_date='',trade_date='20131226', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20131226_tscode_list = list() 
for ts_code_sh in daily_20131226['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20131226_tscode_list.append(stock_name)
daily_20131226_addname_dataframe=pd.DataFrame()
daily_20131226_addname_dataframe['cname'] = daily_20131226_tscode_list
for table_name in daily_20131226.columns.values.tolist():
    daily_20131226_addname_dataframe[table_name] = daily_20131226[table_name]
print("日线行情-时间为序  daily_20131226 返回数据 row 行数 = "+str(daily_20131226.shape[0]))
daily_20131226_addname_dataframe.to_excel(daily_201312_excel_writer,'26_4',index=False)
daily_201312_excel_writer.save()
daily_20131227 = pro.daily(start_date='',end_date='',trade_date='20131227', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20131227_tscode_list = list() 
for ts_code_sh in daily_20131227['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20131227_tscode_list.append(stock_name)
daily_20131227_addname_dataframe=pd.DataFrame()
daily_20131227_addname_dataframe['cname'] = daily_20131227_tscode_list
for table_name in daily_20131227.columns.values.tolist():
    daily_20131227_addname_dataframe[table_name] = daily_20131227[table_name]
print("日线行情-时间为序  daily_20131227 返回数据 row 行数 = "+str(daily_20131227.shape[0]))
daily_20131227_addname_dataframe.to_excel(daily_201312_excel_writer,'27_5',index=False)
daily_201312_excel_writer.save()
daily_20131230 = pro.daily(start_date='',end_date='',trade_date='20131230', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20131230_tscode_list = list() 
for ts_code_sh in daily_20131230['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20131230_tscode_list.append(stock_name)
daily_20131230_addname_dataframe=pd.DataFrame()
daily_20131230_addname_dataframe['cname'] = daily_20131230_tscode_list
for table_name in daily_20131230.columns.values.tolist():
    daily_20131230_addname_dataframe[table_name] = daily_20131230[table_name]
print("日线行情-时间为序  daily_20131230 返回数据 row 行数 = "+str(daily_20131230.shape[0]))
daily_20131230_addname_dataframe.to_excel(daily_201312_excel_writer,'30_1',index=False)
daily_201312_excel_writer.save()
daily_20131231 = pro.daily(start_date='',end_date='',trade_date='20131231', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20131231_tscode_list = list() 
for ts_code_sh in daily_20131231['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20131231_tscode_list.append(stock_name)
daily_20131231_addname_dataframe=pd.DataFrame()
daily_20131231_addname_dataframe['cname'] = daily_20131231_tscode_list
for table_name in daily_20131231.columns.values.tolist():
    daily_20131231_addname_dataframe[table_name] = daily_20131231[table_name]
print("日线行情-时间为序  daily_20131231 返回数据 row 行数 = "+str(daily_20131231.shape[0]))
daily_20131231_addname_dataframe.to_excel(daily_201312_excel_writer,'31_2',index=False)
daily_201312_excel_writer.save()




createexcel('daily_201401.xlsx')
daily_201401_book = load_workbook('C:\\Users\\zhuzj5\\Desktop\\zbin\\J0_Data\\daily_201401.xlsx')
daily_201401_excel_writer = pd.ExcelWriter('C:\\Users\\zhuzj5\\Desktop\\zbin\\J0_Data\\daily_201401.xlsx', engine='openpyxl')
daily_201401_excel_writer.book = daily_201401_book
daily_201401_excel_writer.sheets = dict((ws.title, ws) for ws in daily_201401_book.worksheets)
J0_PROPS.put(tree_node_name+"record_date", "20140101")       ###  更新 记录日期
daily_20140102 = pro.daily(start_date='',end_date='',trade_date='20140102', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20140102_tscode_list = list() 
for ts_code_sh in daily_20140102['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20140102_tscode_list.append(stock_name)
daily_20140102_addname_dataframe=pd.DataFrame()
daily_20140102_addname_dataframe['cname'] = daily_20140102_tscode_list
for table_name in daily_20140102.columns.values.tolist():
    daily_20140102_addname_dataframe[table_name] = daily_20140102[table_name]
print("日线行情-时间为序  daily_20140102 返回数据 row 行数 = "+str(daily_20140102.shape[0]))
daily_20140102_addname_dataframe.to_excel(daily_201401_excel_writer,'2_4',index=False)
daily_201401_excel_writer.save()
daily_20140103 = pro.daily(start_date='',end_date='',trade_date='20140103', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20140103_tscode_list = list() 
for ts_code_sh in daily_20140103['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20140103_tscode_list.append(stock_name)
daily_20140103_addname_dataframe=pd.DataFrame()
daily_20140103_addname_dataframe['cname'] = daily_20140103_tscode_list
for table_name in daily_20140103.columns.values.tolist():
    daily_20140103_addname_dataframe[table_name] = daily_20140103[table_name]
print("日线行情-时间为序  daily_20140103 返回数据 row 行数 = "+str(daily_20140103.shape[0]))
daily_20140103_addname_dataframe.to_excel(daily_201401_excel_writer,'3_5',index=False)
daily_201401_excel_writer.save()
daily_20140106 = pro.daily(start_date='',end_date='',trade_date='20140106', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20140106_tscode_list = list() 
for ts_code_sh in daily_20140106['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20140106_tscode_list.append(stock_name)
daily_20140106_addname_dataframe=pd.DataFrame()
daily_20140106_addname_dataframe['cname'] = daily_20140106_tscode_list
for table_name in daily_20140106.columns.values.tolist():
    daily_20140106_addname_dataframe[table_name] = daily_20140106[table_name]
print("日线行情-时间为序  daily_20140106 返回数据 row 行数 = "+str(daily_20140106.shape[0]))
daily_20140106_addname_dataframe.to_excel(daily_201401_excel_writer,'6_1',index=False)
daily_201401_excel_writer.save()
daily_20140107 = pro.daily(start_date='',end_date='',trade_date='20140107', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20140107_tscode_list = list() 
for ts_code_sh in daily_20140107['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20140107_tscode_list.append(stock_name)
daily_20140107_addname_dataframe=pd.DataFrame()
daily_20140107_addname_dataframe['cname'] = daily_20140107_tscode_list
for table_name in daily_20140107.columns.values.tolist():
    daily_20140107_addname_dataframe[table_name] = daily_20140107[table_name]
print("日线行情-时间为序  daily_20140107 返回数据 row 行数 = "+str(daily_20140107.shape[0]))
daily_20140107_addname_dataframe.to_excel(daily_201401_excel_writer,'7_2',index=False)
daily_201401_excel_writer.save()
daily_20140108 = pro.daily(start_date='',end_date='',trade_date='20140108', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20140108_tscode_list = list() 
for ts_code_sh in daily_20140108['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20140108_tscode_list.append(stock_name)
daily_20140108_addname_dataframe=pd.DataFrame()
daily_20140108_addname_dataframe['cname'] = daily_20140108_tscode_list
for table_name in daily_20140108.columns.values.tolist():
    daily_20140108_addname_dataframe[table_name] = daily_20140108[table_name]
print("日线行情-时间为序  daily_20140108 返回数据 row 行数 = "+str(daily_20140108.shape[0]))
daily_20140108_addname_dataframe.to_excel(daily_201401_excel_writer,'8_3',index=False)
daily_201401_excel_writer.save()
daily_20140109 = pro.daily(start_date='',end_date='',trade_date='20140109', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20140109_tscode_list = list() 
for ts_code_sh in daily_20140109['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20140109_tscode_list.append(stock_name)
daily_20140109_addname_dataframe=pd.DataFrame()
daily_20140109_addname_dataframe['cname'] = daily_20140109_tscode_list
for table_name in daily_20140109.columns.values.tolist():
    daily_20140109_addname_dataframe[table_name] = daily_20140109[table_name]
print("日线行情-时间为序  daily_20140109 返回数据 row 行数 = "+str(daily_20140109.shape[0]))
daily_20140109_addname_dataframe.to_excel(daily_201401_excel_writer,'9_4',index=False)
daily_201401_excel_writer.save()
daily_20140110 = pro.daily(start_date='',end_date='',trade_date='20140110', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20140110_tscode_list = list() 
for ts_code_sh in daily_20140110['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20140110_tscode_list.append(stock_name)
daily_20140110_addname_dataframe=pd.DataFrame()
daily_20140110_addname_dataframe['cname'] = daily_20140110_tscode_list
for table_name in daily_20140110.columns.values.tolist():
    daily_20140110_addname_dataframe[table_name] = daily_20140110[table_name]
print("日线行情-时间为序  daily_20140110 返回数据 row 行数 = "+str(daily_20140110.shape[0]))
daily_20140110_addname_dataframe.to_excel(daily_201401_excel_writer,'10_5',index=False)
daily_201401_excel_writer.save()
daily_20140113 = pro.daily(start_date='',end_date='',trade_date='20140113', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20140113_tscode_list = list() 
for ts_code_sh in daily_20140113['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20140113_tscode_list.append(stock_name)
daily_20140113_addname_dataframe=pd.DataFrame()
daily_20140113_addname_dataframe['cname'] = daily_20140113_tscode_list
for table_name in daily_20140113.columns.values.tolist():
    daily_20140113_addname_dataframe[table_name] = daily_20140113[table_name]
print("日线行情-时间为序  daily_20140113 返回数据 row 行数 = "+str(daily_20140113.shape[0]))
daily_20140113_addname_dataframe.to_excel(daily_201401_excel_writer,'13_1',index=False)
daily_201401_excel_writer.save()
daily_20140114 = pro.daily(start_date='',end_date='',trade_date='20140114', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20140114_tscode_list = list() 
for ts_code_sh in daily_20140114['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20140114_tscode_list.append(stock_name)
daily_20140114_addname_dataframe=pd.DataFrame()
daily_20140114_addname_dataframe['cname'] = daily_20140114_tscode_list
for table_name in daily_20140114.columns.values.tolist():
    daily_20140114_addname_dataframe[table_name] = daily_20140114[table_name]
print("日线行情-时间为序  daily_20140114 返回数据 row 行数 = "+str(daily_20140114.shape[0]))
daily_20140114_addname_dataframe.to_excel(daily_201401_excel_writer,'14_2',index=False)
daily_201401_excel_writer.save()
daily_20140115 = pro.daily(start_date='',end_date='',trade_date='20140115', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20140115_tscode_list = list() 
for ts_code_sh in daily_20140115['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20140115_tscode_list.append(stock_name)
daily_20140115_addname_dataframe=pd.DataFrame()
daily_20140115_addname_dataframe['cname'] = daily_20140115_tscode_list
for table_name in daily_20140115.columns.values.tolist():
    daily_20140115_addname_dataframe[table_name] = daily_20140115[table_name]
print("日线行情-时间为序  daily_20140115 返回数据 row 行数 = "+str(daily_20140115.shape[0]))
daily_20140115_addname_dataframe.to_excel(daily_201401_excel_writer,'15_3',index=False)
daily_201401_excel_writer.save()
daily_20140116 = pro.daily(start_date='',end_date='',trade_date='20140116', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20140116_tscode_list = list() 
for ts_code_sh in daily_20140116['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20140116_tscode_list.append(stock_name)
daily_20140116_addname_dataframe=pd.DataFrame()
daily_20140116_addname_dataframe['cname'] = daily_20140116_tscode_list
for table_name in daily_20140116.columns.values.tolist():
    daily_20140116_addname_dataframe[table_name] = daily_20140116[table_name]
print("日线行情-时间为序  daily_20140116 返回数据 row 行数 = "+str(daily_20140116.shape[0]))
daily_20140116_addname_dataframe.to_excel(daily_201401_excel_writer,'16_4',index=False)
daily_201401_excel_writer.save()
daily_20140117 = pro.daily(start_date='',end_date='',trade_date='20140117', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20140117_tscode_list = list() 
for ts_code_sh in daily_20140117['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20140117_tscode_list.append(stock_name)
daily_20140117_addname_dataframe=pd.DataFrame()
daily_20140117_addname_dataframe['cname'] = daily_20140117_tscode_list
for table_name in daily_20140117.columns.values.tolist():
    daily_20140117_addname_dataframe[table_name] = daily_20140117[table_name]
print("日线行情-时间为序  daily_20140117 返回数据 row 行数 = "+str(daily_20140117.shape[0]))
daily_20140117_addname_dataframe.to_excel(daily_201401_excel_writer,'17_5',index=False)
daily_201401_excel_writer.save()
daily_20140120 = pro.daily(start_date='',end_date='',trade_date='20140120', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20140120_tscode_list = list() 
for ts_code_sh in daily_20140120['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20140120_tscode_list.append(stock_name)
daily_20140120_addname_dataframe=pd.DataFrame()
daily_20140120_addname_dataframe['cname'] = daily_20140120_tscode_list
for table_name in daily_20140120.columns.values.tolist():
    daily_20140120_addname_dataframe[table_name] = daily_20140120[table_name]
print("日线行情-时间为序  daily_20140120 返回数据 row 行数 = "+str(daily_20140120.shape[0]))
daily_20140120_addname_dataframe.to_excel(daily_201401_excel_writer,'20_1',index=False)
daily_201401_excel_writer.save()
daily_20140121 = pro.daily(start_date='',end_date='',trade_date='20140121', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20140121_tscode_list = list() 
for ts_code_sh in daily_20140121['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20140121_tscode_list.append(stock_name)
daily_20140121_addname_dataframe=pd.DataFrame()
daily_20140121_addname_dataframe['cname'] = daily_20140121_tscode_list
for table_name in daily_20140121.columns.values.tolist():
    daily_20140121_addname_dataframe[table_name] = daily_20140121[table_name]
print("日线行情-时间为序  daily_20140121 返回数据 row 行数 = "+str(daily_20140121.shape[0]))
daily_20140121_addname_dataframe.to_excel(daily_201401_excel_writer,'21_2',index=False)
daily_201401_excel_writer.save()
daily_20140122 = pro.daily(start_date='',end_date='',trade_date='20140122', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20140122_tscode_list = list() 
for ts_code_sh in daily_20140122['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20140122_tscode_list.append(stock_name)
daily_20140122_addname_dataframe=pd.DataFrame()
daily_20140122_addname_dataframe['cname'] = daily_20140122_tscode_list
for table_name in daily_20140122.columns.values.tolist():
    daily_20140122_addname_dataframe[table_name] = daily_20140122[table_name]
print("日线行情-时间为序  daily_20140122 返回数据 row 行数 = "+str(daily_20140122.shape[0]))
daily_20140122_addname_dataframe.to_excel(daily_201401_excel_writer,'22_3',index=False)
daily_201401_excel_writer.save()
daily_20140123 = pro.daily(start_date='',end_date='',trade_date='20140123', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20140123_tscode_list = list() 
for ts_code_sh in daily_20140123['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20140123_tscode_list.append(stock_name)
daily_20140123_addname_dataframe=pd.DataFrame()
daily_20140123_addname_dataframe['cname'] = daily_20140123_tscode_list
for table_name in daily_20140123.columns.values.tolist():
    daily_20140123_addname_dataframe[table_name] = daily_20140123[table_name]
print("日线行情-时间为序  daily_20140123 返回数据 row 行数 = "+str(daily_20140123.shape[0]))
daily_20140123_addname_dataframe.to_excel(daily_201401_excel_writer,'23_4',index=False)
daily_201401_excel_writer.save()
daily_20140124 = pro.daily(start_date='',end_date='',trade_date='20140124', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20140124_tscode_list = list() 
for ts_code_sh in daily_20140124['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20140124_tscode_list.append(stock_name)
daily_20140124_addname_dataframe=pd.DataFrame()
daily_20140124_addname_dataframe['cname'] = daily_20140124_tscode_list
for table_name in daily_20140124.columns.values.tolist():
    daily_20140124_addname_dataframe[table_name] = daily_20140124[table_name]
print("日线行情-时间为序  daily_20140124 返回数据 row 行数 = "+str(daily_20140124.shape[0]))
daily_20140124_addname_dataframe.to_excel(daily_201401_excel_writer,'24_5',index=False)
daily_201401_excel_writer.save()
daily_20140127 = pro.daily(start_date='',end_date='',trade_date='20140127', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20140127_tscode_list = list() 
for ts_code_sh in daily_20140127['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20140127_tscode_list.append(stock_name)
daily_20140127_addname_dataframe=pd.DataFrame()
daily_20140127_addname_dataframe['cname'] = daily_20140127_tscode_list
for table_name in daily_20140127.columns.values.tolist():
    daily_20140127_addname_dataframe[table_name] = daily_20140127[table_name]
print("日线行情-时间为序  daily_20140127 返回数据 row 行数 = "+str(daily_20140127.shape[0]))
daily_20140127_addname_dataframe.to_excel(daily_201401_excel_writer,'27_1',index=False)
daily_201401_excel_writer.save()
daily_20140128 = pro.daily(start_date='',end_date='',trade_date='20140128', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20140128_tscode_list = list() 
for ts_code_sh in daily_20140128['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20140128_tscode_list.append(stock_name)
daily_20140128_addname_dataframe=pd.DataFrame()
daily_20140128_addname_dataframe['cname'] = daily_20140128_tscode_list
for table_name in daily_20140128.columns.values.tolist():
    daily_20140128_addname_dataframe[table_name] = daily_20140128[table_name]
print("日线行情-时间为序  daily_20140128 返回数据 row 行数 = "+str(daily_20140128.shape[0]))
daily_20140128_addname_dataframe.to_excel(daily_201401_excel_writer,'28_2',index=False)
daily_201401_excel_writer.save()
daily_20140129 = pro.daily(start_date='',end_date='',trade_date='20140129', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20140129_tscode_list = list() 
for ts_code_sh in daily_20140129['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20140129_tscode_list.append(stock_name)
daily_20140129_addname_dataframe=pd.DataFrame()
daily_20140129_addname_dataframe['cname'] = daily_20140129_tscode_list
for table_name in daily_20140129.columns.values.tolist():
    daily_20140129_addname_dataframe[table_name] = daily_20140129[table_name]
print("日线行情-时间为序  daily_20140129 返回数据 row 行数 = "+str(daily_20140129.shape[0]))
daily_20140129_addname_dataframe.to_excel(daily_201401_excel_writer,'29_3',index=False)
daily_201401_excel_writer.save()
daily_20140130 = pro.daily(start_date='',end_date='',trade_date='20140130', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20140130_tscode_list = list() 
for ts_code_sh in daily_20140130['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20140130_tscode_list.append(stock_name)
daily_20140130_addname_dataframe=pd.DataFrame()
daily_20140130_addname_dataframe['cname'] = daily_20140130_tscode_list
for table_name in daily_20140130.columns.values.tolist():
    daily_20140130_addname_dataframe[table_name] = daily_20140130[table_name]
print("日线行情-时间为序  daily_20140130 返回数据 row 行数 = "+str(daily_20140130.shape[0]))
daily_20140130_addname_dataframe.to_excel(daily_201401_excel_writer,'30_4',index=False)
daily_201401_excel_writer.save()




createexcel('daily_201402.xlsx')
daily_201402_book = load_workbook('C:\\Users\\zhuzj5\\Desktop\\zbin\\J0_Data\\daily_201402.xlsx')
daily_201402_excel_writer = pd.ExcelWriter('C:\\Users\\zhuzj5\\Desktop\\zbin\\J0_Data\\daily_201402.xlsx', engine='openpyxl')
daily_201402_excel_writer.book = daily_201402_book
daily_201402_excel_writer.sheets = dict((ws.title, ws) for ws in daily_201402_book.worksheets)
J0_PROPS.put(tree_node_name+"record_date", "20140201")       ###  更新 记录日期
daily_20140207 = pro.daily(start_date='',end_date='',trade_date='20140207', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20140207_tscode_list = list() 
for ts_code_sh in daily_20140207['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20140207_tscode_list.append(stock_name)
daily_20140207_addname_dataframe=pd.DataFrame()
daily_20140207_addname_dataframe['cname'] = daily_20140207_tscode_list
for table_name in daily_20140207.columns.values.tolist():
    daily_20140207_addname_dataframe[table_name] = daily_20140207[table_name]
print("日线行情-时间为序  daily_20140207 返回数据 row 行数 = "+str(daily_20140207.shape[0]))
daily_20140207_addname_dataframe.to_excel(daily_201402_excel_writer,'7_5',index=False)
daily_201402_excel_writer.save()
daily_20140210 = pro.daily(start_date='',end_date='',trade_date='20140210', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20140210_tscode_list = list() 
for ts_code_sh in daily_20140210['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20140210_tscode_list.append(stock_name)
daily_20140210_addname_dataframe=pd.DataFrame()
daily_20140210_addname_dataframe['cname'] = daily_20140210_tscode_list
for table_name in daily_20140210.columns.values.tolist():
    daily_20140210_addname_dataframe[table_name] = daily_20140210[table_name]
print("日线行情-时间为序  daily_20140210 返回数据 row 行数 = "+str(daily_20140210.shape[0]))
daily_20140210_addname_dataframe.to_excel(daily_201402_excel_writer,'10_1',index=False)
daily_201402_excel_writer.save()
daily_20140211 = pro.daily(start_date='',end_date='',trade_date='20140211', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20140211_tscode_list = list() 
for ts_code_sh in daily_20140211['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20140211_tscode_list.append(stock_name)
daily_20140211_addname_dataframe=pd.DataFrame()
daily_20140211_addname_dataframe['cname'] = daily_20140211_tscode_list
for table_name in daily_20140211.columns.values.tolist():
    daily_20140211_addname_dataframe[table_name] = daily_20140211[table_name]
print("日线行情-时间为序  daily_20140211 返回数据 row 行数 = "+str(daily_20140211.shape[0]))
daily_20140211_addname_dataframe.to_excel(daily_201402_excel_writer,'11_2',index=False)
daily_201402_excel_writer.save()
daily_20140212 = pro.daily(start_date='',end_date='',trade_date='20140212', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20140212_tscode_list = list() 
for ts_code_sh in daily_20140212['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20140212_tscode_list.append(stock_name)
daily_20140212_addname_dataframe=pd.DataFrame()
daily_20140212_addname_dataframe['cname'] = daily_20140212_tscode_list
for table_name in daily_20140212.columns.values.tolist():
    daily_20140212_addname_dataframe[table_name] = daily_20140212[table_name]
print("日线行情-时间为序  daily_20140212 返回数据 row 行数 = "+str(daily_20140212.shape[0]))
daily_20140212_addname_dataframe.to_excel(daily_201402_excel_writer,'12_3',index=False)
daily_201402_excel_writer.save()
daily_20140213 = pro.daily(start_date='',end_date='',trade_date='20140213', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20140213_tscode_list = list() 
for ts_code_sh in daily_20140213['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20140213_tscode_list.append(stock_name)
daily_20140213_addname_dataframe=pd.DataFrame()
daily_20140213_addname_dataframe['cname'] = daily_20140213_tscode_list
for table_name in daily_20140213.columns.values.tolist():
    daily_20140213_addname_dataframe[table_name] = daily_20140213[table_name]
print("日线行情-时间为序  daily_20140213 返回数据 row 行数 = "+str(daily_20140213.shape[0]))
daily_20140213_addname_dataframe.to_excel(daily_201402_excel_writer,'13_4',index=False)
daily_201402_excel_writer.save()
daily_20140214 = pro.daily(start_date='',end_date='',trade_date='20140214', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20140214_tscode_list = list() 
for ts_code_sh in daily_20140214['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20140214_tscode_list.append(stock_name)
daily_20140214_addname_dataframe=pd.DataFrame()
daily_20140214_addname_dataframe['cname'] = daily_20140214_tscode_list
for table_name in daily_20140214.columns.values.tolist():
    daily_20140214_addname_dataframe[table_name] = daily_20140214[table_name]
print("日线行情-时间为序  daily_20140214 返回数据 row 行数 = "+str(daily_20140214.shape[0]))
daily_20140214_addname_dataframe.to_excel(daily_201402_excel_writer,'14_5',index=False)
daily_201402_excel_writer.save()
daily_20140217 = pro.daily(start_date='',end_date='',trade_date='20140217', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20140217_tscode_list = list() 
for ts_code_sh in daily_20140217['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20140217_tscode_list.append(stock_name)
daily_20140217_addname_dataframe=pd.DataFrame()
daily_20140217_addname_dataframe['cname'] = daily_20140217_tscode_list
for table_name in daily_20140217.columns.values.tolist():
    daily_20140217_addname_dataframe[table_name] = daily_20140217[table_name]
print("日线行情-时间为序  daily_20140217 返回数据 row 行数 = "+str(daily_20140217.shape[0]))
daily_20140217_addname_dataframe.to_excel(daily_201402_excel_writer,'17_1',index=False)
daily_201402_excel_writer.save()
daily_20140218 = pro.daily(start_date='',end_date='',trade_date='20140218', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20140218_tscode_list = list() 
for ts_code_sh in daily_20140218['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20140218_tscode_list.append(stock_name)
daily_20140218_addname_dataframe=pd.DataFrame()
daily_20140218_addname_dataframe['cname'] = daily_20140218_tscode_list
for table_name in daily_20140218.columns.values.tolist():
    daily_20140218_addname_dataframe[table_name] = daily_20140218[table_name]
print("日线行情-时间为序  daily_20140218 返回数据 row 行数 = "+str(daily_20140218.shape[0]))
daily_20140218_addname_dataframe.to_excel(daily_201402_excel_writer,'18_2',index=False)
daily_201402_excel_writer.save()
daily_20140219 = pro.daily(start_date='',end_date='',trade_date='20140219', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20140219_tscode_list = list() 
for ts_code_sh in daily_20140219['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20140219_tscode_list.append(stock_name)
daily_20140219_addname_dataframe=pd.DataFrame()
daily_20140219_addname_dataframe['cname'] = daily_20140219_tscode_list
for table_name in daily_20140219.columns.values.tolist():
    daily_20140219_addname_dataframe[table_name] = daily_20140219[table_name]
print("日线行情-时间为序  daily_20140219 返回数据 row 行数 = "+str(daily_20140219.shape[0]))
daily_20140219_addname_dataframe.to_excel(daily_201402_excel_writer,'19_3',index=False)
daily_201402_excel_writer.save()
daily_20140220 = pro.daily(start_date='',end_date='',trade_date='20140220', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20140220_tscode_list = list() 
for ts_code_sh in daily_20140220['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20140220_tscode_list.append(stock_name)
daily_20140220_addname_dataframe=pd.DataFrame()
daily_20140220_addname_dataframe['cname'] = daily_20140220_tscode_list
for table_name in daily_20140220.columns.values.tolist():
    daily_20140220_addname_dataframe[table_name] = daily_20140220[table_name]
print("日线行情-时间为序  daily_20140220 返回数据 row 行数 = "+str(daily_20140220.shape[0]))
daily_20140220_addname_dataframe.to_excel(daily_201402_excel_writer,'20_4',index=False)
daily_201402_excel_writer.save()
daily_20140221 = pro.daily(start_date='',end_date='',trade_date='20140221', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20140221_tscode_list = list() 
for ts_code_sh in daily_20140221['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20140221_tscode_list.append(stock_name)
daily_20140221_addname_dataframe=pd.DataFrame()
daily_20140221_addname_dataframe['cname'] = daily_20140221_tscode_list
for table_name in daily_20140221.columns.values.tolist():
    daily_20140221_addname_dataframe[table_name] = daily_20140221[table_name]
print("日线行情-时间为序  daily_20140221 返回数据 row 行数 = "+str(daily_20140221.shape[0]))
daily_20140221_addname_dataframe.to_excel(daily_201402_excel_writer,'21_5',index=False)
daily_201402_excel_writer.save()
daily_20140224 = pro.daily(start_date='',end_date='',trade_date='20140224', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20140224_tscode_list = list() 
for ts_code_sh in daily_20140224['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20140224_tscode_list.append(stock_name)
daily_20140224_addname_dataframe=pd.DataFrame()
daily_20140224_addname_dataframe['cname'] = daily_20140224_tscode_list
for table_name in daily_20140224.columns.values.tolist():
    daily_20140224_addname_dataframe[table_name] = daily_20140224[table_name]
print("日线行情-时间为序  daily_20140224 返回数据 row 行数 = "+str(daily_20140224.shape[0]))
daily_20140224_addname_dataframe.to_excel(daily_201402_excel_writer,'24_1',index=False)
daily_201402_excel_writer.save()
daily_20140225 = pro.daily(start_date='',end_date='',trade_date='20140225', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20140225_tscode_list = list() 
for ts_code_sh in daily_20140225['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20140225_tscode_list.append(stock_name)
daily_20140225_addname_dataframe=pd.DataFrame()
daily_20140225_addname_dataframe['cname'] = daily_20140225_tscode_list
for table_name in daily_20140225.columns.values.tolist():
    daily_20140225_addname_dataframe[table_name] = daily_20140225[table_name]
print("日线行情-时间为序  daily_20140225 返回数据 row 行数 = "+str(daily_20140225.shape[0]))
daily_20140225_addname_dataframe.to_excel(daily_201402_excel_writer,'25_2',index=False)
daily_201402_excel_writer.save()
daily_20140226 = pro.daily(start_date='',end_date='',trade_date='20140226', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20140226_tscode_list = list() 
for ts_code_sh in daily_20140226['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20140226_tscode_list.append(stock_name)
daily_20140226_addname_dataframe=pd.DataFrame()
daily_20140226_addname_dataframe['cname'] = daily_20140226_tscode_list
for table_name in daily_20140226.columns.values.tolist():
    daily_20140226_addname_dataframe[table_name] = daily_20140226[table_name]
print("日线行情-时间为序  daily_20140226 返回数据 row 行数 = "+str(daily_20140226.shape[0]))
daily_20140226_addname_dataframe.to_excel(daily_201402_excel_writer,'26_3',index=False)
daily_201402_excel_writer.save()
daily_20140227 = pro.daily(start_date='',end_date='',trade_date='20140227', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20140227_tscode_list = list() 
for ts_code_sh in daily_20140227['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20140227_tscode_list.append(stock_name)
daily_20140227_addname_dataframe=pd.DataFrame()
daily_20140227_addname_dataframe['cname'] = daily_20140227_tscode_list
for table_name in daily_20140227.columns.values.tolist():
    daily_20140227_addname_dataframe[table_name] = daily_20140227[table_name]
print("日线行情-时间为序  daily_20140227 返回数据 row 行数 = "+str(daily_20140227.shape[0]))
daily_20140227_addname_dataframe.to_excel(daily_201402_excel_writer,'27_4',index=False)
daily_201402_excel_writer.save()
daily_20140228 = pro.daily(start_date='',end_date='',trade_date='20140228', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20140228_tscode_list = list() 
for ts_code_sh in daily_20140228['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20140228_tscode_list.append(stock_name)
daily_20140228_addname_dataframe=pd.DataFrame()
daily_20140228_addname_dataframe['cname'] = daily_20140228_tscode_list
for table_name in daily_20140228.columns.values.tolist():
    daily_20140228_addname_dataframe[table_name] = daily_20140228[table_name]
print("日线行情-时间为序  daily_20140228 返回数据 row 行数 = "+str(daily_20140228.shape[0]))
daily_20140228_addname_dataframe.to_excel(daily_201402_excel_writer,'28_5',index=False)
daily_201402_excel_writer.save()




createexcel('daily_201403.xlsx')
daily_201403_book = load_workbook('C:\\Users\\zhuzj5\\Desktop\\zbin\\J0_Data\\daily_201403.xlsx')
daily_201403_excel_writer = pd.ExcelWriter('C:\\Users\\zhuzj5\\Desktop\\zbin\\J0_Data\\daily_201403.xlsx', engine='openpyxl')
daily_201403_excel_writer.book = daily_201403_book
daily_201403_excel_writer.sheets = dict((ws.title, ws) for ws in daily_201403_book.worksheets)
J0_PROPS.put(tree_node_name+"record_date", "20140301")       ###  更新 记录日期
daily_20140303 = pro.daily(start_date='',end_date='',trade_date='20140303', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20140303_tscode_list = list() 
for ts_code_sh in daily_20140303['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20140303_tscode_list.append(stock_name)
daily_20140303_addname_dataframe=pd.DataFrame()
daily_20140303_addname_dataframe['cname'] = daily_20140303_tscode_list
for table_name in daily_20140303.columns.values.tolist():
    daily_20140303_addname_dataframe[table_name] = daily_20140303[table_name]
print("日线行情-时间为序  daily_20140303 返回数据 row 行数 = "+str(daily_20140303.shape[0]))
daily_20140303_addname_dataframe.to_excel(daily_201403_excel_writer,'3_1',index=False)
daily_201403_excel_writer.save()
daily_20140304 = pro.daily(start_date='',end_date='',trade_date='20140304', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20140304_tscode_list = list() 
for ts_code_sh in daily_20140304['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20140304_tscode_list.append(stock_name)
daily_20140304_addname_dataframe=pd.DataFrame()
daily_20140304_addname_dataframe['cname'] = daily_20140304_tscode_list
for table_name in daily_20140304.columns.values.tolist():
    daily_20140304_addname_dataframe[table_name] = daily_20140304[table_name]
print("日线行情-时间为序  daily_20140304 返回数据 row 行数 = "+str(daily_20140304.shape[0]))
daily_20140304_addname_dataframe.to_excel(daily_201403_excel_writer,'4_2',index=False)
daily_201403_excel_writer.save()
daily_20140305 = pro.daily(start_date='',end_date='',trade_date='20140305', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20140305_tscode_list = list() 
for ts_code_sh in daily_20140305['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20140305_tscode_list.append(stock_name)
daily_20140305_addname_dataframe=pd.DataFrame()
daily_20140305_addname_dataframe['cname'] = daily_20140305_tscode_list
for table_name in daily_20140305.columns.values.tolist():
    daily_20140305_addname_dataframe[table_name] = daily_20140305[table_name]
print("日线行情-时间为序  daily_20140305 返回数据 row 行数 = "+str(daily_20140305.shape[0]))
daily_20140305_addname_dataframe.to_excel(daily_201403_excel_writer,'5_3',index=False)
daily_201403_excel_writer.save()
daily_20140306 = pro.daily(start_date='',end_date='',trade_date='20140306', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20140306_tscode_list = list() 
for ts_code_sh in daily_20140306['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20140306_tscode_list.append(stock_name)
daily_20140306_addname_dataframe=pd.DataFrame()
daily_20140306_addname_dataframe['cname'] = daily_20140306_tscode_list
for table_name in daily_20140306.columns.values.tolist():
    daily_20140306_addname_dataframe[table_name] = daily_20140306[table_name]
print("日线行情-时间为序  daily_20140306 返回数据 row 行数 = "+str(daily_20140306.shape[0]))
daily_20140306_addname_dataframe.to_excel(daily_201403_excel_writer,'6_4',index=False)
daily_201403_excel_writer.save()
daily_20140307 = pro.daily(start_date='',end_date='',trade_date='20140307', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20140307_tscode_list = list() 
for ts_code_sh in daily_20140307['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20140307_tscode_list.append(stock_name)
daily_20140307_addname_dataframe=pd.DataFrame()
daily_20140307_addname_dataframe['cname'] = daily_20140307_tscode_list
for table_name in daily_20140307.columns.values.tolist():
    daily_20140307_addname_dataframe[table_name] = daily_20140307[table_name]
print("日线行情-时间为序  daily_20140307 返回数据 row 行数 = "+str(daily_20140307.shape[0]))
daily_20140307_addname_dataframe.to_excel(daily_201403_excel_writer,'7_5',index=False)
daily_201403_excel_writer.save()
daily_20140310 = pro.daily(start_date='',end_date='',trade_date='20140310', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20140310_tscode_list = list() 
for ts_code_sh in daily_20140310['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20140310_tscode_list.append(stock_name)
daily_20140310_addname_dataframe=pd.DataFrame()
daily_20140310_addname_dataframe['cname'] = daily_20140310_tscode_list
for table_name in daily_20140310.columns.values.tolist():
    daily_20140310_addname_dataframe[table_name] = daily_20140310[table_name]
print("日线行情-时间为序  daily_20140310 返回数据 row 行数 = "+str(daily_20140310.shape[0]))
daily_20140310_addname_dataframe.to_excel(daily_201403_excel_writer,'10_1',index=False)
daily_201403_excel_writer.save()
daily_20140311 = pro.daily(start_date='',end_date='',trade_date='20140311', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20140311_tscode_list = list() 
for ts_code_sh in daily_20140311['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20140311_tscode_list.append(stock_name)
daily_20140311_addname_dataframe=pd.DataFrame()
daily_20140311_addname_dataframe['cname'] = daily_20140311_tscode_list
for table_name in daily_20140311.columns.values.tolist():
    daily_20140311_addname_dataframe[table_name] = daily_20140311[table_name]
print("日线行情-时间为序  daily_20140311 返回数据 row 行数 = "+str(daily_20140311.shape[0]))
daily_20140311_addname_dataframe.to_excel(daily_201403_excel_writer,'11_2',index=False)
daily_201403_excel_writer.save()
daily_20140312 = pro.daily(start_date='',end_date='',trade_date='20140312', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20140312_tscode_list = list() 
for ts_code_sh in daily_20140312['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20140312_tscode_list.append(stock_name)
daily_20140312_addname_dataframe=pd.DataFrame()
daily_20140312_addname_dataframe['cname'] = daily_20140312_tscode_list
for table_name in daily_20140312.columns.values.tolist():
    daily_20140312_addname_dataframe[table_name] = daily_20140312[table_name]
print("日线行情-时间为序  daily_20140312 返回数据 row 行数 = "+str(daily_20140312.shape[0]))
daily_20140312_addname_dataframe.to_excel(daily_201403_excel_writer,'12_3',index=False)
daily_201403_excel_writer.save()
daily_20140313 = pro.daily(start_date='',end_date='',trade_date='20140313', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20140313_tscode_list = list() 
for ts_code_sh in daily_20140313['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20140313_tscode_list.append(stock_name)
daily_20140313_addname_dataframe=pd.DataFrame()
daily_20140313_addname_dataframe['cname'] = daily_20140313_tscode_list
for table_name in daily_20140313.columns.values.tolist():
    daily_20140313_addname_dataframe[table_name] = daily_20140313[table_name]
print("日线行情-时间为序  daily_20140313 返回数据 row 行数 = "+str(daily_20140313.shape[0]))
daily_20140313_addname_dataframe.to_excel(daily_201403_excel_writer,'13_4',index=False)
daily_201403_excel_writer.save()
daily_20140314 = pro.daily(start_date='',end_date='',trade_date='20140314', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20140314_tscode_list = list() 
for ts_code_sh in daily_20140314['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20140314_tscode_list.append(stock_name)
daily_20140314_addname_dataframe=pd.DataFrame()
daily_20140314_addname_dataframe['cname'] = daily_20140314_tscode_list
for table_name in daily_20140314.columns.values.tolist():
    daily_20140314_addname_dataframe[table_name] = daily_20140314[table_name]
print("日线行情-时间为序  daily_20140314 返回数据 row 行数 = "+str(daily_20140314.shape[0]))
daily_20140314_addname_dataframe.to_excel(daily_201403_excel_writer,'14_5',index=False)
daily_201403_excel_writer.save()
daily_20140317 = pro.daily(start_date='',end_date='',trade_date='20140317', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20140317_tscode_list = list() 
for ts_code_sh in daily_20140317['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20140317_tscode_list.append(stock_name)
daily_20140317_addname_dataframe=pd.DataFrame()
daily_20140317_addname_dataframe['cname'] = daily_20140317_tscode_list
for table_name in daily_20140317.columns.values.tolist():
    daily_20140317_addname_dataframe[table_name] = daily_20140317[table_name]
print("日线行情-时间为序  daily_20140317 返回数据 row 行数 = "+str(daily_20140317.shape[0]))
daily_20140317_addname_dataframe.to_excel(daily_201403_excel_writer,'17_1',index=False)
daily_201403_excel_writer.save()
daily_20140318 = pro.daily(start_date='',end_date='',trade_date='20140318', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20140318_tscode_list = list() 
for ts_code_sh in daily_20140318['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20140318_tscode_list.append(stock_name)
daily_20140318_addname_dataframe=pd.DataFrame()
daily_20140318_addname_dataframe['cname'] = daily_20140318_tscode_list
for table_name in daily_20140318.columns.values.tolist():
    daily_20140318_addname_dataframe[table_name] = daily_20140318[table_name]
print("日线行情-时间为序  daily_20140318 返回数据 row 行数 = "+str(daily_20140318.shape[0]))
daily_20140318_addname_dataframe.to_excel(daily_201403_excel_writer,'18_2',index=False)
daily_201403_excel_writer.save()
daily_20140319 = pro.daily(start_date='',end_date='',trade_date='20140319', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20140319_tscode_list = list() 
for ts_code_sh in daily_20140319['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20140319_tscode_list.append(stock_name)
daily_20140319_addname_dataframe=pd.DataFrame()
daily_20140319_addname_dataframe['cname'] = daily_20140319_tscode_list
for table_name in daily_20140319.columns.values.tolist():
    daily_20140319_addname_dataframe[table_name] = daily_20140319[table_name]
print("日线行情-时间为序  daily_20140319 返回数据 row 行数 = "+str(daily_20140319.shape[0]))
daily_20140319_addname_dataframe.to_excel(daily_201403_excel_writer,'19_3',index=False)
daily_201403_excel_writer.save()
daily_20140320 = pro.daily(start_date='',end_date='',trade_date='20140320', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20140320_tscode_list = list() 
for ts_code_sh in daily_20140320['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20140320_tscode_list.append(stock_name)
daily_20140320_addname_dataframe=pd.DataFrame()
daily_20140320_addname_dataframe['cname'] = daily_20140320_tscode_list
for table_name in daily_20140320.columns.values.tolist():
    daily_20140320_addname_dataframe[table_name] = daily_20140320[table_name]
print("日线行情-时间为序  daily_20140320 返回数据 row 行数 = "+str(daily_20140320.shape[0]))
daily_20140320_addname_dataframe.to_excel(daily_201403_excel_writer,'20_4',index=False)
daily_201403_excel_writer.save()
daily_20140321 = pro.daily(start_date='',end_date='',trade_date='20140321', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20140321_tscode_list = list() 
for ts_code_sh in daily_20140321['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20140321_tscode_list.append(stock_name)
daily_20140321_addname_dataframe=pd.DataFrame()
daily_20140321_addname_dataframe['cname'] = daily_20140321_tscode_list
for table_name in daily_20140321.columns.values.tolist():
    daily_20140321_addname_dataframe[table_name] = daily_20140321[table_name]
print("日线行情-时间为序  daily_20140321 返回数据 row 行数 = "+str(daily_20140321.shape[0]))
daily_20140321_addname_dataframe.to_excel(daily_201403_excel_writer,'21_5',index=False)
daily_201403_excel_writer.save()
daily_20140324 = pro.daily(start_date='',end_date='',trade_date='20140324', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20140324_tscode_list = list() 
for ts_code_sh in daily_20140324['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20140324_tscode_list.append(stock_name)
daily_20140324_addname_dataframe=pd.DataFrame()
daily_20140324_addname_dataframe['cname'] = daily_20140324_tscode_list
for table_name in daily_20140324.columns.values.tolist():
    daily_20140324_addname_dataframe[table_name] = daily_20140324[table_name]
print("日线行情-时间为序  daily_20140324 返回数据 row 行数 = "+str(daily_20140324.shape[0]))
daily_20140324_addname_dataframe.to_excel(daily_201403_excel_writer,'24_1',index=False)
daily_201403_excel_writer.save()
daily_20140325 = pro.daily(start_date='',end_date='',trade_date='20140325', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20140325_tscode_list = list() 
for ts_code_sh in daily_20140325['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20140325_tscode_list.append(stock_name)
daily_20140325_addname_dataframe=pd.DataFrame()
daily_20140325_addname_dataframe['cname'] = daily_20140325_tscode_list
for table_name in daily_20140325.columns.values.tolist():
    daily_20140325_addname_dataframe[table_name] = daily_20140325[table_name]
print("日线行情-时间为序  daily_20140325 返回数据 row 行数 = "+str(daily_20140325.shape[0]))
daily_20140325_addname_dataframe.to_excel(daily_201403_excel_writer,'25_2',index=False)
daily_201403_excel_writer.save()
daily_20140326 = pro.daily(start_date='',end_date='',trade_date='20140326', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20140326_tscode_list = list() 
for ts_code_sh in daily_20140326['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20140326_tscode_list.append(stock_name)
daily_20140326_addname_dataframe=pd.DataFrame()
daily_20140326_addname_dataframe['cname'] = daily_20140326_tscode_list
for table_name in daily_20140326.columns.values.tolist():
    daily_20140326_addname_dataframe[table_name] = daily_20140326[table_name]
print("日线行情-时间为序  daily_20140326 返回数据 row 行数 = "+str(daily_20140326.shape[0]))
daily_20140326_addname_dataframe.to_excel(daily_201403_excel_writer,'26_3',index=False)
daily_201403_excel_writer.save()
daily_20140327 = pro.daily(start_date='',end_date='',trade_date='20140327', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20140327_tscode_list = list() 
for ts_code_sh in daily_20140327['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20140327_tscode_list.append(stock_name)
daily_20140327_addname_dataframe=pd.DataFrame()
daily_20140327_addname_dataframe['cname'] = daily_20140327_tscode_list
for table_name in daily_20140327.columns.values.tolist():
    daily_20140327_addname_dataframe[table_name] = daily_20140327[table_name]
print("日线行情-时间为序  daily_20140327 返回数据 row 行数 = "+str(daily_20140327.shape[0]))
daily_20140327_addname_dataframe.to_excel(daily_201403_excel_writer,'27_4',index=False)
daily_201403_excel_writer.save()
daily_20140328 = pro.daily(start_date='',end_date='',trade_date='20140328', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20140328_tscode_list = list() 
for ts_code_sh in daily_20140328['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20140328_tscode_list.append(stock_name)
daily_20140328_addname_dataframe=pd.DataFrame()
daily_20140328_addname_dataframe['cname'] = daily_20140328_tscode_list
for table_name in daily_20140328.columns.values.tolist():
    daily_20140328_addname_dataframe[table_name] = daily_20140328[table_name]
print("日线行情-时间为序  daily_20140328 返回数据 row 行数 = "+str(daily_20140328.shape[0]))
daily_20140328_addname_dataframe.to_excel(daily_201403_excel_writer,'28_5',index=False)
daily_201403_excel_writer.save()
daily_20140331 = pro.daily(start_date='',end_date='',trade_date='20140331', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20140331_tscode_list = list() 
for ts_code_sh in daily_20140331['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20140331_tscode_list.append(stock_name)
daily_20140331_addname_dataframe=pd.DataFrame()
daily_20140331_addname_dataframe['cname'] = daily_20140331_tscode_list
for table_name in daily_20140331.columns.values.tolist():
    daily_20140331_addname_dataframe[table_name] = daily_20140331[table_name]
print("日线行情-时间为序  daily_20140331 返回数据 row 行数 = "+str(daily_20140331.shape[0]))
daily_20140331_addname_dataframe.to_excel(daily_201403_excel_writer,'31_1',index=False)
daily_201403_excel_writer.save()




createexcel('daily_201404.xlsx')
daily_201404_book = load_workbook('C:\\Users\\zhuzj5\\Desktop\\zbin\\J0_Data\\daily_201404.xlsx')
daily_201404_excel_writer = pd.ExcelWriter('C:\\Users\\zhuzj5\\Desktop\\zbin\\J0_Data\\daily_201404.xlsx', engine='openpyxl')
daily_201404_excel_writer.book = daily_201404_book
daily_201404_excel_writer.sheets = dict((ws.title, ws) for ws in daily_201404_book.worksheets)
J0_PROPS.put(tree_node_name+"record_date", "20140401")       ###  更新 记录日期
daily_20140401 = pro.daily(start_date='',end_date='',trade_date='20140401', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20140401_tscode_list = list() 
for ts_code_sh in daily_20140401['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20140401_tscode_list.append(stock_name)
daily_20140401_addname_dataframe=pd.DataFrame()
daily_20140401_addname_dataframe['cname'] = daily_20140401_tscode_list
for table_name in daily_20140401.columns.values.tolist():
    daily_20140401_addname_dataframe[table_name] = daily_20140401[table_name]
print("日线行情-时间为序  daily_20140401 返回数据 row 行数 = "+str(daily_20140401.shape[0]))
daily_20140401_addname_dataframe.to_excel(daily_201404_excel_writer,'1_2',index=False)
daily_201404_excel_writer.save()
daily_20140402 = pro.daily(start_date='',end_date='',trade_date='20140402', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20140402_tscode_list = list() 
for ts_code_sh in daily_20140402['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20140402_tscode_list.append(stock_name)
daily_20140402_addname_dataframe=pd.DataFrame()
daily_20140402_addname_dataframe['cname'] = daily_20140402_tscode_list
for table_name in daily_20140402.columns.values.tolist():
    daily_20140402_addname_dataframe[table_name] = daily_20140402[table_name]
print("日线行情-时间为序  daily_20140402 返回数据 row 行数 = "+str(daily_20140402.shape[0]))
daily_20140402_addname_dataframe.to_excel(daily_201404_excel_writer,'2_3',index=False)
daily_201404_excel_writer.save()
daily_20140403 = pro.daily(start_date='',end_date='',trade_date='20140403', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20140403_tscode_list = list() 
for ts_code_sh in daily_20140403['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20140403_tscode_list.append(stock_name)
daily_20140403_addname_dataframe=pd.DataFrame()
daily_20140403_addname_dataframe['cname'] = daily_20140403_tscode_list
for table_name in daily_20140403.columns.values.tolist():
    daily_20140403_addname_dataframe[table_name] = daily_20140403[table_name]
print("日线行情-时间为序  daily_20140403 返回数据 row 行数 = "+str(daily_20140403.shape[0]))
daily_20140403_addname_dataframe.to_excel(daily_201404_excel_writer,'3_4',index=False)
daily_201404_excel_writer.save()
daily_20140404 = pro.daily(start_date='',end_date='',trade_date='20140404', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20140404_tscode_list = list() 
for ts_code_sh in daily_20140404['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20140404_tscode_list.append(stock_name)
daily_20140404_addname_dataframe=pd.DataFrame()
daily_20140404_addname_dataframe['cname'] = daily_20140404_tscode_list
for table_name in daily_20140404.columns.values.tolist():
    daily_20140404_addname_dataframe[table_name] = daily_20140404[table_name]
print("日线行情-时间为序  daily_20140404 返回数据 row 行数 = "+str(daily_20140404.shape[0]))
daily_20140404_addname_dataframe.to_excel(daily_201404_excel_writer,'4_5',index=False)
daily_201404_excel_writer.save()
daily_20140408 = pro.daily(start_date='',end_date='',trade_date='20140408', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20140408_tscode_list = list() 
for ts_code_sh in daily_20140408['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20140408_tscode_list.append(stock_name)
daily_20140408_addname_dataframe=pd.DataFrame()
daily_20140408_addname_dataframe['cname'] = daily_20140408_tscode_list
for table_name in daily_20140408.columns.values.tolist():
    daily_20140408_addname_dataframe[table_name] = daily_20140408[table_name]
print("日线行情-时间为序  daily_20140408 返回数据 row 行数 = "+str(daily_20140408.shape[0]))
daily_20140408_addname_dataframe.to_excel(daily_201404_excel_writer,'8_2',index=False)
daily_201404_excel_writer.save()
daily_20140409 = pro.daily(start_date='',end_date='',trade_date='20140409', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20140409_tscode_list = list() 
for ts_code_sh in daily_20140409['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20140409_tscode_list.append(stock_name)
daily_20140409_addname_dataframe=pd.DataFrame()
daily_20140409_addname_dataframe['cname'] = daily_20140409_tscode_list
for table_name in daily_20140409.columns.values.tolist():
    daily_20140409_addname_dataframe[table_name] = daily_20140409[table_name]
print("日线行情-时间为序  daily_20140409 返回数据 row 行数 = "+str(daily_20140409.shape[0]))
daily_20140409_addname_dataframe.to_excel(daily_201404_excel_writer,'9_3',index=False)
daily_201404_excel_writer.save()
daily_20140410 = pro.daily(start_date='',end_date='',trade_date='20140410', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20140410_tscode_list = list() 
for ts_code_sh in daily_20140410['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20140410_tscode_list.append(stock_name)
daily_20140410_addname_dataframe=pd.DataFrame()
daily_20140410_addname_dataframe['cname'] = daily_20140410_tscode_list
for table_name in daily_20140410.columns.values.tolist():
    daily_20140410_addname_dataframe[table_name] = daily_20140410[table_name]
print("日线行情-时间为序  daily_20140410 返回数据 row 行数 = "+str(daily_20140410.shape[0]))
daily_20140410_addname_dataframe.to_excel(daily_201404_excel_writer,'10_4',index=False)
daily_201404_excel_writer.save()
daily_20140411 = pro.daily(start_date='',end_date='',trade_date='20140411', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20140411_tscode_list = list() 
for ts_code_sh in daily_20140411['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20140411_tscode_list.append(stock_name)
daily_20140411_addname_dataframe=pd.DataFrame()
daily_20140411_addname_dataframe['cname'] = daily_20140411_tscode_list
for table_name in daily_20140411.columns.values.tolist():
    daily_20140411_addname_dataframe[table_name] = daily_20140411[table_name]
print("日线行情-时间为序  daily_20140411 返回数据 row 行数 = "+str(daily_20140411.shape[0]))
daily_20140411_addname_dataframe.to_excel(daily_201404_excel_writer,'11_5',index=False)
daily_201404_excel_writer.save()
daily_20140414 = pro.daily(start_date='',end_date='',trade_date='20140414', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20140414_tscode_list = list() 
for ts_code_sh in daily_20140414['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20140414_tscode_list.append(stock_name)
daily_20140414_addname_dataframe=pd.DataFrame()
daily_20140414_addname_dataframe['cname'] = daily_20140414_tscode_list
for table_name in daily_20140414.columns.values.tolist():
    daily_20140414_addname_dataframe[table_name] = daily_20140414[table_name]
print("日线行情-时间为序  daily_20140414 返回数据 row 行数 = "+str(daily_20140414.shape[0]))
daily_20140414_addname_dataframe.to_excel(daily_201404_excel_writer,'14_1',index=False)
daily_201404_excel_writer.save()
daily_20140415 = pro.daily(start_date='',end_date='',trade_date='20140415', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20140415_tscode_list = list() 
for ts_code_sh in daily_20140415['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20140415_tscode_list.append(stock_name)
daily_20140415_addname_dataframe=pd.DataFrame()
daily_20140415_addname_dataframe['cname'] = daily_20140415_tscode_list
for table_name in daily_20140415.columns.values.tolist():
    daily_20140415_addname_dataframe[table_name] = daily_20140415[table_name]
print("日线行情-时间为序  daily_20140415 返回数据 row 行数 = "+str(daily_20140415.shape[0]))
daily_20140415_addname_dataframe.to_excel(daily_201404_excel_writer,'15_2',index=False)
daily_201404_excel_writer.save()
daily_20140416 = pro.daily(start_date='',end_date='',trade_date='20140416', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20140416_tscode_list = list() 
for ts_code_sh in daily_20140416['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20140416_tscode_list.append(stock_name)
daily_20140416_addname_dataframe=pd.DataFrame()
daily_20140416_addname_dataframe['cname'] = daily_20140416_tscode_list
for table_name in daily_20140416.columns.values.tolist():
    daily_20140416_addname_dataframe[table_name] = daily_20140416[table_name]
print("日线行情-时间为序  daily_20140416 返回数据 row 行数 = "+str(daily_20140416.shape[0]))
daily_20140416_addname_dataframe.to_excel(daily_201404_excel_writer,'16_3',index=False)
daily_201404_excel_writer.save()
daily_20140417 = pro.daily(start_date='',end_date='',trade_date='20140417', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20140417_tscode_list = list() 
for ts_code_sh in daily_20140417['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20140417_tscode_list.append(stock_name)
daily_20140417_addname_dataframe=pd.DataFrame()
daily_20140417_addname_dataframe['cname'] = daily_20140417_tscode_list
for table_name in daily_20140417.columns.values.tolist():
    daily_20140417_addname_dataframe[table_name] = daily_20140417[table_name]
print("日线行情-时间为序  daily_20140417 返回数据 row 行数 = "+str(daily_20140417.shape[0]))
daily_20140417_addname_dataframe.to_excel(daily_201404_excel_writer,'17_4',index=False)
daily_201404_excel_writer.save()
daily_20140418 = pro.daily(start_date='',end_date='',trade_date='20140418', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20140418_tscode_list = list() 
for ts_code_sh in daily_20140418['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20140418_tscode_list.append(stock_name)
daily_20140418_addname_dataframe=pd.DataFrame()
daily_20140418_addname_dataframe['cname'] = daily_20140418_tscode_list
for table_name in daily_20140418.columns.values.tolist():
    daily_20140418_addname_dataframe[table_name] = daily_20140418[table_name]
print("日线行情-时间为序  daily_20140418 返回数据 row 行数 = "+str(daily_20140418.shape[0]))
daily_20140418_addname_dataframe.to_excel(daily_201404_excel_writer,'18_5',index=False)
daily_201404_excel_writer.save()
daily_20140421 = pro.daily(start_date='',end_date='',trade_date='20140421', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20140421_tscode_list = list() 
for ts_code_sh in daily_20140421['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20140421_tscode_list.append(stock_name)
daily_20140421_addname_dataframe=pd.DataFrame()
daily_20140421_addname_dataframe['cname'] = daily_20140421_tscode_list
for table_name in daily_20140421.columns.values.tolist():
    daily_20140421_addname_dataframe[table_name] = daily_20140421[table_name]
print("日线行情-时间为序  daily_20140421 返回数据 row 行数 = "+str(daily_20140421.shape[0]))
daily_20140421_addname_dataframe.to_excel(daily_201404_excel_writer,'21_1',index=False)
daily_201404_excel_writer.save()
daily_20140422 = pro.daily(start_date='',end_date='',trade_date='20140422', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20140422_tscode_list = list() 
for ts_code_sh in daily_20140422['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20140422_tscode_list.append(stock_name)
daily_20140422_addname_dataframe=pd.DataFrame()
daily_20140422_addname_dataframe['cname'] = daily_20140422_tscode_list
for table_name in daily_20140422.columns.values.tolist():
    daily_20140422_addname_dataframe[table_name] = daily_20140422[table_name]
print("日线行情-时间为序  daily_20140422 返回数据 row 行数 = "+str(daily_20140422.shape[0]))
daily_20140422_addname_dataframe.to_excel(daily_201404_excel_writer,'22_2',index=False)
daily_201404_excel_writer.save()
daily_20140423 = pro.daily(start_date='',end_date='',trade_date='20140423', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20140423_tscode_list = list() 
for ts_code_sh in daily_20140423['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20140423_tscode_list.append(stock_name)
daily_20140423_addname_dataframe=pd.DataFrame()
daily_20140423_addname_dataframe['cname'] = daily_20140423_tscode_list
for table_name in daily_20140423.columns.values.tolist():
    daily_20140423_addname_dataframe[table_name] = daily_20140423[table_name]
print("日线行情-时间为序  daily_20140423 返回数据 row 行数 = "+str(daily_20140423.shape[0]))
daily_20140423_addname_dataframe.to_excel(daily_201404_excel_writer,'23_3',index=False)
daily_201404_excel_writer.save()
daily_20140424 = pro.daily(start_date='',end_date='',trade_date='20140424', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20140424_tscode_list = list() 
for ts_code_sh in daily_20140424['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20140424_tscode_list.append(stock_name)
daily_20140424_addname_dataframe=pd.DataFrame()
daily_20140424_addname_dataframe['cname'] = daily_20140424_tscode_list
for table_name in daily_20140424.columns.values.tolist():
    daily_20140424_addname_dataframe[table_name] = daily_20140424[table_name]
print("日线行情-时间为序  daily_20140424 返回数据 row 行数 = "+str(daily_20140424.shape[0]))
daily_20140424_addname_dataframe.to_excel(daily_201404_excel_writer,'24_4',index=False)
daily_201404_excel_writer.save()
daily_20140425 = pro.daily(start_date='',end_date='',trade_date='20140425', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20140425_tscode_list = list() 
for ts_code_sh in daily_20140425['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20140425_tscode_list.append(stock_name)
daily_20140425_addname_dataframe=pd.DataFrame()
daily_20140425_addname_dataframe['cname'] = daily_20140425_tscode_list
for table_name in daily_20140425.columns.values.tolist():
    daily_20140425_addname_dataframe[table_name] = daily_20140425[table_name]
print("日线行情-时间为序  daily_20140425 返回数据 row 行数 = "+str(daily_20140425.shape[0]))
daily_20140425_addname_dataframe.to_excel(daily_201404_excel_writer,'25_5',index=False)
daily_201404_excel_writer.save()
daily_20140428 = pro.daily(start_date='',end_date='',trade_date='20140428', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20140428_tscode_list = list() 
for ts_code_sh in daily_20140428['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20140428_tscode_list.append(stock_name)
daily_20140428_addname_dataframe=pd.DataFrame()
daily_20140428_addname_dataframe['cname'] = daily_20140428_tscode_list
for table_name in daily_20140428.columns.values.tolist():
    daily_20140428_addname_dataframe[table_name] = daily_20140428[table_name]
print("日线行情-时间为序  daily_20140428 返回数据 row 行数 = "+str(daily_20140428.shape[0]))
daily_20140428_addname_dataframe.to_excel(daily_201404_excel_writer,'28_1',index=False)
daily_201404_excel_writer.save()
daily_20140429 = pro.daily(start_date='',end_date='',trade_date='20140429', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20140429_tscode_list = list() 
for ts_code_sh in daily_20140429['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20140429_tscode_list.append(stock_name)
daily_20140429_addname_dataframe=pd.DataFrame()
daily_20140429_addname_dataframe['cname'] = daily_20140429_tscode_list
for table_name in daily_20140429.columns.values.tolist():
    daily_20140429_addname_dataframe[table_name] = daily_20140429[table_name]
print("日线行情-时间为序  daily_20140429 返回数据 row 行数 = "+str(daily_20140429.shape[0]))
daily_20140429_addname_dataframe.to_excel(daily_201404_excel_writer,'29_2',index=False)
daily_201404_excel_writer.save()
daily_20140430 = pro.daily(start_date='',end_date='',trade_date='20140430', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20140430_tscode_list = list() 
for ts_code_sh in daily_20140430['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20140430_tscode_list.append(stock_name)
daily_20140430_addname_dataframe=pd.DataFrame()
daily_20140430_addname_dataframe['cname'] = daily_20140430_tscode_list
for table_name in daily_20140430.columns.values.tolist():
    daily_20140430_addname_dataframe[table_name] = daily_20140430[table_name]
print("日线行情-时间为序  daily_20140430 返回数据 row 行数 = "+str(daily_20140430.shape[0]))
daily_20140430_addname_dataframe.to_excel(daily_201404_excel_writer,'30_3',index=False)
daily_201404_excel_writer.save()




createexcel('daily_201405.xlsx')
daily_201405_book = load_workbook('C:\\Users\\zhuzj5\\Desktop\\zbin\\J0_Data\\daily_201405.xlsx')
daily_201405_excel_writer = pd.ExcelWriter('C:\\Users\\zhuzj5\\Desktop\\zbin\\J0_Data\\daily_201405.xlsx', engine='openpyxl')
daily_201405_excel_writer.book = daily_201405_book
daily_201405_excel_writer.sheets = dict((ws.title, ws) for ws in daily_201405_book.worksheets)
J0_PROPS.put(tree_node_name+"record_date", "20140501")       ###  更新 记录日期
daily_20140505 = pro.daily(start_date='',end_date='',trade_date='20140505', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20140505_tscode_list = list() 
for ts_code_sh in daily_20140505['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20140505_tscode_list.append(stock_name)
daily_20140505_addname_dataframe=pd.DataFrame()
daily_20140505_addname_dataframe['cname'] = daily_20140505_tscode_list
for table_name in daily_20140505.columns.values.tolist():
    daily_20140505_addname_dataframe[table_name] = daily_20140505[table_name]
print("日线行情-时间为序  daily_20140505 返回数据 row 行数 = "+str(daily_20140505.shape[0]))
daily_20140505_addname_dataframe.to_excel(daily_201405_excel_writer,'5_1',index=False)
daily_201405_excel_writer.save()
daily_20140506 = pro.daily(start_date='',end_date='',trade_date='20140506', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20140506_tscode_list = list() 
for ts_code_sh in daily_20140506['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20140506_tscode_list.append(stock_name)
daily_20140506_addname_dataframe=pd.DataFrame()
daily_20140506_addname_dataframe['cname'] = daily_20140506_tscode_list
for table_name in daily_20140506.columns.values.tolist():
    daily_20140506_addname_dataframe[table_name] = daily_20140506[table_name]
print("日线行情-时间为序  daily_20140506 返回数据 row 行数 = "+str(daily_20140506.shape[0]))
daily_20140506_addname_dataframe.to_excel(daily_201405_excel_writer,'6_2',index=False)
daily_201405_excel_writer.save()
daily_20140507 = pro.daily(start_date='',end_date='',trade_date='20140507', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20140507_tscode_list = list() 
for ts_code_sh in daily_20140507['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20140507_tscode_list.append(stock_name)
daily_20140507_addname_dataframe=pd.DataFrame()
daily_20140507_addname_dataframe['cname'] = daily_20140507_tscode_list
for table_name in daily_20140507.columns.values.tolist():
    daily_20140507_addname_dataframe[table_name] = daily_20140507[table_name]
print("日线行情-时间为序  daily_20140507 返回数据 row 行数 = "+str(daily_20140507.shape[0]))
daily_20140507_addname_dataframe.to_excel(daily_201405_excel_writer,'7_3',index=False)
daily_201405_excel_writer.save()
daily_20140508 = pro.daily(start_date='',end_date='',trade_date='20140508', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20140508_tscode_list = list() 
for ts_code_sh in daily_20140508['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20140508_tscode_list.append(stock_name)
daily_20140508_addname_dataframe=pd.DataFrame()
daily_20140508_addname_dataframe['cname'] = daily_20140508_tscode_list
for table_name in daily_20140508.columns.values.tolist():
    daily_20140508_addname_dataframe[table_name] = daily_20140508[table_name]
print("日线行情-时间为序  daily_20140508 返回数据 row 行数 = "+str(daily_20140508.shape[0]))
daily_20140508_addname_dataframe.to_excel(daily_201405_excel_writer,'8_4',index=False)
daily_201405_excel_writer.save()
daily_20140509 = pro.daily(start_date='',end_date='',trade_date='20140509', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20140509_tscode_list = list() 
for ts_code_sh in daily_20140509['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20140509_tscode_list.append(stock_name)
daily_20140509_addname_dataframe=pd.DataFrame()
daily_20140509_addname_dataframe['cname'] = daily_20140509_tscode_list
for table_name in daily_20140509.columns.values.tolist():
    daily_20140509_addname_dataframe[table_name] = daily_20140509[table_name]
print("日线行情-时间为序  daily_20140509 返回数据 row 行数 = "+str(daily_20140509.shape[0]))
daily_20140509_addname_dataframe.to_excel(daily_201405_excel_writer,'9_5',index=False)
daily_201405_excel_writer.save()
daily_20140512 = pro.daily(start_date='',end_date='',trade_date='20140512', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20140512_tscode_list = list() 
for ts_code_sh in daily_20140512['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20140512_tscode_list.append(stock_name)
daily_20140512_addname_dataframe=pd.DataFrame()
daily_20140512_addname_dataframe['cname'] = daily_20140512_tscode_list
for table_name in daily_20140512.columns.values.tolist():
    daily_20140512_addname_dataframe[table_name] = daily_20140512[table_name]
print("日线行情-时间为序  daily_20140512 返回数据 row 行数 = "+str(daily_20140512.shape[0]))
daily_20140512_addname_dataframe.to_excel(daily_201405_excel_writer,'12_1',index=False)
daily_201405_excel_writer.save()
daily_20140513 = pro.daily(start_date='',end_date='',trade_date='20140513', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20140513_tscode_list = list() 
for ts_code_sh in daily_20140513['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20140513_tscode_list.append(stock_name)
daily_20140513_addname_dataframe=pd.DataFrame()
daily_20140513_addname_dataframe['cname'] = daily_20140513_tscode_list
for table_name in daily_20140513.columns.values.tolist():
    daily_20140513_addname_dataframe[table_name] = daily_20140513[table_name]
print("日线行情-时间为序  daily_20140513 返回数据 row 行数 = "+str(daily_20140513.shape[0]))
daily_20140513_addname_dataframe.to_excel(daily_201405_excel_writer,'13_2',index=False)
daily_201405_excel_writer.save()
daily_20140514 = pro.daily(start_date='',end_date='',trade_date='20140514', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20140514_tscode_list = list() 
for ts_code_sh in daily_20140514['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20140514_tscode_list.append(stock_name)
daily_20140514_addname_dataframe=pd.DataFrame()
daily_20140514_addname_dataframe['cname'] = daily_20140514_tscode_list
for table_name in daily_20140514.columns.values.tolist():
    daily_20140514_addname_dataframe[table_name] = daily_20140514[table_name]
print("日线行情-时间为序  daily_20140514 返回数据 row 行数 = "+str(daily_20140514.shape[0]))
daily_20140514_addname_dataframe.to_excel(daily_201405_excel_writer,'14_3',index=False)
daily_201405_excel_writer.save()
daily_20140515 = pro.daily(start_date='',end_date='',trade_date='20140515', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20140515_tscode_list = list() 
for ts_code_sh in daily_20140515['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20140515_tscode_list.append(stock_name)
daily_20140515_addname_dataframe=pd.DataFrame()
daily_20140515_addname_dataframe['cname'] = daily_20140515_tscode_list
for table_name in daily_20140515.columns.values.tolist():
    daily_20140515_addname_dataframe[table_name] = daily_20140515[table_name]
print("日线行情-时间为序  daily_20140515 返回数据 row 行数 = "+str(daily_20140515.shape[0]))
daily_20140515_addname_dataframe.to_excel(daily_201405_excel_writer,'15_4',index=False)
daily_201405_excel_writer.save()
daily_20140516 = pro.daily(start_date='',end_date='',trade_date='20140516', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20140516_tscode_list = list() 
for ts_code_sh in daily_20140516['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20140516_tscode_list.append(stock_name)
daily_20140516_addname_dataframe=pd.DataFrame()
daily_20140516_addname_dataframe['cname'] = daily_20140516_tscode_list
for table_name in daily_20140516.columns.values.tolist():
    daily_20140516_addname_dataframe[table_name] = daily_20140516[table_name]
print("日线行情-时间为序  daily_20140516 返回数据 row 行数 = "+str(daily_20140516.shape[0]))
daily_20140516_addname_dataframe.to_excel(daily_201405_excel_writer,'16_5',index=False)
daily_201405_excel_writer.save()
daily_20140519 = pro.daily(start_date='',end_date='',trade_date='20140519', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20140519_tscode_list = list() 
for ts_code_sh in daily_20140519['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20140519_tscode_list.append(stock_name)
daily_20140519_addname_dataframe=pd.DataFrame()
daily_20140519_addname_dataframe['cname'] = daily_20140519_tscode_list
for table_name in daily_20140519.columns.values.tolist():
    daily_20140519_addname_dataframe[table_name] = daily_20140519[table_name]
print("日线行情-时间为序  daily_20140519 返回数据 row 行数 = "+str(daily_20140519.shape[0]))
daily_20140519_addname_dataframe.to_excel(daily_201405_excel_writer,'19_1',index=False)
daily_201405_excel_writer.save()
daily_20140520 = pro.daily(start_date='',end_date='',trade_date='20140520', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20140520_tscode_list = list() 
for ts_code_sh in daily_20140520['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20140520_tscode_list.append(stock_name)
daily_20140520_addname_dataframe=pd.DataFrame()
daily_20140520_addname_dataframe['cname'] = daily_20140520_tscode_list
for table_name in daily_20140520.columns.values.tolist():
    daily_20140520_addname_dataframe[table_name] = daily_20140520[table_name]
print("日线行情-时间为序  daily_20140520 返回数据 row 行数 = "+str(daily_20140520.shape[0]))
daily_20140520_addname_dataframe.to_excel(daily_201405_excel_writer,'20_2',index=False)
daily_201405_excel_writer.save()
daily_20140521 = pro.daily(start_date='',end_date='',trade_date='20140521', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20140521_tscode_list = list() 
for ts_code_sh in daily_20140521['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20140521_tscode_list.append(stock_name)
daily_20140521_addname_dataframe=pd.DataFrame()
daily_20140521_addname_dataframe['cname'] = daily_20140521_tscode_list
for table_name in daily_20140521.columns.values.tolist():
    daily_20140521_addname_dataframe[table_name] = daily_20140521[table_name]
print("日线行情-时间为序  daily_20140521 返回数据 row 行数 = "+str(daily_20140521.shape[0]))
daily_20140521_addname_dataframe.to_excel(daily_201405_excel_writer,'21_3',index=False)
daily_201405_excel_writer.save()
daily_20140522 = pro.daily(start_date='',end_date='',trade_date='20140522', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20140522_tscode_list = list() 
for ts_code_sh in daily_20140522['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20140522_tscode_list.append(stock_name)
daily_20140522_addname_dataframe=pd.DataFrame()
daily_20140522_addname_dataframe['cname'] = daily_20140522_tscode_list
for table_name in daily_20140522.columns.values.tolist():
    daily_20140522_addname_dataframe[table_name] = daily_20140522[table_name]
print("日线行情-时间为序  daily_20140522 返回数据 row 行数 = "+str(daily_20140522.shape[0]))
daily_20140522_addname_dataframe.to_excel(daily_201405_excel_writer,'22_4',index=False)
daily_201405_excel_writer.save()
daily_20140523 = pro.daily(start_date='',end_date='',trade_date='20140523', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20140523_tscode_list = list() 
for ts_code_sh in daily_20140523['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20140523_tscode_list.append(stock_name)
daily_20140523_addname_dataframe=pd.DataFrame()
daily_20140523_addname_dataframe['cname'] = daily_20140523_tscode_list
for table_name in daily_20140523.columns.values.tolist():
    daily_20140523_addname_dataframe[table_name] = daily_20140523[table_name]
print("日线行情-时间为序  daily_20140523 返回数据 row 行数 = "+str(daily_20140523.shape[0]))
daily_20140523_addname_dataframe.to_excel(daily_201405_excel_writer,'23_5',index=False)
daily_201405_excel_writer.save()
daily_20140526 = pro.daily(start_date='',end_date='',trade_date='20140526', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20140526_tscode_list = list() 
for ts_code_sh in daily_20140526['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20140526_tscode_list.append(stock_name)
daily_20140526_addname_dataframe=pd.DataFrame()
daily_20140526_addname_dataframe['cname'] = daily_20140526_tscode_list
for table_name in daily_20140526.columns.values.tolist():
    daily_20140526_addname_dataframe[table_name] = daily_20140526[table_name]
print("日线行情-时间为序  daily_20140526 返回数据 row 行数 = "+str(daily_20140526.shape[0]))
daily_20140526_addname_dataframe.to_excel(daily_201405_excel_writer,'26_1',index=False)
daily_201405_excel_writer.save()
daily_20140527 = pro.daily(start_date='',end_date='',trade_date='20140527', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20140527_tscode_list = list() 
for ts_code_sh in daily_20140527['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20140527_tscode_list.append(stock_name)
daily_20140527_addname_dataframe=pd.DataFrame()
daily_20140527_addname_dataframe['cname'] = daily_20140527_tscode_list
for table_name in daily_20140527.columns.values.tolist():
    daily_20140527_addname_dataframe[table_name] = daily_20140527[table_name]
print("日线行情-时间为序  daily_20140527 返回数据 row 行数 = "+str(daily_20140527.shape[0]))
daily_20140527_addname_dataframe.to_excel(daily_201405_excel_writer,'27_2',index=False)
daily_201405_excel_writer.save()
daily_20140528 = pro.daily(start_date='',end_date='',trade_date='20140528', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20140528_tscode_list = list() 
for ts_code_sh in daily_20140528['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20140528_tscode_list.append(stock_name)
daily_20140528_addname_dataframe=pd.DataFrame()
daily_20140528_addname_dataframe['cname'] = daily_20140528_tscode_list
for table_name in daily_20140528.columns.values.tolist():
    daily_20140528_addname_dataframe[table_name] = daily_20140528[table_name]
print("日线行情-时间为序  daily_20140528 返回数据 row 行数 = "+str(daily_20140528.shape[0]))
daily_20140528_addname_dataframe.to_excel(daily_201405_excel_writer,'28_3',index=False)
daily_201405_excel_writer.save()
daily_20140529 = pro.daily(start_date='',end_date='',trade_date='20140529', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20140529_tscode_list = list() 
for ts_code_sh in daily_20140529['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20140529_tscode_list.append(stock_name)
daily_20140529_addname_dataframe=pd.DataFrame()
daily_20140529_addname_dataframe['cname'] = daily_20140529_tscode_list
for table_name in daily_20140529.columns.values.tolist():
    daily_20140529_addname_dataframe[table_name] = daily_20140529[table_name]
print("日线行情-时间为序  daily_20140529 返回数据 row 行数 = "+str(daily_20140529.shape[0]))
daily_20140529_addname_dataframe.to_excel(daily_201405_excel_writer,'29_4',index=False)
daily_201405_excel_writer.save()
daily_20140530 = pro.daily(start_date='',end_date='',trade_date='20140530', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20140530_tscode_list = list() 
for ts_code_sh in daily_20140530['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20140530_tscode_list.append(stock_name)
daily_20140530_addname_dataframe=pd.DataFrame()
daily_20140530_addname_dataframe['cname'] = daily_20140530_tscode_list
for table_name in daily_20140530.columns.values.tolist():
    daily_20140530_addname_dataframe[table_name] = daily_20140530[table_name]
print("日线行情-时间为序  daily_20140530 返回数据 row 行数 = "+str(daily_20140530.shape[0]))
daily_20140530_addname_dataframe.to_excel(daily_201405_excel_writer,'30_5',index=False)
daily_201405_excel_writer.save()




createexcel('daily_201406.xlsx')
daily_201406_book = load_workbook('C:\\Users\\zhuzj5\\Desktop\\zbin\\J0_Data\\daily_201406.xlsx')
daily_201406_excel_writer = pd.ExcelWriter('C:\\Users\\zhuzj5\\Desktop\\zbin\\J0_Data\\daily_201406.xlsx', engine='openpyxl')
daily_201406_excel_writer.book = daily_201406_book
daily_201406_excel_writer.sheets = dict((ws.title, ws) for ws in daily_201406_book.worksheets)
J0_PROPS.put(tree_node_name+"record_date", "20140601")       ###  更新 记录日期
daily_20140603 = pro.daily(start_date='',end_date='',trade_date='20140603', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20140603_tscode_list = list() 
for ts_code_sh in daily_20140603['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20140603_tscode_list.append(stock_name)
daily_20140603_addname_dataframe=pd.DataFrame()
daily_20140603_addname_dataframe['cname'] = daily_20140603_tscode_list
for table_name in daily_20140603.columns.values.tolist():
    daily_20140603_addname_dataframe[table_name] = daily_20140603[table_name]
print("日线行情-时间为序  daily_20140603 返回数据 row 行数 = "+str(daily_20140603.shape[0]))
daily_20140603_addname_dataframe.to_excel(daily_201406_excel_writer,'3_2',index=False)
daily_201406_excel_writer.save()
daily_20140604 = pro.daily(start_date='',end_date='',trade_date='20140604', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20140604_tscode_list = list() 
for ts_code_sh in daily_20140604['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20140604_tscode_list.append(stock_name)
daily_20140604_addname_dataframe=pd.DataFrame()
daily_20140604_addname_dataframe['cname'] = daily_20140604_tscode_list
for table_name in daily_20140604.columns.values.tolist():
    daily_20140604_addname_dataframe[table_name] = daily_20140604[table_name]
print("日线行情-时间为序  daily_20140604 返回数据 row 行数 = "+str(daily_20140604.shape[0]))
daily_20140604_addname_dataframe.to_excel(daily_201406_excel_writer,'4_3',index=False)
daily_201406_excel_writer.save()
daily_20140605 = pro.daily(start_date='',end_date='',trade_date='20140605', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20140605_tscode_list = list() 
for ts_code_sh in daily_20140605['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20140605_tscode_list.append(stock_name)
daily_20140605_addname_dataframe=pd.DataFrame()
daily_20140605_addname_dataframe['cname'] = daily_20140605_tscode_list
for table_name in daily_20140605.columns.values.tolist():
    daily_20140605_addname_dataframe[table_name] = daily_20140605[table_name]
print("日线行情-时间为序  daily_20140605 返回数据 row 行数 = "+str(daily_20140605.shape[0]))
daily_20140605_addname_dataframe.to_excel(daily_201406_excel_writer,'5_4',index=False)
daily_201406_excel_writer.save()
daily_20140606 = pro.daily(start_date='',end_date='',trade_date='20140606', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20140606_tscode_list = list() 
for ts_code_sh in daily_20140606['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20140606_tscode_list.append(stock_name)
daily_20140606_addname_dataframe=pd.DataFrame()
daily_20140606_addname_dataframe['cname'] = daily_20140606_tscode_list
for table_name in daily_20140606.columns.values.tolist():
    daily_20140606_addname_dataframe[table_name] = daily_20140606[table_name]
print("日线行情-时间为序  daily_20140606 返回数据 row 行数 = "+str(daily_20140606.shape[0]))
daily_20140606_addname_dataframe.to_excel(daily_201406_excel_writer,'6_5',index=False)
daily_201406_excel_writer.save()
daily_20140609 = pro.daily(start_date='',end_date='',trade_date='20140609', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20140609_tscode_list = list() 
for ts_code_sh in daily_20140609['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20140609_tscode_list.append(stock_name)
daily_20140609_addname_dataframe=pd.DataFrame()
daily_20140609_addname_dataframe['cname'] = daily_20140609_tscode_list
for table_name in daily_20140609.columns.values.tolist():
    daily_20140609_addname_dataframe[table_name] = daily_20140609[table_name]
print("日线行情-时间为序  daily_20140609 返回数据 row 行数 = "+str(daily_20140609.shape[0]))
daily_20140609_addname_dataframe.to_excel(daily_201406_excel_writer,'9_1',index=False)
daily_201406_excel_writer.save()
daily_20140610 = pro.daily(start_date='',end_date='',trade_date='20140610', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20140610_tscode_list = list() 
for ts_code_sh in daily_20140610['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20140610_tscode_list.append(stock_name)
daily_20140610_addname_dataframe=pd.DataFrame()
daily_20140610_addname_dataframe['cname'] = daily_20140610_tscode_list
for table_name in daily_20140610.columns.values.tolist():
    daily_20140610_addname_dataframe[table_name] = daily_20140610[table_name]
print("日线行情-时间为序  daily_20140610 返回数据 row 行数 = "+str(daily_20140610.shape[0]))
daily_20140610_addname_dataframe.to_excel(daily_201406_excel_writer,'10_2',index=False)
daily_201406_excel_writer.save()
daily_20140611 = pro.daily(start_date='',end_date='',trade_date='20140611', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20140611_tscode_list = list() 
for ts_code_sh in daily_20140611['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20140611_tscode_list.append(stock_name)
daily_20140611_addname_dataframe=pd.DataFrame()
daily_20140611_addname_dataframe['cname'] = daily_20140611_tscode_list
for table_name in daily_20140611.columns.values.tolist():
    daily_20140611_addname_dataframe[table_name] = daily_20140611[table_name]
print("日线行情-时间为序  daily_20140611 返回数据 row 行数 = "+str(daily_20140611.shape[0]))
daily_20140611_addname_dataframe.to_excel(daily_201406_excel_writer,'11_3',index=False)
daily_201406_excel_writer.save()
daily_20140612 = pro.daily(start_date='',end_date='',trade_date='20140612', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20140612_tscode_list = list() 
for ts_code_sh in daily_20140612['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20140612_tscode_list.append(stock_name)
daily_20140612_addname_dataframe=pd.DataFrame()
daily_20140612_addname_dataframe['cname'] = daily_20140612_tscode_list
for table_name in daily_20140612.columns.values.tolist():
    daily_20140612_addname_dataframe[table_name] = daily_20140612[table_name]
print("日线行情-时间为序  daily_20140612 返回数据 row 行数 = "+str(daily_20140612.shape[0]))
daily_20140612_addname_dataframe.to_excel(daily_201406_excel_writer,'12_4',index=False)
daily_201406_excel_writer.save()
daily_20140613 = pro.daily(start_date='',end_date='',trade_date='20140613', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20140613_tscode_list = list() 
for ts_code_sh in daily_20140613['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20140613_tscode_list.append(stock_name)
daily_20140613_addname_dataframe=pd.DataFrame()
daily_20140613_addname_dataframe['cname'] = daily_20140613_tscode_list
for table_name in daily_20140613.columns.values.tolist():
    daily_20140613_addname_dataframe[table_name] = daily_20140613[table_name]
print("日线行情-时间为序  daily_20140613 返回数据 row 行数 = "+str(daily_20140613.shape[0]))
daily_20140613_addname_dataframe.to_excel(daily_201406_excel_writer,'13_5',index=False)
daily_201406_excel_writer.save()
daily_20140616 = pro.daily(start_date='',end_date='',trade_date='20140616', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20140616_tscode_list = list() 
for ts_code_sh in daily_20140616['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20140616_tscode_list.append(stock_name)
daily_20140616_addname_dataframe=pd.DataFrame()
daily_20140616_addname_dataframe['cname'] = daily_20140616_tscode_list
for table_name in daily_20140616.columns.values.tolist():
    daily_20140616_addname_dataframe[table_name] = daily_20140616[table_name]
print("日线行情-时间为序  daily_20140616 返回数据 row 行数 = "+str(daily_20140616.shape[0]))
daily_20140616_addname_dataframe.to_excel(daily_201406_excel_writer,'16_1',index=False)
daily_201406_excel_writer.save()
daily_20140617 = pro.daily(start_date='',end_date='',trade_date='20140617', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20140617_tscode_list = list() 
for ts_code_sh in daily_20140617['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20140617_tscode_list.append(stock_name)
daily_20140617_addname_dataframe=pd.DataFrame()
daily_20140617_addname_dataframe['cname'] = daily_20140617_tscode_list
for table_name in daily_20140617.columns.values.tolist():
    daily_20140617_addname_dataframe[table_name] = daily_20140617[table_name]
print("日线行情-时间为序  daily_20140617 返回数据 row 行数 = "+str(daily_20140617.shape[0]))
daily_20140617_addname_dataframe.to_excel(daily_201406_excel_writer,'17_2',index=False)
daily_201406_excel_writer.save()
daily_20140618 = pro.daily(start_date='',end_date='',trade_date='20140618', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20140618_tscode_list = list() 
for ts_code_sh in daily_20140618['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20140618_tscode_list.append(stock_name)
daily_20140618_addname_dataframe=pd.DataFrame()
daily_20140618_addname_dataframe['cname'] = daily_20140618_tscode_list
for table_name in daily_20140618.columns.values.tolist():
    daily_20140618_addname_dataframe[table_name] = daily_20140618[table_name]
print("日线行情-时间为序  daily_20140618 返回数据 row 行数 = "+str(daily_20140618.shape[0]))
daily_20140618_addname_dataframe.to_excel(daily_201406_excel_writer,'18_3',index=False)
daily_201406_excel_writer.save()
daily_20140619 = pro.daily(start_date='',end_date='',trade_date='20140619', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20140619_tscode_list = list() 
for ts_code_sh in daily_20140619['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20140619_tscode_list.append(stock_name)
daily_20140619_addname_dataframe=pd.DataFrame()
daily_20140619_addname_dataframe['cname'] = daily_20140619_tscode_list
for table_name in daily_20140619.columns.values.tolist():
    daily_20140619_addname_dataframe[table_name] = daily_20140619[table_name]
print("日线行情-时间为序  daily_20140619 返回数据 row 行数 = "+str(daily_20140619.shape[0]))
daily_20140619_addname_dataframe.to_excel(daily_201406_excel_writer,'19_4',index=False)
daily_201406_excel_writer.save()
daily_20140620 = pro.daily(start_date='',end_date='',trade_date='20140620', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20140620_tscode_list = list() 
for ts_code_sh in daily_20140620['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20140620_tscode_list.append(stock_name)
daily_20140620_addname_dataframe=pd.DataFrame()
daily_20140620_addname_dataframe['cname'] = daily_20140620_tscode_list
for table_name in daily_20140620.columns.values.tolist():
    daily_20140620_addname_dataframe[table_name] = daily_20140620[table_name]
print("日线行情-时间为序  daily_20140620 返回数据 row 行数 = "+str(daily_20140620.shape[0]))
daily_20140620_addname_dataframe.to_excel(daily_201406_excel_writer,'20_5',index=False)
daily_201406_excel_writer.save()
daily_20140623 = pro.daily(start_date='',end_date='',trade_date='20140623', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20140623_tscode_list = list() 
for ts_code_sh in daily_20140623['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20140623_tscode_list.append(stock_name)
daily_20140623_addname_dataframe=pd.DataFrame()
daily_20140623_addname_dataframe['cname'] = daily_20140623_tscode_list
for table_name in daily_20140623.columns.values.tolist():
    daily_20140623_addname_dataframe[table_name] = daily_20140623[table_name]
print("日线行情-时间为序  daily_20140623 返回数据 row 行数 = "+str(daily_20140623.shape[0]))
daily_20140623_addname_dataframe.to_excel(daily_201406_excel_writer,'23_1',index=False)
daily_201406_excel_writer.save()
daily_20140624 = pro.daily(start_date='',end_date='',trade_date='20140624', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20140624_tscode_list = list() 
for ts_code_sh in daily_20140624['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20140624_tscode_list.append(stock_name)
daily_20140624_addname_dataframe=pd.DataFrame()
daily_20140624_addname_dataframe['cname'] = daily_20140624_tscode_list
for table_name in daily_20140624.columns.values.tolist():
    daily_20140624_addname_dataframe[table_name] = daily_20140624[table_name]
print("日线行情-时间为序  daily_20140624 返回数据 row 行数 = "+str(daily_20140624.shape[0]))
daily_20140624_addname_dataframe.to_excel(daily_201406_excel_writer,'24_2',index=False)
daily_201406_excel_writer.save()
daily_20140625 = pro.daily(start_date='',end_date='',trade_date='20140625', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20140625_tscode_list = list() 
for ts_code_sh in daily_20140625['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20140625_tscode_list.append(stock_name)
daily_20140625_addname_dataframe=pd.DataFrame()
daily_20140625_addname_dataframe['cname'] = daily_20140625_tscode_list
for table_name in daily_20140625.columns.values.tolist():
    daily_20140625_addname_dataframe[table_name] = daily_20140625[table_name]
print("日线行情-时间为序  daily_20140625 返回数据 row 行数 = "+str(daily_20140625.shape[0]))
daily_20140625_addname_dataframe.to_excel(daily_201406_excel_writer,'25_3',index=False)
daily_201406_excel_writer.save()
daily_20140626 = pro.daily(start_date='',end_date='',trade_date='20140626', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20140626_tscode_list = list() 
for ts_code_sh in daily_20140626['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20140626_tscode_list.append(stock_name)
daily_20140626_addname_dataframe=pd.DataFrame()
daily_20140626_addname_dataframe['cname'] = daily_20140626_tscode_list
for table_name in daily_20140626.columns.values.tolist():
    daily_20140626_addname_dataframe[table_name] = daily_20140626[table_name]
print("日线行情-时间为序  daily_20140626 返回数据 row 行数 = "+str(daily_20140626.shape[0]))
daily_20140626_addname_dataframe.to_excel(daily_201406_excel_writer,'26_4',index=False)
daily_201406_excel_writer.save()
daily_20140627 = pro.daily(start_date='',end_date='',trade_date='20140627', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20140627_tscode_list = list() 
for ts_code_sh in daily_20140627['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20140627_tscode_list.append(stock_name)
daily_20140627_addname_dataframe=pd.DataFrame()
daily_20140627_addname_dataframe['cname'] = daily_20140627_tscode_list
for table_name in daily_20140627.columns.values.tolist():
    daily_20140627_addname_dataframe[table_name] = daily_20140627[table_name]
print("日线行情-时间为序  daily_20140627 返回数据 row 行数 = "+str(daily_20140627.shape[0]))
daily_20140627_addname_dataframe.to_excel(daily_201406_excel_writer,'27_5',index=False)
daily_201406_excel_writer.save()
daily_20140630 = pro.daily(start_date='',end_date='',trade_date='20140630', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20140630_tscode_list = list() 
for ts_code_sh in daily_20140630['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20140630_tscode_list.append(stock_name)
daily_20140630_addname_dataframe=pd.DataFrame()
daily_20140630_addname_dataframe['cname'] = daily_20140630_tscode_list
for table_name in daily_20140630.columns.values.tolist():
    daily_20140630_addname_dataframe[table_name] = daily_20140630[table_name]
print("日线行情-时间为序  daily_20140630 返回数据 row 行数 = "+str(daily_20140630.shape[0]))
daily_20140630_addname_dataframe.to_excel(daily_201406_excel_writer,'30_1',index=False)
daily_201406_excel_writer.save()




createexcel('daily_201407.xlsx')
daily_201407_book = load_workbook('C:\\Users\\zhuzj5\\Desktop\\zbin\\J0_Data\\daily_201407.xlsx')
daily_201407_excel_writer = pd.ExcelWriter('C:\\Users\\zhuzj5\\Desktop\\zbin\\J0_Data\\daily_201407.xlsx', engine='openpyxl')
daily_201407_excel_writer.book = daily_201407_book
daily_201407_excel_writer.sheets = dict((ws.title, ws) for ws in daily_201407_book.worksheets)
J0_PROPS.put(tree_node_name+"record_date", "20140701")       ###  更新 记录日期
daily_20140701 = pro.daily(start_date='',end_date='',trade_date='20140701', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20140701_tscode_list = list() 
for ts_code_sh in daily_20140701['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20140701_tscode_list.append(stock_name)
daily_20140701_addname_dataframe=pd.DataFrame()
daily_20140701_addname_dataframe['cname'] = daily_20140701_tscode_list
for table_name in daily_20140701.columns.values.tolist():
    daily_20140701_addname_dataframe[table_name] = daily_20140701[table_name]
print("日线行情-时间为序  daily_20140701 返回数据 row 行数 = "+str(daily_20140701.shape[0]))
daily_20140701_addname_dataframe.to_excel(daily_201407_excel_writer,'1_2',index=False)
daily_201407_excel_writer.save()
daily_20140702 = pro.daily(start_date='',end_date='',trade_date='20140702', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20140702_tscode_list = list() 
for ts_code_sh in daily_20140702['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20140702_tscode_list.append(stock_name)
daily_20140702_addname_dataframe=pd.DataFrame()
daily_20140702_addname_dataframe['cname'] = daily_20140702_tscode_list
for table_name in daily_20140702.columns.values.tolist():
    daily_20140702_addname_dataframe[table_name] = daily_20140702[table_name]
print("日线行情-时间为序  daily_20140702 返回数据 row 行数 = "+str(daily_20140702.shape[0]))
daily_20140702_addname_dataframe.to_excel(daily_201407_excel_writer,'2_3',index=False)
daily_201407_excel_writer.save()
daily_20140703 = pro.daily(start_date='',end_date='',trade_date='20140703', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20140703_tscode_list = list() 
for ts_code_sh in daily_20140703['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20140703_tscode_list.append(stock_name)
daily_20140703_addname_dataframe=pd.DataFrame()
daily_20140703_addname_dataframe['cname'] = daily_20140703_tscode_list
for table_name in daily_20140703.columns.values.tolist():
    daily_20140703_addname_dataframe[table_name] = daily_20140703[table_name]
print("日线行情-时间为序  daily_20140703 返回数据 row 行数 = "+str(daily_20140703.shape[0]))
daily_20140703_addname_dataframe.to_excel(daily_201407_excel_writer,'3_4',index=False)
daily_201407_excel_writer.save()
daily_20140704 = pro.daily(start_date='',end_date='',trade_date='20140704', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20140704_tscode_list = list() 
for ts_code_sh in daily_20140704['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20140704_tscode_list.append(stock_name)
daily_20140704_addname_dataframe=pd.DataFrame()
daily_20140704_addname_dataframe['cname'] = daily_20140704_tscode_list
for table_name in daily_20140704.columns.values.tolist():
    daily_20140704_addname_dataframe[table_name] = daily_20140704[table_name]
print("日线行情-时间为序  daily_20140704 返回数据 row 行数 = "+str(daily_20140704.shape[0]))
daily_20140704_addname_dataframe.to_excel(daily_201407_excel_writer,'4_5',index=False)
daily_201407_excel_writer.save()
daily_20140707 = pro.daily(start_date='',end_date='',trade_date='20140707', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20140707_tscode_list = list() 
for ts_code_sh in daily_20140707['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20140707_tscode_list.append(stock_name)
daily_20140707_addname_dataframe=pd.DataFrame()
daily_20140707_addname_dataframe['cname'] = daily_20140707_tscode_list
for table_name in daily_20140707.columns.values.tolist():
    daily_20140707_addname_dataframe[table_name] = daily_20140707[table_name]
print("日线行情-时间为序  daily_20140707 返回数据 row 行数 = "+str(daily_20140707.shape[0]))
daily_20140707_addname_dataframe.to_excel(daily_201407_excel_writer,'7_1',index=False)
daily_201407_excel_writer.save()
daily_20140708 = pro.daily(start_date='',end_date='',trade_date='20140708', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20140708_tscode_list = list() 
for ts_code_sh in daily_20140708['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20140708_tscode_list.append(stock_name)
daily_20140708_addname_dataframe=pd.DataFrame()
daily_20140708_addname_dataframe['cname'] = daily_20140708_tscode_list
for table_name in daily_20140708.columns.values.tolist():
    daily_20140708_addname_dataframe[table_name] = daily_20140708[table_name]
print("日线行情-时间为序  daily_20140708 返回数据 row 行数 = "+str(daily_20140708.shape[0]))
daily_20140708_addname_dataframe.to_excel(daily_201407_excel_writer,'8_2',index=False)
daily_201407_excel_writer.save()
daily_20140709 = pro.daily(start_date='',end_date='',trade_date='20140709', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20140709_tscode_list = list() 
for ts_code_sh in daily_20140709['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20140709_tscode_list.append(stock_name)
daily_20140709_addname_dataframe=pd.DataFrame()
daily_20140709_addname_dataframe['cname'] = daily_20140709_tscode_list
for table_name in daily_20140709.columns.values.tolist():
    daily_20140709_addname_dataframe[table_name] = daily_20140709[table_name]
print("日线行情-时间为序  daily_20140709 返回数据 row 行数 = "+str(daily_20140709.shape[0]))
daily_20140709_addname_dataframe.to_excel(daily_201407_excel_writer,'9_3',index=False)
daily_201407_excel_writer.save()
daily_20140710 = pro.daily(start_date='',end_date='',trade_date='20140710', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20140710_tscode_list = list() 
for ts_code_sh in daily_20140710['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20140710_tscode_list.append(stock_name)
daily_20140710_addname_dataframe=pd.DataFrame()
daily_20140710_addname_dataframe['cname'] = daily_20140710_tscode_list
for table_name in daily_20140710.columns.values.tolist():
    daily_20140710_addname_dataframe[table_name] = daily_20140710[table_name]
print("日线行情-时间为序  daily_20140710 返回数据 row 行数 = "+str(daily_20140710.shape[0]))
daily_20140710_addname_dataframe.to_excel(daily_201407_excel_writer,'10_4',index=False)
daily_201407_excel_writer.save()
daily_20140711 = pro.daily(start_date='',end_date='',trade_date='20140711', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20140711_tscode_list = list() 
for ts_code_sh in daily_20140711['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20140711_tscode_list.append(stock_name)
daily_20140711_addname_dataframe=pd.DataFrame()
daily_20140711_addname_dataframe['cname'] = daily_20140711_tscode_list
for table_name in daily_20140711.columns.values.tolist():
    daily_20140711_addname_dataframe[table_name] = daily_20140711[table_name]
print("日线行情-时间为序  daily_20140711 返回数据 row 行数 = "+str(daily_20140711.shape[0]))
daily_20140711_addname_dataframe.to_excel(daily_201407_excel_writer,'11_5',index=False)
daily_201407_excel_writer.save()
daily_20140714 = pro.daily(start_date='',end_date='',trade_date='20140714', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20140714_tscode_list = list() 
for ts_code_sh in daily_20140714['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20140714_tscode_list.append(stock_name)
daily_20140714_addname_dataframe=pd.DataFrame()
daily_20140714_addname_dataframe['cname'] = daily_20140714_tscode_list
for table_name in daily_20140714.columns.values.tolist():
    daily_20140714_addname_dataframe[table_name] = daily_20140714[table_name]
print("日线行情-时间为序  daily_20140714 返回数据 row 行数 = "+str(daily_20140714.shape[0]))
daily_20140714_addname_dataframe.to_excel(daily_201407_excel_writer,'14_1',index=False)
daily_201407_excel_writer.save()
daily_20140715 = pro.daily(start_date='',end_date='',trade_date='20140715', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20140715_tscode_list = list() 
for ts_code_sh in daily_20140715['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20140715_tscode_list.append(stock_name)
daily_20140715_addname_dataframe=pd.DataFrame()
daily_20140715_addname_dataframe['cname'] = daily_20140715_tscode_list
for table_name in daily_20140715.columns.values.tolist():
    daily_20140715_addname_dataframe[table_name] = daily_20140715[table_name]
print("日线行情-时间为序  daily_20140715 返回数据 row 行数 = "+str(daily_20140715.shape[0]))
daily_20140715_addname_dataframe.to_excel(daily_201407_excel_writer,'15_2',index=False)
daily_201407_excel_writer.save()
daily_20140716 = pro.daily(start_date='',end_date='',trade_date='20140716', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20140716_tscode_list = list() 
for ts_code_sh in daily_20140716['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20140716_tscode_list.append(stock_name)
daily_20140716_addname_dataframe=pd.DataFrame()
daily_20140716_addname_dataframe['cname'] = daily_20140716_tscode_list
for table_name in daily_20140716.columns.values.tolist():
    daily_20140716_addname_dataframe[table_name] = daily_20140716[table_name]
print("日线行情-时间为序  daily_20140716 返回数据 row 行数 = "+str(daily_20140716.shape[0]))
daily_20140716_addname_dataframe.to_excel(daily_201407_excel_writer,'16_3',index=False)
daily_201407_excel_writer.save()
daily_20140717 = pro.daily(start_date='',end_date='',trade_date='20140717', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20140717_tscode_list = list() 
for ts_code_sh in daily_20140717['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20140717_tscode_list.append(stock_name)
daily_20140717_addname_dataframe=pd.DataFrame()
daily_20140717_addname_dataframe['cname'] = daily_20140717_tscode_list
for table_name in daily_20140717.columns.values.tolist():
    daily_20140717_addname_dataframe[table_name] = daily_20140717[table_name]
print("日线行情-时间为序  daily_20140717 返回数据 row 行数 = "+str(daily_20140717.shape[0]))
daily_20140717_addname_dataframe.to_excel(daily_201407_excel_writer,'17_4',index=False)
daily_201407_excel_writer.save()
daily_20140718 = pro.daily(start_date='',end_date='',trade_date='20140718', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20140718_tscode_list = list() 
for ts_code_sh in daily_20140718['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20140718_tscode_list.append(stock_name)
daily_20140718_addname_dataframe=pd.DataFrame()
daily_20140718_addname_dataframe['cname'] = daily_20140718_tscode_list
for table_name in daily_20140718.columns.values.tolist():
    daily_20140718_addname_dataframe[table_name] = daily_20140718[table_name]
print("日线行情-时间为序  daily_20140718 返回数据 row 行数 = "+str(daily_20140718.shape[0]))
daily_20140718_addname_dataframe.to_excel(daily_201407_excel_writer,'18_5',index=False)
daily_201407_excel_writer.save()
daily_20140721 = pro.daily(start_date='',end_date='',trade_date='20140721', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20140721_tscode_list = list() 
for ts_code_sh in daily_20140721['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20140721_tscode_list.append(stock_name)
daily_20140721_addname_dataframe=pd.DataFrame()
daily_20140721_addname_dataframe['cname'] = daily_20140721_tscode_list
for table_name in daily_20140721.columns.values.tolist():
    daily_20140721_addname_dataframe[table_name] = daily_20140721[table_name]
print("日线行情-时间为序  daily_20140721 返回数据 row 行数 = "+str(daily_20140721.shape[0]))
daily_20140721_addname_dataframe.to_excel(daily_201407_excel_writer,'21_1',index=False)
daily_201407_excel_writer.save()
daily_20140722 = pro.daily(start_date='',end_date='',trade_date='20140722', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20140722_tscode_list = list() 
for ts_code_sh in daily_20140722['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20140722_tscode_list.append(stock_name)
daily_20140722_addname_dataframe=pd.DataFrame()
daily_20140722_addname_dataframe['cname'] = daily_20140722_tscode_list
for table_name in daily_20140722.columns.values.tolist():
    daily_20140722_addname_dataframe[table_name] = daily_20140722[table_name]
print("日线行情-时间为序  daily_20140722 返回数据 row 行数 = "+str(daily_20140722.shape[0]))
daily_20140722_addname_dataframe.to_excel(daily_201407_excel_writer,'22_2',index=False)
daily_201407_excel_writer.save()
daily_20140723 = pro.daily(start_date='',end_date='',trade_date='20140723', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20140723_tscode_list = list() 
for ts_code_sh in daily_20140723['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20140723_tscode_list.append(stock_name)
daily_20140723_addname_dataframe=pd.DataFrame()
daily_20140723_addname_dataframe['cname'] = daily_20140723_tscode_list
for table_name in daily_20140723.columns.values.tolist():
    daily_20140723_addname_dataframe[table_name] = daily_20140723[table_name]
print("日线行情-时间为序  daily_20140723 返回数据 row 行数 = "+str(daily_20140723.shape[0]))
daily_20140723_addname_dataframe.to_excel(daily_201407_excel_writer,'23_3',index=False)
daily_201407_excel_writer.save()
daily_20140724 = pro.daily(start_date='',end_date='',trade_date='20140724', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20140724_tscode_list = list() 
for ts_code_sh in daily_20140724['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20140724_tscode_list.append(stock_name)
daily_20140724_addname_dataframe=pd.DataFrame()
daily_20140724_addname_dataframe['cname'] = daily_20140724_tscode_list
for table_name in daily_20140724.columns.values.tolist():
    daily_20140724_addname_dataframe[table_name] = daily_20140724[table_name]
print("日线行情-时间为序  daily_20140724 返回数据 row 行数 = "+str(daily_20140724.shape[0]))
daily_20140724_addname_dataframe.to_excel(daily_201407_excel_writer,'24_4',index=False)
daily_201407_excel_writer.save()
daily_20140725 = pro.daily(start_date='',end_date='',trade_date='20140725', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20140725_tscode_list = list() 
for ts_code_sh in daily_20140725['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20140725_tscode_list.append(stock_name)
daily_20140725_addname_dataframe=pd.DataFrame()
daily_20140725_addname_dataframe['cname'] = daily_20140725_tscode_list
for table_name in daily_20140725.columns.values.tolist():
    daily_20140725_addname_dataframe[table_name] = daily_20140725[table_name]
print("日线行情-时间为序  daily_20140725 返回数据 row 行数 = "+str(daily_20140725.shape[0]))
daily_20140725_addname_dataframe.to_excel(daily_201407_excel_writer,'25_5',index=False)
daily_201407_excel_writer.save()
daily_20140728 = pro.daily(start_date='',end_date='',trade_date='20140728', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20140728_tscode_list = list() 
for ts_code_sh in daily_20140728['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20140728_tscode_list.append(stock_name)
daily_20140728_addname_dataframe=pd.DataFrame()
daily_20140728_addname_dataframe['cname'] = daily_20140728_tscode_list
for table_name in daily_20140728.columns.values.tolist():
    daily_20140728_addname_dataframe[table_name] = daily_20140728[table_name]
print("日线行情-时间为序  daily_20140728 返回数据 row 行数 = "+str(daily_20140728.shape[0]))
daily_20140728_addname_dataframe.to_excel(daily_201407_excel_writer,'28_1',index=False)
daily_201407_excel_writer.save()
daily_20140729 = pro.daily(start_date='',end_date='',trade_date='20140729', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20140729_tscode_list = list() 
for ts_code_sh in daily_20140729['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20140729_tscode_list.append(stock_name)
daily_20140729_addname_dataframe=pd.DataFrame()
daily_20140729_addname_dataframe['cname'] = daily_20140729_tscode_list
for table_name in daily_20140729.columns.values.tolist():
    daily_20140729_addname_dataframe[table_name] = daily_20140729[table_name]
print("日线行情-时间为序  daily_20140729 返回数据 row 行数 = "+str(daily_20140729.shape[0]))
daily_20140729_addname_dataframe.to_excel(daily_201407_excel_writer,'29_2',index=False)
daily_201407_excel_writer.save()
daily_20140730 = pro.daily(start_date='',end_date='',trade_date='20140730', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20140730_tscode_list = list() 
for ts_code_sh in daily_20140730['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20140730_tscode_list.append(stock_name)
daily_20140730_addname_dataframe=pd.DataFrame()
daily_20140730_addname_dataframe['cname'] = daily_20140730_tscode_list
for table_name in daily_20140730.columns.values.tolist():
    daily_20140730_addname_dataframe[table_name] = daily_20140730[table_name]
print("日线行情-时间为序  daily_20140730 返回数据 row 行数 = "+str(daily_20140730.shape[0]))
daily_20140730_addname_dataframe.to_excel(daily_201407_excel_writer,'30_3',index=False)
daily_201407_excel_writer.save()
daily_20140731 = pro.daily(start_date='',end_date='',trade_date='20140731', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20140731_tscode_list = list() 
for ts_code_sh in daily_20140731['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20140731_tscode_list.append(stock_name)
daily_20140731_addname_dataframe=pd.DataFrame()
daily_20140731_addname_dataframe['cname'] = daily_20140731_tscode_list
for table_name in daily_20140731.columns.values.tolist():
    daily_20140731_addname_dataframe[table_name] = daily_20140731[table_name]
print("日线行情-时间为序  daily_20140731 返回数据 row 行数 = "+str(daily_20140731.shape[0]))
daily_20140731_addname_dataframe.to_excel(daily_201407_excel_writer,'31_4',index=False)
daily_201407_excel_writer.save()




createexcel('daily_201408.xlsx')
daily_201408_book = load_workbook('C:\\Users\\zhuzj5\\Desktop\\zbin\\J0_Data\\daily_201408.xlsx')
daily_201408_excel_writer = pd.ExcelWriter('C:\\Users\\zhuzj5\\Desktop\\zbin\\J0_Data\\daily_201408.xlsx', engine='openpyxl')
daily_201408_excel_writer.book = daily_201408_book
daily_201408_excel_writer.sheets = dict((ws.title, ws) for ws in daily_201408_book.worksheets)
J0_PROPS.put(tree_node_name+"record_date", "20140801")       ###  更新 记录日期
daily_20140801 = pro.daily(start_date='',end_date='',trade_date='20140801', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20140801_tscode_list = list() 
for ts_code_sh in daily_20140801['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20140801_tscode_list.append(stock_name)
daily_20140801_addname_dataframe=pd.DataFrame()
daily_20140801_addname_dataframe['cname'] = daily_20140801_tscode_list
for table_name in daily_20140801.columns.values.tolist():
    daily_20140801_addname_dataframe[table_name] = daily_20140801[table_name]
print("日线行情-时间为序  daily_20140801 返回数据 row 行数 = "+str(daily_20140801.shape[0]))
daily_20140801_addname_dataframe.to_excel(daily_201408_excel_writer,'1_5',index=False)
daily_201408_excel_writer.save()
daily_20140804 = pro.daily(start_date='',end_date='',trade_date='20140804', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20140804_tscode_list = list() 
for ts_code_sh in daily_20140804['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20140804_tscode_list.append(stock_name)
daily_20140804_addname_dataframe=pd.DataFrame()
daily_20140804_addname_dataframe['cname'] = daily_20140804_tscode_list
for table_name in daily_20140804.columns.values.tolist():
    daily_20140804_addname_dataframe[table_name] = daily_20140804[table_name]
print("日线行情-时间为序  daily_20140804 返回数据 row 行数 = "+str(daily_20140804.shape[0]))
daily_20140804_addname_dataframe.to_excel(daily_201408_excel_writer,'4_1',index=False)
daily_201408_excel_writer.save()
daily_20140805 = pro.daily(start_date='',end_date='',trade_date='20140805', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20140805_tscode_list = list() 
for ts_code_sh in daily_20140805['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20140805_tscode_list.append(stock_name)
daily_20140805_addname_dataframe=pd.DataFrame()
daily_20140805_addname_dataframe['cname'] = daily_20140805_tscode_list
for table_name in daily_20140805.columns.values.tolist():
    daily_20140805_addname_dataframe[table_name] = daily_20140805[table_name]
print("日线行情-时间为序  daily_20140805 返回数据 row 行数 = "+str(daily_20140805.shape[0]))
daily_20140805_addname_dataframe.to_excel(daily_201408_excel_writer,'5_2',index=False)
daily_201408_excel_writer.save()
daily_20140806 = pro.daily(start_date='',end_date='',trade_date='20140806', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20140806_tscode_list = list() 
for ts_code_sh in daily_20140806['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20140806_tscode_list.append(stock_name)
daily_20140806_addname_dataframe=pd.DataFrame()
daily_20140806_addname_dataframe['cname'] = daily_20140806_tscode_list
for table_name in daily_20140806.columns.values.tolist():
    daily_20140806_addname_dataframe[table_name] = daily_20140806[table_name]
print("日线行情-时间为序  daily_20140806 返回数据 row 行数 = "+str(daily_20140806.shape[0]))
daily_20140806_addname_dataframe.to_excel(daily_201408_excel_writer,'6_3',index=False)
daily_201408_excel_writer.save()
daily_20140807 = pro.daily(start_date='',end_date='',trade_date='20140807', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20140807_tscode_list = list() 
for ts_code_sh in daily_20140807['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20140807_tscode_list.append(stock_name)
daily_20140807_addname_dataframe=pd.DataFrame()
daily_20140807_addname_dataframe['cname'] = daily_20140807_tscode_list
for table_name in daily_20140807.columns.values.tolist():
    daily_20140807_addname_dataframe[table_name] = daily_20140807[table_name]
print("日线行情-时间为序  daily_20140807 返回数据 row 行数 = "+str(daily_20140807.shape[0]))
daily_20140807_addname_dataframe.to_excel(daily_201408_excel_writer,'7_4',index=False)
daily_201408_excel_writer.save()
daily_20140808 = pro.daily(start_date='',end_date='',trade_date='20140808', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20140808_tscode_list = list() 
for ts_code_sh in daily_20140808['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20140808_tscode_list.append(stock_name)
daily_20140808_addname_dataframe=pd.DataFrame()
daily_20140808_addname_dataframe['cname'] = daily_20140808_tscode_list
for table_name in daily_20140808.columns.values.tolist():
    daily_20140808_addname_dataframe[table_name] = daily_20140808[table_name]
print("日线行情-时间为序  daily_20140808 返回数据 row 行数 = "+str(daily_20140808.shape[0]))
daily_20140808_addname_dataframe.to_excel(daily_201408_excel_writer,'8_5',index=False)
daily_201408_excel_writer.save()
daily_20140811 = pro.daily(start_date='',end_date='',trade_date='20140811', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20140811_tscode_list = list() 
for ts_code_sh in daily_20140811['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20140811_tscode_list.append(stock_name)
daily_20140811_addname_dataframe=pd.DataFrame()
daily_20140811_addname_dataframe['cname'] = daily_20140811_tscode_list
for table_name in daily_20140811.columns.values.tolist():
    daily_20140811_addname_dataframe[table_name] = daily_20140811[table_name]
print("日线行情-时间为序  daily_20140811 返回数据 row 行数 = "+str(daily_20140811.shape[0]))
daily_20140811_addname_dataframe.to_excel(daily_201408_excel_writer,'11_1',index=False)
daily_201408_excel_writer.save()
daily_20140812 = pro.daily(start_date='',end_date='',trade_date='20140812', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20140812_tscode_list = list() 
for ts_code_sh in daily_20140812['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20140812_tscode_list.append(stock_name)
daily_20140812_addname_dataframe=pd.DataFrame()
daily_20140812_addname_dataframe['cname'] = daily_20140812_tscode_list
for table_name in daily_20140812.columns.values.tolist():
    daily_20140812_addname_dataframe[table_name] = daily_20140812[table_name]
print("日线行情-时间为序  daily_20140812 返回数据 row 行数 = "+str(daily_20140812.shape[0]))
daily_20140812_addname_dataframe.to_excel(daily_201408_excel_writer,'12_2',index=False)
daily_201408_excel_writer.save()
daily_20140813 = pro.daily(start_date='',end_date='',trade_date='20140813', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20140813_tscode_list = list() 
for ts_code_sh in daily_20140813['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20140813_tscode_list.append(stock_name)
daily_20140813_addname_dataframe=pd.DataFrame()
daily_20140813_addname_dataframe['cname'] = daily_20140813_tscode_list
for table_name in daily_20140813.columns.values.tolist():
    daily_20140813_addname_dataframe[table_name] = daily_20140813[table_name]
print("日线行情-时间为序  daily_20140813 返回数据 row 行数 = "+str(daily_20140813.shape[0]))
daily_20140813_addname_dataframe.to_excel(daily_201408_excel_writer,'13_3',index=False)
daily_201408_excel_writer.save()
daily_20140814 = pro.daily(start_date='',end_date='',trade_date='20140814', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20140814_tscode_list = list() 
for ts_code_sh in daily_20140814['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20140814_tscode_list.append(stock_name)
daily_20140814_addname_dataframe=pd.DataFrame()
daily_20140814_addname_dataframe['cname'] = daily_20140814_tscode_list
for table_name in daily_20140814.columns.values.tolist():
    daily_20140814_addname_dataframe[table_name] = daily_20140814[table_name]
print("日线行情-时间为序  daily_20140814 返回数据 row 行数 = "+str(daily_20140814.shape[0]))
daily_20140814_addname_dataframe.to_excel(daily_201408_excel_writer,'14_4',index=False)
daily_201408_excel_writer.save()
daily_20140815 = pro.daily(start_date='',end_date='',trade_date='20140815', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20140815_tscode_list = list() 
for ts_code_sh in daily_20140815['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20140815_tscode_list.append(stock_name)
daily_20140815_addname_dataframe=pd.DataFrame()
daily_20140815_addname_dataframe['cname'] = daily_20140815_tscode_list
for table_name in daily_20140815.columns.values.tolist():
    daily_20140815_addname_dataframe[table_name] = daily_20140815[table_name]
print("日线行情-时间为序  daily_20140815 返回数据 row 行数 = "+str(daily_20140815.shape[0]))
daily_20140815_addname_dataframe.to_excel(daily_201408_excel_writer,'15_5',index=False)
daily_201408_excel_writer.save()
daily_20140818 = pro.daily(start_date='',end_date='',trade_date='20140818', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20140818_tscode_list = list() 
for ts_code_sh in daily_20140818['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20140818_tscode_list.append(stock_name)
daily_20140818_addname_dataframe=pd.DataFrame()
daily_20140818_addname_dataframe['cname'] = daily_20140818_tscode_list
for table_name in daily_20140818.columns.values.tolist():
    daily_20140818_addname_dataframe[table_name] = daily_20140818[table_name]
print("日线行情-时间为序  daily_20140818 返回数据 row 行数 = "+str(daily_20140818.shape[0]))
daily_20140818_addname_dataframe.to_excel(daily_201408_excel_writer,'18_1',index=False)
daily_201408_excel_writer.save()
daily_20140819 = pro.daily(start_date='',end_date='',trade_date='20140819', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20140819_tscode_list = list() 
for ts_code_sh in daily_20140819['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20140819_tscode_list.append(stock_name)
daily_20140819_addname_dataframe=pd.DataFrame()
daily_20140819_addname_dataframe['cname'] = daily_20140819_tscode_list
for table_name in daily_20140819.columns.values.tolist():
    daily_20140819_addname_dataframe[table_name] = daily_20140819[table_name]
print("日线行情-时间为序  daily_20140819 返回数据 row 行数 = "+str(daily_20140819.shape[0]))
daily_20140819_addname_dataframe.to_excel(daily_201408_excel_writer,'19_2',index=False)
daily_201408_excel_writer.save()
daily_20140820 = pro.daily(start_date='',end_date='',trade_date='20140820', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20140820_tscode_list = list() 
for ts_code_sh in daily_20140820['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20140820_tscode_list.append(stock_name)
daily_20140820_addname_dataframe=pd.DataFrame()
daily_20140820_addname_dataframe['cname'] = daily_20140820_tscode_list
for table_name in daily_20140820.columns.values.tolist():
    daily_20140820_addname_dataframe[table_name] = daily_20140820[table_name]
print("日线行情-时间为序  daily_20140820 返回数据 row 行数 = "+str(daily_20140820.shape[0]))
daily_20140820_addname_dataframe.to_excel(daily_201408_excel_writer,'20_3',index=False)
daily_201408_excel_writer.save()
daily_20140821 = pro.daily(start_date='',end_date='',trade_date='20140821', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20140821_tscode_list = list() 
for ts_code_sh in daily_20140821['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20140821_tscode_list.append(stock_name)
daily_20140821_addname_dataframe=pd.DataFrame()
daily_20140821_addname_dataframe['cname'] = daily_20140821_tscode_list
for table_name in daily_20140821.columns.values.tolist():
    daily_20140821_addname_dataframe[table_name] = daily_20140821[table_name]
print("日线行情-时间为序  daily_20140821 返回数据 row 行数 = "+str(daily_20140821.shape[0]))
daily_20140821_addname_dataframe.to_excel(daily_201408_excel_writer,'21_4',index=False)
daily_201408_excel_writer.save()
daily_20140822 = pro.daily(start_date='',end_date='',trade_date='20140822', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20140822_tscode_list = list() 
for ts_code_sh in daily_20140822['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20140822_tscode_list.append(stock_name)
daily_20140822_addname_dataframe=pd.DataFrame()
daily_20140822_addname_dataframe['cname'] = daily_20140822_tscode_list
for table_name in daily_20140822.columns.values.tolist():
    daily_20140822_addname_dataframe[table_name] = daily_20140822[table_name]
print("日线行情-时间为序  daily_20140822 返回数据 row 行数 = "+str(daily_20140822.shape[0]))
daily_20140822_addname_dataframe.to_excel(daily_201408_excel_writer,'22_5',index=False)
daily_201408_excel_writer.save()
daily_20140825 = pro.daily(start_date='',end_date='',trade_date='20140825', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20140825_tscode_list = list() 
for ts_code_sh in daily_20140825['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20140825_tscode_list.append(stock_name)
daily_20140825_addname_dataframe=pd.DataFrame()
daily_20140825_addname_dataframe['cname'] = daily_20140825_tscode_list
for table_name in daily_20140825.columns.values.tolist():
    daily_20140825_addname_dataframe[table_name] = daily_20140825[table_name]
print("日线行情-时间为序  daily_20140825 返回数据 row 行数 = "+str(daily_20140825.shape[0]))
daily_20140825_addname_dataframe.to_excel(daily_201408_excel_writer,'25_1',index=False)
daily_201408_excel_writer.save()
daily_20140826 = pro.daily(start_date='',end_date='',trade_date='20140826', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20140826_tscode_list = list() 
for ts_code_sh in daily_20140826['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20140826_tscode_list.append(stock_name)
daily_20140826_addname_dataframe=pd.DataFrame()
daily_20140826_addname_dataframe['cname'] = daily_20140826_tscode_list
for table_name in daily_20140826.columns.values.tolist():
    daily_20140826_addname_dataframe[table_name] = daily_20140826[table_name]
print("日线行情-时间为序  daily_20140826 返回数据 row 行数 = "+str(daily_20140826.shape[0]))
daily_20140826_addname_dataframe.to_excel(daily_201408_excel_writer,'26_2',index=False)
daily_201408_excel_writer.save()
daily_20140827 = pro.daily(start_date='',end_date='',trade_date='20140827', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20140827_tscode_list = list() 
for ts_code_sh in daily_20140827['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20140827_tscode_list.append(stock_name)
daily_20140827_addname_dataframe=pd.DataFrame()
daily_20140827_addname_dataframe['cname'] = daily_20140827_tscode_list
for table_name in daily_20140827.columns.values.tolist():
    daily_20140827_addname_dataframe[table_name] = daily_20140827[table_name]
print("日线行情-时间为序  daily_20140827 返回数据 row 行数 = "+str(daily_20140827.shape[0]))
daily_20140827_addname_dataframe.to_excel(daily_201408_excel_writer,'27_3',index=False)
daily_201408_excel_writer.save()
daily_20140828 = pro.daily(start_date='',end_date='',trade_date='20140828', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20140828_tscode_list = list() 
for ts_code_sh in daily_20140828['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20140828_tscode_list.append(stock_name)
daily_20140828_addname_dataframe=pd.DataFrame()
daily_20140828_addname_dataframe['cname'] = daily_20140828_tscode_list
for table_name in daily_20140828.columns.values.tolist():
    daily_20140828_addname_dataframe[table_name] = daily_20140828[table_name]
print("日线行情-时间为序  daily_20140828 返回数据 row 行数 = "+str(daily_20140828.shape[0]))
daily_20140828_addname_dataframe.to_excel(daily_201408_excel_writer,'28_4',index=False)
daily_201408_excel_writer.save()
daily_20140829 = pro.daily(start_date='',end_date='',trade_date='20140829', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20140829_tscode_list = list() 
for ts_code_sh in daily_20140829['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20140829_tscode_list.append(stock_name)
daily_20140829_addname_dataframe=pd.DataFrame()
daily_20140829_addname_dataframe['cname'] = daily_20140829_tscode_list
for table_name in daily_20140829.columns.values.tolist():
    daily_20140829_addname_dataframe[table_name] = daily_20140829[table_name]
print("日线行情-时间为序  daily_20140829 返回数据 row 行数 = "+str(daily_20140829.shape[0]))
daily_20140829_addname_dataframe.to_excel(daily_201408_excel_writer,'29_5',index=False)
daily_201408_excel_writer.save()




createexcel('daily_201409.xlsx')
daily_201409_book = load_workbook('C:\\Users\\zhuzj5\\Desktop\\zbin\\J0_Data\\daily_201409.xlsx')
daily_201409_excel_writer = pd.ExcelWriter('C:\\Users\\zhuzj5\\Desktop\\zbin\\J0_Data\\daily_201409.xlsx', engine='openpyxl')
daily_201409_excel_writer.book = daily_201409_book
daily_201409_excel_writer.sheets = dict((ws.title, ws) for ws in daily_201409_book.worksheets)
J0_PROPS.put(tree_node_name+"record_date", "20140901")       ###  更新 记录日期
daily_20140901 = pro.daily(start_date='',end_date='',trade_date='20140901', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20140901_tscode_list = list() 
for ts_code_sh in daily_20140901['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20140901_tscode_list.append(stock_name)
daily_20140901_addname_dataframe=pd.DataFrame()
daily_20140901_addname_dataframe['cname'] = daily_20140901_tscode_list
for table_name in daily_20140901.columns.values.tolist():
    daily_20140901_addname_dataframe[table_name] = daily_20140901[table_name]
print("日线行情-时间为序  daily_20140901 返回数据 row 行数 = "+str(daily_20140901.shape[0]))
daily_20140901_addname_dataframe.to_excel(daily_201409_excel_writer,'1_1',index=False)
daily_201409_excel_writer.save()
daily_20140902 = pro.daily(start_date='',end_date='',trade_date='20140902', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20140902_tscode_list = list() 
for ts_code_sh in daily_20140902['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20140902_tscode_list.append(stock_name)
daily_20140902_addname_dataframe=pd.DataFrame()
daily_20140902_addname_dataframe['cname'] = daily_20140902_tscode_list
for table_name in daily_20140902.columns.values.tolist():
    daily_20140902_addname_dataframe[table_name] = daily_20140902[table_name]
print("日线行情-时间为序  daily_20140902 返回数据 row 行数 = "+str(daily_20140902.shape[0]))
daily_20140902_addname_dataframe.to_excel(daily_201409_excel_writer,'2_2',index=False)
daily_201409_excel_writer.save()
daily_20140903 = pro.daily(start_date='',end_date='',trade_date='20140903', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20140903_tscode_list = list() 
for ts_code_sh in daily_20140903['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20140903_tscode_list.append(stock_name)
daily_20140903_addname_dataframe=pd.DataFrame()
daily_20140903_addname_dataframe['cname'] = daily_20140903_tscode_list
for table_name in daily_20140903.columns.values.tolist():
    daily_20140903_addname_dataframe[table_name] = daily_20140903[table_name]
print("日线行情-时间为序  daily_20140903 返回数据 row 行数 = "+str(daily_20140903.shape[0]))
daily_20140903_addname_dataframe.to_excel(daily_201409_excel_writer,'3_3',index=False)
daily_201409_excel_writer.save()
daily_20140904 = pro.daily(start_date='',end_date='',trade_date='20140904', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20140904_tscode_list = list() 
for ts_code_sh in daily_20140904['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20140904_tscode_list.append(stock_name)
daily_20140904_addname_dataframe=pd.DataFrame()
daily_20140904_addname_dataframe['cname'] = daily_20140904_tscode_list
for table_name in daily_20140904.columns.values.tolist():
    daily_20140904_addname_dataframe[table_name] = daily_20140904[table_name]
print("日线行情-时间为序  daily_20140904 返回数据 row 行数 = "+str(daily_20140904.shape[0]))
daily_20140904_addname_dataframe.to_excel(daily_201409_excel_writer,'4_4',index=False)
daily_201409_excel_writer.save()
daily_20140905 = pro.daily(start_date='',end_date='',trade_date='20140905', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20140905_tscode_list = list() 
for ts_code_sh in daily_20140905['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20140905_tscode_list.append(stock_name)
daily_20140905_addname_dataframe=pd.DataFrame()
daily_20140905_addname_dataframe['cname'] = daily_20140905_tscode_list
for table_name in daily_20140905.columns.values.tolist():
    daily_20140905_addname_dataframe[table_name] = daily_20140905[table_name]
print("日线行情-时间为序  daily_20140905 返回数据 row 行数 = "+str(daily_20140905.shape[0]))
daily_20140905_addname_dataframe.to_excel(daily_201409_excel_writer,'5_5',index=False)
daily_201409_excel_writer.save()
daily_20140909 = pro.daily(start_date='',end_date='',trade_date='20140909', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20140909_tscode_list = list() 
for ts_code_sh in daily_20140909['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20140909_tscode_list.append(stock_name)
daily_20140909_addname_dataframe=pd.DataFrame()
daily_20140909_addname_dataframe['cname'] = daily_20140909_tscode_list
for table_name in daily_20140909.columns.values.tolist():
    daily_20140909_addname_dataframe[table_name] = daily_20140909[table_name]
print("日线行情-时间为序  daily_20140909 返回数据 row 行数 = "+str(daily_20140909.shape[0]))
daily_20140909_addname_dataframe.to_excel(daily_201409_excel_writer,'9_2',index=False)
daily_201409_excel_writer.save()
daily_20140910 = pro.daily(start_date='',end_date='',trade_date='20140910', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20140910_tscode_list = list() 
for ts_code_sh in daily_20140910['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20140910_tscode_list.append(stock_name)
daily_20140910_addname_dataframe=pd.DataFrame()
daily_20140910_addname_dataframe['cname'] = daily_20140910_tscode_list
for table_name in daily_20140910.columns.values.tolist():
    daily_20140910_addname_dataframe[table_name] = daily_20140910[table_name]
print("日线行情-时间为序  daily_20140910 返回数据 row 行数 = "+str(daily_20140910.shape[0]))
daily_20140910_addname_dataframe.to_excel(daily_201409_excel_writer,'10_3',index=False)
daily_201409_excel_writer.save()
daily_20140911 = pro.daily(start_date='',end_date='',trade_date='20140911', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20140911_tscode_list = list() 
for ts_code_sh in daily_20140911['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20140911_tscode_list.append(stock_name)
daily_20140911_addname_dataframe=pd.DataFrame()
daily_20140911_addname_dataframe['cname'] = daily_20140911_tscode_list
for table_name in daily_20140911.columns.values.tolist():
    daily_20140911_addname_dataframe[table_name] = daily_20140911[table_name]
print("日线行情-时间为序  daily_20140911 返回数据 row 行数 = "+str(daily_20140911.shape[0]))
daily_20140911_addname_dataframe.to_excel(daily_201409_excel_writer,'11_4',index=False)
daily_201409_excel_writer.save()
daily_20140912 = pro.daily(start_date='',end_date='',trade_date='20140912', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20140912_tscode_list = list() 
for ts_code_sh in daily_20140912['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20140912_tscode_list.append(stock_name)
daily_20140912_addname_dataframe=pd.DataFrame()
daily_20140912_addname_dataframe['cname'] = daily_20140912_tscode_list
for table_name in daily_20140912.columns.values.tolist():
    daily_20140912_addname_dataframe[table_name] = daily_20140912[table_name]
print("日线行情-时间为序  daily_20140912 返回数据 row 行数 = "+str(daily_20140912.shape[0]))
daily_20140912_addname_dataframe.to_excel(daily_201409_excel_writer,'12_5',index=False)
daily_201409_excel_writer.save()
daily_20140915 = pro.daily(start_date='',end_date='',trade_date='20140915', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20140915_tscode_list = list() 
for ts_code_sh in daily_20140915['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20140915_tscode_list.append(stock_name)
daily_20140915_addname_dataframe=pd.DataFrame()
daily_20140915_addname_dataframe['cname'] = daily_20140915_tscode_list
for table_name in daily_20140915.columns.values.tolist():
    daily_20140915_addname_dataframe[table_name] = daily_20140915[table_name]
print("日线行情-时间为序  daily_20140915 返回数据 row 行数 = "+str(daily_20140915.shape[0]))
daily_20140915_addname_dataframe.to_excel(daily_201409_excel_writer,'15_1',index=False)
daily_201409_excel_writer.save()
daily_20140916 = pro.daily(start_date='',end_date='',trade_date='20140916', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20140916_tscode_list = list() 
for ts_code_sh in daily_20140916['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20140916_tscode_list.append(stock_name)
daily_20140916_addname_dataframe=pd.DataFrame()
daily_20140916_addname_dataframe['cname'] = daily_20140916_tscode_list
for table_name in daily_20140916.columns.values.tolist():
    daily_20140916_addname_dataframe[table_name] = daily_20140916[table_name]
print("日线行情-时间为序  daily_20140916 返回数据 row 行数 = "+str(daily_20140916.shape[0]))
daily_20140916_addname_dataframe.to_excel(daily_201409_excel_writer,'16_2',index=False)
daily_201409_excel_writer.save()
daily_20140917 = pro.daily(start_date='',end_date='',trade_date='20140917', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20140917_tscode_list = list() 
for ts_code_sh in daily_20140917['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20140917_tscode_list.append(stock_name)
daily_20140917_addname_dataframe=pd.DataFrame()
daily_20140917_addname_dataframe['cname'] = daily_20140917_tscode_list
for table_name in daily_20140917.columns.values.tolist():
    daily_20140917_addname_dataframe[table_name] = daily_20140917[table_name]
print("日线行情-时间为序  daily_20140917 返回数据 row 行数 = "+str(daily_20140917.shape[0]))
daily_20140917_addname_dataframe.to_excel(daily_201409_excel_writer,'17_3',index=False)
daily_201409_excel_writer.save()
daily_20140918 = pro.daily(start_date='',end_date='',trade_date='20140918', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20140918_tscode_list = list() 
for ts_code_sh in daily_20140918['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20140918_tscode_list.append(stock_name)
daily_20140918_addname_dataframe=pd.DataFrame()
daily_20140918_addname_dataframe['cname'] = daily_20140918_tscode_list
for table_name in daily_20140918.columns.values.tolist():
    daily_20140918_addname_dataframe[table_name] = daily_20140918[table_name]
print("日线行情-时间为序  daily_20140918 返回数据 row 行数 = "+str(daily_20140918.shape[0]))
daily_20140918_addname_dataframe.to_excel(daily_201409_excel_writer,'18_4',index=False)
daily_201409_excel_writer.save()
daily_20140919 = pro.daily(start_date='',end_date='',trade_date='20140919', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20140919_tscode_list = list() 
for ts_code_sh in daily_20140919['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20140919_tscode_list.append(stock_name)
daily_20140919_addname_dataframe=pd.DataFrame()
daily_20140919_addname_dataframe['cname'] = daily_20140919_tscode_list
for table_name in daily_20140919.columns.values.tolist():
    daily_20140919_addname_dataframe[table_name] = daily_20140919[table_name]
print("日线行情-时间为序  daily_20140919 返回数据 row 行数 = "+str(daily_20140919.shape[0]))
daily_20140919_addname_dataframe.to_excel(daily_201409_excel_writer,'19_5',index=False)
daily_201409_excel_writer.save()
daily_20140922 = pro.daily(start_date='',end_date='',trade_date='20140922', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20140922_tscode_list = list() 
for ts_code_sh in daily_20140922['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20140922_tscode_list.append(stock_name)
daily_20140922_addname_dataframe=pd.DataFrame()
daily_20140922_addname_dataframe['cname'] = daily_20140922_tscode_list
for table_name in daily_20140922.columns.values.tolist():
    daily_20140922_addname_dataframe[table_name] = daily_20140922[table_name]
print("日线行情-时间为序  daily_20140922 返回数据 row 行数 = "+str(daily_20140922.shape[0]))
daily_20140922_addname_dataframe.to_excel(daily_201409_excel_writer,'22_1',index=False)
daily_201409_excel_writer.save()
daily_20140923 = pro.daily(start_date='',end_date='',trade_date='20140923', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20140923_tscode_list = list() 
for ts_code_sh in daily_20140923['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20140923_tscode_list.append(stock_name)
daily_20140923_addname_dataframe=pd.DataFrame()
daily_20140923_addname_dataframe['cname'] = daily_20140923_tscode_list
for table_name in daily_20140923.columns.values.tolist():
    daily_20140923_addname_dataframe[table_name] = daily_20140923[table_name]
print("日线行情-时间为序  daily_20140923 返回数据 row 行数 = "+str(daily_20140923.shape[0]))
daily_20140923_addname_dataframe.to_excel(daily_201409_excel_writer,'23_2',index=False)
daily_201409_excel_writer.save()
daily_20140924 = pro.daily(start_date='',end_date='',trade_date='20140924', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20140924_tscode_list = list() 
for ts_code_sh in daily_20140924['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20140924_tscode_list.append(stock_name)
daily_20140924_addname_dataframe=pd.DataFrame()
daily_20140924_addname_dataframe['cname'] = daily_20140924_tscode_list
for table_name in daily_20140924.columns.values.tolist():
    daily_20140924_addname_dataframe[table_name] = daily_20140924[table_name]
print("日线行情-时间为序  daily_20140924 返回数据 row 行数 = "+str(daily_20140924.shape[0]))
daily_20140924_addname_dataframe.to_excel(daily_201409_excel_writer,'24_3',index=False)
daily_201409_excel_writer.save()
daily_20140925 = pro.daily(start_date='',end_date='',trade_date='20140925', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20140925_tscode_list = list() 
for ts_code_sh in daily_20140925['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20140925_tscode_list.append(stock_name)
daily_20140925_addname_dataframe=pd.DataFrame()
daily_20140925_addname_dataframe['cname'] = daily_20140925_tscode_list
for table_name in daily_20140925.columns.values.tolist():
    daily_20140925_addname_dataframe[table_name] = daily_20140925[table_name]
print("日线行情-时间为序  daily_20140925 返回数据 row 行数 = "+str(daily_20140925.shape[0]))
daily_20140925_addname_dataframe.to_excel(daily_201409_excel_writer,'25_4',index=False)
daily_201409_excel_writer.save()
daily_20140926 = pro.daily(start_date='',end_date='',trade_date='20140926', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20140926_tscode_list = list() 
for ts_code_sh in daily_20140926['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20140926_tscode_list.append(stock_name)
daily_20140926_addname_dataframe=pd.DataFrame()
daily_20140926_addname_dataframe['cname'] = daily_20140926_tscode_list
for table_name in daily_20140926.columns.values.tolist():
    daily_20140926_addname_dataframe[table_name] = daily_20140926[table_name]
print("日线行情-时间为序  daily_20140926 返回数据 row 行数 = "+str(daily_20140926.shape[0]))
daily_20140926_addname_dataframe.to_excel(daily_201409_excel_writer,'26_5',index=False)
daily_201409_excel_writer.save()
daily_20140929 = pro.daily(start_date='',end_date='',trade_date='20140929', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20140929_tscode_list = list() 
for ts_code_sh in daily_20140929['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20140929_tscode_list.append(stock_name)
daily_20140929_addname_dataframe=pd.DataFrame()
daily_20140929_addname_dataframe['cname'] = daily_20140929_tscode_list
for table_name in daily_20140929.columns.values.tolist():
    daily_20140929_addname_dataframe[table_name] = daily_20140929[table_name]
print("日线行情-时间为序  daily_20140929 返回数据 row 行数 = "+str(daily_20140929.shape[0]))
daily_20140929_addname_dataframe.to_excel(daily_201409_excel_writer,'29_1',index=False)
daily_201409_excel_writer.save()
daily_20140930 = pro.daily(start_date='',end_date='',trade_date='20140930', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20140930_tscode_list = list() 
for ts_code_sh in daily_20140930['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20140930_tscode_list.append(stock_name)
daily_20140930_addname_dataframe=pd.DataFrame()
daily_20140930_addname_dataframe['cname'] = daily_20140930_tscode_list
for table_name in daily_20140930.columns.values.tolist():
    daily_20140930_addname_dataframe[table_name] = daily_20140930[table_name]
print("日线行情-时间为序  daily_20140930 返回数据 row 行数 = "+str(daily_20140930.shape[0]))
daily_20140930_addname_dataframe.to_excel(daily_201409_excel_writer,'30_2',index=False)
daily_201409_excel_writer.save()




createexcel('daily_201410.xlsx')
daily_201410_book = load_workbook('C:\\Users\\zhuzj5\\Desktop\\zbin\\J0_Data\\daily_201410.xlsx')
daily_201410_excel_writer = pd.ExcelWriter('C:\\Users\\zhuzj5\\Desktop\\zbin\\J0_Data\\daily_201410.xlsx', engine='openpyxl')
daily_201410_excel_writer.book = daily_201410_book
daily_201410_excel_writer.sheets = dict((ws.title, ws) for ws in daily_201410_book.worksheets)
J0_PROPS.put(tree_node_name+"record_date", "20141001")       ###  更新 记录日期
daily_20141008 = pro.daily(start_date='',end_date='',trade_date='20141008', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20141008_tscode_list = list() 
for ts_code_sh in daily_20141008['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20141008_tscode_list.append(stock_name)
daily_20141008_addname_dataframe=pd.DataFrame()
daily_20141008_addname_dataframe['cname'] = daily_20141008_tscode_list
for table_name in daily_20141008.columns.values.tolist():
    daily_20141008_addname_dataframe[table_name] = daily_20141008[table_name]
print("日线行情-时间为序  daily_20141008 返回数据 row 行数 = "+str(daily_20141008.shape[0]))
daily_20141008_addname_dataframe.to_excel(daily_201410_excel_writer,'8_3',index=False)
daily_201410_excel_writer.save()
daily_20141009 = pro.daily(start_date='',end_date='',trade_date='20141009', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20141009_tscode_list = list() 
for ts_code_sh in daily_20141009['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20141009_tscode_list.append(stock_name)
daily_20141009_addname_dataframe=pd.DataFrame()
daily_20141009_addname_dataframe['cname'] = daily_20141009_tscode_list
for table_name in daily_20141009.columns.values.tolist():
    daily_20141009_addname_dataframe[table_name] = daily_20141009[table_name]
print("日线行情-时间为序  daily_20141009 返回数据 row 行数 = "+str(daily_20141009.shape[0]))
daily_20141009_addname_dataframe.to_excel(daily_201410_excel_writer,'9_4',index=False)
daily_201410_excel_writer.save()
daily_20141010 = pro.daily(start_date='',end_date='',trade_date='20141010', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20141010_tscode_list = list() 
for ts_code_sh in daily_20141010['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20141010_tscode_list.append(stock_name)
daily_20141010_addname_dataframe=pd.DataFrame()
daily_20141010_addname_dataframe['cname'] = daily_20141010_tscode_list
for table_name in daily_20141010.columns.values.tolist():
    daily_20141010_addname_dataframe[table_name] = daily_20141010[table_name]
print("日线行情-时间为序  daily_20141010 返回数据 row 行数 = "+str(daily_20141010.shape[0]))
daily_20141010_addname_dataframe.to_excel(daily_201410_excel_writer,'10_5',index=False)
daily_201410_excel_writer.save()
daily_20141013 = pro.daily(start_date='',end_date='',trade_date='20141013', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20141013_tscode_list = list() 
for ts_code_sh in daily_20141013['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20141013_tscode_list.append(stock_name)
daily_20141013_addname_dataframe=pd.DataFrame()
daily_20141013_addname_dataframe['cname'] = daily_20141013_tscode_list
for table_name in daily_20141013.columns.values.tolist():
    daily_20141013_addname_dataframe[table_name] = daily_20141013[table_name]
print("日线行情-时间为序  daily_20141013 返回数据 row 行数 = "+str(daily_20141013.shape[0]))
daily_20141013_addname_dataframe.to_excel(daily_201410_excel_writer,'13_1',index=False)
daily_201410_excel_writer.save()
daily_20141014 = pro.daily(start_date='',end_date='',trade_date='20141014', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20141014_tscode_list = list() 
for ts_code_sh in daily_20141014['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20141014_tscode_list.append(stock_name)
daily_20141014_addname_dataframe=pd.DataFrame()
daily_20141014_addname_dataframe['cname'] = daily_20141014_tscode_list
for table_name in daily_20141014.columns.values.tolist():
    daily_20141014_addname_dataframe[table_name] = daily_20141014[table_name]
print("日线行情-时间为序  daily_20141014 返回数据 row 行数 = "+str(daily_20141014.shape[0]))
daily_20141014_addname_dataframe.to_excel(daily_201410_excel_writer,'14_2',index=False)
daily_201410_excel_writer.save()
daily_20141015 = pro.daily(start_date='',end_date='',trade_date='20141015', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20141015_tscode_list = list() 
for ts_code_sh in daily_20141015['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20141015_tscode_list.append(stock_name)
daily_20141015_addname_dataframe=pd.DataFrame()
daily_20141015_addname_dataframe['cname'] = daily_20141015_tscode_list
for table_name in daily_20141015.columns.values.tolist():
    daily_20141015_addname_dataframe[table_name] = daily_20141015[table_name]
print("日线行情-时间为序  daily_20141015 返回数据 row 行数 = "+str(daily_20141015.shape[0]))
daily_20141015_addname_dataframe.to_excel(daily_201410_excel_writer,'15_3',index=False)
daily_201410_excel_writer.save()
daily_20141016 = pro.daily(start_date='',end_date='',trade_date='20141016', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20141016_tscode_list = list() 
for ts_code_sh in daily_20141016['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20141016_tscode_list.append(stock_name)
daily_20141016_addname_dataframe=pd.DataFrame()
daily_20141016_addname_dataframe['cname'] = daily_20141016_tscode_list
for table_name in daily_20141016.columns.values.tolist():
    daily_20141016_addname_dataframe[table_name] = daily_20141016[table_name]
print("日线行情-时间为序  daily_20141016 返回数据 row 行数 = "+str(daily_20141016.shape[0]))
daily_20141016_addname_dataframe.to_excel(daily_201410_excel_writer,'16_4',index=False)
daily_201410_excel_writer.save()
daily_20141017 = pro.daily(start_date='',end_date='',trade_date='20141017', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20141017_tscode_list = list() 
for ts_code_sh in daily_20141017['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20141017_tscode_list.append(stock_name)
daily_20141017_addname_dataframe=pd.DataFrame()
daily_20141017_addname_dataframe['cname'] = daily_20141017_tscode_list
for table_name in daily_20141017.columns.values.tolist():
    daily_20141017_addname_dataframe[table_name] = daily_20141017[table_name]
print("日线行情-时间为序  daily_20141017 返回数据 row 行数 = "+str(daily_20141017.shape[0]))
daily_20141017_addname_dataframe.to_excel(daily_201410_excel_writer,'17_5',index=False)
daily_201410_excel_writer.save()
daily_20141020 = pro.daily(start_date='',end_date='',trade_date='20141020', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20141020_tscode_list = list() 
for ts_code_sh in daily_20141020['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20141020_tscode_list.append(stock_name)
daily_20141020_addname_dataframe=pd.DataFrame()
daily_20141020_addname_dataframe['cname'] = daily_20141020_tscode_list
for table_name in daily_20141020.columns.values.tolist():
    daily_20141020_addname_dataframe[table_name] = daily_20141020[table_name]
print("日线行情-时间为序  daily_20141020 返回数据 row 行数 = "+str(daily_20141020.shape[0]))
daily_20141020_addname_dataframe.to_excel(daily_201410_excel_writer,'20_1',index=False)
daily_201410_excel_writer.save()
daily_20141021 = pro.daily(start_date='',end_date='',trade_date='20141021', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20141021_tscode_list = list() 
for ts_code_sh in daily_20141021['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20141021_tscode_list.append(stock_name)
daily_20141021_addname_dataframe=pd.DataFrame()
daily_20141021_addname_dataframe['cname'] = daily_20141021_tscode_list
for table_name in daily_20141021.columns.values.tolist():
    daily_20141021_addname_dataframe[table_name] = daily_20141021[table_name]
print("日线行情-时间为序  daily_20141021 返回数据 row 行数 = "+str(daily_20141021.shape[0]))
daily_20141021_addname_dataframe.to_excel(daily_201410_excel_writer,'21_2',index=False)
daily_201410_excel_writer.save()
daily_20141022 = pro.daily(start_date='',end_date='',trade_date='20141022', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20141022_tscode_list = list() 
for ts_code_sh in daily_20141022['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20141022_tscode_list.append(stock_name)
daily_20141022_addname_dataframe=pd.DataFrame()
daily_20141022_addname_dataframe['cname'] = daily_20141022_tscode_list
for table_name in daily_20141022.columns.values.tolist():
    daily_20141022_addname_dataframe[table_name] = daily_20141022[table_name]
print("日线行情-时间为序  daily_20141022 返回数据 row 行数 = "+str(daily_20141022.shape[0]))
daily_20141022_addname_dataframe.to_excel(daily_201410_excel_writer,'22_3',index=False)
daily_201410_excel_writer.save()
daily_20141023 = pro.daily(start_date='',end_date='',trade_date='20141023', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20141023_tscode_list = list() 
for ts_code_sh in daily_20141023['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20141023_tscode_list.append(stock_name)
daily_20141023_addname_dataframe=pd.DataFrame()
daily_20141023_addname_dataframe['cname'] = daily_20141023_tscode_list
for table_name in daily_20141023.columns.values.tolist():
    daily_20141023_addname_dataframe[table_name] = daily_20141023[table_name]
print("日线行情-时间为序  daily_20141023 返回数据 row 行数 = "+str(daily_20141023.shape[0]))
daily_20141023_addname_dataframe.to_excel(daily_201410_excel_writer,'23_4',index=False)
daily_201410_excel_writer.save()
daily_20141024 = pro.daily(start_date='',end_date='',trade_date='20141024', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20141024_tscode_list = list() 
for ts_code_sh in daily_20141024['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20141024_tscode_list.append(stock_name)
daily_20141024_addname_dataframe=pd.DataFrame()
daily_20141024_addname_dataframe['cname'] = daily_20141024_tscode_list
for table_name in daily_20141024.columns.values.tolist():
    daily_20141024_addname_dataframe[table_name] = daily_20141024[table_name]
print("日线行情-时间为序  daily_20141024 返回数据 row 行数 = "+str(daily_20141024.shape[0]))
daily_20141024_addname_dataframe.to_excel(daily_201410_excel_writer,'24_5',index=False)
daily_201410_excel_writer.save()
daily_20141027 = pro.daily(start_date='',end_date='',trade_date='20141027', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20141027_tscode_list = list() 
for ts_code_sh in daily_20141027['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20141027_tscode_list.append(stock_name)
daily_20141027_addname_dataframe=pd.DataFrame()
daily_20141027_addname_dataframe['cname'] = daily_20141027_tscode_list
for table_name in daily_20141027.columns.values.tolist():
    daily_20141027_addname_dataframe[table_name] = daily_20141027[table_name]
print("日线行情-时间为序  daily_20141027 返回数据 row 行数 = "+str(daily_20141027.shape[0]))
daily_20141027_addname_dataframe.to_excel(daily_201410_excel_writer,'27_1',index=False)
daily_201410_excel_writer.save()
daily_20141028 = pro.daily(start_date='',end_date='',trade_date='20141028', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20141028_tscode_list = list() 
for ts_code_sh in daily_20141028['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20141028_tscode_list.append(stock_name)
daily_20141028_addname_dataframe=pd.DataFrame()
daily_20141028_addname_dataframe['cname'] = daily_20141028_tscode_list
for table_name in daily_20141028.columns.values.tolist():
    daily_20141028_addname_dataframe[table_name] = daily_20141028[table_name]
print("日线行情-时间为序  daily_20141028 返回数据 row 行数 = "+str(daily_20141028.shape[0]))
daily_20141028_addname_dataframe.to_excel(daily_201410_excel_writer,'28_2',index=False)
daily_201410_excel_writer.save()
daily_20141029 = pro.daily(start_date='',end_date='',trade_date='20141029', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20141029_tscode_list = list() 
for ts_code_sh in daily_20141029['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20141029_tscode_list.append(stock_name)
daily_20141029_addname_dataframe=pd.DataFrame()
daily_20141029_addname_dataframe['cname'] = daily_20141029_tscode_list
for table_name in daily_20141029.columns.values.tolist():
    daily_20141029_addname_dataframe[table_name] = daily_20141029[table_name]
print("日线行情-时间为序  daily_20141029 返回数据 row 行数 = "+str(daily_20141029.shape[0]))
daily_20141029_addname_dataframe.to_excel(daily_201410_excel_writer,'29_3',index=False)
daily_201410_excel_writer.save()
daily_20141030 = pro.daily(start_date='',end_date='',trade_date='20141030', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20141030_tscode_list = list() 
for ts_code_sh in daily_20141030['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20141030_tscode_list.append(stock_name)
daily_20141030_addname_dataframe=pd.DataFrame()
daily_20141030_addname_dataframe['cname'] = daily_20141030_tscode_list
for table_name in daily_20141030.columns.values.tolist():
    daily_20141030_addname_dataframe[table_name] = daily_20141030[table_name]
print("日线行情-时间为序  daily_20141030 返回数据 row 行数 = "+str(daily_20141030.shape[0]))
daily_20141030_addname_dataframe.to_excel(daily_201410_excel_writer,'30_4',index=False)
daily_201410_excel_writer.save()
daily_20141031 = pro.daily(start_date='',end_date='',trade_date='20141031', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20141031_tscode_list = list() 
for ts_code_sh in daily_20141031['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20141031_tscode_list.append(stock_name)
daily_20141031_addname_dataframe=pd.DataFrame()
daily_20141031_addname_dataframe['cname'] = daily_20141031_tscode_list
for table_name in daily_20141031.columns.values.tolist():
    daily_20141031_addname_dataframe[table_name] = daily_20141031[table_name]
print("日线行情-时间为序  daily_20141031 返回数据 row 行数 = "+str(daily_20141031.shape[0]))
daily_20141031_addname_dataframe.to_excel(daily_201410_excel_writer,'31_5',index=False)
daily_201410_excel_writer.save()




createexcel('daily_201411.xlsx')
daily_201411_book = load_workbook('C:\\Users\\zhuzj5\\Desktop\\zbin\\J0_Data\\daily_201411.xlsx')
daily_201411_excel_writer = pd.ExcelWriter('C:\\Users\\zhuzj5\\Desktop\\zbin\\J0_Data\\daily_201411.xlsx', engine='openpyxl')
daily_201411_excel_writer.book = daily_201411_book
daily_201411_excel_writer.sheets = dict((ws.title, ws) for ws in daily_201411_book.worksheets)
J0_PROPS.put(tree_node_name+"record_date", "20141101")       ###  更新 记录日期
daily_20141103 = pro.daily(start_date='',end_date='',trade_date='20141103', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20141103_tscode_list = list() 
for ts_code_sh in daily_20141103['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20141103_tscode_list.append(stock_name)
daily_20141103_addname_dataframe=pd.DataFrame()
daily_20141103_addname_dataframe['cname'] = daily_20141103_tscode_list
for table_name in daily_20141103.columns.values.tolist():
    daily_20141103_addname_dataframe[table_name] = daily_20141103[table_name]
print("日线行情-时间为序  daily_20141103 返回数据 row 行数 = "+str(daily_20141103.shape[0]))
daily_20141103_addname_dataframe.to_excel(daily_201411_excel_writer,'3_1',index=False)
daily_201411_excel_writer.save()
daily_20141104 = pro.daily(start_date='',end_date='',trade_date='20141104', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20141104_tscode_list = list() 
for ts_code_sh in daily_20141104['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20141104_tscode_list.append(stock_name)
daily_20141104_addname_dataframe=pd.DataFrame()
daily_20141104_addname_dataframe['cname'] = daily_20141104_tscode_list
for table_name in daily_20141104.columns.values.tolist():
    daily_20141104_addname_dataframe[table_name] = daily_20141104[table_name]
print("日线行情-时间为序  daily_20141104 返回数据 row 行数 = "+str(daily_20141104.shape[0]))
daily_20141104_addname_dataframe.to_excel(daily_201411_excel_writer,'4_2',index=False)
daily_201411_excel_writer.save()
daily_20141105 = pro.daily(start_date='',end_date='',trade_date='20141105', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20141105_tscode_list = list() 
for ts_code_sh in daily_20141105['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20141105_tscode_list.append(stock_name)
daily_20141105_addname_dataframe=pd.DataFrame()
daily_20141105_addname_dataframe['cname'] = daily_20141105_tscode_list
for table_name in daily_20141105.columns.values.tolist():
    daily_20141105_addname_dataframe[table_name] = daily_20141105[table_name]
print("日线行情-时间为序  daily_20141105 返回数据 row 行数 = "+str(daily_20141105.shape[0]))
daily_20141105_addname_dataframe.to_excel(daily_201411_excel_writer,'5_3',index=False)
daily_201411_excel_writer.save()
daily_20141106 = pro.daily(start_date='',end_date='',trade_date='20141106', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20141106_tscode_list = list() 
for ts_code_sh in daily_20141106['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20141106_tscode_list.append(stock_name)
daily_20141106_addname_dataframe=pd.DataFrame()
daily_20141106_addname_dataframe['cname'] = daily_20141106_tscode_list
for table_name in daily_20141106.columns.values.tolist():
    daily_20141106_addname_dataframe[table_name] = daily_20141106[table_name]
print("日线行情-时间为序  daily_20141106 返回数据 row 行数 = "+str(daily_20141106.shape[0]))
daily_20141106_addname_dataframe.to_excel(daily_201411_excel_writer,'6_4',index=False)
daily_201411_excel_writer.save()
daily_20141107 = pro.daily(start_date='',end_date='',trade_date='20141107', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20141107_tscode_list = list() 
for ts_code_sh in daily_20141107['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20141107_tscode_list.append(stock_name)
daily_20141107_addname_dataframe=pd.DataFrame()
daily_20141107_addname_dataframe['cname'] = daily_20141107_tscode_list
for table_name in daily_20141107.columns.values.tolist():
    daily_20141107_addname_dataframe[table_name] = daily_20141107[table_name]
print("日线行情-时间为序  daily_20141107 返回数据 row 行数 = "+str(daily_20141107.shape[0]))
daily_20141107_addname_dataframe.to_excel(daily_201411_excel_writer,'7_5',index=False)
daily_201411_excel_writer.save()
daily_20141110 = pro.daily(start_date='',end_date='',trade_date='20141110', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20141110_tscode_list = list() 
for ts_code_sh in daily_20141110['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20141110_tscode_list.append(stock_name)
daily_20141110_addname_dataframe=pd.DataFrame()
daily_20141110_addname_dataframe['cname'] = daily_20141110_tscode_list
for table_name in daily_20141110.columns.values.tolist():
    daily_20141110_addname_dataframe[table_name] = daily_20141110[table_name]
print("日线行情-时间为序  daily_20141110 返回数据 row 行数 = "+str(daily_20141110.shape[0]))
daily_20141110_addname_dataframe.to_excel(daily_201411_excel_writer,'10_1',index=False)
daily_201411_excel_writer.save()
daily_20141111 = pro.daily(start_date='',end_date='',trade_date='20141111', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20141111_tscode_list = list() 
for ts_code_sh in daily_20141111['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20141111_tscode_list.append(stock_name)
daily_20141111_addname_dataframe=pd.DataFrame()
daily_20141111_addname_dataframe['cname'] = daily_20141111_tscode_list
for table_name in daily_20141111.columns.values.tolist():
    daily_20141111_addname_dataframe[table_name] = daily_20141111[table_name]
print("日线行情-时间为序  daily_20141111 返回数据 row 行数 = "+str(daily_20141111.shape[0]))
daily_20141111_addname_dataframe.to_excel(daily_201411_excel_writer,'11_2',index=False)
daily_201411_excel_writer.save()
daily_20141112 = pro.daily(start_date='',end_date='',trade_date='20141112', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20141112_tscode_list = list() 
for ts_code_sh in daily_20141112['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20141112_tscode_list.append(stock_name)
daily_20141112_addname_dataframe=pd.DataFrame()
daily_20141112_addname_dataframe['cname'] = daily_20141112_tscode_list
for table_name in daily_20141112.columns.values.tolist():
    daily_20141112_addname_dataframe[table_name] = daily_20141112[table_name]
print("日线行情-时间为序  daily_20141112 返回数据 row 行数 = "+str(daily_20141112.shape[0]))
daily_20141112_addname_dataframe.to_excel(daily_201411_excel_writer,'12_3',index=False)
daily_201411_excel_writer.save()
daily_20141113 = pro.daily(start_date='',end_date='',trade_date='20141113', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20141113_tscode_list = list() 
for ts_code_sh in daily_20141113['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20141113_tscode_list.append(stock_name)
daily_20141113_addname_dataframe=pd.DataFrame()
daily_20141113_addname_dataframe['cname'] = daily_20141113_tscode_list
for table_name in daily_20141113.columns.values.tolist():
    daily_20141113_addname_dataframe[table_name] = daily_20141113[table_name]
print("日线行情-时间为序  daily_20141113 返回数据 row 行数 = "+str(daily_20141113.shape[0]))
daily_20141113_addname_dataframe.to_excel(daily_201411_excel_writer,'13_4',index=False)
daily_201411_excel_writer.save()
daily_20141114 = pro.daily(start_date='',end_date='',trade_date='20141114', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20141114_tscode_list = list() 
for ts_code_sh in daily_20141114['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20141114_tscode_list.append(stock_name)
daily_20141114_addname_dataframe=pd.DataFrame()
daily_20141114_addname_dataframe['cname'] = daily_20141114_tscode_list
for table_name in daily_20141114.columns.values.tolist():
    daily_20141114_addname_dataframe[table_name] = daily_20141114[table_name]
print("日线行情-时间为序  daily_20141114 返回数据 row 行数 = "+str(daily_20141114.shape[0]))
daily_20141114_addname_dataframe.to_excel(daily_201411_excel_writer,'14_5',index=False)
daily_201411_excel_writer.save()
daily_20141117 = pro.daily(start_date='',end_date='',trade_date='20141117', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20141117_tscode_list = list() 
for ts_code_sh in daily_20141117['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20141117_tscode_list.append(stock_name)
daily_20141117_addname_dataframe=pd.DataFrame()
daily_20141117_addname_dataframe['cname'] = daily_20141117_tscode_list
for table_name in daily_20141117.columns.values.tolist():
    daily_20141117_addname_dataframe[table_name] = daily_20141117[table_name]
print("日线行情-时间为序  daily_20141117 返回数据 row 行数 = "+str(daily_20141117.shape[0]))
daily_20141117_addname_dataframe.to_excel(daily_201411_excel_writer,'17_1',index=False)
daily_201411_excel_writer.save()
daily_20141118 = pro.daily(start_date='',end_date='',trade_date='20141118', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20141118_tscode_list = list() 
for ts_code_sh in daily_20141118['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20141118_tscode_list.append(stock_name)
daily_20141118_addname_dataframe=pd.DataFrame()
daily_20141118_addname_dataframe['cname'] = daily_20141118_tscode_list
for table_name in daily_20141118.columns.values.tolist():
    daily_20141118_addname_dataframe[table_name] = daily_20141118[table_name]
print("日线行情-时间为序  daily_20141118 返回数据 row 行数 = "+str(daily_20141118.shape[0]))
daily_20141118_addname_dataframe.to_excel(daily_201411_excel_writer,'18_2',index=False)
daily_201411_excel_writer.save()
daily_20141119 = pro.daily(start_date='',end_date='',trade_date='20141119', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20141119_tscode_list = list() 
for ts_code_sh in daily_20141119['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20141119_tscode_list.append(stock_name)
daily_20141119_addname_dataframe=pd.DataFrame()
daily_20141119_addname_dataframe['cname'] = daily_20141119_tscode_list
for table_name in daily_20141119.columns.values.tolist():
    daily_20141119_addname_dataframe[table_name] = daily_20141119[table_name]
print("日线行情-时间为序  daily_20141119 返回数据 row 行数 = "+str(daily_20141119.shape[0]))
daily_20141119_addname_dataframe.to_excel(daily_201411_excel_writer,'19_3',index=False)
daily_201411_excel_writer.save()
daily_20141120 = pro.daily(start_date='',end_date='',trade_date='20141120', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20141120_tscode_list = list() 
for ts_code_sh in daily_20141120['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20141120_tscode_list.append(stock_name)
daily_20141120_addname_dataframe=pd.DataFrame()
daily_20141120_addname_dataframe['cname'] = daily_20141120_tscode_list
for table_name in daily_20141120.columns.values.tolist():
    daily_20141120_addname_dataframe[table_name] = daily_20141120[table_name]
print("日线行情-时间为序  daily_20141120 返回数据 row 行数 = "+str(daily_20141120.shape[0]))
daily_20141120_addname_dataframe.to_excel(daily_201411_excel_writer,'20_4',index=False)
daily_201411_excel_writer.save()
daily_20141121 = pro.daily(start_date='',end_date='',trade_date='20141121', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20141121_tscode_list = list() 
for ts_code_sh in daily_20141121['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20141121_tscode_list.append(stock_name)
daily_20141121_addname_dataframe=pd.DataFrame()
daily_20141121_addname_dataframe['cname'] = daily_20141121_tscode_list
for table_name in daily_20141121.columns.values.tolist():
    daily_20141121_addname_dataframe[table_name] = daily_20141121[table_name]
print("日线行情-时间为序  daily_20141121 返回数据 row 行数 = "+str(daily_20141121.shape[0]))
daily_20141121_addname_dataframe.to_excel(daily_201411_excel_writer,'21_5',index=False)
daily_201411_excel_writer.save()
daily_20141124 = pro.daily(start_date='',end_date='',trade_date='20141124', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20141124_tscode_list = list() 
for ts_code_sh in daily_20141124['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20141124_tscode_list.append(stock_name)
daily_20141124_addname_dataframe=pd.DataFrame()
daily_20141124_addname_dataframe['cname'] = daily_20141124_tscode_list
for table_name in daily_20141124.columns.values.tolist():
    daily_20141124_addname_dataframe[table_name] = daily_20141124[table_name]
print("日线行情-时间为序  daily_20141124 返回数据 row 行数 = "+str(daily_20141124.shape[0]))
daily_20141124_addname_dataframe.to_excel(daily_201411_excel_writer,'24_1',index=False)
daily_201411_excel_writer.save()
daily_20141125 = pro.daily(start_date='',end_date='',trade_date='20141125', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20141125_tscode_list = list() 
for ts_code_sh in daily_20141125['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20141125_tscode_list.append(stock_name)
daily_20141125_addname_dataframe=pd.DataFrame()
daily_20141125_addname_dataframe['cname'] = daily_20141125_tscode_list
for table_name in daily_20141125.columns.values.tolist():
    daily_20141125_addname_dataframe[table_name] = daily_20141125[table_name]
print("日线行情-时间为序  daily_20141125 返回数据 row 行数 = "+str(daily_20141125.shape[0]))
daily_20141125_addname_dataframe.to_excel(daily_201411_excel_writer,'25_2',index=False)
daily_201411_excel_writer.save()
daily_20141126 = pro.daily(start_date='',end_date='',trade_date='20141126', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20141126_tscode_list = list() 
for ts_code_sh in daily_20141126['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20141126_tscode_list.append(stock_name)
daily_20141126_addname_dataframe=pd.DataFrame()
daily_20141126_addname_dataframe['cname'] = daily_20141126_tscode_list
for table_name in daily_20141126.columns.values.tolist():
    daily_20141126_addname_dataframe[table_name] = daily_20141126[table_name]
print("日线行情-时间为序  daily_20141126 返回数据 row 行数 = "+str(daily_20141126.shape[0]))
daily_20141126_addname_dataframe.to_excel(daily_201411_excel_writer,'26_3',index=False)
daily_201411_excel_writer.save()
daily_20141127 = pro.daily(start_date='',end_date='',trade_date='20141127', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20141127_tscode_list = list() 
for ts_code_sh in daily_20141127['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20141127_tscode_list.append(stock_name)
daily_20141127_addname_dataframe=pd.DataFrame()
daily_20141127_addname_dataframe['cname'] = daily_20141127_tscode_list
for table_name in daily_20141127.columns.values.tolist():
    daily_20141127_addname_dataframe[table_name] = daily_20141127[table_name]
print("日线行情-时间为序  daily_20141127 返回数据 row 行数 = "+str(daily_20141127.shape[0]))
daily_20141127_addname_dataframe.to_excel(daily_201411_excel_writer,'27_4',index=False)
daily_201411_excel_writer.save()
daily_20141128 = pro.daily(start_date='',end_date='',trade_date='20141128', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20141128_tscode_list = list() 
for ts_code_sh in daily_20141128['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20141128_tscode_list.append(stock_name)
daily_20141128_addname_dataframe=pd.DataFrame()
daily_20141128_addname_dataframe['cname'] = daily_20141128_tscode_list
for table_name in daily_20141128.columns.values.tolist():
    daily_20141128_addname_dataframe[table_name] = daily_20141128[table_name]
print("日线行情-时间为序  daily_20141128 返回数据 row 行数 = "+str(daily_20141128.shape[0]))
daily_20141128_addname_dataframe.to_excel(daily_201411_excel_writer,'28_5',index=False)
daily_201411_excel_writer.save()




createexcel('daily_201412.xlsx')
daily_201412_book = load_workbook('C:\\Users\\zhuzj5\\Desktop\\zbin\\J0_Data\\daily_201412.xlsx')
daily_201412_excel_writer = pd.ExcelWriter('C:\\Users\\zhuzj5\\Desktop\\zbin\\J0_Data\\daily_201412.xlsx', engine='openpyxl')
daily_201412_excel_writer.book = daily_201412_book
daily_201412_excel_writer.sheets = dict((ws.title, ws) for ws in daily_201412_book.worksheets)
J0_PROPS.put(tree_node_name+"record_date", "20141201")       ###  更新 记录日期
daily_20141201 = pro.daily(start_date='',end_date='',trade_date='20141201', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20141201_tscode_list = list() 
for ts_code_sh in daily_20141201['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20141201_tscode_list.append(stock_name)
daily_20141201_addname_dataframe=pd.DataFrame()
daily_20141201_addname_dataframe['cname'] = daily_20141201_tscode_list
for table_name in daily_20141201.columns.values.tolist():
    daily_20141201_addname_dataframe[table_name] = daily_20141201[table_name]
print("日线行情-时间为序  daily_20141201 返回数据 row 行数 = "+str(daily_20141201.shape[0]))
daily_20141201_addname_dataframe.to_excel(daily_201412_excel_writer,'1_1',index=False)
daily_201412_excel_writer.save()
daily_20141202 = pro.daily(start_date='',end_date='',trade_date='20141202', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20141202_tscode_list = list() 
for ts_code_sh in daily_20141202['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20141202_tscode_list.append(stock_name)
daily_20141202_addname_dataframe=pd.DataFrame()
daily_20141202_addname_dataframe['cname'] = daily_20141202_tscode_list
for table_name in daily_20141202.columns.values.tolist():
    daily_20141202_addname_dataframe[table_name] = daily_20141202[table_name]
print("日线行情-时间为序  daily_20141202 返回数据 row 行数 = "+str(daily_20141202.shape[0]))
daily_20141202_addname_dataframe.to_excel(daily_201412_excel_writer,'2_2',index=False)
daily_201412_excel_writer.save()
daily_20141203 = pro.daily(start_date='',end_date='',trade_date='20141203', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20141203_tscode_list = list() 
for ts_code_sh in daily_20141203['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20141203_tscode_list.append(stock_name)
daily_20141203_addname_dataframe=pd.DataFrame()
daily_20141203_addname_dataframe['cname'] = daily_20141203_tscode_list
for table_name in daily_20141203.columns.values.tolist():
    daily_20141203_addname_dataframe[table_name] = daily_20141203[table_name]
print("日线行情-时间为序  daily_20141203 返回数据 row 行数 = "+str(daily_20141203.shape[0]))
daily_20141203_addname_dataframe.to_excel(daily_201412_excel_writer,'3_3',index=False)
daily_201412_excel_writer.save()
daily_20141204 = pro.daily(start_date='',end_date='',trade_date='20141204', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20141204_tscode_list = list() 
for ts_code_sh in daily_20141204['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20141204_tscode_list.append(stock_name)
daily_20141204_addname_dataframe=pd.DataFrame()
daily_20141204_addname_dataframe['cname'] = daily_20141204_tscode_list
for table_name in daily_20141204.columns.values.tolist():
    daily_20141204_addname_dataframe[table_name] = daily_20141204[table_name]
print("日线行情-时间为序  daily_20141204 返回数据 row 行数 = "+str(daily_20141204.shape[0]))
daily_20141204_addname_dataframe.to_excel(daily_201412_excel_writer,'4_4',index=False)
daily_201412_excel_writer.save()
daily_20141205 = pro.daily(start_date='',end_date='',trade_date='20141205', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20141205_tscode_list = list() 
for ts_code_sh in daily_20141205['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20141205_tscode_list.append(stock_name)
daily_20141205_addname_dataframe=pd.DataFrame()
daily_20141205_addname_dataframe['cname'] = daily_20141205_tscode_list
for table_name in daily_20141205.columns.values.tolist():
    daily_20141205_addname_dataframe[table_name] = daily_20141205[table_name]
print("日线行情-时间为序  daily_20141205 返回数据 row 行数 = "+str(daily_20141205.shape[0]))
daily_20141205_addname_dataframe.to_excel(daily_201412_excel_writer,'5_5',index=False)
daily_201412_excel_writer.save()
daily_20141208 = pro.daily(start_date='',end_date='',trade_date='20141208', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20141208_tscode_list = list() 
for ts_code_sh in daily_20141208['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20141208_tscode_list.append(stock_name)
daily_20141208_addname_dataframe=pd.DataFrame()
daily_20141208_addname_dataframe['cname'] = daily_20141208_tscode_list
for table_name in daily_20141208.columns.values.tolist():
    daily_20141208_addname_dataframe[table_name] = daily_20141208[table_name]
print("日线行情-时间为序  daily_20141208 返回数据 row 行数 = "+str(daily_20141208.shape[0]))
daily_20141208_addname_dataframe.to_excel(daily_201412_excel_writer,'8_1',index=False)
daily_201412_excel_writer.save()
daily_20141209 = pro.daily(start_date='',end_date='',trade_date='20141209', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20141209_tscode_list = list() 
for ts_code_sh in daily_20141209['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20141209_tscode_list.append(stock_name)
daily_20141209_addname_dataframe=pd.DataFrame()
daily_20141209_addname_dataframe['cname'] = daily_20141209_tscode_list
for table_name in daily_20141209.columns.values.tolist():
    daily_20141209_addname_dataframe[table_name] = daily_20141209[table_name]
print("日线行情-时间为序  daily_20141209 返回数据 row 行数 = "+str(daily_20141209.shape[0]))
daily_20141209_addname_dataframe.to_excel(daily_201412_excel_writer,'9_2',index=False)
daily_201412_excel_writer.save()
daily_20141210 = pro.daily(start_date='',end_date='',trade_date='20141210', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20141210_tscode_list = list() 
for ts_code_sh in daily_20141210['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20141210_tscode_list.append(stock_name)
daily_20141210_addname_dataframe=pd.DataFrame()
daily_20141210_addname_dataframe['cname'] = daily_20141210_tscode_list
for table_name in daily_20141210.columns.values.tolist():
    daily_20141210_addname_dataframe[table_name] = daily_20141210[table_name]
print("日线行情-时间为序  daily_20141210 返回数据 row 行数 = "+str(daily_20141210.shape[0]))
daily_20141210_addname_dataframe.to_excel(daily_201412_excel_writer,'10_3',index=False)
daily_201412_excel_writer.save()
daily_20141211 = pro.daily(start_date='',end_date='',trade_date='20141211', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20141211_tscode_list = list() 
for ts_code_sh in daily_20141211['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20141211_tscode_list.append(stock_name)
daily_20141211_addname_dataframe=pd.DataFrame()
daily_20141211_addname_dataframe['cname'] = daily_20141211_tscode_list
for table_name in daily_20141211.columns.values.tolist():
    daily_20141211_addname_dataframe[table_name] = daily_20141211[table_name]
print("日线行情-时间为序  daily_20141211 返回数据 row 行数 = "+str(daily_20141211.shape[0]))
daily_20141211_addname_dataframe.to_excel(daily_201412_excel_writer,'11_4',index=False)
daily_201412_excel_writer.save()
daily_20141212 = pro.daily(start_date='',end_date='',trade_date='20141212', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20141212_tscode_list = list() 
for ts_code_sh in daily_20141212['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20141212_tscode_list.append(stock_name)
daily_20141212_addname_dataframe=pd.DataFrame()
daily_20141212_addname_dataframe['cname'] = daily_20141212_tscode_list
for table_name in daily_20141212.columns.values.tolist():
    daily_20141212_addname_dataframe[table_name] = daily_20141212[table_name]
print("日线行情-时间为序  daily_20141212 返回数据 row 行数 = "+str(daily_20141212.shape[0]))
daily_20141212_addname_dataframe.to_excel(daily_201412_excel_writer,'12_5',index=False)
daily_201412_excel_writer.save()
daily_20141215 = pro.daily(start_date='',end_date='',trade_date='20141215', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20141215_tscode_list = list() 
for ts_code_sh in daily_20141215['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20141215_tscode_list.append(stock_name)
daily_20141215_addname_dataframe=pd.DataFrame()
daily_20141215_addname_dataframe['cname'] = daily_20141215_tscode_list
for table_name in daily_20141215.columns.values.tolist():
    daily_20141215_addname_dataframe[table_name] = daily_20141215[table_name]
print("日线行情-时间为序  daily_20141215 返回数据 row 行数 = "+str(daily_20141215.shape[0]))
daily_20141215_addname_dataframe.to_excel(daily_201412_excel_writer,'15_1',index=False)
daily_201412_excel_writer.save()
daily_20141216 = pro.daily(start_date='',end_date='',trade_date='20141216', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20141216_tscode_list = list() 
for ts_code_sh in daily_20141216['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20141216_tscode_list.append(stock_name)
daily_20141216_addname_dataframe=pd.DataFrame()
daily_20141216_addname_dataframe['cname'] = daily_20141216_tscode_list
for table_name in daily_20141216.columns.values.tolist():
    daily_20141216_addname_dataframe[table_name] = daily_20141216[table_name]
print("日线行情-时间为序  daily_20141216 返回数据 row 行数 = "+str(daily_20141216.shape[0]))
daily_20141216_addname_dataframe.to_excel(daily_201412_excel_writer,'16_2',index=False)
daily_201412_excel_writer.save()
daily_20141217 = pro.daily(start_date='',end_date='',trade_date='20141217', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20141217_tscode_list = list() 
for ts_code_sh in daily_20141217['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20141217_tscode_list.append(stock_name)
daily_20141217_addname_dataframe=pd.DataFrame()
daily_20141217_addname_dataframe['cname'] = daily_20141217_tscode_list
for table_name in daily_20141217.columns.values.tolist():
    daily_20141217_addname_dataframe[table_name] = daily_20141217[table_name]
print("日线行情-时间为序  daily_20141217 返回数据 row 行数 = "+str(daily_20141217.shape[0]))
daily_20141217_addname_dataframe.to_excel(daily_201412_excel_writer,'17_3',index=False)
daily_201412_excel_writer.save()
daily_20141218 = pro.daily(start_date='',end_date='',trade_date='20141218', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20141218_tscode_list = list() 
for ts_code_sh in daily_20141218['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20141218_tscode_list.append(stock_name)
daily_20141218_addname_dataframe=pd.DataFrame()
daily_20141218_addname_dataframe['cname'] = daily_20141218_tscode_list
for table_name in daily_20141218.columns.values.tolist():
    daily_20141218_addname_dataframe[table_name] = daily_20141218[table_name]
print("日线行情-时间为序  daily_20141218 返回数据 row 行数 = "+str(daily_20141218.shape[0]))
daily_20141218_addname_dataframe.to_excel(daily_201412_excel_writer,'18_4',index=False)
daily_201412_excel_writer.save()
daily_20141219 = pro.daily(start_date='',end_date='',trade_date='20141219', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20141219_tscode_list = list() 
for ts_code_sh in daily_20141219['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20141219_tscode_list.append(stock_name)
daily_20141219_addname_dataframe=pd.DataFrame()
daily_20141219_addname_dataframe['cname'] = daily_20141219_tscode_list
for table_name in daily_20141219.columns.values.tolist():
    daily_20141219_addname_dataframe[table_name] = daily_20141219[table_name]
print("日线行情-时间为序  daily_20141219 返回数据 row 行数 = "+str(daily_20141219.shape[0]))
daily_20141219_addname_dataframe.to_excel(daily_201412_excel_writer,'19_5',index=False)
daily_201412_excel_writer.save()
daily_20141222 = pro.daily(start_date='',end_date='',trade_date='20141222', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20141222_tscode_list = list() 
for ts_code_sh in daily_20141222['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20141222_tscode_list.append(stock_name)
daily_20141222_addname_dataframe=pd.DataFrame()
daily_20141222_addname_dataframe['cname'] = daily_20141222_tscode_list
for table_name in daily_20141222.columns.values.tolist():
    daily_20141222_addname_dataframe[table_name] = daily_20141222[table_name]
print("日线行情-时间为序  daily_20141222 返回数据 row 行数 = "+str(daily_20141222.shape[0]))
daily_20141222_addname_dataframe.to_excel(daily_201412_excel_writer,'22_1',index=False)
daily_201412_excel_writer.save()
daily_20141223 = pro.daily(start_date='',end_date='',trade_date='20141223', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20141223_tscode_list = list() 
for ts_code_sh in daily_20141223['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20141223_tscode_list.append(stock_name)
daily_20141223_addname_dataframe=pd.DataFrame()
daily_20141223_addname_dataframe['cname'] = daily_20141223_tscode_list
for table_name in daily_20141223.columns.values.tolist():
    daily_20141223_addname_dataframe[table_name] = daily_20141223[table_name]
print("日线行情-时间为序  daily_20141223 返回数据 row 行数 = "+str(daily_20141223.shape[0]))
daily_20141223_addname_dataframe.to_excel(daily_201412_excel_writer,'23_2',index=False)
daily_201412_excel_writer.save()
daily_20141224 = pro.daily(start_date='',end_date='',trade_date='20141224', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20141224_tscode_list = list() 
for ts_code_sh in daily_20141224['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20141224_tscode_list.append(stock_name)
daily_20141224_addname_dataframe=pd.DataFrame()
daily_20141224_addname_dataframe['cname'] = daily_20141224_tscode_list
for table_name in daily_20141224.columns.values.tolist():
    daily_20141224_addname_dataframe[table_name] = daily_20141224[table_name]
print("日线行情-时间为序  daily_20141224 返回数据 row 行数 = "+str(daily_20141224.shape[0]))
daily_20141224_addname_dataframe.to_excel(daily_201412_excel_writer,'24_3',index=False)
daily_201412_excel_writer.save()
daily_20141225 = pro.daily(start_date='',end_date='',trade_date='20141225', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20141225_tscode_list = list() 
for ts_code_sh in daily_20141225['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20141225_tscode_list.append(stock_name)
daily_20141225_addname_dataframe=pd.DataFrame()
daily_20141225_addname_dataframe['cname'] = daily_20141225_tscode_list
for table_name in daily_20141225.columns.values.tolist():
    daily_20141225_addname_dataframe[table_name] = daily_20141225[table_name]
print("日线行情-时间为序  daily_20141225 返回数据 row 行数 = "+str(daily_20141225.shape[0]))
daily_20141225_addname_dataframe.to_excel(daily_201412_excel_writer,'25_4',index=False)
daily_201412_excel_writer.save()
daily_20141226 = pro.daily(start_date='',end_date='',trade_date='20141226', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20141226_tscode_list = list() 
for ts_code_sh in daily_20141226['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20141226_tscode_list.append(stock_name)
daily_20141226_addname_dataframe=pd.DataFrame()
daily_20141226_addname_dataframe['cname'] = daily_20141226_tscode_list
for table_name in daily_20141226.columns.values.tolist():
    daily_20141226_addname_dataframe[table_name] = daily_20141226[table_name]
print("日线行情-时间为序  daily_20141226 返回数据 row 行数 = "+str(daily_20141226.shape[0]))
daily_20141226_addname_dataframe.to_excel(daily_201412_excel_writer,'26_5',index=False)
daily_201412_excel_writer.save()
daily_20141229 = pro.daily(start_date='',end_date='',trade_date='20141229', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20141229_tscode_list = list() 
for ts_code_sh in daily_20141229['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20141229_tscode_list.append(stock_name)
daily_20141229_addname_dataframe=pd.DataFrame()
daily_20141229_addname_dataframe['cname'] = daily_20141229_tscode_list
for table_name in daily_20141229.columns.values.tolist():
    daily_20141229_addname_dataframe[table_name] = daily_20141229[table_name]
print("日线行情-时间为序  daily_20141229 返回数据 row 行数 = "+str(daily_20141229.shape[0]))
daily_20141229_addname_dataframe.to_excel(daily_201412_excel_writer,'29_1',index=False)
daily_201412_excel_writer.save()
daily_20141230 = pro.daily(start_date='',end_date='',trade_date='20141230', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20141230_tscode_list = list() 
for ts_code_sh in daily_20141230['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20141230_tscode_list.append(stock_name)
daily_20141230_addname_dataframe=pd.DataFrame()
daily_20141230_addname_dataframe['cname'] = daily_20141230_tscode_list
for table_name in daily_20141230.columns.values.tolist():
    daily_20141230_addname_dataframe[table_name] = daily_20141230[table_name]
print("日线行情-时间为序  daily_20141230 返回数据 row 行数 = "+str(daily_20141230.shape[0]))
daily_20141230_addname_dataframe.to_excel(daily_201412_excel_writer,'30_2',index=False)
daily_201412_excel_writer.save()
daily_20141231 = pro.daily(start_date='',end_date='',trade_date='20141231', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20141231_tscode_list = list() 
for ts_code_sh in daily_20141231['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20141231_tscode_list.append(stock_name)
daily_20141231_addname_dataframe=pd.DataFrame()
daily_20141231_addname_dataframe['cname'] = daily_20141231_tscode_list
for table_name in daily_20141231.columns.values.tolist():
    daily_20141231_addname_dataframe[table_name] = daily_20141231[table_name]
print("日线行情-时间为序  daily_20141231 返回数据 row 行数 = "+str(daily_20141231.shape[0]))
daily_20141231_addname_dataframe.to_excel(daily_201412_excel_writer,'31_3',index=False)
daily_201412_excel_writer.save()




createexcel('daily_201501.xlsx')
daily_201501_book = load_workbook('C:\\Users\\zhuzj5\\Desktop\\zbin\\J0_Data\\daily_201501.xlsx')
daily_201501_excel_writer = pd.ExcelWriter('C:\\Users\\zhuzj5\\Desktop\\zbin\\J0_Data\\daily_201501.xlsx', engine='openpyxl')
daily_201501_excel_writer.book = daily_201501_book
daily_201501_excel_writer.sheets = dict((ws.title, ws) for ws in daily_201501_book.worksheets)
J0_PROPS.put(tree_node_name+"record_date", "20150101")       ###  更新 记录日期
daily_20150105 = pro.daily(start_date='',end_date='',trade_date='20150105', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20150105_tscode_list = list() 
for ts_code_sh in daily_20150105['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20150105_tscode_list.append(stock_name)
daily_20150105_addname_dataframe=pd.DataFrame()
daily_20150105_addname_dataframe['cname'] = daily_20150105_tscode_list
for table_name in daily_20150105.columns.values.tolist():
    daily_20150105_addname_dataframe[table_name] = daily_20150105[table_name]
print("日线行情-时间为序  daily_20150105 返回数据 row 行数 = "+str(daily_20150105.shape[0]))
daily_20150105_addname_dataframe.to_excel(daily_201501_excel_writer,'5_1',index=False)
daily_201501_excel_writer.save()
daily_20150106 = pro.daily(start_date='',end_date='',trade_date='20150106', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20150106_tscode_list = list() 
for ts_code_sh in daily_20150106['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20150106_tscode_list.append(stock_name)
daily_20150106_addname_dataframe=pd.DataFrame()
daily_20150106_addname_dataframe['cname'] = daily_20150106_tscode_list
for table_name in daily_20150106.columns.values.tolist():
    daily_20150106_addname_dataframe[table_name] = daily_20150106[table_name]
print("日线行情-时间为序  daily_20150106 返回数据 row 行数 = "+str(daily_20150106.shape[0]))
daily_20150106_addname_dataframe.to_excel(daily_201501_excel_writer,'6_2',index=False)
daily_201501_excel_writer.save()
daily_20150107 = pro.daily(start_date='',end_date='',trade_date='20150107', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20150107_tscode_list = list() 
for ts_code_sh in daily_20150107['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20150107_tscode_list.append(stock_name)
daily_20150107_addname_dataframe=pd.DataFrame()
daily_20150107_addname_dataframe['cname'] = daily_20150107_tscode_list
for table_name in daily_20150107.columns.values.tolist():
    daily_20150107_addname_dataframe[table_name] = daily_20150107[table_name]
print("日线行情-时间为序  daily_20150107 返回数据 row 行数 = "+str(daily_20150107.shape[0]))
daily_20150107_addname_dataframe.to_excel(daily_201501_excel_writer,'7_3',index=False)
daily_201501_excel_writer.save()
daily_20150108 = pro.daily(start_date='',end_date='',trade_date='20150108', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20150108_tscode_list = list() 
for ts_code_sh in daily_20150108['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20150108_tscode_list.append(stock_name)
daily_20150108_addname_dataframe=pd.DataFrame()
daily_20150108_addname_dataframe['cname'] = daily_20150108_tscode_list
for table_name in daily_20150108.columns.values.tolist():
    daily_20150108_addname_dataframe[table_name] = daily_20150108[table_name]
print("日线行情-时间为序  daily_20150108 返回数据 row 行数 = "+str(daily_20150108.shape[0]))
daily_20150108_addname_dataframe.to_excel(daily_201501_excel_writer,'8_4',index=False)
daily_201501_excel_writer.save()
daily_20150109 = pro.daily(start_date='',end_date='',trade_date='20150109', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20150109_tscode_list = list() 
for ts_code_sh in daily_20150109['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20150109_tscode_list.append(stock_name)
daily_20150109_addname_dataframe=pd.DataFrame()
daily_20150109_addname_dataframe['cname'] = daily_20150109_tscode_list
for table_name in daily_20150109.columns.values.tolist():
    daily_20150109_addname_dataframe[table_name] = daily_20150109[table_name]
print("日线行情-时间为序  daily_20150109 返回数据 row 行数 = "+str(daily_20150109.shape[0]))
daily_20150109_addname_dataframe.to_excel(daily_201501_excel_writer,'9_5',index=False)
daily_201501_excel_writer.save()
daily_20150112 = pro.daily(start_date='',end_date='',trade_date='20150112', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20150112_tscode_list = list() 
for ts_code_sh in daily_20150112['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20150112_tscode_list.append(stock_name)
daily_20150112_addname_dataframe=pd.DataFrame()
daily_20150112_addname_dataframe['cname'] = daily_20150112_tscode_list
for table_name in daily_20150112.columns.values.tolist():
    daily_20150112_addname_dataframe[table_name] = daily_20150112[table_name]
print("日线行情-时间为序  daily_20150112 返回数据 row 行数 = "+str(daily_20150112.shape[0]))
daily_20150112_addname_dataframe.to_excel(daily_201501_excel_writer,'12_1',index=False)
daily_201501_excel_writer.save()
daily_20150113 = pro.daily(start_date='',end_date='',trade_date='20150113', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20150113_tscode_list = list() 
for ts_code_sh in daily_20150113['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20150113_tscode_list.append(stock_name)
daily_20150113_addname_dataframe=pd.DataFrame()
daily_20150113_addname_dataframe['cname'] = daily_20150113_tscode_list
for table_name in daily_20150113.columns.values.tolist():
    daily_20150113_addname_dataframe[table_name] = daily_20150113[table_name]
print("日线行情-时间为序  daily_20150113 返回数据 row 行数 = "+str(daily_20150113.shape[0]))
daily_20150113_addname_dataframe.to_excel(daily_201501_excel_writer,'13_2',index=False)
daily_201501_excel_writer.save()
daily_20150114 = pro.daily(start_date='',end_date='',trade_date='20150114', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20150114_tscode_list = list() 
for ts_code_sh in daily_20150114['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20150114_tscode_list.append(stock_name)
daily_20150114_addname_dataframe=pd.DataFrame()
daily_20150114_addname_dataframe['cname'] = daily_20150114_tscode_list
for table_name in daily_20150114.columns.values.tolist():
    daily_20150114_addname_dataframe[table_name] = daily_20150114[table_name]
print("日线行情-时间为序  daily_20150114 返回数据 row 行数 = "+str(daily_20150114.shape[0]))
daily_20150114_addname_dataframe.to_excel(daily_201501_excel_writer,'14_3',index=False)
daily_201501_excel_writer.save()
daily_20150115 = pro.daily(start_date='',end_date='',trade_date='20150115', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20150115_tscode_list = list() 
for ts_code_sh in daily_20150115['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20150115_tscode_list.append(stock_name)
daily_20150115_addname_dataframe=pd.DataFrame()
daily_20150115_addname_dataframe['cname'] = daily_20150115_tscode_list
for table_name in daily_20150115.columns.values.tolist():
    daily_20150115_addname_dataframe[table_name] = daily_20150115[table_name]
print("日线行情-时间为序  daily_20150115 返回数据 row 行数 = "+str(daily_20150115.shape[0]))
daily_20150115_addname_dataframe.to_excel(daily_201501_excel_writer,'15_4',index=False)
daily_201501_excel_writer.save()
daily_20150116 = pro.daily(start_date='',end_date='',trade_date='20150116', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20150116_tscode_list = list() 
for ts_code_sh in daily_20150116['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20150116_tscode_list.append(stock_name)
daily_20150116_addname_dataframe=pd.DataFrame()
daily_20150116_addname_dataframe['cname'] = daily_20150116_tscode_list
for table_name in daily_20150116.columns.values.tolist():
    daily_20150116_addname_dataframe[table_name] = daily_20150116[table_name]
print("日线行情-时间为序  daily_20150116 返回数据 row 行数 = "+str(daily_20150116.shape[0]))
daily_20150116_addname_dataframe.to_excel(daily_201501_excel_writer,'16_5',index=False)
daily_201501_excel_writer.save()
daily_20150119 = pro.daily(start_date='',end_date='',trade_date='20150119', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20150119_tscode_list = list() 
for ts_code_sh in daily_20150119['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20150119_tscode_list.append(stock_name)
daily_20150119_addname_dataframe=pd.DataFrame()
daily_20150119_addname_dataframe['cname'] = daily_20150119_tscode_list
for table_name in daily_20150119.columns.values.tolist():
    daily_20150119_addname_dataframe[table_name] = daily_20150119[table_name]
print("日线行情-时间为序  daily_20150119 返回数据 row 行数 = "+str(daily_20150119.shape[0]))
daily_20150119_addname_dataframe.to_excel(daily_201501_excel_writer,'19_1',index=False)
daily_201501_excel_writer.save()
daily_20150120 = pro.daily(start_date='',end_date='',trade_date='20150120', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20150120_tscode_list = list() 
for ts_code_sh in daily_20150120['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20150120_tscode_list.append(stock_name)
daily_20150120_addname_dataframe=pd.DataFrame()
daily_20150120_addname_dataframe['cname'] = daily_20150120_tscode_list
for table_name in daily_20150120.columns.values.tolist():
    daily_20150120_addname_dataframe[table_name] = daily_20150120[table_name]
print("日线行情-时间为序  daily_20150120 返回数据 row 行数 = "+str(daily_20150120.shape[0]))
daily_20150120_addname_dataframe.to_excel(daily_201501_excel_writer,'20_2',index=False)
daily_201501_excel_writer.save()
daily_20150121 = pro.daily(start_date='',end_date='',trade_date='20150121', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20150121_tscode_list = list() 
for ts_code_sh in daily_20150121['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20150121_tscode_list.append(stock_name)
daily_20150121_addname_dataframe=pd.DataFrame()
daily_20150121_addname_dataframe['cname'] = daily_20150121_tscode_list
for table_name in daily_20150121.columns.values.tolist():
    daily_20150121_addname_dataframe[table_name] = daily_20150121[table_name]
print("日线行情-时间为序  daily_20150121 返回数据 row 行数 = "+str(daily_20150121.shape[0]))
daily_20150121_addname_dataframe.to_excel(daily_201501_excel_writer,'21_3',index=False)
daily_201501_excel_writer.save()
daily_20150122 = pro.daily(start_date='',end_date='',trade_date='20150122', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20150122_tscode_list = list() 
for ts_code_sh in daily_20150122['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20150122_tscode_list.append(stock_name)
daily_20150122_addname_dataframe=pd.DataFrame()
daily_20150122_addname_dataframe['cname'] = daily_20150122_tscode_list
for table_name in daily_20150122.columns.values.tolist():
    daily_20150122_addname_dataframe[table_name] = daily_20150122[table_name]
print("日线行情-时间为序  daily_20150122 返回数据 row 行数 = "+str(daily_20150122.shape[0]))
daily_20150122_addname_dataframe.to_excel(daily_201501_excel_writer,'22_4',index=False)
daily_201501_excel_writer.save()
daily_20150123 = pro.daily(start_date='',end_date='',trade_date='20150123', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20150123_tscode_list = list() 
for ts_code_sh in daily_20150123['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20150123_tscode_list.append(stock_name)
daily_20150123_addname_dataframe=pd.DataFrame()
daily_20150123_addname_dataframe['cname'] = daily_20150123_tscode_list
for table_name in daily_20150123.columns.values.tolist():
    daily_20150123_addname_dataframe[table_name] = daily_20150123[table_name]
print("日线行情-时间为序  daily_20150123 返回数据 row 行数 = "+str(daily_20150123.shape[0]))
daily_20150123_addname_dataframe.to_excel(daily_201501_excel_writer,'23_5',index=False)
daily_201501_excel_writer.save()
daily_20150126 = pro.daily(start_date='',end_date='',trade_date='20150126', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20150126_tscode_list = list() 
for ts_code_sh in daily_20150126['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20150126_tscode_list.append(stock_name)
daily_20150126_addname_dataframe=pd.DataFrame()
daily_20150126_addname_dataframe['cname'] = daily_20150126_tscode_list
for table_name in daily_20150126.columns.values.tolist():
    daily_20150126_addname_dataframe[table_name] = daily_20150126[table_name]
print("日线行情-时间为序  daily_20150126 返回数据 row 行数 = "+str(daily_20150126.shape[0]))
daily_20150126_addname_dataframe.to_excel(daily_201501_excel_writer,'26_1',index=False)
daily_201501_excel_writer.save()
daily_20150127 = pro.daily(start_date='',end_date='',trade_date='20150127', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20150127_tscode_list = list() 
for ts_code_sh in daily_20150127['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20150127_tscode_list.append(stock_name)
daily_20150127_addname_dataframe=pd.DataFrame()
daily_20150127_addname_dataframe['cname'] = daily_20150127_tscode_list
for table_name in daily_20150127.columns.values.tolist():
    daily_20150127_addname_dataframe[table_name] = daily_20150127[table_name]
print("日线行情-时间为序  daily_20150127 返回数据 row 行数 = "+str(daily_20150127.shape[0]))
daily_20150127_addname_dataframe.to_excel(daily_201501_excel_writer,'27_2',index=False)
daily_201501_excel_writer.save()
daily_20150128 = pro.daily(start_date='',end_date='',trade_date='20150128', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20150128_tscode_list = list() 
for ts_code_sh in daily_20150128['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20150128_tscode_list.append(stock_name)
daily_20150128_addname_dataframe=pd.DataFrame()
daily_20150128_addname_dataframe['cname'] = daily_20150128_tscode_list
for table_name in daily_20150128.columns.values.tolist():
    daily_20150128_addname_dataframe[table_name] = daily_20150128[table_name]
print("日线行情-时间为序  daily_20150128 返回数据 row 行数 = "+str(daily_20150128.shape[0]))
daily_20150128_addname_dataframe.to_excel(daily_201501_excel_writer,'28_3',index=False)
daily_201501_excel_writer.save()
daily_20150129 = pro.daily(start_date='',end_date='',trade_date='20150129', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20150129_tscode_list = list() 
for ts_code_sh in daily_20150129['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20150129_tscode_list.append(stock_name)
daily_20150129_addname_dataframe=pd.DataFrame()
daily_20150129_addname_dataframe['cname'] = daily_20150129_tscode_list
for table_name in daily_20150129.columns.values.tolist():
    daily_20150129_addname_dataframe[table_name] = daily_20150129[table_name]
print("日线行情-时间为序  daily_20150129 返回数据 row 行数 = "+str(daily_20150129.shape[0]))
daily_20150129_addname_dataframe.to_excel(daily_201501_excel_writer,'29_4',index=False)
daily_201501_excel_writer.save()
daily_20150130 = pro.daily(start_date='',end_date='',trade_date='20150130', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20150130_tscode_list = list() 
for ts_code_sh in daily_20150130['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20150130_tscode_list.append(stock_name)
daily_20150130_addname_dataframe=pd.DataFrame()
daily_20150130_addname_dataframe['cname'] = daily_20150130_tscode_list
for table_name in daily_20150130.columns.values.tolist():
    daily_20150130_addname_dataframe[table_name] = daily_20150130[table_name]
print("日线行情-时间为序  daily_20150130 返回数据 row 行数 = "+str(daily_20150130.shape[0]))
daily_20150130_addname_dataframe.to_excel(daily_201501_excel_writer,'30_5',index=False)
daily_201501_excel_writer.save()




createexcel('daily_201502.xlsx')
daily_201502_book = load_workbook('C:\\Users\\zhuzj5\\Desktop\\zbin\\J0_Data\\daily_201502.xlsx')
daily_201502_excel_writer = pd.ExcelWriter('C:\\Users\\zhuzj5\\Desktop\\zbin\\J0_Data\\daily_201502.xlsx', engine='openpyxl')
daily_201502_excel_writer.book = daily_201502_book
daily_201502_excel_writer.sheets = dict((ws.title, ws) for ws in daily_201502_book.worksheets)
J0_PROPS.put(tree_node_name+"record_date", "20150201")       ###  更新 记录日期
daily_20150202 = pro.daily(start_date='',end_date='',trade_date='20150202', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20150202_tscode_list = list() 
for ts_code_sh in daily_20150202['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20150202_tscode_list.append(stock_name)
daily_20150202_addname_dataframe=pd.DataFrame()
daily_20150202_addname_dataframe['cname'] = daily_20150202_tscode_list
for table_name in daily_20150202.columns.values.tolist():
    daily_20150202_addname_dataframe[table_name] = daily_20150202[table_name]
print("日线行情-时间为序  daily_20150202 返回数据 row 行数 = "+str(daily_20150202.shape[0]))
daily_20150202_addname_dataframe.to_excel(daily_201502_excel_writer,'2_1',index=False)
daily_201502_excel_writer.save()
daily_20150203 = pro.daily(start_date='',end_date='',trade_date='20150203', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20150203_tscode_list = list() 
for ts_code_sh in daily_20150203['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20150203_tscode_list.append(stock_name)
daily_20150203_addname_dataframe=pd.DataFrame()
daily_20150203_addname_dataframe['cname'] = daily_20150203_tscode_list
for table_name in daily_20150203.columns.values.tolist():
    daily_20150203_addname_dataframe[table_name] = daily_20150203[table_name]
print("日线行情-时间为序  daily_20150203 返回数据 row 行数 = "+str(daily_20150203.shape[0]))
daily_20150203_addname_dataframe.to_excel(daily_201502_excel_writer,'3_2',index=False)
daily_201502_excel_writer.save()
daily_20150204 = pro.daily(start_date='',end_date='',trade_date='20150204', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20150204_tscode_list = list() 
for ts_code_sh in daily_20150204['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20150204_tscode_list.append(stock_name)
daily_20150204_addname_dataframe=pd.DataFrame()
daily_20150204_addname_dataframe['cname'] = daily_20150204_tscode_list
for table_name in daily_20150204.columns.values.tolist():
    daily_20150204_addname_dataframe[table_name] = daily_20150204[table_name]
print("日线行情-时间为序  daily_20150204 返回数据 row 行数 = "+str(daily_20150204.shape[0]))
daily_20150204_addname_dataframe.to_excel(daily_201502_excel_writer,'4_3',index=False)
daily_201502_excel_writer.save()
daily_20150205 = pro.daily(start_date='',end_date='',trade_date='20150205', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20150205_tscode_list = list() 
for ts_code_sh in daily_20150205['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20150205_tscode_list.append(stock_name)
daily_20150205_addname_dataframe=pd.DataFrame()
daily_20150205_addname_dataframe['cname'] = daily_20150205_tscode_list
for table_name in daily_20150205.columns.values.tolist():
    daily_20150205_addname_dataframe[table_name] = daily_20150205[table_name]
print("日线行情-时间为序  daily_20150205 返回数据 row 行数 = "+str(daily_20150205.shape[0]))
daily_20150205_addname_dataframe.to_excel(daily_201502_excel_writer,'5_4',index=False)
daily_201502_excel_writer.save()
daily_20150206 = pro.daily(start_date='',end_date='',trade_date='20150206', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20150206_tscode_list = list() 
for ts_code_sh in daily_20150206['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20150206_tscode_list.append(stock_name)
daily_20150206_addname_dataframe=pd.DataFrame()
daily_20150206_addname_dataframe['cname'] = daily_20150206_tscode_list
for table_name in daily_20150206.columns.values.tolist():
    daily_20150206_addname_dataframe[table_name] = daily_20150206[table_name]
print("日线行情-时间为序  daily_20150206 返回数据 row 行数 = "+str(daily_20150206.shape[0]))
daily_20150206_addname_dataframe.to_excel(daily_201502_excel_writer,'6_5',index=False)
daily_201502_excel_writer.save()
daily_20150209 = pro.daily(start_date='',end_date='',trade_date='20150209', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20150209_tscode_list = list() 
for ts_code_sh in daily_20150209['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20150209_tscode_list.append(stock_name)
daily_20150209_addname_dataframe=pd.DataFrame()
daily_20150209_addname_dataframe['cname'] = daily_20150209_tscode_list
for table_name in daily_20150209.columns.values.tolist():
    daily_20150209_addname_dataframe[table_name] = daily_20150209[table_name]
print("日线行情-时间为序  daily_20150209 返回数据 row 行数 = "+str(daily_20150209.shape[0]))
daily_20150209_addname_dataframe.to_excel(daily_201502_excel_writer,'9_1',index=False)
daily_201502_excel_writer.save()
daily_20150210 = pro.daily(start_date='',end_date='',trade_date='20150210', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20150210_tscode_list = list() 
for ts_code_sh in daily_20150210['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20150210_tscode_list.append(stock_name)
daily_20150210_addname_dataframe=pd.DataFrame()
daily_20150210_addname_dataframe['cname'] = daily_20150210_tscode_list
for table_name in daily_20150210.columns.values.tolist():
    daily_20150210_addname_dataframe[table_name] = daily_20150210[table_name]
print("日线行情-时间为序  daily_20150210 返回数据 row 行数 = "+str(daily_20150210.shape[0]))
daily_20150210_addname_dataframe.to_excel(daily_201502_excel_writer,'10_2',index=False)
daily_201502_excel_writer.save()
daily_20150211 = pro.daily(start_date='',end_date='',trade_date='20150211', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20150211_tscode_list = list() 
for ts_code_sh in daily_20150211['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20150211_tscode_list.append(stock_name)
daily_20150211_addname_dataframe=pd.DataFrame()
daily_20150211_addname_dataframe['cname'] = daily_20150211_tscode_list
for table_name in daily_20150211.columns.values.tolist():
    daily_20150211_addname_dataframe[table_name] = daily_20150211[table_name]
print("日线行情-时间为序  daily_20150211 返回数据 row 行数 = "+str(daily_20150211.shape[0]))
daily_20150211_addname_dataframe.to_excel(daily_201502_excel_writer,'11_3',index=False)
daily_201502_excel_writer.save()
daily_20150212 = pro.daily(start_date='',end_date='',trade_date='20150212', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20150212_tscode_list = list() 
for ts_code_sh in daily_20150212['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20150212_tscode_list.append(stock_name)
daily_20150212_addname_dataframe=pd.DataFrame()
daily_20150212_addname_dataframe['cname'] = daily_20150212_tscode_list
for table_name in daily_20150212.columns.values.tolist():
    daily_20150212_addname_dataframe[table_name] = daily_20150212[table_name]
print("日线行情-时间为序  daily_20150212 返回数据 row 行数 = "+str(daily_20150212.shape[0]))
daily_20150212_addname_dataframe.to_excel(daily_201502_excel_writer,'12_4',index=False)
daily_201502_excel_writer.save()
daily_20150213 = pro.daily(start_date='',end_date='',trade_date='20150213', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20150213_tscode_list = list() 
for ts_code_sh in daily_20150213['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20150213_tscode_list.append(stock_name)
daily_20150213_addname_dataframe=pd.DataFrame()
daily_20150213_addname_dataframe['cname'] = daily_20150213_tscode_list
for table_name in daily_20150213.columns.values.tolist():
    daily_20150213_addname_dataframe[table_name] = daily_20150213[table_name]
print("日线行情-时间为序  daily_20150213 返回数据 row 行数 = "+str(daily_20150213.shape[0]))
daily_20150213_addname_dataframe.to_excel(daily_201502_excel_writer,'13_5',index=False)
daily_201502_excel_writer.save()
daily_20150216 = pro.daily(start_date='',end_date='',trade_date='20150216', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20150216_tscode_list = list() 
for ts_code_sh in daily_20150216['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20150216_tscode_list.append(stock_name)
daily_20150216_addname_dataframe=pd.DataFrame()
daily_20150216_addname_dataframe['cname'] = daily_20150216_tscode_list
for table_name in daily_20150216.columns.values.tolist():
    daily_20150216_addname_dataframe[table_name] = daily_20150216[table_name]
print("日线行情-时间为序  daily_20150216 返回数据 row 行数 = "+str(daily_20150216.shape[0]))
daily_20150216_addname_dataframe.to_excel(daily_201502_excel_writer,'16_1',index=False)
daily_201502_excel_writer.save()
daily_20150217 = pro.daily(start_date='',end_date='',trade_date='20150217', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20150217_tscode_list = list() 
for ts_code_sh in daily_20150217['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20150217_tscode_list.append(stock_name)
daily_20150217_addname_dataframe=pd.DataFrame()
daily_20150217_addname_dataframe['cname'] = daily_20150217_tscode_list
for table_name in daily_20150217.columns.values.tolist():
    daily_20150217_addname_dataframe[table_name] = daily_20150217[table_name]
print("日线行情-时间为序  daily_20150217 返回数据 row 行数 = "+str(daily_20150217.shape[0]))
daily_20150217_addname_dataframe.to_excel(daily_201502_excel_writer,'17_2',index=False)
daily_201502_excel_writer.save()
daily_20150225 = pro.daily(start_date='',end_date='',trade_date='20150225', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20150225_tscode_list = list() 
for ts_code_sh in daily_20150225['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20150225_tscode_list.append(stock_name)
daily_20150225_addname_dataframe=pd.DataFrame()
daily_20150225_addname_dataframe['cname'] = daily_20150225_tscode_list
for table_name in daily_20150225.columns.values.tolist():
    daily_20150225_addname_dataframe[table_name] = daily_20150225[table_name]
print("日线行情-时间为序  daily_20150225 返回数据 row 行数 = "+str(daily_20150225.shape[0]))
daily_20150225_addname_dataframe.to_excel(daily_201502_excel_writer,'25_3',index=False)
daily_201502_excel_writer.save()
daily_20150226 = pro.daily(start_date='',end_date='',trade_date='20150226', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20150226_tscode_list = list() 
for ts_code_sh in daily_20150226['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20150226_tscode_list.append(stock_name)
daily_20150226_addname_dataframe=pd.DataFrame()
daily_20150226_addname_dataframe['cname'] = daily_20150226_tscode_list
for table_name in daily_20150226.columns.values.tolist():
    daily_20150226_addname_dataframe[table_name] = daily_20150226[table_name]
print("日线行情-时间为序  daily_20150226 返回数据 row 行数 = "+str(daily_20150226.shape[0]))
daily_20150226_addname_dataframe.to_excel(daily_201502_excel_writer,'26_4',index=False)
daily_201502_excel_writer.save()
daily_20150227 = pro.daily(start_date='',end_date='',trade_date='20150227', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20150227_tscode_list = list() 
for ts_code_sh in daily_20150227['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20150227_tscode_list.append(stock_name)
daily_20150227_addname_dataframe=pd.DataFrame()
daily_20150227_addname_dataframe['cname'] = daily_20150227_tscode_list
for table_name in daily_20150227.columns.values.tolist():
    daily_20150227_addname_dataframe[table_name] = daily_20150227[table_name]
print("日线行情-时间为序  daily_20150227 返回数据 row 行数 = "+str(daily_20150227.shape[0]))
daily_20150227_addname_dataframe.to_excel(daily_201502_excel_writer,'27_5',index=False)
daily_201502_excel_writer.save()




createexcel('daily_201503.xlsx')
daily_201503_book = load_workbook('C:\\Users\\zhuzj5\\Desktop\\zbin\\J0_Data\\daily_201503.xlsx')
daily_201503_excel_writer = pd.ExcelWriter('C:\\Users\\zhuzj5\\Desktop\\zbin\\J0_Data\\daily_201503.xlsx', engine='openpyxl')
daily_201503_excel_writer.book = daily_201503_book
daily_201503_excel_writer.sheets = dict((ws.title, ws) for ws in daily_201503_book.worksheets)
J0_PROPS.put(tree_node_name+"record_date", "20150301")       ###  更新 记录日期
daily_20150302 = pro.daily(start_date='',end_date='',trade_date='20150302', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20150302_tscode_list = list() 
for ts_code_sh in daily_20150302['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20150302_tscode_list.append(stock_name)
daily_20150302_addname_dataframe=pd.DataFrame()
daily_20150302_addname_dataframe['cname'] = daily_20150302_tscode_list
for table_name in daily_20150302.columns.values.tolist():
    daily_20150302_addname_dataframe[table_name] = daily_20150302[table_name]
print("日线行情-时间为序  daily_20150302 返回数据 row 行数 = "+str(daily_20150302.shape[0]))
daily_20150302_addname_dataframe.to_excel(daily_201503_excel_writer,'2_1',index=False)
daily_201503_excel_writer.save()
daily_20150303 = pro.daily(start_date='',end_date='',trade_date='20150303', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20150303_tscode_list = list() 
for ts_code_sh in daily_20150303['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20150303_tscode_list.append(stock_name)
daily_20150303_addname_dataframe=pd.DataFrame()
daily_20150303_addname_dataframe['cname'] = daily_20150303_tscode_list
for table_name in daily_20150303.columns.values.tolist():
    daily_20150303_addname_dataframe[table_name] = daily_20150303[table_name]
print("日线行情-时间为序  daily_20150303 返回数据 row 行数 = "+str(daily_20150303.shape[0]))
daily_20150303_addname_dataframe.to_excel(daily_201503_excel_writer,'3_2',index=False)
daily_201503_excel_writer.save()
daily_20150304 = pro.daily(start_date='',end_date='',trade_date='20150304', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20150304_tscode_list = list() 
for ts_code_sh in daily_20150304['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20150304_tscode_list.append(stock_name)
daily_20150304_addname_dataframe=pd.DataFrame()
daily_20150304_addname_dataframe['cname'] = daily_20150304_tscode_list
for table_name in daily_20150304.columns.values.tolist():
    daily_20150304_addname_dataframe[table_name] = daily_20150304[table_name]
print("日线行情-时间为序  daily_20150304 返回数据 row 行数 = "+str(daily_20150304.shape[0]))
daily_20150304_addname_dataframe.to_excel(daily_201503_excel_writer,'4_3',index=False)
daily_201503_excel_writer.save()
daily_20150305 = pro.daily(start_date='',end_date='',trade_date='20150305', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20150305_tscode_list = list() 
for ts_code_sh in daily_20150305['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20150305_tscode_list.append(stock_name)
daily_20150305_addname_dataframe=pd.DataFrame()
daily_20150305_addname_dataframe['cname'] = daily_20150305_tscode_list
for table_name in daily_20150305.columns.values.tolist():
    daily_20150305_addname_dataframe[table_name] = daily_20150305[table_name]
print("日线行情-时间为序  daily_20150305 返回数据 row 行数 = "+str(daily_20150305.shape[0]))
daily_20150305_addname_dataframe.to_excel(daily_201503_excel_writer,'5_4',index=False)
daily_201503_excel_writer.save()
daily_20150306 = pro.daily(start_date='',end_date='',trade_date='20150306', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20150306_tscode_list = list() 
for ts_code_sh in daily_20150306['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20150306_tscode_list.append(stock_name)
daily_20150306_addname_dataframe=pd.DataFrame()
daily_20150306_addname_dataframe['cname'] = daily_20150306_tscode_list
for table_name in daily_20150306.columns.values.tolist():
    daily_20150306_addname_dataframe[table_name] = daily_20150306[table_name]
print("日线行情-时间为序  daily_20150306 返回数据 row 行数 = "+str(daily_20150306.shape[0]))
daily_20150306_addname_dataframe.to_excel(daily_201503_excel_writer,'6_5',index=False)
daily_201503_excel_writer.save()
daily_20150309 = pro.daily(start_date='',end_date='',trade_date='20150309', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20150309_tscode_list = list() 
for ts_code_sh in daily_20150309['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20150309_tscode_list.append(stock_name)
daily_20150309_addname_dataframe=pd.DataFrame()
daily_20150309_addname_dataframe['cname'] = daily_20150309_tscode_list
for table_name in daily_20150309.columns.values.tolist():
    daily_20150309_addname_dataframe[table_name] = daily_20150309[table_name]
print("日线行情-时间为序  daily_20150309 返回数据 row 行数 = "+str(daily_20150309.shape[0]))
daily_20150309_addname_dataframe.to_excel(daily_201503_excel_writer,'9_1',index=False)
daily_201503_excel_writer.save()
daily_20150310 = pro.daily(start_date='',end_date='',trade_date='20150310', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20150310_tscode_list = list() 
for ts_code_sh in daily_20150310['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20150310_tscode_list.append(stock_name)
daily_20150310_addname_dataframe=pd.DataFrame()
daily_20150310_addname_dataframe['cname'] = daily_20150310_tscode_list
for table_name in daily_20150310.columns.values.tolist():
    daily_20150310_addname_dataframe[table_name] = daily_20150310[table_name]
print("日线行情-时间为序  daily_20150310 返回数据 row 行数 = "+str(daily_20150310.shape[0]))
daily_20150310_addname_dataframe.to_excel(daily_201503_excel_writer,'10_2',index=False)
daily_201503_excel_writer.save()
daily_20150311 = pro.daily(start_date='',end_date='',trade_date='20150311', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20150311_tscode_list = list() 
for ts_code_sh in daily_20150311['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20150311_tscode_list.append(stock_name)
daily_20150311_addname_dataframe=pd.DataFrame()
daily_20150311_addname_dataframe['cname'] = daily_20150311_tscode_list
for table_name in daily_20150311.columns.values.tolist():
    daily_20150311_addname_dataframe[table_name] = daily_20150311[table_name]
print("日线行情-时间为序  daily_20150311 返回数据 row 行数 = "+str(daily_20150311.shape[0]))
daily_20150311_addname_dataframe.to_excel(daily_201503_excel_writer,'11_3',index=False)
daily_201503_excel_writer.save()
daily_20150312 = pro.daily(start_date='',end_date='',trade_date='20150312', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20150312_tscode_list = list() 
for ts_code_sh in daily_20150312['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20150312_tscode_list.append(stock_name)
daily_20150312_addname_dataframe=pd.DataFrame()
daily_20150312_addname_dataframe['cname'] = daily_20150312_tscode_list
for table_name in daily_20150312.columns.values.tolist():
    daily_20150312_addname_dataframe[table_name] = daily_20150312[table_name]
print("日线行情-时间为序  daily_20150312 返回数据 row 行数 = "+str(daily_20150312.shape[0]))
daily_20150312_addname_dataframe.to_excel(daily_201503_excel_writer,'12_4',index=False)
daily_201503_excel_writer.save()
daily_20150313 = pro.daily(start_date='',end_date='',trade_date='20150313', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20150313_tscode_list = list() 
for ts_code_sh in daily_20150313['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20150313_tscode_list.append(stock_name)
daily_20150313_addname_dataframe=pd.DataFrame()
daily_20150313_addname_dataframe['cname'] = daily_20150313_tscode_list
for table_name in daily_20150313.columns.values.tolist():
    daily_20150313_addname_dataframe[table_name] = daily_20150313[table_name]
print("日线行情-时间为序  daily_20150313 返回数据 row 行数 = "+str(daily_20150313.shape[0]))
daily_20150313_addname_dataframe.to_excel(daily_201503_excel_writer,'13_5',index=False)
daily_201503_excel_writer.save()
daily_20150316 = pro.daily(start_date='',end_date='',trade_date='20150316', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20150316_tscode_list = list() 
for ts_code_sh in daily_20150316['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20150316_tscode_list.append(stock_name)
daily_20150316_addname_dataframe=pd.DataFrame()
daily_20150316_addname_dataframe['cname'] = daily_20150316_tscode_list
for table_name in daily_20150316.columns.values.tolist():
    daily_20150316_addname_dataframe[table_name] = daily_20150316[table_name]
print("日线行情-时间为序  daily_20150316 返回数据 row 行数 = "+str(daily_20150316.shape[0]))
daily_20150316_addname_dataframe.to_excel(daily_201503_excel_writer,'16_1',index=False)
daily_201503_excel_writer.save()
daily_20150317 = pro.daily(start_date='',end_date='',trade_date='20150317', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20150317_tscode_list = list() 
for ts_code_sh in daily_20150317['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20150317_tscode_list.append(stock_name)
daily_20150317_addname_dataframe=pd.DataFrame()
daily_20150317_addname_dataframe['cname'] = daily_20150317_tscode_list
for table_name in daily_20150317.columns.values.tolist():
    daily_20150317_addname_dataframe[table_name] = daily_20150317[table_name]
print("日线行情-时间为序  daily_20150317 返回数据 row 行数 = "+str(daily_20150317.shape[0]))
daily_20150317_addname_dataframe.to_excel(daily_201503_excel_writer,'17_2',index=False)
daily_201503_excel_writer.save()
daily_20150318 = pro.daily(start_date='',end_date='',trade_date='20150318', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20150318_tscode_list = list() 
for ts_code_sh in daily_20150318['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20150318_tscode_list.append(stock_name)
daily_20150318_addname_dataframe=pd.DataFrame()
daily_20150318_addname_dataframe['cname'] = daily_20150318_tscode_list
for table_name in daily_20150318.columns.values.tolist():
    daily_20150318_addname_dataframe[table_name] = daily_20150318[table_name]
print("日线行情-时间为序  daily_20150318 返回数据 row 行数 = "+str(daily_20150318.shape[0]))
daily_20150318_addname_dataframe.to_excel(daily_201503_excel_writer,'18_3',index=False)
daily_201503_excel_writer.save()
daily_20150319 = pro.daily(start_date='',end_date='',trade_date='20150319', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20150319_tscode_list = list() 
for ts_code_sh in daily_20150319['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20150319_tscode_list.append(stock_name)
daily_20150319_addname_dataframe=pd.DataFrame()
daily_20150319_addname_dataframe['cname'] = daily_20150319_tscode_list
for table_name in daily_20150319.columns.values.tolist():
    daily_20150319_addname_dataframe[table_name] = daily_20150319[table_name]
print("日线行情-时间为序  daily_20150319 返回数据 row 行数 = "+str(daily_20150319.shape[0]))
daily_20150319_addname_dataframe.to_excel(daily_201503_excel_writer,'19_4',index=False)
daily_201503_excel_writer.save()
daily_20150320 = pro.daily(start_date='',end_date='',trade_date='20150320', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20150320_tscode_list = list() 
for ts_code_sh in daily_20150320['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20150320_tscode_list.append(stock_name)
daily_20150320_addname_dataframe=pd.DataFrame()
daily_20150320_addname_dataframe['cname'] = daily_20150320_tscode_list
for table_name in daily_20150320.columns.values.tolist():
    daily_20150320_addname_dataframe[table_name] = daily_20150320[table_name]
print("日线行情-时间为序  daily_20150320 返回数据 row 行数 = "+str(daily_20150320.shape[0]))
daily_20150320_addname_dataframe.to_excel(daily_201503_excel_writer,'20_5',index=False)
daily_201503_excel_writer.save()
daily_20150323 = pro.daily(start_date='',end_date='',trade_date='20150323', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20150323_tscode_list = list() 
for ts_code_sh in daily_20150323['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20150323_tscode_list.append(stock_name)
daily_20150323_addname_dataframe=pd.DataFrame()
daily_20150323_addname_dataframe['cname'] = daily_20150323_tscode_list
for table_name in daily_20150323.columns.values.tolist():
    daily_20150323_addname_dataframe[table_name] = daily_20150323[table_name]
print("日线行情-时间为序  daily_20150323 返回数据 row 行数 = "+str(daily_20150323.shape[0]))
daily_20150323_addname_dataframe.to_excel(daily_201503_excel_writer,'23_1',index=False)
daily_201503_excel_writer.save()
daily_20150324 = pro.daily(start_date='',end_date='',trade_date='20150324', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20150324_tscode_list = list() 
for ts_code_sh in daily_20150324['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20150324_tscode_list.append(stock_name)
daily_20150324_addname_dataframe=pd.DataFrame()
daily_20150324_addname_dataframe['cname'] = daily_20150324_tscode_list
for table_name in daily_20150324.columns.values.tolist():
    daily_20150324_addname_dataframe[table_name] = daily_20150324[table_name]
print("日线行情-时间为序  daily_20150324 返回数据 row 行数 = "+str(daily_20150324.shape[0]))
daily_20150324_addname_dataframe.to_excel(daily_201503_excel_writer,'24_2',index=False)
daily_201503_excel_writer.save()
daily_20150325 = pro.daily(start_date='',end_date='',trade_date='20150325', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20150325_tscode_list = list() 
for ts_code_sh in daily_20150325['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20150325_tscode_list.append(stock_name)
daily_20150325_addname_dataframe=pd.DataFrame()
daily_20150325_addname_dataframe['cname'] = daily_20150325_tscode_list
for table_name in daily_20150325.columns.values.tolist():
    daily_20150325_addname_dataframe[table_name] = daily_20150325[table_name]
print("日线行情-时间为序  daily_20150325 返回数据 row 行数 = "+str(daily_20150325.shape[0]))
daily_20150325_addname_dataframe.to_excel(daily_201503_excel_writer,'25_3',index=False)
daily_201503_excel_writer.save()
daily_20150326 = pro.daily(start_date='',end_date='',trade_date='20150326', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20150326_tscode_list = list() 
for ts_code_sh in daily_20150326['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20150326_tscode_list.append(stock_name)
daily_20150326_addname_dataframe=pd.DataFrame()
daily_20150326_addname_dataframe['cname'] = daily_20150326_tscode_list
for table_name in daily_20150326.columns.values.tolist():
    daily_20150326_addname_dataframe[table_name] = daily_20150326[table_name]
print("日线行情-时间为序  daily_20150326 返回数据 row 行数 = "+str(daily_20150326.shape[0]))
daily_20150326_addname_dataframe.to_excel(daily_201503_excel_writer,'26_4',index=False)
daily_201503_excel_writer.save()
daily_20150327 = pro.daily(start_date='',end_date='',trade_date='20150327', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20150327_tscode_list = list() 
for ts_code_sh in daily_20150327['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20150327_tscode_list.append(stock_name)
daily_20150327_addname_dataframe=pd.DataFrame()
daily_20150327_addname_dataframe['cname'] = daily_20150327_tscode_list
for table_name in daily_20150327.columns.values.tolist():
    daily_20150327_addname_dataframe[table_name] = daily_20150327[table_name]
print("日线行情-时间为序  daily_20150327 返回数据 row 行数 = "+str(daily_20150327.shape[0]))
daily_20150327_addname_dataframe.to_excel(daily_201503_excel_writer,'27_5',index=False)
daily_201503_excel_writer.save()
daily_20150330 = pro.daily(start_date='',end_date='',trade_date='20150330', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20150330_tscode_list = list() 
for ts_code_sh in daily_20150330['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20150330_tscode_list.append(stock_name)
daily_20150330_addname_dataframe=pd.DataFrame()
daily_20150330_addname_dataframe['cname'] = daily_20150330_tscode_list
for table_name in daily_20150330.columns.values.tolist():
    daily_20150330_addname_dataframe[table_name] = daily_20150330[table_name]
print("日线行情-时间为序  daily_20150330 返回数据 row 行数 = "+str(daily_20150330.shape[0]))
daily_20150330_addname_dataframe.to_excel(daily_201503_excel_writer,'30_1',index=False)
daily_201503_excel_writer.save()
daily_20150331 = pro.daily(start_date='',end_date='',trade_date='20150331', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20150331_tscode_list = list() 
for ts_code_sh in daily_20150331['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20150331_tscode_list.append(stock_name)
daily_20150331_addname_dataframe=pd.DataFrame()
daily_20150331_addname_dataframe['cname'] = daily_20150331_tscode_list
for table_name in daily_20150331.columns.values.tolist():
    daily_20150331_addname_dataframe[table_name] = daily_20150331[table_name]
print("日线行情-时间为序  daily_20150331 返回数据 row 行数 = "+str(daily_20150331.shape[0]))
daily_20150331_addname_dataframe.to_excel(daily_201503_excel_writer,'31_2',index=False)
daily_201503_excel_writer.save()




createexcel('daily_201504.xlsx')
daily_201504_book = load_workbook('C:\\Users\\zhuzj5\\Desktop\\zbin\\J0_Data\\daily_201504.xlsx')
daily_201504_excel_writer = pd.ExcelWriter('C:\\Users\\zhuzj5\\Desktop\\zbin\\J0_Data\\daily_201504.xlsx', engine='openpyxl')
daily_201504_excel_writer.book = daily_201504_book
daily_201504_excel_writer.sheets = dict((ws.title, ws) for ws in daily_201504_book.worksheets)
J0_PROPS.put(tree_node_name+"record_date", "20150401")       ###  更新 记录日期
daily_20150401 = pro.daily(start_date='',end_date='',trade_date='20150401', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20150401_tscode_list = list() 
for ts_code_sh in daily_20150401['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20150401_tscode_list.append(stock_name)
daily_20150401_addname_dataframe=pd.DataFrame()
daily_20150401_addname_dataframe['cname'] = daily_20150401_tscode_list
for table_name in daily_20150401.columns.values.tolist():
    daily_20150401_addname_dataframe[table_name] = daily_20150401[table_name]
print("日线行情-时间为序  daily_20150401 返回数据 row 行数 = "+str(daily_20150401.shape[0]))
daily_20150401_addname_dataframe.to_excel(daily_201504_excel_writer,'1_3',index=False)
daily_201504_excel_writer.save()
daily_20150402 = pro.daily(start_date='',end_date='',trade_date='20150402', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20150402_tscode_list = list() 
for ts_code_sh in daily_20150402['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20150402_tscode_list.append(stock_name)
daily_20150402_addname_dataframe=pd.DataFrame()
daily_20150402_addname_dataframe['cname'] = daily_20150402_tscode_list
for table_name in daily_20150402.columns.values.tolist():
    daily_20150402_addname_dataframe[table_name] = daily_20150402[table_name]
print("日线行情-时间为序  daily_20150402 返回数据 row 行数 = "+str(daily_20150402.shape[0]))
daily_20150402_addname_dataframe.to_excel(daily_201504_excel_writer,'2_4',index=False)
daily_201504_excel_writer.save()
daily_20150403 = pro.daily(start_date='',end_date='',trade_date='20150403', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20150403_tscode_list = list() 
for ts_code_sh in daily_20150403['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20150403_tscode_list.append(stock_name)
daily_20150403_addname_dataframe=pd.DataFrame()
daily_20150403_addname_dataframe['cname'] = daily_20150403_tscode_list
for table_name in daily_20150403.columns.values.tolist():
    daily_20150403_addname_dataframe[table_name] = daily_20150403[table_name]
print("日线行情-时间为序  daily_20150403 返回数据 row 行数 = "+str(daily_20150403.shape[0]))
daily_20150403_addname_dataframe.to_excel(daily_201504_excel_writer,'3_5',index=False)
daily_201504_excel_writer.save()
daily_20150407 = pro.daily(start_date='',end_date='',trade_date='20150407', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20150407_tscode_list = list() 
for ts_code_sh in daily_20150407['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20150407_tscode_list.append(stock_name)
daily_20150407_addname_dataframe=pd.DataFrame()
daily_20150407_addname_dataframe['cname'] = daily_20150407_tscode_list
for table_name in daily_20150407.columns.values.tolist():
    daily_20150407_addname_dataframe[table_name] = daily_20150407[table_name]
print("日线行情-时间为序  daily_20150407 返回数据 row 行数 = "+str(daily_20150407.shape[0]))
daily_20150407_addname_dataframe.to_excel(daily_201504_excel_writer,'7_2',index=False)
daily_201504_excel_writer.save()
daily_20150408 = pro.daily(start_date='',end_date='',trade_date='20150408', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20150408_tscode_list = list() 
for ts_code_sh in daily_20150408['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20150408_tscode_list.append(stock_name)
daily_20150408_addname_dataframe=pd.DataFrame()
daily_20150408_addname_dataframe['cname'] = daily_20150408_tscode_list
for table_name in daily_20150408.columns.values.tolist():
    daily_20150408_addname_dataframe[table_name] = daily_20150408[table_name]
print("日线行情-时间为序  daily_20150408 返回数据 row 行数 = "+str(daily_20150408.shape[0]))
daily_20150408_addname_dataframe.to_excel(daily_201504_excel_writer,'8_3',index=False)
daily_201504_excel_writer.save()
daily_20150409 = pro.daily(start_date='',end_date='',trade_date='20150409', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20150409_tscode_list = list() 
for ts_code_sh in daily_20150409['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20150409_tscode_list.append(stock_name)
daily_20150409_addname_dataframe=pd.DataFrame()
daily_20150409_addname_dataframe['cname'] = daily_20150409_tscode_list
for table_name in daily_20150409.columns.values.tolist():
    daily_20150409_addname_dataframe[table_name] = daily_20150409[table_name]
print("日线行情-时间为序  daily_20150409 返回数据 row 行数 = "+str(daily_20150409.shape[0]))
daily_20150409_addname_dataframe.to_excel(daily_201504_excel_writer,'9_4',index=False)
daily_201504_excel_writer.save()
daily_20150410 = pro.daily(start_date='',end_date='',trade_date='20150410', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20150410_tscode_list = list() 
for ts_code_sh in daily_20150410['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20150410_tscode_list.append(stock_name)
daily_20150410_addname_dataframe=pd.DataFrame()
daily_20150410_addname_dataframe['cname'] = daily_20150410_tscode_list
for table_name in daily_20150410.columns.values.tolist():
    daily_20150410_addname_dataframe[table_name] = daily_20150410[table_name]
print("日线行情-时间为序  daily_20150410 返回数据 row 行数 = "+str(daily_20150410.shape[0]))
daily_20150410_addname_dataframe.to_excel(daily_201504_excel_writer,'10_5',index=False)
daily_201504_excel_writer.save()
daily_20150413 = pro.daily(start_date='',end_date='',trade_date='20150413', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20150413_tscode_list = list() 
for ts_code_sh in daily_20150413['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20150413_tscode_list.append(stock_name)
daily_20150413_addname_dataframe=pd.DataFrame()
daily_20150413_addname_dataframe['cname'] = daily_20150413_tscode_list
for table_name in daily_20150413.columns.values.tolist():
    daily_20150413_addname_dataframe[table_name] = daily_20150413[table_name]
print("日线行情-时间为序  daily_20150413 返回数据 row 行数 = "+str(daily_20150413.shape[0]))
daily_20150413_addname_dataframe.to_excel(daily_201504_excel_writer,'13_1',index=False)
daily_201504_excel_writer.save()
daily_20150414 = pro.daily(start_date='',end_date='',trade_date='20150414', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20150414_tscode_list = list() 
for ts_code_sh in daily_20150414['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20150414_tscode_list.append(stock_name)
daily_20150414_addname_dataframe=pd.DataFrame()
daily_20150414_addname_dataframe['cname'] = daily_20150414_tscode_list
for table_name in daily_20150414.columns.values.tolist():
    daily_20150414_addname_dataframe[table_name] = daily_20150414[table_name]
print("日线行情-时间为序  daily_20150414 返回数据 row 行数 = "+str(daily_20150414.shape[0]))
daily_20150414_addname_dataframe.to_excel(daily_201504_excel_writer,'14_2',index=False)
daily_201504_excel_writer.save()
daily_20150415 = pro.daily(start_date='',end_date='',trade_date='20150415', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20150415_tscode_list = list() 
for ts_code_sh in daily_20150415['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20150415_tscode_list.append(stock_name)
daily_20150415_addname_dataframe=pd.DataFrame()
daily_20150415_addname_dataframe['cname'] = daily_20150415_tscode_list
for table_name in daily_20150415.columns.values.tolist():
    daily_20150415_addname_dataframe[table_name] = daily_20150415[table_name]
print("日线行情-时间为序  daily_20150415 返回数据 row 行数 = "+str(daily_20150415.shape[0]))
daily_20150415_addname_dataframe.to_excel(daily_201504_excel_writer,'15_3',index=False)
daily_201504_excel_writer.save()
daily_20150416 = pro.daily(start_date='',end_date='',trade_date='20150416', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20150416_tscode_list = list() 
for ts_code_sh in daily_20150416['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20150416_tscode_list.append(stock_name)
daily_20150416_addname_dataframe=pd.DataFrame()
daily_20150416_addname_dataframe['cname'] = daily_20150416_tscode_list
for table_name in daily_20150416.columns.values.tolist():
    daily_20150416_addname_dataframe[table_name] = daily_20150416[table_name]
print("日线行情-时间为序  daily_20150416 返回数据 row 行数 = "+str(daily_20150416.shape[0]))
daily_20150416_addname_dataframe.to_excel(daily_201504_excel_writer,'16_4',index=False)
daily_201504_excel_writer.save()
daily_20150417 = pro.daily(start_date='',end_date='',trade_date='20150417', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20150417_tscode_list = list() 
for ts_code_sh in daily_20150417['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20150417_tscode_list.append(stock_name)
daily_20150417_addname_dataframe=pd.DataFrame()
daily_20150417_addname_dataframe['cname'] = daily_20150417_tscode_list
for table_name in daily_20150417.columns.values.tolist():
    daily_20150417_addname_dataframe[table_name] = daily_20150417[table_name]
print("日线行情-时间为序  daily_20150417 返回数据 row 行数 = "+str(daily_20150417.shape[0]))
daily_20150417_addname_dataframe.to_excel(daily_201504_excel_writer,'17_5',index=False)
daily_201504_excel_writer.save()
daily_20150420 = pro.daily(start_date='',end_date='',trade_date='20150420', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20150420_tscode_list = list() 
for ts_code_sh in daily_20150420['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20150420_tscode_list.append(stock_name)
daily_20150420_addname_dataframe=pd.DataFrame()
daily_20150420_addname_dataframe['cname'] = daily_20150420_tscode_list
for table_name in daily_20150420.columns.values.tolist():
    daily_20150420_addname_dataframe[table_name] = daily_20150420[table_name]
print("日线行情-时间为序  daily_20150420 返回数据 row 行数 = "+str(daily_20150420.shape[0]))
daily_20150420_addname_dataframe.to_excel(daily_201504_excel_writer,'20_1',index=False)
daily_201504_excel_writer.save()
daily_20150421 = pro.daily(start_date='',end_date='',trade_date='20150421', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20150421_tscode_list = list() 
for ts_code_sh in daily_20150421['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20150421_tscode_list.append(stock_name)
daily_20150421_addname_dataframe=pd.DataFrame()
daily_20150421_addname_dataframe['cname'] = daily_20150421_tscode_list
for table_name in daily_20150421.columns.values.tolist():
    daily_20150421_addname_dataframe[table_name] = daily_20150421[table_name]
print("日线行情-时间为序  daily_20150421 返回数据 row 行数 = "+str(daily_20150421.shape[0]))
daily_20150421_addname_dataframe.to_excel(daily_201504_excel_writer,'21_2',index=False)
daily_201504_excel_writer.save()
daily_20150422 = pro.daily(start_date='',end_date='',trade_date='20150422', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20150422_tscode_list = list() 
for ts_code_sh in daily_20150422['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20150422_tscode_list.append(stock_name)
daily_20150422_addname_dataframe=pd.DataFrame()
daily_20150422_addname_dataframe['cname'] = daily_20150422_tscode_list
for table_name in daily_20150422.columns.values.tolist():
    daily_20150422_addname_dataframe[table_name] = daily_20150422[table_name]
print("日线行情-时间为序  daily_20150422 返回数据 row 行数 = "+str(daily_20150422.shape[0]))
daily_20150422_addname_dataframe.to_excel(daily_201504_excel_writer,'22_3',index=False)
daily_201504_excel_writer.save()
daily_20150423 = pro.daily(start_date='',end_date='',trade_date='20150423', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20150423_tscode_list = list() 
for ts_code_sh in daily_20150423['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20150423_tscode_list.append(stock_name)
daily_20150423_addname_dataframe=pd.DataFrame()
daily_20150423_addname_dataframe['cname'] = daily_20150423_tscode_list
for table_name in daily_20150423.columns.values.tolist():
    daily_20150423_addname_dataframe[table_name] = daily_20150423[table_name]
print("日线行情-时间为序  daily_20150423 返回数据 row 行数 = "+str(daily_20150423.shape[0]))
daily_20150423_addname_dataframe.to_excel(daily_201504_excel_writer,'23_4',index=False)
daily_201504_excel_writer.save()
daily_20150424 = pro.daily(start_date='',end_date='',trade_date='20150424', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20150424_tscode_list = list() 
for ts_code_sh in daily_20150424['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20150424_tscode_list.append(stock_name)
daily_20150424_addname_dataframe=pd.DataFrame()
daily_20150424_addname_dataframe['cname'] = daily_20150424_tscode_list
for table_name in daily_20150424.columns.values.tolist():
    daily_20150424_addname_dataframe[table_name] = daily_20150424[table_name]
print("日线行情-时间为序  daily_20150424 返回数据 row 行数 = "+str(daily_20150424.shape[0]))
daily_20150424_addname_dataframe.to_excel(daily_201504_excel_writer,'24_5',index=False)
daily_201504_excel_writer.save()
daily_20150427 = pro.daily(start_date='',end_date='',trade_date='20150427', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20150427_tscode_list = list() 
for ts_code_sh in daily_20150427['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20150427_tscode_list.append(stock_name)
daily_20150427_addname_dataframe=pd.DataFrame()
daily_20150427_addname_dataframe['cname'] = daily_20150427_tscode_list
for table_name in daily_20150427.columns.values.tolist():
    daily_20150427_addname_dataframe[table_name] = daily_20150427[table_name]
print("日线行情-时间为序  daily_20150427 返回数据 row 行数 = "+str(daily_20150427.shape[0]))
daily_20150427_addname_dataframe.to_excel(daily_201504_excel_writer,'27_1',index=False)
daily_201504_excel_writer.save()
daily_20150428 = pro.daily(start_date='',end_date='',trade_date='20150428', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20150428_tscode_list = list() 
for ts_code_sh in daily_20150428['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20150428_tscode_list.append(stock_name)
daily_20150428_addname_dataframe=pd.DataFrame()
daily_20150428_addname_dataframe['cname'] = daily_20150428_tscode_list
for table_name in daily_20150428.columns.values.tolist():
    daily_20150428_addname_dataframe[table_name] = daily_20150428[table_name]
print("日线行情-时间为序  daily_20150428 返回数据 row 行数 = "+str(daily_20150428.shape[0]))
daily_20150428_addname_dataframe.to_excel(daily_201504_excel_writer,'28_2',index=False)
daily_201504_excel_writer.save()
daily_20150429 = pro.daily(start_date='',end_date='',trade_date='20150429', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20150429_tscode_list = list() 
for ts_code_sh in daily_20150429['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20150429_tscode_list.append(stock_name)
daily_20150429_addname_dataframe=pd.DataFrame()
daily_20150429_addname_dataframe['cname'] = daily_20150429_tscode_list
for table_name in daily_20150429.columns.values.tolist():
    daily_20150429_addname_dataframe[table_name] = daily_20150429[table_name]
print("日线行情-时间为序  daily_20150429 返回数据 row 行数 = "+str(daily_20150429.shape[0]))
daily_20150429_addname_dataframe.to_excel(daily_201504_excel_writer,'29_3',index=False)
daily_201504_excel_writer.save()
daily_20150430 = pro.daily(start_date='',end_date='',trade_date='20150430', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20150430_tscode_list = list() 
for ts_code_sh in daily_20150430['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20150430_tscode_list.append(stock_name)
daily_20150430_addname_dataframe=pd.DataFrame()
daily_20150430_addname_dataframe['cname'] = daily_20150430_tscode_list
for table_name in daily_20150430.columns.values.tolist():
    daily_20150430_addname_dataframe[table_name] = daily_20150430[table_name]
print("日线行情-时间为序  daily_20150430 返回数据 row 行数 = "+str(daily_20150430.shape[0]))
daily_20150430_addname_dataframe.to_excel(daily_201504_excel_writer,'30_4',index=False)
daily_201504_excel_writer.save()




createexcel('daily_201505.xlsx')
daily_201505_book = load_workbook('C:\\Users\\zhuzj5\\Desktop\\zbin\\J0_Data\\daily_201505.xlsx')
daily_201505_excel_writer = pd.ExcelWriter('C:\\Users\\zhuzj5\\Desktop\\zbin\\J0_Data\\daily_201505.xlsx', engine='openpyxl')
daily_201505_excel_writer.book = daily_201505_book
daily_201505_excel_writer.sheets = dict((ws.title, ws) for ws in daily_201505_book.worksheets)
J0_PROPS.put(tree_node_name+"record_date", "20150501")       ###  更新 记录日期
daily_20150504 = pro.daily(start_date='',end_date='',trade_date='20150504', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20150504_tscode_list = list() 
for ts_code_sh in daily_20150504['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20150504_tscode_list.append(stock_name)
daily_20150504_addname_dataframe=pd.DataFrame()
daily_20150504_addname_dataframe['cname'] = daily_20150504_tscode_list
for table_name in daily_20150504.columns.values.tolist():
    daily_20150504_addname_dataframe[table_name] = daily_20150504[table_name]
print("日线行情-时间为序  daily_20150504 返回数据 row 行数 = "+str(daily_20150504.shape[0]))
daily_20150504_addname_dataframe.to_excel(daily_201505_excel_writer,'4_1',index=False)
daily_201505_excel_writer.save()
daily_20150505 = pro.daily(start_date='',end_date='',trade_date='20150505', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20150505_tscode_list = list() 
for ts_code_sh in daily_20150505['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20150505_tscode_list.append(stock_name)
daily_20150505_addname_dataframe=pd.DataFrame()
daily_20150505_addname_dataframe['cname'] = daily_20150505_tscode_list
for table_name in daily_20150505.columns.values.tolist():
    daily_20150505_addname_dataframe[table_name] = daily_20150505[table_name]
print("日线行情-时间为序  daily_20150505 返回数据 row 行数 = "+str(daily_20150505.shape[0]))
daily_20150505_addname_dataframe.to_excel(daily_201505_excel_writer,'5_2',index=False)
daily_201505_excel_writer.save()
daily_20150506 = pro.daily(start_date='',end_date='',trade_date='20150506', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20150506_tscode_list = list() 
for ts_code_sh in daily_20150506['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20150506_tscode_list.append(stock_name)
daily_20150506_addname_dataframe=pd.DataFrame()
daily_20150506_addname_dataframe['cname'] = daily_20150506_tscode_list
for table_name in daily_20150506.columns.values.tolist():
    daily_20150506_addname_dataframe[table_name] = daily_20150506[table_name]
print("日线行情-时间为序  daily_20150506 返回数据 row 行数 = "+str(daily_20150506.shape[0]))
daily_20150506_addname_dataframe.to_excel(daily_201505_excel_writer,'6_3',index=False)
daily_201505_excel_writer.save()
daily_20150507 = pro.daily(start_date='',end_date='',trade_date='20150507', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20150507_tscode_list = list() 
for ts_code_sh in daily_20150507['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20150507_tscode_list.append(stock_name)
daily_20150507_addname_dataframe=pd.DataFrame()
daily_20150507_addname_dataframe['cname'] = daily_20150507_tscode_list
for table_name in daily_20150507.columns.values.tolist():
    daily_20150507_addname_dataframe[table_name] = daily_20150507[table_name]
print("日线行情-时间为序  daily_20150507 返回数据 row 行数 = "+str(daily_20150507.shape[0]))
daily_20150507_addname_dataframe.to_excel(daily_201505_excel_writer,'7_4',index=False)
daily_201505_excel_writer.save()
daily_20150508 = pro.daily(start_date='',end_date='',trade_date='20150508', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20150508_tscode_list = list() 
for ts_code_sh in daily_20150508['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20150508_tscode_list.append(stock_name)
daily_20150508_addname_dataframe=pd.DataFrame()
daily_20150508_addname_dataframe['cname'] = daily_20150508_tscode_list
for table_name in daily_20150508.columns.values.tolist():
    daily_20150508_addname_dataframe[table_name] = daily_20150508[table_name]
print("日线行情-时间为序  daily_20150508 返回数据 row 行数 = "+str(daily_20150508.shape[0]))
daily_20150508_addname_dataframe.to_excel(daily_201505_excel_writer,'8_5',index=False)
daily_201505_excel_writer.save()
daily_20150511 = pro.daily(start_date='',end_date='',trade_date='20150511', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20150511_tscode_list = list() 
for ts_code_sh in daily_20150511['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20150511_tscode_list.append(stock_name)
daily_20150511_addname_dataframe=pd.DataFrame()
daily_20150511_addname_dataframe['cname'] = daily_20150511_tscode_list
for table_name in daily_20150511.columns.values.tolist():
    daily_20150511_addname_dataframe[table_name] = daily_20150511[table_name]
print("日线行情-时间为序  daily_20150511 返回数据 row 行数 = "+str(daily_20150511.shape[0]))
daily_20150511_addname_dataframe.to_excel(daily_201505_excel_writer,'11_1',index=False)
daily_201505_excel_writer.save()
daily_20150512 = pro.daily(start_date='',end_date='',trade_date='20150512', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20150512_tscode_list = list() 
for ts_code_sh in daily_20150512['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20150512_tscode_list.append(stock_name)
daily_20150512_addname_dataframe=pd.DataFrame()
daily_20150512_addname_dataframe['cname'] = daily_20150512_tscode_list
for table_name in daily_20150512.columns.values.tolist():
    daily_20150512_addname_dataframe[table_name] = daily_20150512[table_name]
print("日线行情-时间为序  daily_20150512 返回数据 row 行数 = "+str(daily_20150512.shape[0]))
daily_20150512_addname_dataframe.to_excel(daily_201505_excel_writer,'12_2',index=False)
daily_201505_excel_writer.save()
daily_20150513 = pro.daily(start_date='',end_date='',trade_date='20150513', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20150513_tscode_list = list() 
for ts_code_sh in daily_20150513['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20150513_tscode_list.append(stock_name)
daily_20150513_addname_dataframe=pd.DataFrame()
daily_20150513_addname_dataframe['cname'] = daily_20150513_tscode_list
for table_name in daily_20150513.columns.values.tolist():
    daily_20150513_addname_dataframe[table_name] = daily_20150513[table_name]
print("日线行情-时间为序  daily_20150513 返回数据 row 行数 = "+str(daily_20150513.shape[0]))
daily_20150513_addname_dataframe.to_excel(daily_201505_excel_writer,'13_3',index=False)
daily_201505_excel_writer.save()
daily_20150514 = pro.daily(start_date='',end_date='',trade_date='20150514', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20150514_tscode_list = list() 
for ts_code_sh in daily_20150514['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20150514_tscode_list.append(stock_name)
daily_20150514_addname_dataframe=pd.DataFrame()
daily_20150514_addname_dataframe['cname'] = daily_20150514_tscode_list
for table_name in daily_20150514.columns.values.tolist():
    daily_20150514_addname_dataframe[table_name] = daily_20150514[table_name]
print("日线行情-时间为序  daily_20150514 返回数据 row 行数 = "+str(daily_20150514.shape[0]))
daily_20150514_addname_dataframe.to_excel(daily_201505_excel_writer,'14_4',index=False)
daily_201505_excel_writer.save()
daily_20150515 = pro.daily(start_date='',end_date='',trade_date='20150515', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20150515_tscode_list = list() 
for ts_code_sh in daily_20150515['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20150515_tscode_list.append(stock_name)
daily_20150515_addname_dataframe=pd.DataFrame()
daily_20150515_addname_dataframe['cname'] = daily_20150515_tscode_list
for table_name in daily_20150515.columns.values.tolist():
    daily_20150515_addname_dataframe[table_name] = daily_20150515[table_name]
print("日线行情-时间为序  daily_20150515 返回数据 row 行数 = "+str(daily_20150515.shape[0]))
daily_20150515_addname_dataframe.to_excel(daily_201505_excel_writer,'15_5',index=False)
daily_201505_excel_writer.save()
daily_20150518 = pro.daily(start_date='',end_date='',trade_date='20150518', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20150518_tscode_list = list() 
for ts_code_sh in daily_20150518['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20150518_tscode_list.append(stock_name)
daily_20150518_addname_dataframe=pd.DataFrame()
daily_20150518_addname_dataframe['cname'] = daily_20150518_tscode_list
for table_name in daily_20150518.columns.values.tolist():
    daily_20150518_addname_dataframe[table_name] = daily_20150518[table_name]
print("日线行情-时间为序  daily_20150518 返回数据 row 行数 = "+str(daily_20150518.shape[0]))
daily_20150518_addname_dataframe.to_excel(daily_201505_excel_writer,'18_1',index=False)
daily_201505_excel_writer.save()
daily_20150519 = pro.daily(start_date='',end_date='',trade_date='20150519', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20150519_tscode_list = list() 
for ts_code_sh in daily_20150519['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20150519_tscode_list.append(stock_name)
daily_20150519_addname_dataframe=pd.DataFrame()
daily_20150519_addname_dataframe['cname'] = daily_20150519_tscode_list
for table_name in daily_20150519.columns.values.tolist():
    daily_20150519_addname_dataframe[table_name] = daily_20150519[table_name]
print("日线行情-时间为序  daily_20150519 返回数据 row 行数 = "+str(daily_20150519.shape[0]))
daily_20150519_addname_dataframe.to_excel(daily_201505_excel_writer,'19_2',index=False)
daily_201505_excel_writer.save()
daily_20150520 = pro.daily(start_date='',end_date='',trade_date='20150520', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20150520_tscode_list = list() 
for ts_code_sh in daily_20150520['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20150520_tscode_list.append(stock_name)
daily_20150520_addname_dataframe=pd.DataFrame()
daily_20150520_addname_dataframe['cname'] = daily_20150520_tscode_list
for table_name in daily_20150520.columns.values.tolist():
    daily_20150520_addname_dataframe[table_name] = daily_20150520[table_name]
print("日线行情-时间为序  daily_20150520 返回数据 row 行数 = "+str(daily_20150520.shape[0]))
daily_20150520_addname_dataframe.to_excel(daily_201505_excel_writer,'20_3',index=False)
daily_201505_excel_writer.save()
daily_20150521 = pro.daily(start_date='',end_date='',trade_date='20150521', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20150521_tscode_list = list() 
for ts_code_sh in daily_20150521['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20150521_tscode_list.append(stock_name)
daily_20150521_addname_dataframe=pd.DataFrame()
daily_20150521_addname_dataframe['cname'] = daily_20150521_tscode_list
for table_name in daily_20150521.columns.values.tolist():
    daily_20150521_addname_dataframe[table_name] = daily_20150521[table_name]
print("日线行情-时间为序  daily_20150521 返回数据 row 行数 = "+str(daily_20150521.shape[0]))
daily_20150521_addname_dataframe.to_excel(daily_201505_excel_writer,'21_4',index=False)
daily_201505_excel_writer.save()
daily_20150522 = pro.daily(start_date='',end_date='',trade_date='20150522', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20150522_tscode_list = list() 
for ts_code_sh in daily_20150522['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20150522_tscode_list.append(stock_name)
daily_20150522_addname_dataframe=pd.DataFrame()
daily_20150522_addname_dataframe['cname'] = daily_20150522_tscode_list
for table_name in daily_20150522.columns.values.tolist():
    daily_20150522_addname_dataframe[table_name] = daily_20150522[table_name]
print("日线行情-时间为序  daily_20150522 返回数据 row 行数 = "+str(daily_20150522.shape[0]))
daily_20150522_addname_dataframe.to_excel(daily_201505_excel_writer,'22_5',index=False)
daily_201505_excel_writer.save()
daily_20150525 = pro.daily(start_date='',end_date='',trade_date='20150525', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20150525_tscode_list = list() 
for ts_code_sh in daily_20150525['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20150525_tscode_list.append(stock_name)
daily_20150525_addname_dataframe=pd.DataFrame()
daily_20150525_addname_dataframe['cname'] = daily_20150525_tscode_list
for table_name in daily_20150525.columns.values.tolist():
    daily_20150525_addname_dataframe[table_name] = daily_20150525[table_name]
print("日线行情-时间为序  daily_20150525 返回数据 row 行数 = "+str(daily_20150525.shape[0]))
daily_20150525_addname_dataframe.to_excel(daily_201505_excel_writer,'25_1',index=False)
daily_201505_excel_writer.save()
daily_20150526 = pro.daily(start_date='',end_date='',trade_date='20150526', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20150526_tscode_list = list() 
for ts_code_sh in daily_20150526['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20150526_tscode_list.append(stock_name)
daily_20150526_addname_dataframe=pd.DataFrame()
daily_20150526_addname_dataframe['cname'] = daily_20150526_tscode_list
for table_name in daily_20150526.columns.values.tolist():
    daily_20150526_addname_dataframe[table_name] = daily_20150526[table_name]
print("日线行情-时间为序  daily_20150526 返回数据 row 行数 = "+str(daily_20150526.shape[0]))
daily_20150526_addname_dataframe.to_excel(daily_201505_excel_writer,'26_2',index=False)
daily_201505_excel_writer.save()
daily_20150527 = pro.daily(start_date='',end_date='',trade_date='20150527', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20150527_tscode_list = list() 
for ts_code_sh in daily_20150527['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20150527_tscode_list.append(stock_name)
daily_20150527_addname_dataframe=pd.DataFrame()
daily_20150527_addname_dataframe['cname'] = daily_20150527_tscode_list
for table_name in daily_20150527.columns.values.tolist():
    daily_20150527_addname_dataframe[table_name] = daily_20150527[table_name]
print("日线行情-时间为序  daily_20150527 返回数据 row 行数 = "+str(daily_20150527.shape[0]))
daily_20150527_addname_dataframe.to_excel(daily_201505_excel_writer,'27_3',index=False)
daily_201505_excel_writer.save()
daily_20150528 = pro.daily(start_date='',end_date='',trade_date='20150528', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20150528_tscode_list = list() 
for ts_code_sh in daily_20150528['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20150528_tscode_list.append(stock_name)
daily_20150528_addname_dataframe=pd.DataFrame()
daily_20150528_addname_dataframe['cname'] = daily_20150528_tscode_list
for table_name in daily_20150528.columns.values.tolist():
    daily_20150528_addname_dataframe[table_name] = daily_20150528[table_name]
print("日线行情-时间为序  daily_20150528 返回数据 row 行数 = "+str(daily_20150528.shape[0]))
daily_20150528_addname_dataframe.to_excel(daily_201505_excel_writer,'28_4',index=False)
daily_201505_excel_writer.save()
daily_20150529 = pro.daily(start_date='',end_date='',trade_date='20150529', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20150529_tscode_list = list() 
for ts_code_sh in daily_20150529['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20150529_tscode_list.append(stock_name)
daily_20150529_addname_dataframe=pd.DataFrame()
daily_20150529_addname_dataframe['cname'] = daily_20150529_tscode_list
for table_name in daily_20150529.columns.values.tolist():
    daily_20150529_addname_dataframe[table_name] = daily_20150529[table_name]
print("日线行情-时间为序  daily_20150529 返回数据 row 行数 = "+str(daily_20150529.shape[0]))
daily_20150529_addname_dataframe.to_excel(daily_201505_excel_writer,'29_5',index=False)
daily_201505_excel_writer.save()




createexcel('daily_201506.xlsx')
daily_201506_book = load_workbook('C:\\Users\\zhuzj5\\Desktop\\zbin\\J0_Data\\daily_201506.xlsx')
daily_201506_excel_writer = pd.ExcelWriter('C:\\Users\\zhuzj5\\Desktop\\zbin\\J0_Data\\daily_201506.xlsx', engine='openpyxl')
daily_201506_excel_writer.book = daily_201506_book
daily_201506_excel_writer.sheets = dict((ws.title, ws) for ws in daily_201506_book.worksheets)
J0_PROPS.put(tree_node_name+"record_date", "20150601")       ###  更新 记录日期
daily_20150601 = pro.daily(start_date='',end_date='',trade_date='20150601', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20150601_tscode_list = list() 
for ts_code_sh in daily_20150601['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20150601_tscode_list.append(stock_name)
daily_20150601_addname_dataframe=pd.DataFrame()
daily_20150601_addname_dataframe['cname'] = daily_20150601_tscode_list
for table_name in daily_20150601.columns.values.tolist():
    daily_20150601_addname_dataframe[table_name] = daily_20150601[table_name]
print("日线行情-时间为序  daily_20150601 返回数据 row 行数 = "+str(daily_20150601.shape[0]))
daily_20150601_addname_dataframe.to_excel(daily_201506_excel_writer,'1_1',index=False)
daily_201506_excel_writer.save()
daily_20150602 = pro.daily(start_date='',end_date='',trade_date='20150602', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20150602_tscode_list = list() 
for ts_code_sh in daily_20150602['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20150602_tscode_list.append(stock_name)
daily_20150602_addname_dataframe=pd.DataFrame()
daily_20150602_addname_dataframe['cname'] = daily_20150602_tscode_list
for table_name in daily_20150602.columns.values.tolist():
    daily_20150602_addname_dataframe[table_name] = daily_20150602[table_name]
print("日线行情-时间为序  daily_20150602 返回数据 row 行数 = "+str(daily_20150602.shape[0]))
daily_20150602_addname_dataframe.to_excel(daily_201506_excel_writer,'2_2',index=False)
daily_201506_excel_writer.save()
daily_20150603 = pro.daily(start_date='',end_date='',trade_date='20150603', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20150603_tscode_list = list() 
for ts_code_sh in daily_20150603['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20150603_tscode_list.append(stock_name)
daily_20150603_addname_dataframe=pd.DataFrame()
daily_20150603_addname_dataframe['cname'] = daily_20150603_tscode_list
for table_name in daily_20150603.columns.values.tolist():
    daily_20150603_addname_dataframe[table_name] = daily_20150603[table_name]
print("日线行情-时间为序  daily_20150603 返回数据 row 行数 = "+str(daily_20150603.shape[0]))
daily_20150603_addname_dataframe.to_excel(daily_201506_excel_writer,'3_3',index=False)
daily_201506_excel_writer.save()
daily_20150604 = pro.daily(start_date='',end_date='',trade_date='20150604', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20150604_tscode_list = list() 
for ts_code_sh in daily_20150604['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20150604_tscode_list.append(stock_name)
daily_20150604_addname_dataframe=pd.DataFrame()
daily_20150604_addname_dataframe['cname'] = daily_20150604_tscode_list
for table_name in daily_20150604.columns.values.tolist():
    daily_20150604_addname_dataframe[table_name] = daily_20150604[table_name]
print("日线行情-时间为序  daily_20150604 返回数据 row 行数 = "+str(daily_20150604.shape[0]))
daily_20150604_addname_dataframe.to_excel(daily_201506_excel_writer,'4_4',index=False)
daily_201506_excel_writer.save()
daily_20150605 = pro.daily(start_date='',end_date='',trade_date='20150605', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20150605_tscode_list = list() 
for ts_code_sh in daily_20150605['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20150605_tscode_list.append(stock_name)
daily_20150605_addname_dataframe=pd.DataFrame()
daily_20150605_addname_dataframe['cname'] = daily_20150605_tscode_list
for table_name in daily_20150605.columns.values.tolist():
    daily_20150605_addname_dataframe[table_name] = daily_20150605[table_name]
print("日线行情-时间为序  daily_20150605 返回数据 row 行数 = "+str(daily_20150605.shape[0]))
daily_20150605_addname_dataframe.to_excel(daily_201506_excel_writer,'5_5',index=False)
daily_201506_excel_writer.save()
daily_20150608 = pro.daily(start_date='',end_date='',trade_date='20150608', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20150608_tscode_list = list() 
for ts_code_sh in daily_20150608['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20150608_tscode_list.append(stock_name)
daily_20150608_addname_dataframe=pd.DataFrame()
daily_20150608_addname_dataframe['cname'] = daily_20150608_tscode_list
for table_name in daily_20150608.columns.values.tolist():
    daily_20150608_addname_dataframe[table_name] = daily_20150608[table_name]
print("日线行情-时间为序  daily_20150608 返回数据 row 行数 = "+str(daily_20150608.shape[0]))
daily_20150608_addname_dataframe.to_excel(daily_201506_excel_writer,'8_1',index=False)
daily_201506_excel_writer.save()
daily_20150609 = pro.daily(start_date='',end_date='',trade_date='20150609', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20150609_tscode_list = list() 
for ts_code_sh in daily_20150609['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20150609_tscode_list.append(stock_name)
daily_20150609_addname_dataframe=pd.DataFrame()
daily_20150609_addname_dataframe['cname'] = daily_20150609_tscode_list
for table_name in daily_20150609.columns.values.tolist():
    daily_20150609_addname_dataframe[table_name] = daily_20150609[table_name]
print("日线行情-时间为序  daily_20150609 返回数据 row 行数 = "+str(daily_20150609.shape[0]))
daily_20150609_addname_dataframe.to_excel(daily_201506_excel_writer,'9_2',index=False)
daily_201506_excel_writer.save()
daily_20150610 = pro.daily(start_date='',end_date='',trade_date='20150610', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20150610_tscode_list = list() 
for ts_code_sh in daily_20150610['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20150610_tscode_list.append(stock_name)
daily_20150610_addname_dataframe=pd.DataFrame()
daily_20150610_addname_dataframe['cname'] = daily_20150610_tscode_list
for table_name in daily_20150610.columns.values.tolist():
    daily_20150610_addname_dataframe[table_name] = daily_20150610[table_name]
print("日线行情-时间为序  daily_20150610 返回数据 row 行数 = "+str(daily_20150610.shape[0]))
daily_20150610_addname_dataframe.to_excel(daily_201506_excel_writer,'10_3',index=False)
daily_201506_excel_writer.save()
daily_20150611 = pro.daily(start_date='',end_date='',trade_date='20150611', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20150611_tscode_list = list() 
for ts_code_sh in daily_20150611['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20150611_tscode_list.append(stock_name)
daily_20150611_addname_dataframe=pd.DataFrame()
daily_20150611_addname_dataframe['cname'] = daily_20150611_tscode_list
for table_name in daily_20150611.columns.values.tolist():
    daily_20150611_addname_dataframe[table_name] = daily_20150611[table_name]
print("日线行情-时间为序  daily_20150611 返回数据 row 行数 = "+str(daily_20150611.shape[0]))
daily_20150611_addname_dataframe.to_excel(daily_201506_excel_writer,'11_4',index=False)
daily_201506_excel_writer.save()
daily_20150612 = pro.daily(start_date='',end_date='',trade_date='20150612', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20150612_tscode_list = list() 
for ts_code_sh in daily_20150612['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20150612_tscode_list.append(stock_name)
daily_20150612_addname_dataframe=pd.DataFrame()
daily_20150612_addname_dataframe['cname'] = daily_20150612_tscode_list
for table_name in daily_20150612.columns.values.tolist():
    daily_20150612_addname_dataframe[table_name] = daily_20150612[table_name]
print("日线行情-时间为序  daily_20150612 返回数据 row 行数 = "+str(daily_20150612.shape[0]))
daily_20150612_addname_dataframe.to_excel(daily_201506_excel_writer,'12_5',index=False)
daily_201506_excel_writer.save()
daily_20150615 = pro.daily(start_date='',end_date='',trade_date='20150615', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20150615_tscode_list = list() 
for ts_code_sh in daily_20150615['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20150615_tscode_list.append(stock_name)
daily_20150615_addname_dataframe=pd.DataFrame()
daily_20150615_addname_dataframe['cname'] = daily_20150615_tscode_list
for table_name in daily_20150615.columns.values.tolist():
    daily_20150615_addname_dataframe[table_name] = daily_20150615[table_name]
print("日线行情-时间为序  daily_20150615 返回数据 row 行数 = "+str(daily_20150615.shape[0]))
daily_20150615_addname_dataframe.to_excel(daily_201506_excel_writer,'15_1',index=False)
daily_201506_excel_writer.save()
daily_20150616 = pro.daily(start_date='',end_date='',trade_date='20150616', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20150616_tscode_list = list() 
for ts_code_sh in daily_20150616['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20150616_tscode_list.append(stock_name)
daily_20150616_addname_dataframe=pd.DataFrame()
daily_20150616_addname_dataframe['cname'] = daily_20150616_tscode_list
for table_name in daily_20150616.columns.values.tolist():
    daily_20150616_addname_dataframe[table_name] = daily_20150616[table_name]
print("日线行情-时间为序  daily_20150616 返回数据 row 行数 = "+str(daily_20150616.shape[0]))
daily_20150616_addname_dataframe.to_excel(daily_201506_excel_writer,'16_2',index=False)
daily_201506_excel_writer.save()
daily_20150617 = pro.daily(start_date='',end_date='',trade_date='20150617', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20150617_tscode_list = list() 
for ts_code_sh in daily_20150617['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20150617_tscode_list.append(stock_name)
daily_20150617_addname_dataframe=pd.DataFrame()
daily_20150617_addname_dataframe['cname'] = daily_20150617_tscode_list
for table_name in daily_20150617.columns.values.tolist():
    daily_20150617_addname_dataframe[table_name] = daily_20150617[table_name]
print("日线行情-时间为序  daily_20150617 返回数据 row 行数 = "+str(daily_20150617.shape[0]))
daily_20150617_addname_dataframe.to_excel(daily_201506_excel_writer,'17_3',index=False)
daily_201506_excel_writer.save()
daily_20150618 = pro.daily(start_date='',end_date='',trade_date='20150618', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20150618_tscode_list = list() 
for ts_code_sh in daily_20150618['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20150618_tscode_list.append(stock_name)
daily_20150618_addname_dataframe=pd.DataFrame()
daily_20150618_addname_dataframe['cname'] = daily_20150618_tscode_list
for table_name in daily_20150618.columns.values.tolist():
    daily_20150618_addname_dataframe[table_name] = daily_20150618[table_name]
print("日线行情-时间为序  daily_20150618 返回数据 row 行数 = "+str(daily_20150618.shape[0]))
daily_20150618_addname_dataframe.to_excel(daily_201506_excel_writer,'18_4',index=False)
daily_201506_excel_writer.save()
daily_20150619 = pro.daily(start_date='',end_date='',trade_date='20150619', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20150619_tscode_list = list() 
for ts_code_sh in daily_20150619['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20150619_tscode_list.append(stock_name)
daily_20150619_addname_dataframe=pd.DataFrame()
daily_20150619_addname_dataframe['cname'] = daily_20150619_tscode_list
for table_name in daily_20150619.columns.values.tolist():
    daily_20150619_addname_dataframe[table_name] = daily_20150619[table_name]
print("日线行情-时间为序  daily_20150619 返回数据 row 行数 = "+str(daily_20150619.shape[0]))
daily_20150619_addname_dataframe.to_excel(daily_201506_excel_writer,'19_5',index=False)
daily_201506_excel_writer.save()
daily_20150623 = pro.daily(start_date='',end_date='',trade_date='20150623', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20150623_tscode_list = list() 
for ts_code_sh in daily_20150623['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20150623_tscode_list.append(stock_name)
daily_20150623_addname_dataframe=pd.DataFrame()
daily_20150623_addname_dataframe['cname'] = daily_20150623_tscode_list
for table_name in daily_20150623.columns.values.tolist():
    daily_20150623_addname_dataframe[table_name] = daily_20150623[table_name]
print("日线行情-时间为序  daily_20150623 返回数据 row 行数 = "+str(daily_20150623.shape[0]))
daily_20150623_addname_dataframe.to_excel(daily_201506_excel_writer,'23_2',index=False)
daily_201506_excel_writer.save()
daily_20150624 = pro.daily(start_date='',end_date='',trade_date='20150624', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20150624_tscode_list = list() 
for ts_code_sh in daily_20150624['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20150624_tscode_list.append(stock_name)
daily_20150624_addname_dataframe=pd.DataFrame()
daily_20150624_addname_dataframe['cname'] = daily_20150624_tscode_list
for table_name in daily_20150624.columns.values.tolist():
    daily_20150624_addname_dataframe[table_name] = daily_20150624[table_name]
print("日线行情-时间为序  daily_20150624 返回数据 row 行数 = "+str(daily_20150624.shape[0]))
daily_20150624_addname_dataframe.to_excel(daily_201506_excel_writer,'24_3',index=False)
daily_201506_excel_writer.save()
daily_20150625 = pro.daily(start_date='',end_date='',trade_date='20150625', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20150625_tscode_list = list() 
for ts_code_sh in daily_20150625['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20150625_tscode_list.append(stock_name)
daily_20150625_addname_dataframe=pd.DataFrame()
daily_20150625_addname_dataframe['cname'] = daily_20150625_tscode_list
for table_name in daily_20150625.columns.values.tolist():
    daily_20150625_addname_dataframe[table_name] = daily_20150625[table_name]
print("日线行情-时间为序  daily_20150625 返回数据 row 行数 = "+str(daily_20150625.shape[0]))
daily_20150625_addname_dataframe.to_excel(daily_201506_excel_writer,'25_4',index=False)
daily_201506_excel_writer.save()
daily_20150626 = pro.daily(start_date='',end_date='',trade_date='20150626', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20150626_tscode_list = list() 
for ts_code_sh in daily_20150626['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20150626_tscode_list.append(stock_name)
daily_20150626_addname_dataframe=pd.DataFrame()
daily_20150626_addname_dataframe['cname'] = daily_20150626_tscode_list
for table_name in daily_20150626.columns.values.tolist():
    daily_20150626_addname_dataframe[table_name] = daily_20150626[table_name]
print("日线行情-时间为序  daily_20150626 返回数据 row 行数 = "+str(daily_20150626.shape[0]))
daily_20150626_addname_dataframe.to_excel(daily_201506_excel_writer,'26_5',index=False)
daily_201506_excel_writer.save()
daily_20150629 = pro.daily(start_date='',end_date='',trade_date='20150629', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20150629_tscode_list = list() 
for ts_code_sh in daily_20150629['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20150629_tscode_list.append(stock_name)
daily_20150629_addname_dataframe=pd.DataFrame()
daily_20150629_addname_dataframe['cname'] = daily_20150629_tscode_list
for table_name in daily_20150629.columns.values.tolist():
    daily_20150629_addname_dataframe[table_name] = daily_20150629[table_name]
print("日线行情-时间为序  daily_20150629 返回数据 row 行数 = "+str(daily_20150629.shape[0]))
daily_20150629_addname_dataframe.to_excel(daily_201506_excel_writer,'29_1',index=False)
daily_201506_excel_writer.save()
daily_20150630 = pro.daily(start_date='',end_date='',trade_date='20150630', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20150630_tscode_list = list() 
for ts_code_sh in daily_20150630['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20150630_tscode_list.append(stock_name)
daily_20150630_addname_dataframe=pd.DataFrame()
daily_20150630_addname_dataframe['cname'] = daily_20150630_tscode_list
for table_name in daily_20150630.columns.values.tolist():
    daily_20150630_addname_dataframe[table_name] = daily_20150630[table_name]
print("日线行情-时间为序  daily_20150630 返回数据 row 行数 = "+str(daily_20150630.shape[0]))
daily_20150630_addname_dataframe.to_excel(daily_201506_excel_writer,'30_2',index=False)
daily_201506_excel_writer.save()




createexcel('daily_201507.xlsx')
daily_201507_book = load_workbook('C:\\Users\\zhuzj5\\Desktop\\zbin\\J0_Data\\daily_201507.xlsx')
daily_201507_excel_writer = pd.ExcelWriter('C:\\Users\\zhuzj5\\Desktop\\zbin\\J0_Data\\daily_201507.xlsx', engine='openpyxl')
daily_201507_excel_writer.book = daily_201507_book
daily_201507_excel_writer.sheets = dict((ws.title, ws) for ws in daily_201507_book.worksheets)
J0_PROPS.put(tree_node_name+"record_date", "20150701")       ###  更新 记录日期
daily_20150701 = pro.daily(start_date='',end_date='',trade_date='20150701', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20150701_tscode_list = list() 
for ts_code_sh in daily_20150701['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20150701_tscode_list.append(stock_name)
daily_20150701_addname_dataframe=pd.DataFrame()
daily_20150701_addname_dataframe['cname'] = daily_20150701_tscode_list
for table_name in daily_20150701.columns.values.tolist():
    daily_20150701_addname_dataframe[table_name] = daily_20150701[table_name]
print("日线行情-时间为序  daily_20150701 返回数据 row 行数 = "+str(daily_20150701.shape[0]))
daily_20150701_addname_dataframe.to_excel(daily_201507_excel_writer,'1_3',index=False)
daily_201507_excel_writer.save()
daily_20150702 = pro.daily(start_date='',end_date='',trade_date='20150702', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20150702_tscode_list = list() 
for ts_code_sh in daily_20150702['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20150702_tscode_list.append(stock_name)
daily_20150702_addname_dataframe=pd.DataFrame()
daily_20150702_addname_dataframe['cname'] = daily_20150702_tscode_list
for table_name in daily_20150702.columns.values.tolist():
    daily_20150702_addname_dataframe[table_name] = daily_20150702[table_name]
print("日线行情-时间为序  daily_20150702 返回数据 row 行数 = "+str(daily_20150702.shape[0]))
daily_20150702_addname_dataframe.to_excel(daily_201507_excel_writer,'2_4',index=False)
daily_201507_excel_writer.save()
daily_20150703 = pro.daily(start_date='',end_date='',trade_date='20150703', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20150703_tscode_list = list() 
for ts_code_sh in daily_20150703['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20150703_tscode_list.append(stock_name)
daily_20150703_addname_dataframe=pd.DataFrame()
daily_20150703_addname_dataframe['cname'] = daily_20150703_tscode_list
for table_name in daily_20150703.columns.values.tolist():
    daily_20150703_addname_dataframe[table_name] = daily_20150703[table_name]
print("日线行情-时间为序  daily_20150703 返回数据 row 行数 = "+str(daily_20150703.shape[0]))
daily_20150703_addname_dataframe.to_excel(daily_201507_excel_writer,'3_5',index=False)
daily_201507_excel_writer.save()
daily_20150706 = pro.daily(start_date='',end_date='',trade_date='20150706', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20150706_tscode_list = list() 
for ts_code_sh in daily_20150706['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20150706_tscode_list.append(stock_name)
daily_20150706_addname_dataframe=pd.DataFrame()
daily_20150706_addname_dataframe['cname'] = daily_20150706_tscode_list
for table_name in daily_20150706.columns.values.tolist():
    daily_20150706_addname_dataframe[table_name] = daily_20150706[table_name]
print("日线行情-时间为序  daily_20150706 返回数据 row 行数 = "+str(daily_20150706.shape[0]))
daily_20150706_addname_dataframe.to_excel(daily_201507_excel_writer,'6_1',index=False)
daily_201507_excel_writer.save()
daily_20150707 = pro.daily(start_date='',end_date='',trade_date='20150707', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20150707_tscode_list = list() 
for ts_code_sh in daily_20150707['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20150707_tscode_list.append(stock_name)
daily_20150707_addname_dataframe=pd.DataFrame()
daily_20150707_addname_dataframe['cname'] = daily_20150707_tscode_list
for table_name in daily_20150707.columns.values.tolist():
    daily_20150707_addname_dataframe[table_name] = daily_20150707[table_name]
print("日线行情-时间为序  daily_20150707 返回数据 row 行数 = "+str(daily_20150707.shape[0]))
daily_20150707_addname_dataframe.to_excel(daily_201507_excel_writer,'7_2',index=False)
daily_201507_excel_writer.save()
daily_20150708 = pro.daily(start_date='',end_date='',trade_date='20150708', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20150708_tscode_list = list() 
for ts_code_sh in daily_20150708['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20150708_tscode_list.append(stock_name)
daily_20150708_addname_dataframe=pd.DataFrame()
daily_20150708_addname_dataframe['cname'] = daily_20150708_tscode_list
for table_name in daily_20150708.columns.values.tolist():
    daily_20150708_addname_dataframe[table_name] = daily_20150708[table_name]
print("日线行情-时间为序  daily_20150708 返回数据 row 行数 = "+str(daily_20150708.shape[0]))
daily_20150708_addname_dataframe.to_excel(daily_201507_excel_writer,'8_3',index=False)
daily_201507_excel_writer.save()
daily_20150709 = pro.daily(start_date='',end_date='',trade_date='20150709', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20150709_tscode_list = list() 
for ts_code_sh in daily_20150709['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20150709_tscode_list.append(stock_name)
daily_20150709_addname_dataframe=pd.DataFrame()
daily_20150709_addname_dataframe['cname'] = daily_20150709_tscode_list
for table_name in daily_20150709.columns.values.tolist():
    daily_20150709_addname_dataframe[table_name] = daily_20150709[table_name]
print("日线行情-时间为序  daily_20150709 返回数据 row 行数 = "+str(daily_20150709.shape[0]))
daily_20150709_addname_dataframe.to_excel(daily_201507_excel_writer,'9_4',index=False)
daily_201507_excel_writer.save()
daily_20150710 = pro.daily(start_date='',end_date='',trade_date='20150710', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20150710_tscode_list = list() 
for ts_code_sh in daily_20150710['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20150710_tscode_list.append(stock_name)
daily_20150710_addname_dataframe=pd.DataFrame()
daily_20150710_addname_dataframe['cname'] = daily_20150710_tscode_list
for table_name in daily_20150710.columns.values.tolist():
    daily_20150710_addname_dataframe[table_name] = daily_20150710[table_name]
print("日线行情-时间为序  daily_20150710 返回数据 row 行数 = "+str(daily_20150710.shape[0]))
daily_20150710_addname_dataframe.to_excel(daily_201507_excel_writer,'10_5',index=False)
daily_201507_excel_writer.save()
daily_20150713 = pro.daily(start_date='',end_date='',trade_date='20150713', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20150713_tscode_list = list() 
for ts_code_sh in daily_20150713['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20150713_tscode_list.append(stock_name)
daily_20150713_addname_dataframe=pd.DataFrame()
daily_20150713_addname_dataframe['cname'] = daily_20150713_tscode_list
for table_name in daily_20150713.columns.values.tolist():
    daily_20150713_addname_dataframe[table_name] = daily_20150713[table_name]
print("日线行情-时间为序  daily_20150713 返回数据 row 行数 = "+str(daily_20150713.shape[0]))
daily_20150713_addname_dataframe.to_excel(daily_201507_excel_writer,'13_1',index=False)
daily_201507_excel_writer.save()
daily_20150714 = pro.daily(start_date='',end_date='',trade_date='20150714', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20150714_tscode_list = list() 
for ts_code_sh in daily_20150714['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20150714_tscode_list.append(stock_name)
daily_20150714_addname_dataframe=pd.DataFrame()
daily_20150714_addname_dataframe['cname'] = daily_20150714_tscode_list
for table_name in daily_20150714.columns.values.tolist():
    daily_20150714_addname_dataframe[table_name] = daily_20150714[table_name]
print("日线行情-时间为序  daily_20150714 返回数据 row 行数 = "+str(daily_20150714.shape[0]))
daily_20150714_addname_dataframe.to_excel(daily_201507_excel_writer,'14_2',index=False)
daily_201507_excel_writer.save()
daily_20150715 = pro.daily(start_date='',end_date='',trade_date='20150715', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20150715_tscode_list = list() 
for ts_code_sh in daily_20150715['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20150715_tscode_list.append(stock_name)
daily_20150715_addname_dataframe=pd.DataFrame()
daily_20150715_addname_dataframe['cname'] = daily_20150715_tscode_list
for table_name in daily_20150715.columns.values.tolist():
    daily_20150715_addname_dataframe[table_name] = daily_20150715[table_name]
print("日线行情-时间为序  daily_20150715 返回数据 row 行数 = "+str(daily_20150715.shape[0]))
daily_20150715_addname_dataframe.to_excel(daily_201507_excel_writer,'15_3',index=False)
daily_201507_excel_writer.save()
daily_20150716 = pro.daily(start_date='',end_date='',trade_date='20150716', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20150716_tscode_list = list() 
for ts_code_sh in daily_20150716['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20150716_tscode_list.append(stock_name)
daily_20150716_addname_dataframe=pd.DataFrame()
daily_20150716_addname_dataframe['cname'] = daily_20150716_tscode_list
for table_name in daily_20150716.columns.values.tolist():
    daily_20150716_addname_dataframe[table_name] = daily_20150716[table_name]
print("日线行情-时间为序  daily_20150716 返回数据 row 行数 = "+str(daily_20150716.shape[0]))
daily_20150716_addname_dataframe.to_excel(daily_201507_excel_writer,'16_4',index=False)
daily_201507_excel_writer.save()
daily_20150717 = pro.daily(start_date='',end_date='',trade_date='20150717', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20150717_tscode_list = list() 
for ts_code_sh in daily_20150717['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20150717_tscode_list.append(stock_name)
daily_20150717_addname_dataframe=pd.DataFrame()
daily_20150717_addname_dataframe['cname'] = daily_20150717_tscode_list
for table_name in daily_20150717.columns.values.tolist():
    daily_20150717_addname_dataframe[table_name] = daily_20150717[table_name]
print("日线行情-时间为序  daily_20150717 返回数据 row 行数 = "+str(daily_20150717.shape[0]))
daily_20150717_addname_dataframe.to_excel(daily_201507_excel_writer,'17_5',index=False)
daily_201507_excel_writer.save()
daily_20150720 = pro.daily(start_date='',end_date='',trade_date='20150720', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20150720_tscode_list = list() 
for ts_code_sh in daily_20150720['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20150720_tscode_list.append(stock_name)
daily_20150720_addname_dataframe=pd.DataFrame()
daily_20150720_addname_dataframe['cname'] = daily_20150720_tscode_list
for table_name in daily_20150720.columns.values.tolist():
    daily_20150720_addname_dataframe[table_name] = daily_20150720[table_name]
print("日线行情-时间为序  daily_20150720 返回数据 row 行数 = "+str(daily_20150720.shape[0]))
daily_20150720_addname_dataframe.to_excel(daily_201507_excel_writer,'20_1',index=False)
daily_201507_excel_writer.save()
daily_20150721 = pro.daily(start_date='',end_date='',trade_date='20150721', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20150721_tscode_list = list() 
for ts_code_sh in daily_20150721['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20150721_tscode_list.append(stock_name)
daily_20150721_addname_dataframe=pd.DataFrame()
daily_20150721_addname_dataframe['cname'] = daily_20150721_tscode_list
for table_name in daily_20150721.columns.values.tolist():
    daily_20150721_addname_dataframe[table_name] = daily_20150721[table_name]
print("日线行情-时间为序  daily_20150721 返回数据 row 行数 = "+str(daily_20150721.shape[0]))
daily_20150721_addname_dataframe.to_excel(daily_201507_excel_writer,'21_2',index=False)
daily_201507_excel_writer.save()
daily_20150722 = pro.daily(start_date='',end_date='',trade_date='20150722', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20150722_tscode_list = list() 
for ts_code_sh in daily_20150722['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20150722_tscode_list.append(stock_name)
daily_20150722_addname_dataframe=pd.DataFrame()
daily_20150722_addname_dataframe['cname'] = daily_20150722_tscode_list
for table_name in daily_20150722.columns.values.tolist():
    daily_20150722_addname_dataframe[table_name] = daily_20150722[table_name]
print("日线行情-时间为序  daily_20150722 返回数据 row 行数 = "+str(daily_20150722.shape[0]))
daily_20150722_addname_dataframe.to_excel(daily_201507_excel_writer,'22_3',index=False)
daily_201507_excel_writer.save()
daily_20150723 = pro.daily(start_date='',end_date='',trade_date='20150723', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20150723_tscode_list = list() 
for ts_code_sh in daily_20150723['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20150723_tscode_list.append(stock_name)
daily_20150723_addname_dataframe=pd.DataFrame()
daily_20150723_addname_dataframe['cname'] = daily_20150723_tscode_list
for table_name in daily_20150723.columns.values.tolist():
    daily_20150723_addname_dataframe[table_name] = daily_20150723[table_name]
print("日线行情-时间为序  daily_20150723 返回数据 row 行数 = "+str(daily_20150723.shape[0]))
daily_20150723_addname_dataframe.to_excel(daily_201507_excel_writer,'23_4',index=False)
daily_201507_excel_writer.save()
daily_20150724 = pro.daily(start_date='',end_date='',trade_date='20150724', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20150724_tscode_list = list() 
for ts_code_sh in daily_20150724['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20150724_tscode_list.append(stock_name)
daily_20150724_addname_dataframe=pd.DataFrame()
daily_20150724_addname_dataframe['cname'] = daily_20150724_tscode_list
for table_name in daily_20150724.columns.values.tolist():
    daily_20150724_addname_dataframe[table_name] = daily_20150724[table_name]
print("日线行情-时间为序  daily_20150724 返回数据 row 行数 = "+str(daily_20150724.shape[0]))
daily_20150724_addname_dataframe.to_excel(daily_201507_excel_writer,'24_5',index=False)
daily_201507_excel_writer.save()
daily_20150727 = pro.daily(start_date='',end_date='',trade_date='20150727', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20150727_tscode_list = list() 
for ts_code_sh in daily_20150727['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20150727_tscode_list.append(stock_name)
daily_20150727_addname_dataframe=pd.DataFrame()
daily_20150727_addname_dataframe['cname'] = daily_20150727_tscode_list
for table_name in daily_20150727.columns.values.tolist():
    daily_20150727_addname_dataframe[table_name] = daily_20150727[table_name]
print("日线行情-时间为序  daily_20150727 返回数据 row 行数 = "+str(daily_20150727.shape[0]))
daily_20150727_addname_dataframe.to_excel(daily_201507_excel_writer,'27_1',index=False)
daily_201507_excel_writer.save()
daily_20150728 = pro.daily(start_date='',end_date='',trade_date='20150728', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20150728_tscode_list = list() 
for ts_code_sh in daily_20150728['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20150728_tscode_list.append(stock_name)
daily_20150728_addname_dataframe=pd.DataFrame()
daily_20150728_addname_dataframe['cname'] = daily_20150728_tscode_list
for table_name in daily_20150728.columns.values.tolist():
    daily_20150728_addname_dataframe[table_name] = daily_20150728[table_name]
print("日线行情-时间为序  daily_20150728 返回数据 row 行数 = "+str(daily_20150728.shape[0]))
daily_20150728_addname_dataframe.to_excel(daily_201507_excel_writer,'28_2',index=False)
daily_201507_excel_writer.save()
daily_20150729 = pro.daily(start_date='',end_date='',trade_date='20150729', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20150729_tscode_list = list() 
for ts_code_sh in daily_20150729['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20150729_tscode_list.append(stock_name)
daily_20150729_addname_dataframe=pd.DataFrame()
daily_20150729_addname_dataframe['cname'] = daily_20150729_tscode_list
for table_name in daily_20150729.columns.values.tolist():
    daily_20150729_addname_dataframe[table_name] = daily_20150729[table_name]
print("日线行情-时间为序  daily_20150729 返回数据 row 行数 = "+str(daily_20150729.shape[0]))
daily_20150729_addname_dataframe.to_excel(daily_201507_excel_writer,'29_3',index=False)
daily_201507_excel_writer.save()
daily_20150730 = pro.daily(start_date='',end_date='',trade_date='20150730', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20150730_tscode_list = list() 
for ts_code_sh in daily_20150730['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20150730_tscode_list.append(stock_name)
daily_20150730_addname_dataframe=pd.DataFrame()
daily_20150730_addname_dataframe['cname'] = daily_20150730_tscode_list
for table_name in daily_20150730.columns.values.tolist():
    daily_20150730_addname_dataframe[table_name] = daily_20150730[table_name]
print("日线行情-时间为序  daily_20150730 返回数据 row 行数 = "+str(daily_20150730.shape[0]))
daily_20150730_addname_dataframe.to_excel(daily_201507_excel_writer,'30_4',index=False)
daily_201507_excel_writer.save()
daily_20150731 = pro.daily(start_date='',end_date='',trade_date='20150731', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20150731_tscode_list = list() 
for ts_code_sh in daily_20150731['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20150731_tscode_list.append(stock_name)
daily_20150731_addname_dataframe=pd.DataFrame()
daily_20150731_addname_dataframe['cname'] = daily_20150731_tscode_list
for table_name in daily_20150731.columns.values.tolist():
    daily_20150731_addname_dataframe[table_name] = daily_20150731[table_name]
print("日线行情-时间为序  daily_20150731 返回数据 row 行数 = "+str(daily_20150731.shape[0]))
daily_20150731_addname_dataframe.to_excel(daily_201507_excel_writer,'31_5',index=False)
daily_201507_excel_writer.save()




createexcel('daily_201508.xlsx')
daily_201508_book = load_workbook('C:\\Users\\zhuzj5\\Desktop\\zbin\\J0_Data\\daily_201508.xlsx')
daily_201508_excel_writer = pd.ExcelWriter('C:\\Users\\zhuzj5\\Desktop\\zbin\\J0_Data\\daily_201508.xlsx', engine='openpyxl')
daily_201508_excel_writer.book = daily_201508_book
daily_201508_excel_writer.sheets = dict((ws.title, ws) for ws in daily_201508_book.worksheets)
J0_PROPS.put(tree_node_name+"record_date", "20150801")       ###  更新 记录日期
daily_20150803 = pro.daily(start_date='',end_date='',trade_date='20150803', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20150803_tscode_list = list() 
for ts_code_sh in daily_20150803['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20150803_tscode_list.append(stock_name)
daily_20150803_addname_dataframe=pd.DataFrame()
daily_20150803_addname_dataframe['cname'] = daily_20150803_tscode_list
for table_name in daily_20150803.columns.values.tolist():
    daily_20150803_addname_dataframe[table_name] = daily_20150803[table_name]
print("日线行情-时间为序  daily_20150803 返回数据 row 行数 = "+str(daily_20150803.shape[0]))
daily_20150803_addname_dataframe.to_excel(daily_201508_excel_writer,'3_1',index=False)
daily_201508_excel_writer.save()
daily_20150804 = pro.daily(start_date='',end_date='',trade_date='20150804', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20150804_tscode_list = list() 
for ts_code_sh in daily_20150804['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20150804_tscode_list.append(stock_name)
daily_20150804_addname_dataframe=pd.DataFrame()
daily_20150804_addname_dataframe['cname'] = daily_20150804_tscode_list
for table_name in daily_20150804.columns.values.tolist():
    daily_20150804_addname_dataframe[table_name] = daily_20150804[table_name]
print("日线行情-时间为序  daily_20150804 返回数据 row 行数 = "+str(daily_20150804.shape[0]))
daily_20150804_addname_dataframe.to_excel(daily_201508_excel_writer,'4_2',index=False)
daily_201508_excel_writer.save()
daily_20150805 = pro.daily(start_date='',end_date='',trade_date='20150805', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20150805_tscode_list = list() 
for ts_code_sh in daily_20150805['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20150805_tscode_list.append(stock_name)
daily_20150805_addname_dataframe=pd.DataFrame()
daily_20150805_addname_dataframe['cname'] = daily_20150805_tscode_list
for table_name in daily_20150805.columns.values.tolist():
    daily_20150805_addname_dataframe[table_name] = daily_20150805[table_name]
print("日线行情-时间为序  daily_20150805 返回数据 row 行数 = "+str(daily_20150805.shape[0]))
daily_20150805_addname_dataframe.to_excel(daily_201508_excel_writer,'5_3',index=False)
daily_201508_excel_writer.save()
daily_20150806 = pro.daily(start_date='',end_date='',trade_date='20150806', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20150806_tscode_list = list() 
for ts_code_sh in daily_20150806['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20150806_tscode_list.append(stock_name)
daily_20150806_addname_dataframe=pd.DataFrame()
daily_20150806_addname_dataframe['cname'] = daily_20150806_tscode_list
for table_name in daily_20150806.columns.values.tolist():
    daily_20150806_addname_dataframe[table_name] = daily_20150806[table_name]
print("日线行情-时间为序  daily_20150806 返回数据 row 行数 = "+str(daily_20150806.shape[0]))
daily_20150806_addname_dataframe.to_excel(daily_201508_excel_writer,'6_4',index=False)
daily_201508_excel_writer.save()
daily_20150807 = pro.daily(start_date='',end_date='',trade_date='20150807', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20150807_tscode_list = list() 
for ts_code_sh in daily_20150807['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20150807_tscode_list.append(stock_name)
daily_20150807_addname_dataframe=pd.DataFrame()
daily_20150807_addname_dataframe['cname'] = daily_20150807_tscode_list
for table_name in daily_20150807.columns.values.tolist():
    daily_20150807_addname_dataframe[table_name] = daily_20150807[table_name]
print("日线行情-时间为序  daily_20150807 返回数据 row 行数 = "+str(daily_20150807.shape[0]))
daily_20150807_addname_dataframe.to_excel(daily_201508_excel_writer,'7_5',index=False)
daily_201508_excel_writer.save()
daily_20150810 = pro.daily(start_date='',end_date='',trade_date='20150810', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20150810_tscode_list = list() 
for ts_code_sh in daily_20150810['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20150810_tscode_list.append(stock_name)
daily_20150810_addname_dataframe=pd.DataFrame()
daily_20150810_addname_dataframe['cname'] = daily_20150810_tscode_list
for table_name in daily_20150810.columns.values.tolist():
    daily_20150810_addname_dataframe[table_name] = daily_20150810[table_name]
print("日线行情-时间为序  daily_20150810 返回数据 row 行数 = "+str(daily_20150810.shape[0]))
daily_20150810_addname_dataframe.to_excel(daily_201508_excel_writer,'10_1',index=False)
daily_201508_excel_writer.save()
daily_20150811 = pro.daily(start_date='',end_date='',trade_date='20150811', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20150811_tscode_list = list() 
for ts_code_sh in daily_20150811['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20150811_tscode_list.append(stock_name)
daily_20150811_addname_dataframe=pd.DataFrame()
daily_20150811_addname_dataframe['cname'] = daily_20150811_tscode_list
for table_name in daily_20150811.columns.values.tolist():
    daily_20150811_addname_dataframe[table_name] = daily_20150811[table_name]
print("日线行情-时间为序  daily_20150811 返回数据 row 行数 = "+str(daily_20150811.shape[0]))
daily_20150811_addname_dataframe.to_excel(daily_201508_excel_writer,'11_2',index=False)
daily_201508_excel_writer.save()
daily_20150812 = pro.daily(start_date='',end_date='',trade_date='20150812', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20150812_tscode_list = list() 
for ts_code_sh in daily_20150812['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20150812_tscode_list.append(stock_name)
daily_20150812_addname_dataframe=pd.DataFrame()
daily_20150812_addname_dataframe['cname'] = daily_20150812_tscode_list
for table_name in daily_20150812.columns.values.tolist():
    daily_20150812_addname_dataframe[table_name] = daily_20150812[table_name]
print("日线行情-时间为序  daily_20150812 返回数据 row 行数 = "+str(daily_20150812.shape[0]))
daily_20150812_addname_dataframe.to_excel(daily_201508_excel_writer,'12_3',index=False)
daily_201508_excel_writer.save()
daily_20150813 = pro.daily(start_date='',end_date='',trade_date='20150813', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20150813_tscode_list = list() 
for ts_code_sh in daily_20150813['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20150813_tscode_list.append(stock_name)
daily_20150813_addname_dataframe=pd.DataFrame()
daily_20150813_addname_dataframe['cname'] = daily_20150813_tscode_list
for table_name in daily_20150813.columns.values.tolist():
    daily_20150813_addname_dataframe[table_name] = daily_20150813[table_name]
print("日线行情-时间为序  daily_20150813 返回数据 row 行数 = "+str(daily_20150813.shape[0]))
daily_20150813_addname_dataframe.to_excel(daily_201508_excel_writer,'13_4',index=False)
daily_201508_excel_writer.save()
daily_20150814 = pro.daily(start_date='',end_date='',trade_date='20150814', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20150814_tscode_list = list() 
for ts_code_sh in daily_20150814['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20150814_tscode_list.append(stock_name)
daily_20150814_addname_dataframe=pd.DataFrame()
daily_20150814_addname_dataframe['cname'] = daily_20150814_tscode_list
for table_name in daily_20150814.columns.values.tolist():
    daily_20150814_addname_dataframe[table_name] = daily_20150814[table_name]
print("日线行情-时间为序  daily_20150814 返回数据 row 行数 = "+str(daily_20150814.shape[0]))
daily_20150814_addname_dataframe.to_excel(daily_201508_excel_writer,'14_5',index=False)
daily_201508_excel_writer.save()
daily_20150817 = pro.daily(start_date='',end_date='',trade_date='20150817', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20150817_tscode_list = list() 
for ts_code_sh in daily_20150817['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20150817_tscode_list.append(stock_name)
daily_20150817_addname_dataframe=pd.DataFrame()
daily_20150817_addname_dataframe['cname'] = daily_20150817_tscode_list
for table_name in daily_20150817.columns.values.tolist():
    daily_20150817_addname_dataframe[table_name] = daily_20150817[table_name]
print("日线行情-时间为序  daily_20150817 返回数据 row 行数 = "+str(daily_20150817.shape[0]))
daily_20150817_addname_dataframe.to_excel(daily_201508_excel_writer,'17_1',index=False)
daily_201508_excel_writer.save()
daily_20150818 = pro.daily(start_date='',end_date='',trade_date='20150818', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20150818_tscode_list = list() 
for ts_code_sh in daily_20150818['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20150818_tscode_list.append(stock_name)
daily_20150818_addname_dataframe=pd.DataFrame()
daily_20150818_addname_dataframe['cname'] = daily_20150818_tscode_list
for table_name in daily_20150818.columns.values.tolist():
    daily_20150818_addname_dataframe[table_name] = daily_20150818[table_name]
print("日线行情-时间为序  daily_20150818 返回数据 row 行数 = "+str(daily_20150818.shape[0]))
daily_20150818_addname_dataframe.to_excel(daily_201508_excel_writer,'18_2',index=False)
daily_201508_excel_writer.save()
daily_20150819 = pro.daily(start_date='',end_date='',trade_date='20150819', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20150819_tscode_list = list() 
for ts_code_sh in daily_20150819['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20150819_tscode_list.append(stock_name)
daily_20150819_addname_dataframe=pd.DataFrame()
daily_20150819_addname_dataframe['cname'] = daily_20150819_tscode_list
for table_name in daily_20150819.columns.values.tolist():
    daily_20150819_addname_dataframe[table_name] = daily_20150819[table_name]
print("日线行情-时间为序  daily_20150819 返回数据 row 行数 = "+str(daily_20150819.shape[0]))
daily_20150819_addname_dataframe.to_excel(daily_201508_excel_writer,'19_3',index=False)
daily_201508_excel_writer.save()
daily_20150820 = pro.daily(start_date='',end_date='',trade_date='20150820', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20150820_tscode_list = list() 
for ts_code_sh in daily_20150820['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20150820_tscode_list.append(stock_name)
daily_20150820_addname_dataframe=pd.DataFrame()
daily_20150820_addname_dataframe['cname'] = daily_20150820_tscode_list
for table_name in daily_20150820.columns.values.tolist():
    daily_20150820_addname_dataframe[table_name] = daily_20150820[table_name]
print("日线行情-时间为序  daily_20150820 返回数据 row 行数 = "+str(daily_20150820.shape[0]))
daily_20150820_addname_dataframe.to_excel(daily_201508_excel_writer,'20_4',index=False)
daily_201508_excel_writer.save()
daily_20150821 = pro.daily(start_date='',end_date='',trade_date='20150821', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20150821_tscode_list = list() 
for ts_code_sh in daily_20150821['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20150821_tscode_list.append(stock_name)
daily_20150821_addname_dataframe=pd.DataFrame()
daily_20150821_addname_dataframe['cname'] = daily_20150821_tscode_list
for table_name in daily_20150821.columns.values.tolist():
    daily_20150821_addname_dataframe[table_name] = daily_20150821[table_name]
print("日线行情-时间为序  daily_20150821 返回数据 row 行数 = "+str(daily_20150821.shape[0]))
daily_20150821_addname_dataframe.to_excel(daily_201508_excel_writer,'21_5',index=False)
daily_201508_excel_writer.save()
daily_20150824 = pro.daily(start_date='',end_date='',trade_date='20150824', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20150824_tscode_list = list() 
for ts_code_sh in daily_20150824['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20150824_tscode_list.append(stock_name)
daily_20150824_addname_dataframe=pd.DataFrame()
daily_20150824_addname_dataframe['cname'] = daily_20150824_tscode_list
for table_name in daily_20150824.columns.values.tolist():
    daily_20150824_addname_dataframe[table_name] = daily_20150824[table_name]
print("日线行情-时间为序  daily_20150824 返回数据 row 行数 = "+str(daily_20150824.shape[0]))
daily_20150824_addname_dataframe.to_excel(daily_201508_excel_writer,'24_1',index=False)
daily_201508_excel_writer.save()
daily_20150825 = pro.daily(start_date='',end_date='',trade_date='20150825', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20150825_tscode_list = list() 
for ts_code_sh in daily_20150825['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20150825_tscode_list.append(stock_name)
daily_20150825_addname_dataframe=pd.DataFrame()
daily_20150825_addname_dataframe['cname'] = daily_20150825_tscode_list
for table_name in daily_20150825.columns.values.tolist():
    daily_20150825_addname_dataframe[table_name] = daily_20150825[table_name]
print("日线行情-时间为序  daily_20150825 返回数据 row 行数 = "+str(daily_20150825.shape[0]))
daily_20150825_addname_dataframe.to_excel(daily_201508_excel_writer,'25_2',index=False)
daily_201508_excel_writer.save()
daily_20150826 = pro.daily(start_date='',end_date='',trade_date='20150826', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20150826_tscode_list = list() 
for ts_code_sh in daily_20150826['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20150826_tscode_list.append(stock_name)
daily_20150826_addname_dataframe=pd.DataFrame()
daily_20150826_addname_dataframe['cname'] = daily_20150826_tscode_list
for table_name in daily_20150826.columns.values.tolist():
    daily_20150826_addname_dataframe[table_name] = daily_20150826[table_name]
print("日线行情-时间为序  daily_20150826 返回数据 row 行数 = "+str(daily_20150826.shape[0]))
daily_20150826_addname_dataframe.to_excel(daily_201508_excel_writer,'26_3',index=False)
daily_201508_excel_writer.save()
daily_20150827 = pro.daily(start_date='',end_date='',trade_date='20150827', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20150827_tscode_list = list() 
for ts_code_sh in daily_20150827['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20150827_tscode_list.append(stock_name)
daily_20150827_addname_dataframe=pd.DataFrame()
daily_20150827_addname_dataframe['cname'] = daily_20150827_tscode_list
for table_name in daily_20150827.columns.values.tolist():
    daily_20150827_addname_dataframe[table_name] = daily_20150827[table_name]
print("日线行情-时间为序  daily_20150827 返回数据 row 行数 = "+str(daily_20150827.shape[0]))
daily_20150827_addname_dataframe.to_excel(daily_201508_excel_writer,'27_4',index=False)
daily_201508_excel_writer.save()
daily_20150828 = pro.daily(start_date='',end_date='',trade_date='20150828', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20150828_tscode_list = list() 
for ts_code_sh in daily_20150828['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20150828_tscode_list.append(stock_name)
daily_20150828_addname_dataframe=pd.DataFrame()
daily_20150828_addname_dataframe['cname'] = daily_20150828_tscode_list
for table_name in daily_20150828.columns.values.tolist():
    daily_20150828_addname_dataframe[table_name] = daily_20150828[table_name]
print("日线行情-时间为序  daily_20150828 返回数据 row 行数 = "+str(daily_20150828.shape[0]))
daily_20150828_addname_dataframe.to_excel(daily_201508_excel_writer,'28_5',index=False)
daily_201508_excel_writer.save()
daily_20150831 = pro.daily(start_date='',end_date='',trade_date='20150831', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20150831_tscode_list = list() 
for ts_code_sh in daily_20150831['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20150831_tscode_list.append(stock_name)
daily_20150831_addname_dataframe=pd.DataFrame()
daily_20150831_addname_dataframe['cname'] = daily_20150831_tscode_list
for table_name in daily_20150831.columns.values.tolist():
    daily_20150831_addname_dataframe[table_name] = daily_20150831[table_name]
print("日线行情-时间为序  daily_20150831 返回数据 row 行数 = "+str(daily_20150831.shape[0]))
daily_20150831_addname_dataframe.to_excel(daily_201508_excel_writer,'31_1',index=False)
daily_201508_excel_writer.save()




createexcel('daily_201509.xlsx')
daily_201509_book = load_workbook('C:\\Users\\zhuzj5\\Desktop\\zbin\\J0_Data\\daily_201509.xlsx')
daily_201509_excel_writer = pd.ExcelWriter('C:\\Users\\zhuzj5\\Desktop\\zbin\\J0_Data\\daily_201509.xlsx', engine='openpyxl')
daily_201509_excel_writer.book = daily_201509_book
daily_201509_excel_writer.sheets = dict((ws.title, ws) for ws in daily_201509_book.worksheets)
J0_PROPS.put(tree_node_name+"record_date", "20150901")       ###  更新 记录日期
daily_20150901 = pro.daily(start_date='',end_date='',trade_date='20150901', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20150901_tscode_list = list() 
for ts_code_sh in daily_20150901['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20150901_tscode_list.append(stock_name)
daily_20150901_addname_dataframe=pd.DataFrame()
daily_20150901_addname_dataframe['cname'] = daily_20150901_tscode_list
for table_name in daily_20150901.columns.values.tolist():
    daily_20150901_addname_dataframe[table_name] = daily_20150901[table_name]
print("日线行情-时间为序  daily_20150901 返回数据 row 行数 = "+str(daily_20150901.shape[0]))
daily_20150901_addname_dataframe.to_excel(daily_201509_excel_writer,'1_2',index=False)
daily_201509_excel_writer.save()
daily_20150902 = pro.daily(start_date='',end_date='',trade_date='20150902', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20150902_tscode_list = list() 
for ts_code_sh in daily_20150902['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20150902_tscode_list.append(stock_name)
daily_20150902_addname_dataframe=pd.DataFrame()
daily_20150902_addname_dataframe['cname'] = daily_20150902_tscode_list
for table_name in daily_20150902.columns.values.tolist():
    daily_20150902_addname_dataframe[table_name] = daily_20150902[table_name]
print("日线行情-时间为序  daily_20150902 返回数据 row 行数 = "+str(daily_20150902.shape[0]))
daily_20150902_addname_dataframe.to_excel(daily_201509_excel_writer,'2_3',index=False)
daily_201509_excel_writer.save()
daily_20150907 = pro.daily(start_date='',end_date='',trade_date='20150907', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20150907_tscode_list = list() 
for ts_code_sh in daily_20150907['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20150907_tscode_list.append(stock_name)
daily_20150907_addname_dataframe=pd.DataFrame()
daily_20150907_addname_dataframe['cname'] = daily_20150907_tscode_list
for table_name in daily_20150907.columns.values.tolist():
    daily_20150907_addname_dataframe[table_name] = daily_20150907[table_name]
print("日线行情-时间为序  daily_20150907 返回数据 row 行数 = "+str(daily_20150907.shape[0]))
daily_20150907_addname_dataframe.to_excel(daily_201509_excel_writer,'7_1',index=False)
daily_201509_excel_writer.save()
daily_20150908 = pro.daily(start_date='',end_date='',trade_date='20150908', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20150908_tscode_list = list() 
for ts_code_sh in daily_20150908['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20150908_tscode_list.append(stock_name)
daily_20150908_addname_dataframe=pd.DataFrame()
daily_20150908_addname_dataframe['cname'] = daily_20150908_tscode_list
for table_name in daily_20150908.columns.values.tolist():
    daily_20150908_addname_dataframe[table_name] = daily_20150908[table_name]
print("日线行情-时间为序  daily_20150908 返回数据 row 行数 = "+str(daily_20150908.shape[0]))
daily_20150908_addname_dataframe.to_excel(daily_201509_excel_writer,'8_2',index=False)
daily_201509_excel_writer.save()
daily_20150909 = pro.daily(start_date='',end_date='',trade_date='20150909', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20150909_tscode_list = list() 
for ts_code_sh in daily_20150909['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20150909_tscode_list.append(stock_name)
daily_20150909_addname_dataframe=pd.DataFrame()
daily_20150909_addname_dataframe['cname'] = daily_20150909_tscode_list
for table_name in daily_20150909.columns.values.tolist():
    daily_20150909_addname_dataframe[table_name] = daily_20150909[table_name]
print("日线行情-时间为序  daily_20150909 返回数据 row 行数 = "+str(daily_20150909.shape[0]))
daily_20150909_addname_dataframe.to_excel(daily_201509_excel_writer,'9_3',index=False)
daily_201509_excel_writer.save()
daily_20150910 = pro.daily(start_date='',end_date='',trade_date='20150910', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20150910_tscode_list = list() 
for ts_code_sh in daily_20150910['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20150910_tscode_list.append(stock_name)
daily_20150910_addname_dataframe=pd.DataFrame()
daily_20150910_addname_dataframe['cname'] = daily_20150910_tscode_list
for table_name in daily_20150910.columns.values.tolist():
    daily_20150910_addname_dataframe[table_name] = daily_20150910[table_name]
print("日线行情-时间为序  daily_20150910 返回数据 row 行数 = "+str(daily_20150910.shape[0]))
daily_20150910_addname_dataframe.to_excel(daily_201509_excel_writer,'10_4',index=False)
daily_201509_excel_writer.save()
daily_20150911 = pro.daily(start_date='',end_date='',trade_date='20150911', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20150911_tscode_list = list() 
for ts_code_sh in daily_20150911['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20150911_tscode_list.append(stock_name)
daily_20150911_addname_dataframe=pd.DataFrame()
daily_20150911_addname_dataframe['cname'] = daily_20150911_tscode_list
for table_name in daily_20150911.columns.values.tolist():
    daily_20150911_addname_dataframe[table_name] = daily_20150911[table_name]
print("日线行情-时间为序  daily_20150911 返回数据 row 行数 = "+str(daily_20150911.shape[0]))
daily_20150911_addname_dataframe.to_excel(daily_201509_excel_writer,'11_5',index=False)
daily_201509_excel_writer.save()
daily_20150914 = pro.daily(start_date='',end_date='',trade_date='20150914', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20150914_tscode_list = list() 
for ts_code_sh in daily_20150914['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20150914_tscode_list.append(stock_name)
daily_20150914_addname_dataframe=pd.DataFrame()
daily_20150914_addname_dataframe['cname'] = daily_20150914_tscode_list
for table_name in daily_20150914.columns.values.tolist():
    daily_20150914_addname_dataframe[table_name] = daily_20150914[table_name]
print("日线行情-时间为序  daily_20150914 返回数据 row 行数 = "+str(daily_20150914.shape[0]))
daily_20150914_addname_dataframe.to_excel(daily_201509_excel_writer,'14_1',index=False)
daily_201509_excel_writer.save()
daily_20150915 = pro.daily(start_date='',end_date='',trade_date='20150915', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20150915_tscode_list = list() 
for ts_code_sh in daily_20150915['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20150915_tscode_list.append(stock_name)
daily_20150915_addname_dataframe=pd.DataFrame()
daily_20150915_addname_dataframe['cname'] = daily_20150915_tscode_list
for table_name in daily_20150915.columns.values.tolist():
    daily_20150915_addname_dataframe[table_name] = daily_20150915[table_name]
print("日线行情-时间为序  daily_20150915 返回数据 row 行数 = "+str(daily_20150915.shape[0]))
daily_20150915_addname_dataframe.to_excel(daily_201509_excel_writer,'15_2',index=False)
daily_201509_excel_writer.save()
daily_20150916 = pro.daily(start_date='',end_date='',trade_date='20150916', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20150916_tscode_list = list() 
for ts_code_sh in daily_20150916['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20150916_tscode_list.append(stock_name)
daily_20150916_addname_dataframe=pd.DataFrame()
daily_20150916_addname_dataframe['cname'] = daily_20150916_tscode_list
for table_name in daily_20150916.columns.values.tolist():
    daily_20150916_addname_dataframe[table_name] = daily_20150916[table_name]
print("日线行情-时间为序  daily_20150916 返回数据 row 行数 = "+str(daily_20150916.shape[0]))
daily_20150916_addname_dataframe.to_excel(daily_201509_excel_writer,'16_3',index=False)
daily_201509_excel_writer.save()
daily_20150917 = pro.daily(start_date='',end_date='',trade_date='20150917', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20150917_tscode_list = list() 
for ts_code_sh in daily_20150917['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20150917_tscode_list.append(stock_name)
daily_20150917_addname_dataframe=pd.DataFrame()
daily_20150917_addname_dataframe['cname'] = daily_20150917_tscode_list
for table_name in daily_20150917.columns.values.tolist():
    daily_20150917_addname_dataframe[table_name] = daily_20150917[table_name]
print("日线行情-时间为序  daily_20150917 返回数据 row 行数 = "+str(daily_20150917.shape[0]))
daily_20150917_addname_dataframe.to_excel(daily_201509_excel_writer,'17_4',index=False)
daily_201509_excel_writer.save()
daily_20150918 = pro.daily(start_date='',end_date='',trade_date='20150918', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20150918_tscode_list = list() 
for ts_code_sh in daily_20150918['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20150918_tscode_list.append(stock_name)
daily_20150918_addname_dataframe=pd.DataFrame()
daily_20150918_addname_dataframe['cname'] = daily_20150918_tscode_list
for table_name in daily_20150918.columns.values.tolist():
    daily_20150918_addname_dataframe[table_name] = daily_20150918[table_name]
print("日线行情-时间为序  daily_20150918 返回数据 row 行数 = "+str(daily_20150918.shape[0]))
daily_20150918_addname_dataframe.to_excel(daily_201509_excel_writer,'18_5',index=False)
daily_201509_excel_writer.save()
daily_20150921 = pro.daily(start_date='',end_date='',trade_date='20150921', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20150921_tscode_list = list() 
for ts_code_sh in daily_20150921['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20150921_tscode_list.append(stock_name)
daily_20150921_addname_dataframe=pd.DataFrame()
daily_20150921_addname_dataframe['cname'] = daily_20150921_tscode_list
for table_name in daily_20150921.columns.values.tolist():
    daily_20150921_addname_dataframe[table_name] = daily_20150921[table_name]
print("日线行情-时间为序  daily_20150921 返回数据 row 行数 = "+str(daily_20150921.shape[0]))
daily_20150921_addname_dataframe.to_excel(daily_201509_excel_writer,'21_1',index=False)
daily_201509_excel_writer.save()
daily_20150922 = pro.daily(start_date='',end_date='',trade_date='20150922', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20150922_tscode_list = list() 
for ts_code_sh in daily_20150922['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20150922_tscode_list.append(stock_name)
daily_20150922_addname_dataframe=pd.DataFrame()
daily_20150922_addname_dataframe['cname'] = daily_20150922_tscode_list
for table_name in daily_20150922.columns.values.tolist():
    daily_20150922_addname_dataframe[table_name] = daily_20150922[table_name]
print("日线行情-时间为序  daily_20150922 返回数据 row 行数 = "+str(daily_20150922.shape[0]))
daily_20150922_addname_dataframe.to_excel(daily_201509_excel_writer,'22_2',index=False)
daily_201509_excel_writer.save()
daily_20150923 = pro.daily(start_date='',end_date='',trade_date='20150923', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20150923_tscode_list = list() 
for ts_code_sh in daily_20150923['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20150923_tscode_list.append(stock_name)
daily_20150923_addname_dataframe=pd.DataFrame()
daily_20150923_addname_dataframe['cname'] = daily_20150923_tscode_list
for table_name in daily_20150923.columns.values.tolist():
    daily_20150923_addname_dataframe[table_name] = daily_20150923[table_name]
print("日线行情-时间为序  daily_20150923 返回数据 row 行数 = "+str(daily_20150923.shape[0]))
daily_20150923_addname_dataframe.to_excel(daily_201509_excel_writer,'23_3',index=False)
daily_201509_excel_writer.save()
daily_20150924 = pro.daily(start_date='',end_date='',trade_date='20150924', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20150924_tscode_list = list() 
for ts_code_sh in daily_20150924['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20150924_tscode_list.append(stock_name)
daily_20150924_addname_dataframe=pd.DataFrame()
daily_20150924_addname_dataframe['cname'] = daily_20150924_tscode_list
for table_name in daily_20150924.columns.values.tolist():
    daily_20150924_addname_dataframe[table_name] = daily_20150924[table_name]
print("日线行情-时间为序  daily_20150924 返回数据 row 行数 = "+str(daily_20150924.shape[0]))
daily_20150924_addname_dataframe.to_excel(daily_201509_excel_writer,'24_4',index=False)
daily_201509_excel_writer.save()
daily_20150925 = pro.daily(start_date='',end_date='',trade_date='20150925', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20150925_tscode_list = list() 
for ts_code_sh in daily_20150925['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20150925_tscode_list.append(stock_name)
daily_20150925_addname_dataframe=pd.DataFrame()
daily_20150925_addname_dataframe['cname'] = daily_20150925_tscode_list
for table_name in daily_20150925.columns.values.tolist():
    daily_20150925_addname_dataframe[table_name] = daily_20150925[table_name]
print("日线行情-时间为序  daily_20150925 返回数据 row 行数 = "+str(daily_20150925.shape[0]))
daily_20150925_addname_dataframe.to_excel(daily_201509_excel_writer,'25_5',index=False)
daily_201509_excel_writer.save()
daily_20150928 = pro.daily(start_date='',end_date='',trade_date='20150928', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20150928_tscode_list = list() 
for ts_code_sh in daily_20150928['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20150928_tscode_list.append(stock_name)
daily_20150928_addname_dataframe=pd.DataFrame()
daily_20150928_addname_dataframe['cname'] = daily_20150928_tscode_list
for table_name in daily_20150928.columns.values.tolist():
    daily_20150928_addname_dataframe[table_name] = daily_20150928[table_name]
print("日线行情-时间为序  daily_20150928 返回数据 row 行数 = "+str(daily_20150928.shape[0]))
daily_20150928_addname_dataframe.to_excel(daily_201509_excel_writer,'28_1',index=False)
daily_201509_excel_writer.save()
daily_20150929 = pro.daily(start_date='',end_date='',trade_date='20150929', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20150929_tscode_list = list() 
for ts_code_sh in daily_20150929['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20150929_tscode_list.append(stock_name)
daily_20150929_addname_dataframe=pd.DataFrame()
daily_20150929_addname_dataframe['cname'] = daily_20150929_tscode_list
for table_name in daily_20150929.columns.values.tolist():
    daily_20150929_addname_dataframe[table_name] = daily_20150929[table_name]
print("日线行情-时间为序  daily_20150929 返回数据 row 行数 = "+str(daily_20150929.shape[0]))
daily_20150929_addname_dataframe.to_excel(daily_201509_excel_writer,'29_2',index=False)
daily_201509_excel_writer.save()
daily_20150930 = pro.daily(start_date='',end_date='',trade_date='20150930', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20150930_tscode_list = list() 
for ts_code_sh in daily_20150930['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20150930_tscode_list.append(stock_name)
daily_20150930_addname_dataframe=pd.DataFrame()
daily_20150930_addname_dataframe['cname'] = daily_20150930_tscode_list
for table_name in daily_20150930.columns.values.tolist():
    daily_20150930_addname_dataframe[table_name] = daily_20150930[table_name]
print("日线行情-时间为序  daily_20150930 返回数据 row 行数 = "+str(daily_20150930.shape[0]))
daily_20150930_addname_dataframe.to_excel(daily_201509_excel_writer,'30_3',index=False)
daily_201509_excel_writer.save()




createexcel('daily_201510.xlsx')
daily_201510_book = load_workbook('C:\\Users\\zhuzj5\\Desktop\\zbin\\J0_Data\\daily_201510.xlsx')
daily_201510_excel_writer = pd.ExcelWriter('C:\\Users\\zhuzj5\\Desktop\\zbin\\J0_Data\\daily_201510.xlsx', engine='openpyxl')
daily_201510_excel_writer.book = daily_201510_book
daily_201510_excel_writer.sheets = dict((ws.title, ws) for ws in daily_201510_book.worksheets)
J0_PROPS.put(tree_node_name+"record_date", "20151001")       ###  更新 记录日期
daily_20151008 = pro.daily(start_date='',end_date='',trade_date='20151008', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20151008_tscode_list = list() 
for ts_code_sh in daily_20151008['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20151008_tscode_list.append(stock_name)
daily_20151008_addname_dataframe=pd.DataFrame()
daily_20151008_addname_dataframe['cname'] = daily_20151008_tscode_list
for table_name in daily_20151008.columns.values.tolist():
    daily_20151008_addname_dataframe[table_name] = daily_20151008[table_name]
print("日线行情-时间为序  daily_20151008 返回数据 row 行数 = "+str(daily_20151008.shape[0]))
daily_20151008_addname_dataframe.to_excel(daily_201510_excel_writer,'8_4',index=False)
daily_201510_excel_writer.save()
daily_20151009 = pro.daily(start_date='',end_date='',trade_date='20151009', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20151009_tscode_list = list() 
for ts_code_sh in daily_20151009['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20151009_tscode_list.append(stock_name)
daily_20151009_addname_dataframe=pd.DataFrame()
daily_20151009_addname_dataframe['cname'] = daily_20151009_tscode_list
for table_name in daily_20151009.columns.values.tolist():
    daily_20151009_addname_dataframe[table_name] = daily_20151009[table_name]
print("日线行情-时间为序  daily_20151009 返回数据 row 行数 = "+str(daily_20151009.shape[0]))
daily_20151009_addname_dataframe.to_excel(daily_201510_excel_writer,'9_5',index=False)
daily_201510_excel_writer.save()
daily_20151012 = pro.daily(start_date='',end_date='',trade_date='20151012', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20151012_tscode_list = list() 
for ts_code_sh in daily_20151012['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20151012_tscode_list.append(stock_name)
daily_20151012_addname_dataframe=pd.DataFrame()
daily_20151012_addname_dataframe['cname'] = daily_20151012_tscode_list
for table_name in daily_20151012.columns.values.tolist():
    daily_20151012_addname_dataframe[table_name] = daily_20151012[table_name]
print("日线行情-时间为序  daily_20151012 返回数据 row 行数 = "+str(daily_20151012.shape[0]))
daily_20151012_addname_dataframe.to_excel(daily_201510_excel_writer,'12_1',index=False)
daily_201510_excel_writer.save()
daily_20151013 = pro.daily(start_date='',end_date='',trade_date='20151013', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20151013_tscode_list = list() 
for ts_code_sh in daily_20151013['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20151013_tscode_list.append(stock_name)
daily_20151013_addname_dataframe=pd.DataFrame()
daily_20151013_addname_dataframe['cname'] = daily_20151013_tscode_list
for table_name in daily_20151013.columns.values.tolist():
    daily_20151013_addname_dataframe[table_name] = daily_20151013[table_name]
print("日线行情-时间为序  daily_20151013 返回数据 row 行数 = "+str(daily_20151013.shape[0]))
daily_20151013_addname_dataframe.to_excel(daily_201510_excel_writer,'13_2',index=False)
daily_201510_excel_writer.save()
daily_20151014 = pro.daily(start_date='',end_date='',trade_date='20151014', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20151014_tscode_list = list() 
for ts_code_sh in daily_20151014['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20151014_tscode_list.append(stock_name)
daily_20151014_addname_dataframe=pd.DataFrame()
daily_20151014_addname_dataframe['cname'] = daily_20151014_tscode_list
for table_name in daily_20151014.columns.values.tolist():
    daily_20151014_addname_dataframe[table_name] = daily_20151014[table_name]
print("日线行情-时间为序  daily_20151014 返回数据 row 行数 = "+str(daily_20151014.shape[0]))
daily_20151014_addname_dataframe.to_excel(daily_201510_excel_writer,'14_3',index=False)
daily_201510_excel_writer.save()
daily_20151015 = pro.daily(start_date='',end_date='',trade_date='20151015', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20151015_tscode_list = list() 
for ts_code_sh in daily_20151015['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20151015_tscode_list.append(stock_name)
daily_20151015_addname_dataframe=pd.DataFrame()
daily_20151015_addname_dataframe['cname'] = daily_20151015_tscode_list
for table_name in daily_20151015.columns.values.tolist():
    daily_20151015_addname_dataframe[table_name] = daily_20151015[table_name]
print("日线行情-时间为序  daily_20151015 返回数据 row 行数 = "+str(daily_20151015.shape[0]))
daily_20151015_addname_dataframe.to_excel(daily_201510_excel_writer,'15_4',index=False)
daily_201510_excel_writer.save()
daily_20151016 = pro.daily(start_date='',end_date='',trade_date='20151016', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20151016_tscode_list = list() 
for ts_code_sh in daily_20151016['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20151016_tscode_list.append(stock_name)
daily_20151016_addname_dataframe=pd.DataFrame()
daily_20151016_addname_dataframe['cname'] = daily_20151016_tscode_list
for table_name in daily_20151016.columns.values.tolist():
    daily_20151016_addname_dataframe[table_name] = daily_20151016[table_name]
print("日线行情-时间为序  daily_20151016 返回数据 row 行数 = "+str(daily_20151016.shape[0]))
daily_20151016_addname_dataframe.to_excel(daily_201510_excel_writer,'16_5',index=False)
daily_201510_excel_writer.save()
daily_20151019 = pro.daily(start_date='',end_date='',trade_date='20151019', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20151019_tscode_list = list() 
for ts_code_sh in daily_20151019['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20151019_tscode_list.append(stock_name)
daily_20151019_addname_dataframe=pd.DataFrame()
daily_20151019_addname_dataframe['cname'] = daily_20151019_tscode_list
for table_name in daily_20151019.columns.values.tolist():
    daily_20151019_addname_dataframe[table_name] = daily_20151019[table_name]
print("日线行情-时间为序  daily_20151019 返回数据 row 行数 = "+str(daily_20151019.shape[0]))
daily_20151019_addname_dataframe.to_excel(daily_201510_excel_writer,'19_1',index=False)
daily_201510_excel_writer.save()
daily_20151020 = pro.daily(start_date='',end_date='',trade_date='20151020', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20151020_tscode_list = list() 
for ts_code_sh in daily_20151020['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20151020_tscode_list.append(stock_name)
daily_20151020_addname_dataframe=pd.DataFrame()
daily_20151020_addname_dataframe['cname'] = daily_20151020_tscode_list
for table_name in daily_20151020.columns.values.tolist():
    daily_20151020_addname_dataframe[table_name] = daily_20151020[table_name]
print("日线行情-时间为序  daily_20151020 返回数据 row 行数 = "+str(daily_20151020.shape[0]))
daily_20151020_addname_dataframe.to_excel(daily_201510_excel_writer,'20_2',index=False)
daily_201510_excel_writer.save()
daily_20151021 = pro.daily(start_date='',end_date='',trade_date='20151021', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20151021_tscode_list = list() 
for ts_code_sh in daily_20151021['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20151021_tscode_list.append(stock_name)
daily_20151021_addname_dataframe=pd.DataFrame()
daily_20151021_addname_dataframe['cname'] = daily_20151021_tscode_list
for table_name in daily_20151021.columns.values.tolist():
    daily_20151021_addname_dataframe[table_name] = daily_20151021[table_name]
print("日线行情-时间为序  daily_20151021 返回数据 row 行数 = "+str(daily_20151021.shape[0]))
daily_20151021_addname_dataframe.to_excel(daily_201510_excel_writer,'21_3',index=False)
daily_201510_excel_writer.save()
daily_20151022 = pro.daily(start_date='',end_date='',trade_date='20151022', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20151022_tscode_list = list() 
for ts_code_sh in daily_20151022['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20151022_tscode_list.append(stock_name)
daily_20151022_addname_dataframe=pd.DataFrame()
daily_20151022_addname_dataframe['cname'] = daily_20151022_tscode_list
for table_name in daily_20151022.columns.values.tolist():
    daily_20151022_addname_dataframe[table_name] = daily_20151022[table_name]
print("日线行情-时间为序  daily_20151022 返回数据 row 行数 = "+str(daily_20151022.shape[0]))
daily_20151022_addname_dataframe.to_excel(daily_201510_excel_writer,'22_4',index=False)
daily_201510_excel_writer.save()
daily_20151023 = pro.daily(start_date='',end_date='',trade_date='20151023', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20151023_tscode_list = list() 
for ts_code_sh in daily_20151023['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20151023_tscode_list.append(stock_name)
daily_20151023_addname_dataframe=pd.DataFrame()
daily_20151023_addname_dataframe['cname'] = daily_20151023_tscode_list
for table_name in daily_20151023.columns.values.tolist():
    daily_20151023_addname_dataframe[table_name] = daily_20151023[table_name]
print("日线行情-时间为序  daily_20151023 返回数据 row 行数 = "+str(daily_20151023.shape[0]))
daily_20151023_addname_dataframe.to_excel(daily_201510_excel_writer,'23_5',index=False)
daily_201510_excel_writer.save()
daily_20151026 = pro.daily(start_date='',end_date='',trade_date='20151026', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20151026_tscode_list = list() 
for ts_code_sh in daily_20151026['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20151026_tscode_list.append(stock_name)
daily_20151026_addname_dataframe=pd.DataFrame()
daily_20151026_addname_dataframe['cname'] = daily_20151026_tscode_list
for table_name in daily_20151026.columns.values.tolist():
    daily_20151026_addname_dataframe[table_name] = daily_20151026[table_name]
print("日线行情-时间为序  daily_20151026 返回数据 row 行数 = "+str(daily_20151026.shape[0]))
daily_20151026_addname_dataframe.to_excel(daily_201510_excel_writer,'26_1',index=False)
daily_201510_excel_writer.save()
daily_20151027 = pro.daily(start_date='',end_date='',trade_date='20151027', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20151027_tscode_list = list() 
for ts_code_sh in daily_20151027['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20151027_tscode_list.append(stock_name)
daily_20151027_addname_dataframe=pd.DataFrame()
daily_20151027_addname_dataframe['cname'] = daily_20151027_tscode_list
for table_name in daily_20151027.columns.values.tolist():
    daily_20151027_addname_dataframe[table_name] = daily_20151027[table_name]
print("日线行情-时间为序  daily_20151027 返回数据 row 行数 = "+str(daily_20151027.shape[0]))
daily_20151027_addname_dataframe.to_excel(daily_201510_excel_writer,'27_2',index=False)
daily_201510_excel_writer.save()
daily_20151028 = pro.daily(start_date='',end_date='',trade_date='20151028', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20151028_tscode_list = list() 
for ts_code_sh in daily_20151028['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20151028_tscode_list.append(stock_name)
daily_20151028_addname_dataframe=pd.DataFrame()
daily_20151028_addname_dataframe['cname'] = daily_20151028_tscode_list
for table_name in daily_20151028.columns.values.tolist():
    daily_20151028_addname_dataframe[table_name] = daily_20151028[table_name]
print("日线行情-时间为序  daily_20151028 返回数据 row 行数 = "+str(daily_20151028.shape[0]))
daily_20151028_addname_dataframe.to_excel(daily_201510_excel_writer,'28_3',index=False)
daily_201510_excel_writer.save()
daily_20151029 = pro.daily(start_date='',end_date='',trade_date='20151029', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20151029_tscode_list = list() 
for ts_code_sh in daily_20151029['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20151029_tscode_list.append(stock_name)
daily_20151029_addname_dataframe=pd.DataFrame()
daily_20151029_addname_dataframe['cname'] = daily_20151029_tscode_list
for table_name in daily_20151029.columns.values.tolist():
    daily_20151029_addname_dataframe[table_name] = daily_20151029[table_name]
print("日线行情-时间为序  daily_20151029 返回数据 row 行数 = "+str(daily_20151029.shape[0]))
daily_20151029_addname_dataframe.to_excel(daily_201510_excel_writer,'29_4',index=False)
daily_201510_excel_writer.save()
daily_20151030 = pro.daily(start_date='',end_date='',trade_date='20151030', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20151030_tscode_list = list() 
for ts_code_sh in daily_20151030['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20151030_tscode_list.append(stock_name)
daily_20151030_addname_dataframe=pd.DataFrame()
daily_20151030_addname_dataframe['cname'] = daily_20151030_tscode_list
for table_name in daily_20151030.columns.values.tolist():
    daily_20151030_addname_dataframe[table_name] = daily_20151030[table_name]
print("日线行情-时间为序  daily_20151030 返回数据 row 行数 = "+str(daily_20151030.shape[0]))
daily_20151030_addname_dataframe.to_excel(daily_201510_excel_writer,'30_5',index=False)
daily_201510_excel_writer.save()




createexcel('daily_201511.xlsx')
daily_201511_book = load_workbook('C:\\Users\\zhuzj5\\Desktop\\zbin\\J0_Data\\daily_201511.xlsx')
daily_201511_excel_writer = pd.ExcelWriter('C:\\Users\\zhuzj5\\Desktop\\zbin\\J0_Data\\daily_201511.xlsx', engine='openpyxl')
daily_201511_excel_writer.book = daily_201511_book
daily_201511_excel_writer.sheets = dict((ws.title, ws) for ws in daily_201511_book.worksheets)
J0_PROPS.put(tree_node_name+"record_date", "20151101")       ###  更新 记录日期
daily_20151102 = pro.daily(start_date='',end_date='',trade_date='20151102', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20151102_tscode_list = list() 
for ts_code_sh in daily_20151102['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20151102_tscode_list.append(stock_name)
daily_20151102_addname_dataframe=pd.DataFrame()
daily_20151102_addname_dataframe['cname'] = daily_20151102_tscode_list
for table_name in daily_20151102.columns.values.tolist():
    daily_20151102_addname_dataframe[table_name] = daily_20151102[table_name]
print("日线行情-时间为序  daily_20151102 返回数据 row 行数 = "+str(daily_20151102.shape[0]))
daily_20151102_addname_dataframe.to_excel(daily_201511_excel_writer,'2_1',index=False)
daily_201511_excel_writer.save()
daily_20151103 = pro.daily(start_date='',end_date='',trade_date='20151103', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20151103_tscode_list = list() 
for ts_code_sh in daily_20151103['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20151103_tscode_list.append(stock_name)
daily_20151103_addname_dataframe=pd.DataFrame()
daily_20151103_addname_dataframe['cname'] = daily_20151103_tscode_list
for table_name in daily_20151103.columns.values.tolist():
    daily_20151103_addname_dataframe[table_name] = daily_20151103[table_name]
print("日线行情-时间为序  daily_20151103 返回数据 row 行数 = "+str(daily_20151103.shape[0]))
daily_20151103_addname_dataframe.to_excel(daily_201511_excel_writer,'3_2',index=False)
daily_201511_excel_writer.save()
daily_20151104 = pro.daily(start_date='',end_date='',trade_date='20151104', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20151104_tscode_list = list() 
for ts_code_sh in daily_20151104['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20151104_tscode_list.append(stock_name)
daily_20151104_addname_dataframe=pd.DataFrame()
daily_20151104_addname_dataframe['cname'] = daily_20151104_tscode_list
for table_name in daily_20151104.columns.values.tolist():
    daily_20151104_addname_dataframe[table_name] = daily_20151104[table_name]
print("日线行情-时间为序  daily_20151104 返回数据 row 行数 = "+str(daily_20151104.shape[0]))
daily_20151104_addname_dataframe.to_excel(daily_201511_excel_writer,'4_3',index=False)
daily_201511_excel_writer.save()
daily_20151105 = pro.daily(start_date='',end_date='',trade_date='20151105', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20151105_tscode_list = list() 
for ts_code_sh in daily_20151105['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20151105_tscode_list.append(stock_name)
daily_20151105_addname_dataframe=pd.DataFrame()
daily_20151105_addname_dataframe['cname'] = daily_20151105_tscode_list
for table_name in daily_20151105.columns.values.tolist():
    daily_20151105_addname_dataframe[table_name] = daily_20151105[table_name]
print("日线行情-时间为序  daily_20151105 返回数据 row 行数 = "+str(daily_20151105.shape[0]))
daily_20151105_addname_dataframe.to_excel(daily_201511_excel_writer,'5_4',index=False)
daily_201511_excel_writer.save()
daily_20151106 = pro.daily(start_date='',end_date='',trade_date='20151106', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20151106_tscode_list = list() 
for ts_code_sh in daily_20151106['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20151106_tscode_list.append(stock_name)
daily_20151106_addname_dataframe=pd.DataFrame()
daily_20151106_addname_dataframe['cname'] = daily_20151106_tscode_list
for table_name in daily_20151106.columns.values.tolist():
    daily_20151106_addname_dataframe[table_name] = daily_20151106[table_name]
print("日线行情-时间为序  daily_20151106 返回数据 row 行数 = "+str(daily_20151106.shape[0]))
daily_20151106_addname_dataframe.to_excel(daily_201511_excel_writer,'6_5',index=False)
daily_201511_excel_writer.save()
daily_20151109 = pro.daily(start_date='',end_date='',trade_date='20151109', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20151109_tscode_list = list() 
for ts_code_sh in daily_20151109['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20151109_tscode_list.append(stock_name)
daily_20151109_addname_dataframe=pd.DataFrame()
daily_20151109_addname_dataframe['cname'] = daily_20151109_tscode_list
for table_name in daily_20151109.columns.values.tolist():
    daily_20151109_addname_dataframe[table_name] = daily_20151109[table_name]
print("日线行情-时间为序  daily_20151109 返回数据 row 行数 = "+str(daily_20151109.shape[0]))
daily_20151109_addname_dataframe.to_excel(daily_201511_excel_writer,'9_1',index=False)
daily_201511_excel_writer.save()
daily_20151110 = pro.daily(start_date='',end_date='',trade_date='20151110', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20151110_tscode_list = list() 
for ts_code_sh in daily_20151110['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20151110_tscode_list.append(stock_name)
daily_20151110_addname_dataframe=pd.DataFrame()
daily_20151110_addname_dataframe['cname'] = daily_20151110_tscode_list
for table_name in daily_20151110.columns.values.tolist():
    daily_20151110_addname_dataframe[table_name] = daily_20151110[table_name]
print("日线行情-时间为序  daily_20151110 返回数据 row 行数 = "+str(daily_20151110.shape[0]))
daily_20151110_addname_dataframe.to_excel(daily_201511_excel_writer,'10_2',index=False)
daily_201511_excel_writer.save()
daily_20151111 = pro.daily(start_date='',end_date='',trade_date='20151111', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20151111_tscode_list = list() 
for ts_code_sh in daily_20151111['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20151111_tscode_list.append(stock_name)
daily_20151111_addname_dataframe=pd.DataFrame()
daily_20151111_addname_dataframe['cname'] = daily_20151111_tscode_list
for table_name in daily_20151111.columns.values.tolist():
    daily_20151111_addname_dataframe[table_name] = daily_20151111[table_name]
print("日线行情-时间为序  daily_20151111 返回数据 row 行数 = "+str(daily_20151111.shape[0]))
daily_20151111_addname_dataframe.to_excel(daily_201511_excel_writer,'11_3',index=False)
daily_201511_excel_writer.save()
daily_20151112 = pro.daily(start_date='',end_date='',trade_date='20151112', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20151112_tscode_list = list() 
for ts_code_sh in daily_20151112['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20151112_tscode_list.append(stock_name)
daily_20151112_addname_dataframe=pd.DataFrame()
daily_20151112_addname_dataframe['cname'] = daily_20151112_tscode_list
for table_name in daily_20151112.columns.values.tolist():
    daily_20151112_addname_dataframe[table_name] = daily_20151112[table_name]
print("日线行情-时间为序  daily_20151112 返回数据 row 行数 = "+str(daily_20151112.shape[0]))
daily_20151112_addname_dataframe.to_excel(daily_201511_excel_writer,'12_4',index=False)
daily_201511_excel_writer.save()
daily_20151113 = pro.daily(start_date='',end_date='',trade_date='20151113', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20151113_tscode_list = list() 
for ts_code_sh in daily_20151113['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20151113_tscode_list.append(stock_name)
daily_20151113_addname_dataframe=pd.DataFrame()
daily_20151113_addname_dataframe['cname'] = daily_20151113_tscode_list
for table_name in daily_20151113.columns.values.tolist():
    daily_20151113_addname_dataframe[table_name] = daily_20151113[table_name]
print("日线行情-时间为序  daily_20151113 返回数据 row 行数 = "+str(daily_20151113.shape[0]))
daily_20151113_addname_dataframe.to_excel(daily_201511_excel_writer,'13_5',index=False)
daily_201511_excel_writer.save()
daily_20151116 = pro.daily(start_date='',end_date='',trade_date='20151116', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20151116_tscode_list = list() 
for ts_code_sh in daily_20151116['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20151116_tscode_list.append(stock_name)
daily_20151116_addname_dataframe=pd.DataFrame()
daily_20151116_addname_dataframe['cname'] = daily_20151116_tscode_list
for table_name in daily_20151116.columns.values.tolist():
    daily_20151116_addname_dataframe[table_name] = daily_20151116[table_name]
print("日线行情-时间为序  daily_20151116 返回数据 row 行数 = "+str(daily_20151116.shape[0]))
daily_20151116_addname_dataframe.to_excel(daily_201511_excel_writer,'16_1',index=False)
daily_201511_excel_writer.save()
daily_20151117 = pro.daily(start_date='',end_date='',trade_date='20151117', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20151117_tscode_list = list() 
for ts_code_sh in daily_20151117['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20151117_tscode_list.append(stock_name)
daily_20151117_addname_dataframe=pd.DataFrame()
daily_20151117_addname_dataframe['cname'] = daily_20151117_tscode_list
for table_name in daily_20151117.columns.values.tolist():
    daily_20151117_addname_dataframe[table_name] = daily_20151117[table_name]
print("日线行情-时间为序  daily_20151117 返回数据 row 行数 = "+str(daily_20151117.shape[0]))
daily_20151117_addname_dataframe.to_excel(daily_201511_excel_writer,'17_2',index=False)
daily_201511_excel_writer.save()
daily_20151118 = pro.daily(start_date='',end_date='',trade_date='20151118', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20151118_tscode_list = list() 
for ts_code_sh in daily_20151118['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20151118_tscode_list.append(stock_name)
daily_20151118_addname_dataframe=pd.DataFrame()
daily_20151118_addname_dataframe['cname'] = daily_20151118_tscode_list
for table_name in daily_20151118.columns.values.tolist():
    daily_20151118_addname_dataframe[table_name] = daily_20151118[table_name]
print("日线行情-时间为序  daily_20151118 返回数据 row 行数 = "+str(daily_20151118.shape[0]))
daily_20151118_addname_dataframe.to_excel(daily_201511_excel_writer,'18_3',index=False)
daily_201511_excel_writer.save()
daily_20151119 = pro.daily(start_date='',end_date='',trade_date='20151119', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20151119_tscode_list = list() 
for ts_code_sh in daily_20151119['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20151119_tscode_list.append(stock_name)
daily_20151119_addname_dataframe=pd.DataFrame()
daily_20151119_addname_dataframe['cname'] = daily_20151119_tscode_list
for table_name in daily_20151119.columns.values.tolist():
    daily_20151119_addname_dataframe[table_name] = daily_20151119[table_name]
print("日线行情-时间为序  daily_20151119 返回数据 row 行数 = "+str(daily_20151119.shape[0]))
daily_20151119_addname_dataframe.to_excel(daily_201511_excel_writer,'19_4',index=False)
daily_201511_excel_writer.save()
daily_20151120 = pro.daily(start_date='',end_date='',trade_date='20151120', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20151120_tscode_list = list() 
for ts_code_sh in daily_20151120['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20151120_tscode_list.append(stock_name)
daily_20151120_addname_dataframe=pd.DataFrame()
daily_20151120_addname_dataframe['cname'] = daily_20151120_tscode_list
for table_name in daily_20151120.columns.values.tolist():
    daily_20151120_addname_dataframe[table_name] = daily_20151120[table_name]
print("日线行情-时间为序  daily_20151120 返回数据 row 行数 = "+str(daily_20151120.shape[0]))
daily_20151120_addname_dataframe.to_excel(daily_201511_excel_writer,'20_5',index=False)
daily_201511_excel_writer.save()
daily_20151123 = pro.daily(start_date='',end_date='',trade_date='20151123', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20151123_tscode_list = list() 
for ts_code_sh in daily_20151123['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20151123_tscode_list.append(stock_name)
daily_20151123_addname_dataframe=pd.DataFrame()
daily_20151123_addname_dataframe['cname'] = daily_20151123_tscode_list
for table_name in daily_20151123.columns.values.tolist():
    daily_20151123_addname_dataframe[table_name] = daily_20151123[table_name]
print("日线行情-时间为序  daily_20151123 返回数据 row 行数 = "+str(daily_20151123.shape[0]))
daily_20151123_addname_dataframe.to_excel(daily_201511_excel_writer,'23_1',index=False)
daily_201511_excel_writer.save()
daily_20151124 = pro.daily(start_date='',end_date='',trade_date='20151124', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20151124_tscode_list = list() 
for ts_code_sh in daily_20151124['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20151124_tscode_list.append(stock_name)
daily_20151124_addname_dataframe=pd.DataFrame()
daily_20151124_addname_dataframe['cname'] = daily_20151124_tscode_list
for table_name in daily_20151124.columns.values.tolist():
    daily_20151124_addname_dataframe[table_name] = daily_20151124[table_name]
print("日线行情-时间为序  daily_20151124 返回数据 row 行数 = "+str(daily_20151124.shape[0]))
daily_20151124_addname_dataframe.to_excel(daily_201511_excel_writer,'24_2',index=False)
daily_201511_excel_writer.save()
daily_20151125 = pro.daily(start_date='',end_date='',trade_date='20151125', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20151125_tscode_list = list() 
for ts_code_sh in daily_20151125['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20151125_tscode_list.append(stock_name)
daily_20151125_addname_dataframe=pd.DataFrame()
daily_20151125_addname_dataframe['cname'] = daily_20151125_tscode_list
for table_name in daily_20151125.columns.values.tolist():
    daily_20151125_addname_dataframe[table_name] = daily_20151125[table_name]
print("日线行情-时间为序  daily_20151125 返回数据 row 行数 = "+str(daily_20151125.shape[0]))
daily_20151125_addname_dataframe.to_excel(daily_201511_excel_writer,'25_3',index=False)
daily_201511_excel_writer.save()
daily_20151126 = pro.daily(start_date='',end_date='',trade_date='20151126', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20151126_tscode_list = list() 
for ts_code_sh in daily_20151126['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20151126_tscode_list.append(stock_name)
daily_20151126_addname_dataframe=pd.DataFrame()
daily_20151126_addname_dataframe['cname'] = daily_20151126_tscode_list
for table_name in daily_20151126.columns.values.tolist():
    daily_20151126_addname_dataframe[table_name] = daily_20151126[table_name]
print("日线行情-时间为序  daily_20151126 返回数据 row 行数 = "+str(daily_20151126.shape[0]))
daily_20151126_addname_dataframe.to_excel(daily_201511_excel_writer,'26_4',index=False)
daily_201511_excel_writer.save()
daily_20151127 = pro.daily(start_date='',end_date='',trade_date='20151127', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20151127_tscode_list = list() 
for ts_code_sh in daily_20151127['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20151127_tscode_list.append(stock_name)
daily_20151127_addname_dataframe=pd.DataFrame()
daily_20151127_addname_dataframe['cname'] = daily_20151127_tscode_list
for table_name in daily_20151127.columns.values.tolist():
    daily_20151127_addname_dataframe[table_name] = daily_20151127[table_name]
print("日线行情-时间为序  daily_20151127 返回数据 row 行数 = "+str(daily_20151127.shape[0]))
daily_20151127_addname_dataframe.to_excel(daily_201511_excel_writer,'27_5',index=False)
daily_201511_excel_writer.save()
daily_20151130 = pro.daily(start_date='',end_date='',trade_date='20151130', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20151130_tscode_list = list() 
for ts_code_sh in daily_20151130['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20151130_tscode_list.append(stock_name)
daily_20151130_addname_dataframe=pd.DataFrame()
daily_20151130_addname_dataframe['cname'] = daily_20151130_tscode_list
for table_name in daily_20151130.columns.values.tolist():
    daily_20151130_addname_dataframe[table_name] = daily_20151130[table_name]
print("日线行情-时间为序  daily_20151130 返回数据 row 行数 = "+str(daily_20151130.shape[0]))
daily_20151130_addname_dataframe.to_excel(daily_201511_excel_writer,'30_1',index=False)
daily_201511_excel_writer.save()




createexcel('daily_201512.xlsx')
daily_201512_book = load_workbook('C:\\Users\\zhuzj5\\Desktop\\zbin\\J0_Data\\daily_201512.xlsx')
daily_201512_excel_writer = pd.ExcelWriter('C:\\Users\\zhuzj5\\Desktop\\zbin\\J0_Data\\daily_201512.xlsx', engine='openpyxl')
daily_201512_excel_writer.book = daily_201512_book
daily_201512_excel_writer.sheets = dict((ws.title, ws) for ws in daily_201512_book.worksheets)
J0_PROPS.put(tree_node_name+"record_date", "20151201")       ###  更新 记录日期
daily_20151201 = pro.daily(start_date='',end_date='',trade_date='20151201', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20151201_tscode_list = list() 
for ts_code_sh in daily_20151201['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20151201_tscode_list.append(stock_name)
daily_20151201_addname_dataframe=pd.DataFrame()
daily_20151201_addname_dataframe['cname'] = daily_20151201_tscode_list
for table_name in daily_20151201.columns.values.tolist():
    daily_20151201_addname_dataframe[table_name] = daily_20151201[table_name]
print("日线行情-时间为序  daily_20151201 返回数据 row 行数 = "+str(daily_20151201.shape[0]))
daily_20151201_addname_dataframe.to_excel(daily_201512_excel_writer,'1_2',index=False)
daily_201512_excel_writer.save()
daily_20151202 = pro.daily(start_date='',end_date='',trade_date='20151202', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20151202_tscode_list = list() 
for ts_code_sh in daily_20151202['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20151202_tscode_list.append(stock_name)
daily_20151202_addname_dataframe=pd.DataFrame()
daily_20151202_addname_dataframe['cname'] = daily_20151202_tscode_list
for table_name in daily_20151202.columns.values.tolist():
    daily_20151202_addname_dataframe[table_name] = daily_20151202[table_name]
print("日线行情-时间为序  daily_20151202 返回数据 row 行数 = "+str(daily_20151202.shape[0]))
daily_20151202_addname_dataframe.to_excel(daily_201512_excel_writer,'2_3',index=False)
daily_201512_excel_writer.save()
daily_20151203 = pro.daily(start_date='',end_date='',trade_date='20151203', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20151203_tscode_list = list() 
for ts_code_sh in daily_20151203['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20151203_tscode_list.append(stock_name)
daily_20151203_addname_dataframe=pd.DataFrame()
daily_20151203_addname_dataframe['cname'] = daily_20151203_tscode_list
for table_name in daily_20151203.columns.values.tolist():
    daily_20151203_addname_dataframe[table_name] = daily_20151203[table_name]
print("日线行情-时间为序  daily_20151203 返回数据 row 行数 = "+str(daily_20151203.shape[0]))
daily_20151203_addname_dataframe.to_excel(daily_201512_excel_writer,'3_4',index=False)
daily_201512_excel_writer.save()
daily_20151204 = pro.daily(start_date='',end_date='',trade_date='20151204', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20151204_tscode_list = list() 
for ts_code_sh in daily_20151204['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20151204_tscode_list.append(stock_name)
daily_20151204_addname_dataframe=pd.DataFrame()
daily_20151204_addname_dataframe['cname'] = daily_20151204_tscode_list
for table_name in daily_20151204.columns.values.tolist():
    daily_20151204_addname_dataframe[table_name] = daily_20151204[table_name]
print("日线行情-时间为序  daily_20151204 返回数据 row 行数 = "+str(daily_20151204.shape[0]))
daily_20151204_addname_dataframe.to_excel(daily_201512_excel_writer,'4_5',index=False)
daily_201512_excel_writer.save()
daily_20151207 = pro.daily(start_date='',end_date='',trade_date='20151207', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20151207_tscode_list = list() 
for ts_code_sh in daily_20151207['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20151207_tscode_list.append(stock_name)
daily_20151207_addname_dataframe=pd.DataFrame()
daily_20151207_addname_dataframe['cname'] = daily_20151207_tscode_list
for table_name in daily_20151207.columns.values.tolist():
    daily_20151207_addname_dataframe[table_name] = daily_20151207[table_name]
print("日线行情-时间为序  daily_20151207 返回数据 row 行数 = "+str(daily_20151207.shape[0]))
daily_20151207_addname_dataframe.to_excel(daily_201512_excel_writer,'7_1',index=False)
daily_201512_excel_writer.save()
daily_20151208 = pro.daily(start_date='',end_date='',trade_date='20151208', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20151208_tscode_list = list() 
for ts_code_sh in daily_20151208['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20151208_tscode_list.append(stock_name)
daily_20151208_addname_dataframe=pd.DataFrame()
daily_20151208_addname_dataframe['cname'] = daily_20151208_tscode_list
for table_name in daily_20151208.columns.values.tolist():
    daily_20151208_addname_dataframe[table_name] = daily_20151208[table_name]
print("日线行情-时间为序  daily_20151208 返回数据 row 行数 = "+str(daily_20151208.shape[0]))
daily_20151208_addname_dataframe.to_excel(daily_201512_excel_writer,'8_2',index=False)
daily_201512_excel_writer.save()
daily_20151209 = pro.daily(start_date='',end_date='',trade_date='20151209', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20151209_tscode_list = list() 
for ts_code_sh in daily_20151209['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20151209_tscode_list.append(stock_name)
daily_20151209_addname_dataframe=pd.DataFrame()
daily_20151209_addname_dataframe['cname'] = daily_20151209_tscode_list
for table_name in daily_20151209.columns.values.tolist():
    daily_20151209_addname_dataframe[table_name] = daily_20151209[table_name]
print("日线行情-时间为序  daily_20151209 返回数据 row 行数 = "+str(daily_20151209.shape[0]))
daily_20151209_addname_dataframe.to_excel(daily_201512_excel_writer,'9_3',index=False)
daily_201512_excel_writer.save()
daily_20151210 = pro.daily(start_date='',end_date='',trade_date='20151210', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20151210_tscode_list = list() 
for ts_code_sh in daily_20151210['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20151210_tscode_list.append(stock_name)
daily_20151210_addname_dataframe=pd.DataFrame()
daily_20151210_addname_dataframe['cname'] = daily_20151210_tscode_list
for table_name in daily_20151210.columns.values.tolist():
    daily_20151210_addname_dataframe[table_name] = daily_20151210[table_name]
print("日线行情-时间为序  daily_20151210 返回数据 row 行数 = "+str(daily_20151210.shape[0]))
daily_20151210_addname_dataframe.to_excel(daily_201512_excel_writer,'10_4',index=False)
daily_201512_excel_writer.save()
daily_20151211 = pro.daily(start_date='',end_date='',trade_date='20151211', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20151211_tscode_list = list() 
for ts_code_sh in daily_20151211['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20151211_tscode_list.append(stock_name)
daily_20151211_addname_dataframe=pd.DataFrame()
daily_20151211_addname_dataframe['cname'] = daily_20151211_tscode_list
for table_name in daily_20151211.columns.values.tolist():
    daily_20151211_addname_dataframe[table_name] = daily_20151211[table_name]
print("日线行情-时间为序  daily_20151211 返回数据 row 行数 = "+str(daily_20151211.shape[0]))
daily_20151211_addname_dataframe.to_excel(daily_201512_excel_writer,'11_5',index=False)
daily_201512_excel_writer.save()
daily_20151214 = pro.daily(start_date='',end_date='',trade_date='20151214', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20151214_tscode_list = list() 
for ts_code_sh in daily_20151214['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20151214_tscode_list.append(stock_name)
daily_20151214_addname_dataframe=pd.DataFrame()
daily_20151214_addname_dataframe['cname'] = daily_20151214_tscode_list
for table_name in daily_20151214.columns.values.tolist():
    daily_20151214_addname_dataframe[table_name] = daily_20151214[table_name]
print("日线行情-时间为序  daily_20151214 返回数据 row 行数 = "+str(daily_20151214.shape[0]))
daily_20151214_addname_dataframe.to_excel(daily_201512_excel_writer,'14_1',index=False)
daily_201512_excel_writer.save()
daily_20151215 = pro.daily(start_date='',end_date='',trade_date='20151215', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20151215_tscode_list = list() 
for ts_code_sh in daily_20151215['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20151215_tscode_list.append(stock_name)
daily_20151215_addname_dataframe=pd.DataFrame()
daily_20151215_addname_dataframe['cname'] = daily_20151215_tscode_list
for table_name in daily_20151215.columns.values.tolist():
    daily_20151215_addname_dataframe[table_name] = daily_20151215[table_name]
print("日线行情-时间为序  daily_20151215 返回数据 row 行数 = "+str(daily_20151215.shape[0]))
daily_20151215_addname_dataframe.to_excel(daily_201512_excel_writer,'15_2',index=False)
daily_201512_excel_writer.save()
daily_20151216 = pro.daily(start_date='',end_date='',trade_date='20151216', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20151216_tscode_list = list() 
for ts_code_sh in daily_20151216['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20151216_tscode_list.append(stock_name)
daily_20151216_addname_dataframe=pd.DataFrame()
daily_20151216_addname_dataframe['cname'] = daily_20151216_tscode_list
for table_name in daily_20151216.columns.values.tolist():
    daily_20151216_addname_dataframe[table_name] = daily_20151216[table_name]
print("日线行情-时间为序  daily_20151216 返回数据 row 行数 = "+str(daily_20151216.shape[0]))
daily_20151216_addname_dataframe.to_excel(daily_201512_excel_writer,'16_3',index=False)
daily_201512_excel_writer.save()
daily_20151217 = pro.daily(start_date='',end_date='',trade_date='20151217', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20151217_tscode_list = list() 
for ts_code_sh in daily_20151217['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20151217_tscode_list.append(stock_name)
daily_20151217_addname_dataframe=pd.DataFrame()
daily_20151217_addname_dataframe['cname'] = daily_20151217_tscode_list
for table_name in daily_20151217.columns.values.tolist():
    daily_20151217_addname_dataframe[table_name] = daily_20151217[table_name]
print("日线行情-时间为序  daily_20151217 返回数据 row 行数 = "+str(daily_20151217.shape[0]))
daily_20151217_addname_dataframe.to_excel(daily_201512_excel_writer,'17_4',index=False)
daily_201512_excel_writer.save()
daily_20151218 = pro.daily(start_date='',end_date='',trade_date='20151218', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20151218_tscode_list = list() 
for ts_code_sh in daily_20151218['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20151218_tscode_list.append(stock_name)
daily_20151218_addname_dataframe=pd.DataFrame()
daily_20151218_addname_dataframe['cname'] = daily_20151218_tscode_list
for table_name in daily_20151218.columns.values.tolist():
    daily_20151218_addname_dataframe[table_name] = daily_20151218[table_name]
print("日线行情-时间为序  daily_20151218 返回数据 row 行数 = "+str(daily_20151218.shape[0]))
daily_20151218_addname_dataframe.to_excel(daily_201512_excel_writer,'18_5',index=False)
daily_201512_excel_writer.save()
daily_20151221 = pro.daily(start_date='',end_date='',trade_date='20151221', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20151221_tscode_list = list() 
for ts_code_sh in daily_20151221['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20151221_tscode_list.append(stock_name)
daily_20151221_addname_dataframe=pd.DataFrame()
daily_20151221_addname_dataframe['cname'] = daily_20151221_tscode_list
for table_name in daily_20151221.columns.values.tolist():
    daily_20151221_addname_dataframe[table_name] = daily_20151221[table_name]
print("日线行情-时间为序  daily_20151221 返回数据 row 行数 = "+str(daily_20151221.shape[0]))
daily_20151221_addname_dataframe.to_excel(daily_201512_excel_writer,'21_1',index=False)
daily_201512_excel_writer.save()
daily_20151222 = pro.daily(start_date='',end_date='',trade_date='20151222', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20151222_tscode_list = list() 
for ts_code_sh in daily_20151222['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20151222_tscode_list.append(stock_name)
daily_20151222_addname_dataframe=pd.DataFrame()
daily_20151222_addname_dataframe['cname'] = daily_20151222_tscode_list
for table_name in daily_20151222.columns.values.tolist():
    daily_20151222_addname_dataframe[table_name] = daily_20151222[table_name]
print("日线行情-时间为序  daily_20151222 返回数据 row 行数 = "+str(daily_20151222.shape[0]))
daily_20151222_addname_dataframe.to_excel(daily_201512_excel_writer,'22_2',index=False)
daily_201512_excel_writer.save()
daily_20151223 = pro.daily(start_date='',end_date='',trade_date='20151223', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20151223_tscode_list = list() 
for ts_code_sh in daily_20151223['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20151223_tscode_list.append(stock_name)
daily_20151223_addname_dataframe=pd.DataFrame()
daily_20151223_addname_dataframe['cname'] = daily_20151223_tscode_list
for table_name in daily_20151223.columns.values.tolist():
    daily_20151223_addname_dataframe[table_name] = daily_20151223[table_name]
print("日线行情-时间为序  daily_20151223 返回数据 row 行数 = "+str(daily_20151223.shape[0]))
daily_20151223_addname_dataframe.to_excel(daily_201512_excel_writer,'23_3',index=False)
daily_201512_excel_writer.save()
daily_20151224 = pro.daily(start_date='',end_date='',trade_date='20151224', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20151224_tscode_list = list() 
for ts_code_sh in daily_20151224['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20151224_tscode_list.append(stock_name)
daily_20151224_addname_dataframe=pd.DataFrame()
daily_20151224_addname_dataframe['cname'] = daily_20151224_tscode_list
for table_name in daily_20151224.columns.values.tolist():
    daily_20151224_addname_dataframe[table_name] = daily_20151224[table_name]
print("日线行情-时间为序  daily_20151224 返回数据 row 行数 = "+str(daily_20151224.shape[0]))
daily_20151224_addname_dataframe.to_excel(daily_201512_excel_writer,'24_4',index=False)
daily_201512_excel_writer.save()
daily_20151225 = pro.daily(start_date='',end_date='',trade_date='20151225', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20151225_tscode_list = list() 
for ts_code_sh in daily_20151225['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20151225_tscode_list.append(stock_name)
daily_20151225_addname_dataframe=pd.DataFrame()
daily_20151225_addname_dataframe['cname'] = daily_20151225_tscode_list
for table_name in daily_20151225.columns.values.tolist():
    daily_20151225_addname_dataframe[table_name] = daily_20151225[table_name]
print("日线行情-时间为序  daily_20151225 返回数据 row 行数 = "+str(daily_20151225.shape[0]))
daily_20151225_addname_dataframe.to_excel(daily_201512_excel_writer,'25_5',index=False)
daily_201512_excel_writer.save()
daily_20151228 = pro.daily(start_date='',end_date='',trade_date='20151228', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20151228_tscode_list = list() 
for ts_code_sh in daily_20151228['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20151228_tscode_list.append(stock_name)
daily_20151228_addname_dataframe=pd.DataFrame()
daily_20151228_addname_dataframe['cname'] = daily_20151228_tscode_list
for table_name in daily_20151228.columns.values.tolist():
    daily_20151228_addname_dataframe[table_name] = daily_20151228[table_name]
print("日线行情-时间为序  daily_20151228 返回数据 row 行数 = "+str(daily_20151228.shape[0]))
daily_20151228_addname_dataframe.to_excel(daily_201512_excel_writer,'28_1',index=False)
daily_201512_excel_writer.save()
daily_20151229 = pro.daily(start_date='',end_date='',trade_date='20151229', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20151229_tscode_list = list() 
for ts_code_sh in daily_20151229['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20151229_tscode_list.append(stock_name)
daily_20151229_addname_dataframe=pd.DataFrame()
daily_20151229_addname_dataframe['cname'] = daily_20151229_tscode_list
for table_name in daily_20151229.columns.values.tolist():
    daily_20151229_addname_dataframe[table_name] = daily_20151229[table_name]
print("日线行情-时间为序  daily_20151229 返回数据 row 行数 = "+str(daily_20151229.shape[0]))
daily_20151229_addname_dataframe.to_excel(daily_201512_excel_writer,'29_2',index=False)
daily_201512_excel_writer.save()
daily_20151230 = pro.daily(start_date='',end_date='',trade_date='20151230', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20151230_tscode_list = list() 
for ts_code_sh in daily_20151230['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20151230_tscode_list.append(stock_name)
daily_20151230_addname_dataframe=pd.DataFrame()
daily_20151230_addname_dataframe['cname'] = daily_20151230_tscode_list
for table_name in daily_20151230.columns.values.tolist():
    daily_20151230_addname_dataframe[table_name] = daily_20151230[table_name]
print("日线行情-时间为序  daily_20151230 返回数据 row 行数 = "+str(daily_20151230.shape[0]))
daily_20151230_addname_dataframe.to_excel(daily_201512_excel_writer,'30_3',index=False)
daily_201512_excel_writer.save()
daily_20151231 = pro.daily(start_date='',end_date='',trade_date='20151231', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20151231_tscode_list = list() 
for ts_code_sh in daily_20151231['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20151231_tscode_list.append(stock_name)
daily_20151231_addname_dataframe=pd.DataFrame()
daily_20151231_addname_dataframe['cname'] = daily_20151231_tscode_list
for table_name in daily_20151231.columns.values.tolist():
    daily_20151231_addname_dataframe[table_name] = daily_20151231[table_name]
print("日线行情-时间为序  daily_20151231 返回数据 row 行数 = "+str(daily_20151231.shape[0]))
daily_20151231_addname_dataframe.to_excel(daily_201512_excel_writer,'31_4',index=False)
daily_201512_excel_writer.save()




createexcel('daily_201601.xlsx')
daily_201601_book = load_workbook('C:\\Users\\zhuzj5\\Desktop\\zbin\\J0_Data\\daily_201601.xlsx')
daily_201601_excel_writer = pd.ExcelWriter('C:\\Users\\zhuzj5\\Desktop\\zbin\\J0_Data\\daily_201601.xlsx', engine='openpyxl')
daily_201601_excel_writer.book = daily_201601_book
daily_201601_excel_writer.sheets = dict((ws.title, ws) for ws in daily_201601_book.worksheets)
J0_PROPS.put(tree_node_name+"record_date", "20160101")       ###  更新 记录日期
daily_20160104 = pro.daily(start_date='',end_date='',trade_date='20160104', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20160104_tscode_list = list() 
for ts_code_sh in daily_20160104['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20160104_tscode_list.append(stock_name)
daily_20160104_addname_dataframe=pd.DataFrame()
daily_20160104_addname_dataframe['cname'] = daily_20160104_tscode_list
for table_name in daily_20160104.columns.values.tolist():
    daily_20160104_addname_dataframe[table_name] = daily_20160104[table_name]
print("日线行情-时间为序  daily_20160104 返回数据 row 行数 = "+str(daily_20160104.shape[0]))
daily_20160104_addname_dataframe.to_excel(daily_201601_excel_writer,'4_1',index=False)
daily_201601_excel_writer.save()
daily_20160105 = pro.daily(start_date='',end_date='',trade_date='20160105', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20160105_tscode_list = list() 
for ts_code_sh in daily_20160105['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20160105_tscode_list.append(stock_name)
daily_20160105_addname_dataframe=pd.DataFrame()
daily_20160105_addname_dataframe['cname'] = daily_20160105_tscode_list
for table_name in daily_20160105.columns.values.tolist():
    daily_20160105_addname_dataframe[table_name] = daily_20160105[table_name]
print("日线行情-时间为序  daily_20160105 返回数据 row 行数 = "+str(daily_20160105.shape[0]))
daily_20160105_addname_dataframe.to_excel(daily_201601_excel_writer,'5_2',index=False)
daily_201601_excel_writer.save()
daily_20160106 = pro.daily(start_date='',end_date='',trade_date='20160106', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20160106_tscode_list = list() 
for ts_code_sh in daily_20160106['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20160106_tscode_list.append(stock_name)
daily_20160106_addname_dataframe=pd.DataFrame()
daily_20160106_addname_dataframe['cname'] = daily_20160106_tscode_list
for table_name in daily_20160106.columns.values.tolist():
    daily_20160106_addname_dataframe[table_name] = daily_20160106[table_name]
print("日线行情-时间为序  daily_20160106 返回数据 row 行数 = "+str(daily_20160106.shape[0]))
daily_20160106_addname_dataframe.to_excel(daily_201601_excel_writer,'6_3',index=False)
daily_201601_excel_writer.save()
daily_20160107 = pro.daily(start_date='',end_date='',trade_date='20160107', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20160107_tscode_list = list() 
for ts_code_sh in daily_20160107['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20160107_tscode_list.append(stock_name)
daily_20160107_addname_dataframe=pd.DataFrame()
daily_20160107_addname_dataframe['cname'] = daily_20160107_tscode_list
for table_name in daily_20160107.columns.values.tolist():
    daily_20160107_addname_dataframe[table_name] = daily_20160107[table_name]
print("日线行情-时间为序  daily_20160107 返回数据 row 行数 = "+str(daily_20160107.shape[0]))
daily_20160107_addname_dataframe.to_excel(daily_201601_excel_writer,'7_4',index=False)
daily_201601_excel_writer.save()
daily_20160108 = pro.daily(start_date='',end_date='',trade_date='20160108', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20160108_tscode_list = list() 
for ts_code_sh in daily_20160108['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20160108_tscode_list.append(stock_name)
daily_20160108_addname_dataframe=pd.DataFrame()
daily_20160108_addname_dataframe['cname'] = daily_20160108_tscode_list
for table_name in daily_20160108.columns.values.tolist():
    daily_20160108_addname_dataframe[table_name] = daily_20160108[table_name]
print("日线行情-时间为序  daily_20160108 返回数据 row 行数 = "+str(daily_20160108.shape[0]))
daily_20160108_addname_dataframe.to_excel(daily_201601_excel_writer,'8_5',index=False)
daily_201601_excel_writer.save()
daily_20160111 = pro.daily(start_date='',end_date='',trade_date='20160111', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20160111_tscode_list = list() 
for ts_code_sh in daily_20160111['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20160111_tscode_list.append(stock_name)
daily_20160111_addname_dataframe=pd.DataFrame()
daily_20160111_addname_dataframe['cname'] = daily_20160111_tscode_list
for table_name in daily_20160111.columns.values.tolist():
    daily_20160111_addname_dataframe[table_name] = daily_20160111[table_name]
print("日线行情-时间为序  daily_20160111 返回数据 row 行数 = "+str(daily_20160111.shape[0]))
daily_20160111_addname_dataframe.to_excel(daily_201601_excel_writer,'11_1',index=False)
daily_201601_excel_writer.save()
daily_20160112 = pro.daily(start_date='',end_date='',trade_date='20160112', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20160112_tscode_list = list() 
for ts_code_sh in daily_20160112['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20160112_tscode_list.append(stock_name)
daily_20160112_addname_dataframe=pd.DataFrame()
daily_20160112_addname_dataframe['cname'] = daily_20160112_tscode_list
for table_name in daily_20160112.columns.values.tolist():
    daily_20160112_addname_dataframe[table_name] = daily_20160112[table_name]
print("日线行情-时间为序  daily_20160112 返回数据 row 行数 = "+str(daily_20160112.shape[0]))
daily_20160112_addname_dataframe.to_excel(daily_201601_excel_writer,'12_2',index=False)
daily_201601_excel_writer.save()
daily_20160113 = pro.daily(start_date='',end_date='',trade_date='20160113', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20160113_tscode_list = list() 
for ts_code_sh in daily_20160113['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20160113_tscode_list.append(stock_name)
daily_20160113_addname_dataframe=pd.DataFrame()
daily_20160113_addname_dataframe['cname'] = daily_20160113_tscode_list
for table_name in daily_20160113.columns.values.tolist():
    daily_20160113_addname_dataframe[table_name] = daily_20160113[table_name]
print("日线行情-时间为序  daily_20160113 返回数据 row 行数 = "+str(daily_20160113.shape[0]))
daily_20160113_addname_dataframe.to_excel(daily_201601_excel_writer,'13_3',index=False)
daily_201601_excel_writer.save()
daily_20160114 = pro.daily(start_date='',end_date='',trade_date='20160114', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20160114_tscode_list = list() 
for ts_code_sh in daily_20160114['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20160114_tscode_list.append(stock_name)
daily_20160114_addname_dataframe=pd.DataFrame()
daily_20160114_addname_dataframe['cname'] = daily_20160114_tscode_list
for table_name in daily_20160114.columns.values.tolist():
    daily_20160114_addname_dataframe[table_name] = daily_20160114[table_name]
print("日线行情-时间为序  daily_20160114 返回数据 row 行数 = "+str(daily_20160114.shape[0]))
daily_20160114_addname_dataframe.to_excel(daily_201601_excel_writer,'14_4',index=False)
daily_201601_excel_writer.save()
daily_20160115 = pro.daily(start_date='',end_date='',trade_date='20160115', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20160115_tscode_list = list() 
for ts_code_sh in daily_20160115['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20160115_tscode_list.append(stock_name)
daily_20160115_addname_dataframe=pd.DataFrame()
daily_20160115_addname_dataframe['cname'] = daily_20160115_tscode_list
for table_name in daily_20160115.columns.values.tolist():
    daily_20160115_addname_dataframe[table_name] = daily_20160115[table_name]
print("日线行情-时间为序  daily_20160115 返回数据 row 行数 = "+str(daily_20160115.shape[0]))
daily_20160115_addname_dataframe.to_excel(daily_201601_excel_writer,'15_5',index=False)
daily_201601_excel_writer.save()
daily_20160118 = pro.daily(start_date='',end_date='',trade_date='20160118', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20160118_tscode_list = list() 
for ts_code_sh in daily_20160118['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20160118_tscode_list.append(stock_name)
daily_20160118_addname_dataframe=pd.DataFrame()
daily_20160118_addname_dataframe['cname'] = daily_20160118_tscode_list
for table_name in daily_20160118.columns.values.tolist():
    daily_20160118_addname_dataframe[table_name] = daily_20160118[table_name]
print("日线行情-时间为序  daily_20160118 返回数据 row 行数 = "+str(daily_20160118.shape[0]))
daily_20160118_addname_dataframe.to_excel(daily_201601_excel_writer,'18_1',index=False)
daily_201601_excel_writer.save()
daily_20160119 = pro.daily(start_date='',end_date='',trade_date='20160119', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20160119_tscode_list = list() 
for ts_code_sh in daily_20160119['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20160119_tscode_list.append(stock_name)
daily_20160119_addname_dataframe=pd.DataFrame()
daily_20160119_addname_dataframe['cname'] = daily_20160119_tscode_list
for table_name in daily_20160119.columns.values.tolist():
    daily_20160119_addname_dataframe[table_name] = daily_20160119[table_name]
print("日线行情-时间为序  daily_20160119 返回数据 row 行数 = "+str(daily_20160119.shape[0]))
daily_20160119_addname_dataframe.to_excel(daily_201601_excel_writer,'19_2',index=False)
daily_201601_excel_writer.save()
daily_20160120 = pro.daily(start_date='',end_date='',trade_date='20160120', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20160120_tscode_list = list() 
for ts_code_sh in daily_20160120['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20160120_tscode_list.append(stock_name)
daily_20160120_addname_dataframe=pd.DataFrame()
daily_20160120_addname_dataframe['cname'] = daily_20160120_tscode_list
for table_name in daily_20160120.columns.values.tolist():
    daily_20160120_addname_dataframe[table_name] = daily_20160120[table_name]
print("日线行情-时间为序  daily_20160120 返回数据 row 行数 = "+str(daily_20160120.shape[0]))
daily_20160120_addname_dataframe.to_excel(daily_201601_excel_writer,'20_3',index=False)
daily_201601_excel_writer.save()
daily_20160121 = pro.daily(start_date='',end_date='',trade_date='20160121', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20160121_tscode_list = list() 
for ts_code_sh in daily_20160121['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20160121_tscode_list.append(stock_name)
daily_20160121_addname_dataframe=pd.DataFrame()
daily_20160121_addname_dataframe['cname'] = daily_20160121_tscode_list
for table_name in daily_20160121.columns.values.tolist():
    daily_20160121_addname_dataframe[table_name] = daily_20160121[table_name]
print("日线行情-时间为序  daily_20160121 返回数据 row 行数 = "+str(daily_20160121.shape[0]))
daily_20160121_addname_dataframe.to_excel(daily_201601_excel_writer,'21_4',index=False)
daily_201601_excel_writer.save()
daily_20160122 = pro.daily(start_date='',end_date='',trade_date='20160122', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20160122_tscode_list = list() 
for ts_code_sh in daily_20160122['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20160122_tscode_list.append(stock_name)
daily_20160122_addname_dataframe=pd.DataFrame()
daily_20160122_addname_dataframe['cname'] = daily_20160122_tscode_list
for table_name in daily_20160122.columns.values.tolist():
    daily_20160122_addname_dataframe[table_name] = daily_20160122[table_name]
print("日线行情-时间为序  daily_20160122 返回数据 row 行数 = "+str(daily_20160122.shape[0]))
daily_20160122_addname_dataframe.to_excel(daily_201601_excel_writer,'22_5',index=False)
daily_201601_excel_writer.save()
daily_20160125 = pro.daily(start_date='',end_date='',trade_date='20160125', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20160125_tscode_list = list() 
for ts_code_sh in daily_20160125['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20160125_tscode_list.append(stock_name)
daily_20160125_addname_dataframe=pd.DataFrame()
daily_20160125_addname_dataframe['cname'] = daily_20160125_tscode_list
for table_name in daily_20160125.columns.values.tolist():
    daily_20160125_addname_dataframe[table_name] = daily_20160125[table_name]
print("日线行情-时间为序  daily_20160125 返回数据 row 行数 = "+str(daily_20160125.shape[0]))
daily_20160125_addname_dataframe.to_excel(daily_201601_excel_writer,'25_1',index=False)
daily_201601_excel_writer.save()
daily_20160126 = pro.daily(start_date='',end_date='',trade_date='20160126', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20160126_tscode_list = list() 
for ts_code_sh in daily_20160126['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20160126_tscode_list.append(stock_name)
daily_20160126_addname_dataframe=pd.DataFrame()
daily_20160126_addname_dataframe['cname'] = daily_20160126_tscode_list
for table_name in daily_20160126.columns.values.tolist():
    daily_20160126_addname_dataframe[table_name] = daily_20160126[table_name]
print("日线行情-时间为序  daily_20160126 返回数据 row 行数 = "+str(daily_20160126.shape[0]))
daily_20160126_addname_dataframe.to_excel(daily_201601_excel_writer,'26_2',index=False)
daily_201601_excel_writer.save()
daily_20160127 = pro.daily(start_date='',end_date='',trade_date='20160127', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20160127_tscode_list = list() 
for ts_code_sh in daily_20160127['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20160127_tscode_list.append(stock_name)
daily_20160127_addname_dataframe=pd.DataFrame()
daily_20160127_addname_dataframe['cname'] = daily_20160127_tscode_list
for table_name in daily_20160127.columns.values.tolist():
    daily_20160127_addname_dataframe[table_name] = daily_20160127[table_name]
print("日线行情-时间为序  daily_20160127 返回数据 row 行数 = "+str(daily_20160127.shape[0]))
daily_20160127_addname_dataframe.to_excel(daily_201601_excel_writer,'27_3',index=False)
daily_201601_excel_writer.save()
daily_20160128 = pro.daily(start_date='',end_date='',trade_date='20160128', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20160128_tscode_list = list() 
for ts_code_sh in daily_20160128['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20160128_tscode_list.append(stock_name)
daily_20160128_addname_dataframe=pd.DataFrame()
daily_20160128_addname_dataframe['cname'] = daily_20160128_tscode_list
for table_name in daily_20160128.columns.values.tolist():
    daily_20160128_addname_dataframe[table_name] = daily_20160128[table_name]
print("日线行情-时间为序  daily_20160128 返回数据 row 行数 = "+str(daily_20160128.shape[0]))
daily_20160128_addname_dataframe.to_excel(daily_201601_excel_writer,'28_4',index=False)
daily_201601_excel_writer.save()
daily_20160129 = pro.daily(start_date='',end_date='',trade_date='20160129', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20160129_tscode_list = list() 
for ts_code_sh in daily_20160129['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20160129_tscode_list.append(stock_name)
daily_20160129_addname_dataframe=pd.DataFrame()
daily_20160129_addname_dataframe['cname'] = daily_20160129_tscode_list
for table_name in daily_20160129.columns.values.tolist():
    daily_20160129_addname_dataframe[table_name] = daily_20160129[table_name]
print("日线行情-时间为序  daily_20160129 返回数据 row 行数 = "+str(daily_20160129.shape[0]))
daily_20160129_addname_dataframe.to_excel(daily_201601_excel_writer,'29_5',index=False)
daily_201601_excel_writer.save()




createexcel('daily_201602.xlsx')
daily_201602_book = load_workbook('C:\\Users\\zhuzj5\\Desktop\\zbin\\J0_Data\\daily_201602.xlsx')
daily_201602_excel_writer = pd.ExcelWriter('C:\\Users\\zhuzj5\\Desktop\\zbin\\J0_Data\\daily_201602.xlsx', engine='openpyxl')
daily_201602_excel_writer.book = daily_201602_book
daily_201602_excel_writer.sheets = dict((ws.title, ws) for ws in daily_201602_book.worksheets)
J0_PROPS.put(tree_node_name+"record_date", "20160201")       ###  更新 记录日期
daily_20160201 = pro.daily(start_date='',end_date='',trade_date='20160201', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20160201_tscode_list = list() 
for ts_code_sh in daily_20160201['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20160201_tscode_list.append(stock_name)
daily_20160201_addname_dataframe=pd.DataFrame()
daily_20160201_addname_dataframe['cname'] = daily_20160201_tscode_list
for table_name in daily_20160201.columns.values.tolist():
    daily_20160201_addname_dataframe[table_name] = daily_20160201[table_name]
print("日线行情-时间为序  daily_20160201 返回数据 row 行数 = "+str(daily_20160201.shape[0]))
daily_20160201_addname_dataframe.to_excel(daily_201602_excel_writer,'1_1',index=False)
daily_201602_excel_writer.save()
daily_20160202 = pro.daily(start_date='',end_date='',trade_date='20160202', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20160202_tscode_list = list() 
for ts_code_sh in daily_20160202['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20160202_tscode_list.append(stock_name)
daily_20160202_addname_dataframe=pd.DataFrame()
daily_20160202_addname_dataframe['cname'] = daily_20160202_tscode_list
for table_name in daily_20160202.columns.values.tolist():
    daily_20160202_addname_dataframe[table_name] = daily_20160202[table_name]
print("日线行情-时间为序  daily_20160202 返回数据 row 行数 = "+str(daily_20160202.shape[0]))
daily_20160202_addname_dataframe.to_excel(daily_201602_excel_writer,'2_2',index=False)
daily_201602_excel_writer.save()
daily_20160203 = pro.daily(start_date='',end_date='',trade_date='20160203', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20160203_tscode_list = list() 
for ts_code_sh in daily_20160203['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20160203_tscode_list.append(stock_name)
daily_20160203_addname_dataframe=pd.DataFrame()
daily_20160203_addname_dataframe['cname'] = daily_20160203_tscode_list
for table_name in daily_20160203.columns.values.tolist():
    daily_20160203_addname_dataframe[table_name] = daily_20160203[table_name]
print("日线行情-时间为序  daily_20160203 返回数据 row 行数 = "+str(daily_20160203.shape[0]))
daily_20160203_addname_dataframe.to_excel(daily_201602_excel_writer,'3_3',index=False)
daily_201602_excel_writer.save()
daily_20160204 = pro.daily(start_date='',end_date='',trade_date='20160204', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20160204_tscode_list = list() 
for ts_code_sh in daily_20160204['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20160204_tscode_list.append(stock_name)
daily_20160204_addname_dataframe=pd.DataFrame()
daily_20160204_addname_dataframe['cname'] = daily_20160204_tscode_list
for table_name in daily_20160204.columns.values.tolist():
    daily_20160204_addname_dataframe[table_name] = daily_20160204[table_name]
print("日线行情-时间为序  daily_20160204 返回数据 row 行数 = "+str(daily_20160204.shape[0]))
daily_20160204_addname_dataframe.to_excel(daily_201602_excel_writer,'4_4',index=False)
daily_201602_excel_writer.save()
daily_20160205 = pro.daily(start_date='',end_date='',trade_date='20160205', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20160205_tscode_list = list() 
for ts_code_sh in daily_20160205['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20160205_tscode_list.append(stock_name)
daily_20160205_addname_dataframe=pd.DataFrame()
daily_20160205_addname_dataframe['cname'] = daily_20160205_tscode_list
for table_name in daily_20160205.columns.values.tolist():
    daily_20160205_addname_dataframe[table_name] = daily_20160205[table_name]
print("日线行情-时间为序  daily_20160205 返回数据 row 行数 = "+str(daily_20160205.shape[0]))
daily_20160205_addname_dataframe.to_excel(daily_201602_excel_writer,'5_5',index=False)
daily_201602_excel_writer.save()
daily_20160215 = pro.daily(start_date='',end_date='',trade_date='20160215', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20160215_tscode_list = list() 
for ts_code_sh in daily_20160215['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20160215_tscode_list.append(stock_name)
daily_20160215_addname_dataframe=pd.DataFrame()
daily_20160215_addname_dataframe['cname'] = daily_20160215_tscode_list
for table_name in daily_20160215.columns.values.tolist():
    daily_20160215_addname_dataframe[table_name] = daily_20160215[table_name]
print("日线行情-时间为序  daily_20160215 返回数据 row 行数 = "+str(daily_20160215.shape[0]))
daily_20160215_addname_dataframe.to_excel(daily_201602_excel_writer,'15_1',index=False)
daily_201602_excel_writer.save()
daily_20160216 = pro.daily(start_date='',end_date='',trade_date='20160216', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20160216_tscode_list = list() 
for ts_code_sh in daily_20160216['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20160216_tscode_list.append(stock_name)
daily_20160216_addname_dataframe=pd.DataFrame()
daily_20160216_addname_dataframe['cname'] = daily_20160216_tscode_list
for table_name in daily_20160216.columns.values.tolist():
    daily_20160216_addname_dataframe[table_name] = daily_20160216[table_name]
print("日线行情-时间为序  daily_20160216 返回数据 row 行数 = "+str(daily_20160216.shape[0]))
daily_20160216_addname_dataframe.to_excel(daily_201602_excel_writer,'16_2',index=False)
daily_201602_excel_writer.save()
daily_20160217 = pro.daily(start_date='',end_date='',trade_date='20160217', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20160217_tscode_list = list() 
for ts_code_sh in daily_20160217['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20160217_tscode_list.append(stock_name)
daily_20160217_addname_dataframe=pd.DataFrame()
daily_20160217_addname_dataframe['cname'] = daily_20160217_tscode_list
for table_name in daily_20160217.columns.values.tolist():
    daily_20160217_addname_dataframe[table_name] = daily_20160217[table_name]
print("日线行情-时间为序  daily_20160217 返回数据 row 行数 = "+str(daily_20160217.shape[0]))
daily_20160217_addname_dataframe.to_excel(daily_201602_excel_writer,'17_3',index=False)
daily_201602_excel_writer.save()
daily_20160218 = pro.daily(start_date='',end_date='',trade_date='20160218', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20160218_tscode_list = list() 
for ts_code_sh in daily_20160218['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20160218_tscode_list.append(stock_name)
daily_20160218_addname_dataframe=pd.DataFrame()
daily_20160218_addname_dataframe['cname'] = daily_20160218_tscode_list
for table_name in daily_20160218.columns.values.tolist():
    daily_20160218_addname_dataframe[table_name] = daily_20160218[table_name]
print("日线行情-时间为序  daily_20160218 返回数据 row 行数 = "+str(daily_20160218.shape[0]))
daily_20160218_addname_dataframe.to_excel(daily_201602_excel_writer,'18_4',index=False)
daily_201602_excel_writer.save()
daily_20160219 = pro.daily(start_date='',end_date='',trade_date='20160219', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20160219_tscode_list = list() 
for ts_code_sh in daily_20160219['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20160219_tscode_list.append(stock_name)
daily_20160219_addname_dataframe=pd.DataFrame()
daily_20160219_addname_dataframe['cname'] = daily_20160219_tscode_list
for table_name in daily_20160219.columns.values.tolist():
    daily_20160219_addname_dataframe[table_name] = daily_20160219[table_name]
print("日线行情-时间为序  daily_20160219 返回数据 row 行数 = "+str(daily_20160219.shape[0]))
daily_20160219_addname_dataframe.to_excel(daily_201602_excel_writer,'19_5',index=False)
daily_201602_excel_writer.save()
daily_20160222 = pro.daily(start_date='',end_date='',trade_date='20160222', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20160222_tscode_list = list() 
for ts_code_sh in daily_20160222['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20160222_tscode_list.append(stock_name)
daily_20160222_addname_dataframe=pd.DataFrame()
daily_20160222_addname_dataframe['cname'] = daily_20160222_tscode_list
for table_name in daily_20160222.columns.values.tolist():
    daily_20160222_addname_dataframe[table_name] = daily_20160222[table_name]
print("日线行情-时间为序  daily_20160222 返回数据 row 行数 = "+str(daily_20160222.shape[0]))
daily_20160222_addname_dataframe.to_excel(daily_201602_excel_writer,'22_1',index=False)
daily_201602_excel_writer.save()
daily_20160223 = pro.daily(start_date='',end_date='',trade_date='20160223', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20160223_tscode_list = list() 
for ts_code_sh in daily_20160223['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20160223_tscode_list.append(stock_name)
daily_20160223_addname_dataframe=pd.DataFrame()
daily_20160223_addname_dataframe['cname'] = daily_20160223_tscode_list
for table_name in daily_20160223.columns.values.tolist():
    daily_20160223_addname_dataframe[table_name] = daily_20160223[table_name]
print("日线行情-时间为序  daily_20160223 返回数据 row 行数 = "+str(daily_20160223.shape[0]))
daily_20160223_addname_dataframe.to_excel(daily_201602_excel_writer,'23_2',index=False)
daily_201602_excel_writer.save()
daily_20160224 = pro.daily(start_date='',end_date='',trade_date='20160224', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20160224_tscode_list = list() 
for ts_code_sh in daily_20160224['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20160224_tscode_list.append(stock_name)
daily_20160224_addname_dataframe=pd.DataFrame()
daily_20160224_addname_dataframe['cname'] = daily_20160224_tscode_list
for table_name in daily_20160224.columns.values.tolist():
    daily_20160224_addname_dataframe[table_name] = daily_20160224[table_name]
print("日线行情-时间为序  daily_20160224 返回数据 row 行数 = "+str(daily_20160224.shape[0]))
daily_20160224_addname_dataframe.to_excel(daily_201602_excel_writer,'24_3',index=False)
daily_201602_excel_writer.save()
daily_20160225 = pro.daily(start_date='',end_date='',trade_date='20160225', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20160225_tscode_list = list() 
for ts_code_sh in daily_20160225['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20160225_tscode_list.append(stock_name)
daily_20160225_addname_dataframe=pd.DataFrame()
daily_20160225_addname_dataframe['cname'] = daily_20160225_tscode_list
for table_name in daily_20160225.columns.values.tolist():
    daily_20160225_addname_dataframe[table_name] = daily_20160225[table_name]
print("日线行情-时间为序  daily_20160225 返回数据 row 行数 = "+str(daily_20160225.shape[0]))
daily_20160225_addname_dataframe.to_excel(daily_201602_excel_writer,'25_4',index=False)
daily_201602_excel_writer.save()
daily_20160226 = pro.daily(start_date='',end_date='',trade_date='20160226', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20160226_tscode_list = list() 
for ts_code_sh in daily_20160226['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20160226_tscode_list.append(stock_name)
daily_20160226_addname_dataframe=pd.DataFrame()
daily_20160226_addname_dataframe['cname'] = daily_20160226_tscode_list
for table_name in daily_20160226.columns.values.tolist():
    daily_20160226_addname_dataframe[table_name] = daily_20160226[table_name]
print("日线行情-时间为序  daily_20160226 返回数据 row 行数 = "+str(daily_20160226.shape[0]))
daily_20160226_addname_dataframe.to_excel(daily_201602_excel_writer,'26_5',index=False)
daily_201602_excel_writer.save()
daily_20160229 = pro.daily(start_date='',end_date='',trade_date='20160229', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20160229_tscode_list = list() 
for ts_code_sh in daily_20160229['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20160229_tscode_list.append(stock_name)
daily_20160229_addname_dataframe=pd.DataFrame()
daily_20160229_addname_dataframe['cname'] = daily_20160229_tscode_list
for table_name in daily_20160229.columns.values.tolist():
    daily_20160229_addname_dataframe[table_name] = daily_20160229[table_name]
print("日线行情-时间为序  daily_20160229 返回数据 row 行数 = "+str(daily_20160229.shape[0]))
daily_20160229_addname_dataframe.to_excel(daily_201602_excel_writer,'29_1',index=False)
daily_201602_excel_writer.save()




createexcel('daily_201603.xlsx')
daily_201603_book = load_workbook('C:\\Users\\zhuzj5\\Desktop\\zbin\\J0_Data\\daily_201603.xlsx')
daily_201603_excel_writer = pd.ExcelWriter('C:\\Users\\zhuzj5\\Desktop\\zbin\\J0_Data\\daily_201603.xlsx', engine='openpyxl')
daily_201603_excel_writer.book = daily_201603_book
daily_201603_excel_writer.sheets = dict((ws.title, ws) for ws in daily_201603_book.worksheets)
J0_PROPS.put(tree_node_name+"record_date", "20160301")       ###  更新 记录日期
daily_20160301 = pro.daily(start_date='',end_date='',trade_date='20160301', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20160301_tscode_list = list() 
for ts_code_sh in daily_20160301['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20160301_tscode_list.append(stock_name)
daily_20160301_addname_dataframe=pd.DataFrame()
daily_20160301_addname_dataframe['cname'] = daily_20160301_tscode_list
for table_name in daily_20160301.columns.values.tolist():
    daily_20160301_addname_dataframe[table_name] = daily_20160301[table_name]
print("日线行情-时间为序  daily_20160301 返回数据 row 行数 = "+str(daily_20160301.shape[0]))
daily_20160301_addname_dataframe.to_excel(daily_201603_excel_writer,'1_2',index=False)
daily_201603_excel_writer.save()
daily_20160302 = pro.daily(start_date='',end_date='',trade_date='20160302', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20160302_tscode_list = list() 
for ts_code_sh in daily_20160302['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20160302_tscode_list.append(stock_name)
daily_20160302_addname_dataframe=pd.DataFrame()
daily_20160302_addname_dataframe['cname'] = daily_20160302_tscode_list
for table_name in daily_20160302.columns.values.tolist():
    daily_20160302_addname_dataframe[table_name] = daily_20160302[table_name]
print("日线行情-时间为序  daily_20160302 返回数据 row 行数 = "+str(daily_20160302.shape[0]))
daily_20160302_addname_dataframe.to_excel(daily_201603_excel_writer,'2_3',index=False)
daily_201603_excel_writer.save()
daily_20160303 = pro.daily(start_date='',end_date='',trade_date='20160303', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20160303_tscode_list = list() 
for ts_code_sh in daily_20160303['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20160303_tscode_list.append(stock_name)
daily_20160303_addname_dataframe=pd.DataFrame()
daily_20160303_addname_dataframe['cname'] = daily_20160303_tscode_list
for table_name in daily_20160303.columns.values.tolist():
    daily_20160303_addname_dataframe[table_name] = daily_20160303[table_name]
print("日线行情-时间为序  daily_20160303 返回数据 row 行数 = "+str(daily_20160303.shape[0]))
daily_20160303_addname_dataframe.to_excel(daily_201603_excel_writer,'3_4',index=False)
daily_201603_excel_writer.save()
daily_20160304 = pro.daily(start_date='',end_date='',trade_date='20160304', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20160304_tscode_list = list() 
for ts_code_sh in daily_20160304['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20160304_tscode_list.append(stock_name)
daily_20160304_addname_dataframe=pd.DataFrame()
daily_20160304_addname_dataframe['cname'] = daily_20160304_tscode_list
for table_name in daily_20160304.columns.values.tolist():
    daily_20160304_addname_dataframe[table_name] = daily_20160304[table_name]
print("日线行情-时间为序  daily_20160304 返回数据 row 行数 = "+str(daily_20160304.shape[0]))
daily_20160304_addname_dataframe.to_excel(daily_201603_excel_writer,'4_5',index=False)
daily_201603_excel_writer.save()
daily_20160307 = pro.daily(start_date='',end_date='',trade_date='20160307', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20160307_tscode_list = list() 
for ts_code_sh in daily_20160307['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20160307_tscode_list.append(stock_name)
daily_20160307_addname_dataframe=pd.DataFrame()
daily_20160307_addname_dataframe['cname'] = daily_20160307_tscode_list
for table_name in daily_20160307.columns.values.tolist():
    daily_20160307_addname_dataframe[table_name] = daily_20160307[table_name]
print("日线行情-时间为序  daily_20160307 返回数据 row 行数 = "+str(daily_20160307.shape[0]))
daily_20160307_addname_dataframe.to_excel(daily_201603_excel_writer,'7_1',index=False)
daily_201603_excel_writer.save()
daily_20160308 = pro.daily(start_date='',end_date='',trade_date='20160308', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20160308_tscode_list = list() 
for ts_code_sh in daily_20160308['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20160308_tscode_list.append(stock_name)
daily_20160308_addname_dataframe=pd.DataFrame()
daily_20160308_addname_dataframe['cname'] = daily_20160308_tscode_list
for table_name in daily_20160308.columns.values.tolist():
    daily_20160308_addname_dataframe[table_name] = daily_20160308[table_name]
print("日线行情-时间为序  daily_20160308 返回数据 row 行数 = "+str(daily_20160308.shape[0]))
daily_20160308_addname_dataframe.to_excel(daily_201603_excel_writer,'8_2',index=False)
daily_201603_excel_writer.save()
daily_20160309 = pro.daily(start_date='',end_date='',trade_date='20160309', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20160309_tscode_list = list() 
for ts_code_sh in daily_20160309['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20160309_tscode_list.append(stock_name)
daily_20160309_addname_dataframe=pd.DataFrame()
daily_20160309_addname_dataframe['cname'] = daily_20160309_tscode_list
for table_name in daily_20160309.columns.values.tolist():
    daily_20160309_addname_dataframe[table_name] = daily_20160309[table_name]
print("日线行情-时间为序  daily_20160309 返回数据 row 行数 = "+str(daily_20160309.shape[0]))
daily_20160309_addname_dataframe.to_excel(daily_201603_excel_writer,'9_3',index=False)
daily_201603_excel_writer.save()
daily_20160310 = pro.daily(start_date='',end_date='',trade_date='20160310', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20160310_tscode_list = list() 
for ts_code_sh in daily_20160310['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20160310_tscode_list.append(stock_name)
daily_20160310_addname_dataframe=pd.DataFrame()
daily_20160310_addname_dataframe['cname'] = daily_20160310_tscode_list
for table_name in daily_20160310.columns.values.tolist():
    daily_20160310_addname_dataframe[table_name] = daily_20160310[table_name]
print("日线行情-时间为序  daily_20160310 返回数据 row 行数 = "+str(daily_20160310.shape[0]))
daily_20160310_addname_dataframe.to_excel(daily_201603_excel_writer,'10_4',index=False)
daily_201603_excel_writer.save()
daily_20160311 = pro.daily(start_date='',end_date='',trade_date='20160311', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20160311_tscode_list = list() 
for ts_code_sh in daily_20160311['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20160311_tscode_list.append(stock_name)
daily_20160311_addname_dataframe=pd.DataFrame()
daily_20160311_addname_dataframe['cname'] = daily_20160311_tscode_list
for table_name in daily_20160311.columns.values.tolist():
    daily_20160311_addname_dataframe[table_name] = daily_20160311[table_name]
print("日线行情-时间为序  daily_20160311 返回数据 row 行数 = "+str(daily_20160311.shape[0]))
daily_20160311_addname_dataframe.to_excel(daily_201603_excel_writer,'11_5',index=False)
daily_201603_excel_writer.save()
daily_20160314 = pro.daily(start_date='',end_date='',trade_date='20160314', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20160314_tscode_list = list() 
for ts_code_sh in daily_20160314['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20160314_tscode_list.append(stock_name)
daily_20160314_addname_dataframe=pd.DataFrame()
daily_20160314_addname_dataframe['cname'] = daily_20160314_tscode_list
for table_name in daily_20160314.columns.values.tolist():
    daily_20160314_addname_dataframe[table_name] = daily_20160314[table_name]
print("日线行情-时间为序  daily_20160314 返回数据 row 行数 = "+str(daily_20160314.shape[0]))
daily_20160314_addname_dataframe.to_excel(daily_201603_excel_writer,'14_1',index=False)
daily_201603_excel_writer.save()
daily_20160315 = pro.daily(start_date='',end_date='',trade_date='20160315', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20160315_tscode_list = list() 
for ts_code_sh in daily_20160315['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20160315_tscode_list.append(stock_name)
daily_20160315_addname_dataframe=pd.DataFrame()
daily_20160315_addname_dataframe['cname'] = daily_20160315_tscode_list
for table_name in daily_20160315.columns.values.tolist():
    daily_20160315_addname_dataframe[table_name] = daily_20160315[table_name]
print("日线行情-时间为序  daily_20160315 返回数据 row 行数 = "+str(daily_20160315.shape[0]))
daily_20160315_addname_dataframe.to_excel(daily_201603_excel_writer,'15_2',index=False)
daily_201603_excel_writer.save()
daily_20160316 = pro.daily(start_date='',end_date='',trade_date='20160316', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20160316_tscode_list = list() 
for ts_code_sh in daily_20160316['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20160316_tscode_list.append(stock_name)
daily_20160316_addname_dataframe=pd.DataFrame()
daily_20160316_addname_dataframe['cname'] = daily_20160316_tscode_list
for table_name in daily_20160316.columns.values.tolist():
    daily_20160316_addname_dataframe[table_name] = daily_20160316[table_name]
print("日线行情-时间为序  daily_20160316 返回数据 row 行数 = "+str(daily_20160316.shape[0]))
daily_20160316_addname_dataframe.to_excel(daily_201603_excel_writer,'16_3',index=False)
daily_201603_excel_writer.save()
daily_20160317 = pro.daily(start_date='',end_date='',trade_date='20160317', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20160317_tscode_list = list() 
for ts_code_sh in daily_20160317['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20160317_tscode_list.append(stock_name)
daily_20160317_addname_dataframe=pd.DataFrame()
daily_20160317_addname_dataframe['cname'] = daily_20160317_tscode_list
for table_name in daily_20160317.columns.values.tolist():
    daily_20160317_addname_dataframe[table_name] = daily_20160317[table_name]
print("日线行情-时间为序  daily_20160317 返回数据 row 行数 = "+str(daily_20160317.shape[0]))
daily_20160317_addname_dataframe.to_excel(daily_201603_excel_writer,'17_4',index=False)
daily_201603_excel_writer.save()
daily_20160318 = pro.daily(start_date='',end_date='',trade_date='20160318', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20160318_tscode_list = list() 
for ts_code_sh in daily_20160318['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20160318_tscode_list.append(stock_name)
daily_20160318_addname_dataframe=pd.DataFrame()
daily_20160318_addname_dataframe['cname'] = daily_20160318_tscode_list
for table_name in daily_20160318.columns.values.tolist():
    daily_20160318_addname_dataframe[table_name] = daily_20160318[table_name]
print("日线行情-时间为序  daily_20160318 返回数据 row 行数 = "+str(daily_20160318.shape[0]))
daily_20160318_addname_dataframe.to_excel(daily_201603_excel_writer,'18_5',index=False)
daily_201603_excel_writer.save()
daily_20160321 = pro.daily(start_date='',end_date='',trade_date='20160321', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20160321_tscode_list = list() 
for ts_code_sh in daily_20160321['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20160321_tscode_list.append(stock_name)
daily_20160321_addname_dataframe=pd.DataFrame()
daily_20160321_addname_dataframe['cname'] = daily_20160321_tscode_list
for table_name in daily_20160321.columns.values.tolist():
    daily_20160321_addname_dataframe[table_name] = daily_20160321[table_name]
print("日线行情-时间为序  daily_20160321 返回数据 row 行数 = "+str(daily_20160321.shape[0]))
daily_20160321_addname_dataframe.to_excel(daily_201603_excel_writer,'21_1',index=False)
daily_201603_excel_writer.save()
daily_20160322 = pro.daily(start_date='',end_date='',trade_date='20160322', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20160322_tscode_list = list() 
for ts_code_sh in daily_20160322['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20160322_tscode_list.append(stock_name)
daily_20160322_addname_dataframe=pd.DataFrame()
daily_20160322_addname_dataframe['cname'] = daily_20160322_tscode_list
for table_name in daily_20160322.columns.values.tolist():
    daily_20160322_addname_dataframe[table_name] = daily_20160322[table_name]
print("日线行情-时间为序  daily_20160322 返回数据 row 行数 = "+str(daily_20160322.shape[0]))
daily_20160322_addname_dataframe.to_excel(daily_201603_excel_writer,'22_2',index=False)
daily_201603_excel_writer.save()
daily_20160323 = pro.daily(start_date='',end_date='',trade_date='20160323', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20160323_tscode_list = list() 
for ts_code_sh in daily_20160323['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20160323_tscode_list.append(stock_name)
daily_20160323_addname_dataframe=pd.DataFrame()
daily_20160323_addname_dataframe['cname'] = daily_20160323_tscode_list
for table_name in daily_20160323.columns.values.tolist():
    daily_20160323_addname_dataframe[table_name] = daily_20160323[table_name]
print("日线行情-时间为序  daily_20160323 返回数据 row 行数 = "+str(daily_20160323.shape[0]))
daily_20160323_addname_dataframe.to_excel(daily_201603_excel_writer,'23_3',index=False)
daily_201603_excel_writer.save()
daily_20160324 = pro.daily(start_date='',end_date='',trade_date='20160324', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20160324_tscode_list = list() 
for ts_code_sh in daily_20160324['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20160324_tscode_list.append(stock_name)
daily_20160324_addname_dataframe=pd.DataFrame()
daily_20160324_addname_dataframe['cname'] = daily_20160324_tscode_list
for table_name in daily_20160324.columns.values.tolist():
    daily_20160324_addname_dataframe[table_name] = daily_20160324[table_name]
print("日线行情-时间为序  daily_20160324 返回数据 row 行数 = "+str(daily_20160324.shape[0]))
daily_20160324_addname_dataframe.to_excel(daily_201603_excel_writer,'24_4',index=False)
daily_201603_excel_writer.save()
daily_20160325 = pro.daily(start_date='',end_date='',trade_date='20160325', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20160325_tscode_list = list() 
for ts_code_sh in daily_20160325['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20160325_tscode_list.append(stock_name)
daily_20160325_addname_dataframe=pd.DataFrame()
daily_20160325_addname_dataframe['cname'] = daily_20160325_tscode_list
for table_name in daily_20160325.columns.values.tolist():
    daily_20160325_addname_dataframe[table_name] = daily_20160325[table_name]
print("日线行情-时间为序  daily_20160325 返回数据 row 行数 = "+str(daily_20160325.shape[0]))
daily_20160325_addname_dataframe.to_excel(daily_201603_excel_writer,'25_5',index=False)
daily_201603_excel_writer.save()
daily_20160328 = pro.daily(start_date='',end_date='',trade_date='20160328', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20160328_tscode_list = list() 
for ts_code_sh in daily_20160328['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20160328_tscode_list.append(stock_name)
daily_20160328_addname_dataframe=pd.DataFrame()
daily_20160328_addname_dataframe['cname'] = daily_20160328_tscode_list
for table_name in daily_20160328.columns.values.tolist():
    daily_20160328_addname_dataframe[table_name] = daily_20160328[table_name]
print("日线行情-时间为序  daily_20160328 返回数据 row 行数 = "+str(daily_20160328.shape[0]))
daily_20160328_addname_dataframe.to_excel(daily_201603_excel_writer,'28_1',index=False)
daily_201603_excel_writer.save()
daily_20160329 = pro.daily(start_date='',end_date='',trade_date='20160329', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20160329_tscode_list = list() 
for ts_code_sh in daily_20160329['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20160329_tscode_list.append(stock_name)
daily_20160329_addname_dataframe=pd.DataFrame()
daily_20160329_addname_dataframe['cname'] = daily_20160329_tscode_list
for table_name in daily_20160329.columns.values.tolist():
    daily_20160329_addname_dataframe[table_name] = daily_20160329[table_name]
print("日线行情-时间为序  daily_20160329 返回数据 row 行数 = "+str(daily_20160329.shape[0]))
daily_20160329_addname_dataframe.to_excel(daily_201603_excel_writer,'29_2',index=False)
daily_201603_excel_writer.save()
daily_20160330 = pro.daily(start_date='',end_date='',trade_date='20160330', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20160330_tscode_list = list() 
for ts_code_sh in daily_20160330['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20160330_tscode_list.append(stock_name)
daily_20160330_addname_dataframe=pd.DataFrame()
daily_20160330_addname_dataframe['cname'] = daily_20160330_tscode_list
for table_name in daily_20160330.columns.values.tolist():
    daily_20160330_addname_dataframe[table_name] = daily_20160330[table_name]
print("日线行情-时间为序  daily_20160330 返回数据 row 行数 = "+str(daily_20160330.shape[0]))
daily_20160330_addname_dataframe.to_excel(daily_201603_excel_writer,'30_3',index=False)
daily_201603_excel_writer.save()
daily_20160331 = pro.daily(start_date='',end_date='',trade_date='20160331', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20160331_tscode_list = list() 
for ts_code_sh in daily_20160331['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20160331_tscode_list.append(stock_name)
daily_20160331_addname_dataframe=pd.DataFrame()
daily_20160331_addname_dataframe['cname'] = daily_20160331_tscode_list
for table_name in daily_20160331.columns.values.tolist():
    daily_20160331_addname_dataframe[table_name] = daily_20160331[table_name]
print("日线行情-时间为序  daily_20160331 返回数据 row 行数 = "+str(daily_20160331.shape[0]))
daily_20160331_addname_dataframe.to_excel(daily_201603_excel_writer,'31_4',index=False)
daily_201603_excel_writer.save()




createexcel('daily_201604.xlsx')
daily_201604_book = load_workbook('C:\\Users\\zhuzj5\\Desktop\\zbin\\J0_Data\\daily_201604.xlsx')
daily_201604_excel_writer = pd.ExcelWriter('C:\\Users\\zhuzj5\\Desktop\\zbin\\J0_Data\\daily_201604.xlsx', engine='openpyxl')
daily_201604_excel_writer.book = daily_201604_book
daily_201604_excel_writer.sheets = dict((ws.title, ws) for ws in daily_201604_book.worksheets)
J0_PROPS.put(tree_node_name+"record_date", "20160401")       ###  更新 记录日期
daily_20160401 = pro.daily(start_date='',end_date='',trade_date='20160401', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20160401_tscode_list = list() 
for ts_code_sh in daily_20160401['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20160401_tscode_list.append(stock_name)
daily_20160401_addname_dataframe=pd.DataFrame()
daily_20160401_addname_dataframe['cname'] = daily_20160401_tscode_list
for table_name in daily_20160401.columns.values.tolist():
    daily_20160401_addname_dataframe[table_name] = daily_20160401[table_name]
print("日线行情-时间为序  daily_20160401 返回数据 row 行数 = "+str(daily_20160401.shape[0]))
daily_20160401_addname_dataframe.to_excel(daily_201604_excel_writer,'1_5',index=False)
daily_201604_excel_writer.save()
daily_20160405 = pro.daily(start_date='',end_date='',trade_date='20160405', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20160405_tscode_list = list() 
for ts_code_sh in daily_20160405['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20160405_tscode_list.append(stock_name)
daily_20160405_addname_dataframe=pd.DataFrame()
daily_20160405_addname_dataframe['cname'] = daily_20160405_tscode_list
for table_name in daily_20160405.columns.values.tolist():
    daily_20160405_addname_dataframe[table_name] = daily_20160405[table_name]
print("日线行情-时间为序  daily_20160405 返回数据 row 行数 = "+str(daily_20160405.shape[0]))
daily_20160405_addname_dataframe.to_excel(daily_201604_excel_writer,'5_2',index=False)
daily_201604_excel_writer.save()
daily_20160406 = pro.daily(start_date='',end_date='',trade_date='20160406', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20160406_tscode_list = list() 
for ts_code_sh in daily_20160406['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20160406_tscode_list.append(stock_name)
daily_20160406_addname_dataframe=pd.DataFrame()
daily_20160406_addname_dataframe['cname'] = daily_20160406_tscode_list
for table_name in daily_20160406.columns.values.tolist():
    daily_20160406_addname_dataframe[table_name] = daily_20160406[table_name]
print("日线行情-时间为序  daily_20160406 返回数据 row 行数 = "+str(daily_20160406.shape[0]))
daily_20160406_addname_dataframe.to_excel(daily_201604_excel_writer,'6_3',index=False)
daily_201604_excel_writer.save()
daily_20160407 = pro.daily(start_date='',end_date='',trade_date='20160407', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20160407_tscode_list = list() 
for ts_code_sh in daily_20160407['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20160407_tscode_list.append(stock_name)
daily_20160407_addname_dataframe=pd.DataFrame()
daily_20160407_addname_dataframe['cname'] = daily_20160407_tscode_list
for table_name in daily_20160407.columns.values.tolist():
    daily_20160407_addname_dataframe[table_name] = daily_20160407[table_name]
print("日线行情-时间为序  daily_20160407 返回数据 row 行数 = "+str(daily_20160407.shape[0]))
daily_20160407_addname_dataframe.to_excel(daily_201604_excel_writer,'7_4',index=False)
daily_201604_excel_writer.save()
daily_20160408 = pro.daily(start_date='',end_date='',trade_date='20160408', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20160408_tscode_list = list() 
for ts_code_sh in daily_20160408['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20160408_tscode_list.append(stock_name)
daily_20160408_addname_dataframe=pd.DataFrame()
daily_20160408_addname_dataframe['cname'] = daily_20160408_tscode_list
for table_name in daily_20160408.columns.values.tolist():
    daily_20160408_addname_dataframe[table_name] = daily_20160408[table_name]
print("日线行情-时间为序  daily_20160408 返回数据 row 行数 = "+str(daily_20160408.shape[0]))
daily_20160408_addname_dataframe.to_excel(daily_201604_excel_writer,'8_5',index=False)
daily_201604_excel_writer.save()
daily_20160411 = pro.daily(start_date='',end_date='',trade_date='20160411', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20160411_tscode_list = list() 
for ts_code_sh in daily_20160411['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20160411_tscode_list.append(stock_name)
daily_20160411_addname_dataframe=pd.DataFrame()
daily_20160411_addname_dataframe['cname'] = daily_20160411_tscode_list
for table_name in daily_20160411.columns.values.tolist():
    daily_20160411_addname_dataframe[table_name] = daily_20160411[table_name]
print("日线行情-时间为序  daily_20160411 返回数据 row 行数 = "+str(daily_20160411.shape[0]))
daily_20160411_addname_dataframe.to_excel(daily_201604_excel_writer,'11_1',index=False)
daily_201604_excel_writer.save()
daily_20160412 = pro.daily(start_date='',end_date='',trade_date='20160412', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20160412_tscode_list = list() 
for ts_code_sh in daily_20160412['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20160412_tscode_list.append(stock_name)
daily_20160412_addname_dataframe=pd.DataFrame()
daily_20160412_addname_dataframe['cname'] = daily_20160412_tscode_list
for table_name in daily_20160412.columns.values.tolist():
    daily_20160412_addname_dataframe[table_name] = daily_20160412[table_name]
print("日线行情-时间为序  daily_20160412 返回数据 row 行数 = "+str(daily_20160412.shape[0]))
daily_20160412_addname_dataframe.to_excel(daily_201604_excel_writer,'12_2',index=False)
daily_201604_excel_writer.save()
daily_20160413 = pro.daily(start_date='',end_date='',trade_date='20160413', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20160413_tscode_list = list() 
for ts_code_sh in daily_20160413['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20160413_tscode_list.append(stock_name)
daily_20160413_addname_dataframe=pd.DataFrame()
daily_20160413_addname_dataframe['cname'] = daily_20160413_tscode_list
for table_name in daily_20160413.columns.values.tolist():
    daily_20160413_addname_dataframe[table_name] = daily_20160413[table_name]
print("日线行情-时间为序  daily_20160413 返回数据 row 行数 = "+str(daily_20160413.shape[0]))
daily_20160413_addname_dataframe.to_excel(daily_201604_excel_writer,'13_3',index=False)
daily_201604_excel_writer.save()
daily_20160414 = pro.daily(start_date='',end_date='',trade_date='20160414', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20160414_tscode_list = list() 
for ts_code_sh in daily_20160414['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20160414_tscode_list.append(stock_name)
daily_20160414_addname_dataframe=pd.DataFrame()
daily_20160414_addname_dataframe['cname'] = daily_20160414_tscode_list
for table_name in daily_20160414.columns.values.tolist():
    daily_20160414_addname_dataframe[table_name] = daily_20160414[table_name]
print("日线行情-时间为序  daily_20160414 返回数据 row 行数 = "+str(daily_20160414.shape[0]))
daily_20160414_addname_dataframe.to_excel(daily_201604_excel_writer,'14_4',index=False)
daily_201604_excel_writer.save()
daily_20160415 = pro.daily(start_date='',end_date='',trade_date='20160415', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20160415_tscode_list = list() 
for ts_code_sh in daily_20160415['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20160415_tscode_list.append(stock_name)
daily_20160415_addname_dataframe=pd.DataFrame()
daily_20160415_addname_dataframe['cname'] = daily_20160415_tscode_list
for table_name in daily_20160415.columns.values.tolist():
    daily_20160415_addname_dataframe[table_name] = daily_20160415[table_name]
print("日线行情-时间为序  daily_20160415 返回数据 row 行数 = "+str(daily_20160415.shape[0]))
daily_20160415_addname_dataframe.to_excel(daily_201604_excel_writer,'15_5',index=False)
daily_201604_excel_writer.save()
daily_20160418 = pro.daily(start_date='',end_date='',trade_date='20160418', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20160418_tscode_list = list() 
for ts_code_sh in daily_20160418['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20160418_tscode_list.append(stock_name)
daily_20160418_addname_dataframe=pd.DataFrame()
daily_20160418_addname_dataframe['cname'] = daily_20160418_tscode_list
for table_name in daily_20160418.columns.values.tolist():
    daily_20160418_addname_dataframe[table_name] = daily_20160418[table_name]
print("日线行情-时间为序  daily_20160418 返回数据 row 行数 = "+str(daily_20160418.shape[0]))
daily_20160418_addname_dataframe.to_excel(daily_201604_excel_writer,'18_1',index=False)
daily_201604_excel_writer.save()
daily_20160419 = pro.daily(start_date='',end_date='',trade_date='20160419', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20160419_tscode_list = list() 
for ts_code_sh in daily_20160419['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20160419_tscode_list.append(stock_name)
daily_20160419_addname_dataframe=pd.DataFrame()
daily_20160419_addname_dataframe['cname'] = daily_20160419_tscode_list
for table_name in daily_20160419.columns.values.tolist():
    daily_20160419_addname_dataframe[table_name] = daily_20160419[table_name]
print("日线行情-时间为序  daily_20160419 返回数据 row 行数 = "+str(daily_20160419.shape[0]))
daily_20160419_addname_dataframe.to_excel(daily_201604_excel_writer,'19_2',index=False)
daily_201604_excel_writer.save()
daily_20160420 = pro.daily(start_date='',end_date='',trade_date='20160420', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20160420_tscode_list = list() 
for ts_code_sh in daily_20160420['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20160420_tscode_list.append(stock_name)
daily_20160420_addname_dataframe=pd.DataFrame()
daily_20160420_addname_dataframe['cname'] = daily_20160420_tscode_list
for table_name in daily_20160420.columns.values.tolist():
    daily_20160420_addname_dataframe[table_name] = daily_20160420[table_name]
print("日线行情-时间为序  daily_20160420 返回数据 row 行数 = "+str(daily_20160420.shape[0]))
daily_20160420_addname_dataframe.to_excel(daily_201604_excel_writer,'20_3',index=False)
daily_201604_excel_writer.save()
daily_20160421 = pro.daily(start_date='',end_date='',trade_date='20160421', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20160421_tscode_list = list() 
for ts_code_sh in daily_20160421['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20160421_tscode_list.append(stock_name)
daily_20160421_addname_dataframe=pd.DataFrame()
daily_20160421_addname_dataframe['cname'] = daily_20160421_tscode_list
for table_name in daily_20160421.columns.values.tolist():
    daily_20160421_addname_dataframe[table_name] = daily_20160421[table_name]
print("日线行情-时间为序  daily_20160421 返回数据 row 行数 = "+str(daily_20160421.shape[0]))
daily_20160421_addname_dataframe.to_excel(daily_201604_excel_writer,'21_4',index=False)
daily_201604_excel_writer.save()
daily_20160422 = pro.daily(start_date='',end_date='',trade_date='20160422', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20160422_tscode_list = list() 
for ts_code_sh in daily_20160422['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20160422_tscode_list.append(stock_name)
daily_20160422_addname_dataframe=pd.DataFrame()
daily_20160422_addname_dataframe['cname'] = daily_20160422_tscode_list
for table_name in daily_20160422.columns.values.tolist():
    daily_20160422_addname_dataframe[table_name] = daily_20160422[table_name]
print("日线行情-时间为序  daily_20160422 返回数据 row 行数 = "+str(daily_20160422.shape[0]))
daily_20160422_addname_dataframe.to_excel(daily_201604_excel_writer,'22_5',index=False)
daily_201604_excel_writer.save()
daily_20160425 = pro.daily(start_date='',end_date='',trade_date='20160425', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20160425_tscode_list = list() 
for ts_code_sh in daily_20160425['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20160425_tscode_list.append(stock_name)
daily_20160425_addname_dataframe=pd.DataFrame()
daily_20160425_addname_dataframe['cname'] = daily_20160425_tscode_list
for table_name in daily_20160425.columns.values.tolist():
    daily_20160425_addname_dataframe[table_name] = daily_20160425[table_name]
print("日线行情-时间为序  daily_20160425 返回数据 row 行数 = "+str(daily_20160425.shape[0]))
daily_20160425_addname_dataframe.to_excel(daily_201604_excel_writer,'25_1',index=False)
daily_201604_excel_writer.save()
daily_20160426 = pro.daily(start_date='',end_date='',trade_date='20160426', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20160426_tscode_list = list() 
for ts_code_sh in daily_20160426['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20160426_tscode_list.append(stock_name)
daily_20160426_addname_dataframe=pd.DataFrame()
daily_20160426_addname_dataframe['cname'] = daily_20160426_tscode_list
for table_name in daily_20160426.columns.values.tolist():
    daily_20160426_addname_dataframe[table_name] = daily_20160426[table_name]
print("日线行情-时间为序  daily_20160426 返回数据 row 行数 = "+str(daily_20160426.shape[0]))
daily_20160426_addname_dataframe.to_excel(daily_201604_excel_writer,'26_2',index=False)
daily_201604_excel_writer.save()
daily_20160427 = pro.daily(start_date='',end_date='',trade_date='20160427', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20160427_tscode_list = list() 
for ts_code_sh in daily_20160427['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20160427_tscode_list.append(stock_name)
daily_20160427_addname_dataframe=pd.DataFrame()
daily_20160427_addname_dataframe['cname'] = daily_20160427_tscode_list
for table_name in daily_20160427.columns.values.tolist():
    daily_20160427_addname_dataframe[table_name] = daily_20160427[table_name]
print("日线行情-时间为序  daily_20160427 返回数据 row 行数 = "+str(daily_20160427.shape[0]))
daily_20160427_addname_dataframe.to_excel(daily_201604_excel_writer,'27_3',index=False)
daily_201604_excel_writer.save()
daily_20160428 = pro.daily(start_date='',end_date='',trade_date='20160428', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20160428_tscode_list = list() 
for ts_code_sh in daily_20160428['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20160428_tscode_list.append(stock_name)
daily_20160428_addname_dataframe=pd.DataFrame()
daily_20160428_addname_dataframe['cname'] = daily_20160428_tscode_list
for table_name in daily_20160428.columns.values.tolist():
    daily_20160428_addname_dataframe[table_name] = daily_20160428[table_name]
print("日线行情-时间为序  daily_20160428 返回数据 row 行数 = "+str(daily_20160428.shape[0]))
daily_20160428_addname_dataframe.to_excel(daily_201604_excel_writer,'28_4',index=False)
daily_201604_excel_writer.save()
daily_20160429 = pro.daily(start_date='',end_date='',trade_date='20160429', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20160429_tscode_list = list() 
for ts_code_sh in daily_20160429['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20160429_tscode_list.append(stock_name)
daily_20160429_addname_dataframe=pd.DataFrame()
daily_20160429_addname_dataframe['cname'] = daily_20160429_tscode_list
for table_name in daily_20160429.columns.values.tolist():
    daily_20160429_addname_dataframe[table_name] = daily_20160429[table_name]
print("日线行情-时间为序  daily_20160429 返回数据 row 行数 = "+str(daily_20160429.shape[0]))
daily_20160429_addname_dataframe.to_excel(daily_201604_excel_writer,'29_5',index=False)
daily_201604_excel_writer.save()




createexcel('daily_201605.xlsx')
daily_201605_book = load_workbook('C:\\Users\\zhuzj5\\Desktop\\zbin\\J0_Data\\daily_201605.xlsx')
daily_201605_excel_writer = pd.ExcelWriter('C:\\Users\\zhuzj5\\Desktop\\zbin\\J0_Data\\daily_201605.xlsx', engine='openpyxl')
daily_201605_excel_writer.book = daily_201605_book
daily_201605_excel_writer.sheets = dict((ws.title, ws) for ws in daily_201605_book.worksheets)
J0_PROPS.put(tree_node_name+"record_date", "20160501")       ###  更新 记录日期
daily_20160503 = pro.daily(start_date='',end_date='',trade_date='20160503', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20160503_tscode_list = list() 
for ts_code_sh in daily_20160503['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20160503_tscode_list.append(stock_name)
daily_20160503_addname_dataframe=pd.DataFrame()
daily_20160503_addname_dataframe['cname'] = daily_20160503_tscode_list
for table_name in daily_20160503.columns.values.tolist():
    daily_20160503_addname_dataframe[table_name] = daily_20160503[table_name]
print("日线行情-时间为序  daily_20160503 返回数据 row 行数 = "+str(daily_20160503.shape[0]))
daily_20160503_addname_dataframe.to_excel(daily_201605_excel_writer,'3_2',index=False)
daily_201605_excel_writer.save()
daily_20160504 = pro.daily(start_date='',end_date='',trade_date='20160504', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20160504_tscode_list = list() 
for ts_code_sh in daily_20160504['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20160504_tscode_list.append(stock_name)
daily_20160504_addname_dataframe=pd.DataFrame()
daily_20160504_addname_dataframe['cname'] = daily_20160504_tscode_list
for table_name in daily_20160504.columns.values.tolist():
    daily_20160504_addname_dataframe[table_name] = daily_20160504[table_name]
print("日线行情-时间为序  daily_20160504 返回数据 row 行数 = "+str(daily_20160504.shape[0]))
daily_20160504_addname_dataframe.to_excel(daily_201605_excel_writer,'4_3',index=False)
daily_201605_excel_writer.save()
daily_20160505 = pro.daily(start_date='',end_date='',trade_date='20160505', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20160505_tscode_list = list() 
for ts_code_sh in daily_20160505['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20160505_tscode_list.append(stock_name)
daily_20160505_addname_dataframe=pd.DataFrame()
daily_20160505_addname_dataframe['cname'] = daily_20160505_tscode_list
for table_name in daily_20160505.columns.values.tolist():
    daily_20160505_addname_dataframe[table_name] = daily_20160505[table_name]
print("日线行情-时间为序  daily_20160505 返回数据 row 行数 = "+str(daily_20160505.shape[0]))
daily_20160505_addname_dataframe.to_excel(daily_201605_excel_writer,'5_4',index=False)
daily_201605_excel_writer.save()
daily_20160506 = pro.daily(start_date='',end_date='',trade_date='20160506', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20160506_tscode_list = list() 
for ts_code_sh in daily_20160506['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20160506_tscode_list.append(stock_name)
daily_20160506_addname_dataframe=pd.DataFrame()
daily_20160506_addname_dataframe['cname'] = daily_20160506_tscode_list
for table_name in daily_20160506.columns.values.tolist():
    daily_20160506_addname_dataframe[table_name] = daily_20160506[table_name]
print("日线行情-时间为序  daily_20160506 返回数据 row 行数 = "+str(daily_20160506.shape[0]))
daily_20160506_addname_dataframe.to_excel(daily_201605_excel_writer,'6_5',index=False)
daily_201605_excel_writer.save()
daily_20160509 = pro.daily(start_date='',end_date='',trade_date='20160509', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20160509_tscode_list = list() 
for ts_code_sh in daily_20160509['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20160509_tscode_list.append(stock_name)
daily_20160509_addname_dataframe=pd.DataFrame()
daily_20160509_addname_dataframe['cname'] = daily_20160509_tscode_list
for table_name in daily_20160509.columns.values.tolist():
    daily_20160509_addname_dataframe[table_name] = daily_20160509[table_name]
print("日线行情-时间为序  daily_20160509 返回数据 row 行数 = "+str(daily_20160509.shape[0]))
daily_20160509_addname_dataframe.to_excel(daily_201605_excel_writer,'9_1',index=False)
daily_201605_excel_writer.save()
daily_20160510 = pro.daily(start_date='',end_date='',trade_date='20160510', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20160510_tscode_list = list() 
for ts_code_sh in daily_20160510['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20160510_tscode_list.append(stock_name)
daily_20160510_addname_dataframe=pd.DataFrame()
daily_20160510_addname_dataframe['cname'] = daily_20160510_tscode_list
for table_name in daily_20160510.columns.values.tolist():
    daily_20160510_addname_dataframe[table_name] = daily_20160510[table_name]
print("日线行情-时间为序  daily_20160510 返回数据 row 行数 = "+str(daily_20160510.shape[0]))
daily_20160510_addname_dataframe.to_excel(daily_201605_excel_writer,'10_2',index=False)
daily_201605_excel_writer.save()
daily_20160511 = pro.daily(start_date='',end_date='',trade_date='20160511', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20160511_tscode_list = list() 
for ts_code_sh in daily_20160511['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20160511_tscode_list.append(stock_name)
daily_20160511_addname_dataframe=pd.DataFrame()
daily_20160511_addname_dataframe['cname'] = daily_20160511_tscode_list
for table_name in daily_20160511.columns.values.tolist():
    daily_20160511_addname_dataframe[table_name] = daily_20160511[table_name]
print("日线行情-时间为序  daily_20160511 返回数据 row 行数 = "+str(daily_20160511.shape[0]))
daily_20160511_addname_dataframe.to_excel(daily_201605_excel_writer,'11_3',index=False)
daily_201605_excel_writer.save()
daily_20160512 = pro.daily(start_date='',end_date='',trade_date='20160512', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20160512_tscode_list = list() 
for ts_code_sh in daily_20160512['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20160512_tscode_list.append(stock_name)
daily_20160512_addname_dataframe=pd.DataFrame()
daily_20160512_addname_dataframe['cname'] = daily_20160512_tscode_list
for table_name in daily_20160512.columns.values.tolist():
    daily_20160512_addname_dataframe[table_name] = daily_20160512[table_name]
print("日线行情-时间为序  daily_20160512 返回数据 row 行数 = "+str(daily_20160512.shape[0]))
daily_20160512_addname_dataframe.to_excel(daily_201605_excel_writer,'12_4',index=False)
daily_201605_excel_writer.save()
daily_20160513 = pro.daily(start_date='',end_date='',trade_date='20160513', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20160513_tscode_list = list() 
for ts_code_sh in daily_20160513['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20160513_tscode_list.append(stock_name)
daily_20160513_addname_dataframe=pd.DataFrame()
daily_20160513_addname_dataframe['cname'] = daily_20160513_tscode_list
for table_name in daily_20160513.columns.values.tolist():
    daily_20160513_addname_dataframe[table_name] = daily_20160513[table_name]
print("日线行情-时间为序  daily_20160513 返回数据 row 行数 = "+str(daily_20160513.shape[0]))
daily_20160513_addname_dataframe.to_excel(daily_201605_excel_writer,'13_5',index=False)
daily_201605_excel_writer.save()
daily_20160516 = pro.daily(start_date='',end_date='',trade_date='20160516', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20160516_tscode_list = list() 
for ts_code_sh in daily_20160516['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20160516_tscode_list.append(stock_name)
daily_20160516_addname_dataframe=pd.DataFrame()
daily_20160516_addname_dataframe['cname'] = daily_20160516_tscode_list
for table_name in daily_20160516.columns.values.tolist():
    daily_20160516_addname_dataframe[table_name] = daily_20160516[table_name]
print("日线行情-时间为序  daily_20160516 返回数据 row 行数 = "+str(daily_20160516.shape[0]))
daily_20160516_addname_dataframe.to_excel(daily_201605_excel_writer,'16_1',index=False)
daily_201605_excel_writer.save()
daily_20160517 = pro.daily(start_date='',end_date='',trade_date='20160517', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20160517_tscode_list = list() 
for ts_code_sh in daily_20160517['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20160517_tscode_list.append(stock_name)
daily_20160517_addname_dataframe=pd.DataFrame()
daily_20160517_addname_dataframe['cname'] = daily_20160517_tscode_list
for table_name in daily_20160517.columns.values.tolist():
    daily_20160517_addname_dataframe[table_name] = daily_20160517[table_name]
print("日线行情-时间为序  daily_20160517 返回数据 row 行数 = "+str(daily_20160517.shape[0]))
daily_20160517_addname_dataframe.to_excel(daily_201605_excel_writer,'17_2',index=False)
daily_201605_excel_writer.save()
daily_20160518 = pro.daily(start_date='',end_date='',trade_date='20160518', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20160518_tscode_list = list() 
for ts_code_sh in daily_20160518['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20160518_tscode_list.append(stock_name)
daily_20160518_addname_dataframe=pd.DataFrame()
daily_20160518_addname_dataframe['cname'] = daily_20160518_tscode_list
for table_name in daily_20160518.columns.values.tolist():
    daily_20160518_addname_dataframe[table_name] = daily_20160518[table_name]
print("日线行情-时间为序  daily_20160518 返回数据 row 行数 = "+str(daily_20160518.shape[0]))
daily_20160518_addname_dataframe.to_excel(daily_201605_excel_writer,'18_3',index=False)
daily_201605_excel_writer.save()
daily_20160519 = pro.daily(start_date='',end_date='',trade_date='20160519', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20160519_tscode_list = list() 
for ts_code_sh in daily_20160519['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20160519_tscode_list.append(stock_name)
daily_20160519_addname_dataframe=pd.DataFrame()
daily_20160519_addname_dataframe['cname'] = daily_20160519_tscode_list
for table_name in daily_20160519.columns.values.tolist():
    daily_20160519_addname_dataframe[table_name] = daily_20160519[table_name]
print("日线行情-时间为序  daily_20160519 返回数据 row 行数 = "+str(daily_20160519.shape[0]))
daily_20160519_addname_dataframe.to_excel(daily_201605_excel_writer,'19_4',index=False)
daily_201605_excel_writer.save()
daily_20160520 = pro.daily(start_date='',end_date='',trade_date='20160520', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20160520_tscode_list = list() 
for ts_code_sh in daily_20160520['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20160520_tscode_list.append(stock_name)
daily_20160520_addname_dataframe=pd.DataFrame()
daily_20160520_addname_dataframe['cname'] = daily_20160520_tscode_list
for table_name in daily_20160520.columns.values.tolist():
    daily_20160520_addname_dataframe[table_name] = daily_20160520[table_name]
print("日线行情-时间为序  daily_20160520 返回数据 row 行数 = "+str(daily_20160520.shape[0]))
daily_20160520_addname_dataframe.to_excel(daily_201605_excel_writer,'20_5',index=False)
daily_201605_excel_writer.save()
daily_20160523 = pro.daily(start_date='',end_date='',trade_date='20160523', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20160523_tscode_list = list() 
for ts_code_sh in daily_20160523['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20160523_tscode_list.append(stock_name)
daily_20160523_addname_dataframe=pd.DataFrame()
daily_20160523_addname_dataframe['cname'] = daily_20160523_tscode_list
for table_name in daily_20160523.columns.values.tolist():
    daily_20160523_addname_dataframe[table_name] = daily_20160523[table_name]
print("日线行情-时间为序  daily_20160523 返回数据 row 行数 = "+str(daily_20160523.shape[0]))
daily_20160523_addname_dataframe.to_excel(daily_201605_excel_writer,'23_1',index=False)
daily_201605_excel_writer.save()
daily_20160524 = pro.daily(start_date='',end_date='',trade_date='20160524', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20160524_tscode_list = list() 
for ts_code_sh in daily_20160524['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20160524_tscode_list.append(stock_name)
daily_20160524_addname_dataframe=pd.DataFrame()
daily_20160524_addname_dataframe['cname'] = daily_20160524_tscode_list
for table_name in daily_20160524.columns.values.tolist():
    daily_20160524_addname_dataframe[table_name] = daily_20160524[table_name]
print("日线行情-时间为序  daily_20160524 返回数据 row 行数 = "+str(daily_20160524.shape[0]))
daily_20160524_addname_dataframe.to_excel(daily_201605_excel_writer,'24_2',index=False)
daily_201605_excel_writer.save()
daily_20160525 = pro.daily(start_date='',end_date='',trade_date='20160525', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20160525_tscode_list = list() 
for ts_code_sh in daily_20160525['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20160525_tscode_list.append(stock_name)
daily_20160525_addname_dataframe=pd.DataFrame()
daily_20160525_addname_dataframe['cname'] = daily_20160525_tscode_list
for table_name in daily_20160525.columns.values.tolist():
    daily_20160525_addname_dataframe[table_name] = daily_20160525[table_name]
print("日线行情-时间为序  daily_20160525 返回数据 row 行数 = "+str(daily_20160525.shape[0]))
daily_20160525_addname_dataframe.to_excel(daily_201605_excel_writer,'25_3',index=False)
daily_201605_excel_writer.save()
daily_20160526 = pro.daily(start_date='',end_date='',trade_date='20160526', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20160526_tscode_list = list() 
for ts_code_sh in daily_20160526['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20160526_tscode_list.append(stock_name)
daily_20160526_addname_dataframe=pd.DataFrame()
daily_20160526_addname_dataframe['cname'] = daily_20160526_tscode_list
for table_name in daily_20160526.columns.values.tolist():
    daily_20160526_addname_dataframe[table_name] = daily_20160526[table_name]
print("日线行情-时间为序  daily_20160526 返回数据 row 行数 = "+str(daily_20160526.shape[0]))
daily_20160526_addname_dataframe.to_excel(daily_201605_excel_writer,'26_4',index=False)
daily_201605_excel_writer.save()
daily_20160527 = pro.daily(start_date='',end_date='',trade_date='20160527', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20160527_tscode_list = list() 
for ts_code_sh in daily_20160527['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20160527_tscode_list.append(stock_name)
daily_20160527_addname_dataframe=pd.DataFrame()
daily_20160527_addname_dataframe['cname'] = daily_20160527_tscode_list
for table_name in daily_20160527.columns.values.tolist():
    daily_20160527_addname_dataframe[table_name] = daily_20160527[table_name]
print("日线行情-时间为序  daily_20160527 返回数据 row 行数 = "+str(daily_20160527.shape[0]))
daily_20160527_addname_dataframe.to_excel(daily_201605_excel_writer,'27_5',index=False)
daily_201605_excel_writer.save()
daily_20160530 = pro.daily(start_date='',end_date='',trade_date='20160530', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20160530_tscode_list = list() 
for ts_code_sh in daily_20160530['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20160530_tscode_list.append(stock_name)
daily_20160530_addname_dataframe=pd.DataFrame()
daily_20160530_addname_dataframe['cname'] = daily_20160530_tscode_list
for table_name in daily_20160530.columns.values.tolist():
    daily_20160530_addname_dataframe[table_name] = daily_20160530[table_name]
print("日线行情-时间为序  daily_20160530 返回数据 row 行数 = "+str(daily_20160530.shape[0]))
daily_20160530_addname_dataframe.to_excel(daily_201605_excel_writer,'30_1',index=False)
daily_201605_excel_writer.save()
daily_20160531 = pro.daily(start_date='',end_date='',trade_date='20160531', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20160531_tscode_list = list() 
for ts_code_sh in daily_20160531['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20160531_tscode_list.append(stock_name)
daily_20160531_addname_dataframe=pd.DataFrame()
daily_20160531_addname_dataframe['cname'] = daily_20160531_tscode_list
for table_name in daily_20160531.columns.values.tolist():
    daily_20160531_addname_dataframe[table_name] = daily_20160531[table_name]
print("日线行情-时间为序  daily_20160531 返回数据 row 行数 = "+str(daily_20160531.shape[0]))
daily_20160531_addname_dataframe.to_excel(daily_201605_excel_writer,'31_2',index=False)
daily_201605_excel_writer.save()




createexcel('daily_201606.xlsx')
daily_201606_book = load_workbook('C:\\Users\\zhuzj5\\Desktop\\zbin\\J0_Data\\daily_201606.xlsx')
daily_201606_excel_writer = pd.ExcelWriter('C:\\Users\\zhuzj5\\Desktop\\zbin\\J0_Data\\daily_201606.xlsx', engine='openpyxl')
daily_201606_excel_writer.book = daily_201606_book
daily_201606_excel_writer.sheets = dict((ws.title, ws) for ws in daily_201606_book.worksheets)
J0_PROPS.put(tree_node_name+"record_date", "20160601")       ###  更新 记录日期
daily_20160601 = pro.daily(start_date='',end_date='',trade_date='20160601', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20160601_tscode_list = list() 
for ts_code_sh in daily_20160601['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20160601_tscode_list.append(stock_name)
daily_20160601_addname_dataframe=pd.DataFrame()
daily_20160601_addname_dataframe['cname'] = daily_20160601_tscode_list
for table_name in daily_20160601.columns.values.tolist():
    daily_20160601_addname_dataframe[table_name] = daily_20160601[table_name]
print("日线行情-时间为序  daily_20160601 返回数据 row 行数 = "+str(daily_20160601.shape[0]))
daily_20160601_addname_dataframe.to_excel(daily_201606_excel_writer,'1_3',index=False)
daily_201606_excel_writer.save()
daily_20160602 = pro.daily(start_date='',end_date='',trade_date='20160602', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20160602_tscode_list = list() 
for ts_code_sh in daily_20160602['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20160602_tscode_list.append(stock_name)
daily_20160602_addname_dataframe=pd.DataFrame()
daily_20160602_addname_dataframe['cname'] = daily_20160602_tscode_list
for table_name in daily_20160602.columns.values.tolist():
    daily_20160602_addname_dataframe[table_name] = daily_20160602[table_name]
print("日线行情-时间为序  daily_20160602 返回数据 row 行数 = "+str(daily_20160602.shape[0]))
daily_20160602_addname_dataframe.to_excel(daily_201606_excel_writer,'2_4',index=False)
daily_201606_excel_writer.save()
daily_20160603 = pro.daily(start_date='',end_date='',trade_date='20160603', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20160603_tscode_list = list() 
for ts_code_sh in daily_20160603['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20160603_tscode_list.append(stock_name)
daily_20160603_addname_dataframe=pd.DataFrame()
daily_20160603_addname_dataframe['cname'] = daily_20160603_tscode_list
for table_name in daily_20160603.columns.values.tolist():
    daily_20160603_addname_dataframe[table_name] = daily_20160603[table_name]
print("日线行情-时间为序  daily_20160603 返回数据 row 行数 = "+str(daily_20160603.shape[0]))
daily_20160603_addname_dataframe.to_excel(daily_201606_excel_writer,'3_5',index=False)
daily_201606_excel_writer.save()
daily_20160606 = pro.daily(start_date='',end_date='',trade_date='20160606', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20160606_tscode_list = list() 
for ts_code_sh in daily_20160606['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20160606_tscode_list.append(stock_name)
daily_20160606_addname_dataframe=pd.DataFrame()
daily_20160606_addname_dataframe['cname'] = daily_20160606_tscode_list
for table_name in daily_20160606.columns.values.tolist():
    daily_20160606_addname_dataframe[table_name] = daily_20160606[table_name]
print("日线行情-时间为序  daily_20160606 返回数据 row 行数 = "+str(daily_20160606.shape[0]))
daily_20160606_addname_dataframe.to_excel(daily_201606_excel_writer,'6_1',index=False)
daily_201606_excel_writer.save()
daily_20160607 = pro.daily(start_date='',end_date='',trade_date='20160607', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20160607_tscode_list = list() 
for ts_code_sh in daily_20160607['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20160607_tscode_list.append(stock_name)
daily_20160607_addname_dataframe=pd.DataFrame()
daily_20160607_addname_dataframe['cname'] = daily_20160607_tscode_list
for table_name in daily_20160607.columns.values.tolist():
    daily_20160607_addname_dataframe[table_name] = daily_20160607[table_name]
print("日线行情-时间为序  daily_20160607 返回数据 row 行数 = "+str(daily_20160607.shape[0]))
daily_20160607_addname_dataframe.to_excel(daily_201606_excel_writer,'7_2',index=False)
daily_201606_excel_writer.save()
daily_20160608 = pro.daily(start_date='',end_date='',trade_date='20160608', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20160608_tscode_list = list() 
for ts_code_sh in daily_20160608['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20160608_tscode_list.append(stock_name)
daily_20160608_addname_dataframe=pd.DataFrame()
daily_20160608_addname_dataframe['cname'] = daily_20160608_tscode_list
for table_name in daily_20160608.columns.values.tolist():
    daily_20160608_addname_dataframe[table_name] = daily_20160608[table_name]
print("日线行情-时间为序  daily_20160608 返回数据 row 行数 = "+str(daily_20160608.shape[0]))
daily_20160608_addname_dataframe.to_excel(daily_201606_excel_writer,'8_3',index=False)
daily_201606_excel_writer.save()
daily_20160613 = pro.daily(start_date='',end_date='',trade_date='20160613', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20160613_tscode_list = list() 
for ts_code_sh in daily_20160613['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20160613_tscode_list.append(stock_name)
daily_20160613_addname_dataframe=pd.DataFrame()
daily_20160613_addname_dataframe['cname'] = daily_20160613_tscode_list
for table_name in daily_20160613.columns.values.tolist():
    daily_20160613_addname_dataframe[table_name] = daily_20160613[table_name]
print("日线行情-时间为序  daily_20160613 返回数据 row 行数 = "+str(daily_20160613.shape[0]))
daily_20160613_addname_dataframe.to_excel(daily_201606_excel_writer,'13_1',index=False)
daily_201606_excel_writer.save()
daily_20160614 = pro.daily(start_date='',end_date='',trade_date='20160614', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20160614_tscode_list = list() 
for ts_code_sh in daily_20160614['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20160614_tscode_list.append(stock_name)
daily_20160614_addname_dataframe=pd.DataFrame()
daily_20160614_addname_dataframe['cname'] = daily_20160614_tscode_list
for table_name in daily_20160614.columns.values.tolist():
    daily_20160614_addname_dataframe[table_name] = daily_20160614[table_name]
print("日线行情-时间为序  daily_20160614 返回数据 row 行数 = "+str(daily_20160614.shape[0]))
daily_20160614_addname_dataframe.to_excel(daily_201606_excel_writer,'14_2',index=False)
daily_201606_excel_writer.save()
daily_20160615 = pro.daily(start_date='',end_date='',trade_date='20160615', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20160615_tscode_list = list() 
for ts_code_sh in daily_20160615['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20160615_tscode_list.append(stock_name)
daily_20160615_addname_dataframe=pd.DataFrame()
daily_20160615_addname_dataframe['cname'] = daily_20160615_tscode_list
for table_name in daily_20160615.columns.values.tolist():
    daily_20160615_addname_dataframe[table_name] = daily_20160615[table_name]
print("日线行情-时间为序  daily_20160615 返回数据 row 行数 = "+str(daily_20160615.shape[0]))
daily_20160615_addname_dataframe.to_excel(daily_201606_excel_writer,'15_3',index=False)
daily_201606_excel_writer.save()
daily_20160616 = pro.daily(start_date='',end_date='',trade_date='20160616', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20160616_tscode_list = list() 
for ts_code_sh in daily_20160616['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20160616_tscode_list.append(stock_name)
daily_20160616_addname_dataframe=pd.DataFrame()
daily_20160616_addname_dataframe['cname'] = daily_20160616_tscode_list
for table_name in daily_20160616.columns.values.tolist():
    daily_20160616_addname_dataframe[table_name] = daily_20160616[table_name]
print("日线行情-时间为序  daily_20160616 返回数据 row 行数 = "+str(daily_20160616.shape[0]))
daily_20160616_addname_dataframe.to_excel(daily_201606_excel_writer,'16_4',index=False)
daily_201606_excel_writer.save()
daily_20160617 = pro.daily(start_date='',end_date='',trade_date='20160617', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20160617_tscode_list = list() 
for ts_code_sh in daily_20160617['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20160617_tscode_list.append(stock_name)
daily_20160617_addname_dataframe=pd.DataFrame()
daily_20160617_addname_dataframe['cname'] = daily_20160617_tscode_list
for table_name in daily_20160617.columns.values.tolist():
    daily_20160617_addname_dataframe[table_name] = daily_20160617[table_name]
print("日线行情-时间为序  daily_20160617 返回数据 row 行数 = "+str(daily_20160617.shape[0]))
daily_20160617_addname_dataframe.to_excel(daily_201606_excel_writer,'17_5',index=False)
daily_201606_excel_writer.save()
daily_20160620 = pro.daily(start_date='',end_date='',trade_date='20160620', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20160620_tscode_list = list() 
for ts_code_sh in daily_20160620['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20160620_tscode_list.append(stock_name)
daily_20160620_addname_dataframe=pd.DataFrame()
daily_20160620_addname_dataframe['cname'] = daily_20160620_tscode_list
for table_name in daily_20160620.columns.values.tolist():
    daily_20160620_addname_dataframe[table_name] = daily_20160620[table_name]
print("日线行情-时间为序  daily_20160620 返回数据 row 行数 = "+str(daily_20160620.shape[0]))
daily_20160620_addname_dataframe.to_excel(daily_201606_excel_writer,'20_1',index=False)
daily_201606_excel_writer.save()
daily_20160621 = pro.daily(start_date='',end_date='',trade_date='20160621', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20160621_tscode_list = list() 
for ts_code_sh in daily_20160621['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20160621_tscode_list.append(stock_name)
daily_20160621_addname_dataframe=pd.DataFrame()
daily_20160621_addname_dataframe['cname'] = daily_20160621_tscode_list
for table_name in daily_20160621.columns.values.tolist():
    daily_20160621_addname_dataframe[table_name] = daily_20160621[table_name]
print("日线行情-时间为序  daily_20160621 返回数据 row 行数 = "+str(daily_20160621.shape[0]))
daily_20160621_addname_dataframe.to_excel(daily_201606_excel_writer,'21_2',index=False)
daily_201606_excel_writer.save()
daily_20160622 = pro.daily(start_date='',end_date='',trade_date='20160622', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20160622_tscode_list = list() 
for ts_code_sh in daily_20160622['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20160622_tscode_list.append(stock_name)
daily_20160622_addname_dataframe=pd.DataFrame()
daily_20160622_addname_dataframe['cname'] = daily_20160622_tscode_list
for table_name in daily_20160622.columns.values.tolist():
    daily_20160622_addname_dataframe[table_name] = daily_20160622[table_name]
print("日线行情-时间为序  daily_20160622 返回数据 row 行数 = "+str(daily_20160622.shape[0]))
daily_20160622_addname_dataframe.to_excel(daily_201606_excel_writer,'22_3',index=False)
daily_201606_excel_writer.save()
daily_20160623 = pro.daily(start_date='',end_date='',trade_date='20160623', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20160623_tscode_list = list() 
for ts_code_sh in daily_20160623['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20160623_tscode_list.append(stock_name)
daily_20160623_addname_dataframe=pd.DataFrame()
daily_20160623_addname_dataframe['cname'] = daily_20160623_tscode_list
for table_name in daily_20160623.columns.values.tolist():
    daily_20160623_addname_dataframe[table_name] = daily_20160623[table_name]
print("日线行情-时间为序  daily_20160623 返回数据 row 行数 = "+str(daily_20160623.shape[0]))
daily_20160623_addname_dataframe.to_excel(daily_201606_excel_writer,'23_4',index=False)
daily_201606_excel_writer.save()
daily_20160624 = pro.daily(start_date='',end_date='',trade_date='20160624', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20160624_tscode_list = list() 
for ts_code_sh in daily_20160624['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20160624_tscode_list.append(stock_name)
daily_20160624_addname_dataframe=pd.DataFrame()
daily_20160624_addname_dataframe['cname'] = daily_20160624_tscode_list
for table_name in daily_20160624.columns.values.tolist():
    daily_20160624_addname_dataframe[table_name] = daily_20160624[table_name]
print("日线行情-时间为序  daily_20160624 返回数据 row 行数 = "+str(daily_20160624.shape[0]))
daily_20160624_addname_dataframe.to_excel(daily_201606_excel_writer,'24_5',index=False)
daily_201606_excel_writer.save()
daily_20160627 = pro.daily(start_date='',end_date='',trade_date='20160627', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20160627_tscode_list = list() 
for ts_code_sh in daily_20160627['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20160627_tscode_list.append(stock_name)
daily_20160627_addname_dataframe=pd.DataFrame()
daily_20160627_addname_dataframe['cname'] = daily_20160627_tscode_list
for table_name in daily_20160627.columns.values.tolist():
    daily_20160627_addname_dataframe[table_name] = daily_20160627[table_name]
print("日线行情-时间为序  daily_20160627 返回数据 row 行数 = "+str(daily_20160627.shape[0]))
daily_20160627_addname_dataframe.to_excel(daily_201606_excel_writer,'27_1',index=False)
daily_201606_excel_writer.save()
daily_20160628 = pro.daily(start_date='',end_date='',trade_date='20160628', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20160628_tscode_list = list() 
for ts_code_sh in daily_20160628['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20160628_tscode_list.append(stock_name)
daily_20160628_addname_dataframe=pd.DataFrame()
daily_20160628_addname_dataframe['cname'] = daily_20160628_tscode_list
for table_name in daily_20160628.columns.values.tolist():
    daily_20160628_addname_dataframe[table_name] = daily_20160628[table_name]
print("日线行情-时间为序  daily_20160628 返回数据 row 行数 = "+str(daily_20160628.shape[0]))
daily_20160628_addname_dataframe.to_excel(daily_201606_excel_writer,'28_2',index=False)
daily_201606_excel_writer.save()
daily_20160629 = pro.daily(start_date='',end_date='',trade_date='20160629', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20160629_tscode_list = list() 
for ts_code_sh in daily_20160629['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20160629_tscode_list.append(stock_name)
daily_20160629_addname_dataframe=pd.DataFrame()
daily_20160629_addname_dataframe['cname'] = daily_20160629_tscode_list
for table_name in daily_20160629.columns.values.tolist():
    daily_20160629_addname_dataframe[table_name] = daily_20160629[table_name]
print("日线行情-时间为序  daily_20160629 返回数据 row 行数 = "+str(daily_20160629.shape[0]))
daily_20160629_addname_dataframe.to_excel(daily_201606_excel_writer,'29_3',index=False)
daily_201606_excel_writer.save()
daily_20160630 = pro.daily(start_date='',end_date='',trade_date='20160630', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20160630_tscode_list = list() 
for ts_code_sh in daily_20160630['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20160630_tscode_list.append(stock_name)
daily_20160630_addname_dataframe=pd.DataFrame()
daily_20160630_addname_dataframe['cname'] = daily_20160630_tscode_list
for table_name in daily_20160630.columns.values.tolist():
    daily_20160630_addname_dataframe[table_name] = daily_20160630[table_name]
print("日线行情-时间为序  daily_20160630 返回数据 row 行数 = "+str(daily_20160630.shape[0]))
daily_20160630_addname_dataframe.to_excel(daily_201606_excel_writer,'30_4',index=False)
daily_201606_excel_writer.save()




createexcel('daily_201607.xlsx')
daily_201607_book = load_workbook('C:\\Users\\zhuzj5\\Desktop\\zbin\\J0_Data\\daily_201607.xlsx')
daily_201607_excel_writer = pd.ExcelWriter('C:\\Users\\zhuzj5\\Desktop\\zbin\\J0_Data\\daily_201607.xlsx', engine='openpyxl')
daily_201607_excel_writer.book = daily_201607_book
daily_201607_excel_writer.sheets = dict((ws.title, ws) for ws in daily_201607_book.worksheets)
J0_PROPS.put(tree_node_name+"record_date", "20160701")       ###  更新 记录日期
daily_20160701 = pro.daily(start_date='',end_date='',trade_date='20160701', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20160701_tscode_list = list() 
for ts_code_sh in daily_20160701['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20160701_tscode_list.append(stock_name)
daily_20160701_addname_dataframe=pd.DataFrame()
daily_20160701_addname_dataframe['cname'] = daily_20160701_tscode_list
for table_name in daily_20160701.columns.values.tolist():
    daily_20160701_addname_dataframe[table_name] = daily_20160701[table_name]
print("日线行情-时间为序  daily_20160701 返回数据 row 行数 = "+str(daily_20160701.shape[0]))
daily_20160701_addname_dataframe.to_excel(daily_201607_excel_writer,'1_5',index=False)
daily_201607_excel_writer.save()
daily_20160704 = pro.daily(start_date='',end_date='',trade_date='20160704', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20160704_tscode_list = list() 
for ts_code_sh in daily_20160704['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20160704_tscode_list.append(stock_name)
daily_20160704_addname_dataframe=pd.DataFrame()
daily_20160704_addname_dataframe['cname'] = daily_20160704_tscode_list
for table_name in daily_20160704.columns.values.tolist():
    daily_20160704_addname_dataframe[table_name] = daily_20160704[table_name]
print("日线行情-时间为序  daily_20160704 返回数据 row 行数 = "+str(daily_20160704.shape[0]))
daily_20160704_addname_dataframe.to_excel(daily_201607_excel_writer,'4_1',index=False)
daily_201607_excel_writer.save()
daily_20160705 = pro.daily(start_date='',end_date='',trade_date='20160705', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20160705_tscode_list = list() 
for ts_code_sh in daily_20160705['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20160705_tscode_list.append(stock_name)
daily_20160705_addname_dataframe=pd.DataFrame()
daily_20160705_addname_dataframe['cname'] = daily_20160705_tscode_list
for table_name in daily_20160705.columns.values.tolist():
    daily_20160705_addname_dataframe[table_name] = daily_20160705[table_name]
print("日线行情-时间为序  daily_20160705 返回数据 row 行数 = "+str(daily_20160705.shape[0]))
daily_20160705_addname_dataframe.to_excel(daily_201607_excel_writer,'5_2',index=False)
daily_201607_excel_writer.save()
daily_20160706 = pro.daily(start_date='',end_date='',trade_date='20160706', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20160706_tscode_list = list() 
for ts_code_sh in daily_20160706['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20160706_tscode_list.append(stock_name)
daily_20160706_addname_dataframe=pd.DataFrame()
daily_20160706_addname_dataframe['cname'] = daily_20160706_tscode_list
for table_name in daily_20160706.columns.values.tolist():
    daily_20160706_addname_dataframe[table_name] = daily_20160706[table_name]
print("日线行情-时间为序  daily_20160706 返回数据 row 行数 = "+str(daily_20160706.shape[0]))
daily_20160706_addname_dataframe.to_excel(daily_201607_excel_writer,'6_3',index=False)
daily_201607_excel_writer.save()
daily_20160707 = pro.daily(start_date='',end_date='',trade_date='20160707', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20160707_tscode_list = list() 
for ts_code_sh in daily_20160707['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20160707_tscode_list.append(stock_name)
daily_20160707_addname_dataframe=pd.DataFrame()
daily_20160707_addname_dataframe['cname'] = daily_20160707_tscode_list
for table_name in daily_20160707.columns.values.tolist():
    daily_20160707_addname_dataframe[table_name] = daily_20160707[table_name]
print("日线行情-时间为序  daily_20160707 返回数据 row 行数 = "+str(daily_20160707.shape[0]))
daily_20160707_addname_dataframe.to_excel(daily_201607_excel_writer,'7_4',index=False)
daily_201607_excel_writer.save()
daily_20160708 = pro.daily(start_date='',end_date='',trade_date='20160708', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20160708_tscode_list = list() 
for ts_code_sh in daily_20160708['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20160708_tscode_list.append(stock_name)
daily_20160708_addname_dataframe=pd.DataFrame()
daily_20160708_addname_dataframe['cname'] = daily_20160708_tscode_list
for table_name in daily_20160708.columns.values.tolist():
    daily_20160708_addname_dataframe[table_name] = daily_20160708[table_name]
print("日线行情-时间为序  daily_20160708 返回数据 row 行数 = "+str(daily_20160708.shape[0]))
daily_20160708_addname_dataframe.to_excel(daily_201607_excel_writer,'8_5',index=False)
daily_201607_excel_writer.save()
daily_20160711 = pro.daily(start_date='',end_date='',trade_date='20160711', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20160711_tscode_list = list() 
for ts_code_sh in daily_20160711['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20160711_tscode_list.append(stock_name)
daily_20160711_addname_dataframe=pd.DataFrame()
daily_20160711_addname_dataframe['cname'] = daily_20160711_tscode_list
for table_name in daily_20160711.columns.values.tolist():
    daily_20160711_addname_dataframe[table_name] = daily_20160711[table_name]
print("日线行情-时间为序  daily_20160711 返回数据 row 行数 = "+str(daily_20160711.shape[0]))
daily_20160711_addname_dataframe.to_excel(daily_201607_excel_writer,'11_1',index=False)
daily_201607_excel_writer.save()
daily_20160712 = pro.daily(start_date='',end_date='',trade_date='20160712', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20160712_tscode_list = list() 
for ts_code_sh in daily_20160712['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20160712_tscode_list.append(stock_name)
daily_20160712_addname_dataframe=pd.DataFrame()
daily_20160712_addname_dataframe['cname'] = daily_20160712_tscode_list
for table_name in daily_20160712.columns.values.tolist():
    daily_20160712_addname_dataframe[table_name] = daily_20160712[table_name]
print("日线行情-时间为序  daily_20160712 返回数据 row 行数 = "+str(daily_20160712.shape[0]))
daily_20160712_addname_dataframe.to_excel(daily_201607_excel_writer,'12_2',index=False)
daily_201607_excel_writer.save()
daily_20160713 = pro.daily(start_date='',end_date='',trade_date='20160713', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20160713_tscode_list = list() 
for ts_code_sh in daily_20160713['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20160713_tscode_list.append(stock_name)
daily_20160713_addname_dataframe=pd.DataFrame()
daily_20160713_addname_dataframe['cname'] = daily_20160713_tscode_list
for table_name in daily_20160713.columns.values.tolist():
    daily_20160713_addname_dataframe[table_name] = daily_20160713[table_name]
print("日线行情-时间为序  daily_20160713 返回数据 row 行数 = "+str(daily_20160713.shape[0]))
daily_20160713_addname_dataframe.to_excel(daily_201607_excel_writer,'13_3',index=False)
daily_201607_excel_writer.save()
daily_20160714 = pro.daily(start_date='',end_date='',trade_date='20160714', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20160714_tscode_list = list() 
for ts_code_sh in daily_20160714['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20160714_tscode_list.append(stock_name)
daily_20160714_addname_dataframe=pd.DataFrame()
daily_20160714_addname_dataframe['cname'] = daily_20160714_tscode_list
for table_name in daily_20160714.columns.values.tolist():
    daily_20160714_addname_dataframe[table_name] = daily_20160714[table_name]
print("日线行情-时间为序  daily_20160714 返回数据 row 行数 = "+str(daily_20160714.shape[0]))
daily_20160714_addname_dataframe.to_excel(daily_201607_excel_writer,'14_4',index=False)
daily_201607_excel_writer.save()
daily_20160715 = pro.daily(start_date='',end_date='',trade_date='20160715', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20160715_tscode_list = list() 
for ts_code_sh in daily_20160715['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20160715_tscode_list.append(stock_name)
daily_20160715_addname_dataframe=pd.DataFrame()
daily_20160715_addname_dataframe['cname'] = daily_20160715_tscode_list
for table_name in daily_20160715.columns.values.tolist():
    daily_20160715_addname_dataframe[table_name] = daily_20160715[table_name]
print("日线行情-时间为序  daily_20160715 返回数据 row 行数 = "+str(daily_20160715.shape[0]))
daily_20160715_addname_dataframe.to_excel(daily_201607_excel_writer,'15_5',index=False)
daily_201607_excel_writer.save()
daily_20160718 = pro.daily(start_date='',end_date='',trade_date='20160718', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20160718_tscode_list = list() 
for ts_code_sh in daily_20160718['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20160718_tscode_list.append(stock_name)
daily_20160718_addname_dataframe=pd.DataFrame()
daily_20160718_addname_dataframe['cname'] = daily_20160718_tscode_list
for table_name in daily_20160718.columns.values.tolist():
    daily_20160718_addname_dataframe[table_name] = daily_20160718[table_name]
print("日线行情-时间为序  daily_20160718 返回数据 row 行数 = "+str(daily_20160718.shape[0]))
daily_20160718_addname_dataframe.to_excel(daily_201607_excel_writer,'18_1',index=False)
daily_201607_excel_writer.save()
daily_20160719 = pro.daily(start_date='',end_date='',trade_date='20160719', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20160719_tscode_list = list() 
for ts_code_sh in daily_20160719['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20160719_tscode_list.append(stock_name)
daily_20160719_addname_dataframe=pd.DataFrame()
daily_20160719_addname_dataframe['cname'] = daily_20160719_tscode_list
for table_name in daily_20160719.columns.values.tolist():
    daily_20160719_addname_dataframe[table_name] = daily_20160719[table_name]
print("日线行情-时间为序  daily_20160719 返回数据 row 行数 = "+str(daily_20160719.shape[0]))
daily_20160719_addname_dataframe.to_excel(daily_201607_excel_writer,'19_2',index=False)
daily_201607_excel_writer.save()
daily_20160720 = pro.daily(start_date='',end_date='',trade_date='20160720', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20160720_tscode_list = list() 
for ts_code_sh in daily_20160720['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20160720_tscode_list.append(stock_name)
daily_20160720_addname_dataframe=pd.DataFrame()
daily_20160720_addname_dataframe['cname'] = daily_20160720_tscode_list
for table_name in daily_20160720.columns.values.tolist():
    daily_20160720_addname_dataframe[table_name] = daily_20160720[table_name]
print("日线行情-时间为序  daily_20160720 返回数据 row 行数 = "+str(daily_20160720.shape[0]))
daily_20160720_addname_dataframe.to_excel(daily_201607_excel_writer,'20_3',index=False)
daily_201607_excel_writer.save()
daily_20160721 = pro.daily(start_date='',end_date='',trade_date='20160721', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20160721_tscode_list = list() 
for ts_code_sh in daily_20160721['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20160721_tscode_list.append(stock_name)
daily_20160721_addname_dataframe=pd.DataFrame()
daily_20160721_addname_dataframe['cname'] = daily_20160721_tscode_list
for table_name in daily_20160721.columns.values.tolist():
    daily_20160721_addname_dataframe[table_name] = daily_20160721[table_name]
print("日线行情-时间为序  daily_20160721 返回数据 row 行数 = "+str(daily_20160721.shape[0]))
daily_20160721_addname_dataframe.to_excel(daily_201607_excel_writer,'21_4',index=False)
daily_201607_excel_writer.save()
daily_20160722 = pro.daily(start_date='',end_date='',trade_date='20160722', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20160722_tscode_list = list() 
for ts_code_sh in daily_20160722['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20160722_tscode_list.append(stock_name)
daily_20160722_addname_dataframe=pd.DataFrame()
daily_20160722_addname_dataframe['cname'] = daily_20160722_tscode_list
for table_name in daily_20160722.columns.values.tolist():
    daily_20160722_addname_dataframe[table_name] = daily_20160722[table_name]
print("日线行情-时间为序  daily_20160722 返回数据 row 行数 = "+str(daily_20160722.shape[0]))
daily_20160722_addname_dataframe.to_excel(daily_201607_excel_writer,'22_5',index=False)
daily_201607_excel_writer.save()
daily_20160725 = pro.daily(start_date='',end_date='',trade_date='20160725', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20160725_tscode_list = list() 
for ts_code_sh in daily_20160725['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20160725_tscode_list.append(stock_name)
daily_20160725_addname_dataframe=pd.DataFrame()
daily_20160725_addname_dataframe['cname'] = daily_20160725_tscode_list
for table_name in daily_20160725.columns.values.tolist():
    daily_20160725_addname_dataframe[table_name] = daily_20160725[table_name]
print("日线行情-时间为序  daily_20160725 返回数据 row 行数 = "+str(daily_20160725.shape[0]))
daily_20160725_addname_dataframe.to_excel(daily_201607_excel_writer,'25_1',index=False)
daily_201607_excel_writer.save()
daily_20160726 = pro.daily(start_date='',end_date='',trade_date='20160726', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20160726_tscode_list = list() 
for ts_code_sh in daily_20160726['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20160726_tscode_list.append(stock_name)
daily_20160726_addname_dataframe=pd.DataFrame()
daily_20160726_addname_dataframe['cname'] = daily_20160726_tscode_list
for table_name in daily_20160726.columns.values.tolist():
    daily_20160726_addname_dataframe[table_name] = daily_20160726[table_name]
print("日线行情-时间为序  daily_20160726 返回数据 row 行数 = "+str(daily_20160726.shape[0]))
daily_20160726_addname_dataframe.to_excel(daily_201607_excel_writer,'26_2',index=False)
daily_201607_excel_writer.save()
daily_20160727 = pro.daily(start_date='',end_date='',trade_date='20160727', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20160727_tscode_list = list() 
for ts_code_sh in daily_20160727['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20160727_tscode_list.append(stock_name)
daily_20160727_addname_dataframe=pd.DataFrame()
daily_20160727_addname_dataframe['cname'] = daily_20160727_tscode_list
for table_name in daily_20160727.columns.values.tolist():
    daily_20160727_addname_dataframe[table_name] = daily_20160727[table_name]
print("日线行情-时间为序  daily_20160727 返回数据 row 行数 = "+str(daily_20160727.shape[0]))
daily_20160727_addname_dataframe.to_excel(daily_201607_excel_writer,'27_3',index=False)
daily_201607_excel_writer.save()
daily_20160728 = pro.daily(start_date='',end_date='',trade_date='20160728', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20160728_tscode_list = list() 
for ts_code_sh in daily_20160728['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20160728_tscode_list.append(stock_name)
daily_20160728_addname_dataframe=pd.DataFrame()
daily_20160728_addname_dataframe['cname'] = daily_20160728_tscode_list
for table_name in daily_20160728.columns.values.tolist():
    daily_20160728_addname_dataframe[table_name] = daily_20160728[table_name]
print("日线行情-时间为序  daily_20160728 返回数据 row 行数 = "+str(daily_20160728.shape[0]))
daily_20160728_addname_dataframe.to_excel(daily_201607_excel_writer,'28_4',index=False)
daily_201607_excel_writer.save()
daily_20160729 = pro.daily(start_date='',end_date='',trade_date='20160729', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20160729_tscode_list = list() 
for ts_code_sh in daily_20160729['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20160729_tscode_list.append(stock_name)
daily_20160729_addname_dataframe=pd.DataFrame()
daily_20160729_addname_dataframe['cname'] = daily_20160729_tscode_list
for table_name in daily_20160729.columns.values.tolist():
    daily_20160729_addname_dataframe[table_name] = daily_20160729[table_name]
print("日线行情-时间为序  daily_20160729 返回数据 row 行数 = "+str(daily_20160729.shape[0]))
daily_20160729_addname_dataframe.to_excel(daily_201607_excel_writer,'29_5',index=False)
daily_201607_excel_writer.save()




createexcel('daily_201608.xlsx')
daily_201608_book = load_workbook('C:\\Users\\zhuzj5\\Desktop\\zbin\\J0_Data\\daily_201608.xlsx')
daily_201608_excel_writer = pd.ExcelWriter('C:\\Users\\zhuzj5\\Desktop\\zbin\\J0_Data\\daily_201608.xlsx', engine='openpyxl')
daily_201608_excel_writer.book = daily_201608_book
daily_201608_excel_writer.sheets = dict((ws.title, ws) for ws in daily_201608_book.worksheets)
J0_PROPS.put(tree_node_name+"record_date", "20160801")       ###  更新 记录日期
daily_20160801 = pro.daily(start_date='',end_date='',trade_date='20160801', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20160801_tscode_list = list() 
for ts_code_sh in daily_20160801['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20160801_tscode_list.append(stock_name)
daily_20160801_addname_dataframe=pd.DataFrame()
daily_20160801_addname_dataframe['cname'] = daily_20160801_tscode_list
for table_name in daily_20160801.columns.values.tolist():
    daily_20160801_addname_dataframe[table_name] = daily_20160801[table_name]
print("日线行情-时间为序  daily_20160801 返回数据 row 行数 = "+str(daily_20160801.shape[0]))
daily_20160801_addname_dataframe.to_excel(daily_201608_excel_writer,'1_1',index=False)
daily_201608_excel_writer.save()
daily_20160802 = pro.daily(start_date='',end_date='',trade_date='20160802', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20160802_tscode_list = list() 
for ts_code_sh in daily_20160802['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20160802_tscode_list.append(stock_name)
daily_20160802_addname_dataframe=pd.DataFrame()
daily_20160802_addname_dataframe['cname'] = daily_20160802_tscode_list
for table_name in daily_20160802.columns.values.tolist():
    daily_20160802_addname_dataframe[table_name] = daily_20160802[table_name]
print("日线行情-时间为序  daily_20160802 返回数据 row 行数 = "+str(daily_20160802.shape[0]))
daily_20160802_addname_dataframe.to_excel(daily_201608_excel_writer,'2_2',index=False)
daily_201608_excel_writer.save()
daily_20160803 = pro.daily(start_date='',end_date='',trade_date='20160803', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20160803_tscode_list = list() 
for ts_code_sh in daily_20160803['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20160803_tscode_list.append(stock_name)
daily_20160803_addname_dataframe=pd.DataFrame()
daily_20160803_addname_dataframe['cname'] = daily_20160803_tscode_list
for table_name in daily_20160803.columns.values.tolist():
    daily_20160803_addname_dataframe[table_name] = daily_20160803[table_name]
print("日线行情-时间为序  daily_20160803 返回数据 row 行数 = "+str(daily_20160803.shape[0]))
daily_20160803_addname_dataframe.to_excel(daily_201608_excel_writer,'3_3',index=False)
daily_201608_excel_writer.save()
daily_20160804 = pro.daily(start_date='',end_date='',trade_date='20160804', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20160804_tscode_list = list() 
for ts_code_sh in daily_20160804['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20160804_tscode_list.append(stock_name)
daily_20160804_addname_dataframe=pd.DataFrame()
daily_20160804_addname_dataframe['cname'] = daily_20160804_tscode_list
for table_name in daily_20160804.columns.values.tolist():
    daily_20160804_addname_dataframe[table_name] = daily_20160804[table_name]
print("日线行情-时间为序  daily_20160804 返回数据 row 行数 = "+str(daily_20160804.shape[0]))
daily_20160804_addname_dataframe.to_excel(daily_201608_excel_writer,'4_4',index=False)
daily_201608_excel_writer.save()
daily_20160805 = pro.daily(start_date='',end_date='',trade_date='20160805', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20160805_tscode_list = list() 
for ts_code_sh in daily_20160805['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20160805_tscode_list.append(stock_name)
daily_20160805_addname_dataframe=pd.DataFrame()
daily_20160805_addname_dataframe['cname'] = daily_20160805_tscode_list
for table_name in daily_20160805.columns.values.tolist():
    daily_20160805_addname_dataframe[table_name] = daily_20160805[table_name]
print("日线行情-时间为序  daily_20160805 返回数据 row 行数 = "+str(daily_20160805.shape[0]))
daily_20160805_addname_dataframe.to_excel(daily_201608_excel_writer,'5_5',index=False)
daily_201608_excel_writer.save()
daily_20160808 = pro.daily(start_date='',end_date='',trade_date='20160808', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20160808_tscode_list = list() 
for ts_code_sh in daily_20160808['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20160808_tscode_list.append(stock_name)
daily_20160808_addname_dataframe=pd.DataFrame()
daily_20160808_addname_dataframe['cname'] = daily_20160808_tscode_list
for table_name in daily_20160808.columns.values.tolist():
    daily_20160808_addname_dataframe[table_name] = daily_20160808[table_name]
print("日线行情-时间为序  daily_20160808 返回数据 row 行数 = "+str(daily_20160808.shape[0]))
daily_20160808_addname_dataframe.to_excel(daily_201608_excel_writer,'8_1',index=False)
daily_201608_excel_writer.save()
daily_20160809 = pro.daily(start_date='',end_date='',trade_date='20160809', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20160809_tscode_list = list() 
for ts_code_sh in daily_20160809['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20160809_tscode_list.append(stock_name)
daily_20160809_addname_dataframe=pd.DataFrame()
daily_20160809_addname_dataframe['cname'] = daily_20160809_tscode_list
for table_name in daily_20160809.columns.values.tolist():
    daily_20160809_addname_dataframe[table_name] = daily_20160809[table_name]
print("日线行情-时间为序  daily_20160809 返回数据 row 行数 = "+str(daily_20160809.shape[0]))
daily_20160809_addname_dataframe.to_excel(daily_201608_excel_writer,'9_2',index=False)
daily_201608_excel_writer.save()
daily_20160810 = pro.daily(start_date='',end_date='',trade_date='20160810', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20160810_tscode_list = list() 
for ts_code_sh in daily_20160810['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20160810_tscode_list.append(stock_name)
daily_20160810_addname_dataframe=pd.DataFrame()
daily_20160810_addname_dataframe['cname'] = daily_20160810_tscode_list
for table_name in daily_20160810.columns.values.tolist():
    daily_20160810_addname_dataframe[table_name] = daily_20160810[table_name]
print("日线行情-时间为序  daily_20160810 返回数据 row 行数 = "+str(daily_20160810.shape[0]))
daily_20160810_addname_dataframe.to_excel(daily_201608_excel_writer,'10_3',index=False)
daily_201608_excel_writer.save()
daily_20160811 = pro.daily(start_date='',end_date='',trade_date='20160811', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20160811_tscode_list = list() 
for ts_code_sh in daily_20160811['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20160811_tscode_list.append(stock_name)
daily_20160811_addname_dataframe=pd.DataFrame()
daily_20160811_addname_dataframe['cname'] = daily_20160811_tscode_list
for table_name in daily_20160811.columns.values.tolist():
    daily_20160811_addname_dataframe[table_name] = daily_20160811[table_name]
print("日线行情-时间为序  daily_20160811 返回数据 row 行数 = "+str(daily_20160811.shape[0]))
daily_20160811_addname_dataframe.to_excel(daily_201608_excel_writer,'11_4',index=False)
daily_201608_excel_writer.save()
daily_20160812 = pro.daily(start_date='',end_date='',trade_date='20160812', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20160812_tscode_list = list() 
for ts_code_sh in daily_20160812['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20160812_tscode_list.append(stock_name)
daily_20160812_addname_dataframe=pd.DataFrame()
daily_20160812_addname_dataframe['cname'] = daily_20160812_tscode_list
for table_name in daily_20160812.columns.values.tolist():
    daily_20160812_addname_dataframe[table_name] = daily_20160812[table_name]
print("日线行情-时间为序  daily_20160812 返回数据 row 行数 = "+str(daily_20160812.shape[0]))
daily_20160812_addname_dataframe.to_excel(daily_201608_excel_writer,'12_5',index=False)
daily_201608_excel_writer.save()
daily_20160815 = pro.daily(start_date='',end_date='',trade_date='20160815', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20160815_tscode_list = list() 
for ts_code_sh in daily_20160815['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20160815_tscode_list.append(stock_name)
daily_20160815_addname_dataframe=pd.DataFrame()
daily_20160815_addname_dataframe['cname'] = daily_20160815_tscode_list
for table_name in daily_20160815.columns.values.tolist():
    daily_20160815_addname_dataframe[table_name] = daily_20160815[table_name]
print("日线行情-时间为序  daily_20160815 返回数据 row 行数 = "+str(daily_20160815.shape[0]))
daily_20160815_addname_dataframe.to_excel(daily_201608_excel_writer,'15_1',index=False)
daily_201608_excel_writer.save()
daily_20160816 = pro.daily(start_date='',end_date='',trade_date='20160816', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20160816_tscode_list = list() 
for ts_code_sh in daily_20160816['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20160816_tscode_list.append(stock_name)
daily_20160816_addname_dataframe=pd.DataFrame()
daily_20160816_addname_dataframe['cname'] = daily_20160816_tscode_list
for table_name in daily_20160816.columns.values.tolist():
    daily_20160816_addname_dataframe[table_name] = daily_20160816[table_name]
print("日线行情-时间为序  daily_20160816 返回数据 row 行数 = "+str(daily_20160816.shape[0]))
daily_20160816_addname_dataframe.to_excel(daily_201608_excel_writer,'16_2',index=False)
daily_201608_excel_writer.save()
daily_20160817 = pro.daily(start_date='',end_date='',trade_date='20160817', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20160817_tscode_list = list() 
for ts_code_sh in daily_20160817['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20160817_tscode_list.append(stock_name)
daily_20160817_addname_dataframe=pd.DataFrame()
daily_20160817_addname_dataframe['cname'] = daily_20160817_tscode_list
for table_name in daily_20160817.columns.values.tolist():
    daily_20160817_addname_dataframe[table_name] = daily_20160817[table_name]
print("日线行情-时间为序  daily_20160817 返回数据 row 行数 = "+str(daily_20160817.shape[0]))
daily_20160817_addname_dataframe.to_excel(daily_201608_excel_writer,'17_3',index=False)
daily_201608_excel_writer.save()
daily_20160818 = pro.daily(start_date='',end_date='',trade_date='20160818', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20160818_tscode_list = list() 
for ts_code_sh in daily_20160818['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20160818_tscode_list.append(stock_name)
daily_20160818_addname_dataframe=pd.DataFrame()
daily_20160818_addname_dataframe['cname'] = daily_20160818_tscode_list
for table_name in daily_20160818.columns.values.tolist():
    daily_20160818_addname_dataframe[table_name] = daily_20160818[table_name]
print("日线行情-时间为序  daily_20160818 返回数据 row 行数 = "+str(daily_20160818.shape[0]))
daily_20160818_addname_dataframe.to_excel(daily_201608_excel_writer,'18_4',index=False)
daily_201608_excel_writer.save()
daily_20160819 = pro.daily(start_date='',end_date='',trade_date='20160819', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20160819_tscode_list = list() 
for ts_code_sh in daily_20160819['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20160819_tscode_list.append(stock_name)
daily_20160819_addname_dataframe=pd.DataFrame()
daily_20160819_addname_dataframe['cname'] = daily_20160819_tscode_list
for table_name in daily_20160819.columns.values.tolist():
    daily_20160819_addname_dataframe[table_name] = daily_20160819[table_name]
print("日线行情-时间为序  daily_20160819 返回数据 row 行数 = "+str(daily_20160819.shape[0]))
daily_20160819_addname_dataframe.to_excel(daily_201608_excel_writer,'19_5',index=False)
daily_201608_excel_writer.save()
daily_20160822 = pro.daily(start_date='',end_date='',trade_date='20160822', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20160822_tscode_list = list() 
for ts_code_sh in daily_20160822['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20160822_tscode_list.append(stock_name)
daily_20160822_addname_dataframe=pd.DataFrame()
daily_20160822_addname_dataframe['cname'] = daily_20160822_tscode_list
for table_name in daily_20160822.columns.values.tolist():
    daily_20160822_addname_dataframe[table_name] = daily_20160822[table_name]
print("日线行情-时间为序  daily_20160822 返回数据 row 行数 = "+str(daily_20160822.shape[0]))
daily_20160822_addname_dataframe.to_excel(daily_201608_excel_writer,'22_1',index=False)
daily_201608_excel_writer.save()
daily_20160823 = pro.daily(start_date='',end_date='',trade_date='20160823', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20160823_tscode_list = list() 
for ts_code_sh in daily_20160823['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20160823_tscode_list.append(stock_name)
daily_20160823_addname_dataframe=pd.DataFrame()
daily_20160823_addname_dataframe['cname'] = daily_20160823_tscode_list
for table_name in daily_20160823.columns.values.tolist():
    daily_20160823_addname_dataframe[table_name] = daily_20160823[table_name]
print("日线行情-时间为序  daily_20160823 返回数据 row 行数 = "+str(daily_20160823.shape[0]))
daily_20160823_addname_dataframe.to_excel(daily_201608_excel_writer,'23_2',index=False)
daily_201608_excel_writer.save()
daily_20160824 = pro.daily(start_date='',end_date='',trade_date='20160824', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20160824_tscode_list = list() 
for ts_code_sh in daily_20160824['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20160824_tscode_list.append(stock_name)
daily_20160824_addname_dataframe=pd.DataFrame()
daily_20160824_addname_dataframe['cname'] = daily_20160824_tscode_list
for table_name in daily_20160824.columns.values.tolist():
    daily_20160824_addname_dataframe[table_name] = daily_20160824[table_name]
print("日线行情-时间为序  daily_20160824 返回数据 row 行数 = "+str(daily_20160824.shape[0]))
daily_20160824_addname_dataframe.to_excel(daily_201608_excel_writer,'24_3',index=False)
daily_201608_excel_writer.save()
daily_20160825 = pro.daily(start_date='',end_date='',trade_date='20160825', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20160825_tscode_list = list() 
for ts_code_sh in daily_20160825['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20160825_tscode_list.append(stock_name)
daily_20160825_addname_dataframe=pd.DataFrame()
daily_20160825_addname_dataframe['cname'] = daily_20160825_tscode_list
for table_name in daily_20160825.columns.values.tolist():
    daily_20160825_addname_dataframe[table_name] = daily_20160825[table_name]
print("日线行情-时间为序  daily_20160825 返回数据 row 行数 = "+str(daily_20160825.shape[0]))
daily_20160825_addname_dataframe.to_excel(daily_201608_excel_writer,'25_4',index=False)
daily_201608_excel_writer.save()
daily_20160826 = pro.daily(start_date='',end_date='',trade_date='20160826', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20160826_tscode_list = list() 
for ts_code_sh in daily_20160826['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20160826_tscode_list.append(stock_name)
daily_20160826_addname_dataframe=pd.DataFrame()
daily_20160826_addname_dataframe['cname'] = daily_20160826_tscode_list
for table_name in daily_20160826.columns.values.tolist():
    daily_20160826_addname_dataframe[table_name] = daily_20160826[table_name]
print("日线行情-时间为序  daily_20160826 返回数据 row 行数 = "+str(daily_20160826.shape[0]))
daily_20160826_addname_dataframe.to_excel(daily_201608_excel_writer,'26_5',index=False)
daily_201608_excel_writer.save()
daily_20160829 = pro.daily(start_date='',end_date='',trade_date='20160829', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20160829_tscode_list = list() 
for ts_code_sh in daily_20160829['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20160829_tscode_list.append(stock_name)
daily_20160829_addname_dataframe=pd.DataFrame()
daily_20160829_addname_dataframe['cname'] = daily_20160829_tscode_list
for table_name in daily_20160829.columns.values.tolist():
    daily_20160829_addname_dataframe[table_name] = daily_20160829[table_name]
print("日线行情-时间为序  daily_20160829 返回数据 row 行数 = "+str(daily_20160829.shape[0]))
daily_20160829_addname_dataframe.to_excel(daily_201608_excel_writer,'29_1',index=False)
daily_201608_excel_writer.save()
daily_20160830 = pro.daily(start_date='',end_date='',trade_date='20160830', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20160830_tscode_list = list() 
for ts_code_sh in daily_20160830['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20160830_tscode_list.append(stock_name)
daily_20160830_addname_dataframe=pd.DataFrame()
daily_20160830_addname_dataframe['cname'] = daily_20160830_tscode_list
for table_name in daily_20160830.columns.values.tolist():
    daily_20160830_addname_dataframe[table_name] = daily_20160830[table_name]
print("日线行情-时间为序  daily_20160830 返回数据 row 行数 = "+str(daily_20160830.shape[0]))
daily_20160830_addname_dataframe.to_excel(daily_201608_excel_writer,'30_2',index=False)
daily_201608_excel_writer.save()
daily_20160831 = pro.daily(start_date='',end_date='',trade_date='20160831', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20160831_tscode_list = list() 
for ts_code_sh in daily_20160831['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20160831_tscode_list.append(stock_name)
daily_20160831_addname_dataframe=pd.DataFrame()
daily_20160831_addname_dataframe['cname'] = daily_20160831_tscode_list
for table_name in daily_20160831.columns.values.tolist():
    daily_20160831_addname_dataframe[table_name] = daily_20160831[table_name]
print("日线行情-时间为序  daily_20160831 返回数据 row 行数 = "+str(daily_20160831.shape[0]))
daily_20160831_addname_dataframe.to_excel(daily_201608_excel_writer,'31_3',index=False)
daily_201608_excel_writer.save()




createexcel('daily_201609.xlsx')
daily_201609_book = load_workbook('C:\\Users\\zhuzj5\\Desktop\\zbin\\J0_Data\\daily_201609.xlsx')
daily_201609_excel_writer = pd.ExcelWriter('C:\\Users\\zhuzj5\\Desktop\\zbin\\J0_Data\\daily_201609.xlsx', engine='openpyxl')
daily_201609_excel_writer.book = daily_201609_book
daily_201609_excel_writer.sheets = dict((ws.title, ws) for ws in daily_201609_book.worksheets)
J0_PROPS.put(tree_node_name+"record_date", "20160901")       ###  更新 记录日期
daily_20160901 = pro.daily(start_date='',end_date='',trade_date='20160901', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20160901_tscode_list = list() 
for ts_code_sh in daily_20160901['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20160901_tscode_list.append(stock_name)
daily_20160901_addname_dataframe=pd.DataFrame()
daily_20160901_addname_dataframe['cname'] = daily_20160901_tscode_list
for table_name in daily_20160901.columns.values.tolist():
    daily_20160901_addname_dataframe[table_name] = daily_20160901[table_name]
print("日线行情-时间为序  daily_20160901 返回数据 row 行数 = "+str(daily_20160901.shape[0]))
daily_20160901_addname_dataframe.to_excel(daily_201609_excel_writer,'1_4',index=False)
daily_201609_excel_writer.save()
daily_20160902 = pro.daily(start_date='',end_date='',trade_date='20160902', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20160902_tscode_list = list() 
for ts_code_sh in daily_20160902['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20160902_tscode_list.append(stock_name)
daily_20160902_addname_dataframe=pd.DataFrame()
daily_20160902_addname_dataframe['cname'] = daily_20160902_tscode_list
for table_name in daily_20160902.columns.values.tolist():
    daily_20160902_addname_dataframe[table_name] = daily_20160902[table_name]
print("日线行情-时间为序  daily_20160902 返回数据 row 行数 = "+str(daily_20160902.shape[0]))
daily_20160902_addname_dataframe.to_excel(daily_201609_excel_writer,'2_5',index=False)
daily_201609_excel_writer.save()
daily_20160905 = pro.daily(start_date='',end_date='',trade_date='20160905', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20160905_tscode_list = list() 
for ts_code_sh in daily_20160905['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20160905_tscode_list.append(stock_name)
daily_20160905_addname_dataframe=pd.DataFrame()
daily_20160905_addname_dataframe['cname'] = daily_20160905_tscode_list
for table_name in daily_20160905.columns.values.tolist():
    daily_20160905_addname_dataframe[table_name] = daily_20160905[table_name]
print("日线行情-时间为序  daily_20160905 返回数据 row 行数 = "+str(daily_20160905.shape[0]))
daily_20160905_addname_dataframe.to_excel(daily_201609_excel_writer,'5_1',index=False)
daily_201609_excel_writer.save()
daily_20160906 = pro.daily(start_date='',end_date='',trade_date='20160906', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20160906_tscode_list = list() 
for ts_code_sh in daily_20160906['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20160906_tscode_list.append(stock_name)
daily_20160906_addname_dataframe=pd.DataFrame()
daily_20160906_addname_dataframe['cname'] = daily_20160906_tscode_list
for table_name in daily_20160906.columns.values.tolist():
    daily_20160906_addname_dataframe[table_name] = daily_20160906[table_name]
print("日线行情-时间为序  daily_20160906 返回数据 row 行数 = "+str(daily_20160906.shape[0]))
daily_20160906_addname_dataframe.to_excel(daily_201609_excel_writer,'6_2',index=False)
daily_201609_excel_writer.save()
daily_20160907 = pro.daily(start_date='',end_date='',trade_date='20160907', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20160907_tscode_list = list() 
for ts_code_sh in daily_20160907['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20160907_tscode_list.append(stock_name)
daily_20160907_addname_dataframe=pd.DataFrame()
daily_20160907_addname_dataframe['cname'] = daily_20160907_tscode_list
for table_name in daily_20160907.columns.values.tolist():
    daily_20160907_addname_dataframe[table_name] = daily_20160907[table_name]
print("日线行情-时间为序  daily_20160907 返回数据 row 行数 = "+str(daily_20160907.shape[0]))
daily_20160907_addname_dataframe.to_excel(daily_201609_excel_writer,'7_3',index=False)
daily_201609_excel_writer.save()
daily_20160908 = pro.daily(start_date='',end_date='',trade_date='20160908', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20160908_tscode_list = list() 
for ts_code_sh in daily_20160908['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20160908_tscode_list.append(stock_name)
daily_20160908_addname_dataframe=pd.DataFrame()
daily_20160908_addname_dataframe['cname'] = daily_20160908_tscode_list
for table_name in daily_20160908.columns.values.tolist():
    daily_20160908_addname_dataframe[table_name] = daily_20160908[table_name]
print("日线行情-时间为序  daily_20160908 返回数据 row 行数 = "+str(daily_20160908.shape[0]))
daily_20160908_addname_dataframe.to_excel(daily_201609_excel_writer,'8_4',index=False)
daily_201609_excel_writer.save()
daily_20160909 = pro.daily(start_date='',end_date='',trade_date='20160909', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20160909_tscode_list = list() 
for ts_code_sh in daily_20160909['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20160909_tscode_list.append(stock_name)
daily_20160909_addname_dataframe=pd.DataFrame()
daily_20160909_addname_dataframe['cname'] = daily_20160909_tscode_list
for table_name in daily_20160909.columns.values.tolist():
    daily_20160909_addname_dataframe[table_name] = daily_20160909[table_name]
print("日线行情-时间为序  daily_20160909 返回数据 row 行数 = "+str(daily_20160909.shape[0]))
daily_20160909_addname_dataframe.to_excel(daily_201609_excel_writer,'9_5',index=False)
daily_201609_excel_writer.save()
daily_20160912 = pro.daily(start_date='',end_date='',trade_date='20160912', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20160912_tscode_list = list() 
for ts_code_sh in daily_20160912['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20160912_tscode_list.append(stock_name)
daily_20160912_addname_dataframe=pd.DataFrame()
daily_20160912_addname_dataframe['cname'] = daily_20160912_tscode_list
for table_name in daily_20160912.columns.values.tolist():
    daily_20160912_addname_dataframe[table_name] = daily_20160912[table_name]
print("日线行情-时间为序  daily_20160912 返回数据 row 行数 = "+str(daily_20160912.shape[0]))
daily_20160912_addname_dataframe.to_excel(daily_201609_excel_writer,'12_1',index=False)
daily_201609_excel_writer.save()
daily_20160913 = pro.daily(start_date='',end_date='',trade_date='20160913', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20160913_tscode_list = list() 
for ts_code_sh in daily_20160913['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20160913_tscode_list.append(stock_name)
daily_20160913_addname_dataframe=pd.DataFrame()
daily_20160913_addname_dataframe['cname'] = daily_20160913_tscode_list
for table_name in daily_20160913.columns.values.tolist():
    daily_20160913_addname_dataframe[table_name] = daily_20160913[table_name]
print("日线行情-时间为序  daily_20160913 返回数据 row 行数 = "+str(daily_20160913.shape[0]))
daily_20160913_addname_dataframe.to_excel(daily_201609_excel_writer,'13_2',index=False)
daily_201609_excel_writer.save()
daily_20160914 = pro.daily(start_date='',end_date='',trade_date='20160914', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20160914_tscode_list = list() 
for ts_code_sh in daily_20160914['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20160914_tscode_list.append(stock_name)
daily_20160914_addname_dataframe=pd.DataFrame()
daily_20160914_addname_dataframe['cname'] = daily_20160914_tscode_list
for table_name in daily_20160914.columns.values.tolist():
    daily_20160914_addname_dataframe[table_name] = daily_20160914[table_name]
print("日线行情-时间为序  daily_20160914 返回数据 row 行数 = "+str(daily_20160914.shape[0]))
daily_20160914_addname_dataframe.to_excel(daily_201609_excel_writer,'14_3',index=False)
daily_201609_excel_writer.save()
daily_20160919 = pro.daily(start_date='',end_date='',trade_date='20160919', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20160919_tscode_list = list() 
for ts_code_sh in daily_20160919['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20160919_tscode_list.append(stock_name)
daily_20160919_addname_dataframe=pd.DataFrame()
daily_20160919_addname_dataframe['cname'] = daily_20160919_tscode_list
for table_name in daily_20160919.columns.values.tolist():
    daily_20160919_addname_dataframe[table_name] = daily_20160919[table_name]
print("日线行情-时间为序  daily_20160919 返回数据 row 行数 = "+str(daily_20160919.shape[0]))
daily_20160919_addname_dataframe.to_excel(daily_201609_excel_writer,'19_1',index=False)
daily_201609_excel_writer.save()
daily_20160920 = pro.daily(start_date='',end_date='',trade_date='20160920', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20160920_tscode_list = list() 
for ts_code_sh in daily_20160920['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20160920_tscode_list.append(stock_name)
daily_20160920_addname_dataframe=pd.DataFrame()
daily_20160920_addname_dataframe['cname'] = daily_20160920_tscode_list
for table_name in daily_20160920.columns.values.tolist():
    daily_20160920_addname_dataframe[table_name] = daily_20160920[table_name]
print("日线行情-时间为序  daily_20160920 返回数据 row 行数 = "+str(daily_20160920.shape[0]))
daily_20160920_addname_dataframe.to_excel(daily_201609_excel_writer,'20_2',index=False)
daily_201609_excel_writer.save()
daily_20160921 = pro.daily(start_date='',end_date='',trade_date='20160921', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20160921_tscode_list = list() 
for ts_code_sh in daily_20160921['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20160921_tscode_list.append(stock_name)
daily_20160921_addname_dataframe=pd.DataFrame()
daily_20160921_addname_dataframe['cname'] = daily_20160921_tscode_list
for table_name in daily_20160921.columns.values.tolist():
    daily_20160921_addname_dataframe[table_name] = daily_20160921[table_name]
print("日线行情-时间为序  daily_20160921 返回数据 row 行数 = "+str(daily_20160921.shape[0]))
daily_20160921_addname_dataframe.to_excel(daily_201609_excel_writer,'21_3',index=False)
daily_201609_excel_writer.save()
daily_20160922 = pro.daily(start_date='',end_date='',trade_date='20160922', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20160922_tscode_list = list() 
for ts_code_sh in daily_20160922['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20160922_tscode_list.append(stock_name)
daily_20160922_addname_dataframe=pd.DataFrame()
daily_20160922_addname_dataframe['cname'] = daily_20160922_tscode_list
for table_name in daily_20160922.columns.values.tolist():
    daily_20160922_addname_dataframe[table_name] = daily_20160922[table_name]
print("日线行情-时间为序  daily_20160922 返回数据 row 行数 = "+str(daily_20160922.shape[0]))
daily_20160922_addname_dataframe.to_excel(daily_201609_excel_writer,'22_4',index=False)
daily_201609_excel_writer.save()
daily_20160923 = pro.daily(start_date='',end_date='',trade_date='20160923', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20160923_tscode_list = list() 
for ts_code_sh in daily_20160923['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20160923_tscode_list.append(stock_name)
daily_20160923_addname_dataframe=pd.DataFrame()
daily_20160923_addname_dataframe['cname'] = daily_20160923_tscode_list
for table_name in daily_20160923.columns.values.tolist():
    daily_20160923_addname_dataframe[table_name] = daily_20160923[table_name]
print("日线行情-时间为序  daily_20160923 返回数据 row 行数 = "+str(daily_20160923.shape[0]))
daily_20160923_addname_dataframe.to_excel(daily_201609_excel_writer,'23_5',index=False)
daily_201609_excel_writer.save()
daily_20160926 = pro.daily(start_date='',end_date='',trade_date='20160926', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20160926_tscode_list = list() 
for ts_code_sh in daily_20160926['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20160926_tscode_list.append(stock_name)
daily_20160926_addname_dataframe=pd.DataFrame()
daily_20160926_addname_dataframe['cname'] = daily_20160926_tscode_list
for table_name in daily_20160926.columns.values.tolist():
    daily_20160926_addname_dataframe[table_name] = daily_20160926[table_name]
print("日线行情-时间为序  daily_20160926 返回数据 row 行数 = "+str(daily_20160926.shape[0]))
daily_20160926_addname_dataframe.to_excel(daily_201609_excel_writer,'26_1',index=False)
daily_201609_excel_writer.save()
daily_20160927 = pro.daily(start_date='',end_date='',trade_date='20160927', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20160927_tscode_list = list() 
for ts_code_sh in daily_20160927['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20160927_tscode_list.append(stock_name)
daily_20160927_addname_dataframe=pd.DataFrame()
daily_20160927_addname_dataframe['cname'] = daily_20160927_tscode_list
for table_name in daily_20160927.columns.values.tolist():
    daily_20160927_addname_dataframe[table_name] = daily_20160927[table_name]
print("日线行情-时间为序  daily_20160927 返回数据 row 行数 = "+str(daily_20160927.shape[0]))
daily_20160927_addname_dataframe.to_excel(daily_201609_excel_writer,'27_2',index=False)
daily_201609_excel_writer.save()
daily_20160928 = pro.daily(start_date='',end_date='',trade_date='20160928', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20160928_tscode_list = list() 
for ts_code_sh in daily_20160928['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20160928_tscode_list.append(stock_name)
daily_20160928_addname_dataframe=pd.DataFrame()
daily_20160928_addname_dataframe['cname'] = daily_20160928_tscode_list
for table_name in daily_20160928.columns.values.tolist():
    daily_20160928_addname_dataframe[table_name] = daily_20160928[table_name]
print("日线行情-时间为序  daily_20160928 返回数据 row 行数 = "+str(daily_20160928.shape[0]))
daily_20160928_addname_dataframe.to_excel(daily_201609_excel_writer,'28_3',index=False)
daily_201609_excel_writer.save()
daily_20160929 = pro.daily(start_date='',end_date='',trade_date='20160929', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20160929_tscode_list = list() 
for ts_code_sh in daily_20160929['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20160929_tscode_list.append(stock_name)
daily_20160929_addname_dataframe=pd.DataFrame()
daily_20160929_addname_dataframe['cname'] = daily_20160929_tscode_list
for table_name in daily_20160929.columns.values.tolist():
    daily_20160929_addname_dataframe[table_name] = daily_20160929[table_name]
print("日线行情-时间为序  daily_20160929 返回数据 row 行数 = "+str(daily_20160929.shape[0]))
daily_20160929_addname_dataframe.to_excel(daily_201609_excel_writer,'29_4',index=False)
daily_201609_excel_writer.save()
daily_20160930 = pro.daily(start_date='',end_date='',trade_date='20160930', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20160930_tscode_list = list() 
for ts_code_sh in daily_20160930['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20160930_tscode_list.append(stock_name)
daily_20160930_addname_dataframe=pd.DataFrame()
daily_20160930_addname_dataframe['cname'] = daily_20160930_tscode_list
for table_name in daily_20160930.columns.values.tolist():
    daily_20160930_addname_dataframe[table_name] = daily_20160930[table_name]
print("日线行情-时间为序  daily_20160930 返回数据 row 行数 = "+str(daily_20160930.shape[0]))
daily_20160930_addname_dataframe.to_excel(daily_201609_excel_writer,'30_5',index=False)
daily_201609_excel_writer.save()




createexcel('daily_201610.xlsx')
daily_201610_book = load_workbook('C:\\Users\\zhuzj5\\Desktop\\zbin\\J0_Data\\daily_201610.xlsx')
daily_201610_excel_writer = pd.ExcelWriter('C:\\Users\\zhuzj5\\Desktop\\zbin\\J0_Data\\daily_201610.xlsx', engine='openpyxl')
daily_201610_excel_writer.book = daily_201610_book
daily_201610_excel_writer.sheets = dict((ws.title, ws) for ws in daily_201610_book.worksheets)
J0_PROPS.put(tree_node_name+"record_date", "20161001")       ###  更新 记录日期
daily_20161010 = pro.daily(start_date='',end_date='',trade_date='20161010', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20161010_tscode_list = list() 
for ts_code_sh in daily_20161010['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20161010_tscode_list.append(stock_name)
daily_20161010_addname_dataframe=pd.DataFrame()
daily_20161010_addname_dataframe['cname'] = daily_20161010_tscode_list
for table_name in daily_20161010.columns.values.tolist():
    daily_20161010_addname_dataframe[table_name] = daily_20161010[table_name]
print("日线行情-时间为序  daily_20161010 返回数据 row 行数 = "+str(daily_20161010.shape[0]))
daily_20161010_addname_dataframe.to_excel(daily_201610_excel_writer,'10_1',index=False)
daily_201610_excel_writer.save()
daily_20161011 = pro.daily(start_date='',end_date='',trade_date='20161011', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20161011_tscode_list = list() 
for ts_code_sh in daily_20161011['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20161011_tscode_list.append(stock_name)
daily_20161011_addname_dataframe=pd.DataFrame()
daily_20161011_addname_dataframe['cname'] = daily_20161011_tscode_list
for table_name in daily_20161011.columns.values.tolist():
    daily_20161011_addname_dataframe[table_name] = daily_20161011[table_name]
print("日线行情-时间为序  daily_20161011 返回数据 row 行数 = "+str(daily_20161011.shape[0]))
daily_20161011_addname_dataframe.to_excel(daily_201610_excel_writer,'11_2',index=False)
daily_201610_excel_writer.save()
daily_20161012 = pro.daily(start_date='',end_date='',trade_date='20161012', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20161012_tscode_list = list() 
for ts_code_sh in daily_20161012['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20161012_tscode_list.append(stock_name)
daily_20161012_addname_dataframe=pd.DataFrame()
daily_20161012_addname_dataframe['cname'] = daily_20161012_tscode_list
for table_name in daily_20161012.columns.values.tolist():
    daily_20161012_addname_dataframe[table_name] = daily_20161012[table_name]
print("日线行情-时间为序  daily_20161012 返回数据 row 行数 = "+str(daily_20161012.shape[0]))
daily_20161012_addname_dataframe.to_excel(daily_201610_excel_writer,'12_3',index=False)
daily_201610_excel_writer.save()
daily_20161013 = pro.daily(start_date='',end_date='',trade_date='20161013', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20161013_tscode_list = list() 
for ts_code_sh in daily_20161013['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20161013_tscode_list.append(stock_name)
daily_20161013_addname_dataframe=pd.DataFrame()
daily_20161013_addname_dataframe['cname'] = daily_20161013_tscode_list
for table_name in daily_20161013.columns.values.tolist():
    daily_20161013_addname_dataframe[table_name] = daily_20161013[table_name]
print("日线行情-时间为序  daily_20161013 返回数据 row 行数 = "+str(daily_20161013.shape[0]))
daily_20161013_addname_dataframe.to_excel(daily_201610_excel_writer,'13_4',index=False)
daily_201610_excel_writer.save()
daily_20161014 = pro.daily(start_date='',end_date='',trade_date='20161014', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20161014_tscode_list = list() 
for ts_code_sh in daily_20161014['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20161014_tscode_list.append(stock_name)
daily_20161014_addname_dataframe=pd.DataFrame()
daily_20161014_addname_dataframe['cname'] = daily_20161014_tscode_list
for table_name in daily_20161014.columns.values.tolist():
    daily_20161014_addname_dataframe[table_name] = daily_20161014[table_name]
print("日线行情-时间为序  daily_20161014 返回数据 row 行数 = "+str(daily_20161014.shape[0]))
daily_20161014_addname_dataframe.to_excel(daily_201610_excel_writer,'14_5',index=False)
daily_201610_excel_writer.save()
daily_20161017 = pro.daily(start_date='',end_date='',trade_date='20161017', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20161017_tscode_list = list() 
for ts_code_sh in daily_20161017['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20161017_tscode_list.append(stock_name)
daily_20161017_addname_dataframe=pd.DataFrame()
daily_20161017_addname_dataframe['cname'] = daily_20161017_tscode_list
for table_name in daily_20161017.columns.values.tolist():
    daily_20161017_addname_dataframe[table_name] = daily_20161017[table_name]
print("日线行情-时间为序  daily_20161017 返回数据 row 行数 = "+str(daily_20161017.shape[0]))
daily_20161017_addname_dataframe.to_excel(daily_201610_excel_writer,'17_1',index=False)
daily_201610_excel_writer.save()
daily_20161018 = pro.daily(start_date='',end_date='',trade_date='20161018', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20161018_tscode_list = list() 
for ts_code_sh in daily_20161018['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20161018_tscode_list.append(stock_name)
daily_20161018_addname_dataframe=pd.DataFrame()
daily_20161018_addname_dataframe['cname'] = daily_20161018_tscode_list
for table_name in daily_20161018.columns.values.tolist():
    daily_20161018_addname_dataframe[table_name] = daily_20161018[table_name]
print("日线行情-时间为序  daily_20161018 返回数据 row 行数 = "+str(daily_20161018.shape[0]))
daily_20161018_addname_dataframe.to_excel(daily_201610_excel_writer,'18_2',index=False)
daily_201610_excel_writer.save()
daily_20161019 = pro.daily(start_date='',end_date='',trade_date='20161019', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20161019_tscode_list = list() 
for ts_code_sh in daily_20161019['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20161019_tscode_list.append(stock_name)
daily_20161019_addname_dataframe=pd.DataFrame()
daily_20161019_addname_dataframe['cname'] = daily_20161019_tscode_list
for table_name in daily_20161019.columns.values.tolist():
    daily_20161019_addname_dataframe[table_name] = daily_20161019[table_name]
print("日线行情-时间为序  daily_20161019 返回数据 row 行数 = "+str(daily_20161019.shape[0]))
daily_20161019_addname_dataframe.to_excel(daily_201610_excel_writer,'19_3',index=False)
daily_201610_excel_writer.save()
daily_20161020 = pro.daily(start_date='',end_date='',trade_date='20161020', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20161020_tscode_list = list() 
for ts_code_sh in daily_20161020['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20161020_tscode_list.append(stock_name)
daily_20161020_addname_dataframe=pd.DataFrame()
daily_20161020_addname_dataframe['cname'] = daily_20161020_tscode_list
for table_name in daily_20161020.columns.values.tolist():
    daily_20161020_addname_dataframe[table_name] = daily_20161020[table_name]
print("日线行情-时间为序  daily_20161020 返回数据 row 行数 = "+str(daily_20161020.shape[0]))
daily_20161020_addname_dataframe.to_excel(daily_201610_excel_writer,'20_4',index=False)
daily_201610_excel_writer.save()
daily_20161021 = pro.daily(start_date='',end_date='',trade_date='20161021', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20161021_tscode_list = list() 
for ts_code_sh in daily_20161021['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20161021_tscode_list.append(stock_name)
daily_20161021_addname_dataframe=pd.DataFrame()
daily_20161021_addname_dataframe['cname'] = daily_20161021_tscode_list
for table_name in daily_20161021.columns.values.tolist():
    daily_20161021_addname_dataframe[table_name] = daily_20161021[table_name]
print("日线行情-时间为序  daily_20161021 返回数据 row 行数 = "+str(daily_20161021.shape[0]))
daily_20161021_addname_dataframe.to_excel(daily_201610_excel_writer,'21_5',index=False)
daily_201610_excel_writer.save()
daily_20161024 = pro.daily(start_date='',end_date='',trade_date='20161024', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20161024_tscode_list = list() 
for ts_code_sh in daily_20161024['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20161024_tscode_list.append(stock_name)
daily_20161024_addname_dataframe=pd.DataFrame()
daily_20161024_addname_dataframe['cname'] = daily_20161024_tscode_list
for table_name in daily_20161024.columns.values.tolist():
    daily_20161024_addname_dataframe[table_name] = daily_20161024[table_name]
print("日线行情-时间为序  daily_20161024 返回数据 row 行数 = "+str(daily_20161024.shape[0]))
daily_20161024_addname_dataframe.to_excel(daily_201610_excel_writer,'24_1',index=False)
daily_201610_excel_writer.save()
daily_20161025 = pro.daily(start_date='',end_date='',trade_date='20161025', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20161025_tscode_list = list() 
for ts_code_sh in daily_20161025['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20161025_tscode_list.append(stock_name)
daily_20161025_addname_dataframe=pd.DataFrame()
daily_20161025_addname_dataframe['cname'] = daily_20161025_tscode_list
for table_name in daily_20161025.columns.values.tolist():
    daily_20161025_addname_dataframe[table_name] = daily_20161025[table_name]
print("日线行情-时间为序  daily_20161025 返回数据 row 行数 = "+str(daily_20161025.shape[0]))
daily_20161025_addname_dataframe.to_excel(daily_201610_excel_writer,'25_2',index=False)
daily_201610_excel_writer.save()
daily_20161026 = pro.daily(start_date='',end_date='',trade_date='20161026', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20161026_tscode_list = list() 
for ts_code_sh in daily_20161026['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20161026_tscode_list.append(stock_name)
daily_20161026_addname_dataframe=pd.DataFrame()
daily_20161026_addname_dataframe['cname'] = daily_20161026_tscode_list
for table_name in daily_20161026.columns.values.tolist():
    daily_20161026_addname_dataframe[table_name] = daily_20161026[table_name]
print("日线行情-时间为序  daily_20161026 返回数据 row 行数 = "+str(daily_20161026.shape[0]))
daily_20161026_addname_dataframe.to_excel(daily_201610_excel_writer,'26_3',index=False)
daily_201610_excel_writer.save()
daily_20161027 = pro.daily(start_date='',end_date='',trade_date='20161027', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20161027_tscode_list = list() 
for ts_code_sh in daily_20161027['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20161027_tscode_list.append(stock_name)
daily_20161027_addname_dataframe=pd.DataFrame()
daily_20161027_addname_dataframe['cname'] = daily_20161027_tscode_list
for table_name in daily_20161027.columns.values.tolist():
    daily_20161027_addname_dataframe[table_name] = daily_20161027[table_name]
print("日线行情-时间为序  daily_20161027 返回数据 row 行数 = "+str(daily_20161027.shape[0]))
daily_20161027_addname_dataframe.to_excel(daily_201610_excel_writer,'27_4',index=False)
daily_201610_excel_writer.save()
daily_20161028 = pro.daily(start_date='',end_date='',trade_date='20161028', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20161028_tscode_list = list() 
for ts_code_sh in daily_20161028['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20161028_tscode_list.append(stock_name)
daily_20161028_addname_dataframe=pd.DataFrame()
daily_20161028_addname_dataframe['cname'] = daily_20161028_tscode_list
for table_name in daily_20161028.columns.values.tolist():
    daily_20161028_addname_dataframe[table_name] = daily_20161028[table_name]
print("日线行情-时间为序  daily_20161028 返回数据 row 行数 = "+str(daily_20161028.shape[0]))
daily_20161028_addname_dataframe.to_excel(daily_201610_excel_writer,'28_5',index=False)
daily_201610_excel_writer.save()
daily_20161031 = pro.daily(start_date='',end_date='',trade_date='20161031', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20161031_tscode_list = list() 
for ts_code_sh in daily_20161031['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20161031_tscode_list.append(stock_name)
daily_20161031_addname_dataframe=pd.DataFrame()
daily_20161031_addname_dataframe['cname'] = daily_20161031_tscode_list
for table_name in daily_20161031.columns.values.tolist():
    daily_20161031_addname_dataframe[table_name] = daily_20161031[table_name]
print("日线行情-时间为序  daily_20161031 返回数据 row 行数 = "+str(daily_20161031.shape[0]))
daily_20161031_addname_dataframe.to_excel(daily_201610_excel_writer,'31_1',index=False)
daily_201610_excel_writer.save()




createexcel('daily_201611.xlsx')
daily_201611_book = load_workbook('C:\\Users\\zhuzj5\\Desktop\\zbin\\J0_Data\\daily_201611.xlsx')
daily_201611_excel_writer = pd.ExcelWriter('C:\\Users\\zhuzj5\\Desktop\\zbin\\J0_Data\\daily_201611.xlsx', engine='openpyxl')
daily_201611_excel_writer.book = daily_201611_book
daily_201611_excel_writer.sheets = dict((ws.title, ws) for ws in daily_201611_book.worksheets)
J0_PROPS.put(tree_node_name+"record_date", "20161101")       ###  更新 记录日期
daily_20161101 = pro.daily(start_date='',end_date='',trade_date='20161101', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20161101_tscode_list = list() 
for ts_code_sh in daily_20161101['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20161101_tscode_list.append(stock_name)
daily_20161101_addname_dataframe=pd.DataFrame()
daily_20161101_addname_dataframe['cname'] = daily_20161101_tscode_list
for table_name in daily_20161101.columns.values.tolist():
    daily_20161101_addname_dataframe[table_name] = daily_20161101[table_name]
print("日线行情-时间为序  daily_20161101 返回数据 row 行数 = "+str(daily_20161101.shape[0]))
daily_20161101_addname_dataframe.to_excel(daily_201611_excel_writer,'1_2',index=False)
daily_201611_excel_writer.save()
daily_20161102 = pro.daily(start_date='',end_date='',trade_date='20161102', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20161102_tscode_list = list() 
for ts_code_sh in daily_20161102['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20161102_tscode_list.append(stock_name)
daily_20161102_addname_dataframe=pd.DataFrame()
daily_20161102_addname_dataframe['cname'] = daily_20161102_tscode_list
for table_name in daily_20161102.columns.values.tolist():
    daily_20161102_addname_dataframe[table_name] = daily_20161102[table_name]
print("日线行情-时间为序  daily_20161102 返回数据 row 行数 = "+str(daily_20161102.shape[0]))
daily_20161102_addname_dataframe.to_excel(daily_201611_excel_writer,'2_3',index=False)
daily_201611_excel_writer.save()
daily_20161103 = pro.daily(start_date='',end_date='',trade_date='20161103', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20161103_tscode_list = list() 
for ts_code_sh in daily_20161103['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20161103_tscode_list.append(stock_name)
daily_20161103_addname_dataframe=pd.DataFrame()
daily_20161103_addname_dataframe['cname'] = daily_20161103_tscode_list
for table_name in daily_20161103.columns.values.tolist():
    daily_20161103_addname_dataframe[table_name] = daily_20161103[table_name]
print("日线行情-时间为序  daily_20161103 返回数据 row 行数 = "+str(daily_20161103.shape[0]))
daily_20161103_addname_dataframe.to_excel(daily_201611_excel_writer,'3_4',index=False)
daily_201611_excel_writer.save()
daily_20161104 = pro.daily(start_date='',end_date='',trade_date='20161104', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20161104_tscode_list = list() 
for ts_code_sh in daily_20161104['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20161104_tscode_list.append(stock_name)
daily_20161104_addname_dataframe=pd.DataFrame()
daily_20161104_addname_dataframe['cname'] = daily_20161104_tscode_list
for table_name in daily_20161104.columns.values.tolist():
    daily_20161104_addname_dataframe[table_name] = daily_20161104[table_name]
print("日线行情-时间为序  daily_20161104 返回数据 row 行数 = "+str(daily_20161104.shape[0]))
daily_20161104_addname_dataframe.to_excel(daily_201611_excel_writer,'4_5',index=False)
daily_201611_excel_writer.save()
daily_20161107 = pro.daily(start_date='',end_date='',trade_date='20161107', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20161107_tscode_list = list() 
for ts_code_sh in daily_20161107['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20161107_tscode_list.append(stock_name)
daily_20161107_addname_dataframe=pd.DataFrame()
daily_20161107_addname_dataframe['cname'] = daily_20161107_tscode_list
for table_name in daily_20161107.columns.values.tolist():
    daily_20161107_addname_dataframe[table_name] = daily_20161107[table_name]
print("日线行情-时间为序  daily_20161107 返回数据 row 行数 = "+str(daily_20161107.shape[0]))
daily_20161107_addname_dataframe.to_excel(daily_201611_excel_writer,'7_1',index=False)
daily_201611_excel_writer.save()
daily_20161108 = pro.daily(start_date='',end_date='',trade_date='20161108', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20161108_tscode_list = list() 
for ts_code_sh in daily_20161108['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20161108_tscode_list.append(stock_name)
daily_20161108_addname_dataframe=pd.DataFrame()
daily_20161108_addname_dataframe['cname'] = daily_20161108_tscode_list
for table_name in daily_20161108.columns.values.tolist():
    daily_20161108_addname_dataframe[table_name] = daily_20161108[table_name]
print("日线行情-时间为序  daily_20161108 返回数据 row 行数 = "+str(daily_20161108.shape[0]))
daily_20161108_addname_dataframe.to_excel(daily_201611_excel_writer,'8_2',index=False)
daily_201611_excel_writer.save()
daily_20161109 = pro.daily(start_date='',end_date='',trade_date='20161109', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20161109_tscode_list = list() 
for ts_code_sh in daily_20161109['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20161109_tscode_list.append(stock_name)
daily_20161109_addname_dataframe=pd.DataFrame()
daily_20161109_addname_dataframe['cname'] = daily_20161109_tscode_list
for table_name in daily_20161109.columns.values.tolist():
    daily_20161109_addname_dataframe[table_name] = daily_20161109[table_name]
print("日线行情-时间为序  daily_20161109 返回数据 row 行数 = "+str(daily_20161109.shape[0]))
daily_20161109_addname_dataframe.to_excel(daily_201611_excel_writer,'9_3',index=False)
daily_201611_excel_writer.save()
daily_20161110 = pro.daily(start_date='',end_date='',trade_date='20161110', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20161110_tscode_list = list() 
for ts_code_sh in daily_20161110['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20161110_tscode_list.append(stock_name)
daily_20161110_addname_dataframe=pd.DataFrame()
daily_20161110_addname_dataframe['cname'] = daily_20161110_tscode_list
for table_name in daily_20161110.columns.values.tolist():
    daily_20161110_addname_dataframe[table_name] = daily_20161110[table_name]
print("日线行情-时间为序  daily_20161110 返回数据 row 行数 = "+str(daily_20161110.shape[0]))
daily_20161110_addname_dataframe.to_excel(daily_201611_excel_writer,'10_4',index=False)
daily_201611_excel_writer.save()
daily_20161111 = pro.daily(start_date='',end_date='',trade_date='20161111', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20161111_tscode_list = list() 
for ts_code_sh in daily_20161111['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20161111_tscode_list.append(stock_name)
daily_20161111_addname_dataframe=pd.DataFrame()
daily_20161111_addname_dataframe['cname'] = daily_20161111_tscode_list
for table_name in daily_20161111.columns.values.tolist():
    daily_20161111_addname_dataframe[table_name] = daily_20161111[table_name]
print("日线行情-时间为序  daily_20161111 返回数据 row 行数 = "+str(daily_20161111.shape[0]))
daily_20161111_addname_dataframe.to_excel(daily_201611_excel_writer,'11_5',index=False)
daily_201611_excel_writer.save()
daily_20161114 = pro.daily(start_date='',end_date='',trade_date='20161114', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20161114_tscode_list = list() 
for ts_code_sh in daily_20161114['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20161114_tscode_list.append(stock_name)
daily_20161114_addname_dataframe=pd.DataFrame()
daily_20161114_addname_dataframe['cname'] = daily_20161114_tscode_list
for table_name in daily_20161114.columns.values.tolist():
    daily_20161114_addname_dataframe[table_name] = daily_20161114[table_name]
print("日线行情-时间为序  daily_20161114 返回数据 row 行数 = "+str(daily_20161114.shape[0]))
daily_20161114_addname_dataframe.to_excel(daily_201611_excel_writer,'14_1',index=False)
daily_201611_excel_writer.save()
daily_20161115 = pro.daily(start_date='',end_date='',trade_date='20161115', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20161115_tscode_list = list() 
for ts_code_sh in daily_20161115['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20161115_tscode_list.append(stock_name)
daily_20161115_addname_dataframe=pd.DataFrame()
daily_20161115_addname_dataframe['cname'] = daily_20161115_tscode_list
for table_name in daily_20161115.columns.values.tolist():
    daily_20161115_addname_dataframe[table_name] = daily_20161115[table_name]
print("日线行情-时间为序  daily_20161115 返回数据 row 行数 = "+str(daily_20161115.shape[0]))
daily_20161115_addname_dataframe.to_excel(daily_201611_excel_writer,'15_2',index=False)
daily_201611_excel_writer.save()
daily_20161116 = pro.daily(start_date='',end_date='',trade_date='20161116', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20161116_tscode_list = list() 
for ts_code_sh in daily_20161116['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20161116_tscode_list.append(stock_name)
daily_20161116_addname_dataframe=pd.DataFrame()
daily_20161116_addname_dataframe['cname'] = daily_20161116_tscode_list
for table_name in daily_20161116.columns.values.tolist():
    daily_20161116_addname_dataframe[table_name] = daily_20161116[table_name]
print("日线行情-时间为序  daily_20161116 返回数据 row 行数 = "+str(daily_20161116.shape[0]))
daily_20161116_addname_dataframe.to_excel(daily_201611_excel_writer,'16_3',index=False)
daily_201611_excel_writer.save()
daily_20161117 = pro.daily(start_date='',end_date='',trade_date='20161117', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20161117_tscode_list = list() 
for ts_code_sh in daily_20161117['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20161117_tscode_list.append(stock_name)
daily_20161117_addname_dataframe=pd.DataFrame()
daily_20161117_addname_dataframe['cname'] = daily_20161117_tscode_list
for table_name in daily_20161117.columns.values.tolist():
    daily_20161117_addname_dataframe[table_name] = daily_20161117[table_name]
print("日线行情-时间为序  daily_20161117 返回数据 row 行数 = "+str(daily_20161117.shape[0]))
daily_20161117_addname_dataframe.to_excel(daily_201611_excel_writer,'17_4',index=False)
daily_201611_excel_writer.save()
daily_20161118 = pro.daily(start_date='',end_date='',trade_date='20161118', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20161118_tscode_list = list() 
for ts_code_sh in daily_20161118['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20161118_tscode_list.append(stock_name)
daily_20161118_addname_dataframe=pd.DataFrame()
daily_20161118_addname_dataframe['cname'] = daily_20161118_tscode_list
for table_name in daily_20161118.columns.values.tolist():
    daily_20161118_addname_dataframe[table_name] = daily_20161118[table_name]
print("日线行情-时间为序  daily_20161118 返回数据 row 行数 = "+str(daily_20161118.shape[0]))
daily_20161118_addname_dataframe.to_excel(daily_201611_excel_writer,'18_5',index=False)
daily_201611_excel_writer.save()
daily_20161121 = pro.daily(start_date='',end_date='',trade_date='20161121', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20161121_tscode_list = list() 
for ts_code_sh in daily_20161121['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20161121_tscode_list.append(stock_name)
daily_20161121_addname_dataframe=pd.DataFrame()
daily_20161121_addname_dataframe['cname'] = daily_20161121_tscode_list
for table_name in daily_20161121.columns.values.tolist():
    daily_20161121_addname_dataframe[table_name] = daily_20161121[table_name]
print("日线行情-时间为序  daily_20161121 返回数据 row 行数 = "+str(daily_20161121.shape[0]))
daily_20161121_addname_dataframe.to_excel(daily_201611_excel_writer,'21_1',index=False)
daily_201611_excel_writer.save()
daily_20161122 = pro.daily(start_date='',end_date='',trade_date='20161122', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20161122_tscode_list = list() 
for ts_code_sh in daily_20161122['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20161122_tscode_list.append(stock_name)
daily_20161122_addname_dataframe=pd.DataFrame()
daily_20161122_addname_dataframe['cname'] = daily_20161122_tscode_list
for table_name in daily_20161122.columns.values.tolist():
    daily_20161122_addname_dataframe[table_name] = daily_20161122[table_name]
print("日线行情-时间为序  daily_20161122 返回数据 row 行数 = "+str(daily_20161122.shape[0]))
daily_20161122_addname_dataframe.to_excel(daily_201611_excel_writer,'22_2',index=False)
daily_201611_excel_writer.save()
daily_20161123 = pro.daily(start_date='',end_date='',trade_date='20161123', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20161123_tscode_list = list() 
for ts_code_sh in daily_20161123['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20161123_tscode_list.append(stock_name)
daily_20161123_addname_dataframe=pd.DataFrame()
daily_20161123_addname_dataframe['cname'] = daily_20161123_tscode_list
for table_name in daily_20161123.columns.values.tolist():
    daily_20161123_addname_dataframe[table_name] = daily_20161123[table_name]
print("日线行情-时间为序  daily_20161123 返回数据 row 行数 = "+str(daily_20161123.shape[0]))
daily_20161123_addname_dataframe.to_excel(daily_201611_excel_writer,'23_3',index=False)
daily_201611_excel_writer.save()
daily_20161124 = pro.daily(start_date='',end_date='',trade_date='20161124', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20161124_tscode_list = list() 
for ts_code_sh in daily_20161124['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20161124_tscode_list.append(stock_name)
daily_20161124_addname_dataframe=pd.DataFrame()
daily_20161124_addname_dataframe['cname'] = daily_20161124_tscode_list
for table_name in daily_20161124.columns.values.tolist():
    daily_20161124_addname_dataframe[table_name] = daily_20161124[table_name]
print("日线行情-时间为序  daily_20161124 返回数据 row 行数 = "+str(daily_20161124.shape[0]))
daily_20161124_addname_dataframe.to_excel(daily_201611_excel_writer,'24_4',index=False)
daily_201611_excel_writer.save()
daily_20161125 = pro.daily(start_date='',end_date='',trade_date='20161125', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20161125_tscode_list = list() 
for ts_code_sh in daily_20161125['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20161125_tscode_list.append(stock_name)
daily_20161125_addname_dataframe=pd.DataFrame()
daily_20161125_addname_dataframe['cname'] = daily_20161125_tscode_list
for table_name in daily_20161125.columns.values.tolist():
    daily_20161125_addname_dataframe[table_name] = daily_20161125[table_name]
print("日线行情-时间为序  daily_20161125 返回数据 row 行数 = "+str(daily_20161125.shape[0]))
daily_20161125_addname_dataframe.to_excel(daily_201611_excel_writer,'25_5',index=False)
daily_201611_excel_writer.save()
daily_20161128 = pro.daily(start_date='',end_date='',trade_date='20161128', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20161128_tscode_list = list() 
for ts_code_sh in daily_20161128['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20161128_tscode_list.append(stock_name)
daily_20161128_addname_dataframe=pd.DataFrame()
daily_20161128_addname_dataframe['cname'] = daily_20161128_tscode_list
for table_name in daily_20161128.columns.values.tolist():
    daily_20161128_addname_dataframe[table_name] = daily_20161128[table_name]
print("日线行情-时间为序  daily_20161128 返回数据 row 行数 = "+str(daily_20161128.shape[0]))
daily_20161128_addname_dataframe.to_excel(daily_201611_excel_writer,'28_1',index=False)
daily_201611_excel_writer.save()
daily_20161129 = pro.daily(start_date='',end_date='',trade_date='20161129', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20161129_tscode_list = list() 
for ts_code_sh in daily_20161129['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20161129_tscode_list.append(stock_name)
daily_20161129_addname_dataframe=pd.DataFrame()
daily_20161129_addname_dataframe['cname'] = daily_20161129_tscode_list
for table_name in daily_20161129.columns.values.tolist():
    daily_20161129_addname_dataframe[table_name] = daily_20161129[table_name]
print("日线行情-时间为序  daily_20161129 返回数据 row 行数 = "+str(daily_20161129.shape[0]))
daily_20161129_addname_dataframe.to_excel(daily_201611_excel_writer,'29_2',index=False)
daily_201611_excel_writer.save()
daily_20161130 = pro.daily(start_date='',end_date='',trade_date='20161130', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20161130_tscode_list = list() 
for ts_code_sh in daily_20161130['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20161130_tscode_list.append(stock_name)
daily_20161130_addname_dataframe=pd.DataFrame()
daily_20161130_addname_dataframe['cname'] = daily_20161130_tscode_list
for table_name in daily_20161130.columns.values.tolist():
    daily_20161130_addname_dataframe[table_name] = daily_20161130[table_name]
print("日线行情-时间为序  daily_20161130 返回数据 row 行数 = "+str(daily_20161130.shape[0]))
daily_20161130_addname_dataframe.to_excel(daily_201611_excel_writer,'30_3',index=False)
daily_201611_excel_writer.save()




createexcel('daily_201612.xlsx')
daily_201612_book = load_workbook('C:\\Users\\zhuzj5\\Desktop\\zbin\\J0_Data\\daily_201612.xlsx')
daily_201612_excel_writer = pd.ExcelWriter('C:\\Users\\zhuzj5\\Desktop\\zbin\\J0_Data\\daily_201612.xlsx', engine='openpyxl')
daily_201612_excel_writer.book = daily_201612_book
daily_201612_excel_writer.sheets = dict((ws.title, ws) for ws in daily_201612_book.worksheets)
J0_PROPS.put(tree_node_name+"record_date", "20161201")       ###  更新 记录日期
daily_20161201 = pro.daily(start_date='',end_date='',trade_date='20161201', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20161201_tscode_list = list() 
for ts_code_sh in daily_20161201['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20161201_tscode_list.append(stock_name)
daily_20161201_addname_dataframe=pd.DataFrame()
daily_20161201_addname_dataframe['cname'] = daily_20161201_tscode_list
for table_name in daily_20161201.columns.values.tolist():
    daily_20161201_addname_dataframe[table_name] = daily_20161201[table_name]
print("日线行情-时间为序  daily_20161201 返回数据 row 行数 = "+str(daily_20161201.shape[0]))
daily_20161201_addname_dataframe.to_excel(daily_201612_excel_writer,'1_4',index=False)
daily_201612_excel_writer.save()
daily_20161202 = pro.daily(start_date='',end_date='',trade_date='20161202', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20161202_tscode_list = list() 
for ts_code_sh in daily_20161202['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20161202_tscode_list.append(stock_name)
daily_20161202_addname_dataframe=pd.DataFrame()
daily_20161202_addname_dataframe['cname'] = daily_20161202_tscode_list
for table_name in daily_20161202.columns.values.tolist():
    daily_20161202_addname_dataframe[table_name] = daily_20161202[table_name]
print("日线行情-时间为序  daily_20161202 返回数据 row 行数 = "+str(daily_20161202.shape[0]))
daily_20161202_addname_dataframe.to_excel(daily_201612_excel_writer,'2_5',index=False)
daily_201612_excel_writer.save()
daily_20161205 = pro.daily(start_date='',end_date='',trade_date='20161205', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20161205_tscode_list = list() 
for ts_code_sh in daily_20161205['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20161205_tscode_list.append(stock_name)
daily_20161205_addname_dataframe=pd.DataFrame()
daily_20161205_addname_dataframe['cname'] = daily_20161205_tscode_list
for table_name in daily_20161205.columns.values.tolist():
    daily_20161205_addname_dataframe[table_name] = daily_20161205[table_name]
print("日线行情-时间为序  daily_20161205 返回数据 row 行数 = "+str(daily_20161205.shape[0]))
daily_20161205_addname_dataframe.to_excel(daily_201612_excel_writer,'5_1',index=False)
daily_201612_excel_writer.save()
daily_20161206 = pro.daily(start_date='',end_date='',trade_date='20161206', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20161206_tscode_list = list() 
for ts_code_sh in daily_20161206['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20161206_tscode_list.append(stock_name)
daily_20161206_addname_dataframe=pd.DataFrame()
daily_20161206_addname_dataframe['cname'] = daily_20161206_tscode_list
for table_name in daily_20161206.columns.values.tolist():
    daily_20161206_addname_dataframe[table_name] = daily_20161206[table_name]
print("日线行情-时间为序  daily_20161206 返回数据 row 行数 = "+str(daily_20161206.shape[0]))
daily_20161206_addname_dataframe.to_excel(daily_201612_excel_writer,'6_2',index=False)
daily_201612_excel_writer.save()
daily_20161207 = pro.daily(start_date='',end_date='',trade_date='20161207', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20161207_tscode_list = list() 
for ts_code_sh in daily_20161207['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20161207_tscode_list.append(stock_name)
daily_20161207_addname_dataframe=pd.DataFrame()
daily_20161207_addname_dataframe['cname'] = daily_20161207_tscode_list
for table_name in daily_20161207.columns.values.tolist():
    daily_20161207_addname_dataframe[table_name] = daily_20161207[table_name]
print("日线行情-时间为序  daily_20161207 返回数据 row 行数 = "+str(daily_20161207.shape[0]))
daily_20161207_addname_dataframe.to_excel(daily_201612_excel_writer,'7_3',index=False)
daily_201612_excel_writer.save()
daily_20161208 = pro.daily(start_date='',end_date='',trade_date='20161208', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20161208_tscode_list = list() 
for ts_code_sh in daily_20161208['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20161208_tscode_list.append(stock_name)
daily_20161208_addname_dataframe=pd.DataFrame()
daily_20161208_addname_dataframe['cname'] = daily_20161208_tscode_list
for table_name in daily_20161208.columns.values.tolist():
    daily_20161208_addname_dataframe[table_name] = daily_20161208[table_name]
print("日线行情-时间为序  daily_20161208 返回数据 row 行数 = "+str(daily_20161208.shape[0]))
daily_20161208_addname_dataframe.to_excel(daily_201612_excel_writer,'8_4',index=False)
daily_201612_excel_writer.save()
daily_20161209 = pro.daily(start_date='',end_date='',trade_date='20161209', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20161209_tscode_list = list() 
for ts_code_sh in daily_20161209['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20161209_tscode_list.append(stock_name)
daily_20161209_addname_dataframe=pd.DataFrame()
daily_20161209_addname_dataframe['cname'] = daily_20161209_tscode_list
for table_name in daily_20161209.columns.values.tolist():
    daily_20161209_addname_dataframe[table_name] = daily_20161209[table_name]
print("日线行情-时间为序  daily_20161209 返回数据 row 行数 = "+str(daily_20161209.shape[0]))
daily_20161209_addname_dataframe.to_excel(daily_201612_excel_writer,'9_5',index=False)
daily_201612_excel_writer.save()
daily_20161212 = pro.daily(start_date='',end_date='',trade_date='20161212', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20161212_tscode_list = list() 
for ts_code_sh in daily_20161212['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20161212_tscode_list.append(stock_name)
daily_20161212_addname_dataframe=pd.DataFrame()
daily_20161212_addname_dataframe['cname'] = daily_20161212_tscode_list
for table_name in daily_20161212.columns.values.tolist():
    daily_20161212_addname_dataframe[table_name] = daily_20161212[table_name]
print("日线行情-时间为序  daily_20161212 返回数据 row 行数 = "+str(daily_20161212.shape[0]))
daily_20161212_addname_dataframe.to_excel(daily_201612_excel_writer,'12_1',index=False)
daily_201612_excel_writer.save()
daily_20161213 = pro.daily(start_date='',end_date='',trade_date='20161213', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20161213_tscode_list = list() 
for ts_code_sh in daily_20161213['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20161213_tscode_list.append(stock_name)
daily_20161213_addname_dataframe=pd.DataFrame()
daily_20161213_addname_dataframe['cname'] = daily_20161213_tscode_list
for table_name in daily_20161213.columns.values.tolist():
    daily_20161213_addname_dataframe[table_name] = daily_20161213[table_name]
print("日线行情-时间为序  daily_20161213 返回数据 row 行数 = "+str(daily_20161213.shape[0]))
daily_20161213_addname_dataframe.to_excel(daily_201612_excel_writer,'13_2',index=False)
daily_201612_excel_writer.save()
daily_20161214 = pro.daily(start_date='',end_date='',trade_date='20161214', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20161214_tscode_list = list() 
for ts_code_sh in daily_20161214['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20161214_tscode_list.append(stock_name)
daily_20161214_addname_dataframe=pd.DataFrame()
daily_20161214_addname_dataframe['cname'] = daily_20161214_tscode_list
for table_name in daily_20161214.columns.values.tolist():
    daily_20161214_addname_dataframe[table_name] = daily_20161214[table_name]
print("日线行情-时间为序  daily_20161214 返回数据 row 行数 = "+str(daily_20161214.shape[0]))
daily_20161214_addname_dataframe.to_excel(daily_201612_excel_writer,'14_3',index=False)
daily_201612_excel_writer.save()
daily_20161215 = pro.daily(start_date='',end_date='',trade_date='20161215', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20161215_tscode_list = list() 
for ts_code_sh in daily_20161215['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20161215_tscode_list.append(stock_name)
daily_20161215_addname_dataframe=pd.DataFrame()
daily_20161215_addname_dataframe['cname'] = daily_20161215_tscode_list
for table_name in daily_20161215.columns.values.tolist():
    daily_20161215_addname_dataframe[table_name] = daily_20161215[table_name]
print("日线行情-时间为序  daily_20161215 返回数据 row 行数 = "+str(daily_20161215.shape[0]))
daily_20161215_addname_dataframe.to_excel(daily_201612_excel_writer,'15_4',index=False)
daily_201612_excel_writer.save()
daily_20161216 = pro.daily(start_date='',end_date='',trade_date='20161216', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20161216_tscode_list = list() 
for ts_code_sh in daily_20161216['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20161216_tscode_list.append(stock_name)
daily_20161216_addname_dataframe=pd.DataFrame()
daily_20161216_addname_dataframe['cname'] = daily_20161216_tscode_list
for table_name in daily_20161216.columns.values.tolist():
    daily_20161216_addname_dataframe[table_name] = daily_20161216[table_name]
print("日线行情-时间为序  daily_20161216 返回数据 row 行数 = "+str(daily_20161216.shape[0]))
daily_20161216_addname_dataframe.to_excel(daily_201612_excel_writer,'16_5',index=False)
daily_201612_excel_writer.save()
daily_20161219 = pro.daily(start_date='',end_date='',trade_date='20161219', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20161219_tscode_list = list() 
for ts_code_sh in daily_20161219['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20161219_tscode_list.append(stock_name)
daily_20161219_addname_dataframe=pd.DataFrame()
daily_20161219_addname_dataframe['cname'] = daily_20161219_tscode_list
for table_name in daily_20161219.columns.values.tolist():
    daily_20161219_addname_dataframe[table_name] = daily_20161219[table_name]
print("日线行情-时间为序  daily_20161219 返回数据 row 行数 = "+str(daily_20161219.shape[0]))
daily_20161219_addname_dataframe.to_excel(daily_201612_excel_writer,'19_1',index=False)
daily_201612_excel_writer.save()
daily_20161220 = pro.daily(start_date='',end_date='',trade_date='20161220', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20161220_tscode_list = list() 
for ts_code_sh in daily_20161220['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20161220_tscode_list.append(stock_name)
daily_20161220_addname_dataframe=pd.DataFrame()
daily_20161220_addname_dataframe['cname'] = daily_20161220_tscode_list
for table_name in daily_20161220.columns.values.tolist():
    daily_20161220_addname_dataframe[table_name] = daily_20161220[table_name]
print("日线行情-时间为序  daily_20161220 返回数据 row 行数 = "+str(daily_20161220.shape[0]))
daily_20161220_addname_dataframe.to_excel(daily_201612_excel_writer,'20_2',index=False)
daily_201612_excel_writer.save()
daily_20161221 = pro.daily(start_date='',end_date='',trade_date='20161221', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20161221_tscode_list = list() 
for ts_code_sh in daily_20161221['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20161221_tscode_list.append(stock_name)
daily_20161221_addname_dataframe=pd.DataFrame()
daily_20161221_addname_dataframe['cname'] = daily_20161221_tscode_list
for table_name in daily_20161221.columns.values.tolist():
    daily_20161221_addname_dataframe[table_name] = daily_20161221[table_name]
print("日线行情-时间为序  daily_20161221 返回数据 row 行数 = "+str(daily_20161221.shape[0]))
daily_20161221_addname_dataframe.to_excel(daily_201612_excel_writer,'21_3',index=False)
daily_201612_excel_writer.save()
daily_20161222 = pro.daily(start_date='',end_date='',trade_date='20161222', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20161222_tscode_list = list() 
for ts_code_sh in daily_20161222['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20161222_tscode_list.append(stock_name)
daily_20161222_addname_dataframe=pd.DataFrame()
daily_20161222_addname_dataframe['cname'] = daily_20161222_tscode_list
for table_name in daily_20161222.columns.values.tolist():
    daily_20161222_addname_dataframe[table_name] = daily_20161222[table_name]
print("日线行情-时间为序  daily_20161222 返回数据 row 行数 = "+str(daily_20161222.shape[0]))
daily_20161222_addname_dataframe.to_excel(daily_201612_excel_writer,'22_4',index=False)
daily_201612_excel_writer.save()
daily_20161223 = pro.daily(start_date='',end_date='',trade_date='20161223', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20161223_tscode_list = list() 
for ts_code_sh in daily_20161223['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20161223_tscode_list.append(stock_name)
daily_20161223_addname_dataframe=pd.DataFrame()
daily_20161223_addname_dataframe['cname'] = daily_20161223_tscode_list
for table_name in daily_20161223.columns.values.tolist():
    daily_20161223_addname_dataframe[table_name] = daily_20161223[table_name]
print("日线行情-时间为序  daily_20161223 返回数据 row 行数 = "+str(daily_20161223.shape[0]))
daily_20161223_addname_dataframe.to_excel(daily_201612_excel_writer,'23_5',index=False)
daily_201612_excel_writer.save()
daily_20161226 = pro.daily(start_date='',end_date='',trade_date='20161226', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20161226_tscode_list = list() 
for ts_code_sh in daily_20161226['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20161226_tscode_list.append(stock_name)
daily_20161226_addname_dataframe=pd.DataFrame()
daily_20161226_addname_dataframe['cname'] = daily_20161226_tscode_list
for table_name in daily_20161226.columns.values.tolist():
    daily_20161226_addname_dataframe[table_name] = daily_20161226[table_name]
print("日线行情-时间为序  daily_20161226 返回数据 row 行数 = "+str(daily_20161226.shape[0]))
daily_20161226_addname_dataframe.to_excel(daily_201612_excel_writer,'26_1',index=False)
daily_201612_excel_writer.save()
daily_20161227 = pro.daily(start_date='',end_date='',trade_date='20161227', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20161227_tscode_list = list() 
for ts_code_sh in daily_20161227['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20161227_tscode_list.append(stock_name)
daily_20161227_addname_dataframe=pd.DataFrame()
daily_20161227_addname_dataframe['cname'] = daily_20161227_tscode_list
for table_name in daily_20161227.columns.values.tolist():
    daily_20161227_addname_dataframe[table_name] = daily_20161227[table_name]
print("日线行情-时间为序  daily_20161227 返回数据 row 行数 = "+str(daily_20161227.shape[0]))
daily_20161227_addname_dataframe.to_excel(daily_201612_excel_writer,'27_2',index=False)
daily_201612_excel_writer.save()
daily_20161228 = pro.daily(start_date='',end_date='',trade_date='20161228', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20161228_tscode_list = list() 
for ts_code_sh in daily_20161228['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20161228_tscode_list.append(stock_name)
daily_20161228_addname_dataframe=pd.DataFrame()
daily_20161228_addname_dataframe['cname'] = daily_20161228_tscode_list
for table_name in daily_20161228.columns.values.tolist():
    daily_20161228_addname_dataframe[table_name] = daily_20161228[table_name]
print("日线行情-时间为序  daily_20161228 返回数据 row 行数 = "+str(daily_20161228.shape[0]))
daily_20161228_addname_dataframe.to_excel(daily_201612_excel_writer,'28_3',index=False)
daily_201612_excel_writer.save()
daily_20161229 = pro.daily(start_date='',end_date='',trade_date='20161229', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20161229_tscode_list = list() 
for ts_code_sh in daily_20161229['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20161229_tscode_list.append(stock_name)
daily_20161229_addname_dataframe=pd.DataFrame()
daily_20161229_addname_dataframe['cname'] = daily_20161229_tscode_list
for table_name in daily_20161229.columns.values.tolist():
    daily_20161229_addname_dataframe[table_name] = daily_20161229[table_name]
print("日线行情-时间为序  daily_20161229 返回数据 row 行数 = "+str(daily_20161229.shape[0]))
daily_20161229_addname_dataframe.to_excel(daily_201612_excel_writer,'29_4',index=False)
daily_201612_excel_writer.save()
daily_20161230 = pro.daily(start_date='',end_date='',trade_date='20161230', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20161230_tscode_list = list() 
for ts_code_sh in daily_20161230['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20161230_tscode_list.append(stock_name)
daily_20161230_addname_dataframe=pd.DataFrame()
daily_20161230_addname_dataframe['cname'] = daily_20161230_tscode_list
for table_name in daily_20161230.columns.values.tolist():
    daily_20161230_addname_dataframe[table_name] = daily_20161230[table_name]
print("日线行情-时间为序  daily_20161230 返回数据 row 行数 = "+str(daily_20161230.shape[0]))
daily_20161230_addname_dataframe.to_excel(daily_201612_excel_writer,'30_5',index=False)
daily_201612_excel_writer.save()




createexcel('daily_201701.xlsx')
daily_201701_book = load_workbook('C:\\Users\\zhuzj5\\Desktop\\zbin\\J0_Data\\daily_201701.xlsx')
daily_201701_excel_writer = pd.ExcelWriter('C:\\Users\\zhuzj5\\Desktop\\zbin\\J0_Data\\daily_201701.xlsx', engine='openpyxl')
daily_201701_excel_writer.book = daily_201701_book
daily_201701_excel_writer.sheets = dict((ws.title, ws) for ws in daily_201701_book.worksheets)
J0_PROPS.put(tree_node_name+"record_date", "20170101")       ###  更新 记录日期
daily_20170103 = pro.daily(start_date='',end_date='',trade_date='20170103', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20170103_tscode_list = list() 
for ts_code_sh in daily_20170103['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20170103_tscode_list.append(stock_name)
daily_20170103_addname_dataframe=pd.DataFrame()
daily_20170103_addname_dataframe['cname'] = daily_20170103_tscode_list
for table_name in daily_20170103.columns.values.tolist():
    daily_20170103_addname_dataframe[table_name] = daily_20170103[table_name]
print("日线行情-时间为序  daily_20170103 返回数据 row 行数 = "+str(daily_20170103.shape[0]))
daily_20170103_addname_dataframe.to_excel(daily_201701_excel_writer,'3_2',index=False)
daily_201701_excel_writer.save()
daily_20170104 = pro.daily(start_date='',end_date='',trade_date='20170104', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20170104_tscode_list = list() 
for ts_code_sh in daily_20170104['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20170104_tscode_list.append(stock_name)
daily_20170104_addname_dataframe=pd.DataFrame()
daily_20170104_addname_dataframe['cname'] = daily_20170104_tscode_list
for table_name in daily_20170104.columns.values.tolist():
    daily_20170104_addname_dataframe[table_name] = daily_20170104[table_name]
print("日线行情-时间为序  daily_20170104 返回数据 row 行数 = "+str(daily_20170104.shape[0]))
daily_20170104_addname_dataframe.to_excel(daily_201701_excel_writer,'4_3',index=False)
daily_201701_excel_writer.save()
daily_20170105 = pro.daily(start_date='',end_date='',trade_date='20170105', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20170105_tscode_list = list() 
for ts_code_sh in daily_20170105['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20170105_tscode_list.append(stock_name)
daily_20170105_addname_dataframe=pd.DataFrame()
daily_20170105_addname_dataframe['cname'] = daily_20170105_tscode_list
for table_name in daily_20170105.columns.values.tolist():
    daily_20170105_addname_dataframe[table_name] = daily_20170105[table_name]
print("日线行情-时间为序  daily_20170105 返回数据 row 行数 = "+str(daily_20170105.shape[0]))
daily_20170105_addname_dataframe.to_excel(daily_201701_excel_writer,'5_4',index=False)
daily_201701_excel_writer.save()
daily_20170106 = pro.daily(start_date='',end_date='',trade_date='20170106', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20170106_tscode_list = list() 
for ts_code_sh in daily_20170106['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20170106_tscode_list.append(stock_name)
daily_20170106_addname_dataframe=pd.DataFrame()
daily_20170106_addname_dataframe['cname'] = daily_20170106_tscode_list
for table_name in daily_20170106.columns.values.tolist():
    daily_20170106_addname_dataframe[table_name] = daily_20170106[table_name]
print("日线行情-时间为序  daily_20170106 返回数据 row 行数 = "+str(daily_20170106.shape[0]))
daily_20170106_addname_dataframe.to_excel(daily_201701_excel_writer,'6_5',index=False)
daily_201701_excel_writer.save()
daily_20170109 = pro.daily(start_date='',end_date='',trade_date='20170109', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20170109_tscode_list = list() 
for ts_code_sh in daily_20170109['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20170109_tscode_list.append(stock_name)
daily_20170109_addname_dataframe=pd.DataFrame()
daily_20170109_addname_dataframe['cname'] = daily_20170109_tscode_list
for table_name in daily_20170109.columns.values.tolist():
    daily_20170109_addname_dataframe[table_name] = daily_20170109[table_name]
print("日线行情-时间为序  daily_20170109 返回数据 row 行数 = "+str(daily_20170109.shape[0]))
daily_20170109_addname_dataframe.to_excel(daily_201701_excel_writer,'9_1',index=False)
daily_201701_excel_writer.save()
daily_20170110 = pro.daily(start_date='',end_date='',trade_date='20170110', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20170110_tscode_list = list() 
for ts_code_sh in daily_20170110['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20170110_tscode_list.append(stock_name)
daily_20170110_addname_dataframe=pd.DataFrame()
daily_20170110_addname_dataframe['cname'] = daily_20170110_tscode_list
for table_name in daily_20170110.columns.values.tolist():
    daily_20170110_addname_dataframe[table_name] = daily_20170110[table_name]
print("日线行情-时间为序  daily_20170110 返回数据 row 行数 = "+str(daily_20170110.shape[0]))
daily_20170110_addname_dataframe.to_excel(daily_201701_excel_writer,'10_2',index=False)
daily_201701_excel_writer.save()
daily_20170111 = pro.daily(start_date='',end_date='',trade_date='20170111', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20170111_tscode_list = list() 
for ts_code_sh in daily_20170111['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20170111_tscode_list.append(stock_name)
daily_20170111_addname_dataframe=pd.DataFrame()
daily_20170111_addname_dataframe['cname'] = daily_20170111_tscode_list
for table_name in daily_20170111.columns.values.tolist():
    daily_20170111_addname_dataframe[table_name] = daily_20170111[table_name]
print("日线行情-时间为序  daily_20170111 返回数据 row 行数 = "+str(daily_20170111.shape[0]))
daily_20170111_addname_dataframe.to_excel(daily_201701_excel_writer,'11_3',index=False)
daily_201701_excel_writer.save()
daily_20170112 = pro.daily(start_date='',end_date='',trade_date='20170112', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20170112_tscode_list = list() 
for ts_code_sh in daily_20170112['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20170112_tscode_list.append(stock_name)
daily_20170112_addname_dataframe=pd.DataFrame()
daily_20170112_addname_dataframe['cname'] = daily_20170112_tscode_list
for table_name in daily_20170112.columns.values.tolist():
    daily_20170112_addname_dataframe[table_name] = daily_20170112[table_name]
print("日线行情-时间为序  daily_20170112 返回数据 row 行数 = "+str(daily_20170112.shape[0]))
daily_20170112_addname_dataframe.to_excel(daily_201701_excel_writer,'12_4',index=False)
daily_201701_excel_writer.save()
daily_20170113 = pro.daily(start_date='',end_date='',trade_date='20170113', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20170113_tscode_list = list() 
for ts_code_sh in daily_20170113['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20170113_tscode_list.append(stock_name)
daily_20170113_addname_dataframe=pd.DataFrame()
daily_20170113_addname_dataframe['cname'] = daily_20170113_tscode_list
for table_name in daily_20170113.columns.values.tolist():
    daily_20170113_addname_dataframe[table_name] = daily_20170113[table_name]
print("日线行情-时间为序  daily_20170113 返回数据 row 行数 = "+str(daily_20170113.shape[0]))
daily_20170113_addname_dataframe.to_excel(daily_201701_excel_writer,'13_5',index=False)
daily_201701_excel_writer.save()
daily_20170116 = pro.daily(start_date='',end_date='',trade_date='20170116', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20170116_tscode_list = list() 
for ts_code_sh in daily_20170116['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20170116_tscode_list.append(stock_name)
daily_20170116_addname_dataframe=pd.DataFrame()
daily_20170116_addname_dataframe['cname'] = daily_20170116_tscode_list
for table_name in daily_20170116.columns.values.tolist():
    daily_20170116_addname_dataframe[table_name] = daily_20170116[table_name]
print("日线行情-时间为序  daily_20170116 返回数据 row 行数 = "+str(daily_20170116.shape[0]))
daily_20170116_addname_dataframe.to_excel(daily_201701_excel_writer,'16_1',index=False)
daily_201701_excel_writer.save()
daily_20170117 = pro.daily(start_date='',end_date='',trade_date='20170117', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20170117_tscode_list = list() 
for ts_code_sh in daily_20170117['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20170117_tscode_list.append(stock_name)
daily_20170117_addname_dataframe=pd.DataFrame()
daily_20170117_addname_dataframe['cname'] = daily_20170117_tscode_list
for table_name in daily_20170117.columns.values.tolist():
    daily_20170117_addname_dataframe[table_name] = daily_20170117[table_name]
print("日线行情-时间为序  daily_20170117 返回数据 row 行数 = "+str(daily_20170117.shape[0]))
daily_20170117_addname_dataframe.to_excel(daily_201701_excel_writer,'17_2',index=False)
daily_201701_excel_writer.save()
daily_20170118 = pro.daily(start_date='',end_date='',trade_date='20170118', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20170118_tscode_list = list() 
for ts_code_sh in daily_20170118['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20170118_tscode_list.append(stock_name)
daily_20170118_addname_dataframe=pd.DataFrame()
daily_20170118_addname_dataframe['cname'] = daily_20170118_tscode_list
for table_name in daily_20170118.columns.values.tolist():
    daily_20170118_addname_dataframe[table_name] = daily_20170118[table_name]
print("日线行情-时间为序  daily_20170118 返回数据 row 行数 = "+str(daily_20170118.shape[0]))
daily_20170118_addname_dataframe.to_excel(daily_201701_excel_writer,'18_3',index=False)
daily_201701_excel_writer.save()
daily_20170119 = pro.daily(start_date='',end_date='',trade_date='20170119', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20170119_tscode_list = list() 
for ts_code_sh in daily_20170119['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20170119_tscode_list.append(stock_name)
daily_20170119_addname_dataframe=pd.DataFrame()
daily_20170119_addname_dataframe['cname'] = daily_20170119_tscode_list
for table_name in daily_20170119.columns.values.tolist():
    daily_20170119_addname_dataframe[table_name] = daily_20170119[table_name]
print("日线行情-时间为序  daily_20170119 返回数据 row 行数 = "+str(daily_20170119.shape[0]))
daily_20170119_addname_dataframe.to_excel(daily_201701_excel_writer,'19_4',index=False)
daily_201701_excel_writer.save()
daily_20170120 = pro.daily(start_date='',end_date='',trade_date='20170120', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20170120_tscode_list = list() 
for ts_code_sh in daily_20170120['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20170120_tscode_list.append(stock_name)
daily_20170120_addname_dataframe=pd.DataFrame()
daily_20170120_addname_dataframe['cname'] = daily_20170120_tscode_list
for table_name in daily_20170120.columns.values.tolist():
    daily_20170120_addname_dataframe[table_name] = daily_20170120[table_name]
print("日线行情-时间为序  daily_20170120 返回数据 row 行数 = "+str(daily_20170120.shape[0]))
daily_20170120_addname_dataframe.to_excel(daily_201701_excel_writer,'20_5',index=False)
daily_201701_excel_writer.save()
daily_20170123 = pro.daily(start_date='',end_date='',trade_date='20170123', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20170123_tscode_list = list() 
for ts_code_sh in daily_20170123['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20170123_tscode_list.append(stock_name)
daily_20170123_addname_dataframe=pd.DataFrame()
daily_20170123_addname_dataframe['cname'] = daily_20170123_tscode_list
for table_name in daily_20170123.columns.values.tolist():
    daily_20170123_addname_dataframe[table_name] = daily_20170123[table_name]
print("日线行情-时间为序  daily_20170123 返回数据 row 行数 = "+str(daily_20170123.shape[0]))
daily_20170123_addname_dataframe.to_excel(daily_201701_excel_writer,'23_1',index=False)
daily_201701_excel_writer.save()
daily_20170124 = pro.daily(start_date='',end_date='',trade_date='20170124', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20170124_tscode_list = list() 
for ts_code_sh in daily_20170124['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20170124_tscode_list.append(stock_name)
daily_20170124_addname_dataframe=pd.DataFrame()
daily_20170124_addname_dataframe['cname'] = daily_20170124_tscode_list
for table_name in daily_20170124.columns.values.tolist():
    daily_20170124_addname_dataframe[table_name] = daily_20170124[table_name]
print("日线行情-时间为序  daily_20170124 返回数据 row 行数 = "+str(daily_20170124.shape[0]))
daily_20170124_addname_dataframe.to_excel(daily_201701_excel_writer,'24_2',index=False)
daily_201701_excel_writer.save()
daily_20170125 = pro.daily(start_date='',end_date='',trade_date='20170125', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20170125_tscode_list = list() 
for ts_code_sh in daily_20170125['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20170125_tscode_list.append(stock_name)
daily_20170125_addname_dataframe=pd.DataFrame()
daily_20170125_addname_dataframe['cname'] = daily_20170125_tscode_list
for table_name in daily_20170125.columns.values.tolist():
    daily_20170125_addname_dataframe[table_name] = daily_20170125[table_name]
print("日线行情-时间为序  daily_20170125 返回数据 row 行数 = "+str(daily_20170125.shape[0]))
daily_20170125_addname_dataframe.to_excel(daily_201701_excel_writer,'25_3',index=False)
daily_201701_excel_writer.save()
daily_20170126 = pro.daily(start_date='',end_date='',trade_date='20170126', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20170126_tscode_list = list() 
for ts_code_sh in daily_20170126['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20170126_tscode_list.append(stock_name)
daily_20170126_addname_dataframe=pd.DataFrame()
daily_20170126_addname_dataframe['cname'] = daily_20170126_tscode_list
for table_name in daily_20170126.columns.values.tolist():
    daily_20170126_addname_dataframe[table_name] = daily_20170126[table_name]
print("日线行情-时间为序  daily_20170126 返回数据 row 行数 = "+str(daily_20170126.shape[0]))
daily_20170126_addname_dataframe.to_excel(daily_201701_excel_writer,'26_4',index=False)
daily_201701_excel_writer.save()




createexcel('daily_201702.xlsx')
daily_201702_book = load_workbook('C:\\Users\\zhuzj5\\Desktop\\zbin\\J0_Data\\daily_201702.xlsx')
daily_201702_excel_writer = pd.ExcelWriter('C:\\Users\\zhuzj5\\Desktop\\zbin\\J0_Data\\daily_201702.xlsx', engine='openpyxl')
daily_201702_excel_writer.book = daily_201702_book
daily_201702_excel_writer.sheets = dict((ws.title, ws) for ws in daily_201702_book.worksheets)
J0_PROPS.put(tree_node_name+"record_date", "20170201")       ###  更新 记录日期
daily_20170203 = pro.daily(start_date='',end_date='',trade_date='20170203', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20170203_tscode_list = list() 
for ts_code_sh in daily_20170203['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20170203_tscode_list.append(stock_name)
daily_20170203_addname_dataframe=pd.DataFrame()
daily_20170203_addname_dataframe['cname'] = daily_20170203_tscode_list
for table_name in daily_20170203.columns.values.tolist():
    daily_20170203_addname_dataframe[table_name] = daily_20170203[table_name]
print("日线行情-时间为序  daily_20170203 返回数据 row 行数 = "+str(daily_20170203.shape[0]))
daily_20170203_addname_dataframe.to_excel(daily_201702_excel_writer,'3_5',index=False)
daily_201702_excel_writer.save()
daily_20170206 = pro.daily(start_date='',end_date='',trade_date='20170206', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20170206_tscode_list = list() 
for ts_code_sh in daily_20170206['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20170206_tscode_list.append(stock_name)
daily_20170206_addname_dataframe=pd.DataFrame()
daily_20170206_addname_dataframe['cname'] = daily_20170206_tscode_list
for table_name in daily_20170206.columns.values.tolist():
    daily_20170206_addname_dataframe[table_name] = daily_20170206[table_name]
print("日线行情-时间为序  daily_20170206 返回数据 row 行数 = "+str(daily_20170206.shape[0]))
daily_20170206_addname_dataframe.to_excel(daily_201702_excel_writer,'6_1',index=False)
daily_201702_excel_writer.save()
daily_20170207 = pro.daily(start_date='',end_date='',trade_date='20170207', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20170207_tscode_list = list() 
for ts_code_sh in daily_20170207['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20170207_tscode_list.append(stock_name)
daily_20170207_addname_dataframe=pd.DataFrame()
daily_20170207_addname_dataframe['cname'] = daily_20170207_tscode_list
for table_name in daily_20170207.columns.values.tolist():
    daily_20170207_addname_dataframe[table_name] = daily_20170207[table_name]
print("日线行情-时间为序  daily_20170207 返回数据 row 行数 = "+str(daily_20170207.shape[0]))
daily_20170207_addname_dataframe.to_excel(daily_201702_excel_writer,'7_2',index=False)
daily_201702_excel_writer.save()
daily_20170208 = pro.daily(start_date='',end_date='',trade_date='20170208', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20170208_tscode_list = list() 
for ts_code_sh in daily_20170208['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20170208_tscode_list.append(stock_name)
daily_20170208_addname_dataframe=pd.DataFrame()
daily_20170208_addname_dataframe['cname'] = daily_20170208_tscode_list
for table_name in daily_20170208.columns.values.tolist():
    daily_20170208_addname_dataframe[table_name] = daily_20170208[table_name]
print("日线行情-时间为序  daily_20170208 返回数据 row 行数 = "+str(daily_20170208.shape[0]))
daily_20170208_addname_dataframe.to_excel(daily_201702_excel_writer,'8_3',index=False)
daily_201702_excel_writer.save()
daily_20170209 = pro.daily(start_date='',end_date='',trade_date='20170209', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20170209_tscode_list = list() 
for ts_code_sh in daily_20170209['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20170209_tscode_list.append(stock_name)
daily_20170209_addname_dataframe=pd.DataFrame()
daily_20170209_addname_dataframe['cname'] = daily_20170209_tscode_list
for table_name in daily_20170209.columns.values.tolist():
    daily_20170209_addname_dataframe[table_name] = daily_20170209[table_name]
print("日线行情-时间为序  daily_20170209 返回数据 row 行数 = "+str(daily_20170209.shape[0]))
daily_20170209_addname_dataframe.to_excel(daily_201702_excel_writer,'9_4',index=False)
daily_201702_excel_writer.save()
daily_20170210 = pro.daily(start_date='',end_date='',trade_date='20170210', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20170210_tscode_list = list() 
for ts_code_sh in daily_20170210['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20170210_tscode_list.append(stock_name)
daily_20170210_addname_dataframe=pd.DataFrame()
daily_20170210_addname_dataframe['cname'] = daily_20170210_tscode_list
for table_name in daily_20170210.columns.values.tolist():
    daily_20170210_addname_dataframe[table_name] = daily_20170210[table_name]
print("日线行情-时间为序  daily_20170210 返回数据 row 行数 = "+str(daily_20170210.shape[0]))
daily_20170210_addname_dataframe.to_excel(daily_201702_excel_writer,'10_5',index=False)
daily_201702_excel_writer.save()
daily_20170213 = pro.daily(start_date='',end_date='',trade_date='20170213', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20170213_tscode_list = list() 
for ts_code_sh in daily_20170213['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20170213_tscode_list.append(stock_name)
daily_20170213_addname_dataframe=pd.DataFrame()
daily_20170213_addname_dataframe['cname'] = daily_20170213_tscode_list
for table_name in daily_20170213.columns.values.tolist():
    daily_20170213_addname_dataframe[table_name] = daily_20170213[table_name]
print("日线行情-时间为序  daily_20170213 返回数据 row 行数 = "+str(daily_20170213.shape[0]))
daily_20170213_addname_dataframe.to_excel(daily_201702_excel_writer,'13_1',index=False)
daily_201702_excel_writer.save()
daily_20170214 = pro.daily(start_date='',end_date='',trade_date='20170214', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20170214_tscode_list = list() 
for ts_code_sh in daily_20170214['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20170214_tscode_list.append(stock_name)
daily_20170214_addname_dataframe=pd.DataFrame()
daily_20170214_addname_dataframe['cname'] = daily_20170214_tscode_list
for table_name in daily_20170214.columns.values.tolist():
    daily_20170214_addname_dataframe[table_name] = daily_20170214[table_name]
print("日线行情-时间为序  daily_20170214 返回数据 row 行数 = "+str(daily_20170214.shape[0]))
daily_20170214_addname_dataframe.to_excel(daily_201702_excel_writer,'14_2',index=False)
daily_201702_excel_writer.save()
daily_20170215 = pro.daily(start_date='',end_date='',trade_date='20170215', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20170215_tscode_list = list() 
for ts_code_sh in daily_20170215['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20170215_tscode_list.append(stock_name)
daily_20170215_addname_dataframe=pd.DataFrame()
daily_20170215_addname_dataframe['cname'] = daily_20170215_tscode_list
for table_name in daily_20170215.columns.values.tolist():
    daily_20170215_addname_dataframe[table_name] = daily_20170215[table_name]
print("日线行情-时间为序  daily_20170215 返回数据 row 行数 = "+str(daily_20170215.shape[0]))
daily_20170215_addname_dataframe.to_excel(daily_201702_excel_writer,'15_3',index=False)
daily_201702_excel_writer.save()
daily_20170216 = pro.daily(start_date='',end_date='',trade_date='20170216', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20170216_tscode_list = list() 
for ts_code_sh in daily_20170216['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20170216_tscode_list.append(stock_name)
daily_20170216_addname_dataframe=pd.DataFrame()
daily_20170216_addname_dataframe['cname'] = daily_20170216_tscode_list
for table_name in daily_20170216.columns.values.tolist():
    daily_20170216_addname_dataframe[table_name] = daily_20170216[table_name]
print("日线行情-时间为序  daily_20170216 返回数据 row 行数 = "+str(daily_20170216.shape[0]))
daily_20170216_addname_dataframe.to_excel(daily_201702_excel_writer,'16_4',index=False)
daily_201702_excel_writer.save()
daily_20170217 = pro.daily(start_date='',end_date='',trade_date='20170217', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20170217_tscode_list = list() 
for ts_code_sh in daily_20170217['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20170217_tscode_list.append(stock_name)
daily_20170217_addname_dataframe=pd.DataFrame()
daily_20170217_addname_dataframe['cname'] = daily_20170217_tscode_list
for table_name in daily_20170217.columns.values.tolist():
    daily_20170217_addname_dataframe[table_name] = daily_20170217[table_name]
print("日线行情-时间为序  daily_20170217 返回数据 row 行数 = "+str(daily_20170217.shape[0]))
daily_20170217_addname_dataframe.to_excel(daily_201702_excel_writer,'17_5',index=False)
daily_201702_excel_writer.save()
daily_20170220 = pro.daily(start_date='',end_date='',trade_date='20170220', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20170220_tscode_list = list() 
for ts_code_sh in daily_20170220['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20170220_tscode_list.append(stock_name)
daily_20170220_addname_dataframe=pd.DataFrame()
daily_20170220_addname_dataframe['cname'] = daily_20170220_tscode_list
for table_name in daily_20170220.columns.values.tolist():
    daily_20170220_addname_dataframe[table_name] = daily_20170220[table_name]
print("日线行情-时间为序  daily_20170220 返回数据 row 行数 = "+str(daily_20170220.shape[0]))
daily_20170220_addname_dataframe.to_excel(daily_201702_excel_writer,'20_1',index=False)
daily_201702_excel_writer.save()
daily_20170221 = pro.daily(start_date='',end_date='',trade_date='20170221', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20170221_tscode_list = list() 
for ts_code_sh in daily_20170221['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20170221_tscode_list.append(stock_name)
daily_20170221_addname_dataframe=pd.DataFrame()
daily_20170221_addname_dataframe['cname'] = daily_20170221_tscode_list
for table_name in daily_20170221.columns.values.tolist():
    daily_20170221_addname_dataframe[table_name] = daily_20170221[table_name]
print("日线行情-时间为序  daily_20170221 返回数据 row 行数 = "+str(daily_20170221.shape[0]))
daily_20170221_addname_dataframe.to_excel(daily_201702_excel_writer,'21_2',index=False)
daily_201702_excel_writer.save()
daily_20170222 = pro.daily(start_date='',end_date='',trade_date='20170222', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20170222_tscode_list = list() 
for ts_code_sh in daily_20170222['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20170222_tscode_list.append(stock_name)
daily_20170222_addname_dataframe=pd.DataFrame()
daily_20170222_addname_dataframe['cname'] = daily_20170222_tscode_list
for table_name in daily_20170222.columns.values.tolist():
    daily_20170222_addname_dataframe[table_name] = daily_20170222[table_name]
print("日线行情-时间为序  daily_20170222 返回数据 row 行数 = "+str(daily_20170222.shape[0]))
daily_20170222_addname_dataframe.to_excel(daily_201702_excel_writer,'22_3',index=False)
daily_201702_excel_writer.save()
daily_20170223 = pro.daily(start_date='',end_date='',trade_date='20170223', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20170223_tscode_list = list() 
for ts_code_sh in daily_20170223['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20170223_tscode_list.append(stock_name)
daily_20170223_addname_dataframe=pd.DataFrame()
daily_20170223_addname_dataframe['cname'] = daily_20170223_tscode_list
for table_name in daily_20170223.columns.values.tolist():
    daily_20170223_addname_dataframe[table_name] = daily_20170223[table_name]
print("日线行情-时间为序  daily_20170223 返回数据 row 行数 = "+str(daily_20170223.shape[0]))
daily_20170223_addname_dataframe.to_excel(daily_201702_excel_writer,'23_4',index=False)
daily_201702_excel_writer.save()
daily_20170224 = pro.daily(start_date='',end_date='',trade_date='20170224', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20170224_tscode_list = list() 
for ts_code_sh in daily_20170224['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20170224_tscode_list.append(stock_name)
daily_20170224_addname_dataframe=pd.DataFrame()
daily_20170224_addname_dataframe['cname'] = daily_20170224_tscode_list
for table_name in daily_20170224.columns.values.tolist():
    daily_20170224_addname_dataframe[table_name] = daily_20170224[table_name]
print("日线行情-时间为序  daily_20170224 返回数据 row 行数 = "+str(daily_20170224.shape[0]))
daily_20170224_addname_dataframe.to_excel(daily_201702_excel_writer,'24_5',index=False)
daily_201702_excel_writer.save()
daily_20170227 = pro.daily(start_date='',end_date='',trade_date='20170227', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20170227_tscode_list = list() 
for ts_code_sh in daily_20170227['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20170227_tscode_list.append(stock_name)
daily_20170227_addname_dataframe=pd.DataFrame()
daily_20170227_addname_dataframe['cname'] = daily_20170227_tscode_list
for table_name in daily_20170227.columns.values.tolist():
    daily_20170227_addname_dataframe[table_name] = daily_20170227[table_name]
print("日线行情-时间为序  daily_20170227 返回数据 row 行数 = "+str(daily_20170227.shape[0]))
daily_20170227_addname_dataframe.to_excel(daily_201702_excel_writer,'27_1',index=False)
daily_201702_excel_writer.save()
daily_20170228 = pro.daily(start_date='',end_date='',trade_date='20170228', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20170228_tscode_list = list() 
for ts_code_sh in daily_20170228['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20170228_tscode_list.append(stock_name)
daily_20170228_addname_dataframe=pd.DataFrame()
daily_20170228_addname_dataframe['cname'] = daily_20170228_tscode_list
for table_name in daily_20170228.columns.values.tolist():
    daily_20170228_addname_dataframe[table_name] = daily_20170228[table_name]
print("日线行情-时间为序  daily_20170228 返回数据 row 行数 = "+str(daily_20170228.shape[0]))
daily_20170228_addname_dataframe.to_excel(daily_201702_excel_writer,'28_2',index=False)
daily_201702_excel_writer.save()




createexcel('daily_201703.xlsx')
daily_201703_book = load_workbook('C:\\Users\\zhuzj5\\Desktop\\zbin\\J0_Data\\daily_201703.xlsx')
daily_201703_excel_writer = pd.ExcelWriter('C:\\Users\\zhuzj5\\Desktop\\zbin\\J0_Data\\daily_201703.xlsx', engine='openpyxl')
daily_201703_excel_writer.book = daily_201703_book
daily_201703_excel_writer.sheets = dict((ws.title, ws) for ws in daily_201703_book.worksheets)
J0_PROPS.put(tree_node_name+"record_date", "20170301")       ###  更新 记录日期
daily_20170301 = pro.daily(start_date='',end_date='',trade_date='20170301', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20170301_tscode_list = list() 
for ts_code_sh in daily_20170301['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20170301_tscode_list.append(stock_name)
daily_20170301_addname_dataframe=pd.DataFrame()
daily_20170301_addname_dataframe['cname'] = daily_20170301_tscode_list
for table_name in daily_20170301.columns.values.tolist():
    daily_20170301_addname_dataframe[table_name] = daily_20170301[table_name]
print("日线行情-时间为序  daily_20170301 返回数据 row 行数 = "+str(daily_20170301.shape[0]))
daily_20170301_addname_dataframe.to_excel(daily_201703_excel_writer,'1_3',index=False)
daily_201703_excel_writer.save()
daily_20170302 = pro.daily(start_date='',end_date='',trade_date='20170302', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20170302_tscode_list = list() 
for ts_code_sh in daily_20170302['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20170302_tscode_list.append(stock_name)
daily_20170302_addname_dataframe=pd.DataFrame()
daily_20170302_addname_dataframe['cname'] = daily_20170302_tscode_list
for table_name in daily_20170302.columns.values.tolist():
    daily_20170302_addname_dataframe[table_name] = daily_20170302[table_name]
print("日线行情-时间为序  daily_20170302 返回数据 row 行数 = "+str(daily_20170302.shape[0]))
daily_20170302_addname_dataframe.to_excel(daily_201703_excel_writer,'2_4',index=False)
daily_201703_excel_writer.save()
daily_20170303 = pro.daily(start_date='',end_date='',trade_date='20170303', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20170303_tscode_list = list() 
for ts_code_sh in daily_20170303['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20170303_tscode_list.append(stock_name)
daily_20170303_addname_dataframe=pd.DataFrame()
daily_20170303_addname_dataframe['cname'] = daily_20170303_tscode_list
for table_name in daily_20170303.columns.values.tolist():
    daily_20170303_addname_dataframe[table_name] = daily_20170303[table_name]
print("日线行情-时间为序  daily_20170303 返回数据 row 行数 = "+str(daily_20170303.shape[0]))
daily_20170303_addname_dataframe.to_excel(daily_201703_excel_writer,'3_5',index=False)
daily_201703_excel_writer.save()
daily_20170306 = pro.daily(start_date='',end_date='',trade_date='20170306', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20170306_tscode_list = list() 
for ts_code_sh in daily_20170306['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20170306_tscode_list.append(stock_name)
daily_20170306_addname_dataframe=pd.DataFrame()
daily_20170306_addname_dataframe['cname'] = daily_20170306_tscode_list
for table_name in daily_20170306.columns.values.tolist():
    daily_20170306_addname_dataframe[table_name] = daily_20170306[table_name]
print("日线行情-时间为序  daily_20170306 返回数据 row 行数 = "+str(daily_20170306.shape[0]))
daily_20170306_addname_dataframe.to_excel(daily_201703_excel_writer,'6_1',index=False)
daily_201703_excel_writer.save()
daily_20170307 = pro.daily(start_date='',end_date='',trade_date='20170307', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20170307_tscode_list = list() 
for ts_code_sh in daily_20170307['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20170307_tscode_list.append(stock_name)
daily_20170307_addname_dataframe=pd.DataFrame()
daily_20170307_addname_dataframe['cname'] = daily_20170307_tscode_list
for table_name in daily_20170307.columns.values.tolist():
    daily_20170307_addname_dataframe[table_name] = daily_20170307[table_name]
print("日线行情-时间为序  daily_20170307 返回数据 row 行数 = "+str(daily_20170307.shape[0]))
daily_20170307_addname_dataframe.to_excel(daily_201703_excel_writer,'7_2',index=False)
daily_201703_excel_writer.save()
daily_20170308 = pro.daily(start_date='',end_date='',trade_date='20170308', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20170308_tscode_list = list() 
for ts_code_sh in daily_20170308['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20170308_tscode_list.append(stock_name)
daily_20170308_addname_dataframe=pd.DataFrame()
daily_20170308_addname_dataframe['cname'] = daily_20170308_tscode_list
for table_name in daily_20170308.columns.values.tolist():
    daily_20170308_addname_dataframe[table_name] = daily_20170308[table_name]
print("日线行情-时间为序  daily_20170308 返回数据 row 行数 = "+str(daily_20170308.shape[0]))
daily_20170308_addname_dataframe.to_excel(daily_201703_excel_writer,'8_3',index=False)
daily_201703_excel_writer.save()
daily_20170309 = pro.daily(start_date='',end_date='',trade_date='20170309', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20170309_tscode_list = list() 
for ts_code_sh in daily_20170309['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20170309_tscode_list.append(stock_name)
daily_20170309_addname_dataframe=pd.DataFrame()
daily_20170309_addname_dataframe['cname'] = daily_20170309_tscode_list
for table_name in daily_20170309.columns.values.tolist():
    daily_20170309_addname_dataframe[table_name] = daily_20170309[table_name]
print("日线行情-时间为序  daily_20170309 返回数据 row 行数 = "+str(daily_20170309.shape[0]))
daily_20170309_addname_dataframe.to_excel(daily_201703_excel_writer,'9_4',index=False)
daily_201703_excel_writer.save()
daily_20170310 = pro.daily(start_date='',end_date='',trade_date='20170310', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20170310_tscode_list = list() 
for ts_code_sh in daily_20170310['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20170310_tscode_list.append(stock_name)
daily_20170310_addname_dataframe=pd.DataFrame()
daily_20170310_addname_dataframe['cname'] = daily_20170310_tscode_list
for table_name in daily_20170310.columns.values.tolist():
    daily_20170310_addname_dataframe[table_name] = daily_20170310[table_name]
print("日线行情-时间为序  daily_20170310 返回数据 row 行数 = "+str(daily_20170310.shape[0]))
daily_20170310_addname_dataframe.to_excel(daily_201703_excel_writer,'10_5',index=False)
daily_201703_excel_writer.save()
daily_20170313 = pro.daily(start_date='',end_date='',trade_date='20170313', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20170313_tscode_list = list() 
for ts_code_sh in daily_20170313['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20170313_tscode_list.append(stock_name)
daily_20170313_addname_dataframe=pd.DataFrame()
daily_20170313_addname_dataframe['cname'] = daily_20170313_tscode_list
for table_name in daily_20170313.columns.values.tolist():
    daily_20170313_addname_dataframe[table_name] = daily_20170313[table_name]
print("日线行情-时间为序  daily_20170313 返回数据 row 行数 = "+str(daily_20170313.shape[0]))
daily_20170313_addname_dataframe.to_excel(daily_201703_excel_writer,'13_1',index=False)
daily_201703_excel_writer.save()
daily_20170314 = pro.daily(start_date='',end_date='',trade_date='20170314', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20170314_tscode_list = list() 
for ts_code_sh in daily_20170314['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20170314_tscode_list.append(stock_name)
daily_20170314_addname_dataframe=pd.DataFrame()
daily_20170314_addname_dataframe['cname'] = daily_20170314_tscode_list
for table_name in daily_20170314.columns.values.tolist():
    daily_20170314_addname_dataframe[table_name] = daily_20170314[table_name]
print("日线行情-时间为序  daily_20170314 返回数据 row 行数 = "+str(daily_20170314.shape[0]))
daily_20170314_addname_dataframe.to_excel(daily_201703_excel_writer,'14_2',index=False)
daily_201703_excel_writer.save()
daily_20170315 = pro.daily(start_date='',end_date='',trade_date='20170315', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20170315_tscode_list = list() 
for ts_code_sh in daily_20170315['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20170315_tscode_list.append(stock_name)
daily_20170315_addname_dataframe=pd.DataFrame()
daily_20170315_addname_dataframe['cname'] = daily_20170315_tscode_list
for table_name in daily_20170315.columns.values.tolist():
    daily_20170315_addname_dataframe[table_name] = daily_20170315[table_name]
print("日线行情-时间为序  daily_20170315 返回数据 row 行数 = "+str(daily_20170315.shape[0]))
daily_20170315_addname_dataframe.to_excel(daily_201703_excel_writer,'15_3',index=False)
daily_201703_excel_writer.save()
daily_20170316 = pro.daily(start_date='',end_date='',trade_date='20170316', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20170316_tscode_list = list() 
for ts_code_sh in daily_20170316['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20170316_tscode_list.append(stock_name)
daily_20170316_addname_dataframe=pd.DataFrame()
daily_20170316_addname_dataframe['cname'] = daily_20170316_tscode_list
for table_name in daily_20170316.columns.values.tolist():
    daily_20170316_addname_dataframe[table_name] = daily_20170316[table_name]
print("日线行情-时间为序  daily_20170316 返回数据 row 行数 = "+str(daily_20170316.shape[0]))
daily_20170316_addname_dataframe.to_excel(daily_201703_excel_writer,'16_4',index=False)
daily_201703_excel_writer.save()
daily_20170317 = pro.daily(start_date='',end_date='',trade_date='20170317', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20170317_tscode_list = list() 
for ts_code_sh in daily_20170317['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20170317_tscode_list.append(stock_name)
daily_20170317_addname_dataframe=pd.DataFrame()
daily_20170317_addname_dataframe['cname'] = daily_20170317_tscode_list
for table_name in daily_20170317.columns.values.tolist():
    daily_20170317_addname_dataframe[table_name] = daily_20170317[table_name]
print("日线行情-时间为序  daily_20170317 返回数据 row 行数 = "+str(daily_20170317.shape[0]))
daily_20170317_addname_dataframe.to_excel(daily_201703_excel_writer,'17_5',index=False)
daily_201703_excel_writer.save()
daily_20170320 = pro.daily(start_date='',end_date='',trade_date='20170320', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20170320_tscode_list = list() 
for ts_code_sh in daily_20170320['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20170320_tscode_list.append(stock_name)
daily_20170320_addname_dataframe=pd.DataFrame()
daily_20170320_addname_dataframe['cname'] = daily_20170320_tscode_list
for table_name in daily_20170320.columns.values.tolist():
    daily_20170320_addname_dataframe[table_name] = daily_20170320[table_name]
print("日线行情-时间为序  daily_20170320 返回数据 row 行数 = "+str(daily_20170320.shape[0]))
daily_20170320_addname_dataframe.to_excel(daily_201703_excel_writer,'20_1',index=False)
daily_201703_excel_writer.save()
daily_20170321 = pro.daily(start_date='',end_date='',trade_date='20170321', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20170321_tscode_list = list() 
for ts_code_sh in daily_20170321['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20170321_tscode_list.append(stock_name)
daily_20170321_addname_dataframe=pd.DataFrame()
daily_20170321_addname_dataframe['cname'] = daily_20170321_tscode_list
for table_name in daily_20170321.columns.values.tolist():
    daily_20170321_addname_dataframe[table_name] = daily_20170321[table_name]
print("日线行情-时间为序  daily_20170321 返回数据 row 行数 = "+str(daily_20170321.shape[0]))
daily_20170321_addname_dataframe.to_excel(daily_201703_excel_writer,'21_2',index=False)
daily_201703_excel_writer.save()
daily_20170322 = pro.daily(start_date='',end_date='',trade_date='20170322', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20170322_tscode_list = list() 
for ts_code_sh in daily_20170322['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20170322_tscode_list.append(stock_name)
daily_20170322_addname_dataframe=pd.DataFrame()
daily_20170322_addname_dataframe['cname'] = daily_20170322_tscode_list
for table_name in daily_20170322.columns.values.tolist():
    daily_20170322_addname_dataframe[table_name] = daily_20170322[table_name]
print("日线行情-时间为序  daily_20170322 返回数据 row 行数 = "+str(daily_20170322.shape[0]))
daily_20170322_addname_dataframe.to_excel(daily_201703_excel_writer,'22_3',index=False)
daily_201703_excel_writer.save()
daily_20170323 = pro.daily(start_date='',end_date='',trade_date='20170323', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20170323_tscode_list = list() 
for ts_code_sh in daily_20170323['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20170323_tscode_list.append(stock_name)
daily_20170323_addname_dataframe=pd.DataFrame()
daily_20170323_addname_dataframe['cname'] = daily_20170323_tscode_list
for table_name in daily_20170323.columns.values.tolist():
    daily_20170323_addname_dataframe[table_name] = daily_20170323[table_name]
print("日线行情-时间为序  daily_20170323 返回数据 row 行数 = "+str(daily_20170323.shape[0]))
daily_20170323_addname_dataframe.to_excel(daily_201703_excel_writer,'23_4',index=False)
daily_201703_excel_writer.save()
daily_20170324 = pro.daily(start_date='',end_date='',trade_date='20170324', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20170324_tscode_list = list() 
for ts_code_sh in daily_20170324['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20170324_tscode_list.append(stock_name)
daily_20170324_addname_dataframe=pd.DataFrame()
daily_20170324_addname_dataframe['cname'] = daily_20170324_tscode_list
for table_name in daily_20170324.columns.values.tolist():
    daily_20170324_addname_dataframe[table_name] = daily_20170324[table_name]
print("日线行情-时间为序  daily_20170324 返回数据 row 行数 = "+str(daily_20170324.shape[0]))
daily_20170324_addname_dataframe.to_excel(daily_201703_excel_writer,'24_5',index=False)
daily_201703_excel_writer.save()
daily_20170327 = pro.daily(start_date='',end_date='',trade_date='20170327', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20170327_tscode_list = list() 
for ts_code_sh in daily_20170327['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20170327_tscode_list.append(stock_name)
daily_20170327_addname_dataframe=pd.DataFrame()
daily_20170327_addname_dataframe['cname'] = daily_20170327_tscode_list
for table_name in daily_20170327.columns.values.tolist():
    daily_20170327_addname_dataframe[table_name] = daily_20170327[table_name]
print("日线行情-时间为序  daily_20170327 返回数据 row 行数 = "+str(daily_20170327.shape[0]))
daily_20170327_addname_dataframe.to_excel(daily_201703_excel_writer,'27_1',index=False)
daily_201703_excel_writer.save()
daily_20170328 = pro.daily(start_date='',end_date='',trade_date='20170328', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20170328_tscode_list = list() 
for ts_code_sh in daily_20170328['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20170328_tscode_list.append(stock_name)
daily_20170328_addname_dataframe=pd.DataFrame()
daily_20170328_addname_dataframe['cname'] = daily_20170328_tscode_list
for table_name in daily_20170328.columns.values.tolist():
    daily_20170328_addname_dataframe[table_name] = daily_20170328[table_name]
print("日线行情-时间为序  daily_20170328 返回数据 row 行数 = "+str(daily_20170328.shape[0]))
daily_20170328_addname_dataframe.to_excel(daily_201703_excel_writer,'28_2',index=False)
daily_201703_excel_writer.save()
daily_20170329 = pro.daily(start_date='',end_date='',trade_date='20170329', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20170329_tscode_list = list() 
for ts_code_sh in daily_20170329['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20170329_tscode_list.append(stock_name)
daily_20170329_addname_dataframe=pd.DataFrame()
daily_20170329_addname_dataframe['cname'] = daily_20170329_tscode_list
for table_name in daily_20170329.columns.values.tolist():
    daily_20170329_addname_dataframe[table_name] = daily_20170329[table_name]
print("日线行情-时间为序  daily_20170329 返回数据 row 行数 = "+str(daily_20170329.shape[0]))
daily_20170329_addname_dataframe.to_excel(daily_201703_excel_writer,'29_3',index=False)
daily_201703_excel_writer.save()
daily_20170330 = pro.daily(start_date='',end_date='',trade_date='20170330', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20170330_tscode_list = list() 
for ts_code_sh in daily_20170330['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20170330_tscode_list.append(stock_name)
daily_20170330_addname_dataframe=pd.DataFrame()
daily_20170330_addname_dataframe['cname'] = daily_20170330_tscode_list
for table_name in daily_20170330.columns.values.tolist():
    daily_20170330_addname_dataframe[table_name] = daily_20170330[table_name]
print("日线行情-时间为序  daily_20170330 返回数据 row 行数 = "+str(daily_20170330.shape[0]))
daily_20170330_addname_dataframe.to_excel(daily_201703_excel_writer,'30_4',index=False)
daily_201703_excel_writer.save()
daily_20170331 = pro.daily(start_date='',end_date='',trade_date='20170331', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20170331_tscode_list = list() 
for ts_code_sh in daily_20170331['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20170331_tscode_list.append(stock_name)
daily_20170331_addname_dataframe=pd.DataFrame()
daily_20170331_addname_dataframe['cname'] = daily_20170331_tscode_list
for table_name in daily_20170331.columns.values.tolist():
    daily_20170331_addname_dataframe[table_name] = daily_20170331[table_name]
print("日线行情-时间为序  daily_20170331 返回数据 row 行数 = "+str(daily_20170331.shape[0]))
daily_20170331_addname_dataframe.to_excel(daily_201703_excel_writer,'31_5',index=False)
daily_201703_excel_writer.save()




createexcel('daily_201704.xlsx')
daily_201704_book = load_workbook('C:\\Users\\zhuzj5\\Desktop\\zbin\\J0_Data\\daily_201704.xlsx')
daily_201704_excel_writer = pd.ExcelWriter('C:\\Users\\zhuzj5\\Desktop\\zbin\\J0_Data\\daily_201704.xlsx', engine='openpyxl')
daily_201704_excel_writer.book = daily_201704_book
daily_201704_excel_writer.sheets = dict((ws.title, ws) for ws in daily_201704_book.worksheets)
J0_PROPS.put(tree_node_name+"record_date", "20170401")       ###  更新 记录日期
daily_20170405 = pro.daily(start_date='',end_date='',trade_date='20170405', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20170405_tscode_list = list() 
for ts_code_sh in daily_20170405['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20170405_tscode_list.append(stock_name)
daily_20170405_addname_dataframe=pd.DataFrame()
daily_20170405_addname_dataframe['cname'] = daily_20170405_tscode_list
for table_name in daily_20170405.columns.values.tolist():
    daily_20170405_addname_dataframe[table_name] = daily_20170405[table_name]
print("日线行情-时间为序  daily_20170405 返回数据 row 行数 = "+str(daily_20170405.shape[0]))
daily_20170405_addname_dataframe.to_excel(daily_201704_excel_writer,'5_3',index=False)
daily_201704_excel_writer.save()
daily_20170406 = pro.daily(start_date='',end_date='',trade_date='20170406', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20170406_tscode_list = list() 
for ts_code_sh in daily_20170406['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20170406_tscode_list.append(stock_name)
daily_20170406_addname_dataframe=pd.DataFrame()
daily_20170406_addname_dataframe['cname'] = daily_20170406_tscode_list
for table_name in daily_20170406.columns.values.tolist():
    daily_20170406_addname_dataframe[table_name] = daily_20170406[table_name]
print("日线行情-时间为序  daily_20170406 返回数据 row 行数 = "+str(daily_20170406.shape[0]))
daily_20170406_addname_dataframe.to_excel(daily_201704_excel_writer,'6_4',index=False)
daily_201704_excel_writer.save()
daily_20170407 = pro.daily(start_date='',end_date='',trade_date='20170407', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20170407_tscode_list = list() 
for ts_code_sh in daily_20170407['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20170407_tscode_list.append(stock_name)
daily_20170407_addname_dataframe=pd.DataFrame()
daily_20170407_addname_dataframe['cname'] = daily_20170407_tscode_list
for table_name in daily_20170407.columns.values.tolist():
    daily_20170407_addname_dataframe[table_name] = daily_20170407[table_name]
print("日线行情-时间为序  daily_20170407 返回数据 row 行数 = "+str(daily_20170407.shape[0]))
daily_20170407_addname_dataframe.to_excel(daily_201704_excel_writer,'7_5',index=False)
daily_201704_excel_writer.save()
daily_20170410 = pro.daily(start_date='',end_date='',trade_date='20170410', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20170410_tscode_list = list() 
for ts_code_sh in daily_20170410['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20170410_tscode_list.append(stock_name)
daily_20170410_addname_dataframe=pd.DataFrame()
daily_20170410_addname_dataframe['cname'] = daily_20170410_tscode_list
for table_name in daily_20170410.columns.values.tolist():
    daily_20170410_addname_dataframe[table_name] = daily_20170410[table_name]
print("日线行情-时间为序  daily_20170410 返回数据 row 行数 = "+str(daily_20170410.shape[0]))
daily_20170410_addname_dataframe.to_excel(daily_201704_excel_writer,'10_1',index=False)
daily_201704_excel_writer.save()
daily_20170411 = pro.daily(start_date='',end_date='',trade_date='20170411', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20170411_tscode_list = list() 
for ts_code_sh in daily_20170411['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20170411_tscode_list.append(stock_name)
daily_20170411_addname_dataframe=pd.DataFrame()
daily_20170411_addname_dataframe['cname'] = daily_20170411_tscode_list
for table_name in daily_20170411.columns.values.tolist():
    daily_20170411_addname_dataframe[table_name] = daily_20170411[table_name]
print("日线行情-时间为序  daily_20170411 返回数据 row 行数 = "+str(daily_20170411.shape[0]))
daily_20170411_addname_dataframe.to_excel(daily_201704_excel_writer,'11_2',index=False)
daily_201704_excel_writer.save()
daily_20170412 = pro.daily(start_date='',end_date='',trade_date='20170412', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20170412_tscode_list = list() 
for ts_code_sh in daily_20170412['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20170412_tscode_list.append(stock_name)
daily_20170412_addname_dataframe=pd.DataFrame()
daily_20170412_addname_dataframe['cname'] = daily_20170412_tscode_list
for table_name in daily_20170412.columns.values.tolist():
    daily_20170412_addname_dataframe[table_name] = daily_20170412[table_name]
print("日线行情-时间为序  daily_20170412 返回数据 row 行数 = "+str(daily_20170412.shape[0]))
daily_20170412_addname_dataframe.to_excel(daily_201704_excel_writer,'12_3',index=False)
daily_201704_excel_writer.save()
daily_20170413 = pro.daily(start_date='',end_date='',trade_date='20170413', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20170413_tscode_list = list() 
for ts_code_sh in daily_20170413['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20170413_tscode_list.append(stock_name)
daily_20170413_addname_dataframe=pd.DataFrame()
daily_20170413_addname_dataframe['cname'] = daily_20170413_tscode_list
for table_name in daily_20170413.columns.values.tolist():
    daily_20170413_addname_dataframe[table_name] = daily_20170413[table_name]
print("日线行情-时间为序  daily_20170413 返回数据 row 行数 = "+str(daily_20170413.shape[0]))
daily_20170413_addname_dataframe.to_excel(daily_201704_excel_writer,'13_4',index=False)
daily_201704_excel_writer.save()
daily_20170414 = pro.daily(start_date='',end_date='',trade_date='20170414', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20170414_tscode_list = list() 
for ts_code_sh in daily_20170414['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20170414_tscode_list.append(stock_name)
daily_20170414_addname_dataframe=pd.DataFrame()
daily_20170414_addname_dataframe['cname'] = daily_20170414_tscode_list
for table_name in daily_20170414.columns.values.tolist():
    daily_20170414_addname_dataframe[table_name] = daily_20170414[table_name]
print("日线行情-时间为序  daily_20170414 返回数据 row 行数 = "+str(daily_20170414.shape[0]))
daily_20170414_addname_dataframe.to_excel(daily_201704_excel_writer,'14_5',index=False)
daily_201704_excel_writer.save()
daily_20170417 = pro.daily(start_date='',end_date='',trade_date='20170417', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20170417_tscode_list = list() 
for ts_code_sh in daily_20170417['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20170417_tscode_list.append(stock_name)
daily_20170417_addname_dataframe=pd.DataFrame()
daily_20170417_addname_dataframe['cname'] = daily_20170417_tscode_list
for table_name in daily_20170417.columns.values.tolist():
    daily_20170417_addname_dataframe[table_name] = daily_20170417[table_name]
print("日线行情-时间为序  daily_20170417 返回数据 row 行数 = "+str(daily_20170417.shape[0]))
daily_20170417_addname_dataframe.to_excel(daily_201704_excel_writer,'17_1',index=False)
daily_201704_excel_writer.save()
daily_20170418 = pro.daily(start_date='',end_date='',trade_date='20170418', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20170418_tscode_list = list() 
for ts_code_sh in daily_20170418['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20170418_tscode_list.append(stock_name)
daily_20170418_addname_dataframe=pd.DataFrame()
daily_20170418_addname_dataframe['cname'] = daily_20170418_tscode_list
for table_name in daily_20170418.columns.values.tolist():
    daily_20170418_addname_dataframe[table_name] = daily_20170418[table_name]
print("日线行情-时间为序  daily_20170418 返回数据 row 行数 = "+str(daily_20170418.shape[0]))
daily_20170418_addname_dataframe.to_excel(daily_201704_excel_writer,'18_2',index=False)
daily_201704_excel_writer.save()
daily_20170419 = pro.daily(start_date='',end_date='',trade_date='20170419', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20170419_tscode_list = list() 
for ts_code_sh in daily_20170419['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20170419_tscode_list.append(stock_name)
daily_20170419_addname_dataframe=pd.DataFrame()
daily_20170419_addname_dataframe['cname'] = daily_20170419_tscode_list
for table_name in daily_20170419.columns.values.tolist():
    daily_20170419_addname_dataframe[table_name] = daily_20170419[table_name]
print("日线行情-时间为序  daily_20170419 返回数据 row 行数 = "+str(daily_20170419.shape[0]))
daily_20170419_addname_dataframe.to_excel(daily_201704_excel_writer,'19_3',index=False)
daily_201704_excel_writer.save()
daily_20170420 = pro.daily(start_date='',end_date='',trade_date='20170420', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20170420_tscode_list = list() 
for ts_code_sh in daily_20170420['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20170420_tscode_list.append(stock_name)
daily_20170420_addname_dataframe=pd.DataFrame()
daily_20170420_addname_dataframe['cname'] = daily_20170420_tscode_list
for table_name in daily_20170420.columns.values.tolist():
    daily_20170420_addname_dataframe[table_name] = daily_20170420[table_name]
print("日线行情-时间为序  daily_20170420 返回数据 row 行数 = "+str(daily_20170420.shape[0]))
daily_20170420_addname_dataframe.to_excel(daily_201704_excel_writer,'20_4',index=False)
daily_201704_excel_writer.save()
daily_20170421 = pro.daily(start_date='',end_date='',trade_date='20170421', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20170421_tscode_list = list() 
for ts_code_sh in daily_20170421['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20170421_tscode_list.append(stock_name)
daily_20170421_addname_dataframe=pd.DataFrame()
daily_20170421_addname_dataframe['cname'] = daily_20170421_tscode_list
for table_name in daily_20170421.columns.values.tolist():
    daily_20170421_addname_dataframe[table_name] = daily_20170421[table_name]
print("日线行情-时间为序  daily_20170421 返回数据 row 行数 = "+str(daily_20170421.shape[0]))
daily_20170421_addname_dataframe.to_excel(daily_201704_excel_writer,'21_5',index=False)
daily_201704_excel_writer.save()
daily_20170424 = pro.daily(start_date='',end_date='',trade_date='20170424', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20170424_tscode_list = list() 
for ts_code_sh in daily_20170424['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20170424_tscode_list.append(stock_name)
daily_20170424_addname_dataframe=pd.DataFrame()
daily_20170424_addname_dataframe['cname'] = daily_20170424_tscode_list
for table_name in daily_20170424.columns.values.tolist():
    daily_20170424_addname_dataframe[table_name] = daily_20170424[table_name]
print("日线行情-时间为序  daily_20170424 返回数据 row 行数 = "+str(daily_20170424.shape[0]))
daily_20170424_addname_dataframe.to_excel(daily_201704_excel_writer,'24_1',index=False)
daily_201704_excel_writer.save()
daily_20170425 = pro.daily(start_date='',end_date='',trade_date='20170425', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20170425_tscode_list = list() 
for ts_code_sh in daily_20170425['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20170425_tscode_list.append(stock_name)
daily_20170425_addname_dataframe=pd.DataFrame()
daily_20170425_addname_dataframe['cname'] = daily_20170425_tscode_list
for table_name in daily_20170425.columns.values.tolist():
    daily_20170425_addname_dataframe[table_name] = daily_20170425[table_name]
print("日线行情-时间为序  daily_20170425 返回数据 row 行数 = "+str(daily_20170425.shape[0]))
daily_20170425_addname_dataframe.to_excel(daily_201704_excel_writer,'25_2',index=False)
daily_201704_excel_writer.save()
daily_20170426 = pro.daily(start_date='',end_date='',trade_date='20170426', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20170426_tscode_list = list() 
for ts_code_sh in daily_20170426['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20170426_tscode_list.append(stock_name)
daily_20170426_addname_dataframe=pd.DataFrame()
daily_20170426_addname_dataframe['cname'] = daily_20170426_tscode_list
for table_name in daily_20170426.columns.values.tolist():
    daily_20170426_addname_dataframe[table_name] = daily_20170426[table_name]
print("日线行情-时间为序  daily_20170426 返回数据 row 行数 = "+str(daily_20170426.shape[0]))
daily_20170426_addname_dataframe.to_excel(daily_201704_excel_writer,'26_3',index=False)
daily_201704_excel_writer.save()
daily_20170427 = pro.daily(start_date='',end_date='',trade_date='20170427', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20170427_tscode_list = list() 
for ts_code_sh in daily_20170427['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20170427_tscode_list.append(stock_name)
daily_20170427_addname_dataframe=pd.DataFrame()
daily_20170427_addname_dataframe['cname'] = daily_20170427_tscode_list
for table_name in daily_20170427.columns.values.tolist():
    daily_20170427_addname_dataframe[table_name] = daily_20170427[table_name]
print("日线行情-时间为序  daily_20170427 返回数据 row 行数 = "+str(daily_20170427.shape[0]))
daily_20170427_addname_dataframe.to_excel(daily_201704_excel_writer,'27_4',index=False)
daily_201704_excel_writer.save()
daily_20170428 = pro.daily(start_date='',end_date='',trade_date='20170428', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20170428_tscode_list = list() 
for ts_code_sh in daily_20170428['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20170428_tscode_list.append(stock_name)
daily_20170428_addname_dataframe=pd.DataFrame()
daily_20170428_addname_dataframe['cname'] = daily_20170428_tscode_list
for table_name in daily_20170428.columns.values.tolist():
    daily_20170428_addname_dataframe[table_name] = daily_20170428[table_name]
print("日线行情-时间为序  daily_20170428 返回数据 row 行数 = "+str(daily_20170428.shape[0]))
daily_20170428_addname_dataframe.to_excel(daily_201704_excel_writer,'28_5',index=False)
daily_201704_excel_writer.save()




createexcel('daily_201705.xlsx')
daily_201705_book = load_workbook('C:\\Users\\zhuzj5\\Desktop\\zbin\\J0_Data\\daily_201705.xlsx')
daily_201705_excel_writer = pd.ExcelWriter('C:\\Users\\zhuzj5\\Desktop\\zbin\\J0_Data\\daily_201705.xlsx', engine='openpyxl')
daily_201705_excel_writer.book = daily_201705_book
daily_201705_excel_writer.sheets = dict((ws.title, ws) for ws in daily_201705_book.worksheets)
J0_PROPS.put(tree_node_name+"record_date", "20170501")       ###  更新 记录日期
daily_20170502 = pro.daily(start_date='',end_date='',trade_date='20170502', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20170502_tscode_list = list() 
for ts_code_sh in daily_20170502['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20170502_tscode_list.append(stock_name)
daily_20170502_addname_dataframe=pd.DataFrame()
daily_20170502_addname_dataframe['cname'] = daily_20170502_tscode_list
for table_name in daily_20170502.columns.values.tolist():
    daily_20170502_addname_dataframe[table_name] = daily_20170502[table_name]
print("日线行情-时间为序  daily_20170502 返回数据 row 行数 = "+str(daily_20170502.shape[0]))
daily_20170502_addname_dataframe.to_excel(daily_201705_excel_writer,'2_2',index=False)
daily_201705_excel_writer.save()
daily_20170503 = pro.daily(start_date='',end_date='',trade_date='20170503', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20170503_tscode_list = list() 
for ts_code_sh in daily_20170503['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20170503_tscode_list.append(stock_name)
daily_20170503_addname_dataframe=pd.DataFrame()
daily_20170503_addname_dataframe['cname'] = daily_20170503_tscode_list
for table_name in daily_20170503.columns.values.tolist():
    daily_20170503_addname_dataframe[table_name] = daily_20170503[table_name]
print("日线行情-时间为序  daily_20170503 返回数据 row 行数 = "+str(daily_20170503.shape[0]))
daily_20170503_addname_dataframe.to_excel(daily_201705_excel_writer,'3_3',index=False)
daily_201705_excel_writer.save()
daily_20170504 = pro.daily(start_date='',end_date='',trade_date='20170504', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20170504_tscode_list = list() 
for ts_code_sh in daily_20170504['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20170504_tscode_list.append(stock_name)
daily_20170504_addname_dataframe=pd.DataFrame()
daily_20170504_addname_dataframe['cname'] = daily_20170504_tscode_list
for table_name in daily_20170504.columns.values.tolist():
    daily_20170504_addname_dataframe[table_name] = daily_20170504[table_name]
print("日线行情-时间为序  daily_20170504 返回数据 row 行数 = "+str(daily_20170504.shape[0]))
daily_20170504_addname_dataframe.to_excel(daily_201705_excel_writer,'4_4',index=False)
daily_201705_excel_writer.save()
daily_20170505 = pro.daily(start_date='',end_date='',trade_date='20170505', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20170505_tscode_list = list() 
for ts_code_sh in daily_20170505['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20170505_tscode_list.append(stock_name)
daily_20170505_addname_dataframe=pd.DataFrame()
daily_20170505_addname_dataframe['cname'] = daily_20170505_tscode_list
for table_name in daily_20170505.columns.values.tolist():
    daily_20170505_addname_dataframe[table_name] = daily_20170505[table_name]
print("日线行情-时间为序  daily_20170505 返回数据 row 行数 = "+str(daily_20170505.shape[0]))
daily_20170505_addname_dataframe.to_excel(daily_201705_excel_writer,'5_5',index=False)
daily_201705_excel_writer.save()
daily_20170508 = pro.daily(start_date='',end_date='',trade_date='20170508', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20170508_tscode_list = list() 
for ts_code_sh in daily_20170508['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20170508_tscode_list.append(stock_name)
daily_20170508_addname_dataframe=pd.DataFrame()
daily_20170508_addname_dataframe['cname'] = daily_20170508_tscode_list
for table_name in daily_20170508.columns.values.tolist():
    daily_20170508_addname_dataframe[table_name] = daily_20170508[table_name]
print("日线行情-时间为序  daily_20170508 返回数据 row 行数 = "+str(daily_20170508.shape[0]))
daily_20170508_addname_dataframe.to_excel(daily_201705_excel_writer,'8_1',index=False)
daily_201705_excel_writer.save()
daily_20170509 = pro.daily(start_date='',end_date='',trade_date='20170509', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20170509_tscode_list = list() 
for ts_code_sh in daily_20170509['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20170509_tscode_list.append(stock_name)
daily_20170509_addname_dataframe=pd.DataFrame()
daily_20170509_addname_dataframe['cname'] = daily_20170509_tscode_list
for table_name in daily_20170509.columns.values.tolist():
    daily_20170509_addname_dataframe[table_name] = daily_20170509[table_name]
print("日线行情-时间为序  daily_20170509 返回数据 row 行数 = "+str(daily_20170509.shape[0]))
daily_20170509_addname_dataframe.to_excel(daily_201705_excel_writer,'9_2',index=False)
daily_201705_excel_writer.save()
daily_20170510 = pro.daily(start_date='',end_date='',trade_date='20170510', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20170510_tscode_list = list() 
for ts_code_sh in daily_20170510['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20170510_tscode_list.append(stock_name)
daily_20170510_addname_dataframe=pd.DataFrame()
daily_20170510_addname_dataframe['cname'] = daily_20170510_tscode_list
for table_name in daily_20170510.columns.values.tolist():
    daily_20170510_addname_dataframe[table_name] = daily_20170510[table_name]
print("日线行情-时间为序  daily_20170510 返回数据 row 行数 = "+str(daily_20170510.shape[0]))
daily_20170510_addname_dataframe.to_excel(daily_201705_excel_writer,'10_3',index=False)
daily_201705_excel_writer.save()
daily_20170511 = pro.daily(start_date='',end_date='',trade_date='20170511', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20170511_tscode_list = list() 
for ts_code_sh in daily_20170511['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20170511_tscode_list.append(stock_name)
daily_20170511_addname_dataframe=pd.DataFrame()
daily_20170511_addname_dataframe['cname'] = daily_20170511_tscode_list
for table_name in daily_20170511.columns.values.tolist():
    daily_20170511_addname_dataframe[table_name] = daily_20170511[table_name]
print("日线行情-时间为序  daily_20170511 返回数据 row 行数 = "+str(daily_20170511.shape[0]))
daily_20170511_addname_dataframe.to_excel(daily_201705_excel_writer,'11_4',index=False)
daily_201705_excel_writer.save()
daily_20170512 = pro.daily(start_date='',end_date='',trade_date='20170512', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20170512_tscode_list = list() 
for ts_code_sh in daily_20170512['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20170512_tscode_list.append(stock_name)
daily_20170512_addname_dataframe=pd.DataFrame()
daily_20170512_addname_dataframe['cname'] = daily_20170512_tscode_list
for table_name in daily_20170512.columns.values.tolist():
    daily_20170512_addname_dataframe[table_name] = daily_20170512[table_name]
print("日线行情-时间为序  daily_20170512 返回数据 row 行数 = "+str(daily_20170512.shape[0]))
daily_20170512_addname_dataframe.to_excel(daily_201705_excel_writer,'12_5',index=False)
daily_201705_excel_writer.save()
daily_20170515 = pro.daily(start_date='',end_date='',trade_date='20170515', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20170515_tscode_list = list() 
for ts_code_sh in daily_20170515['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20170515_tscode_list.append(stock_name)
daily_20170515_addname_dataframe=pd.DataFrame()
daily_20170515_addname_dataframe['cname'] = daily_20170515_tscode_list
for table_name in daily_20170515.columns.values.tolist():
    daily_20170515_addname_dataframe[table_name] = daily_20170515[table_name]
print("日线行情-时间为序  daily_20170515 返回数据 row 行数 = "+str(daily_20170515.shape[0]))
daily_20170515_addname_dataframe.to_excel(daily_201705_excel_writer,'15_1',index=False)
daily_201705_excel_writer.save()
daily_20170516 = pro.daily(start_date='',end_date='',trade_date='20170516', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20170516_tscode_list = list() 
for ts_code_sh in daily_20170516['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20170516_tscode_list.append(stock_name)
daily_20170516_addname_dataframe=pd.DataFrame()
daily_20170516_addname_dataframe['cname'] = daily_20170516_tscode_list
for table_name in daily_20170516.columns.values.tolist():
    daily_20170516_addname_dataframe[table_name] = daily_20170516[table_name]
print("日线行情-时间为序  daily_20170516 返回数据 row 行数 = "+str(daily_20170516.shape[0]))
daily_20170516_addname_dataframe.to_excel(daily_201705_excel_writer,'16_2',index=False)
daily_201705_excel_writer.save()
daily_20170517 = pro.daily(start_date='',end_date='',trade_date='20170517', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20170517_tscode_list = list() 
for ts_code_sh in daily_20170517['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20170517_tscode_list.append(stock_name)
daily_20170517_addname_dataframe=pd.DataFrame()
daily_20170517_addname_dataframe['cname'] = daily_20170517_tscode_list
for table_name in daily_20170517.columns.values.tolist():
    daily_20170517_addname_dataframe[table_name] = daily_20170517[table_name]
print("日线行情-时间为序  daily_20170517 返回数据 row 行数 = "+str(daily_20170517.shape[0]))
daily_20170517_addname_dataframe.to_excel(daily_201705_excel_writer,'17_3',index=False)
daily_201705_excel_writer.save()
daily_20170518 = pro.daily(start_date='',end_date='',trade_date='20170518', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20170518_tscode_list = list() 
for ts_code_sh in daily_20170518['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20170518_tscode_list.append(stock_name)
daily_20170518_addname_dataframe=pd.DataFrame()
daily_20170518_addname_dataframe['cname'] = daily_20170518_tscode_list
for table_name in daily_20170518.columns.values.tolist():
    daily_20170518_addname_dataframe[table_name] = daily_20170518[table_name]
print("日线行情-时间为序  daily_20170518 返回数据 row 行数 = "+str(daily_20170518.shape[0]))
daily_20170518_addname_dataframe.to_excel(daily_201705_excel_writer,'18_4',index=False)
daily_201705_excel_writer.save()
daily_20170519 = pro.daily(start_date='',end_date='',trade_date='20170519', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20170519_tscode_list = list() 
for ts_code_sh in daily_20170519['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20170519_tscode_list.append(stock_name)
daily_20170519_addname_dataframe=pd.DataFrame()
daily_20170519_addname_dataframe['cname'] = daily_20170519_tscode_list
for table_name in daily_20170519.columns.values.tolist():
    daily_20170519_addname_dataframe[table_name] = daily_20170519[table_name]
print("日线行情-时间为序  daily_20170519 返回数据 row 行数 = "+str(daily_20170519.shape[0]))
daily_20170519_addname_dataframe.to_excel(daily_201705_excel_writer,'19_5',index=False)
daily_201705_excel_writer.save()
daily_20170522 = pro.daily(start_date='',end_date='',trade_date='20170522', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20170522_tscode_list = list() 
for ts_code_sh in daily_20170522['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20170522_tscode_list.append(stock_name)
daily_20170522_addname_dataframe=pd.DataFrame()
daily_20170522_addname_dataframe['cname'] = daily_20170522_tscode_list
for table_name in daily_20170522.columns.values.tolist():
    daily_20170522_addname_dataframe[table_name] = daily_20170522[table_name]
print("日线行情-时间为序  daily_20170522 返回数据 row 行数 = "+str(daily_20170522.shape[0]))
daily_20170522_addname_dataframe.to_excel(daily_201705_excel_writer,'22_1',index=False)
daily_201705_excel_writer.save()
daily_20170523 = pro.daily(start_date='',end_date='',trade_date='20170523', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20170523_tscode_list = list() 
for ts_code_sh in daily_20170523['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20170523_tscode_list.append(stock_name)
daily_20170523_addname_dataframe=pd.DataFrame()
daily_20170523_addname_dataframe['cname'] = daily_20170523_tscode_list
for table_name in daily_20170523.columns.values.tolist():
    daily_20170523_addname_dataframe[table_name] = daily_20170523[table_name]
print("日线行情-时间为序  daily_20170523 返回数据 row 行数 = "+str(daily_20170523.shape[0]))
daily_20170523_addname_dataframe.to_excel(daily_201705_excel_writer,'23_2',index=False)
daily_201705_excel_writer.save()
daily_20170524 = pro.daily(start_date='',end_date='',trade_date='20170524', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20170524_tscode_list = list() 
for ts_code_sh in daily_20170524['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20170524_tscode_list.append(stock_name)
daily_20170524_addname_dataframe=pd.DataFrame()
daily_20170524_addname_dataframe['cname'] = daily_20170524_tscode_list
for table_name in daily_20170524.columns.values.tolist():
    daily_20170524_addname_dataframe[table_name] = daily_20170524[table_name]
print("日线行情-时间为序  daily_20170524 返回数据 row 行数 = "+str(daily_20170524.shape[0]))
daily_20170524_addname_dataframe.to_excel(daily_201705_excel_writer,'24_3',index=False)
daily_201705_excel_writer.save()
daily_20170525 = pro.daily(start_date='',end_date='',trade_date='20170525', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20170525_tscode_list = list() 
for ts_code_sh in daily_20170525['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20170525_tscode_list.append(stock_name)
daily_20170525_addname_dataframe=pd.DataFrame()
daily_20170525_addname_dataframe['cname'] = daily_20170525_tscode_list
for table_name in daily_20170525.columns.values.tolist():
    daily_20170525_addname_dataframe[table_name] = daily_20170525[table_name]
print("日线行情-时间为序  daily_20170525 返回数据 row 行数 = "+str(daily_20170525.shape[0]))
daily_20170525_addname_dataframe.to_excel(daily_201705_excel_writer,'25_4',index=False)
daily_201705_excel_writer.save()
daily_20170526 = pro.daily(start_date='',end_date='',trade_date='20170526', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20170526_tscode_list = list() 
for ts_code_sh in daily_20170526['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20170526_tscode_list.append(stock_name)
daily_20170526_addname_dataframe=pd.DataFrame()
daily_20170526_addname_dataframe['cname'] = daily_20170526_tscode_list
for table_name in daily_20170526.columns.values.tolist():
    daily_20170526_addname_dataframe[table_name] = daily_20170526[table_name]
print("日线行情-时间为序  daily_20170526 返回数据 row 行数 = "+str(daily_20170526.shape[0]))
daily_20170526_addname_dataframe.to_excel(daily_201705_excel_writer,'26_5',index=False)
daily_201705_excel_writer.save()
daily_20170531 = pro.daily(start_date='',end_date='',trade_date='20170531', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20170531_tscode_list = list() 
for ts_code_sh in daily_20170531['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20170531_tscode_list.append(stock_name)
daily_20170531_addname_dataframe=pd.DataFrame()
daily_20170531_addname_dataframe['cname'] = daily_20170531_tscode_list
for table_name in daily_20170531.columns.values.tolist():
    daily_20170531_addname_dataframe[table_name] = daily_20170531[table_name]
print("日线行情-时间为序  daily_20170531 返回数据 row 行数 = "+str(daily_20170531.shape[0]))
daily_20170531_addname_dataframe.to_excel(daily_201705_excel_writer,'31_3',index=False)
daily_201705_excel_writer.save()




createexcel('daily_201706.xlsx')
daily_201706_book = load_workbook('C:\\Users\\zhuzj5\\Desktop\\zbin\\J0_Data\\daily_201706.xlsx')
daily_201706_excel_writer = pd.ExcelWriter('C:\\Users\\zhuzj5\\Desktop\\zbin\\J0_Data\\daily_201706.xlsx', engine='openpyxl')
daily_201706_excel_writer.book = daily_201706_book
daily_201706_excel_writer.sheets = dict((ws.title, ws) for ws in daily_201706_book.worksheets)
J0_PROPS.put(tree_node_name+"record_date", "20170601")       ###  更新 记录日期
daily_20170601 = pro.daily(start_date='',end_date='',trade_date='20170601', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20170601_tscode_list = list() 
for ts_code_sh in daily_20170601['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20170601_tscode_list.append(stock_name)
daily_20170601_addname_dataframe=pd.DataFrame()
daily_20170601_addname_dataframe['cname'] = daily_20170601_tscode_list
for table_name in daily_20170601.columns.values.tolist():
    daily_20170601_addname_dataframe[table_name] = daily_20170601[table_name]
print("日线行情-时间为序  daily_20170601 返回数据 row 行数 = "+str(daily_20170601.shape[0]))
daily_20170601_addname_dataframe.to_excel(daily_201706_excel_writer,'1_4',index=False)
daily_201706_excel_writer.save()
daily_20170602 = pro.daily(start_date='',end_date='',trade_date='20170602', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20170602_tscode_list = list() 
for ts_code_sh in daily_20170602['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20170602_tscode_list.append(stock_name)
daily_20170602_addname_dataframe=pd.DataFrame()
daily_20170602_addname_dataframe['cname'] = daily_20170602_tscode_list
for table_name in daily_20170602.columns.values.tolist():
    daily_20170602_addname_dataframe[table_name] = daily_20170602[table_name]
print("日线行情-时间为序  daily_20170602 返回数据 row 行数 = "+str(daily_20170602.shape[0]))
daily_20170602_addname_dataframe.to_excel(daily_201706_excel_writer,'2_5',index=False)
daily_201706_excel_writer.save()
daily_20170605 = pro.daily(start_date='',end_date='',trade_date='20170605', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20170605_tscode_list = list() 
for ts_code_sh in daily_20170605['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20170605_tscode_list.append(stock_name)
daily_20170605_addname_dataframe=pd.DataFrame()
daily_20170605_addname_dataframe['cname'] = daily_20170605_tscode_list
for table_name in daily_20170605.columns.values.tolist():
    daily_20170605_addname_dataframe[table_name] = daily_20170605[table_name]
print("日线行情-时间为序  daily_20170605 返回数据 row 行数 = "+str(daily_20170605.shape[0]))
daily_20170605_addname_dataframe.to_excel(daily_201706_excel_writer,'5_1',index=False)
daily_201706_excel_writer.save()
daily_20170606 = pro.daily(start_date='',end_date='',trade_date='20170606', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20170606_tscode_list = list() 
for ts_code_sh in daily_20170606['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20170606_tscode_list.append(stock_name)
daily_20170606_addname_dataframe=pd.DataFrame()
daily_20170606_addname_dataframe['cname'] = daily_20170606_tscode_list
for table_name in daily_20170606.columns.values.tolist():
    daily_20170606_addname_dataframe[table_name] = daily_20170606[table_name]
print("日线行情-时间为序  daily_20170606 返回数据 row 行数 = "+str(daily_20170606.shape[0]))
daily_20170606_addname_dataframe.to_excel(daily_201706_excel_writer,'6_2',index=False)
daily_201706_excel_writer.save()
daily_20170607 = pro.daily(start_date='',end_date='',trade_date='20170607', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20170607_tscode_list = list() 
for ts_code_sh in daily_20170607['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20170607_tscode_list.append(stock_name)
daily_20170607_addname_dataframe=pd.DataFrame()
daily_20170607_addname_dataframe['cname'] = daily_20170607_tscode_list
for table_name in daily_20170607.columns.values.tolist():
    daily_20170607_addname_dataframe[table_name] = daily_20170607[table_name]
print("日线行情-时间为序  daily_20170607 返回数据 row 行数 = "+str(daily_20170607.shape[0]))
daily_20170607_addname_dataframe.to_excel(daily_201706_excel_writer,'7_3',index=False)
daily_201706_excel_writer.save()
daily_20170608 = pro.daily(start_date='',end_date='',trade_date='20170608', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20170608_tscode_list = list() 
for ts_code_sh in daily_20170608['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20170608_tscode_list.append(stock_name)
daily_20170608_addname_dataframe=pd.DataFrame()
daily_20170608_addname_dataframe['cname'] = daily_20170608_tscode_list
for table_name in daily_20170608.columns.values.tolist():
    daily_20170608_addname_dataframe[table_name] = daily_20170608[table_name]
print("日线行情-时间为序  daily_20170608 返回数据 row 行数 = "+str(daily_20170608.shape[0]))
daily_20170608_addname_dataframe.to_excel(daily_201706_excel_writer,'8_4',index=False)
daily_201706_excel_writer.save()
daily_20170609 = pro.daily(start_date='',end_date='',trade_date='20170609', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20170609_tscode_list = list() 
for ts_code_sh in daily_20170609['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20170609_tscode_list.append(stock_name)
daily_20170609_addname_dataframe=pd.DataFrame()
daily_20170609_addname_dataframe['cname'] = daily_20170609_tscode_list
for table_name in daily_20170609.columns.values.tolist():
    daily_20170609_addname_dataframe[table_name] = daily_20170609[table_name]
print("日线行情-时间为序  daily_20170609 返回数据 row 行数 = "+str(daily_20170609.shape[0]))
daily_20170609_addname_dataframe.to_excel(daily_201706_excel_writer,'9_5',index=False)
daily_201706_excel_writer.save()
daily_20170612 = pro.daily(start_date='',end_date='',trade_date='20170612', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20170612_tscode_list = list() 
for ts_code_sh in daily_20170612['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20170612_tscode_list.append(stock_name)
daily_20170612_addname_dataframe=pd.DataFrame()
daily_20170612_addname_dataframe['cname'] = daily_20170612_tscode_list
for table_name in daily_20170612.columns.values.tolist():
    daily_20170612_addname_dataframe[table_name] = daily_20170612[table_name]
print("日线行情-时间为序  daily_20170612 返回数据 row 行数 = "+str(daily_20170612.shape[0]))
daily_20170612_addname_dataframe.to_excel(daily_201706_excel_writer,'12_1',index=False)
daily_201706_excel_writer.save()
daily_20170613 = pro.daily(start_date='',end_date='',trade_date='20170613', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20170613_tscode_list = list() 
for ts_code_sh in daily_20170613['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20170613_tscode_list.append(stock_name)
daily_20170613_addname_dataframe=pd.DataFrame()
daily_20170613_addname_dataframe['cname'] = daily_20170613_tscode_list
for table_name in daily_20170613.columns.values.tolist():
    daily_20170613_addname_dataframe[table_name] = daily_20170613[table_name]
print("日线行情-时间为序  daily_20170613 返回数据 row 行数 = "+str(daily_20170613.shape[0]))
daily_20170613_addname_dataframe.to_excel(daily_201706_excel_writer,'13_2',index=False)
daily_201706_excel_writer.save()
daily_20170614 = pro.daily(start_date='',end_date='',trade_date='20170614', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20170614_tscode_list = list() 
for ts_code_sh in daily_20170614['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20170614_tscode_list.append(stock_name)
daily_20170614_addname_dataframe=pd.DataFrame()
daily_20170614_addname_dataframe['cname'] = daily_20170614_tscode_list
for table_name in daily_20170614.columns.values.tolist():
    daily_20170614_addname_dataframe[table_name] = daily_20170614[table_name]
print("日线行情-时间为序  daily_20170614 返回数据 row 行数 = "+str(daily_20170614.shape[0]))
daily_20170614_addname_dataframe.to_excel(daily_201706_excel_writer,'14_3',index=False)
daily_201706_excel_writer.save()
daily_20170615 = pro.daily(start_date='',end_date='',trade_date='20170615', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20170615_tscode_list = list() 
for ts_code_sh in daily_20170615['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20170615_tscode_list.append(stock_name)
daily_20170615_addname_dataframe=pd.DataFrame()
daily_20170615_addname_dataframe['cname'] = daily_20170615_tscode_list
for table_name in daily_20170615.columns.values.tolist():
    daily_20170615_addname_dataframe[table_name] = daily_20170615[table_name]
print("日线行情-时间为序  daily_20170615 返回数据 row 行数 = "+str(daily_20170615.shape[0]))
daily_20170615_addname_dataframe.to_excel(daily_201706_excel_writer,'15_4',index=False)
daily_201706_excel_writer.save()
daily_20170616 = pro.daily(start_date='',end_date='',trade_date='20170616', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20170616_tscode_list = list() 
for ts_code_sh in daily_20170616['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20170616_tscode_list.append(stock_name)
daily_20170616_addname_dataframe=pd.DataFrame()
daily_20170616_addname_dataframe['cname'] = daily_20170616_tscode_list
for table_name in daily_20170616.columns.values.tolist():
    daily_20170616_addname_dataframe[table_name] = daily_20170616[table_name]
print("日线行情-时间为序  daily_20170616 返回数据 row 行数 = "+str(daily_20170616.shape[0]))
daily_20170616_addname_dataframe.to_excel(daily_201706_excel_writer,'16_5',index=False)
daily_201706_excel_writer.save()
daily_20170619 = pro.daily(start_date='',end_date='',trade_date='20170619', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20170619_tscode_list = list() 
for ts_code_sh in daily_20170619['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20170619_tscode_list.append(stock_name)
daily_20170619_addname_dataframe=pd.DataFrame()
daily_20170619_addname_dataframe['cname'] = daily_20170619_tscode_list
for table_name in daily_20170619.columns.values.tolist():
    daily_20170619_addname_dataframe[table_name] = daily_20170619[table_name]
print("日线行情-时间为序  daily_20170619 返回数据 row 行数 = "+str(daily_20170619.shape[0]))
daily_20170619_addname_dataframe.to_excel(daily_201706_excel_writer,'19_1',index=False)
daily_201706_excel_writer.save()
daily_20170620 = pro.daily(start_date='',end_date='',trade_date='20170620', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20170620_tscode_list = list() 
for ts_code_sh in daily_20170620['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20170620_tscode_list.append(stock_name)
daily_20170620_addname_dataframe=pd.DataFrame()
daily_20170620_addname_dataframe['cname'] = daily_20170620_tscode_list
for table_name in daily_20170620.columns.values.tolist():
    daily_20170620_addname_dataframe[table_name] = daily_20170620[table_name]
print("日线行情-时间为序  daily_20170620 返回数据 row 行数 = "+str(daily_20170620.shape[0]))
daily_20170620_addname_dataframe.to_excel(daily_201706_excel_writer,'20_2',index=False)
daily_201706_excel_writer.save()
daily_20170621 = pro.daily(start_date='',end_date='',trade_date='20170621', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20170621_tscode_list = list() 
for ts_code_sh in daily_20170621['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20170621_tscode_list.append(stock_name)
daily_20170621_addname_dataframe=pd.DataFrame()
daily_20170621_addname_dataframe['cname'] = daily_20170621_tscode_list
for table_name in daily_20170621.columns.values.tolist():
    daily_20170621_addname_dataframe[table_name] = daily_20170621[table_name]
print("日线行情-时间为序  daily_20170621 返回数据 row 行数 = "+str(daily_20170621.shape[0]))
daily_20170621_addname_dataframe.to_excel(daily_201706_excel_writer,'21_3',index=False)
daily_201706_excel_writer.save()
daily_20170622 = pro.daily(start_date='',end_date='',trade_date='20170622', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20170622_tscode_list = list() 
for ts_code_sh in daily_20170622['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20170622_tscode_list.append(stock_name)
daily_20170622_addname_dataframe=pd.DataFrame()
daily_20170622_addname_dataframe['cname'] = daily_20170622_tscode_list
for table_name in daily_20170622.columns.values.tolist():
    daily_20170622_addname_dataframe[table_name] = daily_20170622[table_name]
print("日线行情-时间为序  daily_20170622 返回数据 row 行数 = "+str(daily_20170622.shape[0]))
daily_20170622_addname_dataframe.to_excel(daily_201706_excel_writer,'22_4',index=False)
daily_201706_excel_writer.save()
daily_20170623 = pro.daily(start_date='',end_date='',trade_date='20170623', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20170623_tscode_list = list() 
for ts_code_sh in daily_20170623['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20170623_tscode_list.append(stock_name)
daily_20170623_addname_dataframe=pd.DataFrame()
daily_20170623_addname_dataframe['cname'] = daily_20170623_tscode_list
for table_name in daily_20170623.columns.values.tolist():
    daily_20170623_addname_dataframe[table_name] = daily_20170623[table_name]
print("日线行情-时间为序  daily_20170623 返回数据 row 行数 = "+str(daily_20170623.shape[0]))
daily_20170623_addname_dataframe.to_excel(daily_201706_excel_writer,'23_5',index=False)
daily_201706_excel_writer.save()
daily_20170626 = pro.daily(start_date='',end_date='',trade_date='20170626', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20170626_tscode_list = list() 
for ts_code_sh in daily_20170626['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20170626_tscode_list.append(stock_name)
daily_20170626_addname_dataframe=pd.DataFrame()
daily_20170626_addname_dataframe['cname'] = daily_20170626_tscode_list
for table_name in daily_20170626.columns.values.tolist():
    daily_20170626_addname_dataframe[table_name] = daily_20170626[table_name]
print("日线行情-时间为序  daily_20170626 返回数据 row 行数 = "+str(daily_20170626.shape[0]))
daily_20170626_addname_dataframe.to_excel(daily_201706_excel_writer,'26_1',index=False)
daily_201706_excel_writer.save()
daily_20170627 = pro.daily(start_date='',end_date='',trade_date='20170627', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20170627_tscode_list = list() 
for ts_code_sh in daily_20170627['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20170627_tscode_list.append(stock_name)
daily_20170627_addname_dataframe=pd.DataFrame()
daily_20170627_addname_dataframe['cname'] = daily_20170627_tscode_list
for table_name in daily_20170627.columns.values.tolist():
    daily_20170627_addname_dataframe[table_name] = daily_20170627[table_name]
print("日线行情-时间为序  daily_20170627 返回数据 row 行数 = "+str(daily_20170627.shape[0]))
daily_20170627_addname_dataframe.to_excel(daily_201706_excel_writer,'27_2',index=False)
daily_201706_excel_writer.save()
daily_20170628 = pro.daily(start_date='',end_date='',trade_date='20170628', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20170628_tscode_list = list() 
for ts_code_sh in daily_20170628['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20170628_tscode_list.append(stock_name)
daily_20170628_addname_dataframe=pd.DataFrame()
daily_20170628_addname_dataframe['cname'] = daily_20170628_tscode_list
for table_name in daily_20170628.columns.values.tolist():
    daily_20170628_addname_dataframe[table_name] = daily_20170628[table_name]
print("日线行情-时间为序  daily_20170628 返回数据 row 行数 = "+str(daily_20170628.shape[0]))
daily_20170628_addname_dataframe.to_excel(daily_201706_excel_writer,'28_3',index=False)
daily_201706_excel_writer.save()
daily_20170629 = pro.daily(start_date='',end_date='',trade_date='20170629', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20170629_tscode_list = list() 
for ts_code_sh in daily_20170629['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20170629_tscode_list.append(stock_name)
daily_20170629_addname_dataframe=pd.DataFrame()
daily_20170629_addname_dataframe['cname'] = daily_20170629_tscode_list
for table_name in daily_20170629.columns.values.tolist():
    daily_20170629_addname_dataframe[table_name] = daily_20170629[table_name]
print("日线行情-时间为序  daily_20170629 返回数据 row 行数 = "+str(daily_20170629.shape[0]))
daily_20170629_addname_dataframe.to_excel(daily_201706_excel_writer,'29_4',index=False)
daily_201706_excel_writer.save()
daily_20170630 = pro.daily(start_date='',end_date='',trade_date='20170630', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20170630_tscode_list = list() 
for ts_code_sh in daily_20170630['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20170630_tscode_list.append(stock_name)
daily_20170630_addname_dataframe=pd.DataFrame()
daily_20170630_addname_dataframe['cname'] = daily_20170630_tscode_list
for table_name in daily_20170630.columns.values.tolist():
    daily_20170630_addname_dataframe[table_name] = daily_20170630[table_name]
print("日线行情-时间为序  daily_20170630 返回数据 row 行数 = "+str(daily_20170630.shape[0]))
daily_20170630_addname_dataframe.to_excel(daily_201706_excel_writer,'30_5',index=False)
daily_201706_excel_writer.save()




createexcel('daily_201707.xlsx')
daily_201707_book = load_workbook('C:\\Users\\zhuzj5\\Desktop\\zbin\\J0_Data\\daily_201707.xlsx')
daily_201707_excel_writer = pd.ExcelWriter('C:\\Users\\zhuzj5\\Desktop\\zbin\\J0_Data\\daily_201707.xlsx', engine='openpyxl')
daily_201707_excel_writer.book = daily_201707_book
daily_201707_excel_writer.sheets = dict((ws.title, ws) for ws in daily_201707_book.worksheets)
J0_PROPS.put(tree_node_name+"record_date", "20170701")       ###  更新 记录日期
daily_20170703 = pro.daily(start_date='',end_date='',trade_date='20170703', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20170703_tscode_list = list() 
for ts_code_sh in daily_20170703['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20170703_tscode_list.append(stock_name)
daily_20170703_addname_dataframe=pd.DataFrame()
daily_20170703_addname_dataframe['cname'] = daily_20170703_tscode_list
for table_name in daily_20170703.columns.values.tolist():
    daily_20170703_addname_dataframe[table_name] = daily_20170703[table_name]
print("日线行情-时间为序  daily_20170703 返回数据 row 行数 = "+str(daily_20170703.shape[0]))
daily_20170703_addname_dataframe.to_excel(daily_201707_excel_writer,'3_1',index=False)
daily_201707_excel_writer.save()
daily_20170704 = pro.daily(start_date='',end_date='',trade_date='20170704', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20170704_tscode_list = list() 
for ts_code_sh in daily_20170704['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20170704_tscode_list.append(stock_name)
daily_20170704_addname_dataframe=pd.DataFrame()
daily_20170704_addname_dataframe['cname'] = daily_20170704_tscode_list
for table_name in daily_20170704.columns.values.tolist():
    daily_20170704_addname_dataframe[table_name] = daily_20170704[table_name]
print("日线行情-时间为序  daily_20170704 返回数据 row 行数 = "+str(daily_20170704.shape[0]))
daily_20170704_addname_dataframe.to_excel(daily_201707_excel_writer,'4_2',index=False)
daily_201707_excel_writer.save()
daily_20170705 = pro.daily(start_date='',end_date='',trade_date='20170705', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20170705_tscode_list = list() 
for ts_code_sh in daily_20170705['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20170705_tscode_list.append(stock_name)
daily_20170705_addname_dataframe=pd.DataFrame()
daily_20170705_addname_dataframe['cname'] = daily_20170705_tscode_list
for table_name in daily_20170705.columns.values.tolist():
    daily_20170705_addname_dataframe[table_name] = daily_20170705[table_name]
print("日线行情-时间为序  daily_20170705 返回数据 row 行数 = "+str(daily_20170705.shape[0]))
daily_20170705_addname_dataframe.to_excel(daily_201707_excel_writer,'5_3',index=False)
daily_201707_excel_writer.save()
daily_20170706 = pro.daily(start_date='',end_date='',trade_date='20170706', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20170706_tscode_list = list() 
for ts_code_sh in daily_20170706['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20170706_tscode_list.append(stock_name)
daily_20170706_addname_dataframe=pd.DataFrame()
daily_20170706_addname_dataframe['cname'] = daily_20170706_tscode_list
for table_name in daily_20170706.columns.values.tolist():
    daily_20170706_addname_dataframe[table_name] = daily_20170706[table_name]
print("日线行情-时间为序  daily_20170706 返回数据 row 行数 = "+str(daily_20170706.shape[0]))
daily_20170706_addname_dataframe.to_excel(daily_201707_excel_writer,'6_4',index=False)
daily_201707_excel_writer.save()
daily_20170707 = pro.daily(start_date='',end_date='',trade_date='20170707', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20170707_tscode_list = list() 
for ts_code_sh in daily_20170707['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20170707_tscode_list.append(stock_name)
daily_20170707_addname_dataframe=pd.DataFrame()
daily_20170707_addname_dataframe['cname'] = daily_20170707_tscode_list
for table_name in daily_20170707.columns.values.tolist():
    daily_20170707_addname_dataframe[table_name] = daily_20170707[table_name]
print("日线行情-时间为序  daily_20170707 返回数据 row 行数 = "+str(daily_20170707.shape[0]))
daily_20170707_addname_dataframe.to_excel(daily_201707_excel_writer,'7_5',index=False)
daily_201707_excel_writer.save()
daily_20170710 = pro.daily(start_date='',end_date='',trade_date='20170710', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20170710_tscode_list = list() 
for ts_code_sh in daily_20170710['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20170710_tscode_list.append(stock_name)
daily_20170710_addname_dataframe=pd.DataFrame()
daily_20170710_addname_dataframe['cname'] = daily_20170710_tscode_list
for table_name in daily_20170710.columns.values.tolist():
    daily_20170710_addname_dataframe[table_name] = daily_20170710[table_name]
print("日线行情-时间为序  daily_20170710 返回数据 row 行数 = "+str(daily_20170710.shape[0]))
daily_20170710_addname_dataframe.to_excel(daily_201707_excel_writer,'10_1',index=False)
daily_201707_excel_writer.save()
daily_20170711 = pro.daily(start_date='',end_date='',trade_date='20170711', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20170711_tscode_list = list() 
for ts_code_sh in daily_20170711['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20170711_tscode_list.append(stock_name)
daily_20170711_addname_dataframe=pd.DataFrame()
daily_20170711_addname_dataframe['cname'] = daily_20170711_tscode_list
for table_name in daily_20170711.columns.values.tolist():
    daily_20170711_addname_dataframe[table_name] = daily_20170711[table_name]
print("日线行情-时间为序  daily_20170711 返回数据 row 行数 = "+str(daily_20170711.shape[0]))
daily_20170711_addname_dataframe.to_excel(daily_201707_excel_writer,'11_2',index=False)
daily_201707_excel_writer.save()
daily_20170712 = pro.daily(start_date='',end_date='',trade_date='20170712', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20170712_tscode_list = list() 
for ts_code_sh in daily_20170712['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20170712_tscode_list.append(stock_name)
daily_20170712_addname_dataframe=pd.DataFrame()
daily_20170712_addname_dataframe['cname'] = daily_20170712_tscode_list
for table_name in daily_20170712.columns.values.tolist():
    daily_20170712_addname_dataframe[table_name] = daily_20170712[table_name]
print("日线行情-时间为序  daily_20170712 返回数据 row 行数 = "+str(daily_20170712.shape[0]))
daily_20170712_addname_dataframe.to_excel(daily_201707_excel_writer,'12_3',index=False)
daily_201707_excel_writer.save()
daily_20170713 = pro.daily(start_date='',end_date='',trade_date='20170713', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20170713_tscode_list = list() 
for ts_code_sh in daily_20170713['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20170713_tscode_list.append(stock_name)
daily_20170713_addname_dataframe=pd.DataFrame()
daily_20170713_addname_dataframe['cname'] = daily_20170713_tscode_list
for table_name in daily_20170713.columns.values.tolist():
    daily_20170713_addname_dataframe[table_name] = daily_20170713[table_name]
print("日线行情-时间为序  daily_20170713 返回数据 row 行数 = "+str(daily_20170713.shape[0]))
daily_20170713_addname_dataframe.to_excel(daily_201707_excel_writer,'13_4',index=False)
daily_201707_excel_writer.save()
daily_20170714 = pro.daily(start_date='',end_date='',trade_date='20170714', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20170714_tscode_list = list() 
for ts_code_sh in daily_20170714['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20170714_tscode_list.append(stock_name)
daily_20170714_addname_dataframe=pd.DataFrame()
daily_20170714_addname_dataframe['cname'] = daily_20170714_tscode_list
for table_name in daily_20170714.columns.values.tolist():
    daily_20170714_addname_dataframe[table_name] = daily_20170714[table_name]
print("日线行情-时间为序  daily_20170714 返回数据 row 行数 = "+str(daily_20170714.shape[0]))
daily_20170714_addname_dataframe.to_excel(daily_201707_excel_writer,'14_5',index=False)
daily_201707_excel_writer.save()
daily_20170717 = pro.daily(start_date='',end_date='',trade_date='20170717', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20170717_tscode_list = list() 
for ts_code_sh in daily_20170717['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20170717_tscode_list.append(stock_name)
daily_20170717_addname_dataframe=pd.DataFrame()
daily_20170717_addname_dataframe['cname'] = daily_20170717_tscode_list
for table_name in daily_20170717.columns.values.tolist():
    daily_20170717_addname_dataframe[table_name] = daily_20170717[table_name]
print("日线行情-时间为序  daily_20170717 返回数据 row 行数 = "+str(daily_20170717.shape[0]))
daily_20170717_addname_dataframe.to_excel(daily_201707_excel_writer,'17_1',index=False)
daily_201707_excel_writer.save()
daily_20170718 = pro.daily(start_date='',end_date='',trade_date='20170718', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20170718_tscode_list = list() 
for ts_code_sh in daily_20170718['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20170718_tscode_list.append(stock_name)
daily_20170718_addname_dataframe=pd.DataFrame()
daily_20170718_addname_dataframe['cname'] = daily_20170718_tscode_list
for table_name in daily_20170718.columns.values.tolist():
    daily_20170718_addname_dataframe[table_name] = daily_20170718[table_name]
print("日线行情-时间为序  daily_20170718 返回数据 row 行数 = "+str(daily_20170718.shape[0]))
daily_20170718_addname_dataframe.to_excel(daily_201707_excel_writer,'18_2',index=False)
daily_201707_excel_writer.save()
daily_20170719 = pro.daily(start_date='',end_date='',trade_date='20170719', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20170719_tscode_list = list() 
for ts_code_sh in daily_20170719['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20170719_tscode_list.append(stock_name)
daily_20170719_addname_dataframe=pd.DataFrame()
daily_20170719_addname_dataframe['cname'] = daily_20170719_tscode_list
for table_name in daily_20170719.columns.values.tolist():
    daily_20170719_addname_dataframe[table_name] = daily_20170719[table_name]
print("日线行情-时间为序  daily_20170719 返回数据 row 行数 = "+str(daily_20170719.shape[0]))
daily_20170719_addname_dataframe.to_excel(daily_201707_excel_writer,'19_3',index=False)
daily_201707_excel_writer.save()
daily_20170720 = pro.daily(start_date='',end_date='',trade_date='20170720', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20170720_tscode_list = list() 
for ts_code_sh in daily_20170720['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20170720_tscode_list.append(stock_name)
daily_20170720_addname_dataframe=pd.DataFrame()
daily_20170720_addname_dataframe['cname'] = daily_20170720_tscode_list
for table_name in daily_20170720.columns.values.tolist():
    daily_20170720_addname_dataframe[table_name] = daily_20170720[table_name]
print("日线行情-时间为序  daily_20170720 返回数据 row 行数 = "+str(daily_20170720.shape[0]))
daily_20170720_addname_dataframe.to_excel(daily_201707_excel_writer,'20_4',index=False)
daily_201707_excel_writer.save()
daily_20170721 = pro.daily(start_date='',end_date='',trade_date='20170721', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20170721_tscode_list = list() 
for ts_code_sh in daily_20170721['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20170721_tscode_list.append(stock_name)
daily_20170721_addname_dataframe=pd.DataFrame()
daily_20170721_addname_dataframe['cname'] = daily_20170721_tscode_list
for table_name in daily_20170721.columns.values.tolist():
    daily_20170721_addname_dataframe[table_name] = daily_20170721[table_name]
print("日线行情-时间为序  daily_20170721 返回数据 row 行数 = "+str(daily_20170721.shape[0]))
daily_20170721_addname_dataframe.to_excel(daily_201707_excel_writer,'21_5',index=False)
daily_201707_excel_writer.save()
daily_20170724 = pro.daily(start_date='',end_date='',trade_date='20170724', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20170724_tscode_list = list() 
for ts_code_sh in daily_20170724['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20170724_tscode_list.append(stock_name)
daily_20170724_addname_dataframe=pd.DataFrame()
daily_20170724_addname_dataframe['cname'] = daily_20170724_tscode_list
for table_name in daily_20170724.columns.values.tolist():
    daily_20170724_addname_dataframe[table_name] = daily_20170724[table_name]
print("日线行情-时间为序  daily_20170724 返回数据 row 行数 = "+str(daily_20170724.shape[0]))
daily_20170724_addname_dataframe.to_excel(daily_201707_excel_writer,'24_1',index=False)
daily_201707_excel_writer.save()
daily_20170725 = pro.daily(start_date='',end_date='',trade_date='20170725', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20170725_tscode_list = list() 
for ts_code_sh in daily_20170725['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20170725_tscode_list.append(stock_name)
daily_20170725_addname_dataframe=pd.DataFrame()
daily_20170725_addname_dataframe['cname'] = daily_20170725_tscode_list
for table_name in daily_20170725.columns.values.tolist():
    daily_20170725_addname_dataframe[table_name] = daily_20170725[table_name]
print("日线行情-时间为序  daily_20170725 返回数据 row 行数 = "+str(daily_20170725.shape[0]))
daily_20170725_addname_dataframe.to_excel(daily_201707_excel_writer,'25_2',index=False)
daily_201707_excel_writer.save()
daily_20170726 = pro.daily(start_date='',end_date='',trade_date='20170726', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20170726_tscode_list = list() 
for ts_code_sh in daily_20170726['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20170726_tscode_list.append(stock_name)
daily_20170726_addname_dataframe=pd.DataFrame()
daily_20170726_addname_dataframe['cname'] = daily_20170726_tscode_list
for table_name in daily_20170726.columns.values.tolist():
    daily_20170726_addname_dataframe[table_name] = daily_20170726[table_name]
print("日线行情-时间为序  daily_20170726 返回数据 row 行数 = "+str(daily_20170726.shape[0]))
daily_20170726_addname_dataframe.to_excel(daily_201707_excel_writer,'26_3',index=False)
daily_201707_excel_writer.save()
daily_20170727 = pro.daily(start_date='',end_date='',trade_date='20170727', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20170727_tscode_list = list() 
for ts_code_sh in daily_20170727['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20170727_tscode_list.append(stock_name)
daily_20170727_addname_dataframe=pd.DataFrame()
daily_20170727_addname_dataframe['cname'] = daily_20170727_tscode_list
for table_name in daily_20170727.columns.values.tolist():
    daily_20170727_addname_dataframe[table_name] = daily_20170727[table_name]
print("日线行情-时间为序  daily_20170727 返回数据 row 行数 = "+str(daily_20170727.shape[0]))
daily_20170727_addname_dataframe.to_excel(daily_201707_excel_writer,'27_4',index=False)
daily_201707_excel_writer.save()
daily_20170728 = pro.daily(start_date='',end_date='',trade_date='20170728', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20170728_tscode_list = list() 
for ts_code_sh in daily_20170728['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20170728_tscode_list.append(stock_name)
daily_20170728_addname_dataframe=pd.DataFrame()
daily_20170728_addname_dataframe['cname'] = daily_20170728_tscode_list
for table_name in daily_20170728.columns.values.tolist():
    daily_20170728_addname_dataframe[table_name] = daily_20170728[table_name]
print("日线行情-时间为序  daily_20170728 返回数据 row 行数 = "+str(daily_20170728.shape[0]))
daily_20170728_addname_dataframe.to_excel(daily_201707_excel_writer,'28_5',index=False)
daily_201707_excel_writer.save()
daily_20170731 = pro.daily(start_date='',end_date='',trade_date='20170731', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20170731_tscode_list = list() 
for ts_code_sh in daily_20170731['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20170731_tscode_list.append(stock_name)
daily_20170731_addname_dataframe=pd.DataFrame()
daily_20170731_addname_dataframe['cname'] = daily_20170731_tscode_list
for table_name in daily_20170731.columns.values.tolist():
    daily_20170731_addname_dataframe[table_name] = daily_20170731[table_name]
print("日线行情-时间为序  daily_20170731 返回数据 row 行数 = "+str(daily_20170731.shape[0]))
daily_20170731_addname_dataframe.to_excel(daily_201707_excel_writer,'31_1',index=False)
daily_201707_excel_writer.save()




createexcel('daily_201708.xlsx')
daily_201708_book = load_workbook('C:\\Users\\zhuzj5\\Desktop\\zbin\\J0_Data\\daily_201708.xlsx')
daily_201708_excel_writer = pd.ExcelWriter('C:\\Users\\zhuzj5\\Desktop\\zbin\\J0_Data\\daily_201708.xlsx', engine='openpyxl')
daily_201708_excel_writer.book = daily_201708_book
daily_201708_excel_writer.sheets = dict((ws.title, ws) for ws in daily_201708_book.worksheets)
J0_PROPS.put(tree_node_name+"record_date", "20170801")       ###  更新 记录日期
daily_20170801 = pro.daily(start_date='',end_date='',trade_date='20170801', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20170801_tscode_list = list() 
for ts_code_sh in daily_20170801['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20170801_tscode_list.append(stock_name)
daily_20170801_addname_dataframe=pd.DataFrame()
daily_20170801_addname_dataframe['cname'] = daily_20170801_tscode_list
for table_name in daily_20170801.columns.values.tolist():
    daily_20170801_addname_dataframe[table_name] = daily_20170801[table_name]
print("日线行情-时间为序  daily_20170801 返回数据 row 行数 = "+str(daily_20170801.shape[0]))
daily_20170801_addname_dataframe.to_excel(daily_201708_excel_writer,'1_2',index=False)
daily_201708_excel_writer.save()
daily_20170802 = pro.daily(start_date='',end_date='',trade_date='20170802', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20170802_tscode_list = list() 
for ts_code_sh in daily_20170802['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20170802_tscode_list.append(stock_name)
daily_20170802_addname_dataframe=pd.DataFrame()
daily_20170802_addname_dataframe['cname'] = daily_20170802_tscode_list
for table_name in daily_20170802.columns.values.tolist():
    daily_20170802_addname_dataframe[table_name] = daily_20170802[table_name]
print("日线行情-时间为序  daily_20170802 返回数据 row 行数 = "+str(daily_20170802.shape[0]))
daily_20170802_addname_dataframe.to_excel(daily_201708_excel_writer,'2_3',index=False)
daily_201708_excel_writer.save()
daily_20170803 = pro.daily(start_date='',end_date='',trade_date='20170803', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20170803_tscode_list = list() 
for ts_code_sh in daily_20170803['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20170803_tscode_list.append(stock_name)
daily_20170803_addname_dataframe=pd.DataFrame()
daily_20170803_addname_dataframe['cname'] = daily_20170803_tscode_list
for table_name in daily_20170803.columns.values.tolist():
    daily_20170803_addname_dataframe[table_name] = daily_20170803[table_name]
print("日线行情-时间为序  daily_20170803 返回数据 row 行数 = "+str(daily_20170803.shape[0]))
daily_20170803_addname_dataframe.to_excel(daily_201708_excel_writer,'3_4',index=False)
daily_201708_excel_writer.save()
daily_20170804 = pro.daily(start_date='',end_date='',trade_date='20170804', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20170804_tscode_list = list() 
for ts_code_sh in daily_20170804['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20170804_tscode_list.append(stock_name)
daily_20170804_addname_dataframe=pd.DataFrame()
daily_20170804_addname_dataframe['cname'] = daily_20170804_tscode_list
for table_name in daily_20170804.columns.values.tolist():
    daily_20170804_addname_dataframe[table_name] = daily_20170804[table_name]
print("日线行情-时间为序  daily_20170804 返回数据 row 行数 = "+str(daily_20170804.shape[0]))
daily_20170804_addname_dataframe.to_excel(daily_201708_excel_writer,'4_5',index=False)
daily_201708_excel_writer.save()
daily_20170807 = pro.daily(start_date='',end_date='',trade_date='20170807', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20170807_tscode_list = list() 
for ts_code_sh in daily_20170807['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20170807_tscode_list.append(stock_name)
daily_20170807_addname_dataframe=pd.DataFrame()
daily_20170807_addname_dataframe['cname'] = daily_20170807_tscode_list
for table_name in daily_20170807.columns.values.tolist():
    daily_20170807_addname_dataframe[table_name] = daily_20170807[table_name]
print("日线行情-时间为序  daily_20170807 返回数据 row 行数 = "+str(daily_20170807.shape[0]))
daily_20170807_addname_dataframe.to_excel(daily_201708_excel_writer,'7_1',index=False)
daily_201708_excel_writer.save()
daily_20170808 = pro.daily(start_date='',end_date='',trade_date='20170808', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20170808_tscode_list = list() 
for ts_code_sh in daily_20170808['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20170808_tscode_list.append(stock_name)
daily_20170808_addname_dataframe=pd.DataFrame()
daily_20170808_addname_dataframe['cname'] = daily_20170808_tscode_list
for table_name in daily_20170808.columns.values.tolist():
    daily_20170808_addname_dataframe[table_name] = daily_20170808[table_name]
print("日线行情-时间为序  daily_20170808 返回数据 row 行数 = "+str(daily_20170808.shape[0]))
daily_20170808_addname_dataframe.to_excel(daily_201708_excel_writer,'8_2',index=False)
daily_201708_excel_writer.save()
daily_20170809 = pro.daily(start_date='',end_date='',trade_date='20170809', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20170809_tscode_list = list() 
for ts_code_sh in daily_20170809['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20170809_tscode_list.append(stock_name)
daily_20170809_addname_dataframe=pd.DataFrame()
daily_20170809_addname_dataframe['cname'] = daily_20170809_tscode_list
for table_name in daily_20170809.columns.values.tolist():
    daily_20170809_addname_dataframe[table_name] = daily_20170809[table_name]
print("日线行情-时间为序  daily_20170809 返回数据 row 行数 = "+str(daily_20170809.shape[0]))
daily_20170809_addname_dataframe.to_excel(daily_201708_excel_writer,'9_3',index=False)
daily_201708_excel_writer.save()
daily_20170810 = pro.daily(start_date='',end_date='',trade_date='20170810', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20170810_tscode_list = list() 
for ts_code_sh in daily_20170810['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20170810_tscode_list.append(stock_name)
daily_20170810_addname_dataframe=pd.DataFrame()
daily_20170810_addname_dataframe['cname'] = daily_20170810_tscode_list
for table_name in daily_20170810.columns.values.tolist():
    daily_20170810_addname_dataframe[table_name] = daily_20170810[table_name]
print("日线行情-时间为序  daily_20170810 返回数据 row 行数 = "+str(daily_20170810.shape[0]))
daily_20170810_addname_dataframe.to_excel(daily_201708_excel_writer,'10_4',index=False)
daily_201708_excel_writer.save()
daily_20170811 = pro.daily(start_date='',end_date='',trade_date='20170811', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20170811_tscode_list = list() 
for ts_code_sh in daily_20170811['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20170811_tscode_list.append(stock_name)
daily_20170811_addname_dataframe=pd.DataFrame()
daily_20170811_addname_dataframe['cname'] = daily_20170811_tscode_list
for table_name in daily_20170811.columns.values.tolist():
    daily_20170811_addname_dataframe[table_name] = daily_20170811[table_name]
print("日线行情-时间为序  daily_20170811 返回数据 row 行数 = "+str(daily_20170811.shape[0]))
daily_20170811_addname_dataframe.to_excel(daily_201708_excel_writer,'11_5',index=False)
daily_201708_excel_writer.save()
daily_20170814 = pro.daily(start_date='',end_date='',trade_date='20170814', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20170814_tscode_list = list() 
for ts_code_sh in daily_20170814['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20170814_tscode_list.append(stock_name)
daily_20170814_addname_dataframe=pd.DataFrame()
daily_20170814_addname_dataframe['cname'] = daily_20170814_tscode_list
for table_name in daily_20170814.columns.values.tolist():
    daily_20170814_addname_dataframe[table_name] = daily_20170814[table_name]
print("日线行情-时间为序  daily_20170814 返回数据 row 行数 = "+str(daily_20170814.shape[0]))
daily_20170814_addname_dataframe.to_excel(daily_201708_excel_writer,'14_1',index=False)
daily_201708_excel_writer.save()
daily_20170815 = pro.daily(start_date='',end_date='',trade_date='20170815', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20170815_tscode_list = list() 
for ts_code_sh in daily_20170815['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20170815_tscode_list.append(stock_name)
daily_20170815_addname_dataframe=pd.DataFrame()
daily_20170815_addname_dataframe['cname'] = daily_20170815_tscode_list
for table_name in daily_20170815.columns.values.tolist():
    daily_20170815_addname_dataframe[table_name] = daily_20170815[table_name]
print("日线行情-时间为序  daily_20170815 返回数据 row 行数 = "+str(daily_20170815.shape[0]))
daily_20170815_addname_dataframe.to_excel(daily_201708_excel_writer,'15_2',index=False)
daily_201708_excel_writer.save()
daily_20170816 = pro.daily(start_date='',end_date='',trade_date='20170816', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20170816_tscode_list = list() 
for ts_code_sh in daily_20170816['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20170816_tscode_list.append(stock_name)
daily_20170816_addname_dataframe=pd.DataFrame()
daily_20170816_addname_dataframe['cname'] = daily_20170816_tscode_list
for table_name in daily_20170816.columns.values.tolist():
    daily_20170816_addname_dataframe[table_name] = daily_20170816[table_name]
print("日线行情-时间为序  daily_20170816 返回数据 row 行数 = "+str(daily_20170816.shape[0]))
daily_20170816_addname_dataframe.to_excel(daily_201708_excel_writer,'16_3',index=False)
daily_201708_excel_writer.save()
daily_20170817 = pro.daily(start_date='',end_date='',trade_date='20170817', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20170817_tscode_list = list() 
for ts_code_sh in daily_20170817['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20170817_tscode_list.append(stock_name)
daily_20170817_addname_dataframe=pd.DataFrame()
daily_20170817_addname_dataframe['cname'] = daily_20170817_tscode_list
for table_name in daily_20170817.columns.values.tolist():
    daily_20170817_addname_dataframe[table_name] = daily_20170817[table_name]
print("日线行情-时间为序  daily_20170817 返回数据 row 行数 = "+str(daily_20170817.shape[0]))
daily_20170817_addname_dataframe.to_excel(daily_201708_excel_writer,'17_4',index=False)
daily_201708_excel_writer.save()
daily_20170818 = pro.daily(start_date='',end_date='',trade_date='20170818', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20170818_tscode_list = list() 
for ts_code_sh in daily_20170818['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20170818_tscode_list.append(stock_name)
daily_20170818_addname_dataframe=pd.DataFrame()
daily_20170818_addname_dataframe['cname'] = daily_20170818_tscode_list
for table_name in daily_20170818.columns.values.tolist():
    daily_20170818_addname_dataframe[table_name] = daily_20170818[table_name]
print("日线行情-时间为序  daily_20170818 返回数据 row 行数 = "+str(daily_20170818.shape[0]))
daily_20170818_addname_dataframe.to_excel(daily_201708_excel_writer,'18_5',index=False)
daily_201708_excel_writer.save()
daily_20170821 = pro.daily(start_date='',end_date='',trade_date='20170821', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20170821_tscode_list = list() 
for ts_code_sh in daily_20170821['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20170821_tscode_list.append(stock_name)
daily_20170821_addname_dataframe=pd.DataFrame()
daily_20170821_addname_dataframe['cname'] = daily_20170821_tscode_list
for table_name in daily_20170821.columns.values.tolist():
    daily_20170821_addname_dataframe[table_name] = daily_20170821[table_name]
print("日线行情-时间为序  daily_20170821 返回数据 row 行数 = "+str(daily_20170821.shape[0]))
daily_20170821_addname_dataframe.to_excel(daily_201708_excel_writer,'21_1',index=False)
daily_201708_excel_writer.save()
daily_20170822 = pro.daily(start_date='',end_date='',trade_date='20170822', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20170822_tscode_list = list() 
for ts_code_sh in daily_20170822['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20170822_tscode_list.append(stock_name)
daily_20170822_addname_dataframe=pd.DataFrame()
daily_20170822_addname_dataframe['cname'] = daily_20170822_tscode_list
for table_name in daily_20170822.columns.values.tolist():
    daily_20170822_addname_dataframe[table_name] = daily_20170822[table_name]
print("日线行情-时间为序  daily_20170822 返回数据 row 行数 = "+str(daily_20170822.shape[0]))
daily_20170822_addname_dataframe.to_excel(daily_201708_excel_writer,'22_2',index=False)
daily_201708_excel_writer.save()
daily_20170823 = pro.daily(start_date='',end_date='',trade_date='20170823', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20170823_tscode_list = list() 
for ts_code_sh in daily_20170823['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20170823_tscode_list.append(stock_name)
daily_20170823_addname_dataframe=pd.DataFrame()
daily_20170823_addname_dataframe['cname'] = daily_20170823_tscode_list
for table_name in daily_20170823.columns.values.tolist():
    daily_20170823_addname_dataframe[table_name] = daily_20170823[table_name]
print("日线行情-时间为序  daily_20170823 返回数据 row 行数 = "+str(daily_20170823.shape[0]))
daily_20170823_addname_dataframe.to_excel(daily_201708_excel_writer,'23_3',index=False)
daily_201708_excel_writer.save()
daily_20170824 = pro.daily(start_date='',end_date='',trade_date='20170824', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20170824_tscode_list = list() 
for ts_code_sh in daily_20170824['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20170824_tscode_list.append(stock_name)
daily_20170824_addname_dataframe=pd.DataFrame()
daily_20170824_addname_dataframe['cname'] = daily_20170824_tscode_list
for table_name in daily_20170824.columns.values.tolist():
    daily_20170824_addname_dataframe[table_name] = daily_20170824[table_name]
print("日线行情-时间为序  daily_20170824 返回数据 row 行数 = "+str(daily_20170824.shape[0]))
daily_20170824_addname_dataframe.to_excel(daily_201708_excel_writer,'24_4',index=False)
daily_201708_excel_writer.save()
daily_20170825 = pro.daily(start_date='',end_date='',trade_date='20170825', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20170825_tscode_list = list() 
for ts_code_sh in daily_20170825['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20170825_tscode_list.append(stock_name)
daily_20170825_addname_dataframe=pd.DataFrame()
daily_20170825_addname_dataframe['cname'] = daily_20170825_tscode_list
for table_name in daily_20170825.columns.values.tolist():
    daily_20170825_addname_dataframe[table_name] = daily_20170825[table_name]
print("日线行情-时间为序  daily_20170825 返回数据 row 行数 = "+str(daily_20170825.shape[0]))
daily_20170825_addname_dataframe.to_excel(daily_201708_excel_writer,'25_5',index=False)
daily_201708_excel_writer.save()
daily_20170828 = pro.daily(start_date='',end_date='',trade_date='20170828', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20170828_tscode_list = list() 
for ts_code_sh in daily_20170828['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20170828_tscode_list.append(stock_name)
daily_20170828_addname_dataframe=pd.DataFrame()
daily_20170828_addname_dataframe['cname'] = daily_20170828_tscode_list
for table_name in daily_20170828.columns.values.tolist():
    daily_20170828_addname_dataframe[table_name] = daily_20170828[table_name]
print("日线行情-时间为序  daily_20170828 返回数据 row 行数 = "+str(daily_20170828.shape[0]))
daily_20170828_addname_dataframe.to_excel(daily_201708_excel_writer,'28_1',index=False)
daily_201708_excel_writer.save()
daily_20170829 = pro.daily(start_date='',end_date='',trade_date='20170829', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20170829_tscode_list = list() 
for ts_code_sh in daily_20170829['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20170829_tscode_list.append(stock_name)
daily_20170829_addname_dataframe=pd.DataFrame()
daily_20170829_addname_dataframe['cname'] = daily_20170829_tscode_list
for table_name in daily_20170829.columns.values.tolist():
    daily_20170829_addname_dataframe[table_name] = daily_20170829[table_name]
print("日线行情-时间为序  daily_20170829 返回数据 row 行数 = "+str(daily_20170829.shape[0]))
daily_20170829_addname_dataframe.to_excel(daily_201708_excel_writer,'29_2',index=False)
daily_201708_excel_writer.save()
daily_20170830 = pro.daily(start_date='',end_date='',trade_date='20170830', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20170830_tscode_list = list() 
for ts_code_sh in daily_20170830['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20170830_tscode_list.append(stock_name)
daily_20170830_addname_dataframe=pd.DataFrame()
daily_20170830_addname_dataframe['cname'] = daily_20170830_tscode_list
for table_name in daily_20170830.columns.values.tolist():
    daily_20170830_addname_dataframe[table_name] = daily_20170830[table_name]
print("日线行情-时间为序  daily_20170830 返回数据 row 行数 = "+str(daily_20170830.shape[0]))
daily_20170830_addname_dataframe.to_excel(daily_201708_excel_writer,'30_3',index=False)
daily_201708_excel_writer.save()
daily_20170831 = pro.daily(start_date='',end_date='',trade_date='20170831', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20170831_tscode_list = list() 
for ts_code_sh in daily_20170831['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20170831_tscode_list.append(stock_name)
daily_20170831_addname_dataframe=pd.DataFrame()
daily_20170831_addname_dataframe['cname'] = daily_20170831_tscode_list
for table_name in daily_20170831.columns.values.tolist():
    daily_20170831_addname_dataframe[table_name] = daily_20170831[table_name]
print("日线行情-时间为序  daily_20170831 返回数据 row 行数 = "+str(daily_20170831.shape[0]))
daily_20170831_addname_dataframe.to_excel(daily_201708_excel_writer,'31_4',index=False)
daily_201708_excel_writer.save()




createexcel('daily_201709.xlsx')
daily_201709_book = load_workbook('C:\\Users\\zhuzj5\\Desktop\\zbin\\J0_Data\\daily_201709.xlsx')
daily_201709_excel_writer = pd.ExcelWriter('C:\\Users\\zhuzj5\\Desktop\\zbin\\J0_Data\\daily_201709.xlsx', engine='openpyxl')
daily_201709_excel_writer.book = daily_201709_book
daily_201709_excel_writer.sheets = dict((ws.title, ws) for ws in daily_201709_book.worksheets)
J0_PROPS.put(tree_node_name+"record_date", "20170901")       ###  更新 记录日期
daily_20170901 = pro.daily(start_date='',end_date='',trade_date='20170901', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20170901_tscode_list = list() 
for ts_code_sh in daily_20170901['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20170901_tscode_list.append(stock_name)
daily_20170901_addname_dataframe=pd.DataFrame()
daily_20170901_addname_dataframe['cname'] = daily_20170901_tscode_list
for table_name in daily_20170901.columns.values.tolist():
    daily_20170901_addname_dataframe[table_name] = daily_20170901[table_name]
print("日线行情-时间为序  daily_20170901 返回数据 row 行数 = "+str(daily_20170901.shape[0]))
daily_20170901_addname_dataframe.to_excel(daily_201709_excel_writer,'1_5',index=False)
daily_201709_excel_writer.save()
daily_20170904 = pro.daily(start_date='',end_date='',trade_date='20170904', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20170904_tscode_list = list() 
for ts_code_sh in daily_20170904['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20170904_tscode_list.append(stock_name)
daily_20170904_addname_dataframe=pd.DataFrame()
daily_20170904_addname_dataframe['cname'] = daily_20170904_tscode_list
for table_name in daily_20170904.columns.values.tolist():
    daily_20170904_addname_dataframe[table_name] = daily_20170904[table_name]
print("日线行情-时间为序  daily_20170904 返回数据 row 行数 = "+str(daily_20170904.shape[0]))
daily_20170904_addname_dataframe.to_excel(daily_201709_excel_writer,'4_1',index=False)
daily_201709_excel_writer.save()
daily_20170905 = pro.daily(start_date='',end_date='',trade_date='20170905', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20170905_tscode_list = list() 
for ts_code_sh in daily_20170905['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20170905_tscode_list.append(stock_name)
daily_20170905_addname_dataframe=pd.DataFrame()
daily_20170905_addname_dataframe['cname'] = daily_20170905_tscode_list
for table_name in daily_20170905.columns.values.tolist():
    daily_20170905_addname_dataframe[table_name] = daily_20170905[table_name]
print("日线行情-时间为序  daily_20170905 返回数据 row 行数 = "+str(daily_20170905.shape[0]))
daily_20170905_addname_dataframe.to_excel(daily_201709_excel_writer,'5_2',index=False)
daily_201709_excel_writer.save()
daily_20170906 = pro.daily(start_date='',end_date='',trade_date='20170906', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20170906_tscode_list = list() 
for ts_code_sh in daily_20170906['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20170906_tscode_list.append(stock_name)
daily_20170906_addname_dataframe=pd.DataFrame()
daily_20170906_addname_dataframe['cname'] = daily_20170906_tscode_list
for table_name in daily_20170906.columns.values.tolist():
    daily_20170906_addname_dataframe[table_name] = daily_20170906[table_name]
print("日线行情-时间为序  daily_20170906 返回数据 row 行数 = "+str(daily_20170906.shape[0]))
daily_20170906_addname_dataframe.to_excel(daily_201709_excel_writer,'6_3',index=False)
daily_201709_excel_writer.save()
daily_20170907 = pro.daily(start_date='',end_date='',trade_date='20170907', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20170907_tscode_list = list() 
for ts_code_sh in daily_20170907['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20170907_tscode_list.append(stock_name)
daily_20170907_addname_dataframe=pd.DataFrame()
daily_20170907_addname_dataframe['cname'] = daily_20170907_tscode_list
for table_name in daily_20170907.columns.values.tolist():
    daily_20170907_addname_dataframe[table_name] = daily_20170907[table_name]
print("日线行情-时间为序  daily_20170907 返回数据 row 行数 = "+str(daily_20170907.shape[0]))
daily_20170907_addname_dataframe.to_excel(daily_201709_excel_writer,'7_4',index=False)
daily_201709_excel_writer.save()
daily_20170908 = pro.daily(start_date='',end_date='',trade_date='20170908', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20170908_tscode_list = list() 
for ts_code_sh in daily_20170908['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20170908_tscode_list.append(stock_name)
daily_20170908_addname_dataframe=pd.DataFrame()
daily_20170908_addname_dataframe['cname'] = daily_20170908_tscode_list
for table_name in daily_20170908.columns.values.tolist():
    daily_20170908_addname_dataframe[table_name] = daily_20170908[table_name]
print("日线行情-时间为序  daily_20170908 返回数据 row 行数 = "+str(daily_20170908.shape[0]))
daily_20170908_addname_dataframe.to_excel(daily_201709_excel_writer,'8_5',index=False)
daily_201709_excel_writer.save()
daily_20170911 = pro.daily(start_date='',end_date='',trade_date='20170911', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20170911_tscode_list = list() 
for ts_code_sh in daily_20170911['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20170911_tscode_list.append(stock_name)
daily_20170911_addname_dataframe=pd.DataFrame()
daily_20170911_addname_dataframe['cname'] = daily_20170911_tscode_list
for table_name in daily_20170911.columns.values.tolist():
    daily_20170911_addname_dataframe[table_name] = daily_20170911[table_name]
print("日线行情-时间为序  daily_20170911 返回数据 row 行数 = "+str(daily_20170911.shape[0]))
daily_20170911_addname_dataframe.to_excel(daily_201709_excel_writer,'11_1',index=False)
daily_201709_excel_writer.save()
daily_20170912 = pro.daily(start_date='',end_date='',trade_date='20170912', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20170912_tscode_list = list() 
for ts_code_sh in daily_20170912['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20170912_tscode_list.append(stock_name)
daily_20170912_addname_dataframe=pd.DataFrame()
daily_20170912_addname_dataframe['cname'] = daily_20170912_tscode_list
for table_name in daily_20170912.columns.values.tolist():
    daily_20170912_addname_dataframe[table_name] = daily_20170912[table_name]
print("日线行情-时间为序  daily_20170912 返回数据 row 行数 = "+str(daily_20170912.shape[0]))
daily_20170912_addname_dataframe.to_excel(daily_201709_excel_writer,'12_2',index=False)
daily_201709_excel_writer.save()
daily_20170913 = pro.daily(start_date='',end_date='',trade_date='20170913', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20170913_tscode_list = list() 
for ts_code_sh in daily_20170913['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20170913_tscode_list.append(stock_name)
daily_20170913_addname_dataframe=pd.DataFrame()
daily_20170913_addname_dataframe['cname'] = daily_20170913_tscode_list
for table_name in daily_20170913.columns.values.tolist():
    daily_20170913_addname_dataframe[table_name] = daily_20170913[table_name]
print("日线行情-时间为序  daily_20170913 返回数据 row 行数 = "+str(daily_20170913.shape[0]))
daily_20170913_addname_dataframe.to_excel(daily_201709_excel_writer,'13_3',index=False)
daily_201709_excel_writer.save()
daily_20170914 = pro.daily(start_date='',end_date='',trade_date='20170914', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20170914_tscode_list = list() 
for ts_code_sh in daily_20170914['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20170914_tscode_list.append(stock_name)
daily_20170914_addname_dataframe=pd.DataFrame()
daily_20170914_addname_dataframe['cname'] = daily_20170914_tscode_list
for table_name in daily_20170914.columns.values.tolist():
    daily_20170914_addname_dataframe[table_name] = daily_20170914[table_name]
print("日线行情-时间为序  daily_20170914 返回数据 row 行数 = "+str(daily_20170914.shape[0]))
daily_20170914_addname_dataframe.to_excel(daily_201709_excel_writer,'14_4',index=False)
daily_201709_excel_writer.save()
daily_20170915 = pro.daily(start_date='',end_date='',trade_date='20170915', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20170915_tscode_list = list() 
for ts_code_sh in daily_20170915['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20170915_tscode_list.append(stock_name)
daily_20170915_addname_dataframe=pd.DataFrame()
daily_20170915_addname_dataframe['cname'] = daily_20170915_tscode_list
for table_name in daily_20170915.columns.values.tolist():
    daily_20170915_addname_dataframe[table_name] = daily_20170915[table_name]
print("日线行情-时间为序  daily_20170915 返回数据 row 行数 = "+str(daily_20170915.shape[0]))
daily_20170915_addname_dataframe.to_excel(daily_201709_excel_writer,'15_5',index=False)
daily_201709_excel_writer.save()
daily_20170918 = pro.daily(start_date='',end_date='',trade_date='20170918', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20170918_tscode_list = list() 
for ts_code_sh in daily_20170918['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20170918_tscode_list.append(stock_name)
daily_20170918_addname_dataframe=pd.DataFrame()
daily_20170918_addname_dataframe['cname'] = daily_20170918_tscode_list
for table_name in daily_20170918.columns.values.tolist():
    daily_20170918_addname_dataframe[table_name] = daily_20170918[table_name]
print("日线行情-时间为序  daily_20170918 返回数据 row 行数 = "+str(daily_20170918.shape[0]))
daily_20170918_addname_dataframe.to_excel(daily_201709_excel_writer,'18_1',index=False)
daily_201709_excel_writer.save()
daily_20170919 = pro.daily(start_date='',end_date='',trade_date='20170919', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20170919_tscode_list = list() 
for ts_code_sh in daily_20170919['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20170919_tscode_list.append(stock_name)
daily_20170919_addname_dataframe=pd.DataFrame()
daily_20170919_addname_dataframe['cname'] = daily_20170919_tscode_list
for table_name in daily_20170919.columns.values.tolist():
    daily_20170919_addname_dataframe[table_name] = daily_20170919[table_name]
print("日线行情-时间为序  daily_20170919 返回数据 row 行数 = "+str(daily_20170919.shape[0]))
daily_20170919_addname_dataframe.to_excel(daily_201709_excel_writer,'19_2',index=False)
daily_201709_excel_writer.save()
daily_20170920 = pro.daily(start_date='',end_date='',trade_date='20170920', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20170920_tscode_list = list() 
for ts_code_sh in daily_20170920['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20170920_tscode_list.append(stock_name)
daily_20170920_addname_dataframe=pd.DataFrame()
daily_20170920_addname_dataframe['cname'] = daily_20170920_tscode_list
for table_name in daily_20170920.columns.values.tolist():
    daily_20170920_addname_dataframe[table_name] = daily_20170920[table_name]
print("日线行情-时间为序  daily_20170920 返回数据 row 行数 = "+str(daily_20170920.shape[0]))
daily_20170920_addname_dataframe.to_excel(daily_201709_excel_writer,'20_3',index=False)
daily_201709_excel_writer.save()
daily_20170921 = pro.daily(start_date='',end_date='',trade_date='20170921', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20170921_tscode_list = list() 
for ts_code_sh in daily_20170921['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20170921_tscode_list.append(stock_name)
daily_20170921_addname_dataframe=pd.DataFrame()
daily_20170921_addname_dataframe['cname'] = daily_20170921_tscode_list
for table_name in daily_20170921.columns.values.tolist():
    daily_20170921_addname_dataframe[table_name] = daily_20170921[table_name]
print("日线行情-时间为序  daily_20170921 返回数据 row 行数 = "+str(daily_20170921.shape[0]))
daily_20170921_addname_dataframe.to_excel(daily_201709_excel_writer,'21_4',index=False)
daily_201709_excel_writer.save()
daily_20170922 = pro.daily(start_date='',end_date='',trade_date='20170922', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20170922_tscode_list = list() 
for ts_code_sh in daily_20170922['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20170922_tscode_list.append(stock_name)
daily_20170922_addname_dataframe=pd.DataFrame()
daily_20170922_addname_dataframe['cname'] = daily_20170922_tscode_list
for table_name in daily_20170922.columns.values.tolist():
    daily_20170922_addname_dataframe[table_name] = daily_20170922[table_name]
print("日线行情-时间为序  daily_20170922 返回数据 row 行数 = "+str(daily_20170922.shape[0]))
daily_20170922_addname_dataframe.to_excel(daily_201709_excel_writer,'22_5',index=False)
daily_201709_excel_writer.save()
daily_20170925 = pro.daily(start_date='',end_date='',trade_date='20170925', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20170925_tscode_list = list() 
for ts_code_sh in daily_20170925['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20170925_tscode_list.append(stock_name)
daily_20170925_addname_dataframe=pd.DataFrame()
daily_20170925_addname_dataframe['cname'] = daily_20170925_tscode_list
for table_name in daily_20170925.columns.values.tolist():
    daily_20170925_addname_dataframe[table_name] = daily_20170925[table_name]
print("日线行情-时间为序  daily_20170925 返回数据 row 行数 = "+str(daily_20170925.shape[0]))
daily_20170925_addname_dataframe.to_excel(daily_201709_excel_writer,'25_1',index=False)
daily_201709_excel_writer.save()
daily_20170926 = pro.daily(start_date='',end_date='',trade_date='20170926', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20170926_tscode_list = list() 
for ts_code_sh in daily_20170926['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20170926_tscode_list.append(stock_name)
daily_20170926_addname_dataframe=pd.DataFrame()
daily_20170926_addname_dataframe['cname'] = daily_20170926_tscode_list
for table_name in daily_20170926.columns.values.tolist():
    daily_20170926_addname_dataframe[table_name] = daily_20170926[table_name]
print("日线行情-时间为序  daily_20170926 返回数据 row 行数 = "+str(daily_20170926.shape[0]))
daily_20170926_addname_dataframe.to_excel(daily_201709_excel_writer,'26_2',index=False)
daily_201709_excel_writer.save()
daily_20170927 = pro.daily(start_date='',end_date='',trade_date='20170927', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20170927_tscode_list = list() 
for ts_code_sh in daily_20170927['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20170927_tscode_list.append(stock_name)
daily_20170927_addname_dataframe=pd.DataFrame()
daily_20170927_addname_dataframe['cname'] = daily_20170927_tscode_list
for table_name in daily_20170927.columns.values.tolist():
    daily_20170927_addname_dataframe[table_name] = daily_20170927[table_name]
print("日线行情-时间为序  daily_20170927 返回数据 row 行数 = "+str(daily_20170927.shape[0]))
daily_20170927_addname_dataframe.to_excel(daily_201709_excel_writer,'27_3',index=False)
daily_201709_excel_writer.save()
daily_20170928 = pro.daily(start_date='',end_date='',trade_date='20170928', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20170928_tscode_list = list() 
for ts_code_sh in daily_20170928['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20170928_tscode_list.append(stock_name)
daily_20170928_addname_dataframe=pd.DataFrame()
daily_20170928_addname_dataframe['cname'] = daily_20170928_tscode_list
for table_name in daily_20170928.columns.values.tolist():
    daily_20170928_addname_dataframe[table_name] = daily_20170928[table_name]
print("日线行情-时间为序  daily_20170928 返回数据 row 行数 = "+str(daily_20170928.shape[0]))
daily_20170928_addname_dataframe.to_excel(daily_201709_excel_writer,'28_4',index=False)
daily_201709_excel_writer.save()
daily_20170929 = pro.daily(start_date='',end_date='',trade_date='20170929', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20170929_tscode_list = list() 
for ts_code_sh in daily_20170929['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20170929_tscode_list.append(stock_name)
daily_20170929_addname_dataframe=pd.DataFrame()
daily_20170929_addname_dataframe['cname'] = daily_20170929_tscode_list
for table_name in daily_20170929.columns.values.tolist():
    daily_20170929_addname_dataframe[table_name] = daily_20170929[table_name]
print("日线行情-时间为序  daily_20170929 返回数据 row 行数 = "+str(daily_20170929.shape[0]))
daily_20170929_addname_dataframe.to_excel(daily_201709_excel_writer,'29_5',index=False)
daily_201709_excel_writer.save()




createexcel('daily_201710.xlsx')
daily_201710_book = load_workbook('C:\\Users\\zhuzj5\\Desktop\\zbin\\J0_Data\\daily_201710.xlsx')
daily_201710_excel_writer = pd.ExcelWriter('C:\\Users\\zhuzj5\\Desktop\\zbin\\J0_Data\\daily_201710.xlsx', engine='openpyxl')
daily_201710_excel_writer.book = daily_201710_book
daily_201710_excel_writer.sheets = dict((ws.title, ws) for ws in daily_201710_book.worksheets)
J0_PROPS.put(tree_node_name+"record_date", "20171001")       ###  更新 记录日期
daily_20171009 = pro.daily(start_date='',end_date='',trade_date='20171009', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20171009_tscode_list = list() 
for ts_code_sh in daily_20171009['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20171009_tscode_list.append(stock_name)
daily_20171009_addname_dataframe=pd.DataFrame()
daily_20171009_addname_dataframe['cname'] = daily_20171009_tscode_list
for table_name in daily_20171009.columns.values.tolist():
    daily_20171009_addname_dataframe[table_name] = daily_20171009[table_name]
print("日线行情-时间为序  daily_20171009 返回数据 row 行数 = "+str(daily_20171009.shape[0]))
daily_20171009_addname_dataframe.to_excel(daily_201710_excel_writer,'9_1',index=False)
daily_201710_excel_writer.save()
daily_20171010 = pro.daily(start_date='',end_date='',trade_date='20171010', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20171010_tscode_list = list() 
for ts_code_sh in daily_20171010['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20171010_tscode_list.append(stock_name)
daily_20171010_addname_dataframe=pd.DataFrame()
daily_20171010_addname_dataframe['cname'] = daily_20171010_tscode_list
for table_name in daily_20171010.columns.values.tolist():
    daily_20171010_addname_dataframe[table_name] = daily_20171010[table_name]
print("日线行情-时间为序  daily_20171010 返回数据 row 行数 = "+str(daily_20171010.shape[0]))
daily_20171010_addname_dataframe.to_excel(daily_201710_excel_writer,'10_2',index=False)
daily_201710_excel_writer.save()
daily_20171011 = pro.daily(start_date='',end_date='',trade_date='20171011', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20171011_tscode_list = list() 
for ts_code_sh in daily_20171011['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20171011_tscode_list.append(stock_name)
daily_20171011_addname_dataframe=pd.DataFrame()
daily_20171011_addname_dataframe['cname'] = daily_20171011_tscode_list
for table_name in daily_20171011.columns.values.tolist():
    daily_20171011_addname_dataframe[table_name] = daily_20171011[table_name]
print("日线行情-时间为序  daily_20171011 返回数据 row 行数 = "+str(daily_20171011.shape[0]))
daily_20171011_addname_dataframe.to_excel(daily_201710_excel_writer,'11_3',index=False)
daily_201710_excel_writer.save()
daily_20171012 = pro.daily(start_date='',end_date='',trade_date='20171012', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20171012_tscode_list = list() 
for ts_code_sh in daily_20171012['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20171012_tscode_list.append(stock_name)
daily_20171012_addname_dataframe=pd.DataFrame()
daily_20171012_addname_dataframe['cname'] = daily_20171012_tscode_list
for table_name in daily_20171012.columns.values.tolist():
    daily_20171012_addname_dataframe[table_name] = daily_20171012[table_name]
print("日线行情-时间为序  daily_20171012 返回数据 row 行数 = "+str(daily_20171012.shape[0]))
daily_20171012_addname_dataframe.to_excel(daily_201710_excel_writer,'12_4',index=False)
daily_201710_excel_writer.save()
daily_20171013 = pro.daily(start_date='',end_date='',trade_date='20171013', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20171013_tscode_list = list() 
for ts_code_sh in daily_20171013['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20171013_tscode_list.append(stock_name)
daily_20171013_addname_dataframe=pd.DataFrame()
daily_20171013_addname_dataframe['cname'] = daily_20171013_tscode_list
for table_name in daily_20171013.columns.values.tolist():
    daily_20171013_addname_dataframe[table_name] = daily_20171013[table_name]
print("日线行情-时间为序  daily_20171013 返回数据 row 行数 = "+str(daily_20171013.shape[0]))
daily_20171013_addname_dataframe.to_excel(daily_201710_excel_writer,'13_5',index=False)
daily_201710_excel_writer.save()
daily_20171016 = pro.daily(start_date='',end_date='',trade_date='20171016', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20171016_tscode_list = list() 
for ts_code_sh in daily_20171016['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20171016_tscode_list.append(stock_name)
daily_20171016_addname_dataframe=pd.DataFrame()
daily_20171016_addname_dataframe['cname'] = daily_20171016_tscode_list
for table_name in daily_20171016.columns.values.tolist():
    daily_20171016_addname_dataframe[table_name] = daily_20171016[table_name]
print("日线行情-时间为序  daily_20171016 返回数据 row 行数 = "+str(daily_20171016.shape[0]))
daily_20171016_addname_dataframe.to_excel(daily_201710_excel_writer,'16_1',index=False)
daily_201710_excel_writer.save()
daily_20171017 = pro.daily(start_date='',end_date='',trade_date='20171017', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20171017_tscode_list = list() 
for ts_code_sh in daily_20171017['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20171017_tscode_list.append(stock_name)
daily_20171017_addname_dataframe=pd.DataFrame()
daily_20171017_addname_dataframe['cname'] = daily_20171017_tscode_list
for table_name in daily_20171017.columns.values.tolist():
    daily_20171017_addname_dataframe[table_name] = daily_20171017[table_name]
print("日线行情-时间为序  daily_20171017 返回数据 row 行数 = "+str(daily_20171017.shape[0]))
daily_20171017_addname_dataframe.to_excel(daily_201710_excel_writer,'17_2',index=False)
daily_201710_excel_writer.save()
daily_20171018 = pro.daily(start_date='',end_date='',trade_date='20171018', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20171018_tscode_list = list() 
for ts_code_sh in daily_20171018['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20171018_tscode_list.append(stock_name)
daily_20171018_addname_dataframe=pd.DataFrame()
daily_20171018_addname_dataframe['cname'] = daily_20171018_tscode_list
for table_name in daily_20171018.columns.values.tolist():
    daily_20171018_addname_dataframe[table_name] = daily_20171018[table_name]
print("日线行情-时间为序  daily_20171018 返回数据 row 行数 = "+str(daily_20171018.shape[0]))
daily_20171018_addname_dataframe.to_excel(daily_201710_excel_writer,'18_3',index=False)
daily_201710_excel_writer.save()
daily_20171019 = pro.daily(start_date='',end_date='',trade_date='20171019', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20171019_tscode_list = list() 
for ts_code_sh in daily_20171019['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20171019_tscode_list.append(stock_name)
daily_20171019_addname_dataframe=pd.DataFrame()
daily_20171019_addname_dataframe['cname'] = daily_20171019_tscode_list
for table_name in daily_20171019.columns.values.tolist():
    daily_20171019_addname_dataframe[table_name] = daily_20171019[table_name]
print("日线行情-时间为序  daily_20171019 返回数据 row 行数 = "+str(daily_20171019.shape[0]))
daily_20171019_addname_dataframe.to_excel(daily_201710_excel_writer,'19_4',index=False)
daily_201710_excel_writer.save()
daily_20171020 = pro.daily(start_date='',end_date='',trade_date='20171020', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20171020_tscode_list = list() 
for ts_code_sh in daily_20171020['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20171020_tscode_list.append(stock_name)
daily_20171020_addname_dataframe=pd.DataFrame()
daily_20171020_addname_dataframe['cname'] = daily_20171020_tscode_list
for table_name in daily_20171020.columns.values.tolist():
    daily_20171020_addname_dataframe[table_name] = daily_20171020[table_name]
print("日线行情-时间为序  daily_20171020 返回数据 row 行数 = "+str(daily_20171020.shape[0]))
daily_20171020_addname_dataframe.to_excel(daily_201710_excel_writer,'20_5',index=False)
daily_201710_excel_writer.save()
daily_20171023 = pro.daily(start_date='',end_date='',trade_date='20171023', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20171023_tscode_list = list() 
for ts_code_sh in daily_20171023['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20171023_tscode_list.append(stock_name)
daily_20171023_addname_dataframe=pd.DataFrame()
daily_20171023_addname_dataframe['cname'] = daily_20171023_tscode_list
for table_name in daily_20171023.columns.values.tolist():
    daily_20171023_addname_dataframe[table_name] = daily_20171023[table_name]
print("日线行情-时间为序  daily_20171023 返回数据 row 行数 = "+str(daily_20171023.shape[0]))
daily_20171023_addname_dataframe.to_excel(daily_201710_excel_writer,'23_1',index=False)
daily_201710_excel_writer.save()
daily_20171024 = pro.daily(start_date='',end_date='',trade_date='20171024', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20171024_tscode_list = list() 
for ts_code_sh in daily_20171024['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20171024_tscode_list.append(stock_name)
daily_20171024_addname_dataframe=pd.DataFrame()
daily_20171024_addname_dataframe['cname'] = daily_20171024_tscode_list
for table_name in daily_20171024.columns.values.tolist():
    daily_20171024_addname_dataframe[table_name] = daily_20171024[table_name]
print("日线行情-时间为序  daily_20171024 返回数据 row 行数 = "+str(daily_20171024.shape[0]))
daily_20171024_addname_dataframe.to_excel(daily_201710_excel_writer,'24_2',index=False)
daily_201710_excel_writer.save()
daily_20171025 = pro.daily(start_date='',end_date='',trade_date='20171025', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20171025_tscode_list = list() 
for ts_code_sh in daily_20171025['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20171025_tscode_list.append(stock_name)
daily_20171025_addname_dataframe=pd.DataFrame()
daily_20171025_addname_dataframe['cname'] = daily_20171025_tscode_list
for table_name in daily_20171025.columns.values.tolist():
    daily_20171025_addname_dataframe[table_name] = daily_20171025[table_name]
print("日线行情-时间为序  daily_20171025 返回数据 row 行数 = "+str(daily_20171025.shape[0]))
daily_20171025_addname_dataframe.to_excel(daily_201710_excel_writer,'25_3',index=False)
daily_201710_excel_writer.save()
daily_20171026 = pro.daily(start_date='',end_date='',trade_date='20171026', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20171026_tscode_list = list() 
for ts_code_sh in daily_20171026['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20171026_tscode_list.append(stock_name)
daily_20171026_addname_dataframe=pd.DataFrame()
daily_20171026_addname_dataframe['cname'] = daily_20171026_tscode_list
for table_name in daily_20171026.columns.values.tolist():
    daily_20171026_addname_dataframe[table_name] = daily_20171026[table_name]
print("日线行情-时间为序  daily_20171026 返回数据 row 行数 = "+str(daily_20171026.shape[0]))
daily_20171026_addname_dataframe.to_excel(daily_201710_excel_writer,'26_4',index=False)
daily_201710_excel_writer.save()
daily_20171027 = pro.daily(start_date='',end_date='',trade_date='20171027', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20171027_tscode_list = list() 
for ts_code_sh in daily_20171027['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20171027_tscode_list.append(stock_name)
daily_20171027_addname_dataframe=pd.DataFrame()
daily_20171027_addname_dataframe['cname'] = daily_20171027_tscode_list
for table_name in daily_20171027.columns.values.tolist():
    daily_20171027_addname_dataframe[table_name] = daily_20171027[table_name]
print("日线行情-时间为序  daily_20171027 返回数据 row 行数 = "+str(daily_20171027.shape[0]))
daily_20171027_addname_dataframe.to_excel(daily_201710_excel_writer,'27_5',index=False)
daily_201710_excel_writer.save()
daily_20171030 = pro.daily(start_date='',end_date='',trade_date='20171030', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20171030_tscode_list = list() 
for ts_code_sh in daily_20171030['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20171030_tscode_list.append(stock_name)
daily_20171030_addname_dataframe=pd.DataFrame()
daily_20171030_addname_dataframe['cname'] = daily_20171030_tscode_list
for table_name in daily_20171030.columns.values.tolist():
    daily_20171030_addname_dataframe[table_name] = daily_20171030[table_name]
print("日线行情-时间为序  daily_20171030 返回数据 row 行数 = "+str(daily_20171030.shape[0]))
daily_20171030_addname_dataframe.to_excel(daily_201710_excel_writer,'30_1',index=False)
daily_201710_excel_writer.save()
daily_20171031 = pro.daily(start_date='',end_date='',trade_date='20171031', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20171031_tscode_list = list() 
for ts_code_sh in daily_20171031['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20171031_tscode_list.append(stock_name)
daily_20171031_addname_dataframe=pd.DataFrame()
daily_20171031_addname_dataframe['cname'] = daily_20171031_tscode_list
for table_name in daily_20171031.columns.values.tolist():
    daily_20171031_addname_dataframe[table_name] = daily_20171031[table_name]
print("日线行情-时间为序  daily_20171031 返回数据 row 行数 = "+str(daily_20171031.shape[0]))
daily_20171031_addname_dataframe.to_excel(daily_201710_excel_writer,'31_2',index=False)
daily_201710_excel_writer.save()




createexcel('daily_201711.xlsx')
daily_201711_book = load_workbook('C:\\Users\\zhuzj5\\Desktop\\zbin\\J0_Data\\daily_201711.xlsx')
daily_201711_excel_writer = pd.ExcelWriter('C:\\Users\\zhuzj5\\Desktop\\zbin\\J0_Data\\daily_201711.xlsx', engine='openpyxl')
daily_201711_excel_writer.book = daily_201711_book
daily_201711_excel_writer.sheets = dict((ws.title, ws) for ws in daily_201711_book.worksheets)
J0_PROPS.put(tree_node_name+"record_date", "20171101")       ###  更新 记录日期
daily_20171101 = pro.daily(start_date='',end_date='',trade_date='20171101', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20171101_tscode_list = list() 
for ts_code_sh in daily_20171101['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20171101_tscode_list.append(stock_name)
daily_20171101_addname_dataframe=pd.DataFrame()
daily_20171101_addname_dataframe['cname'] = daily_20171101_tscode_list
for table_name in daily_20171101.columns.values.tolist():
    daily_20171101_addname_dataframe[table_name] = daily_20171101[table_name]
print("日线行情-时间为序  daily_20171101 返回数据 row 行数 = "+str(daily_20171101.shape[0]))
daily_20171101_addname_dataframe.to_excel(daily_201711_excel_writer,'1_3',index=False)
daily_201711_excel_writer.save()
daily_20171102 = pro.daily(start_date='',end_date='',trade_date='20171102', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20171102_tscode_list = list() 
for ts_code_sh in daily_20171102['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20171102_tscode_list.append(stock_name)
daily_20171102_addname_dataframe=pd.DataFrame()
daily_20171102_addname_dataframe['cname'] = daily_20171102_tscode_list
for table_name in daily_20171102.columns.values.tolist():
    daily_20171102_addname_dataframe[table_name] = daily_20171102[table_name]
print("日线行情-时间为序  daily_20171102 返回数据 row 行数 = "+str(daily_20171102.shape[0]))
daily_20171102_addname_dataframe.to_excel(daily_201711_excel_writer,'2_4',index=False)
daily_201711_excel_writer.save()
daily_20171103 = pro.daily(start_date='',end_date='',trade_date='20171103', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20171103_tscode_list = list() 
for ts_code_sh in daily_20171103['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20171103_tscode_list.append(stock_name)
daily_20171103_addname_dataframe=pd.DataFrame()
daily_20171103_addname_dataframe['cname'] = daily_20171103_tscode_list
for table_name in daily_20171103.columns.values.tolist():
    daily_20171103_addname_dataframe[table_name] = daily_20171103[table_name]
print("日线行情-时间为序  daily_20171103 返回数据 row 行数 = "+str(daily_20171103.shape[0]))
daily_20171103_addname_dataframe.to_excel(daily_201711_excel_writer,'3_5',index=False)
daily_201711_excel_writer.save()
daily_20171106 = pro.daily(start_date='',end_date='',trade_date='20171106', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20171106_tscode_list = list() 
for ts_code_sh in daily_20171106['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20171106_tscode_list.append(stock_name)
daily_20171106_addname_dataframe=pd.DataFrame()
daily_20171106_addname_dataframe['cname'] = daily_20171106_tscode_list
for table_name in daily_20171106.columns.values.tolist():
    daily_20171106_addname_dataframe[table_name] = daily_20171106[table_name]
print("日线行情-时间为序  daily_20171106 返回数据 row 行数 = "+str(daily_20171106.shape[0]))
daily_20171106_addname_dataframe.to_excel(daily_201711_excel_writer,'6_1',index=False)
daily_201711_excel_writer.save()
daily_20171107 = pro.daily(start_date='',end_date='',trade_date='20171107', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20171107_tscode_list = list() 
for ts_code_sh in daily_20171107['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20171107_tscode_list.append(stock_name)
daily_20171107_addname_dataframe=pd.DataFrame()
daily_20171107_addname_dataframe['cname'] = daily_20171107_tscode_list
for table_name in daily_20171107.columns.values.tolist():
    daily_20171107_addname_dataframe[table_name] = daily_20171107[table_name]
print("日线行情-时间为序  daily_20171107 返回数据 row 行数 = "+str(daily_20171107.shape[0]))
daily_20171107_addname_dataframe.to_excel(daily_201711_excel_writer,'7_2',index=False)
daily_201711_excel_writer.save()
daily_20171108 = pro.daily(start_date='',end_date='',trade_date='20171108', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20171108_tscode_list = list() 
for ts_code_sh in daily_20171108['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20171108_tscode_list.append(stock_name)
daily_20171108_addname_dataframe=pd.DataFrame()
daily_20171108_addname_dataframe['cname'] = daily_20171108_tscode_list
for table_name in daily_20171108.columns.values.tolist():
    daily_20171108_addname_dataframe[table_name] = daily_20171108[table_name]
print("日线行情-时间为序  daily_20171108 返回数据 row 行数 = "+str(daily_20171108.shape[0]))
daily_20171108_addname_dataframe.to_excel(daily_201711_excel_writer,'8_3',index=False)
daily_201711_excel_writer.save()
daily_20171109 = pro.daily(start_date='',end_date='',trade_date='20171109', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20171109_tscode_list = list() 
for ts_code_sh in daily_20171109['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20171109_tscode_list.append(stock_name)
daily_20171109_addname_dataframe=pd.DataFrame()
daily_20171109_addname_dataframe['cname'] = daily_20171109_tscode_list
for table_name in daily_20171109.columns.values.tolist():
    daily_20171109_addname_dataframe[table_name] = daily_20171109[table_name]
print("日线行情-时间为序  daily_20171109 返回数据 row 行数 = "+str(daily_20171109.shape[0]))
daily_20171109_addname_dataframe.to_excel(daily_201711_excel_writer,'9_4',index=False)
daily_201711_excel_writer.save()
daily_20171110 = pro.daily(start_date='',end_date='',trade_date='20171110', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20171110_tscode_list = list() 
for ts_code_sh in daily_20171110['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20171110_tscode_list.append(stock_name)
daily_20171110_addname_dataframe=pd.DataFrame()
daily_20171110_addname_dataframe['cname'] = daily_20171110_tscode_list
for table_name in daily_20171110.columns.values.tolist():
    daily_20171110_addname_dataframe[table_name] = daily_20171110[table_name]
print("日线行情-时间为序  daily_20171110 返回数据 row 行数 = "+str(daily_20171110.shape[0]))
daily_20171110_addname_dataframe.to_excel(daily_201711_excel_writer,'10_5',index=False)
daily_201711_excel_writer.save()
daily_20171113 = pro.daily(start_date='',end_date='',trade_date='20171113', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20171113_tscode_list = list() 
for ts_code_sh in daily_20171113['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20171113_tscode_list.append(stock_name)
daily_20171113_addname_dataframe=pd.DataFrame()
daily_20171113_addname_dataframe['cname'] = daily_20171113_tscode_list
for table_name in daily_20171113.columns.values.tolist():
    daily_20171113_addname_dataframe[table_name] = daily_20171113[table_name]
print("日线行情-时间为序  daily_20171113 返回数据 row 行数 = "+str(daily_20171113.shape[0]))
daily_20171113_addname_dataframe.to_excel(daily_201711_excel_writer,'13_1',index=False)
daily_201711_excel_writer.save()
daily_20171114 = pro.daily(start_date='',end_date='',trade_date='20171114', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20171114_tscode_list = list() 
for ts_code_sh in daily_20171114['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20171114_tscode_list.append(stock_name)
daily_20171114_addname_dataframe=pd.DataFrame()
daily_20171114_addname_dataframe['cname'] = daily_20171114_tscode_list
for table_name in daily_20171114.columns.values.tolist():
    daily_20171114_addname_dataframe[table_name] = daily_20171114[table_name]
print("日线行情-时间为序  daily_20171114 返回数据 row 行数 = "+str(daily_20171114.shape[0]))
daily_20171114_addname_dataframe.to_excel(daily_201711_excel_writer,'14_2',index=False)
daily_201711_excel_writer.save()
daily_20171115 = pro.daily(start_date='',end_date='',trade_date='20171115', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20171115_tscode_list = list() 
for ts_code_sh in daily_20171115['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20171115_tscode_list.append(stock_name)
daily_20171115_addname_dataframe=pd.DataFrame()
daily_20171115_addname_dataframe['cname'] = daily_20171115_tscode_list
for table_name in daily_20171115.columns.values.tolist():
    daily_20171115_addname_dataframe[table_name] = daily_20171115[table_name]
print("日线行情-时间为序  daily_20171115 返回数据 row 行数 = "+str(daily_20171115.shape[0]))
daily_20171115_addname_dataframe.to_excel(daily_201711_excel_writer,'15_3',index=False)
daily_201711_excel_writer.save()
daily_20171116 = pro.daily(start_date='',end_date='',trade_date='20171116', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20171116_tscode_list = list() 
for ts_code_sh in daily_20171116['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20171116_tscode_list.append(stock_name)
daily_20171116_addname_dataframe=pd.DataFrame()
daily_20171116_addname_dataframe['cname'] = daily_20171116_tscode_list
for table_name in daily_20171116.columns.values.tolist():
    daily_20171116_addname_dataframe[table_name] = daily_20171116[table_name]
print("日线行情-时间为序  daily_20171116 返回数据 row 行数 = "+str(daily_20171116.shape[0]))
daily_20171116_addname_dataframe.to_excel(daily_201711_excel_writer,'16_4',index=False)
daily_201711_excel_writer.save()
daily_20171117 = pro.daily(start_date='',end_date='',trade_date='20171117', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20171117_tscode_list = list() 
for ts_code_sh in daily_20171117['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20171117_tscode_list.append(stock_name)
daily_20171117_addname_dataframe=pd.DataFrame()
daily_20171117_addname_dataframe['cname'] = daily_20171117_tscode_list
for table_name in daily_20171117.columns.values.tolist():
    daily_20171117_addname_dataframe[table_name] = daily_20171117[table_name]
print("日线行情-时间为序  daily_20171117 返回数据 row 行数 = "+str(daily_20171117.shape[0]))
daily_20171117_addname_dataframe.to_excel(daily_201711_excel_writer,'17_5',index=False)
daily_201711_excel_writer.save()
daily_20171120 = pro.daily(start_date='',end_date='',trade_date='20171120', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20171120_tscode_list = list() 
for ts_code_sh in daily_20171120['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20171120_tscode_list.append(stock_name)
daily_20171120_addname_dataframe=pd.DataFrame()
daily_20171120_addname_dataframe['cname'] = daily_20171120_tscode_list
for table_name in daily_20171120.columns.values.tolist():
    daily_20171120_addname_dataframe[table_name] = daily_20171120[table_name]
print("日线行情-时间为序  daily_20171120 返回数据 row 行数 = "+str(daily_20171120.shape[0]))
daily_20171120_addname_dataframe.to_excel(daily_201711_excel_writer,'20_1',index=False)
daily_201711_excel_writer.save()
daily_20171121 = pro.daily(start_date='',end_date='',trade_date='20171121', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20171121_tscode_list = list() 
for ts_code_sh in daily_20171121['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20171121_tscode_list.append(stock_name)
daily_20171121_addname_dataframe=pd.DataFrame()
daily_20171121_addname_dataframe['cname'] = daily_20171121_tscode_list
for table_name in daily_20171121.columns.values.tolist():
    daily_20171121_addname_dataframe[table_name] = daily_20171121[table_name]
print("日线行情-时间为序  daily_20171121 返回数据 row 行数 = "+str(daily_20171121.shape[0]))
daily_20171121_addname_dataframe.to_excel(daily_201711_excel_writer,'21_2',index=False)
daily_201711_excel_writer.save()
daily_20171122 = pro.daily(start_date='',end_date='',trade_date='20171122', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20171122_tscode_list = list() 
for ts_code_sh in daily_20171122['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20171122_tscode_list.append(stock_name)
daily_20171122_addname_dataframe=pd.DataFrame()
daily_20171122_addname_dataframe['cname'] = daily_20171122_tscode_list
for table_name in daily_20171122.columns.values.tolist():
    daily_20171122_addname_dataframe[table_name] = daily_20171122[table_name]
print("日线行情-时间为序  daily_20171122 返回数据 row 行数 = "+str(daily_20171122.shape[0]))
daily_20171122_addname_dataframe.to_excel(daily_201711_excel_writer,'22_3',index=False)
daily_201711_excel_writer.save()
daily_20171123 = pro.daily(start_date='',end_date='',trade_date='20171123', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20171123_tscode_list = list() 
for ts_code_sh in daily_20171123['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20171123_tscode_list.append(stock_name)
daily_20171123_addname_dataframe=pd.DataFrame()
daily_20171123_addname_dataframe['cname'] = daily_20171123_tscode_list
for table_name in daily_20171123.columns.values.tolist():
    daily_20171123_addname_dataframe[table_name] = daily_20171123[table_name]
print("日线行情-时间为序  daily_20171123 返回数据 row 行数 = "+str(daily_20171123.shape[0]))
daily_20171123_addname_dataframe.to_excel(daily_201711_excel_writer,'23_4',index=False)
daily_201711_excel_writer.save()
daily_20171124 = pro.daily(start_date='',end_date='',trade_date='20171124', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20171124_tscode_list = list() 
for ts_code_sh in daily_20171124['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20171124_tscode_list.append(stock_name)
daily_20171124_addname_dataframe=pd.DataFrame()
daily_20171124_addname_dataframe['cname'] = daily_20171124_tscode_list
for table_name in daily_20171124.columns.values.tolist():
    daily_20171124_addname_dataframe[table_name] = daily_20171124[table_name]
print("日线行情-时间为序  daily_20171124 返回数据 row 行数 = "+str(daily_20171124.shape[0]))
daily_20171124_addname_dataframe.to_excel(daily_201711_excel_writer,'24_5',index=False)
daily_201711_excel_writer.save()
daily_20171127 = pro.daily(start_date='',end_date='',trade_date='20171127', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20171127_tscode_list = list() 
for ts_code_sh in daily_20171127['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20171127_tscode_list.append(stock_name)
daily_20171127_addname_dataframe=pd.DataFrame()
daily_20171127_addname_dataframe['cname'] = daily_20171127_tscode_list
for table_name in daily_20171127.columns.values.tolist():
    daily_20171127_addname_dataframe[table_name] = daily_20171127[table_name]
print("日线行情-时间为序  daily_20171127 返回数据 row 行数 = "+str(daily_20171127.shape[0]))
daily_20171127_addname_dataframe.to_excel(daily_201711_excel_writer,'27_1',index=False)
daily_201711_excel_writer.save()
daily_20171128 = pro.daily(start_date='',end_date='',trade_date='20171128', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20171128_tscode_list = list() 
for ts_code_sh in daily_20171128['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20171128_tscode_list.append(stock_name)
daily_20171128_addname_dataframe=pd.DataFrame()
daily_20171128_addname_dataframe['cname'] = daily_20171128_tscode_list
for table_name in daily_20171128.columns.values.tolist():
    daily_20171128_addname_dataframe[table_name] = daily_20171128[table_name]
print("日线行情-时间为序  daily_20171128 返回数据 row 行数 = "+str(daily_20171128.shape[0]))
daily_20171128_addname_dataframe.to_excel(daily_201711_excel_writer,'28_2',index=False)
daily_201711_excel_writer.save()
daily_20171129 = pro.daily(start_date='',end_date='',trade_date='20171129', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20171129_tscode_list = list() 
for ts_code_sh in daily_20171129['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20171129_tscode_list.append(stock_name)
daily_20171129_addname_dataframe=pd.DataFrame()
daily_20171129_addname_dataframe['cname'] = daily_20171129_tscode_list
for table_name in daily_20171129.columns.values.tolist():
    daily_20171129_addname_dataframe[table_name] = daily_20171129[table_name]
print("日线行情-时间为序  daily_20171129 返回数据 row 行数 = "+str(daily_20171129.shape[0]))
daily_20171129_addname_dataframe.to_excel(daily_201711_excel_writer,'29_3',index=False)
daily_201711_excel_writer.save()
daily_20171130 = pro.daily(start_date='',end_date='',trade_date='20171130', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20171130_tscode_list = list() 
for ts_code_sh in daily_20171130['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20171130_tscode_list.append(stock_name)
daily_20171130_addname_dataframe=pd.DataFrame()
daily_20171130_addname_dataframe['cname'] = daily_20171130_tscode_list
for table_name in daily_20171130.columns.values.tolist():
    daily_20171130_addname_dataframe[table_name] = daily_20171130[table_name]
print("日线行情-时间为序  daily_20171130 返回数据 row 行数 = "+str(daily_20171130.shape[0]))
daily_20171130_addname_dataframe.to_excel(daily_201711_excel_writer,'30_4',index=False)
daily_201711_excel_writer.save()




createexcel('daily_201712.xlsx')
daily_201712_book = load_workbook('C:\\Users\\zhuzj5\\Desktop\\zbin\\J0_Data\\daily_201712.xlsx')
daily_201712_excel_writer = pd.ExcelWriter('C:\\Users\\zhuzj5\\Desktop\\zbin\\J0_Data\\daily_201712.xlsx', engine='openpyxl')
daily_201712_excel_writer.book = daily_201712_book
daily_201712_excel_writer.sheets = dict((ws.title, ws) for ws in daily_201712_book.worksheets)
J0_PROPS.put(tree_node_name+"record_date", "20171201")       ###  更新 记录日期
daily_20171201 = pro.daily(start_date='',end_date='',trade_date='20171201', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20171201_tscode_list = list() 
for ts_code_sh in daily_20171201['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20171201_tscode_list.append(stock_name)
daily_20171201_addname_dataframe=pd.DataFrame()
daily_20171201_addname_dataframe['cname'] = daily_20171201_tscode_list
for table_name in daily_20171201.columns.values.tolist():
    daily_20171201_addname_dataframe[table_name] = daily_20171201[table_name]
print("日线行情-时间为序  daily_20171201 返回数据 row 行数 = "+str(daily_20171201.shape[0]))
daily_20171201_addname_dataframe.to_excel(daily_201712_excel_writer,'1_5',index=False)
daily_201712_excel_writer.save()
daily_20171204 = pro.daily(start_date='',end_date='',trade_date='20171204', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20171204_tscode_list = list() 
for ts_code_sh in daily_20171204['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20171204_tscode_list.append(stock_name)
daily_20171204_addname_dataframe=pd.DataFrame()
daily_20171204_addname_dataframe['cname'] = daily_20171204_tscode_list
for table_name in daily_20171204.columns.values.tolist():
    daily_20171204_addname_dataframe[table_name] = daily_20171204[table_name]
print("日线行情-时间为序  daily_20171204 返回数据 row 行数 = "+str(daily_20171204.shape[0]))
daily_20171204_addname_dataframe.to_excel(daily_201712_excel_writer,'4_1',index=False)
daily_201712_excel_writer.save()
daily_20171205 = pro.daily(start_date='',end_date='',trade_date='20171205', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20171205_tscode_list = list() 
for ts_code_sh in daily_20171205['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20171205_tscode_list.append(stock_name)
daily_20171205_addname_dataframe=pd.DataFrame()
daily_20171205_addname_dataframe['cname'] = daily_20171205_tscode_list
for table_name in daily_20171205.columns.values.tolist():
    daily_20171205_addname_dataframe[table_name] = daily_20171205[table_name]
print("日线行情-时间为序  daily_20171205 返回数据 row 行数 = "+str(daily_20171205.shape[0]))
daily_20171205_addname_dataframe.to_excel(daily_201712_excel_writer,'5_2',index=False)
daily_201712_excel_writer.save()
daily_20171206 = pro.daily(start_date='',end_date='',trade_date='20171206', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20171206_tscode_list = list() 
for ts_code_sh in daily_20171206['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20171206_tscode_list.append(stock_name)
daily_20171206_addname_dataframe=pd.DataFrame()
daily_20171206_addname_dataframe['cname'] = daily_20171206_tscode_list
for table_name in daily_20171206.columns.values.tolist():
    daily_20171206_addname_dataframe[table_name] = daily_20171206[table_name]
print("日线行情-时间为序  daily_20171206 返回数据 row 行数 = "+str(daily_20171206.shape[0]))
daily_20171206_addname_dataframe.to_excel(daily_201712_excel_writer,'6_3',index=False)
daily_201712_excel_writer.save()
daily_20171207 = pro.daily(start_date='',end_date='',trade_date='20171207', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20171207_tscode_list = list() 
for ts_code_sh in daily_20171207['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20171207_tscode_list.append(stock_name)
daily_20171207_addname_dataframe=pd.DataFrame()
daily_20171207_addname_dataframe['cname'] = daily_20171207_tscode_list
for table_name in daily_20171207.columns.values.tolist():
    daily_20171207_addname_dataframe[table_name] = daily_20171207[table_name]
print("日线行情-时间为序  daily_20171207 返回数据 row 行数 = "+str(daily_20171207.shape[0]))
daily_20171207_addname_dataframe.to_excel(daily_201712_excel_writer,'7_4',index=False)
daily_201712_excel_writer.save()
daily_20171208 = pro.daily(start_date='',end_date='',trade_date='20171208', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20171208_tscode_list = list() 
for ts_code_sh in daily_20171208['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20171208_tscode_list.append(stock_name)
daily_20171208_addname_dataframe=pd.DataFrame()
daily_20171208_addname_dataframe['cname'] = daily_20171208_tscode_list
for table_name in daily_20171208.columns.values.tolist():
    daily_20171208_addname_dataframe[table_name] = daily_20171208[table_name]
print("日线行情-时间为序  daily_20171208 返回数据 row 行数 = "+str(daily_20171208.shape[0]))
daily_20171208_addname_dataframe.to_excel(daily_201712_excel_writer,'8_5',index=False)
daily_201712_excel_writer.save()
daily_20171211 = pro.daily(start_date='',end_date='',trade_date='20171211', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20171211_tscode_list = list() 
for ts_code_sh in daily_20171211['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20171211_tscode_list.append(stock_name)
daily_20171211_addname_dataframe=pd.DataFrame()
daily_20171211_addname_dataframe['cname'] = daily_20171211_tscode_list
for table_name in daily_20171211.columns.values.tolist():
    daily_20171211_addname_dataframe[table_name] = daily_20171211[table_name]
print("日线行情-时间为序  daily_20171211 返回数据 row 行数 = "+str(daily_20171211.shape[0]))
daily_20171211_addname_dataframe.to_excel(daily_201712_excel_writer,'11_1',index=False)
daily_201712_excel_writer.save()
daily_20171212 = pro.daily(start_date='',end_date='',trade_date='20171212', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20171212_tscode_list = list() 
for ts_code_sh in daily_20171212['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20171212_tscode_list.append(stock_name)
daily_20171212_addname_dataframe=pd.DataFrame()
daily_20171212_addname_dataframe['cname'] = daily_20171212_tscode_list
for table_name in daily_20171212.columns.values.tolist():
    daily_20171212_addname_dataframe[table_name] = daily_20171212[table_name]
print("日线行情-时间为序  daily_20171212 返回数据 row 行数 = "+str(daily_20171212.shape[0]))
daily_20171212_addname_dataframe.to_excel(daily_201712_excel_writer,'12_2',index=False)
daily_201712_excel_writer.save()
daily_20171213 = pro.daily(start_date='',end_date='',trade_date='20171213', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20171213_tscode_list = list() 
for ts_code_sh in daily_20171213['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20171213_tscode_list.append(stock_name)
daily_20171213_addname_dataframe=pd.DataFrame()
daily_20171213_addname_dataframe['cname'] = daily_20171213_tscode_list
for table_name in daily_20171213.columns.values.tolist():
    daily_20171213_addname_dataframe[table_name] = daily_20171213[table_name]
print("日线行情-时间为序  daily_20171213 返回数据 row 行数 = "+str(daily_20171213.shape[0]))
daily_20171213_addname_dataframe.to_excel(daily_201712_excel_writer,'13_3',index=False)
daily_201712_excel_writer.save()
daily_20171214 = pro.daily(start_date='',end_date='',trade_date='20171214', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20171214_tscode_list = list() 
for ts_code_sh in daily_20171214['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20171214_tscode_list.append(stock_name)
daily_20171214_addname_dataframe=pd.DataFrame()
daily_20171214_addname_dataframe['cname'] = daily_20171214_tscode_list
for table_name in daily_20171214.columns.values.tolist():
    daily_20171214_addname_dataframe[table_name] = daily_20171214[table_name]
print("日线行情-时间为序  daily_20171214 返回数据 row 行数 = "+str(daily_20171214.shape[0]))
daily_20171214_addname_dataframe.to_excel(daily_201712_excel_writer,'14_4',index=False)
daily_201712_excel_writer.save()
daily_20171215 = pro.daily(start_date='',end_date='',trade_date='20171215', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20171215_tscode_list = list() 
for ts_code_sh in daily_20171215['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20171215_tscode_list.append(stock_name)
daily_20171215_addname_dataframe=pd.DataFrame()
daily_20171215_addname_dataframe['cname'] = daily_20171215_tscode_list
for table_name in daily_20171215.columns.values.tolist():
    daily_20171215_addname_dataframe[table_name] = daily_20171215[table_name]
print("日线行情-时间为序  daily_20171215 返回数据 row 行数 = "+str(daily_20171215.shape[0]))
daily_20171215_addname_dataframe.to_excel(daily_201712_excel_writer,'15_5',index=False)
daily_201712_excel_writer.save()
daily_20171218 = pro.daily(start_date='',end_date='',trade_date='20171218', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20171218_tscode_list = list() 
for ts_code_sh in daily_20171218['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20171218_tscode_list.append(stock_name)
daily_20171218_addname_dataframe=pd.DataFrame()
daily_20171218_addname_dataframe['cname'] = daily_20171218_tscode_list
for table_name in daily_20171218.columns.values.tolist():
    daily_20171218_addname_dataframe[table_name] = daily_20171218[table_name]
print("日线行情-时间为序  daily_20171218 返回数据 row 行数 = "+str(daily_20171218.shape[0]))
daily_20171218_addname_dataframe.to_excel(daily_201712_excel_writer,'18_1',index=False)
daily_201712_excel_writer.save()
daily_20171219 = pro.daily(start_date='',end_date='',trade_date='20171219', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20171219_tscode_list = list() 
for ts_code_sh in daily_20171219['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20171219_tscode_list.append(stock_name)
daily_20171219_addname_dataframe=pd.DataFrame()
daily_20171219_addname_dataframe['cname'] = daily_20171219_tscode_list
for table_name in daily_20171219.columns.values.tolist():
    daily_20171219_addname_dataframe[table_name] = daily_20171219[table_name]
print("日线行情-时间为序  daily_20171219 返回数据 row 行数 = "+str(daily_20171219.shape[0]))
daily_20171219_addname_dataframe.to_excel(daily_201712_excel_writer,'19_2',index=False)
daily_201712_excel_writer.save()
daily_20171220 = pro.daily(start_date='',end_date='',trade_date='20171220', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20171220_tscode_list = list() 
for ts_code_sh in daily_20171220['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20171220_tscode_list.append(stock_name)
daily_20171220_addname_dataframe=pd.DataFrame()
daily_20171220_addname_dataframe['cname'] = daily_20171220_tscode_list
for table_name in daily_20171220.columns.values.tolist():
    daily_20171220_addname_dataframe[table_name] = daily_20171220[table_name]
print("日线行情-时间为序  daily_20171220 返回数据 row 行数 = "+str(daily_20171220.shape[0]))
daily_20171220_addname_dataframe.to_excel(daily_201712_excel_writer,'20_3',index=False)
daily_201712_excel_writer.save()
daily_20171221 = pro.daily(start_date='',end_date='',trade_date='20171221', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20171221_tscode_list = list() 
for ts_code_sh in daily_20171221['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20171221_tscode_list.append(stock_name)
daily_20171221_addname_dataframe=pd.DataFrame()
daily_20171221_addname_dataframe['cname'] = daily_20171221_tscode_list
for table_name in daily_20171221.columns.values.tolist():
    daily_20171221_addname_dataframe[table_name] = daily_20171221[table_name]
print("日线行情-时间为序  daily_20171221 返回数据 row 行数 = "+str(daily_20171221.shape[0]))
daily_20171221_addname_dataframe.to_excel(daily_201712_excel_writer,'21_4',index=False)
daily_201712_excel_writer.save()
daily_20171222 = pro.daily(start_date='',end_date='',trade_date='20171222', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20171222_tscode_list = list() 
for ts_code_sh in daily_20171222['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20171222_tscode_list.append(stock_name)
daily_20171222_addname_dataframe=pd.DataFrame()
daily_20171222_addname_dataframe['cname'] = daily_20171222_tscode_list
for table_name in daily_20171222.columns.values.tolist():
    daily_20171222_addname_dataframe[table_name] = daily_20171222[table_name]
print("日线行情-时间为序  daily_20171222 返回数据 row 行数 = "+str(daily_20171222.shape[0]))
daily_20171222_addname_dataframe.to_excel(daily_201712_excel_writer,'22_5',index=False)
daily_201712_excel_writer.save()
daily_20171225 = pro.daily(start_date='',end_date='',trade_date='20171225', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20171225_tscode_list = list() 
for ts_code_sh in daily_20171225['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20171225_tscode_list.append(stock_name)
daily_20171225_addname_dataframe=pd.DataFrame()
daily_20171225_addname_dataframe['cname'] = daily_20171225_tscode_list
for table_name in daily_20171225.columns.values.tolist():
    daily_20171225_addname_dataframe[table_name] = daily_20171225[table_name]
print("日线行情-时间为序  daily_20171225 返回数据 row 行数 = "+str(daily_20171225.shape[0]))
daily_20171225_addname_dataframe.to_excel(daily_201712_excel_writer,'25_1',index=False)
daily_201712_excel_writer.save()
daily_20171226 = pro.daily(start_date='',end_date='',trade_date='20171226', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20171226_tscode_list = list() 
for ts_code_sh in daily_20171226['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20171226_tscode_list.append(stock_name)
daily_20171226_addname_dataframe=pd.DataFrame()
daily_20171226_addname_dataframe['cname'] = daily_20171226_tscode_list
for table_name in daily_20171226.columns.values.tolist():
    daily_20171226_addname_dataframe[table_name] = daily_20171226[table_name]
print("日线行情-时间为序  daily_20171226 返回数据 row 行数 = "+str(daily_20171226.shape[0]))
daily_20171226_addname_dataframe.to_excel(daily_201712_excel_writer,'26_2',index=False)
daily_201712_excel_writer.save()
daily_20171227 = pro.daily(start_date='',end_date='',trade_date='20171227', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20171227_tscode_list = list() 
for ts_code_sh in daily_20171227['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20171227_tscode_list.append(stock_name)
daily_20171227_addname_dataframe=pd.DataFrame()
daily_20171227_addname_dataframe['cname'] = daily_20171227_tscode_list
for table_name in daily_20171227.columns.values.tolist():
    daily_20171227_addname_dataframe[table_name] = daily_20171227[table_name]
print("日线行情-时间为序  daily_20171227 返回数据 row 行数 = "+str(daily_20171227.shape[0]))
daily_20171227_addname_dataframe.to_excel(daily_201712_excel_writer,'27_3',index=False)
daily_201712_excel_writer.save()
daily_20171228 = pro.daily(start_date='',end_date='',trade_date='20171228', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20171228_tscode_list = list() 
for ts_code_sh in daily_20171228['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20171228_tscode_list.append(stock_name)
daily_20171228_addname_dataframe=pd.DataFrame()
daily_20171228_addname_dataframe['cname'] = daily_20171228_tscode_list
for table_name in daily_20171228.columns.values.tolist():
    daily_20171228_addname_dataframe[table_name] = daily_20171228[table_name]
print("日线行情-时间为序  daily_20171228 返回数据 row 行数 = "+str(daily_20171228.shape[0]))
daily_20171228_addname_dataframe.to_excel(daily_201712_excel_writer,'28_4',index=False)
daily_201712_excel_writer.save()
daily_20171229 = pro.daily(start_date='',end_date='',trade_date='20171229', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20171229_tscode_list = list() 
for ts_code_sh in daily_20171229['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20171229_tscode_list.append(stock_name)
daily_20171229_addname_dataframe=pd.DataFrame()
daily_20171229_addname_dataframe['cname'] = daily_20171229_tscode_list
for table_name in daily_20171229.columns.values.tolist():
    daily_20171229_addname_dataframe[table_name] = daily_20171229[table_name]
print("日线行情-时间为序  daily_20171229 返回数据 row 行数 = "+str(daily_20171229.shape[0]))
daily_20171229_addname_dataframe.to_excel(daily_201712_excel_writer,'29_5',index=False)
daily_201712_excel_writer.save()




createexcel('daily_201801.xlsx')
daily_201801_book = load_workbook('C:\\Users\\zhuzj5\\Desktop\\zbin\\J0_Data\\daily_201801.xlsx')
daily_201801_excel_writer = pd.ExcelWriter('C:\\Users\\zhuzj5\\Desktop\\zbin\\J0_Data\\daily_201801.xlsx', engine='openpyxl')
daily_201801_excel_writer.book = daily_201801_book
daily_201801_excel_writer.sheets = dict((ws.title, ws) for ws in daily_201801_book.worksheets)
J0_PROPS.put(tree_node_name+"record_date", "20180101")       ###  更新 记录日期
daily_20180102 = pro.daily(start_date='',end_date='',trade_date='20180102', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20180102_tscode_list = list() 
for ts_code_sh in daily_20180102['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20180102_tscode_list.append(stock_name)
daily_20180102_addname_dataframe=pd.DataFrame()
daily_20180102_addname_dataframe['cname'] = daily_20180102_tscode_list
for table_name in daily_20180102.columns.values.tolist():
    daily_20180102_addname_dataframe[table_name] = daily_20180102[table_name]
print("日线行情-时间为序  daily_20180102 返回数据 row 行数 = "+str(daily_20180102.shape[0]))
daily_20180102_addname_dataframe.to_excel(daily_201801_excel_writer,'2_2',index=False)
daily_201801_excel_writer.save()
daily_20180103 = pro.daily(start_date='',end_date='',trade_date='20180103', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20180103_tscode_list = list() 
for ts_code_sh in daily_20180103['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20180103_tscode_list.append(stock_name)
daily_20180103_addname_dataframe=pd.DataFrame()
daily_20180103_addname_dataframe['cname'] = daily_20180103_tscode_list
for table_name in daily_20180103.columns.values.tolist():
    daily_20180103_addname_dataframe[table_name] = daily_20180103[table_name]
print("日线行情-时间为序  daily_20180103 返回数据 row 行数 = "+str(daily_20180103.shape[0]))
daily_20180103_addname_dataframe.to_excel(daily_201801_excel_writer,'3_3',index=False)
daily_201801_excel_writer.save()
daily_20180104 = pro.daily(start_date='',end_date='',trade_date='20180104', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20180104_tscode_list = list() 
for ts_code_sh in daily_20180104['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20180104_tscode_list.append(stock_name)
daily_20180104_addname_dataframe=pd.DataFrame()
daily_20180104_addname_dataframe['cname'] = daily_20180104_tscode_list
for table_name in daily_20180104.columns.values.tolist():
    daily_20180104_addname_dataframe[table_name] = daily_20180104[table_name]
print("日线行情-时间为序  daily_20180104 返回数据 row 行数 = "+str(daily_20180104.shape[0]))
daily_20180104_addname_dataframe.to_excel(daily_201801_excel_writer,'4_4',index=False)
daily_201801_excel_writer.save()
daily_20180105 = pro.daily(start_date='',end_date='',trade_date='20180105', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20180105_tscode_list = list() 
for ts_code_sh in daily_20180105['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20180105_tscode_list.append(stock_name)
daily_20180105_addname_dataframe=pd.DataFrame()
daily_20180105_addname_dataframe['cname'] = daily_20180105_tscode_list
for table_name in daily_20180105.columns.values.tolist():
    daily_20180105_addname_dataframe[table_name] = daily_20180105[table_name]
print("日线行情-时间为序  daily_20180105 返回数据 row 行数 = "+str(daily_20180105.shape[0]))
daily_20180105_addname_dataframe.to_excel(daily_201801_excel_writer,'5_5',index=False)
daily_201801_excel_writer.save()
daily_20180108 = pro.daily(start_date='',end_date='',trade_date='20180108', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20180108_tscode_list = list() 
for ts_code_sh in daily_20180108['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20180108_tscode_list.append(stock_name)
daily_20180108_addname_dataframe=pd.DataFrame()
daily_20180108_addname_dataframe['cname'] = daily_20180108_tscode_list
for table_name in daily_20180108.columns.values.tolist():
    daily_20180108_addname_dataframe[table_name] = daily_20180108[table_name]
print("日线行情-时间为序  daily_20180108 返回数据 row 行数 = "+str(daily_20180108.shape[0]))
daily_20180108_addname_dataframe.to_excel(daily_201801_excel_writer,'8_1',index=False)
daily_201801_excel_writer.save()
daily_20180109 = pro.daily(start_date='',end_date='',trade_date='20180109', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20180109_tscode_list = list() 
for ts_code_sh in daily_20180109['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20180109_tscode_list.append(stock_name)
daily_20180109_addname_dataframe=pd.DataFrame()
daily_20180109_addname_dataframe['cname'] = daily_20180109_tscode_list
for table_name in daily_20180109.columns.values.tolist():
    daily_20180109_addname_dataframe[table_name] = daily_20180109[table_name]
print("日线行情-时间为序  daily_20180109 返回数据 row 行数 = "+str(daily_20180109.shape[0]))
daily_20180109_addname_dataframe.to_excel(daily_201801_excel_writer,'9_2',index=False)
daily_201801_excel_writer.save()
daily_20180110 = pro.daily(start_date='',end_date='',trade_date='20180110', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20180110_tscode_list = list() 
for ts_code_sh in daily_20180110['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20180110_tscode_list.append(stock_name)
daily_20180110_addname_dataframe=pd.DataFrame()
daily_20180110_addname_dataframe['cname'] = daily_20180110_tscode_list
for table_name in daily_20180110.columns.values.tolist():
    daily_20180110_addname_dataframe[table_name] = daily_20180110[table_name]
print("日线行情-时间为序  daily_20180110 返回数据 row 行数 = "+str(daily_20180110.shape[0]))
daily_20180110_addname_dataframe.to_excel(daily_201801_excel_writer,'10_3',index=False)
daily_201801_excel_writer.save()
daily_20180111 = pro.daily(start_date='',end_date='',trade_date='20180111', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20180111_tscode_list = list() 
for ts_code_sh in daily_20180111['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20180111_tscode_list.append(stock_name)
daily_20180111_addname_dataframe=pd.DataFrame()
daily_20180111_addname_dataframe['cname'] = daily_20180111_tscode_list
for table_name in daily_20180111.columns.values.tolist():
    daily_20180111_addname_dataframe[table_name] = daily_20180111[table_name]
print("日线行情-时间为序  daily_20180111 返回数据 row 行数 = "+str(daily_20180111.shape[0]))
daily_20180111_addname_dataframe.to_excel(daily_201801_excel_writer,'11_4',index=False)
daily_201801_excel_writer.save()
daily_20180112 = pro.daily(start_date='',end_date='',trade_date='20180112', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20180112_tscode_list = list() 
for ts_code_sh in daily_20180112['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20180112_tscode_list.append(stock_name)
daily_20180112_addname_dataframe=pd.DataFrame()
daily_20180112_addname_dataframe['cname'] = daily_20180112_tscode_list
for table_name in daily_20180112.columns.values.tolist():
    daily_20180112_addname_dataframe[table_name] = daily_20180112[table_name]
print("日线行情-时间为序  daily_20180112 返回数据 row 行数 = "+str(daily_20180112.shape[0]))
daily_20180112_addname_dataframe.to_excel(daily_201801_excel_writer,'12_5',index=False)
daily_201801_excel_writer.save()
daily_20180115 = pro.daily(start_date='',end_date='',trade_date='20180115', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20180115_tscode_list = list() 
for ts_code_sh in daily_20180115['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20180115_tscode_list.append(stock_name)
daily_20180115_addname_dataframe=pd.DataFrame()
daily_20180115_addname_dataframe['cname'] = daily_20180115_tscode_list
for table_name in daily_20180115.columns.values.tolist():
    daily_20180115_addname_dataframe[table_name] = daily_20180115[table_name]
print("日线行情-时间为序  daily_20180115 返回数据 row 行数 = "+str(daily_20180115.shape[0]))
daily_20180115_addname_dataframe.to_excel(daily_201801_excel_writer,'15_1',index=False)
daily_201801_excel_writer.save()
daily_20180116 = pro.daily(start_date='',end_date='',trade_date='20180116', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20180116_tscode_list = list() 
for ts_code_sh in daily_20180116['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20180116_tscode_list.append(stock_name)
daily_20180116_addname_dataframe=pd.DataFrame()
daily_20180116_addname_dataframe['cname'] = daily_20180116_tscode_list
for table_name in daily_20180116.columns.values.tolist():
    daily_20180116_addname_dataframe[table_name] = daily_20180116[table_name]
print("日线行情-时间为序  daily_20180116 返回数据 row 行数 = "+str(daily_20180116.shape[0]))
daily_20180116_addname_dataframe.to_excel(daily_201801_excel_writer,'16_2',index=False)
daily_201801_excel_writer.save()
daily_20180117 = pro.daily(start_date='',end_date='',trade_date='20180117', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20180117_tscode_list = list() 
for ts_code_sh in daily_20180117['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20180117_tscode_list.append(stock_name)
daily_20180117_addname_dataframe=pd.DataFrame()
daily_20180117_addname_dataframe['cname'] = daily_20180117_tscode_list
for table_name in daily_20180117.columns.values.tolist():
    daily_20180117_addname_dataframe[table_name] = daily_20180117[table_name]
print("日线行情-时间为序  daily_20180117 返回数据 row 行数 = "+str(daily_20180117.shape[0]))
daily_20180117_addname_dataframe.to_excel(daily_201801_excel_writer,'17_3',index=False)
daily_201801_excel_writer.save()
daily_20180118 = pro.daily(start_date='',end_date='',trade_date='20180118', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20180118_tscode_list = list() 
for ts_code_sh in daily_20180118['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20180118_tscode_list.append(stock_name)
daily_20180118_addname_dataframe=pd.DataFrame()
daily_20180118_addname_dataframe['cname'] = daily_20180118_tscode_list
for table_name in daily_20180118.columns.values.tolist():
    daily_20180118_addname_dataframe[table_name] = daily_20180118[table_name]
print("日线行情-时间为序  daily_20180118 返回数据 row 行数 = "+str(daily_20180118.shape[0]))
daily_20180118_addname_dataframe.to_excel(daily_201801_excel_writer,'18_4',index=False)
daily_201801_excel_writer.save()
daily_20180119 = pro.daily(start_date='',end_date='',trade_date='20180119', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20180119_tscode_list = list() 
for ts_code_sh in daily_20180119['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20180119_tscode_list.append(stock_name)
daily_20180119_addname_dataframe=pd.DataFrame()
daily_20180119_addname_dataframe['cname'] = daily_20180119_tscode_list
for table_name in daily_20180119.columns.values.tolist():
    daily_20180119_addname_dataframe[table_name] = daily_20180119[table_name]
print("日线行情-时间为序  daily_20180119 返回数据 row 行数 = "+str(daily_20180119.shape[0]))
daily_20180119_addname_dataframe.to_excel(daily_201801_excel_writer,'19_5',index=False)
daily_201801_excel_writer.save()
daily_20180122 = pro.daily(start_date='',end_date='',trade_date='20180122', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20180122_tscode_list = list() 
for ts_code_sh in daily_20180122['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20180122_tscode_list.append(stock_name)
daily_20180122_addname_dataframe=pd.DataFrame()
daily_20180122_addname_dataframe['cname'] = daily_20180122_tscode_list
for table_name in daily_20180122.columns.values.tolist():
    daily_20180122_addname_dataframe[table_name] = daily_20180122[table_name]
print("日线行情-时间为序  daily_20180122 返回数据 row 行数 = "+str(daily_20180122.shape[0]))
daily_20180122_addname_dataframe.to_excel(daily_201801_excel_writer,'22_1',index=False)
daily_201801_excel_writer.save()
daily_20180123 = pro.daily(start_date='',end_date='',trade_date='20180123', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20180123_tscode_list = list() 
for ts_code_sh in daily_20180123['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20180123_tscode_list.append(stock_name)
daily_20180123_addname_dataframe=pd.DataFrame()
daily_20180123_addname_dataframe['cname'] = daily_20180123_tscode_list
for table_name in daily_20180123.columns.values.tolist():
    daily_20180123_addname_dataframe[table_name] = daily_20180123[table_name]
print("日线行情-时间为序  daily_20180123 返回数据 row 行数 = "+str(daily_20180123.shape[0]))
daily_20180123_addname_dataframe.to_excel(daily_201801_excel_writer,'23_2',index=False)
daily_201801_excel_writer.save()
daily_20180124 = pro.daily(start_date='',end_date='',trade_date='20180124', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20180124_tscode_list = list() 
for ts_code_sh in daily_20180124['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20180124_tscode_list.append(stock_name)
daily_20180124_addname_dataframe=pd.DataFrame()
daily_20180124_addname_dataframe['cname'] = daily_20180124_tscode_list
for table_name in daily_20180124.columns.values.tolist():
    daily_20180124_addname_dataframe[table_name] = daily_20180124[table_name]
print("日线行情-时间为序  daily_20180124 返回数据 row 行数 = "+str(daily_20180124.shape[0]))
daily_20180124_addname_dataframe.to_excel(daily_201801_excel_writer,'24_3',index=False)
daily_201801_excel_writer.save()
daily_20180125 = pro.daily(start_date='',end_date='',trade_date='20180125', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20180125_tscode_list = list() 
for ts_code_sh in daily_20180125['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20180125_tscode_list.append(stock_name)
daily_20180125_addname_dataframe=pd.DataFrame()
daily_20180125_addname_dataframe['cname'] = daily_20180125_tscode_list
for table_name in daily_20180125.columns.values.tolist():
    daily_20180125_addname_dataframe[table_name] = daily_20180125[table_name]
print("日线行情-时间为序  daily_20180125 返回数据 row 行数 = "+str(daily_20180125.shape[0]))
daily_20180125_addname_dataframe.to_excel(daily_201801_excel_writer,'25_4',index=False)
daily_201801_excel_writer.save()
daily_20180126 = pro.daily(start_date='',end_date='',trade_date='20180126', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20180126_tscode_list = list() 
for ts_code_sh in daily_20180126['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20180126_tscode_list.append(stock_name)
daily_20180126_addname_dataframe=pd.DataFrame()
daily_20180126_addname_dataframe['cname'] = daily_20180126_tscode_list
for table_name in daily_20180126.columns.values.tolist():
    daily_20180126_addname_dataframe[table_name] = daily_20180126[table_name]
print("日线行情-时间为序  daily_20180126 返回数据 row 行数 = "+str(daily_20180126.shape[0]))
daily_20180126_addname_dataframe.to_excel(daily_201801_excel_writer,'26_5',index=False)
daily_201801_excel_writer.save()
daily_20180129 = pro.daily(start_date='',end_date='',trade_date='20180129', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20180129_tscode_list = list() 
for ts_code_sh in daily_20180129['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20180129_tscode_list.append(stock_name)
daily_20180129_addname_dataframe=pd.DataFrame()
daily_20180129_addname_dataframe['cname'] = daily_20180129_tscode_list
for table_name in daily_20180129.columns.values.tolist():
    daily_20180129_addname_dataframe[table_name] = daily_20180129[table_name]
print("日线行情-时间为序  daily_20180129 返回数据 row 行数 = "+str(daily_20180129.shape[0]))
daily_20180129_addname_dataframe.to_excel(daily_201801_excel_writer,'29_1',index=False)
daily_201801_excel_writer.save()
daily_20180130 = pro.daily(start_date='',end_date='',trade_date='20180130', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20180130_tscode_list = list() 
for ts_code_sh in daily_20180130['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20180130_tscode_list.append(stock_name)
daily_20180130_addname_dataframe=pd.DataFrame()
daily_20180130_addname_dataframe['cname'] = daily_20180130_tscode_list
for table_name in daily_20180130.columns.values.tolist():
    daily_20180130_addname_dataframe[table_name] = daily_20180130[table_name]
print("日线行情-时间为序  daily_20180130 返回数据 row 行数 = "+str(daily_20180130.shape[0]))
daily_20180130_addname_dataframe.to_excel(daily_201801_excel_writer,'30_2',index=False)
daily_201801_excel_writer.save()
daily_20180131 = pro.daily(start_date='',end_date='',trade_date='20180131', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20180131_tscode_list = list() 
for ts_code_sh in daily_20180131['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20180131_tscode_list.append(stock_name)
daily_20180131_addname_dataframe=pd.DataFrame()
daily_20180131_addname_dataframe['cname'] = daily_20180131_tscode_list
for table_name in daily_20180131.columns.values.tolist():
    daily_20180131_addname_dataframe[table_name] = daily_20180131[table_name]
print("日线行情-时间为序  daily_20180131 返回数据 row 行数 = "+str(daily_20180131.shape[0]))
daily_20180131_addname_dataframe.to_excel(daily_201801_excel_writer,'31_3',index=False)
daily_201801_excel_writer.save()




createexcel('daily_201802.xlsx')
daily_201802_book = load_workbook('C:\\Users\\zhuzj5\\Desktop\\zbin\\J0_Data\\daily_201802.xlsx')
daily_201802_excel_writer = pd.ExcelWriter('C:\\Users\\zhuzj5\\Desktop\\zbin\\J0_Data\\daily_201802.xlsx', engine='openpyxl')
daily_201802_excel_writer.book = daily_201802_book
daily_201802_excel_writer.sheets = dict((ws.title, ws) for ws in daily_201802_book.worksheets)
J0_PROPS.put(tree_node_name+"record_date", "20180201")       ###  更新 记录日期
daily_20180201 = pro.daily(start_date='',end_date='',trade_date='20180201', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20180201_tscode_list = list() 
for ts_code_sh in daily_20180201['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20180201_tscode_list.append(stock_name)
daily_20180201_addname_dataframe=pd.DataFrame()
daily_20180201_addname_dataframe['cname'] = daily_20180201_tscode_list
for table_name in daily_20180201.columns.values.tolist():
    daily_20180201_addname_dataframe[table_name] = daily_20180201[table_name]
print("日线行情-时间为序  daily_20180201 返回数据 row 行数 = "+str(daily_20180201.shape[0]))
daily_20180201_addname_dataframe.to_excel(daily_201802_excel_writer,'1_4',index=False)
daily_201802_excel_writer.save()
daily_20180202 = pro.daily(start_date='',end_date='',trade_date='20180202', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20180202_tscode_list = list() 
for ts_code_sh in daily_20180202['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20180202_tscode_list.append(stock_name)
daily_20180202_addname_dataframe=pd.DataFrame()
daily_20180202_addname_dataframe['cname'] = daily_20180202_tscode_list
for table_name in daily_20180202.columns.values.tolist():
    daily_20180202_addname_dataframe[table_name] = daily_20180202[table_name]
print("日线行情-时间为序  daily_20180202 返回数据 row 行数 = "+str(daily_20180202.shape[0]))
daily_20180202_addname_dataframe.to_excel(daily_201802_excel_writer,'2_5',index=False)
daily_201802_excel_writer.save()
daily_20180205 = pro.daily(start_date='',end_date='',trade_date='20180205', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20180205_tscode_list = list() 
for ts_code_sh in daily_20180205['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20180205_tscode_list.append(stock_name)
daily_20180205_addname_dataframe=pd.DataFrame()
daily_20180205_addname_dataframe['cname'] = daily_20180205_tscode_list
for table_name in daily_20180205.columns.values.tolist():
    daily_20180205_addname_dataframe[table_name] = daily_20180205[table_name]
print("日线行情-时间为序  daily_20180205 返回数据 row 行数 = "+str(daily_20180205.shape[0]))
daily_20180205_addname_dataframe.to_excel(daily_201802_excel_writer,'5_1',index=False)
daily_201802_excel_writer.save()
daily_20180206 = pro.daily(start_date='',end_date='',trade_date='20180206', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20180206_tscode_list = list() 
for ts_code_sh in daily_20180206['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20180206_tscode_list.append(stock_name)
daily_20180206_addname_dataframe=pd.DataFrame()
daily_20180206_addname_dataframe['cname'] = daily_20180206_tscode_list
for table_name in daily_20180206.columns.values.tolist():
    daily_20180206_addname_dataframe[table_name] = daily_20180206[table_name]
print("日线行情-时间为序  daily_20180206 返回数据 row 行数 = "+str(daily_20180206.shape[0]))
daily_20180206_addname_dataframe.to_excel(daily_201802_excel_writer,'6_2',index=False)
daily_201802_excel_writer.save()
daily_20180207 = pro.daily(start_date='',end_date='',trade_date='20180207', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20180207_tscode_list = list() 
for ts_code_sh in daily_20180207['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20180207_tscode_list.append(stock_name)
daily_20180207_addname_dataframe=pd.DataFrame()
daily_20180207_addname_dataframe['cname'] = daily_20180207_tscode_list
for table_name in daily_20180207.columns.values.tolist():
    daily_20180207_addname_dataframe[table_name] = daily_20180207[table_name]
print("日线行情-时间为序  daily_20180207 返回数据 row 行数 = "+str(daily_20180207.shape[0]))
daily_20180207_addname_dataframe.to_excel(daily_201802_excel_writer,'7_3',index=False)
daily_201802_excel_writer.save()
daily_20180208 = pro.daily(start_date='',end_date='',trade_date='20180208', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20180208_tscode_list = list() 
for ts_code_sh in daily_20180208['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20180208_tscode_list.append(stock_name)
daily_20180208_addname_dataframe=pd.DataFrame()
daily_20180208_addname_dataframe['cname'] = daily_20180208_tscode_list
for table_name in daily_20180208.columns.values.tolist():
    daily_20180208_addname_dataframe[table_name] = daily_20180208[table_name]
print("日线行情-时间为序  daily_20180208 返回数据 row 行数 = "+str(daily_20180208.shape[0]))
daily_20180208_addname_dataframe.to_excel(daily_201802_excel_writer,'8_4',index=False)
daily_201802_excel_writer.save()
daily_20180209 = pro.daily(start_date='',end_date='',trade_date='20180209', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20180209_tscode_list = list() 
for ts_code_sh in daily_20180209['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20180209_tscode_list.append(stock_name)
daily_20180209_addname_dataframe=pd.DataFrame()
daily_20180209_addname_dataframe['cname'] = daily_20180209_tscode_list
for table_name in daily_20180209.columns.values.tolist():
    daily_20180209_addname_dataframe[table_name] = daily_20180209[table_name]
print("日线行情-时间为序  daily_20180209 返回数据 row 行数 = "+str(daily_20180209.shape[0]))
daily_20180209_addname_dataframe.to_excel(daily_201802_excel_writer,'9_5',index=False)
daily_201802_excel_writer.save()
daily_20180212 = pro.daily(start_date='',end_date='',trade_date='20180212', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20180212_tscode_list = list() 
for ts_code_sh in daily_20180212['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20180212_tscode_list.append(stock_name)
daily_20180212_addname_dataframe=pd.DataFrame()
daily_20180212_addname_dataframe['cname'] = daily_20180212_tscode_list
for table_name in daily_20180212.columns.values.tolist():
    daily_20180212_addname_dataframe[table_name] = daily_20180212[table_name]
print("日线行情-时间为序  daily_20180212 返回数据 row 行数 = "+str(daily_20180212.shape[0]))
daily_20180212_addname_dataframe.to_excel(daily_201802_excel_writer,'12_1',index=False)
daily_201802_excel_writer.save()
daily_20180213 = pro.daily(start_date='',end_date='',trade_date='20180213', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20180213_tscode_list = list() 
for ts_code_sh in daily_20180213['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20180213_tscode_list.append(stock_name)
daily_20180213_addname_dataframe=pd.DataFrame()
daily_20180213_addname_dataframe['cname'] = daily_20180213_tscode_list
for table_name in daily_20180213.columns.values.tolist():
    daily_20180213_addname_dataframe[table_name] = daily_20180213[table_name]
print("日线行情-时间为序  daily_20180213 返回数据 row 行数 = "+str(daily_20180213.shape[0]))
daily_20180213_addname_dataframe.to_excel(daily_201802_excel_writer,'13_2',index=False)
daily_201802_excel_writer.save()
daily_20180214 = pro.daily(start_date='',end_date='',trade_date='20180214', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20180214_tscode_list = list() 
for ts_code_sh in daily_20180214['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20180214_tscode_list.append(stock_name)
daily_20180214_addname_dataframe=pd.DataFrame()
daily_20180214_addname_dataframe['cname'] = daily_20180214_tscode_list
for table_name in daily_20180214.columns.values.tolist():
    daily_20180214_addname_dataframe[table_name] = daily_20180214[table_name]
print("日线行情-时间为序  daily_20180214 返回数据 row 行数 = "+str(daily_20180214.shape[0]))
daily_20180214_addname_dataframe.to_excel(daily_201802_excel_writer,'14_3',index=False)
daily_201802_excel_writer.save()
daily_20180222 = pro.daily(start_date='',end_date='',trade_date='20180222', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20180222_tscode_list = list() 
for ts_code_sh in daily_20180222['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20180222_tscode_list.append(stock_name)
daily_20180222_addname_dataframe=pd.DataFrame()
daily_20180222_addname_dataframe['cname'] = daily_20180222_tscode_list
for table_name in daily_20180222.columns.values.tolist():
    daily_20180222_addname_dataframe[table_name] = daily_20180222[table_name]
print("日线行情-时间为序  daily_20180222 返回数据 row 行数 = "+str(daily_20180222.shape[0]))
daily_20180222_addname_dataframe.to_excel(daily_201802_excel_writer,'22_4',index=False)
daily_201802_excel_writer.save()
daily_20180223 = pro.daily(start_date='',end_date='',trade_date='20180223', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20180223_tscode_list = list() 
for ts_code_sh in daily_20180223['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20180223_tscode_list.append(stock_name)
daily_20180223_addname_dataframe=pd.DataFrame()
daily_20180223_addname_dataframe['cname'] = daily_20180223_tscode_list
for table_name in daily_20180223.columns.values.tolist():
    daily_20180223_addname_dataframe[table_name] = daily_20180223[table_name]
print("日线行情-时间为序  daily_20180223 返回数据 row 行数 = "+str(daily_20180223.shape[0]))
daily_20180223_addname_dataframe.to_excel(daily_201802_excel_writer,'23_5',index=False)
daily_201802_excel_writer.save()
daily_20180226 = pro.daily(start_date='',end_date='',trade_date='20180226', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20180226_tscode_list = list() 
for ts_code_sh in daily_20180226['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20180226_tscode_list.append(stock_name)
daily_20180226_addname_dataframe=pd.DataFrame()
daily_20180226_addname_dataframe['cname'] = daily_20180226_tscode_list
for table_name in daily_20180226.columns.values.tolist():
    daily_20180226_addname_dataframe[table_name] = daily_20180226[table_name]
print("日线行情-时间为序  daily_20180226 返回数据 row 行数 = "+str(daily_20180226.shape[0]))
daily_20180226_addname_dataframe.to_excel(daily_201802_excel_writer,'26_1',index=False)
daily_201802_excel_writer.save()
daily_20180227 = pro.daily(start_date='',end_date='',trade_date='20180227', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20180227_tscode_list = list() 
for ts_code_sh in daily_20180227['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20180227_tscode_list.append(stock_name)
daily_20180227_addname_dataframe=pd.DataFrame()
daily_20180227_addname_dataframe['cname'] = daily_20180227_tscode_list
for table_name in daily_20180227.columns.values.tolist():
    daily_20180227_addname_dataframe[table_name] = daily_20180227[table_name]
print("日线行情-时间为序  daily_20180227 返回数据 row 行数 = "+str(daily_20180227.shape[0]))
daily_20180227_addname_dataframe.to_excel(daily_201802_excel_writer,'27_2',index=False)
daily_201802_excel_writer.save()
daily_20180228 = pro.daily(start_date='',end_date='',trade_date='20180228', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20180228_tscode_list = list() 
for ts_code_sh in daily_20180228['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20180228_tscode_list.append(stock_name)
daily_20180228_addname_dataframe=pd.DataFrame()
daily_20180228_addname_dataframe['cname'] = daily_20180228_tscode_list
for table_name in daily_20180228.columns.values.tolist():
    daily_20180228_addname_dataframe[table_name] = daily_20180228[table_name]
print("日线行情-时间为序  daily_20180228 返回数据 row 行数 = "+str(daily_20180228.shape[0]))
daily_20180228_addname_dataframe.to_excel(daily_201802_excel_writer,'28_3',index=False)
daily_201802_excel_writer.save()




createexcel('daily_201803.xlsx')
daily_201803_book = load_workbook('C:\\Users\\zhuzj5\\Desktop\\zbin\\J0_Data\\daily_201803.xlsx')
daily_201803_excel_writer = pd.ExcelWriter('C:\\Users\\zhuzj5\\Desktop\\zbin\\J0_Data\\daily_201803.xlsx', engine='openpyxl')
daily_201803_excel_writer.book = daily_201803_book
daily_201803_excel_writer.sheets = dict((ws.title, ws) for ws in daily_201803_book.worksheets)
J0_PROPS.put(tree_node_name+"record_date", "20180301")       ###  更新 记录日期
daily_20180301 = pro.daily(start_date='',end_date='',trade_date='20180301', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20180301_tscode_list = list() 
for ts_code_sh in daily_20180301['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20180301_tscode_list.append(stock_name)
daily_20180301_addname_dataframe=pd.DataFrame()
daily_20180301_addname_dataframe['cname'] = daily_20180301_tscode_list
for table_name in daily_20180301.columns.values.tolist():
    daily_20180301_addname_dataframe[table_name] = daily_20180301[table_name]
print("日线行情-时间为序  daily_20180301 返回数据 row 行数 = "+str(daily_20180301.shape[0]))
daily_20180301_addname_dataframe.to_excel(daily_201803_excel_writer,'1_4',index=False)
daily_201803_excel_writer.save()
daily_20180302 = pro.daily(start_date='',end_date='',trade_date='20180302', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20180302_tscode_list = list() 
for ts_code_sh in daily_20180302['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20180302_tscode_list.append(stock_name)
daily_20180302_addname_dataframe=pd.DataFrame()
daily_20180302_addname_dataframe['cname'] = daily_20180302_tscode_list
for table_name in daily_20180302.columns.values.tolist():
    daily_20180302_addname_dataframe[table_name] = daily_20180302[table_name]
print("日线行情-时间为序  daily_20180302 返回数据 row 行数 = "+str(daily_20180302.shape[0]))
daily_20180302_addname_dataframe.to_excel(daily_201803_excel_writer,'2_5',index=False)
daily_201803_excel_writer.save()
daily_20180305 = pro.daily(start_date='',end_date='',trade_date='20180305', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20180305_tscode_list = list() 
for ts_code_sh in daily_20180305['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20180305_tscode_list.append(stock_name)
daily_20180305_addname_dataframe=pd.DataFrame()
daily_20180305_addname_dataframe['cname'] = daily_20180305_tscode_list
for table_name in daily_20180305.columns.values.tolist():
    daily_20180305_addname_dataframe[table_name] = daily_20180305[table_name]
print("日线行情-时间为序  daily_20180305 返回数据 row 行数 = "+str(daily_20180305.shape[0]))
daily_20180305_addname_dataframe.to_excel(daily_201803_excel_writer,'5_1',index=False)
daily_201803_excel_writer.save()
daily_20180306 = pro.daily(start_date='',end_date='',trade_date='20180306', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20180306_tscode_list = list() 
for ts_code_sh in daily_20180306['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20180306_tscode_list.append(stock_name)
daily_20180306_addname_dataframe=pd.DataFrame()
daily_20180306_addname_dataframe['cname'] = daily_20180306_tscode_list
for table_name in daily_20180306.columns.values.tolist():
    daily_20180306_addname_dataframe[table_name] = daily_20180306[table_name]
print("日线行情-时间为序  daily_20180306 返回数据 row 行数 = "+str(daily_20180306.shape[0]))
daily_20180306_addname_dataframe.to_excel(daily_201803_excel_writer,'6_2',index=False)
daily_201803_excel_writer.save()
daily_20180307 = pro.daily(start_date='',end_date='',trade_date='20180307', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20180307_tscode_list = list() 
for ts_code_sh in daily_20180307['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20180307_tscode_list.append(stock_name)
daily_20180307_addname_dataframe=pd.DataFrame()
daily_20180307_addname_dataframe['cname'] = daily_20180307_tscode_list
for table_name in daily_20180307.columns.values.tolist():
    daily_20180307_addname_dataframe[table_name] = daily_20180307[table_name]
print("日线行情-时间为序  daily_20180307 返回数据 row 行数 = "+str(daily_20180307.shape[0]))
daily_20180307_addname_dataframe.to_excel(daily_201803_excel_writer,'7_3',index=False)
daily_201803_excel_writer.save()
daily_20180308 = pro.daily(start_date='',end_date='',trade_date='20180308', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20180308_tscode_list = list() 
for ts_code_sh in daily_20180308['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20180308_tscode_list.append(stock_name)
daily_20180308_addname_dataframe=pd.DataFrame()
daily_20180308_addname_dataframe['cname'] = daily_20180308_tscode_list
for table_name in daily_20180308.columns.values.tolist():
    daily_20180308_addname_dataframe[table_name] = daily_20180308[table_name]
print("日线行情-时间为序  daily_20180308 返回数据 row 行数 = "+str(daily_20180308.shape[0]))
daily_20180308_addname_dataframe.to_excel(daily_201803_excel_writer,'8_4',index=False)
daily_201803_excel_writer.save()
daily_20180309 = pro.daily(start_date='',end_date='',trade_date='20180309', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20180309_tscode_list = list() 
for ts_code_sh in daily_20180309['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20180309_tscode_list.append(stock_name)
daily_20180309_addname_dataframe=pd.DataFrame()
daily_20180309_addname_dataframe['cname'] = daily_20180309_tscode_list
for table_name in daily_20180309.columns.values.tolist():
    daily_20180309_addname_dataframe[table_name] = daily_20180309[table_name]
print("日线行情-时间为序  daily_20180309 返回数据 row 行数 = "+str(daily_20180309.shape[0]))
daily_20180309_addname_dataframe.to_excel(daily_201803_excel_writer,'9_5',index=False)
daily_201803_excel_writer.save()
daily_20180312 = pro.daily(start_date='',end_date='',trade_date='20180312', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20180312_tscode_list = list() 
for ts_code_sh in daily_20180312['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20180312_tscode_list.append(stock_name)
daily_20180312_addname_dataframe=pd.DataFrame()
daily_20180312_addname_dataframe['cname'] = daily_20180312_tscode_list
for table_name in daily_20180312.columns.values.tolist():
    daily_20180312_addname_dataframe[table_name] = daily_20180312[table_name]
print("日线行情-时间为序  daily_20180312 返回数据 row 行数 = "+str(daily_20180312.shape[0]))
daily_20180312_addname_dataframe.to_excel(daily_201803_excel_writer,'12_1',index=False)
daily_201803_excel_writer.save()
daily_20180313 = pro.daily(start_date='',end_date='',trade_date='20180313', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20180313_tscode_list = list() 
for ts_code_sh in daily_20180313['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20180313_tscode_list.append(stock_name)
daily_20180313_addname_dataframe=pd.DataFrame()
daily_20180313_addname_dataframe['cname'] = daily_20180313_tscode_list
for table_name in daily_20180313.columns.values.tolist():
    daily_20180313_addname_dataframe[table_name] = daily_20180313[table_name]
print("日线行情-时间为序  daily_20180313 返回数据 row 行数 = "+str(daily_20180313.shape[0]))
daily_20180313_addname_dataframe.to_excel(daily_201803_excel_writer,'13_2',index=False)
daily_201803_excel_writer.save()
daily_20180314 = pro.daily(start_date='',end_date='',trade_date='20180314', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20180314_tscode_list = list() 
for ts_code_sh in daily_20180314['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20180314_tscode_list.append(stock_name)
daily_20180314_addname_dataframe=pd.DataFrame()
daily_20180314_addname_dataframe['cname'] = daily_20180314_tscode_list
for table_name in daily_20180314.columns.values.tolist():
    daily_20180314_addname_dataframe[table_name] = daily_20180314[table_name]
print("日线行情-时间为序  daily_20180314 返回数据 row 行数 = "+str(daily_20180314.shape[0]))
daily_20180314_addname_dataframe.to_excel(daily_201803_excel_writer,'14_3',index=False)
daily_201803_excel_writer.save()
daily_20180315 = pro.daily(start_date='',end_date='',trade_date='20180315', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20180315_tscode_list = list() 
for ts_code_sh in daily_20180315['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20180315_tscode_list.append(stock_name)
daily_20180315_addname_dataframe=pd.DataFrame()
daily_20180315_addname_dataframe['cname'] = daily_20180315_tscode_list
for table_name in daily_20180315.columns.values.tolist():
    daily_20180315_addname_dataframe[table_name] = daily_20180315[table_name]
print("日线行情-时间为序  daily_20180315 返回数据 row 行数 = "+str(daily_20180315.shape[0]))
daily_20180315_addname_dataframe.to_excel(daily_201803_excel_writer,'15_4',index=False)
daily_201803_excel_writer.save()
daily_20180316 = pro.daily(start_date='',end_date='',trade_date='20180316', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20180316_tscode_list = list() 
for ts_code_sh in daily_20180316['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20180316_tscode_list.append(stock_name)
daily_20180316_addname_dataframe=pd.DataFrame()
daily_20180316_addname_dataframe['cname'] = daily_20180316_tscode_list
for table_name in daily_20180316.columns.values.tolist():
    daily_20180316_addname_dataframe[table_name] = daily_20180316[table_name]
print("日线行情-时间为序  daily_20180316 返回数据 row 行数 = "+str(daily_20180316.shape[0]))
daily_20180316_addname_dataframe.to_excel(daily_201803_excel_writer,'16_5',index=False)
daily_201803_excel_writer.save()
daily_20180319 = pro.daily(start_date='',end_date='',trade_date='20180319', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20180319_tscode_list = list() 
for ts_code_sh in daily_20180319['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20180319_tscode_list.append(stock_name)
daily_20180319_addname_dataframe=pd.DataFrame()
daily_20180319_addname_dataframe['cname'] = daily_20180319_tscode_list
for table_name in daily_20180319.columns.values.tolist():
    daily_20180319_addname_dataframe[table_name] = daily_20180319[table_name]
print("日线行情-时间为序  daily_20180319 返回数据 row 行数 = "+str(daily_20180319.shape[0]))
daily_20180319_addname_dataframe.to_excel(daily_201803_excel_writer,'19_1',index=False)
daily_201803_excel_writer.save()
daily_20180320 = pro.daily(start_date='',end_date='',trade_date='20180320', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20180320_tscode_list = list() 
for ts_code_sh in daily_20180320['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20180320_tscode_list.append(stock_name)
daily_20180320_addname_dataframe=pd.DataFrame()
daily_20180320_addname_dataframe['cname'] = daily_20180320_tscode_list
for table_name in daily_20180320.columns.values.tolist():
    daily_20180320_addname_dataframe[table_name] = daily_20180320[table_name]
print("日线行情-时间为序  daily_20180320 返回数据 row 行数 = "+str(daily_20180320.shape[0]))
daily_20180320_addname_dataframe.to_excel(daily_201803_excel_writer,'20_2',index=False)
daily_201803_excel_writer.save()
daily_20180321 = pro.daily(start_date='',end_date='',trade_date='20180321', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20180321_tscode_list = list() 
for ts_code_sh in daily_20180321['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20180321_tscode_list.append(stock_name)
daily_20180321_addname_dataframe=pd.DataFrame()
daily_20180321_addname_dataframe['cname'] = daily_20180321_tscode_list
for table_name in daily_20180321.columns.values.tolist():
    daily_20180321_addname_dataframe[table_name] = daily_20180321[table_name]
print("日线行情-时间为序  daily_20180321 返回数据 row 行数 = "+str(daily_20180321.shape[0]))
daily_20180321_addname_dataframe.to_excel(daily_201803_excel_writer,'21_3',index=False)
daily_201803_excel_writer.save()
daily_20180322 = pro.daily(start_date='',end_date='',trade_date='20180322', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20180322_tscode_list = list() 
for ts_code_sh in daily_20180322['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20180322_tscode_list.append(stock_name)
daily_20180322_addname_dataframe=pd.DataFrame()
daily_20180322_addname_dataframe['cname'] = daily_20180322_tscode_list
for table_name in daily_20180322.columns.values.tolist():
    daily_20180322_addname_dataframe[table_name] = daily_20180322[table_name]
print("日线行情-时间为序  daily_20180322 返回数据 row 行数 = "+str(daily_20180322.shape[0]))
daily_20180322_addname_dataframe.to_excel(daily_201803_excel_writer,'22_4',index=False)
daily_201803_excel_writer.save()
daily_20180323 = pro.daily(start_date='',end_date='',trade_date='20180323', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20180323_tscode_list = list() 
for ts_code_sh in daily_20180323['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20180323_tscode_list.append(stock_name)
daily_20180323_addname_dataframe=pd.DataFrame()
daily_20180323_addname_dataframe['cname'] = daily_20180323_tscode_list
for table_name in daily_20180323.columns.values.tolist():
    daily_20180323_addname_dataframe[table_name] = daily_20180323[table_name]
print("日线行情-时间为序  daily_20180323 返回数据 row 行数 = "+str(daily_20180323.shape[0]))
daily_20180323_addname_dataframe.to_excel(daily_201803_excel_writer,'23_5',index=False)
daily_201803_excel_writer.save()
daily_20180326 = pro.daily(start_date='',end_date='',trade_date='20180326', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20180326_tscode_list = list() 
for ts_code_sh in daily_20180326['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20180326_tscode_list.append(stock_name)
daily_20180326_addname_dataframe=pd.DataFrame()
daily_20180326_addname_dataframe['cname'] = daily_20180326_tscode_list
for table_name in daily_20180326.columns.values.tolist():
    daily_20180326_addname_dataframe[table_name] = daily_20180326[table_name]
print("日线行情-时间为序  daily_20180326 返回数据 row 行数 = "+str(daily_20180326.shape[0]))
daily_20180326_addname_dataframe.to_excel(daily_201803_excel_writer,'26_1',index=False)
daily_201803_excel_writer.save()
daily_20180327 = pro.daily(start_date='',end_date='',trade_date='20180327', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20180327_tscode_list = list() 
for ts_code_sh in daily_20180327['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20180327_tscode_list.append(stock_name)
daily_20180327_addname_dataframe=pd.DataFrame()
daily_20180327_addname_dataframe['cname'] = daily_20180327_tscode_list
for table_name in daily_20180327.columns.values.tolist():
    daily_20180327_addname_dataframe[table_name] = daily_20180327[table_name]
print("日线行情-时间为序  daily_20180327 返回数据 row 行数 = "+str(daily_20180327.shape[0]))
daily_20180327_addname_dataframe.to_excel(daily_201803_excel_writer,'27_2',index=False)
daily_201803_excel_writer.save()
daily_20180328 = pro.daily(start_date='',end_date='',trade_date='20180328', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20180328_tscode_list = list() 
for ts_code_sh in daily_20180328['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20180328_tscode_list.append(stock_name)
daily_20180328_addname_dataframe=pd.DataFrame()
daily_20180328_addname_dataframe['cname'] = daily_20180328_tscode_list
for table_name in daily_20180328.columns.values.tolist():
    daily_20180328_addname_dataframe[table_name] = daily_20180328[table_name]
print("日线行情-时间为序  daily_20180328 返回数据 row 行数 = "+str(daily_20180328.shape[0]))
daily_20180328_addname_dataframe.to_excel(daily_201803_excel_writer,'28_3',index=False)
daily_201803_excel_writer.save()
daily_20180329 = pro.daily(start_date='',end_date='',trade_date='20180329', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20180329_tscode_list = list() 
for ts_code_sh in daily_20180329['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20180329_tscode_list.append(stock_name)
daily_20180329_addname_dataframe=pd.DataFrame()
daily_20180329_addname_dataframe['cname'] = daily_20180329_tscode_list
for table_name in daily_20180329.columns.values.tolist():
    daily_20180329_addname_dataframe[table_name] = daily_20180329[table_name]
print("日线行情-时间为序  daily_20180329 返回数据 row 行数 = "+str(daily_20180329.shape[0]))
daily_20180329_addname_dataframe.to_excel(daily_201803_excel_writer,'29_4',index=False)
daily_201803_excel_writer.save()
daily_20180330 = pro.daily(start_date='',end_date='',trade_date='20180330', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20180330_tscode_list = list() 
for ts_code_sh in daily_20180330['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20180330_tscode_list.append(stock_name)
daily_20180330_addname_dataframe=pd.DataFrame()
daily_20180330_addname_dataframe['cname'] = daily_20180330_tscode_list
for table_name in daily_20180330.columns.values.tolist():
    daily_20180330_addname_dataframe[table_name] = daily_20180330[table_name]
print("日线行情-时间为序  daily_20180330 返回数据 row 行数 = "+str(daily_20180330.shape[0]))
daily_20180330_addname_dataframe.to_excel(daily_201803_excel_writer,'30_5',index=False)
daily_201803_excel_writer.save()




createexcel('daily_201804.xlsx')
daily_201804_book = load_workbook('C:\\Users\\zhuzj5\\Desktop\\zbin\\J0_Data\\daily_201804.xlsx')
daily_201804_excel_writer = pd.ExcelWriter('C:\\Users\\zhuzj5\\Desktop\\zbin\\J0_Data\\daily_201804.xlsx', engine='openpyxl')
daily_201804_excel_writer.book = daily_201804_book
daily_201804_excel_writer.sheets = dict((ws.title, ws) for ws in daily_201804_book.worksheets)
J0_PROPS.put(tree_node_name+"record_date", "20180401")       ###  更新 记录日期
daily_20180402 = pro.daily(start_date='',end_date='',trade_date='20180402', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20180402_tscode_list = list() 
for ts_code_sh in daily_20180402['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20180402_tscode_list.append(stock_name)
daily_20180402_addname_dataframe=pd.DataFrame()
daily_20180402_addname_dataframe['cname'] = daily_20180402_tscode_list
for table_name in daily_20180402.columns.values.tolist():
    daily_20180402_addname_dataframe[table_name] = daily_20180402[table_name]
print("日线行情-时间为序  daily_20180402 返回数据 row 行数 = "+str(daily_20180402.shape[0]))
daily_20180402_addname_dataframe.to_excel(daily_201804_excel_writer,'2_1',index=False)
daily_201804_excel_writer.save()
daily_20180403 = pro.daily(start_date='',end_date='',trade_date='20180403', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20180403_tscode_list = list() 
for ts_code_sh in daily_20180403['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20180403_tscode_list.append(stock_name)
daily_20180403_addname_dataframe=pd.DataFrame()
daily_20180403_addname_dataframe['cname'] = daily_20180403_tscode_list
for table_name in daily_20180403.columns.values.tolist():
    daily_20180403_addname_dataframe[table_name] = daily_20180403[table_name]
print("日线行情-时间为序  daily_20180403 返回数据 row 行数 = "+str(daily_20180403.shape[0]))
daily_20180403_addname_dataframe.to_excel(daily_201804_excel_writer,'3_2',index=False)
daily_201804_excel_writer.save()
daily_20180404 = pro.daily(start_date='',end_date='',trade_date='20180404', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20180404_tscode_list = list() 
for ts_code_sh in daily_20180404['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20180404_tscode_list.append(stock_name)
daily_20180404_addname_dataframe=pd.DataFrame()
daily_20180404_addname_dataframe['cname'] = daily_20180404_tscode_list
for table_name in daily_20180404.columns.values.tolist():
    daily_20180404_addname_dataframe[table_name] = daily_20180404[table_name]
print("日线行情-时间为序  daily_20180404 返回数据 row 行数 = "+str(daily_20180404.shape[0]))
daily_20180404_addname_dataframe.to_excel(daily_201804_excel_writer,'4_3',index=False)
daily_201804_excel_writer.save()
daily_20180409 = pro.daily(start_date='',end_date='',trade_date='20180409', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20180409_tscode_list = list() 
for ts_code_sh in daily_20180409['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20180409_tscode_list.append(stock_name)
daily_20180409_addname_dataframe=pd.DataFrame()
daily_20180409_addname_dataframe['cname'] = daily_20180409_tscode_list
for table_name in daily_20180409.columns.values.tolist():
    daily_20180409_addname_dataframe[table_name] = daily_20180409[table_name]
print("日线行情-时间为序  daily_20180409 返回数据 row 行数 = "+str(daily_20180409.shape[0]))
daily_20180409_addname_dataframe.to_excel(daily_201804_excel_writer,'9_1',index=False)
daily_201804_excel_writer.save()
daily_20180410 = pro.daily(start_date='',end_date='',trade_date='20180410', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20180410_tscode_list = list() 
for ts_code_sh in daily_20180410['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20180410_tscode_list.append(stock_name)
daily_20180410_addname_dataframe=pd.DataFrame()
daily_20180410_addname_dataframe['cname'] = daily_20180410_tscode_list
for table_name in daily_20180410.columns.values.tolist():
    daily_20180410_addname_dataframe[table_name] = daily_20180410[table_name]
print("日线行情-时间为序  daily_20180410 返回数据 row 行数 = "+str(daily_20180410.shape[0]))
daily_20180410_addname_dataframe.to_excel(daily_201804_excel_writer,'10_2',index=False)
daily_201804_excel_writer.save()
daily_20180411 = pro.daily(start_date='',end_date='',trade_date='20180411', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20180411_tscode_list = list() 
for ts_code_sh in daily_20180411['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20180411_tscode_list.append(stock_name)
daily_20180411_addname_dataframe=pd.DataFrame()
daily_20180411_addname_dataframe['cname'] = daily_20180411_tscode_list
for table_name in daily_20180411.columns.values.tolist():
    daily_20180411_addname_dataframe[table_name] = daily_20180411[table_name]
print("日线行情-时间为序  daily_20180411 返回数据 row 行数 = "+str(daily_20180411.shape[0]))
daily_20180411_addname_dataframe.to_excel(daily_201804_excel_writer,'11_3',index=False)
daily_201804_excel_writer.save()
daily_20180412 = pro.daily(start_date='',end_date='',trade_date='20180412', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20180412_tscode_list = list() 
for ts_code_sh in daily_20180412['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20180412_tscode_list.append(stock_name)
daily_20180412_addname_dataframe=pd.DataFrame()
daily_20180412_addname_dataframe['cname'] = daily_20180412_tscode_list
for table_name in daily_20180412.columns.values.tolist():
    daily_20180412_addname_dataframe[table_name] = daily_20180412[table_name]
print("日线行情-时间为序  daily_20180412 返回数据 row 行数 = "+str(daily_20180412.shape[0]))
daily_20180412_addname_dataframe.to_excel(daily_201804_excel_writer,'12_4',index=False)
daily_201804_excel_writer.save()
daily_20180413 = pro.daily(start_date='',end_date='',trade_date='20180413', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20180413_tscode_list = list() 
for ts_code_sh in daily_20180413['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20180413_tscode_list.append(stock_name)
daily_20180413_addname_dataframe=pd.DataFrame()
daily_20180413_addname_dataframe['cname'] = daily_20180413_tscode_list
for table_name in daily_20180413.columns.values.tolist():
    daily_20180413_addname_dataframe[table_name] = daily_20180413[table_name]
print("日线行情-时间为序  daily_20180413 返回数据 row 行数 = "+str(daily_20180413.shape[0]))
daily_20180413_addname_dataframe.to_excel(daily_201804_excel_writer,'13_5',index=False)
daily_201804_excel_writer.save()
daily_20180416 = pro.daily(start_date='',end_date='',trade_date='20180416', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20180416_tscode_list = list() 
for ts_code_sh in daily_20180416['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20180416_tscode_list.append(stock_name)
daily_20180416_addname_dataframe=pd.DataFrame()
daily_20180416_addname_dataframe['cname'] = daily_20180416_tscode_list
for table_name in daily_20180416.columns.values.tolist():
    daily_20180416_addname_dataframe[table_name] = daily_20180416[table_name]
print("日线行情-时间为序  daily_20180416 返回数据 row 行数 = "+str(daily_20180416.shape[0]))
daily_20180416_addname_dataframe.to_excel(daily_201804_excel_writer,'16_1',index=False)
daily_201804_excel_writer.save()
daily_20180417 = pro.daily(start_date='',end_date='',trade_date='20180417', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20180417_tscode_list = list() 
for ts_code_sh in daily_20180417['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20180417_tscode_list.append(stock_name)
daily_20180417_addname_dataframe=pd.DataFrame()
daily_20180417_addname_dataframe['cname'] = daily_20180417_tscode_list
for table_name in daily_20180417.columns.values.tolist():
    daily_20180417_addname_dataframe[table_name] = daily_20180417[table_name]
print("日线行情-时间为序  daily_20180417 返回数据 row 行数 = "+str(daily_20180417.shape[0]))
daily_20180417_addname_dataframe.to_excel(daily_201804_excel_writer,'17_2',index=False)
daily_201804_excel_writer.save()
daily_20180418 = pro.daily(start_date='',end_date='',trade_date='20180418', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20180418_tscode_list = list() 
for ts_code_sh in daily_20180418['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20180418_tscode_list.append(stock_name)
daily_20180418_addname_dataframe=pd.DataFrame()
daily_20180418_addname_dataframe['cname'] = daily_20180418_tscode_list
for table_name in daily_20180418.columns.values.tolist():
    daily_20180418_addname_dataframe[table_name] = daily_20180418[table_name]
print("日线行情-时间为序  daily_20180418 返回数据 row 行数 = "+str(daily_20180418.shape[0]))
daily_20180418_addname_dataframe.to_excel(daily_201804_excel_writer,'18_3',index=False)
daily_201804_excel_writer.save()
daily_20180419 = pro.daily(start_date='',end_date='',trade_date='20180419', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20180419_tscode_list = list() 
for ts_code_sh in daily_20180419['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20180419_tscode_list.append(stock_name)
daily_20180419_addname_dataframe=pd.DataFrame()
daily_20180419_addname_dataframe['cname'] = daily_20180419_tscode_list
for table_name in daily_20180419.columns.values.tolist():
    daily_20180419_addname_dataframe[table_name] = daily_20180419[table_name]
print("日线行情-时间为序  daily_20180419 返回数据 row 行数 = "+str(daily_20180419.shape[0]))
daily_20180419_addname_dataframe.to_excel(daily_201804_excel_writer,'19_4',index=False)
daily_201804_excel_writer.save()
daily_20180420 = pro.daily(start_date='',end_date='',trade_date='20180420', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20180420_tscode_list = list() 
for ts_code_sh in daily_20180420['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20180420_tscode_list.append(stock_name)
daily_20180420_addname_dataframe=pd.DataFrame()
daily_20180420_addname_dataframe['cname'] = daily_20180420_tscode_list
for table_name in daily_20180420.columns.values.tolist():
    daily_20180420_addname_dataframe[table_name] = daily_20180420[table_name]
print("日线行情-时间为序  daily_20180420 返回数据 row 行数 = "+str(daily_20180420.shape[0]))
daily_20180420_addname_dataframe.to_excel(daily_201804_excel_writer,'20_5',index=False)
daily_201804_excel_writer.save()
daily_20180423 = pro.daily(start_date='',end_date='',trade_date='20180423', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20180423_tscode_list = list() 
for ts_code_sh in daily_20180423['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20180423_tscode_list.append(stock_name)
daily_20180423_addname_dataframe=pd.DataFrame()
daily_20180423_addname_dataframe['cname'] = daily_20180423_tscode_list
for table_name in daily_20180423.columns.values.tolist():
    daily_20180423_addname_dataframe[table_name] = daily_20180423[table_name]
print("日线行情-时间为序  daily_20180423 返回数据 row 行数 = "+str(daily_20180423.shape[0]))
daily_20180423_addname_dataframe.to_excel(daily_201804_excel_writer,'23_1',index=False)
daily_201804_excel_writer.save()
daily_20180424 = pro.daily(start_date='',end_date='',trade_date='20180424', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20180424_tscode_list = list() 
for ts_code_sh in daily_20180424['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20180424_tscode_list.append(stock_name)
daily_20180424_addname_dataframe=pd.DataFrame()
daily_20180424_addname_dataframe['cname'] = daily_20180424_tscode_list
for table_name in daily_20180424.columns.values.tolist():
    daily_20180424_addname_dataframe[table_name] = daily_20180424[table_name]
print("日线行情-时间为序  daily_20180424 返回数据 row 行数 = "+str(daily_20180424.shape[0]))
daily_20180424_addname_dataframe.to_excel(daily_201804_excel_writer,'24_2',index=False)
daily_201804_excel_writer.save()
daily_20180425 = pro.daily(start_date='',end_date='',trade_date='20180425', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20180425_tscode_list = list() 
for ts_code_sh in daily_20180425['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20180425_tscode_list.append(stock_name)
daily_20180425_addname_dataframe=pd.DataFrame()
daily_20180425_addname_dataframe['cname'] = daily_20180425_tscode_list
for table_name in daily_20180425.columns.values.tolist():
    daily_20180425_addname_dataframe[table_name] = daily_20180425[table_name]
print("日线行情-时间为序  daily_20180425 返回数据 row 行数 = "+str(daily_20180425.shape[0]))
daily_20180425_addname_dataframe.to_excel(daily_201804_excel_writer,'25_3',index=False)
daily_201804_excel_writer.save()
daily_20180426 = pro.daily(start_date='',end_date='',trade_date='20180426', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20180426_tscode_list = list() 
for ts_code_sh in daily_20180426['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20180426_tscode_list.append(stock_name)
daily_20180426_addname_dataframe=pd.DataFrame()
daily_20180426_addname_dataframe['cname'] = daily_20180426_tscode_list
for table_name in daily_20180426.columns.values.tolist():
    daily_20180426_addname_dataframe[table_name] = daily_20180426[table_name]
print("日线行情-时间为序  daily_20180426 返回数据 row 行数 = "+str(daily_20180426.shape[0]))
daily_20180426_addname_dataframe.to_excel(daily_201804_excel_writer,'26_4',index=False)
daily_201804_excel_writer.save()
daily_20180427 = pro.daily(start_date='',end_date='',trade_date='20180427', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20180427_tscode_list = list() 
for ts_code_sh in daily_20180427['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20180427_tscode_list.append(stock_name)
daily_20180427_addname_dataframe=pd.DataFrame()
daily_20180427_addname_dataframe['cname'] = daily_20180427_tscode_list
for table_name in daily_20180427.columns.values.tolist():
    daily_20180427_addname_dataframe[table_name] = daily_20180427[table_name]
print("日线行情-时间为序  daily_20180427 返回数据 row 行数 = "+str(daily_20180427.shape[0]))
daily_20180427_addname_dataframe.to_excel(daily_201804_excel_writer,'27_5',index=False)
daily_201804_excel_writer.save()




createexcel('daily_201805.xlsx')
daily_201805_book = load_workbook('C:\\Users\\zhuzj5\\Desktop\\zbin\\J0_Data\\daily_201805.xlsx')
daily_201805_excel_writer = pd.ExcelWriter('C:\\Users\\zhuzj5\\Desktop\\zbin\\J0_Data\\daily_201805.xlsx', engine='openpyxl')
daily_201805_excel_writer.book = daily_201805_book
daily_201805_excel_writer.sheets = dict((ws.title, ws) for ws in daily_201805_book.worksheets)
J0_PROPS.put(tree_node_name+"record_date", "20180501")       ###  更新 记录日期
daily_20180502 = pro.daily(start_date='',end_date='',trade_date='20180502', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20180502_tscode_list = list() 
for ts_code_sh in daily_20180502['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20180502_tscode_list.append(stock_name)
daily_20180502_addname_dataframe=pd.DataFrame()
daily_20180502_addname_dataframe['cname'] = daily_20180502_tscode_list
for table_name in daily_20180502.columns.values.tolist():
    daily_20180502_addname_dataframe[table_name] = daily_20180502[table_name]
print("日线行情-时间为序  daily_20180502 返回数据 row 行数 = "+str(daily_20180502.shape[0]))
daily_20180502_addname_dataframe.to_excel(daily_201805_excel_writer,'2_3',index=False)
daily_201805_excel_writer.save()
daily_20180503 = pro.daily(start_date='',end_date='',trade_date='20180503', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20180503_tscode_list = list() 
for ts_code_sh in daily_20180503['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20180503_tscode_list.append(stock_name)
daily_20180503_addname_dataframe=pd.DataFrame()
daily_20180503_addname_dataframe['cname'] = daily_20180503_tscode_list
for table_name in daily_20180503.columns.values.tolist():
    daily_20180503_addname_dataframe[table_name] = daily_20180503[table_name]
print("日线行情-时间为序  daily_20180503 返回数据 row 行数 = "+str(daily_20180503.shape[0]))
daily_20180503_addname_dataframe.to_excel(daily_201805_excel_writer,'3_4',index=False)
daily_201805_excel_writer.save()
daily_20180504 = pro.daily(start_date='',end_date='',trade_date='20180504', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20180504_tscode_list = list() 
for ts_code_sh in daily_20180504['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20180504_tscode_list.append(stock_name)
daily_20180504_addname_dataframe=pd.DataFrame()
daily_20180504_addname_dataframe['cname'] = daily_20180504_tscode_list
for table_name in daily_20180504.columns.values.tolist():
    daily_20180504_addname_dataframe[table_name] = daily_20180504[table_name]
print("日线行情-时间为序  daily_20180504 返回数据 row 行数 = "+str(daily_20180504.shape[0]))
daily_20180504_addname_dataframe.to_excel(daily_201805_excel_writer,'4_5',index=False)
daily_201805_excel_writer.save()
daily_20180507 = pro.daily(start_date='',end_date='',trade_date='20180507', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20180507_tscode_list = list() 
for ts_code_sh in daily_20180507['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20180507_tscode_list.append(stock_name)
daily_20180507_addname_dataframe=pd.DataFrame()
daily_20180507_addname_dataframe['cname'] = daily_20180507_tscode_list
for table_name in daily_20180507.columns.values.tolist():
    daily_20180507_addname_dataframe[table_name] = daily_20180507[table_name]
print("日线行情-时间为序  daily_20180507 返回数据 row 行数 = "+str(daily_20180507.shape[0]))
daily_20180507_addname_dataframe.to_excel(daily_201805_excel_writer,'7_1',index=False)
daily_201805_excel_writer.save()
daily_20180508 = pro.daily(start_date='',end_date='',trade_date='20180508', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20180508_tscode_list = list() 
for ts_code_sh in daily_20180508['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20180508_tscode_list.append(stock_name)
daily_20180508_addname_dataframe=pd.DataFrame()
daily_20180508_addname_dataframe['cname'] = daily_20180508_tscode_list
for table_name in daily_20180508.columns.values.tolist():
    daily_20180508_addname_dataframe[table_name] = daily_20180508[table_name]
print("日线行情-时间为序  daily_20180508 返回数据 row 行数 = "+str(daily_20180508.shape[0]))
daily_20180508_addname_dataframe.to_excel(daily_201805_excel_writer,'8_2',index=False)
daily_201805_excel_writer.save()
daily_20180509 = pro.daily(start_date='',end_date='',trade_date='20180509', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20180509_tscode_list = list() 
for ts_code_sh in daily_20180509['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20180509_tscode_list.append(stock_name)
daily_20180509_addname_dataframe=pd.DataFrame()
daily_20180509_addname_dataframe['cname'] = daily_20180509_tscode_list
for table_name in daily_20180509.columns.values.tolist():
    daily_20180509_addname_dataframe[table_name] = daily_20180509[table_name]
print("日线行情-时间为序  daily_20180509 返回数据 row 行数 = "+str(daily_20180509.shape[0]))
daily_20180509_addname_dataframe.to_excel(daily_201805_excel_writer,'9_3',index=False)
daily_201805_excel_writer.save()
daily_20180510 = pro.daily(start_date='',end_date='',trade_date='20180510', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20180510_tscode_list = list() 
for ts_code_sh in daily_20180510['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20180510_tscode_list.append(stock_name)
daily_20180510_addname_dataframe=pd.DataFrame()
daily_20180510_addname_dataframe['cname'] = daily_20180510_tscode_list
for table_name in daily_20180510.columns.values.tolist():
    daily_20180510_addname_dataframe[table_name] = daily_20180510[table_name]
print("日线行情-时间为序  daily_20180510 返回数据 row 行数 = "+str(daily_20180510.shape[0]))
daily_20180510_addname_dataframe.to_excel(daily_201805_excel_writer,'10_4',index=False)
daily_201805_excel_writer.save()
daily_20180511 = pro.daily(start_date='',end_date='',trade_date='20180511', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20180511_tscode_list = list() 
for ts_code_sh in daily_20180511['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20180511_tscode_list.append(stock_name)
daily_20180511_addname_dataframe=pd.DataFrame()
daily_20180511_addname_dataframe['cname'] = daily_20180511_tscode_list
for table_name in daily_20180511.columns.values.tolist():
    daily_20180511_addname_dataframe[table_name] = daily_20180511[table_name]
print("日线行情-时间为序  daily_20180511 返回数据 row 行数 = "+str(daily_20180511.shape[0]))
daily_20180511_addname_dataframe.to_excel(daily_201805_excel_writer,'11_5',index=False)
daily_201805_excel_writer.save()
daily_20180514 = pro.daily(start_date='',end_date='',trade_date='20180514', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20180514_tscode_list = list() 
for ts_code_sh in daily_20180514['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20180514_tscode_list.append(stock_name)
daily_20180514_addname_dataframe=pd.DataFrame()
daily_20180514_addname_dataframe['cname'] = daily_20180514_tscode_list
for table_name in daily_20180514.columns.values.tolist():
    daily_20180514_addname_dataframe[table_name] = daily_20180514[table_name]
print("日线行情-时间为序  daily_20180514 返回数据 row 行数 = "+str(daily_20180514.shape[0]))
daily_20180514_addname_dataframe.to_excel(daily_201805_excel_writer,'14_1',index=False)
daily_201805_excel_writer.save()
daily_20180515 = pro.daily(start_date='',end_date='',trade_date='20180515', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20180515_tscode_list = list() 
for ts_code_sh in daily_20180515['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20180515_tscode_list.append(stock_name)
daily_20180515_addname_dataframe=pd.DataFrame()
daily_20180515_addname_dataframe['cname'] = daily_20180515_tscode_list
for table_name in daily_20180515.columns.values.tolist():
    daily_20180515_addname_dataframe[table_name] = daily_20180515[table_name]
print("日线行情-时间为序  daily_20180515 返回数据 row 行数 = "+str(daily_20180515.shape[0]))
daily_20180515_addname_dataframe.to_excel(daily_201805_excel_writer,'15_2',index=False)
daily_201805_excel_writer.save()
daily_20180516 = pro.daily(start_date='',end_date='',trade_date='20180516', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20180516_tscode_list = list() 
for ts_code_sh in daily_20180516['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20180516_tscode_list.append(stock_name)
daily_20180516_addname_dataframe=pd.DataFrame()
daily_20180516_addname_dataframe['cname'] = daily_20180516_tscode_list
for table_name in daily_20180516.columns.values.tolist():
    daily_20180516_addname_dataframe[table_name] = daily_20180516[table_name]
print("日线行情-时间为序  daily_20180516 返回数据 row 行数 = "+str(daily_20180516.shape[0]))
daily_20180516_addname_dataframe.to_excel(daily_201805_excel_writer,'16_3',index=False)
daily_201805_excel_writer.save()
daily_20180517 = pro.daily(start_date='',end_date='',trade_date='20180517', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20180517_tscode_list = list() 
for ts_code_sh in daily_20180517['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20180517_tscode_list.append(stock_name)
daily_20180517_addname_dataframe=pd.DataFrame()
daily_20180517_addname_dataframe['cname'] = daily_20180517_tscode_list
for table_name in daily_20180517.columns.values.tolist():
    daily_20180517_addname_dataframe[table_name] = daily_20180517[table_name]
print("日线行情-时间为序  daily_20180517 返回数据 row 行数 = "+str(daily_20180517.shape[0]))
daily_20180517_addname_dataframe.to_excel(daily_201805_excel_writer,'17_4',index=False)
daily_201805_excel_writer.save()
daily_20180518 = pro.daily(start_date='',end_date='',trade_date='20180518', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20180518_tscode_list = list() 
for ts_code_sh in daily_20180518['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20180518_tscode_list.append(stock_name)
daily_20180518_addname_dataframe=pd.DataFrame()
daily_20180518_addname_dataframe['cname'] = daily_20180518_tscode_list
for table_name in daily_20180518.columns.values.tolist():
    daily_20180518_addname_dataframe[table_name] = daily_20180518[table_name]
print("日线行情-时间为序  daily_20180518 返回数据 row 行数 = "+str(daily_20180518.shape[0]))
daily_20180518_addname_dataframe.to_excel(daily_201805_excel_writer,'18_5',index=False)
daily_201805_excel_writer.save()
daily_20180521 = pro.daily(start_date='',end_date='',trade_date='20180521', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20180521_tscode_list = list() 
for ts_code_sh in daily_20180521['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20180521_tscode_list.append(stock_name)
daily_20180521_addname_dataframe=pd.DataFrame()
daily_20180521_addname_dataframe['cname'] = daily_20180521_tscode_list
for table_name in daily_20180521.columns.values.tolist():
    daily_20180521_addname_dataframe[table_name] = daily_20180521[table_name]
print("日线行情-时间为序  daily_20180521 返回数据 row 行数 = "+str(daily_20180521.shape[0]))
daily_20180521_addname_dataframe.to_excel(daily_201805_excel_writer,'21_1',index=False)
daily_201805_excel_writer.save()
daily_20180522 = pro.daily(start_date='',end_date='',trade_date='20180522', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20180522_tscode_list = list() 
for ts_code_sh in daily_20180522['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20180522_tscode_list.append(stock_name)
daily_20180522_addname_dataframe=pd.DataFrame()
daily_20180522_addname_dataframe['cname'] = daily_20180522_tscode_list
for table_name in daily_20180522.columns.values.tolist():
    daily_20180522_addname_dataframe[table_name] = daily_20180522[table_name]
print("日线行情-时间为序  daily_20180522 返回数据 row 行数 = "+str(daily_20180522.shape[0]))
daily_20180522_addname_dataframe.to_excel(daily_201805_excel_writer,'22_2',index=False)
daily_201805_excel_writer.save()
daily_20180523 = pro.daily(start_date='',end_date='',trade_date='20180523', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20180523_tscode_list = list() 
for ts_code_sh in daily_20180523['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20180523_tscode_list.append(stock_name)
daily_20180523_addname_dataframe=pd.DataFrame()
daily_20180523_addname_dataframe['cname'] = daily_20180523_tscode_list
for table_name in daily_20180523.columns.values.tolist():
    daily_20180523_addname_dataframe[table_name] = daily_20180523[table_name]
print("日线行情-时间为序  daily_20180523 返回数据 row 行数 = "+str(daily_20180523.shape[0]))
daily_20180523_addname_dataframe.to_excel(daily_201805_excel_writer,'23_3',index=False)
daily_201805_excel_writer.save()
daily_20180524 = pro.daily(start_date='',end_date='',trade_date='20180524', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20180524_tscode_list = list() 
for ts_code_sh in daily_20180524['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20180524_tscode_list.append(stock_name)
daily_20180524_addname_dataframe=pd.DataFrame()
daily_20180524_addname_dataframe['cname'] = daily_20180524_tscode_list
for table_name in daily_20180524.columns.values.tolist():
    daily_20180524_addname_dataframe[table_name] = daily_20180524[table_name]
print("日线行情-时间为序  daily_20180524 返回数据 row 行数 = "+str(daily_20180524.shape[0]))
daily_20180524_addname_dataframe.to_excel(daily_201805_excel_writer,'24_4',index=False)
daily_201805_excel_writer.save()
daily_20180525 = pro.daily(start_date='',end_date='',trade_date='20180525', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20180525_tscode_list = list() 
for ts_code_sh in daily_20180525['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20180525_tscode_list.append(stock_name)
daily_20180525_addname_dataframe=pd.DataFrame()
daily_20180525_addname_dataframe['cname'] = daily_20180525_tscode_list
for table_name in daily_20180525.columns.values.tolist():
    daily_20180525_addname_dataframe[table_name] = daily_20180525[table_name]
print("日线行情-时间为序  daily_20180525 返回数据 row 行数 = "+str(daily_20180525.shape[0]))
daily_20180525_addname_dataframe.to_excel(daily_201805_excel_writer,'25_5',index=False)
daily_201805_excel_writer.save()
daily_20180528 = pro.daily(start_date='',end_date='',trade_date='20180528', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20180528_tscode_list = list() 
for ts_code_sh in daily_20180528['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20180528_tscode_list.append(stock_name)
daily_20180528_addname_dataframe=pd.DataFrame()
daily_20180528_addname_dataframe['cname'] = daily_20180528_tscode_list
for table_name in daily_20180528.columns.values.tolist():
    daily_20180528_addname_dataframe[table_name] = daily_20180528[table_name]
print("日线行情-时间为序  daily_20180528 返回数据 row 行数 = "+str(daily_20180528.shape[0]))
daily_20180528_addname_dataframe.to_excel(daily_201805_excel_writer,'28_1',index=False)
daily_201805_excel_writer.save()
daily_20180529 = pro.daily(start_date='',end_date='',trade_date='20180529', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20180529_tscode_list = list() 
for ts_code_sh in daily_20180529['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20180529_tscode_list.append(stock_name)
daily_20180529_addname_dataframe=pd.DataFrame()
daily_20180529_addname_dataframe['cname'] = daily_20180529_tscode_list
for table_name in daily_20180529.columns.values.tolist():
    daily_20180529_addname_dataframe[table_name] = daily_20180529[table_name]
print("日线行情-时间为序  daily_20180529 返回数据 row 行数 = "+str(daily_20180529.shape[0]))
daily_20180529_addname_dataframe.to_excel(daily_201805_excel_writer,'29_2',index=False)
daily_201805_excel_writer.save()
daily_20180530 = pro.daily(start_date='',end_date='',trade_date='20180530', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20180530_tscode_list = list() 
for ts_code_sh in daily_20180530['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20180530_tscode_list.append(stock_name)
daily_20180530_addname_dataframe=pd.DataFrame()
daily_20180530_addname_dataframe['cname'] = daily_20180530_tscode_list
for table_name in daily_20180530.columns.values.tolist():
    daily_20180530_addname_dataframe[table_name] = daily_20180530[table_name]
print("日线行情-时间为序  daily_20180530 返回数据 row 行数 = "+str(daily_20180530.shape[0]))
daily_20180530_addname_dataframe.to_excel(daily_201805_excel_writer,'30_3',index=False)
daily_201805_excel_writer.save()
daily_20180531 = pro.daily(start_date='',end_date='',trade_date='20180531', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20180531_tscode_list = list() 
for ts_code_sh in daily_20180531['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20180531_tscode_list.append(stock_name)
daily_20180531_addname_dataframe=pd.DataFrame()
daily_20180531_addname_dataframe['cname'] = daily_20180531_tscode_list
for table_name in daily_20180531.columns.values.tolist():
    daily_20180531_addname_dataframe[table_name] = daily_20180531[table_name]
print("日线行情-时间为序  daily_20180531 返回数据 row 行数 = "+str(daily_20180531.shape[0]))
daily_20180531_addname_dataframe.to_excel(daily_201805_excel_writer,'31_4',index=False)
daily_201805_excel_writer.save()




createexcel('daily_201806.xlsx')
daily_201806_book = load_workbook('C:\\Users\\zhuzj5\\Desktop\\zbin\\J0_Data\\daily_201806.xlsx')
daily_201806_excel_writer = pd.ExcelWriter('C:\\Users\\zhuzj5\\Desktop\\zbin\\J0_Data\\daily_201806.xlsx', engine='openpyxl')
daily_201806_excel_writer.book = daily_201806_book
daily_201806_excel_writer.sheets = dict((ws.title, ws) for ws in daily_201806_book.worksheets)
J0_PROPS.put(tree_node_name+"record_date", "20180601")       ###  更新 记录日期
daily_20180601 = pro.daily(start_date='',end_date='',trade_date='20180601', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20180601_tscode_list = list() 
for ts_code_sh in daily_20180601['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20180601_tscode_list.append(stock_name)
daily_20180601_addname_dataframe=pd.DataFrame()
daily_20180601_addname_dataframe['cname'] = daily_20180601_tscode_list
for table_name in daily_20180601.columns.values.tolist():
    daily_20180601_addname_dataframe[table_name] = daily_20180601[table_name]
print("日线行情-时间为序  daily_20180601 返回数据 row 行数 = "+str(daily_20180601.shape[0]))
daily_20180601_addname_dataframe.to_excel(daily_201806_excel_writer,'1_5',index=False)
daily_201806_excel_writer.save()
daily_20180604 = pro.daily(start_date='',end_date='',trade_date='20180604', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20180604_tscode_list = list() 
for ts_code_sh in daily_20180604['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20180604_tscode_list.append(stock_name)
daily_20180604_addname_dataframe=pd.DataFrame()
daily_20180604_addname_dataframe['cname'] = daily_20180604_tscode_list
for table_name in daily_20180604.columns.values.tolist():
    daily_20180604_addname_dataframe[table_name] = daily_20180604[table_name]
print("日线行情-时间为序  daily_20180604 返回数据 row 行数 = "+str(daily_20180604.shape[0]))
daily_20180604_addname_dataframe.to_excel(daily_201806_excel_writer,'4_1',index=False)
daily_201806_excel_writer.save()
daily_20180605 = pro.daily(start_date='',end_date='',trade_date='20180605', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20180605_tscode_list = list() 
for ts_code_sh in daily_20180605['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20180605_tscode_list.append(stock_name)
daily_20180605_addname_dataframe=pd.DataFrame()
daily_20180605_addname_dataframe['cname'] = daily_20180605_tscode_list
for table_name in daily_20180605.columns.values.tolist():
    daily_20180605_addname_dataframe[table_name] = daily_20180605[table_name]
print("日线行情-时间为序  daily_20180605 返回数据 row 行数 = "+str(daily_20180605.shape[0]))
daily_20180605_addname_dataframe.to_excel(daily_201806_excel_writer,'5_2',index=False)
daily_201806_excel_writer.save()
daily_20180606 = pro.daily(start_date='',end_date='',trade_date='20180606', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20180606_tscode_list = list() 
for ts_code_sh in daily_20180606['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20180606_tscode_list.append(stock_name)
daily_20180606_addname_dataframe=pd.DataFrame()
daily_20180606_addname_dataframe['cname'] = daily_20180606_tscode_list
for table_name in daily_20180606.columns.values.tolist():
    daily_20180606_addname_dataframe[table_name] = daily_20180606[table_name]
print("日线行情-时间为序  daily_20180606 返回数据 row 行数 = "+str(daily_20180606.shape[0]))
daily_20180606_addname_dataframe.to_excel(daily_201806_excel_writer,'6_3',index=False)
daily_201806_excel_writer.save()
daily_20180607 = pro.daily(start_date='',end_date='',trade_date='20180607', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20180607_tscode_list = list() 
for ts_code_sh in daily_20180607['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20180607_tscode_list.append(stock_name)
daily_20180607_addname_dataframe=pd.DataFrame()
daily_20180607_addname_dataframe['cname'] = daily_20180607_tscode_list
for table_name in daily_20180607.columns.values.tolist():
    daily_20180607_addname_dataframe[table_name] = daily_20180607[table_name]
print("日线行情-时间为序  daily_20180607 返回数据 row 行数 = "+str(daily_20180607.shape[0]))
daily_20180607_addname_dataframe.to_excel(daily_201806_excel_writer,'7_4',index=False)
daily_201806_excel_writer.save()
daily_20180608 = pro.daily(start_date='',end_date='',trade_date='20180608', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20180608_tscode_list = list() 
for ts_code_sh in daily_20180608['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20180608_tscode_list.append(stock_name)
daily_20180608_addname_dataframe=pd.DataFrame()
daily_20180608_addname_dataframe['cname'] = daily_20180608_tscode_list
for table_name in daily_20180608.columns.values.tolist():
    daily_20180608_addname_dataframe[table_name] = daily_20180608[table_name]
print("日线行情-时间为序  daily_20180608 返回数据 row 行数 = "+str(daily_20180608.shape[0]))
daily_20180608_addname_dataframe.to_excel(daily_201806_excel_writer,'8_5',index=False)
daily_201806_excel_writer.save()
daily_20180611 = pro.daily(start_date='',end_date='',trade_date='20180611', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20180611_tscode_list = list() 
for ts_code_sh in daily_20180611['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20180611_tscode_list.append(stock_name)
daily_20180611_addname_dataframe=pd.DataFrame()
daily_20180611_addname_dataframe['cname'] = daily_20180611_tscode_list
for table_name in daily_20180611.columns.values.tolist():
    daily_20180611_addname_dataframe[table_name] = daily_20180611[table_name]
print("日线行情-时间为序  daily_20180611 返回数据 row 行数 = "+str(daily_20180611.shape[0]))
daily_20180611_addname_dataframe.to_excel(daily_201806_excel_writer,'11_1',index=False)
daily_201806_excel_writer.save()
daily_20180612 = pro.daily(start_date='',end_date='',trade_date='20180612', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20180612_tscode_list = list() 
for ts_code_sh in daily_20180612['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20180612_tscode_list.append(stock_name)
daily_20180612_addname_dataframe=pd.DataFrame()
daily_20180612_addname_dataframe['cname'] = daily_20180612_tscode_list
for table_name in daily_20180612.columns.values.tolist():
    daily_20180612_addname_dataframe[table_name] = daily_20180612[table_name]
print("日线行情-时间为序  daily_20180612 返回数据 row 行数 = "+str(daily_20180612.shape[0]))
daily_20180612_addname_dataframe.to_excel(daily_201806_excel_writer,'12_2',index=False)
daily_201806_excel_writer.save()
daily_20180613 = pro.daily(start_date='',end_date='',trade_date='20180613', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20180613_tscode_list = list() 
for ts_code_sh in daily_20180613['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20180613_tscode_list.append(stock_name)
daily_20180613_addname_dataframe=pd.DataFrame()
daily_20180613_addname_dataframe['cname'] = daily_20180613_tscode_list
for table_name in daily_20180613.columns.values.tolist():
    daily_20180613_addname_dataframe[table_name] = daily_20180613[table_name]
print("日线行情-时间为序  daily_20180613 返回数据 row 行数 = "+str(daily_20180613.shape[0]))
daily_20180613_addname_dataframe.to_excel(daily_201806_excel_writer,'13_3',index=False)
daily_201806_excel_writer.save()
daily_20180614 = pro.daily(start_date='',end_date='',trade_date='20180614', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20180614_tscode_list = list() 
for ts_code_sh in daily_20180614['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20180614_tscode_list.append(stock_name)
daily_20180614_addname_dataframe=pd.DataFrame()
daily_20180614_addname_dataframe['cname'] = daily_20180614_tscode_list
for table_name in daily_20180614.columns.values.tolist():
    daily_20180614_addname_dataframe[table_name] = daily_20180614[table_name]
print("日线行情-时间为序  daily_20180614 返回数据 row 行数 = "+str(daily_20180614.shape[0]))
daily_20180614_addname_dataframe.to_excel(daily_201806_excel_writer,'14_4',index=False)
daily_201806_excel_writer.save()
daily_20180615 = pro.daily(start_date='',end_date='',trade_date='20180615', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20180615_tscode_list = list() 
for ts_code_sh in daily_20180615['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20180615_tscode_list.append(stock_name)
daily_20180615_addname_dataframe=pd.DataFrame()
daily_20180615_addname_dataframe['cname'] = daily_20180615_tscode_list
for table_name in daily_20180615.columns.values.tolist():
    daily_20180615_addname_dataframe[table_name] = daily_20180615[table_name]
print("日线行情-时间为序  daily_20180615 返回数据 row 行数 = "+str(daily_20180615.shape[0]))
daily_20180615_addname_dataframe.to_excel(daily_201806_excel_writer,'15_5',index=False)
daily_201806_excel_writer.save()
daily_20180619 = pro.daily(start_date='',end_date='',trade_date='20180619', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20180619_tscode_list = list() 
for ts_code_sh in daily_20180619['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20180619_tscode_list.append(stock_name)
daily_20180619_addname_dataframe=pd.DataFrame()
daily_20180619_addname_dataframe['cname'] = daily_20180619_tscode_list
for table_name in daily_20180619.columns.values.tolist():
    daily_20180619_addname_dataframe[table_name] = daily_20180619[table_name]
print("日线行情-时间为序  daily_20180619 返回数据 row 行数 = "+str(daily_20180619.shape[0]))
daily_20180619_addname_dataframe.to_excel(daily_201806_excel_writer,'19_2',index=False)
daily_201806_excel_writer.save()
daily_20180620 = pro.daily(start_date='',end_date='',trade_date='20180620', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20180620_tscode_list = list() 
for ts_code_sh in daily_20180620['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20180620_tscode_list.append(stock_name)
daily_20180620_addname_dataframe=pd.DataFrame()
daily_20180620_addname_dataframe['cname'] = daily_20180620_tscode_list
for table_name in daily_20180620.columns.values.tolist():
    daily_20180620_addname_dataframe[table_name] = daily_20180620[table_name]
print("日线行情-时间为序  daily_20180620 返回数据 row 行数 = "+str(daily_20180620.shape[0]))
daily_20180620_addname_dataframe.to_excel(daily_201806_excel_writer,'20_3',index=False)
daily_201806_excel_writer.save()
daily_20180621 = pro.daily(start_date='',end_date='',trade_date='20180621', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20180621_tscode_list = list() 
for ts_code_sh in daily_20180621['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20180621_tscode_list.append(stock_name)
daily_20180621_addname_dataframe=pd.DataFrame()
daily_20180621_addname_dataframe['cname'] = daily_20180621_tscode_list
for table_name in daily_20180621.columns.values.tolist():
    daily_20180621_addname_dataframe[table_name] = daily_20180621[table_name]
print("日线行情-时间为序  daily_20180621 返回数据 row 行数 = "+str(daily_20180621.shape[0]))
daily_20180621_addname_dataframe.to_excel(daily_201806_excel_writer,'21_4',index=False)
daily_201806_excel_writer.save()
daily_20180622 = pro.daily(start_date='',end_date='',trade_date='20180622', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20180622_tscode_list = list() 
for ts_code_sh in daily_20180622['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20180622_tscode_list.append(stock_name)
daily_20180622_addname_dataframe=pd.DataFrame()
daily_20180622_addname_dataframe['cname'] = daily_20180622_tscode_list
for table_name in daily_20180622.columns.values.tolist():
    daily_20180622_addname_dataframe[table_name] = daily_20180622[table_name]
print("日线行情-时间为序  daily_20180622 返回数据 row 行数 = "+str(daily_20180622.shape[0]))
daily_20180622_addname_dataframe.to_excel(daily_201806_excel_writer,'22_5',index=False)
daily_201806_excel_writer.save()
daily_20180625 = pro.daily(start_date='',end_date='',trade_date='20180625', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20180625_tscode_list = list() 
for ts_code_sh in daily_20180625['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20180625_tscode_list.append(stock_name)
daily_20180625_addname_dataframe=pd.DataFrame()
daily_20180625_addname_dataframe['cname'] = daily_20180625_tscode_list
for table_name in daily_20180625.columns.values.tolist():
    daily_20180625_addname_dataframe[table_name] = daily_20180625[table_name]
print("日线行情-时间为序  daily_20180625 返回数据 row 行数 = "+str(daily_20180625.shape[0]))
daily_20180625_addname_dataframe.to_excel(daily_201806_excel_writer,'25_1',index=False)
daily_201806_excel_writer.save()
daily_20180626 = pro.daily(start_date='',end_date='',trade_date='20180626', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20180626_tscode_list = list() 
for ts_code_sh in daily_20180626['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20180626_tscode_list.append(stock_name)
daily_20180626_addname_dataframe=pd.DataFrame()
daily_20180626_addname_dataframe['cname'] = daily_20180626_tscode_list
for table_name in daily_20180626.columns.values.tolist():
    daily_20180626_addname_dataframe[table_name] = daily_20180626[table_name]
print("日线行情-时间为序  daily_20180626 返回数据 row 行数 = "+str(daily_20180626.shape[0]))
daily_20180626_addname_dataframe.to_excel(daily_201806_excel_writer,'26_2',index=False)
daily_201806_excel_writer.save()
daily_20180627 = pro.daily(start_date='',end_date='',trade_date='20180627', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20180627_tscode_list = list() 
for ts_code_sh in daily_20180627['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20180627_tscode_list.append(stock_name)
daily_20180627_addname_dataframe=pd.DataFrame()
daily_20180627_addname_dataframe['cname'] = daily_20180627_tscode_list
for table_name in daily_20180627.columns.values.tolist():
    daily_20180627_addname_dataframe[table_name] = daily_20180627[table_name]
print("日线行情-时间为序  daily_20180627 返回数据 row 行数 = "+str(daily_20180627.shape[0]))
daily_20180627_addname_dataframe.to_excel(daily_201806_excel_writer,'27_3',index=False)
daily_201806_excel_writer.save()
daily_20180628 = pro.daily(start_date='',end_date='',trade_date='20180628', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20180628_tscode_list = list() 
for ts_code_sh in daily_20180628['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20180628_tscode_list.append(stock_name)
daily_20180628_addname_dataframe=pd.DataFrame()
daily_20180628_addname_dataframe['cname'] = daily_20180628_tscode_list
for table_name in daily_20180628.columns.values.tolist():
    daily_20180628_addname_dataframe[table_name] = daily_20180628[table_name]
print("日线行情-时间为序  daily_20180628 返回数据 row 行数 = "+str(daily_20180628.shape[0]))
daily_20180628_addname_dataframe.to_excel(daily_201806_excel_writer,'28_4',index=False)
daily_201806_excel_writer.save()
daily_20180629 = pro.daily(start_date='',end_date='',trade_date='20180629', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20180629_tscode_list = list() 
for ts_code_sh in daily_20180629['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20180629_tscode_list.append(stock_name)
daily_20180629_addname_dataframe=pd.DataFrame()
daily_20180629_addname_dataframe['cname'] = daily_20180629_tscode_list
for table_name in daily_20180629.columns.values.tolist():
    daily_20180629_addname_dataframe[table_name] = daily_20180629[table_name]
print("日线行情-时间为序  daily_20180629 返回数据 row 行数 = "+str(daily_20180629.shape[0]))
daily_20180629_addname_dataframe.to_excel(daily_201806_excel_writer,'29_5',index=False)
daily_201806_excel_writer.save()




createexcel('daily_201807.xlsx')
daily_201807_book = load_workbook('C:\\Users\\zhuzj5\\Desktop\\zbin\\J0_Data\\daily_201807.xlsx')
daily_201807_excel_writer = pd.ExcelWriter('C:\\Users\\zhuzj5\\Desktop\\zbin\\J0_Data\\daily_201807.xlsx', engine='openpyxl')
daily_201807_excel_writer.book = daily_201807_book
daily_201807_excel_writer.sheets = dict((ws.title, ws) for ws in daily_201807_book.worksheets)
J0_PROPS.put(tree_node_name+"record_date", "20180701")       ###  更新 记录日期
daily_20180702 = pro.daily(start_date='',end_date='',trade_date='20180702', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20180702_tscode_list = list() 
for ts_code_sh in daily_20180702['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20180702_tscode_list.append(stock_name)
daily_20180702_addname_dataframe=pd.DataFrame()
daily_20180702_addname_dataframe['cname'] = daily_20180702_tscode_list
for table_name in daily_20180702.columns.values.tolist():
    daily_20180702_addname_dataframe[table_name] = daily_20180702[table_name]
print("日线行情-时间为序  daily_20180702 返回数据 row 行数 = "+str(daily_20180702.shape[0]))
daily_20180702_addname_dataframe.to_excel(daily_201807_excel_writer,'2_1',index=False)
daily_201807_excel_writer.save()
daily_20180703 = pro.daily(start_date='',end_date='',trade_date='20180703', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20180703_tscode_list = list() 
for ts_code_sh in daily_20180703['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20180703_tscode_list.append(stock_name)
daily_20180703_addname_dataframe=pd.DataFrame()
daily_20180703_addname_dataframe['cname'] = daily_20180703_tscode_list
for table_name in daily_20180703.columns.values.tolist():
    daily_20180703_addname_dataframe[table_name] = daily_20180703[table_name]
print("日线行情-时间为序  daily_20180703 返回数据 row 行数 = "+str(daily_20180703.shape[0]))
daily_20180703_addname_dataframe.to_excel(daily_201807_excel_writer,'3_2',index=False)
daily_201807_excel_writer.save()
daily_20180704 = pro.daily(start_date='',end_date='',trade_date='20180704', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20180704_tscode_list = list() 
for ts_code_sh in daily_20180704['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20180704_tscode_list.append(stock_name)
daily_20180704_addname_dataframe=pd.DataFrame()
daily_20180704_addname_dataframe['cname'] = daily_20180704_tscode_list
for table_name in daily_20180704.columns.values.tolist():
    daily_20180704_addname_dataframe[table_name] = daily_20180704[table_name]
print("日线行情-时间为序  daily_20180704 返回数据 row 行数 = "+str(daily_20180704.shape[0]))
daily_20180704_addname_dataframe.to_excel(daily_201807_excel_writer,'4_3',index=False)
daily_201807_excel_writer.save()
daily_20180705 = pro.daily(start_date='',end_date='',trade_date='20180705', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20180705_tscode_list = list() 
for ts_code_sh in daily_20180705['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20180705_tscode_list.append(stock_name)
daily_20180705_addname_dataframe=pd.DataFrame()
daily_20180705_addname_dataframe['cname'] = daily_20180705_tscode_list
for table_name in daily_20180705.columns.values.tolist():
    daily_20180705_addname_dataframe[table_name] = daily_20180705[table_name]
print("日线行情-时间为序  daily_20180705 返回数据 row 行数 = "+str(daily_20180705.shape[0]))
daily_20180705_addname_dataframe.to_excel(daily_201807_excel_writer,'5_4',index=False)
daily_201807_excel_writer.save()
daily_20180706 = pro.daily(start_date='',end_date='',trade_date='20180706', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20180706_tscode_list = list() 
for ts_code_sh in daily_20180706['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20180706_tscode_list.append(stock_name)
daily_20180706_addname_dataframe=pd.DataFrame()
daily_20180706_addname_dataframe['cname'] = daily_20180706_tscode_list
for table_name in daily_20180706.columns.values.tolist():
    daily_20180706_addname_dataframe[table_name] = daily_20180706[table_name]
print("日线行情-时间为序  daily_20180706 返回数据 row 行数 = "+str(daily_20180706.shape[0]))
daily_20180706_addname_dataframe.to_excel(daily_201807_excel_writer,'6_5',index=False)
daily_201807_excel_writer.save()
daily_20180709 = pro.daily(start_date='',end_date='',trade_date='20180709', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20180709_tscode_list = list() 
for ts_code_sh in daily_20180709['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20180709_tscode_list.append(stock_name)
daily_20180709_addname_dataframe=pd.DataFrame()
daily_20180709_addname_dataframe['cname'] = daily_20180709_tscode_list
for table_name in daily_20180709.columns.values.tolist():
    daily_20180709_addname_dataframe[table_name] = daily_20180709[table_name]
print("日线行情-时间为序  daily_20180709 返回数据 row 行数 = "+str(daily_20180709.shape[0]))
daily_20180709_addname_dataframe.to_excel(daily_201807_excel_writer,'9_1',index=False)
daily_201807_excel_writer.save()
daily_20180710 = pro.daily(start_date='',end_date='',trade_date='20180710', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20180710_tscode_list = list() 
for ts_code_sh in daily_20180710['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20180710_tscode_list.append(stock_name)
daily_20180710_addname_dataframe=pd.DataFrame()
daily_20180710_addname_dataframe['cname'] = daily_20180710_tscode_list
for table_name in daily_20180710.columns.values.tolist():
    daily_20180710_addname_dataframe[table_name] = daily_20180710[table_name]
print("日线行情-时间为序  daily_20180710 返回数据 row 行数 = "+str(daily_20180710.shape[0]))
daily_20180710_addname_dataframe.to_excel(daily_201807_excel_writer,'10_2',index=False)
daily_201807_excel_writer.save()
daily_20180711 = pro.daily(start_date='',end_date='',trade_date='20180711', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20180711_tscode_list = list() 
for ts_code_sh in daily_20180711['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20180711_tscode_list.append(stock_name)
daily_20180711_addname_dataframe=pd.DataFrame()
daily_20180711_addname_dataframe['cname'] = daily_20180711_tscode_list
for table_name in daily_20180711.columns.values.tolist():
    daily_20180711_addname_dataframe[table_name] = daily_20180711[table_name]
print("日线行情-时间为序  daily_20180711 返回数据 row 行数 = "+str(daily_20180711.shape[0]))
daily_20180711_addname_dataframe.to_excel(daily_201807_excel_writer,'11_3',index=False)
daily_201807_excel_writer.save()
daily_20180712 = pro.daily(start_date='',end_date='',trade_date='20180712', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20180712_tscode_list = list() 
for ts_code_sh in daily_20180712['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20180712_tscode_list.append(stock_name)
daily_20180712_addname_dataframe=pd.DataFrame()
daily_20180712_addname_dataframe['cname'] = daily_20180712_tscode_list
for table_name in daily_20180712.columns.values.tolist():
    daily_20180712_addname_dataframe[table_name] = daily_20180712[table_name]
print("日线行情-时间为序  daily_20180712 返回数据 row 行数 = "+str(daily_20180712.shape[0]))
daily_20180712_addname_dataframe.to_excel(daily_201807_excel_writer,'12_4',index=False)
daily_201807_excel_writer.save()
daily_20180713 = pro.daily(start_date='',end_date='',trade_date='20180713', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20180713_tscode_list = list() 
for ts_code_sh in daily_20180713['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20180713_tscode_list.append(stock_name)
daily_20180713_addname_dataframe=pd.DataFrame()
daily_20180713_addname_dataframe['cname'] = daily_20180713_tscode_list
for table_name in daily_20180713.columns.values.tolist():
    daily_20180713_addname_dataframe[table_name] = daily_20180713[table_name]
print("日线行情-时间为序  daily_20180713 返回数据 row 行数 = "+str(daily_20180713.shape[0]))
daily_20180713_addname_dataframe.to_excel(daily_201807_excel_writer,'13_5',index=False)
daily_201807_excel_writer.save()
daily_20180716 = pro.daily(start_date='',end_date='',trade_date='20180716', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20180716_tscode_list = list() 
for ts_code_sh in daily_20180716['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20180716_tscode_list.append(stock_name)
daily_20180716_addname_dataframe=pd.DataFrame()
daily_20180716_addname_dataframe['cname'] = daily_20180716_tscode_list
for table_name in daily_20180716.columns.values.tolist():
    daily_20180716_addname_dataframe[table_name] = daily_20180716[table_name]
print("日线行情-时间为序  daily_20180716 返回数据 row 行数 = "+str(daily_20180716.shape[0]))
daily_20180716_addname_dataframe.to_excel(daily_201807_excel_writer,'16_1',index=False)
daily_201807_excel_writer.save()
daily_20180717 = pro.daily(start_date='',end_date='',trade_date='20180717', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20180717_tscode_list = list() 
for ts_code_sh in daily_20180717['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20180717_tscode_list.append(stock_name)
daily_20180717_addname_dataframe=pd.DataFrame()
daily_20180717_addname_dataframe['cname'] = daily_20180717_tscode_list
for table_name in daily_20180717.columns.values.tolist():
    daily_20180717_addname_dataframe[table_name] = daily_20180717[table_name]
print("日线行情-时间为序  daily_20180717 返回数据 row 行数 = "+str(daily_20180717.shape[0]))
daily_20180717_addname_dataframe.to_excel(daily_201807_excel_writer,'17_2',index=False)
daily_201807_excel_writer.save()
daily_20180718 = pro.daily(start_date='',end_date='',trade_date='20180718', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20180718_tscode_list = list() 
for ts_code_sh in daily_20180718['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20180718_tscode_list.append(stock_name)
daily_20180718_addname_dataframe=pd.DataFrame()
daily_20180718_addname_dataframe['cname'] = daily_20180718_tscode_list
for table_name in daily_20180718.columns.values.tolist():
    daily_20180718_addname_dataframe[table_name] = daily_20180718[table_name]
print("日线行情-时间为序  daily_20180718 返回数据 row 行数 = "+str(daily_20180718.shape[0]))
daily_20180718_addname_dataframe.to_excel(daily_201807_excel_writer,'18_3',index=False)
daily_201807_excel_writer.save()
daily_20180719 = pro.daily(start_date='',end_date='',trade_date='20180719', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20180719_tscode_list = list() 
for ts_code_sh in daily_20180719['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20180719_tscode_list.append(stock_name)
daily_20180719_addname_dataframe=pd.DataFrame()
daily_20180719_addname_dataframe['cname'] = daily_20180719_tscode_list
for table_name in daily_20180719.columns.values.tolist():
    daily_20180719_addname_dataframe[table_name] = daily_20180719[table_name]
print("日线行情-时间为序  daily_20180719 返回数据 row 行数 = "+str(daily_20180719.shape[0]))
daily_20180719_addname_dataframe.to_excel(daily_201807_excel_writer,'19_4',index=False)
daily_201807_excel_writer.save()
daily_20180720 = pro.daily(start_date='',end_date='',trade_date='20180720', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20180720_tscode_list = list() 
for ts_code_sh in daily_20180720['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20180720_tscode_list.append(stock_name)
daily_20180720_addname_dataframe=pd.DataFrame()
daily_20180720_addname_dataframe['cname'] = daily_20180720_tscode_list
for table_name in daily_20180720.columns.values.tolist():
    daily_20180720_addname_dataframe[table_name] = daily_20180720[table_name]
print("日线行情-时间为序  daily_20180720 返回数据 row 行数 = "+str(daily_20180720.shape[0]))
daily_20180720_addname_dataframe.to_excel(daily_201807_excel_writer,'20_5',index=False)
daily_201807_excel_writer.save()
daily_20180723 = pro.daily(start_date='',end_date='',trade_date='20180723', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20180723_tscode_list = list() 
for ts_code_sh in daily_20180723['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20180723_tscode_list.append(stock_name)
daily_20180723_addname_dataframe=pd.DataFrame()
daily_20180723_addname_dataframe['cname'] = daily_20180723_tscode_list
for table_name in daily_20180723.columns.values.tolist():
    daily_20180723_addname_dataframe[table_name] = daily_20180723[table_name]
print("日线行情-时间为序  daily_20180723 返回数据 row 行数 = "+str(daily_20180723.shape[0]))
daily_20180723_addname_dataframe.to_excel(daily_201807_excel_writer,'23_1',index=False)
daily_201807_excel_writer.save()
daily_20180724 = pro.daily(start_date='',end_date='',trade_date='20180724', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20180724_tscode_list = list() 
for ts_code_sh in daily_20180724['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20180724_tscode_list.append(stock_name)
daily_20180724_addname_dataframe=pd.DataFrame()
daily_20180724_addname_dataframe['cname'] = daily_20180724_tscode_list
for table_name in daily_20180724.columns.values.tolist():
    daily_20180724_addname_dataframe[table_name] = daily_20180724[table_name]
print("日线行情-时间为序  daily_20180724 返回数据 row 行数 = "+str(daily_20180724.shape[0]))
daily_20180724_addname_dataframe.to_excel(daily_201807_excel_writer,'24_2',index=False)
daily_201807_excel_writer.save()
daily_20180725 = pro.daily(start_date='',end_date='',trade_date='20180725', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20180725_tscode_list = list() 
for ts_code_sh in daily_20180725['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20180725_tscode_list.append(stock_name)
daily_20180725_addname_dataframe=pd.DataFrame()
daily_20180725_addname_dataframe['cname'] = daily_20180725_tscode_list
for table_name in daily_20180725.columns.values.tolist():
    daily_20180725_addname_dataframe[table_name] = daily_20180725[table_name]
print("日线行情-时间为序  daily_20180725 返回数据 row 行数 = "+str(daily_20180725.shape[0]))
daily_20180725_addname_dataframe.to_excel(daily_201807_excel_writer,'25_3',index=False)
daily_201807_excel_writer.save()
daily_20180726 = pro.daily(start_date='',end_date='',trade_date='20180726', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20180726_tscode_list = list() 
for ts_code_sh in daily_20180726['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20180726_tscode_list.append(stock_name)
daily_20180726_addname_dataframe=pd.DataFrame()
daily_20180726_addname_dataframe['cname'] = daily_20180726_tscode_list
for table_name in daily_20180726.columns.values.tolist():
    daily_20180726_addname_dataframe[table_name] = daily_20180726[table_name]
print("日线行情-时间为序  daily_20180726 返回数据 row 行数 = "+str(daily_20180726.shape[0]))
daily_20180726_addname_dataframe.to_excel(daily_201807_excel_writer,'26_4',index=False)
daily_201807_excel_writer.save()
daily_20180727 = pro.daily(start_date='',end_date='',trade_date='20180727', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20180727_tscode_list = list() 
for ts_code_sh in daily_20180727['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20180727_tscode_list.append(stock_name)
daily_20180727_addname_dataframe=pd.DataFrame()
daily_20180727_addname_dataframe['cname'] = daily_20180727_tscode_list
for table_name in daily_20180727.columns.values.tolist():
    daily_20180727_addname_dataframe[table_name] = daily_20180727[table_name]
print("日线行情-时间为序  daily_20180727 返回数据 row 行数 = "+str(daily_20180727.shape[0]))
daily_20180727_addname_dataframe.to_excel(daily_201807_excel_writer,'27_5',index=False)
daily_201807_excel_writer.save()
daily_20180730 = pro.daily(start_date='',end_date='',trade_date='20180730', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20180730_tscode_list = list() 
for ts_code_sh in daily_20180730['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20180730_tscode_list.append(stock_name)
daily_20180730_addname_dataframe=pd.DataFrame()
daily_20180730_addname_dataframe['cname'] = daily_20180730_tscode_list
for table_name in daily_20180730.columns.values.tolist():
    daily_20180730_addname_dataframe[table_name] = daily_20180730[table_name]
print("日线行情-时间为序  daily_20180730 返回数据 row 行数 = "+str(daily_20180730.shape[0]))
daily_20180730_addname_dataframe.to_excel(daily_201807_excel_writer,'30_1',index=False)
daily_201807_excel_writer.save()
daily_20180731 = pro.daily(start_date='',end_date='',trade_date='20180731', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20180731_tscode_list = list() 
for ts_code_sh in daily_20180731['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20180731_tscode_list.append(stock_name)
daily_20180731_addname_dataframe=pd.DataFrame()
daily_20180731_addname_dataframe['cname'] = daily_20180731_tscode_list
for table_name in daily_20180731.columns.values.tolist():
    daily_20180731_addname_dataframe[table_name] = daily_20180731[table_name]
print("日线行情-时间为序  daily_20180731 返回数据 row 行数 = "+str(daily_20180731.shape[0]))
daily_20180731_addname_dataframe.to_excel(daily_201807_excel_writer,'31_2',index=False)
daily_201807_excel_writer.save()




createexcel('daily_201808.xlsx')
daily_201808_book = load_workbook('C:\\Users\\zhuzj5\\Desktop\\zbin\\J0_Data\\daily_201808.xlsx')
daily_201808_excel_writer = pd.ExcelWriter('C:\\Users\\zhuzj5\\Desktop\\zbin\\J0_Data\\daily_201808.xlsx', engine='openpyxl')
daily_201808_excel_writer.book = daily_201808_book
daily_201808_excel_writer.sheets = dict((ws.title, ws) for ws in daily_201808_book.worksheets)
J0_PROPS.put(tree_node_name+"record_date", "20180801")       ###  更新 记录日期
daily_20180801 = pro.daily(start_date='',end_date='',trade_date='20180801', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20180801_tscode_list = list() 
for ts_code_sh in daily_20180801['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20180801_tscode_list.append(stock_name)
daily_20180801_addname_dataframe=pd.DataFrame()
daily_20180801_addname_dataframe['cname'] = daily_20180801_tscode_list
for table_name in daily_20180801.columns.values.tolist():
    daily_20180801_addname_dataframe[table_name] = daily_20180801[table_name]
print("日线行情-时间为序  daily_20180801 返回数据 row 行数 = "+str(daily_20180801.shape[0]))
daily_20180801_addname_dataframe.to_excel(daily_201808_excel_writer,'1_3',index=False)
daily_201808_excel_writer.save()
daily_20180802 = pro.daily(start_date='',end_date='',trade_date='20180802', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20180802_tscode_list = list() 
for ts_code_sh in daily_20180802['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20180802_tscode_list.append(stock_name)
daily_20180802_addname_dataframe=pd.DataFrame()
daily_20180802_addname_dataframe['cname'] = daily_20180802_tscode_list
for table_name in daily_20180802.columns.values.tolist():
    daily_20180802_addname_dataframe[table_name] = daily_20180802[table_name]
print("日线行情-时间为序  daily_20180802 返回数据 row 行数 = "+str(daily_20180802.shape[0]))
daily_20180802_addname_dataframe.to_excel(daily_201808_excel_writer,'2_4',index=False)
daily_201808_excel_writer.save()
daily_20180803 = pro.daily(start_date='',end_date='',trade_date='20180803', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20180803_tscode_list = list() 
for ts_code_sh in daily_20180803['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20180803_tscode_list.append(stock_name)
daily_20180803_addname_dataframe=pd.DataFrame()
daily_20180803_addname_dataframe['cname'] = daily_20180803_tscode_list
for table_name in daily_20180803.columns.values.tolist():
    daily_20180803_addname_dataframe[table_name] = daily_20180803[table_name]
print("日线行情-时间为序  daily_20180803 返回数据 row 行数 = "+str(daily_20180803.shape[0]))
daily_20180803_addname_dataframe.to_excel(daily_201808_excel_writer,'3_5',index=False)
daily_201808_excel_writer.save()
daily_20180806 = pro.daily(start_date='',end_date='',trade_date='20180806', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20180806_tscode_list = list() 
for ts_code_sh in daily_20180806['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20180806_tscode_list.append(stock_name)
daily_20180806_addname_dataframe=pd.DataFrame()
daily_20180806_addname_dataframe['cname'] = daily_20180806_tscode_list
for table_name in daily_20180806.columns.values.tolist():
    daily_20180806_addname_dataframe[table_name] = daily_20180806[table_name]
print("日线行情-时间为序  daily_20180806 返回数据 row 行数 = "+str(daily_20180806.shape[0]))
daily_20180806_addname_dataframe.to_excel(daily_201808_excel_writer,'6_1',index=False)
daily_201808_excel_writer.save()
daily_20180807 = pro.daily(start_date='',end_date='',trade_date='20180807', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20180807_tscode_list = list() 
for ts_code_sh in daily_20180807['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20180807_tscode_list.append(stock_name)
daily_20180807_addname_dataframe=pd.DataFrame()
daily_20180807_addname_dataframe['cname'] = daily_20180807_tscode_list
for table_name in daily_20180807.columns.values.tolist():
    daily_20180807_addname_dataframe[table_name] = daily_20180807[table_name]
print("日线行情-时间为序  daily_20180807 返回数据 row 行数 = "+str(daily_20180807.shape[0]))
daily_20180807_addname_dataframe.to_excel(daily_201808_excel_writer,'7_2',index=False)
daily_201808_excel_writer.save()
daily_20180808 = pro.daily(start_date='',end_date='',trade_date='20180808', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20180808_tscode_list = list() 
for ts_code_sh in daily_20180808['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20180808_tscode_list.append(stock_name)
daily_20180808_addname_dataframe=pd.DataFrame()
daily_20180808_addname_dataframe['cname'] = daily_20180808_tscode_list
for table_name in daily_20180808.columns.values.tolist():
    daily_20180808_addname_dataframe[table_name] = daily_20180808[table_name]
print("日线行情-时间为序  daily_20180808 返回数据 row 行数 = "+str(daily_20180808.shape[0]))
daily_20180808_addname_dataframe.to_excel(daily_201808_excel_writer,'8_3',index=False)
daily_201808_excel_writer.save()
daily_20180809 = pro.daily(start_date='',end_date='',trade_date='20180809', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20180809_tscode_list = list() 
for ts_code_sh in daily_20180809['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20180809_tscode_list.append(stock_name)
daily_20180809_addname_dataframe=pd.DataFrame()
daily_20180809_addname_dataframe['cname'] = daily_20180809_tscode_list
for table_name in daily_20180809.columns.values.tolist():
    daily_20180809_addname_dataframe[table_name] = daily_20180809[table_name]
print("日线行情-时间为序  daily_20180809 返回数据 row 行数 = "+str(daily_20180809.shape[0]))
daily_20180809_addname_dataframe.to_excel(daily_201808_excel_writer,'9_4',index=False)
daily_201808_excel_writer.save()
daily_20180810 = pro.daily(start_date='',end_date='',trade_date='20180810', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20180810_tscode_list = list() 
for ts_code_sh in daily_20180810['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20180810_tscode_list.append(stock_name)
daily_20180810_addname_dataframe=pd.DataFrame()
daily_20180810_addname_dataframe['cname'] = daily_20180810_tscode_list
for table_name in daily_20180810.columns.values.tolist():
    daily_20180810_addname_dataframe[table_name] = daily_20180810[table_name]
print("日线行情-时间为序  daily_20180810 返回数据 row 行数 = "+str(daily_20180810.shape[0]))
daily_20180810_addname_dataframe.to_excel(daily_201808_excel_writer,'10_5',index=False)
daily_201808_excel_writer.save()
daily_20180813 = pro.daily(start_date='',end_date='',trade_date='20180813', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20180813_tscode_list = list() 
for ts_code_sh in daily_20180813['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20180813_tscode_list.append(stock_name)
daily_20180813_addname_dataframe=pd.DataFrame()
daily_20180813_addname_dataframe['cname'] = daily_20180813_tscode_list
for table_name in daily_20180813.columns.values.tolist():
    daily_20180813_addname_dataframe[table_name] = daily_20180813[table_name]
print("日线行情-时间为序  daily_20180813 返回数据 row 行数 = "+str(daily_20180813.shape[0]))
daily_20180813_addname_dataframe.to_excel(daily_201808_excel_writer,'13_1',index=False)
daily_201808_excel_writer.save()
daily_20180814 = pro.daily(start_date='',end_date='',trade_date='20180814', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20180814_tscode_list = list() 
for ts_code_sh in daily_20180814['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20180814_tscode_list.append(stock_name)
daily_20180814_addname_dataframe=pd.DataFrame()
daily_20180814_addname_dataframe['cname'] = daily_20180814_tscode_list
for table_name in daily_20180814.columns.values.tolist():
    daily_20180814_addname_dataframe[table_name] = daily_20180814[table_name]
print("日线行情-时间为序  daily_20180814 返回数据 row 行数 = "+str(daily_20180814.shape[0]))
daily_20180814_addname_dataframe.to_excel(daily_201808_excel_writer,'14_2',index=False)
daily_201808_excel_writer.save()
daily_20180815 = pro.daily(start_date='',end_date='',trade_date='20180815', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20180815_tscode_list = list() 
for ts_code_sh in daily_20180815['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20180815_tscode_list.append(stock_name)
daily_20180815_addname_dataframe=pd.DataFrame()
daily_20180815_addname_dataframe['cname'] = daily_20180815_tscode_list
for table_name in daily_20180815.columns.values.tolist():
    daily_20180815_addname_dataframe[table_name] = daily_20180815[table_name]
print("日线行情-时间为序  daily_20180815 返回数据 row 行数 = "+str(daily_20180815.shape[0]))
daily_20180815_addname_dataframe.to_excel(daily_201808_excel_writer,'15_3',index=False)
daily_201808_excel_writer.save()
daily_20180816 = pro.daily(start_date='',end_date='',trade_date='20180816', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20180816_tscode_list = list() 
for ts_code_sh in daily_20180816['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20180816_tscode_list.append(stock_name)
daily_20180816_addname_dataframe=pd.DataFrame()
daily_20180816_addname_dataframe['cname'] = daily_20180816_tscode_list
for table_name in daily_20180816.columns.values.tolist():
    daily_20180816_addname_dataframe[table_name] = daily_20180816[table_name]
print("日线行情-时间为序  daily_20180816 返回数据 row 行数 = "+str(daily_20180816.shape[0]))
daily_20180816_addname_dataframe.to_excel(daily_201808_excel_writer,'16_4',index=False)
daily_201808_excel_writer.save()
daily_20180817 = pro.daily(start_date='',end_date='',trade_date='20180817', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20180817_tscode_list = list() 
for ts_code_sh in daily_20180817['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20180817_tscode_list.append(stock_name)
daily_20180817_addname_dataframe=pd.DataFrame()
daily_20180817_addname_dataframe['cname'] = daily_20180817_tscode_list
for table_name in daily_20180817.columns.values.tolist():
    daily_20180817_addname_dataframe[table_name] = daily_20180817[table_name]
print("日线行情-时间为序  daily_20180817 返回数据 row 行数 = "+str(daily_20180817.shape[0]))
daily_20180817_addname_dataframe.to_excel(daily_201808_excel_writer,'17_5',index=False)
daily_201808_excel_writer.save()
daily_20180820 = pro.daily(start_date='',end_date='',trade_date='20180820', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20180820_tscode_list = list() 
for ts_code_sh in daily_20180820['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20180820_tscode_list.append(stock_name)
daily_20180820_addname_dataframe=pd.DataFrame()
daily_20180820_addname_dataframe['cname'] = daily_20180820_tscode_list
for table_name in daily_20180820.columns.values.tolist():
    daily_20180820_addname_dataframe[table_name] = daily_20180820[table_name]
print("日线行情-时间为序  daily_20180820 返回数据 row 行数 = "+str(daily_20180820.shape[0]))
daily_20180820_addname_dataframe.to_excel(daily_201808_excel_writer,'20_1',index=False)
daily_201808_excel_writer.save()
daily_20180821 = pro.daily(start_date='',end_date='',trade_date='20180821', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20180821_tscode_list = list() 
for ts_code_sh in daily_20180821['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20180821_tscode_list.append(stock_name)
daily_20180821_addname_dataframe=pd.DataFrame()
daily_20180821_addname_dataframe['cname'] = daily_20180821_tscode_list
for table_name in daily_20180821.columns.values.tolist():
    daily_20180821_addname_dataframe[table_name] = daily_20180821[table_name]
print("日线行情-时间为序  daily_20180821 返回数据 row 行数 = "+str(daily_20180821.shape[0]))
daily_20180821_addname_dataframe.to_excel(daily_201808_excel_writer,'21_2',index=False)
daily_201808_excel_writer.save()
daily_20180822 = pro.daily(start_date='',end_date='',trade_date='20180822', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20180822_tscode_list = list() 
for ts_code_sh in daily_20180822['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20180822_tscode_list.append(stock_name)
daily_20180822_addname_dataframe=pd.DataFrame()
daily_20180822_addname_dataframe['cname'] = daily_20180822_tscode_list
for table_name in daily_20180822.columns.values.tolist():
    daily_20180822_addname_dataframe[table_name] = daily_20180822[table_name]
print("日线行情-时间为序  daily_20180822 返回数据 row 行数 = "+str(daily_20180822.shape[0]))
daily_20180822_addname_dataframe.to_excel(daily_201808_excel_writer,'22_3',index=False)
daily_201808_excel_writer.save()
daily_20180823 = pro.daily(start_date='',end_date='',trade_date='20180823', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20180823_tscode_list = list() 
for ts_code_sh in daily_20180823['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20180823_tscode_list.append(stock_name)
daily_20180823_addname_dataframe=pd.DataFrame()
daily_20180823_addname_dataframe['cname'] = daily_20180823_tscode_list
for table_name in daily_20180823.columns.values.tolist():
    daily_20180823_addname_dataframe[table_name] = daily_20180823[table_name]
print("日线行情-时间为序  daily_20180823 返回数据 row 行数 = "+str(daily_20180823.shape[0]))
daily_20180823_addname_dataframe.to_excel(daily_201808_excel_writer,'23_4',index=False)
daily_201808_excel_writer.save()
daily_20180824 = pro.daily(start_date='',end_date='',trade_date='20180824', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20180824_tscode_list = list() 
for ts_code_sh in daily_20180824['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20180824_tscode_list.append(stock_name)
daily_20180824_addname_dataframe=pd.DataFrame()
daily_20180824_addname_dataframe['cname'] = daily_20180824_tscode_list
for table_name in daily_20180824.columns.values.tolist():
    daily_20180824_addname_dataframe[table_name] = daily_20180824[table_name]
print("日线行情-时间为序  daily_20180824 返回数据 row 行数 = "+str(daily_20180824.shape[0]))
daily_20180824_addname_dataframe.to_excel(daily_201808_excel_writer,'24_5',index=False)
daily_201808_excel_writer.save()
daily_20180827 = pro.daily(start_date='',end_date='',trade_date='20180827', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20180827_tscode_list = list() 
for ts_code_sh in daily_20180827['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20180827_tscode_list.append(stock_name)
daily_20180827_addname_dataframe=pd.DataFrame()
daily_20180827_addname_dataframe['cname'] = daily_20180827_tscode_list
for table_name in daily_20180827.columns.values.tolist():
    daily_20180827_addname_dataframe[table_name] = daily_20180827[table_name]
print("日线行情-时间为序  daily_20180827 返回数据 row 行数 = "+str(daily_20180827.shape[0]))
daily_20180827_addname_dataframe.to_excel(daily_201808_excel_writer,'27_1',index=False)
daily_201808_excel_writer.save()
daily_20180828 = pro.daily(start_date='',end_date='',trade_date='20180828', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20180828_tscode_list = list() 
for ts_code_sh in daily_20180828['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20180828_tscode_list.append(stock_name)
daily_20180828_addname_dataframe=pd.DataFrame()
daily_20180828_addname_dataframe['cname'] = daily_20180828_tscode_list
for table_name in daily_20180828.columns.values.tolist():
    daily_20180828_addname_dataframe[table_name] = daily_20180828[table_name]
print("日线行情-时间为序  daily_20180828 返回数据 row 行数 = "+str(daily_20180828.shape[0]))
daily_20180828_addname_dataframe.to_excel(daily_201808_excel_writer,'28_2',index=False)
daily_201808_excel_writer.save()
daily_20180829 = pro.daily(start_date='',end_date='',trade_date='20180829', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20180829_tscode_list = list() 
for ts_code_sh in daily_20180829['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20180829_tscode_list.append(stock_name)
daily_20180829_addname_dataframe=pd.DataFrame()
daily_20180829_addname_dataframe['cname'] = daily_20180829_tscode_list
for table_name in daily_20180829.columns.values.tolist():
    daily_20180829_addname_dataframe[table_name] = daily_20180829[table_name]
print("日线行情-时间为序  daily_20180829 返回数据 row 行数 = "+str(daily_20180829.shape[0]))
daily_20180829_addname_dataframe.to_excel(daily_201808_excel_writer,'29_3',index=False)
daily_201808_excel_writer.save()
daily_20180830 = pro.daily(start_date='',end_date='',trade_date='20180830', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20180830_tscode_list = list() 
for ts_code_sh in daily_20180830['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20180830_tscode_list.append(stock_name)
daily_20180830_addname_dataframe=pd.DataFrame()
daily_20180830_addname_dataframe['cname'] = daily_20180830_tscode_list
for table_name in daily_20180830.columns.values.tolist():
    daily_20180830_addname_dataframe[table_name] = daily_20180830[table_name]
print("日线行情-时间为序  daily_20180830 返回数据 row 行数 = "+str(daily_20180830.shape[0]))
daily_20180830_addname_dataframe.to_excel(daily_201808_excel_writer,'30_4',index=False)
daily_201808_excel_writer.save()
daily_20180831 = pro.daily(start_date='',end_date='',trade_date='20180831', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20180831_tscode_list = list() 
for ts_code_sh in daily_20180831['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20180831_tscode_list.append(stock_name)
daily_20180831_addname_dataframe=pd.DataFrame()
daily_20180831_addname_dataframe['cname'] = daily_20180831_tscode_list
for table_name in daily_20180831.columns.values.tolist():
    daily_20180831_addname_dataframe[table_name] = daily_20180831[table_name]
print("日线行情-时间为序  daily_20180831 返回数据 row 行数 = "+str(daily_20180831.shape[0]))
daily_20180831_addname_dataframe.to_excel(daily_201808_excel_writer,'31_5',index=False)
daily_201808_excel_writer.save()




createexcel('daily_201809.xlsx')
daily_201809_book = load_workbook('C:\\Users\\zhuzj5\\Desktop\\zbin\\J0_Data\\daily_201809.xlsx')
daily_201809_excel_writer = pd.ExcelWriter('C:\\Users\\zhuzj5\\Desktop\\zbin\\J0_Data\\daily_201809.xlsx', engine='openpyxl')
daily_201809_excel_writer.book = daily_201809_book
daily_201809_excel_writer.sheets = dict((ws.title, ws) for ws in daily_201809_book.worksheets)
J0_PROPS.put(tree_node_name+"record_date", "20180901")       ###  更新 记录日期
daily_20180903 = pro.daily(start_date='',end_date='',trade_date='20180903', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20180903_tscode_list = list() 
for ts_code_sh in daily_20180903['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20180903_tscode_list.append(stock_name)
daily_20180903_addname_dataframe=pd.DataFrame()
daily_20180903_addname_dataframe['cname'] = daily_20180903_tscode_list
for table_name in daily_20180903.columns.values.tolist():
    daily_20180903_addname_dataframe[table_name] = daily_20180903[table_name]
print("日线行情-时间为序  daily_20180903 返回数据 row 行数 = "+str(daily_20180903.shape[0]))
daily_20180903_addname_dataframe.to_excel(daily_201809_excel_writer,'3_1',index=False)
daily_201809_excel_writer.save()
daily_20180904 = pro.daily(start_date='',end_date='',trade_date='20180904', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20180904_tscode_list = list() 
for ts_code_sh in daily_20180904['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20180904_tscode_list.append(stock_name)
daily_20180904_addname_dataframe=pd.DataFrame()
daily_20180904_addname_dataframe['cname'] = daily_20180904_tscode_list
for table_name in daily_20180904.columns.values.tolist():
    daily_20180904_addname_dataframe[table_name] = daily_20180904[table_name]
print("日线行情-时间为序  daily_20180904 返回数据 row 行数 = "+str(daily_20180904.shape[0]))
daily_20180904_addname_dataframe.to_excel(daily_201809_excel_writer,'4_2',index=False)
daily_201809_excel_writer.save()
daily_20180905 = pro.daily(start_date='',end_date='',trade_date='20180905', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20180905_tscode_list = list() 
for ts_code_sh in daily_20180905['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20180905_tscode_list.append(stock_name)
daily_20180905_addname_dataframe=pd.DataFrame()
daily_20180905_addname_dataframe['cname'] = daily_20180905_tscode_list
for table_name in daily_20180905.columns.values.tolist():
    daily_20180905_addname_dataframe[table_name] = daily_20180905[table_name]
print("日线行情-时间为序  daily_20180905 返回数据 row 行数 = "+str(daily_20180905.shape[0]))
daily_20180905_addname_dataframe.to_excel(daily_201809_excel_writer,'5_3',index=False)
daily_201809_excel_writer.save()
daily_20180906 = pro.daily(start_date='',end_date='',trade_date='20180906', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20180906_tscode_list = list() 
for ts_code_sh in daily_20180906['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20180906_tscode_list.append(stock_name)
daily_20180906_addname_dataframe=pd.DataFrame()
daily_20180906_addname_dataframe['cname'] = daily_20180906_tscode_list
for table_name in daily_20180906.columns.values.tolist():
    daily_20180906_addname_dataframe[table_name] = daily_20180906[table_name]
print("日线行情-时间为序  daily_20180906 返回数据 row 行数 = "+str(daily_20180906.shape[0]))
daily_20180906_addname_dataframe.to_excel(daily_201809_excel_writer,'6_4',index=False)
daily_201809_excel_writer.save()
daily_20180907 = pro.daily(start_date='',end_date='',trade_date='20180907', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20180907_tscode_list = list() 
for ts_code_sh in daily_20180907['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20180907_tscode_list.append(stock_name)
daily_20180907_addname_dataframe=pd.DataFrame()
daily_20180907_addname_dataframe['cname'] = daily_20180907_tscode_list
for table_name in daily_20180907.columns.values.tolist():
    daily_20180907_addname_dataframe[table_name] = daily_20180907[table_name]
print("日线行情-时间为序  daily_20180907 返回数据 row 行数 = "+str(daily_20180907.shape[0]))
daily_20180907_addname_dataframe.to_excel(daily_201809_excel_writer,'7_5',index=False)
daily_201809_excel_writer.save()
daily_20180910 = pro.daily(start_date='',end_date='',trade_date='20180910', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20180910_tscode_list = list() 
for ts_code_sh in daily_20180910['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20180910_tscode_list.append(stock_name)
daily_20180910_addname_dataframe=pd.DataFrame()
daily_20180910_addname_dataframe['cname'] = daily_20180910_tscode_list
for table_name in daily_20180910.columns.values.tolist():
    daily_20180910_addname_dataframe[table_name] = daily_20180910[table_name]
print("日线行情-时间为序  daily_20180910 返回数据 row 行数 = "+str(daily_20180910.shape[0]))
daily_20180910_addname_dataframe.to_excel(daily_201809_excel_writer,'10_1',index=False)
daily_201809_excel_writer.save()
daily_20180911 = pro.daily(start_date='',end_date='',trade_date='20180911', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20180911_tscode_list = list() 
for ts_code_sh in daily_20180911['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20180911_tscode_list.append(stock_name)
daily_20180911_addname_dataframe=pd.DataFrame()
daily_20180911_addname_dataframe['cname'] = daily_20180911_tscode_list
for table_name in daily_20180911.columns.values.tolist():
    daily_20180911_addname_dataframe[table_name] = daily_20180911[table_name]
print("日线行情-时间为序  daily_20180911 返回数据 row 行数 = "+str(daily_20180911.shape[0]))
daily_20180911_addname_dataframe.to_excel(daily_201809_excel_writer,'11_2',index=False)
daily_201809_excel_writer.save()
daily_20180912 = pro.daily(start_date='',end_date='',trade_date='20180912', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20180912_tscode_list = list() 
for ts_code_sh in daily_20180912['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20180912_tscode_list.append(stock_name)
daily_20180912_addname_dataframe=pd.DataFrame()
daily_20180912_addname_dataframe['cname'] = daily_20180912_tscode_list
for table_name in daily_20180912.columns.values.tolist():
    daily_20180912_addname_dataframe[table_name] = daily_20180912[table_name]
print("日线行情-时间为序  daily_20180912 返回数据 row 行数 = "+str(daily_20180912.shape[0]))
daily_20180912_addname_dataframe.to_excel(daily_201809_excel_writer,'12_3',index=False)
daily_201809_excel_writer.save()
daily_20180913 = pro.daily(start_date='',end_date='',trade_date='20180913', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20180913_tscode_list = list() 
for ts_code_sh in daily_20180913['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20180913_tscode_list.append(stock_name)
daily_20180913_addname_dataframe=pd.DataFrame()
daily_20180913_addname_dataframe['cname'] = daily_20180913_tscode_list
for table_name in daily_20180913.columns.values.tolist():
    daily_20180913_addname_dataframe[table_name] = daily_20180913[table_name]
print("日线行情-时间为序  daily_20180913 返回数据 row 行数 = "+str(daily_20180913.shape[0]))
daily_20180913_addname_dataframe.to_excel(daily_201809_excel_writer,'13_4',index=False)
daily_201809_excel_writer.save()
daily_20180914 = pro.daily(start_date='',end_date='',trade_date='20180914', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20180914_tscode_list = list() 
for ts_code_sh in daily_20180914['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20180914_tscode_list.append(stock_name)
daily_20180914_addname_dataframe=pd.DataFrame()
daily_20180914_addname_dataframe['cname'] = daily_20180914_tscode_list
for table_name in daily_20180914.columns.values.tolist():
    daily_20180914_addname_dataframe[table_name] = daily_20180914[table_name]
print("日线行情-时间为序  daily_20180914 返回数据 row 行数 = "+str(daily_20180914.shape[0]))
daily_20180914_addname_dataframe.to_excel(daily_201809_excel_writer,'14_5',index=False)
daily_201809_excel_writer.save()
daily_20180917 = pro.daily(start_date='',end_date='',trade_date='20180917', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20180917_tscode_list = list() 
for ts_code_sh in daily_20180917['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20180917_tscode_list.append(stock_name)
daily_20180917_addname_dataframe=pd.DataFrame()
daily_20180917_addname_dataframe['cname'] = daily_20180917_tscode_list
for table_name in daily_20180917.columns.values.tolist():
    daily_20180917_addname_dataframe[table_name] = daily_20180917[table_name]
print("日线行情-时间为序  daily_20180917 返回数据 row 行数 = "+str(daily_20180917.shape[0]))
daily_20180917_addname_dataframe.to_excel(daily_201809_excel_writer,'17_1',index=False)
daily_201809_excel_writer.save()
daily_20180918 = pro.daily(start_date='',end_date='',trade_date='20180918', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20180918_tscode_list = list() 
for ts_code_sh in daily_20180918['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20180918_tscode_list.append(stock_name)
daily_20180918_addname_dataframe=pd.DataFrame()
daily_20180918_addname_dataframe['cname'] = daily_20180918_tscode_list
for table_name in daily_20180918.columns.values.tolist():
    daily_20180918_addname_dataframe[table_name] = daily_20180918[table_name]
print("日线行情-时间为序  daily_20180918 返回数据 row 行数 = "+str(daily_20180918.shape[0]))
daily_20180918_addname_dataframe.to_excel(daily_201809_excel_writer,'18_2',index=False)
daily_201809_excel_writer.save()
daily_20180919 = pro.daily(start_date='',end_date='',trade_date='20180919', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20180919_tscode_list = list() 
for ts_code_sh in daily_20180919['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20180919_tscode_list.append(stock_name)
daily_20180919_addname_dataframe=pd.DataFrame()
daily_20180919_addname_dataframe['cname'] = daily_20180919_tscode_list
for table_name in daily_20180919.columns.values.tolist():
    daily_20180919_addname_dataframe[table_name] = daily_20180919[table_name]
print("日线行情-时间为序  daily_20180919 返回数据 row 行数 = "+str(daily_20180919.shape[0]))
daily_20180919_addname_dataframe.to_excel(daily_201809_excel_writer,'19_3',index=False)
daily_201809_excel_writer.save()
daily_20180920 = pro.daily(start_date='',end_date='',trade_date='20180920', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20180920_tscode_list = list() 
for ts_code_sh in daily_20180920['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20180920_tscode_list.append(stock_name)
daily_20180920_addname_dataframe=pd.DataFrame()
daily_20180920_addname_dataframe['cname'] = daily_20180920_tscode_list
for table_name in daily_20180920.columns.values.tolist():
    daily_20180920_addname_dataframe[table_name] = daily_20180920[table_name]
print("日线行情-时间为序  daily_20180920 返回数据 row 行数 = "+str(daily_20180920.shape[0]))
daily_20180920_addname_dataframe.to_excel(daily_201809_excel_writer,'20_4',index=False)
daily_201809_excel_writer.save()
daily_20180921 = pro.daily(start_date='',end_date='',trade_date='20180921', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20180921_tscode_list = list() 
for ts_code_sh in daily_20180921['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20180921_tscode_list.append(stock_name)
daily_20180921_addname_dataframe=pd.DataFrame()
daily_20180921_addname_dataframe['cname'] = daily_20180921_tscode_list
for table_name in daily_20180921.columns.values.tolist():
    daily_20180921_addname_dataframe[table_name] = daily_20180921[table_name]
print("日线行情-时间为序  daily_20180921 返回数据 row 行数 = "+str(daily_20180921.shape[0]))
daily_20180921_addname_dataframe.to_excel(daily_201809_excel_writer,'21_5',index=False)
daily_201809_excel_writer.save()
daily_20180925 = pro.daily(start_date='',end_date='',trade_date='20180925', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20180925_tscode_list = list() 
for ts_code_sh in daily_20180925['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20180925_tscode_list.append(stock_name)
daily_20180925_addname_dataframe=pd.DataFrame()
daily_20180925_addname_dataframe['cname'] = daily_20180925_tscode_list
for table_name in daily_20180925.columns.values.tolist():
    daily_20180925_addname_dataframe[table_name] = daily_20180925[table_name]
print("日线行情-时间为序  daily_20180925 返回数据 row 行数 = "+str(daily_20180925.shape[0]))
daily_20180925_addname_dataframe.to_excel(daily_201809_excel_writer,'25_2',index=False)
daily_201809_excel_writer.save()
daily_20180926 = pro.daily(start_date='',end_date='',trade_date='20180926', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20180926_tscode_list = list() 
for ts_code_sh in daily_20180926['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20180926_tscode_list.append(stock_name)
daily_20180926_addname_dataframe=pd.DataFrame()
daily_20180926_addname_dataframe['cname'] = daily_20180926_tscode_list
for table_name in daily_20180926.columns.values.tolist():
    daily_20180926_addname_dataframe[table_name] = daily_20180926[table_name]
print("日线行情-时间为序  daily_20180926 返回数据 row 行数 = "+str(daily_20180926.shape[0]))
daily_20180926_addname_dataframe.to_excel(daily_201809_excel_writer,'26_3',index=False)
daily_201809_excel_writer.save()
daily_20180927 = pro.daily(start_date='',end_date='',trade_date='20180927', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20180927_tscode_list = list() 
for ts_code_sh in daily_20180927['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20180927_tscode_list.append(stock_name)
daily_20180927_addname_dataframe=pd.DataFrame()
daily_20180927_addname_dataframe['cname'] = daily_20180927_tscode_list
for table_name in daily_20180927.columns.values.tolist():
    daily_20180927_addname_dataframe[table_name] = daily_20180927[table_name]
print("日线行情-时间为序  daily_20180927 返回数据 row 行数 = "+str(daily_20180927.shape[0]))
daily_20180927_addname_dataframe.to_excel(daily_201809_excel_writer,'27_4',index=False)
daily_201809_excel_writer.save()
daily_20180928 = pro.daily(start_date='',end_date='',trade_date='20180928', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20180928_tscode_list = list() 
for ts_code_sh in daily_20180928['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20180928_tscode_list.append(stock_name)
daily_20180928_addname_dataframe=pd.DataFrame()
daily_20180928_addname_dataframe['cname'] = daily_20180928_tscode_list
for table_name in daily_20180928.columns.values.tolist():
    daily_20180928_addname_dataframe[table_name] = daily_20180928[table_name]
print("日线行情-时间为序  daily_20180928 返回数据 row 行数 = "+str(daily_20180928.shape[0]))
daily_20180928_addname_dataframe.to_excel(daily_201809_excel_writer,'28_5',index=False)
daily_201809_excel_writer.save()




createexcel('daily_201810.xlsx')
daily_201810_book = load_workbook('C:\\Users\\zhuzj5\\Desktop\\zbin\\J0_Data\\daily_201810.xlsx')
daily_201810_excel_writer = pd.ExcelWriter('C:\\Users\\zhuzj5\\Desktop\\zbin\\J0_Data\\daily_201810.xlsx', engine='openpyxl')
daily_201810_excel_writer.book = daily_201810_book
daily_201810_excel_writer.sheets = dict((ws.title, ws) for ws in daily_201810_book.worksheets)
J0_PROPS.put(tree_node_name+"record_date", "20181001")       ###  更新 记录日期
daily_20181008 = pro.daily(start_date='',end_date='',trade_date='20181008', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20181008_tscode_list = list() 
for ts_code_sh in daily_20181008['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20181008_tscode_list.append(stock_name)
daily_20181008_addname_dataframe=pd.DataFrame()
daily_20181008_addname_dataframe['cname'] = daily_20181008_tscode_list
for table_name in daily_20181008.columns.values.tolist():
    daily_20181008_addname_dataframe[table_name] = daily_20181008[table_name]
print("日线行情-时间为序  daily_20181008 返回数据 row 行数 = "+str(daily_20181008.shape[0]))
daily_20181008_addname_dataframe.to_excel(daily_201810_excel_writer,'8_1',index=False)
daily_201810_excel_writer.save()
daily_20181009 = pro.daily(start_date='',end_date='',trade_date='20181009', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20181009_tscode_list = list() 
for ts_code_sh in daily_20181009['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20181009_tscode_list.append(stock_name)
daily_20181009_addname_dataframe=pd.DataFrame()
daily_20181009_addname_dataframe['cname'] = daily_20181009_tscode_list
for table_name in daily_20181009.columns.values.tolist():
    daily_20181009_addname_dataframe[table_name] = daily_20181009[table_name]
print("日线行情-时间为序  daily_20181009 返回数据 row 行数 = "+str(daily_20181009.shape[0]))
daily_20181009_addname_dataframe.to_excel(daily_201810_excel_writer,'9_2',index=False)
daily_201810_excel_writer.save()
daily_20181010 = pro.daily(start_date='',end_date='',trade_date='20181010', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20181010_tscode_list = list() 
for ts_code_sh in daily_20181010['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20181010_tscode_list.append(stock_name)
daily_20181010_addname_dataframe=pd.DataFrame()
daily_20181010_addname_dataframe['cname'] = daily_20181010_tscode_list
for table_name in daily_20181010.columns.values.tolist():
    daily_20181010_addname_dataframe[table_name] = daily_20181010[table_name]
print("日线行情-时间为序  daily_20181010 返回数据 row 行数 = "+str(daily_20181010.shape[0]))
daily_20181010_addname_dataframe.to_excel(daily_201810_excel_writer,'10_3',index=False)
daily_201810_excel_writer.save()
daily_20181011 = pro.daily(start_date='',end_date='',trade_date='20181011', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20181011_tscode_list = list() 
for ts_code_sh in daily_20181011['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20181011_tscode_list.append(stock_name)
daily_20181011_addname_dataframe=pd.DataFrame()
daily_20181011_addname_dataframe['cname'] = daily_20181011_tscode_list
for table_name in daily_20181011.columns.values.tolist():
    daily_20181011_addname_dataframe[table_name] = daily_20181011[table_name]
print("日线行情-时间为序  daily_20181011 返回数据 row 行数 = "+str(daily_20181011.shape[0]))
daily_20181011_addname_dataframe.to_excel(daily_201810_excel_writer,'11_4',index=False)
daily_201810_excel_writer.save()
daily_20181012 = pro.daily(start_date='',end_date='',trade_date='20181012', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20181012_tscode_list = list() 
for ts_code_sh in daily_20181012['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20181012_tscode_list.append(stock_name)
daily_20181012_addname_dataframe=pd.DataFrame()
daily_20181012_addname_dataframe['cname'] = daily_20181012_tscode_list
for table_name in daily_20181012.columns.values.tolist():
    daily_20181012_addname_dataframe[table_name] = daily_20181012[table_name]
print("日线行情-时间为序  daily_20181012 返回数据 row 行数 = "+str(daily_20181012.shape[0]))
daily_20181012_addname_dataframe.to_excel(daily_201810_excel_writer,'12_5',index=False)
daily_201810_excel_writer.save()
daily_20181015 = pro.daily(start_date='',end_date='',trade_date='20181015', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20181015_tscode_list = list() 
for ts_code_sh in daily_20181015['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20181015_tscode_list.append(stock_name)
daily_20181015_addname_dataframe=pd.DataFrame()
daily_20181015_addname_dataframe['cname'] = daily_20181015_tscode_list
for table_name in daily_20181015.columns.values.tolist():
    daily_20181015_addname_dataframe[table_name] = daily_20181015[table_name]
print("日线行情-时间为序  daily_20181015 返回数据 row 行数 = "+str(daily_20181015.shape[0]))
daily_20181015_addname_dataframe.to_excel(daily_201810_excel_writer,'15_1',index=False)
daily_201810_excel_writer.save()
daily_20181016 = pro.daily(start_date='',end_date='',trade_date='20181016', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20181016_tscode_list = list() 
for ts_code_sh in daily_20181016['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20181016_tscode_list.append(stock_name)
daily_20181016_addname_dataframe=pd.DataFrame()
daily_20181016_addname_dataframe['cname'] = daily_20181016_tscode_list
for table_name in daily_20181016.columns.values.tolist():
    daily_20181016_addname_dataframe[table_name] = daily_20181016[table_name]
print("日线行情-时间为序  daily_20181016 返回数据 row 行数 = "+str(daily_20181016.shape[0]))
daily_20181016_addname_dataframe.to_excel(daily_201810_excel_writer,'16_2',index=False)
daily_201810_excel_writer.save()
daily_20181017 = pro.daily(start_date='',end_date='',trade_date='20181017', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20181017_tscode_list = list() 
for ts_code_sh in daily_20181017['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20181017_tscode_list.append(stock_name)
daily_20181017_addname_dataframe=pd.DataFrame()
daily_20181017_addname_dataframe['cname'] = daily_20181017_tscode_list
for table_name in daily_20181017.columns.values.tolist():
    daily_20181017_addname_dataframe[table_name] = daily_20181017[table_name]
print("日线行情-时间为序  daily_20181017 返回数据 row 行数 = "+str(daily_20181017.shape[0]))
daily_20181017_addname_dataframe.to_excel(daily_201810_excel_writer,'17_3',index=False)
daily_201810_excel_writer.save()
daily_20181018 = pro.daily(start_date='',end_date='',trade_date='20181018', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20181018_tscode_list = list() 
for ts_code_sh in daily_20181018['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20181018_tscode_list.append(stock_name)
daily_20181018_addname_dataframe=pd.DataFrame()
daily_20181018_addname_dataframe['cname'] = daily_20181018_tscode_list
for table_name in daily_20181018.columns.values.tolist():
    daily_20181018_addname_dataframe[table_name] = daily_20181018[table_name]
print("日线行情-时间为序  daily_20181018 返回数据 row 行数 = "+str(daily_20181018.shape[0]))
daily_20181018_addname_dataframe.to_excel(daily_201810_excel_writer,'18_4',index=False)
daily_201810_excel_writer.save()
daily_20181019 = pro.daily(start_date='',end_date='',trade_date='20181019', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20181019_tscode_list = list() 
for ts_code_sh in daily_20181019['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20181019_tscode_list.append(stock_name)
daily_20181019_addname_dataframe=pd.DataFrame()
daily_20181019_addname_dataframe['cname'] = daily_20181019_tscode_list
for table_name in daily_20181019.columns.values.tolist():
    daily_20181019_addname_dataframe[table_name] = daily_20181019[table_name]
print("日线行情-时间为序  daily_20181019 返回数据 row 行数 = "+str(daily_20181019.shape[0]))
daily_20181019_addname_dataframe.to_excel(daily_201810_excel_writer,'19_5',index=False)
daily_201810_excel_writer.save()
daily_20181022 = pro.daily(start_date='',end_date='',trade_date='20181022', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20181022_tscode_list = list() 
for ts_code_sh in daily_20181022['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20181022_tscode_list.append(stock_name)
daily_20181022_addname_dataframe=pd.DataFrame()
daily_20181022_addname_dataframe['cname'] = daily_20181022_tscode_list
for table_name in daily_20181022.columns.values.tolist():
    daily_20181022_addname_dataframe[table_name] = daily_20181022[table_name]
print("日线行情-时间为序  daily_20181022 返回数据 row 行数 = "+str(daily_20181022.shape[0]))
daily_20181022_addname_dataframe.to_excel(daily_201810_excel_writer,'22_1',index=False)
daily_201810_excel_writer.save()
daily_20181023 = pro.daily(start_date='',end_date='',trade_date='20181023', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20181023_tscode_list = list() 
for ts_code_sh in daily_20181023['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20181023_tscode_list.append(stock_name)
daily_20181023_addname_dataframe=pd.DataFrame()
daily_20181023_addname_dataframe['cname'] = daily_20181023_tscode_list
for table_name in daily_20181023.columns.values.tolist():
    daily_20181023_addname_dataframe[table_name] = daily_20181023[table_name]
print("日线行情-时间为序  daily_20181023 返回数据 row 行数 = "+str(daily_20181023.shape[0]))
daily_20181023_addname_dataframe.to_excel(daily_201810_excel_writer,'23_2',index=False)
daily_201810_excel_writer.save()
daily_20181024 = pro.daily(start_date='',end_date='',trade_date='20181024', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20181024_tscode_list = list() 
for ts_code_sh in daily_20181024['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20181024_tscode_list.append(stock_name)
daily_20181024_addname_dataframe=pd.DataFrame()
daily_20181024_addname_dataframe['cname'] = daily_20181024_tscode_list
for table_name in daily_20181024.columns.values.tolist():
    daily_20181024_addname_dataframe[table_name] = daily_20181024[table_name]
print("日线行情-时间为序  daily_20181024 返回数据 row 行数 = "+str(daily_20181024.shape[0]))
daily_20181024_addname_dataframe.to_excel(daily_201810_excel_writer,'24_3',index=False)
daily_201810_excel_writer.save()
daily_20181025 = pro.daily(start_date='',end_date='',trade_date='20181025', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20181025_tscode_list = list() 
for ts_code_sh in daily_20181025['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20181025_tscode_list.append(stock_name)
daily_20181025_addname_dataframe=pd.DataFrame()
daily_20181025_addname_dataframe['cname'] = daily_20181025_tscode_list
for table_name in daily_20181025.columns.values.tolist():
    daily_20181025_addname_dataframe[table_name] = daily_20181025[table_name]
print("日线行情-时间为序  daily_20181025 返回数据 row 行数 = "+str(daily_20181025.shape[0]))
daily_20181025_addname_dataframe.to_excel(daily_201810_excel_writer,'25_4',index=False)
daily_201810_excel_writer.save()
daily_20181026 = pro.daily(start_date='',end_date='',trade_date='20181026', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20181026_tscode_list = list() 
for ts_code_sh in daily_20181026['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20181026_tscode_list.append(stock_name)
daily_20181026_addname_dataframe=pd.DataFrame()
daily_20181026_addname_dataframe['cname'] = daily_20181026_tscode_list
for table_name in daily_20181026.columns.values.tolist():
    daily_20181026_addname_dataframe[table_name] = daily_20181026[table_name]
print("日线行情-时间为序  daily_20181026 返回数据 row 行数 = "+str(daily_20181026.shape[0]))
daily_20181026_addname_dataframe.to_excel(daily_201810_excel_writer,'26_5',index=False)
daily_201810_excel_writer.save()
daily_20181029 = pro.daily(start_date='',end_date='',trade_date='20181029', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20181029_tscode_list = list() 
for ts_code_sh in daily_20181029['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20181029_tscode_list.append(stock_name)
daily_20181029_addname_dataframe=pd.DataFrame()
daily_20181029_addname_dataframe['cname'] = daily_20181029_tscode_list
for table_name in daily_20181029.columns.values.tolist():
    daily_20181029_addname_dataframe[table_name] = daily_20181029[table_name]
print("日线行情-时间为序  daily_20181029 返回数据 row 行数 = "+str(daily_20181029.shape[0]))
daily_20181029_addname_dataframe.to_excel(daily_201810_excel_writer,'29_1',index=False)
daily_201810_excel_writer.save()
daily_20181030 = pro.daily(start_date='',end_date='',trade_date='20181030', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20181030_tscode_list = list() 
for ts_code_sh in daily_20181030['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20181030_tscode_list.append(stock_name)
daily_20181030_addname_dataframe=pd.DataFrame()
daily_20181030_addname_dataframe['cname'] = daily_20181030_tscode_list
for table_name in daily_20181030.columns.values.tolist():
    daily_20181030_addname_dataframe[table_name] = daily_20181030[table_name]
print("日线行情-时间为序  daily_20181030 返回数据 row 行数 = "+str(daily_20181030.shape[0]))
daily_20181030_addname_dataframe.to_excel(daily_201810_excel_writer,'30_2',index=False)
daily_201810_excel_writer.save()
daily_20181031 = pro.daily(start_date='',end_date='',trade_date='20181031', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20181031_tscode_list = list() 
for ts_code_sh in daily_20181031['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20181031_tscode_list.append(stock_name)
daily_20181031_addname_dataframe=pd.DataFrame()
daily_20181031_addname_dataframe['cname'] = daily_20181031_tscode_list
for table_name in daily_20181031.columns.values.tolist():
    daily_20181031_addname_dataframe[table_name] = daily_20181031[table_name]
print("日线行情-时间为序  daily_20181031 返回数据 row 行数 = "+str(daily_20181031.shape[0]))
daily_20181031_addname_dataframe.to_excel(daily_201810_excel_writer,'31_3',index=False)
daily_201810_excel_writer.save()




createexcel('daily_201811.xlsx')
daily_201811_book = load_workbook('C:\\Users\\zhuzj5\\Desktop\\zbin\\J0_Data\\daily_201811.xlsx')
daily_201811_excel_writer = pd.ExcelWriter('C:\\Users\\zhuzj5\\Desktop\\zbin\\J0_Data\\daily_201811.xlsx', engine='openpyxl')
daily_201811_excel_writer.book = daily_201811_book
daily_201811_excel_writer.sheets = dict((ws.title, ws) for ws in daily_201811_book.worksheets)
J0_PROPS.put(tree_node_name+"record_date", "20181101")       ###  更新 记录日期
daily_20181101 = pro.daily(start_date='',end_date='',trade_date='20181101', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20181101_tscode_list = list() 
for ts_code_sh in daily_20181101['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20181101_tscode_list.append(stock_name)
daily_20181101_addname_dataframe=pd.DataFrame()
daily_20181101_addname_dataframe['cname'] = daily_20181101_tscode_list
for table_name in daily_20181101.columns.values.tolist():
    daily_20181101_addname_dataframe[table_name] = daily_20181101[table_name]
print("日线行情-时间为序  daily_20181101 返回数据 row 行数 = "+str(daily_20181101.shape[0]))
daily_20181101_addname_dataframe.to_excel(daily_201811_excel_writer,'1_4',index=False)
daily_201811_excel_writer.save()
daily_20181102 = pro.daily(start_date='',end_date='',trade_date='20181102', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20181102_tscode_list = list() 
for ts_code_sh in daily_20181102['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20181102_tscode_list.append(stock_name)
daily_20181102_addname_dataframe=pd.DataFrame()
daily_20181102_addname_dataframe['cname'] = daily_20181102_tscode_list
for table_name in daily_20181102.columns.values.tolist():
    daily_20181102_addname_dataframe[table_name] = daily_20181102[table_name]
print("日线行情-时间为序  daily_20181102 返回数据 row 行数 = "+str(daily_20181102.shape[0]))
daily_20181102_addname_dataframe.to_excel(daily_201811_excel_writer,'2_5',index=False)
daily_201811_excel_writer.save()
daily_20181105 = pro.daily(start_date='',end_date='',trade_date='20181105', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20181105_tscode_list = list() 
for ts_code_sh in daily_20181105['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20181105_tscode_list.append(stock_name)
daily_20181105_addname_dataframe=pd.DataFrame()
daily_20181105_addname_dataframe['cname'] = daily_20181105_tscode_list
for table_name in daily_20181105.columns.values.tolist():
    daily_20181105_addname_dataframe[table_name] = daily_20181105[table_name]
print("日线行情-时间为序  daily_20181105 返回数据 row 行数 = "+str(daily_20181105.shape[0]))
daily_20181105_addname_dataframe.to_excel(daily_201811_excel_writer,'5_1',index=False)
daily_201811_excel_writer.save()
daily_20181106 = pro.daily(start_date='',end_date='',trade_date='20181106', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20181106_tscode_list = list() 
for ts_code_sh in daily_20181106['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20181106_tscode_list.append(stock_name)
daily_20181106_addname_dataframe=pd.DataFrame()
daily_20181106_addname_dataframe['cname'] = daily_20181106_tscode_list
for table_name in daily_20181106.columns.values.tolist():
    daily_20181106_addname_dataframe[table_name] = daily_20181106[table_name]
print("日线行情-时间为序  daily_20181106 返回数据 row 行数 = "+str(daily_20181106.shape[0]))
daily_20181106_addname_dataframe.to_excel(daily_201811_excel_writer,'6_2',index=False)
daily_201811_excel_writer.save()
daily_20181107 = pro.daily(start_date='',end_date='',trade_date='20181107', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20181107_tscode_list = list() 
for ts_code_sh in daily_20181107['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20181107_tscode_list.append(stock_name)
daily_20181107_addname_dataframe=pd.DataFrame()
daily_20181107_addname_dataframe['cname'] = daily_20181107_tscode_list
for table_name in daily_20181107.columns.values.tolist():
    daily_20181107_addname_dataframe[table_name] = daily_20181107[table_name]
print("日线行情-时间为序  daily_20181107 返回数据 row 行数 = "+str(daily_20181107.shape[0]))
daily_20181107_addname_dataframe.to_excel(daily_201811_excel_writer,'7_3',index=False)
daily_201811_excel_writer.save()
daily_20181108 = pro.daily(start_date='',end_date='',trade_date='20181108', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20181108_tscode_list = list() 
for ts_code_sh in daily_20181108['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20181108_tscode_list.append(stock_name)
daily_20181108_addname_dataframe=pd.DataFrame()
daily_20181108_addname_dataframe['cname'] = daily_20181108_tscode_list
for table_name in daily_20181108.columns.values.tolist():
    daily_20181108_addname_dataframe[table_name] = daily_20181108[table_name]
print("日线行情-时间为序  daily_20181108 返回数据 row 行数 = "+str(daily_20181108.shape[0]))
daily_20181108_addname_dataframe.to_excel(daily_201811_excel_writer,'8_4',index=False)
daily_201811_excel_writer.save()
daily_20181109 = pro.daily(start_date='',end_date='',trade_date='20181109', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20181109_tscode_list = list() 
for ts_code_sh in daily_20181109['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20181109_tscode_list.append(stock_name)
daily_20181109_addname_dataframe=pd.DataFrame()
daily_20181109_addname_dataframe['cname'] = daily_20181109_tscode_list
for table_name in daily_20181109.columns.values.tolist():
    daily_20181109_addname_dataframe[table_name] = daily_20181109[table_name]
print("日线行情-时间为序  daily_20181109 返回数据 row 行数 = "+str(daily_20181109.shape[0]))
daily_20181109_addname_dataframe.to_excel(daily_201811_excel_writer,'9_5',index=False)
daily_201811_excel_writer.save()
daily_20181112 = pro.daily(start_date='',end_date='',trade_date='20181112', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20181112_tscode_list = list() 
for ts_code_sh in daily_20181112['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20181112_tscode_list.append(stock_name)
daily_20181112_addname_dataframe=pd.DataFrame()
daily_20181112_addname_dataframe['cname'] = daily_20181112_tscode_list
for table_name in daily_20181112.columns.values.tolist():
    daily_20181112_addname_dataframe[table_name] = daily_20181112[table_name]
print("日线行情-时间为序  daily_20181112 返回数据 row 行数 = "+str(daily_20181112.shape[0]))
daily_20181112_addname_dataframe.to_excel(daily_201811_excel_writer,'12_1',index=False)
daily_201811_excel_writer.save()
daily_20181113 = pro.daily(start_date='',end_date='',trade_date='20181113', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20181113_tscode_list = list() 
for ts_code_sh in daily_20181113['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20181113_tscode_list.append(stock_name)
daily_20181113_addname_dataframe=pd.DataFrame()
daily_20181113_addname_dataframe['cname'] = daily_20181113_tscode_list
for table_name in daily_20181113.columns.values.tolist():
    daily_20181113_addname_dataframe[table_name] = daily_20181113[table_name]
print("日线行情-时间为序  daily_20181113 返回数据 row 行数 = "+str(daily_20181113.shape[0]))
daily_20181113_addname_dataframe.to_excel(daily_201811_excel_writer,'13_2',index=False)
daily_201811_excel_writer.save()
daily_20181114 = pro.daily(start_date='',end_date='',trade_date='20181114', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20181114_tscode_list = list() 
for ts_code_sh in daily_20181114['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20181114_tscode_list.append(stock_name)
daily_20181114_addname_dataframe=pd.DataFrame()
daily_20181114_addname_dataframe['cname'] = daily_20181114_tscode_list
for table_name in daily_20181114.columns.values.tolist():
    daily_20181114_addname_dataframe[table_name] = daily_20181114[table_name]
print("日线行情-时间为序  daily_20181114 返回数据 row 行数 = "+str(daily_20181114.shape[0]))
daily_20181114_addname_dataframe.to_excel(daily_201811_excel_writer,'14_3',index=False)
daily_201811_excel_writer.save()
daily_20181115 = pro.daily(start_date='',end_date='',trade_date='20181115', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20181115_tscode_list = list() 
for ts_code_sh in daily_20181115['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20181115_tscode_list.append(stock_name)
daily_20181115_addname_dataframe=pd.DataFrame()
daily_20181115_addname_dataframe['cname'] = daily_20181115_tscode_list
for table_name in daily_20181115.columns.values.tolist():
    daily_20181115_addname_dataframe[table_name] = daily_20181115[table_name]
print("日线行情-时间为序  daily_20181115 返回数据 row 行数 = "+str(daily_20181115.shape[0]))
daily_20181115_addname_dataframe.to_excel(daily_201811_excel_writer,'15_4',index=False)
daily_201811_excel_writer.save()
daily_20181116 = pro.daily(start_date='',end_date='',trade_date='20181116', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20181116_tscode_list = list() 
for ts_code_sh in daily_20181116['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20181116_tscode_list.append(stock_name)
daily_20181116_addname_dataframe=pd.DataFrame()
daily_20181116_addname_dataframe['cname'] = daily_20181116_tscode_list
for table_name in daily_20181116.columns.values.tolist():
    daily_20181116_addname_dataframe[table_name] = daily_20181116[table_name]
print("日线行情-时间为序  daily_20181116 返回数据 row 行数 = "+str(daily_20181116.shape[0]))
daily_20181116_addname_dataframe.to_excel(daily_201811_excel_writer,'16_5',index=False)
daily_201811_excel_writer.save()
daily_20181119 = pro.daily(start_date='',end_date='',trade_date='20181119', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20181119_tscode_list = list() 
for ts_code_sh in daily_20181119['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20181119_tscode_list.append(stock_name)
daily_20181119_addname_dataframe=pd.DataFrame()
daily_20181119_addname_dataframe['cname'] = daily_20181119_tscode_list
for table_name in daily_20181119.columns.values.tolist():
    daily_20181119_addname_dataframe[table_name] = daily_20181119[table_name]
print("日线行情-时间为序  daily_20181119 返回数据 row 行数 = "+str(daily_20181119.shape[0]))
daily_20181119_addname_dataframe.to_excel(daily_201811_excel_writer,'19_1',index=False)
daily_201811_excel_writer.save()
daily_20181120 = pro.daily(start_date='',end_date='',trade_date='20181120', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20181120_tscode_list = list() 
for ts_code_sh in daily_20181120['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20181120_tscode_list.append(stock_name)
daily_20181120_addname_dataframe=pd.DataFrame()
daily_20181120_addname_dataframe['cname'] = daily_20181120_tscode_list
for table_name in daily_20181120.columns.values.tolist():
    daily_20181120_addname_dataframe[table_name] = daily_20181120[table_name]
print("日线行情-时间为序  daily_20181120 返回数据 row 行数 = "+str(daily_20181120.shape[0]))
daily_20181120_addname_dataframe.to_excel(daily_201811_excel_writer,'20_2',index=False)
daily_201811_excel_writer.save()
daily_20181121 = pro.daily(start_date='',end_date='',trade_date='20181121', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20181121_tscode_list = list() 
for ts_code_sh in daily_20181121['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20181121_tscode_list.append(stock_name)
daily_20181121_addname_dataframe=pd.DataFrame()
daily_20181121_addname_dataframe['cname'] = daily_20181121_tscode_list
for table_name in daily_20181121.columns.values.tolist():
    daily_20181121_addname_dataframe[table_name] = daily_20181121[table_name]
print("日线行情-时间为序  daily_20181121 返回数据 row 行数 = "+str(daily_20181121.shape[0]))
daily_20181121_addname_dataframe.to_excel(daily_201811_excel_writer,'21_3',index=False)
daily_201811_excel_writer.save()
daily_20181122 = pro.daily(start_date='',end_date='',trade_date='20181122', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20181122_tscode_list = list() 
for ts_code_sh in daily_20181122['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20181122_tscode_list.append(stock_name)
daily_20181122_addname_dataframe=pd.DataFrame()
daily_20181122_addname_dataframe['cname'] = daily_20181122_tscode_list
for table_name in daily_20181122.columns.values.tolist():
    daily_20181122_addname_dataframe[table_name] = daily_20181122[table_name]
print("日线行情-时间为序  daily_20181122 返回数据 row 行数 = "+str(daily_20181122.shape[0]))
daily_20181122_addname_dataframe.to_excel(daily_201811_excel_writer,'22_4',index=False)
daily_201811_excel_writer.save()
daily_20181123 = pro.daily(start_date='',end_date='',trade_date='20181123', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20181123_tscode_list = list() 
for ts_code_sh in daily_20181123['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20181123_tscode_list.append(stock_name)
daily_20181123_addname_dataframe=pd.DataFrame()
daily_20181123_addname_dataframe['cname'] = daily_20181123_tscode_list
for table_name in daily_20181123.columns.values.tolist():
    daily_20181123_addname_dataframe[table_name] = daily_20181123[table_name]
print("日线行情-时间为序  daily_20181123 返回数据 row 行数 = "+str(daily_20181123.shape[0]))
daily_20181123_addname_dataframe.to_excel(daily_201811_excel_writer,'23_5',index=False)
daily_201811_excel_writer.save()
daily_20181126 = pro.daily(start_date='',end_date='',trade_date='20181126', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20181126_tscode_list = list() 
for ts_code_sh in daily_20181126['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20181126_tscode_list.append(stock_name)
daily_20181126_addname_dataframe=pd.DataFrame()
daily_20181126_addname_dataframe['cname'] = daily_20181126_tscode_list
for table_name in daily_20181126.columns.values.tolist():
    daily_20181126_addname_dataframe[table_name] = daily_20181126[table_name]
print("日线行情-时间为序  daily_20181126 返回数据 row 行数 = "+str(daily_20181126.shape[0]))
daily_20181126_addname_dataframe.to_excel(daily_201811_excel_writer,'26_1',index=False)
daily_201811_excel_writer.save()
daily_20181127 = pro.daily(start_date='',end_date='',trade_date='20181127', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20181127_tscode_list = list() 
for ts_code_sh in daily_20181127['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20181127_tscode_list.append(stock_name)
daily_20181127_addname_dataframe=pd.DataFrame()
daily_20181127_addname_dataframe['cname'] = daily_20181127_tscode_list
for table_name in daily_20181127.columns.values.tolist():
    daily_20181127_addname_dataframe[table_name] = daily_20181127[table_name]
print("日线行情-时间为序  daily_20181127 返回数据 row 行数 = "+str(daily_20181127.shape[0]))
daily_20181127_addname_dataframe.to_excel(daily_201811_excel_writer,'27_2',index=False)
daily_201811_excel_writer.save()
daily_20181128 = pro.daily(start_date='',end_date='',trade_date='20181128', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20181128_tscode_list = list() 
for ts_code_sh in daily_20181128['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20181128_tscode_list.append(stock_name)
daily_20181128_addname_dataframe=pd.DataFrame()
daily_20181128_addname_dataframe['cname'] = daily_20181128_tscode_list
for table_name in daily_20181128.columns.values.tolist():
    daily_20181128_addname_dataframe[table_name] = daily_20181128[table_name]
print("日线行情-时间为序  daily_20181128 返回数据 row 行数 = "+str(daily_20181128.shape[0]))
daily_20181128_addname_dataframe.to_excel(daily_201811_excel_writer,'28_3',index=False)
daily_201811_excel_writer.save()
daily_20181129 = pro.daily(start_date='',end_date='',trade_date='20181129', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20181129_tscode_list = list() 
for ts_code_sh in daily_20181129['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20181129_tscode_list.append(stock_name)
daily_20181129_addname_dataframe=pd.DataFrame()
daily_20181129_addname_dataframe['cname'] = daily_20181129_tscode_list
for table_name in daily_20181129.columns.values.tolist():
    daily_20181129_addname_dataframe[table_name] = daily_20181129[table_name]
print("日线行情-时间为序  daily_20181129 返回数据 row 行数 = "+str(daily_20181129.shape[0]))
daily_20181129_addname_dataframe.to_excel(daily_201811_excel_writer,'29_4',index=False)
daily_201811_excel_writer.save()
daily_20181130 = pro.daily(start_date='',end_date='',trade_date='20181130', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20181130_tscode_list = list() 
for ts_code_sh in daily_20181130['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20181130_tscode_list.append(stock_name)
daily_20181130_addname_dataframe=pd.DataFrame()
daily_20181130_addname_dataframe['cname'] = daily_20181130_tscode_list
for table_name in daily_20181130.columns.values.tolist():
    daily_20181130_addname_dataframe[table_name] = daily_20181130[table_name]
print("日线行情-时间为序  daily_20181130 返回数据 row 行数 = "+str(daily_20181130.shape[0]))
daily_20181130_addname_dataframe.to_excel(daily_201811_excel_writer,'30_5',index=False)
daily_201811_excel_writer.save()




createexcel('daily_201812.xlsx')
daily_201812_book = load_workbook('C:\\Users\\zhuzj5\\Desktop\\zbin\\J0_Data\\daily_201812.xlsx')
daily_201812_excel_writer = pd.ExcelWriter('C:\\Users\\zhuzj5\\Desktop\\zbin\\J0_Data\\daily_201812.xlsx', engine='openpyxl')
daily_201812_excel_writer.book = daily_201812_book
daily_201812_excel_writer.sheets = dict((ws.title, ws) for ws in daily_201812_book.worksheets)
J0_PROPS.put(tree_node_name+"record_date", "20181201")       ###  更新 记录日期
daily_20181203 = pro.daily(start_date='',end_date='',trade_date='20181203', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20181203_tscode_list = list() 
for ts_code_sh in daily_20181203['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20181203_tscode_list.append(stock_name)
daily_20181203_addname_dataframe=pd.DataFrame()
daily_20181203_addname_dataframe['cname'] = daily_20181203_tscode_list
for table_name in daily_20181203.columns.values.tolist():
    daily_20181203_addname_dataframe[table_name] = daily_20181203[table_name]
print("日线行情-时间为序  daily_20181203 返回数据 row 行数 = "+str(daily_20181203.shape[0]))
daily_20181203_addname_dataframe.to_excel(daily_201812_excel_writer,'3_1',index=False)
daily_201812_excel_writer.save()
daily_20181204 = pro.daily(start_date='',end_date='',trade_date='20181204', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20181204_tscode_list = list() 
for ts_code_sh in daily_20181204['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20181204_tscode_list.append(stock_name)
daily_20181204_addname_dataframe=pd.DataFrame()
daily_20181204_addname_dataframe['cname'] = daily_20181204_tscode_list
for table_name in daily_20181204.columns.values.tolist():
    daily_20181204_addname_dataframe[table_name] = daily_20181204[table_name]
print("日线行情-时间为序  daily_20181204 返回数据 row 行数 = "+str(daily_20181204.shape[0]))
daily_20181204_addname_dataframe.to_excel(daily_201812_excel_writer,'4_2',index=False)
daily_201812_excel_writer.save()
daily_20181205 = pro.daily(start_date='',end_date='',trade_date='20181205', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20181205_tscode_list = list() 
for ts_code_sh in daily_20181205['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20181205_tscode_list.append(stock_name)
daily_20181205_addname_dataframe=pd.DataFrame()
daily_20181205_addname_dataframe['cname'] = daily_20181205_tscode_list
for table_name in daily_20181205.columns.values.tolist():
    daily_20181205_addname_dataframe[table_name] = daily_20181205[table_name]
print("日线行情-时间为序  daily_20181205 返回数据 row 行数 = "+str(daily_20181205.shape[0]))
daily_20181205_addname_dataframe.to_excel(daily_201812_excel_writer,'5_3',index=False)
daily_201812_excel_writer.save()
daily_20181206 = pro.daily(start_date='',end_date='',trade_date='20181206', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20181206_tscode_list = list() 
for ts_code_sh in daily_20181206['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20181206_tscode_list.append(stock_name)
daily_20181206_addname_dataframe=pd.DataFrame()
daily_20181206_addname_dataframe['cname'] = daily_20181206_tscode_list
for table_name in daily_20181206.columns.values.tolist():
    daily_20181206_addname_dataframe[table_name] = daily_20181206[table_name]
print("日线行情-时间为序  daily_20181206 返回数据 row 行数 = "+str(daily_20181206.shape[0]))
daily_20181206_addname_dataframe.to_excel(daily_201812_excel_writer,'6_4',index=False)
daily_201812_excel_writer.save()
daily_20181207 = pro.daily(start_date='',end_date='',trade_date='20181207', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20181207_tscode_list = list() 
for ts_code_sh in daily_20181207['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20181207_tscode_list.append(stock_name)
daily_20181207_addname_dataframe=pd.DataFrame()
daily_20181207_addname_dataframe['cname'] = daily_20181207_tscode_list
for table_name in daily_20181207.columns.values.tolist():
    daily_20181207_addname_dataframe[table_name] = daily_20181207[table_name]
print("日线行情-时间为序  daily_20181207 返回数据 row 行数 = "+str(daily_20181207.shape[0]))
daily_20181207_addname_dataframe.to_excel(daily_201812_excel_writer,'7_5',index=False)
daily_201812_excel_writer.save()
daily_20181210 = pro.daily(start_date='',end_date='',trade_date='20181210', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20181210_tscode_list = list() 
for ts_code_sh in daily_20181210['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20181210_tscode_list.append(stock_name)
daily_20181210_addname_dataframe=pd.DataFrame()
daily_20181210_addname_dataframe['cname'] = daily_20181210_tscode_list
for table_name in daily_20181210.columns.values.tolist():
    daily_20181210_addname_dataframe[table_name] = daily_20181210[table_name]
print("日线行情-时间为序  daily_20181210 返回数据 row 行数 = "+str(daily_20181210.shape[0]))
daily_20181210_addname_dataframe.to_excel(daily_201812_excel_writer,'10_1',index=False)
daily_201812_excel_writer.save()
daily_20181211 = pro.daily(start_date='',end_date='',trade_date='20181211', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20181211_tscode_list = list() 
for ts_code_sh in daily_20181211['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20181211_tscode_list.append(stock_name)
daily_20181211_addname_dataframe=pd.DataFrame()
daily_20181211_addname_dataframe['cname'] = daily_20181211_tscode_list
for table_name in daily_20181211.columns.values.tolist():
    daily_20181211_addname_dataframe[table_name] = daily_20181211[table_name]
print("日线行情-时间为序  daily_20181211 返回数据 row 行数 = "+str(daily_20181211.shape[0]))
daily_20181211_addname_dataframe.to_excel(daily_201812_excel_writer,'11_2',index=False)
daily_201812_excel_writer.save()
daily_20181212 = pro.daily(start_date='',end_date='',trade_date='20181212', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20181212_tscode_list = list() 
for ts_code_sh in daily_20181212['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20181212_tscode_list.append(stock_name)
daily_20181212_addname_dataframe=pd.DataFrame()
daily_20181212_addname_dataframe['cname'] = daily_20181212_tscode_list
for table_name in daily_20181212.columns.values.tolist():
    daily_20181212_addname_dataframe[table_name] = daily_20181212[table_name]
print("日线行情-时间为序  daily_20181212 返回数据 row 行数 = "+str(daily_20181212.shape[0]))
daily_20181212_addname_dataframe.to_excel(daily_201812_excel_writer,'12_3',index=False)
daily_201812_excel_writer.save()
daily_20181213 = pro.daily(start_date='',end_date='',trade_date='20181213', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20181213_tscode_list = list() 
for ts_code_sh in daily_20181213['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20181213_tscode_list.append(stock_name)
daily_20181213_addname_dataframe=pd.DataFrame()
daily_20181213_addname_dataframe['cname'] = daily_20181213_tscode_list
for table_name in daily_20181213.columns.values.tolist():
    daily_20181213_addname_dataframe[table_name] = daily_20181213[table_name]
print("日线行情-时间为序  daily_20181213 返回数据 row 行数 = "+str(daily_20181213.shape[0]))
daily_20181213_addname_dataframe.to_excel(daily_201812_excel_writer,'13_4',index=False)
daily_201812_excel_writer.save()
daily_20181214 = pro.daily(start_date='',end_date='',trade_date='20181214', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20181214_tscode_list = list() 
for ts_code_sh in daily_20181214['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20181214_tscode_list.append(stock_name)
daily_20181214_addname_dataframe=pd.DataFrame()
daily_20181214_addname_dataframe['cname'] = daily_20181214_tscode_list
for table_name in daily_20181214.columns.values.tolist():
    daily_20181214_addname_dataframe[table_name] = daily_20181214[table_name]
print("日线行情-时间为序  daily_20181214 返回数据 row 行数 = "+str(daily_20181214.shape[0]))
daily_20181214_addname_dataframe.to_excel(daily_201812_excel_writer,'14_5',index=False)
daily_201812_excel_writer.save()
daily_20181217 = pro.daily(start_date='',end_date='',trade_date='20181217', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20181217_tscode_list = list() 
for ts_code_sh in daily_20181217['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20181217_tscode_list.append(stock_name)
daily_20181217_addname_dataframe=pd.DataFrame()
daily_20181217_addname_dataframe['cname'] = daily_20181217_tscode_list
for table_name in daily_20181217.columns.values.tolist():
    daily_20181217_addname_dataframe[table_name] = daily_20181217[table_name]
print("日线行情-时间为序  daily_20181217 返回数据 row 行数 = "+str(daily_20181217.shape[0]))
daily_20181217_addname_dataframe.to_excel(daily_201812_excel_writer,'17_1',index=False)
daily_201812_excel_writer.save()
daily_20181218 = pro.daily(start_date='',end_date='',trade_date='20181218', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20181218_tscode_list = list() 
for ts_code_sh in daily_20181218['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20181218_tscode_list.append(stock_name)
daily_20181218_addname_dataframe=pd.DataFrame()
daily_20181218_addname_dataframe['cname'] = daily_20181218_tscode_list
for table_name in daily_20181218.columns.values.tolist():
    daily_20181218_addname_dataframe[table_name] = daily_20181218[table_name]
print("日线行情-时间为序  daily_20181218 返回数据 row 行数 = "+str(daily_20181218.shape[0]))
daily_20181218_addname_dataframe.to_excel(daily_201812_excel_writer,'18_2',index=False)
daily_201812_excel_writer.save()
daily_20181219 = pro.daily(start_date='',end_date='',trade_date='20181219', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20181219_tscode_list = list() 
for ts_code_sh in daily_20181219['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20181219_tscode_list.append(stock_name)
daily_20181219_addname_dataframe=pd.DataFrame()
daily_20181219_addname_dataframe['cname'] = daily_20181219_tscode_list
for table_name in daily_20181219.columns.values.tolist():
    daily_20181219_addname_dataframe[table_name] = daily_20181219[table_name]
print("日线行情-时间为序  daily_20181219 返回数据 row 行数 = "+str(daily_20181219.shape[0]))
daily_20181219_addname_dataframe.to_excel(daily_201812_excel_writer,'19_3',index=False)
daily_201812_excel_writer.save()
daily_20181220 = pro.daily(start_date='',end_date='',trade_date='20181220', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20181220_tscode_list = list() 
for ts_code_sh in daily_20181220['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20181220_tscode_list.append(stock_name)
daily_20181220_addname_dataframe=pd.DataFrame()
daily_20181220_addname_dataframe['cname'] = daily_20181220_tscode_list
for table_name in daily_20181220.columns.values.tolist():
    daily_20181220_addname_dataframe[table_name] = daily_20181220[table_name]
print("日线行情-时间为序  daily_20181220 返回数据 row 行数 = "+str(daily_20181220.shape[0]))
daily_20181220_addname_dataframe.to_excel(daily_201812_excel_writer,'20_4',index=False)
daily_201812_excel_writer.save()
daily_20181221 = pro.daily(start_date='',end_date='',trade_date='20181221', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20181221_tscode_list = list() 
for ts_code_sh in daily_20181221['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20181221_tscode_list.append(stock_name)
daily_20181221_addname_dataframe=pd.DataFrame()
daily_20181221_addname_dataframe['cname'] = daily_20181221_tscode_list
for table_name in daily_20181221.columns.values.tolist():
    daily_20181221_addname_dataframe[table_name] = daily_20181221[table_name]
print("日线行情-时间为序  daily_20181221 返回数据 row 行数 = "+str(daily_20181221.shape[0]))
daily_20181221_addname_dataframe.to_excel(daily_201812_excel_writer,'21_5',index=False)
daily_201812_excel_writer.save()
daily_20181224 = pro.daily(start_date='',end_date='',trade_date='20181224', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20181224_tscode_list = list() 
for ts_code_sh in daily_20181224['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20181224_tscode_list.append(stock_name)
daily_20181224_addname_dataframe=pd.DataFrame()
daily_20181224_addname_dataframe['cname'] = daily_20181224_tscode_list
for table_name in daily_20181224.columns.values.tolist():
    daily_20181224_addname_dataframe[table_name] = daily_20181224[table_name]
print("日线行情-时间为序  daily_20181224 返回数据 row 行数 = "+str(daily_20181224.shape[0]))
daily_20181224_addname_dataframe.to_excel(daily_201812_excel_writer,'24_1',index=False)
daily_201812_excel_writer.save()
daily_20181225 = pro.daily(start_date='',end_date='',trade_date='20181225', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20181225_tscode_list = list() 
for ts_code_sh in daily_20181225['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20181225_tscode_list.append(stock_name)
daily_20181225_addname_dataframe=pd.DataFrame()
daily_20181225_addname_dataframe['cname'] = daily_20181225_tscode_list
for table_name in daily_20181225.columns.values.tolist():
    daily_20181225_addname_dataframe[table_name] = daily_20181225[table_name]
print("日线行情-时间为序  daily_20181225 返回数据 row 行数 = "+str(daily_20181225.shape[0]))
daily_20181225_addname_dataframe.to_excel(daily_201812_excel_writer,'25_2',index=False)
daily_201812_excel_writer.save()
daily_20181226 = pro.daily(start_date='',end_date='',trade_date='20181226', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20181226_tscode_list = list() 
for ts_code_sh in daily_20181226['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20181226_tscode_list.append(stock_name)
daily_20181226_addname_dataframe=pd.DataFrame()
daily_20181226_addname_dataframe['cname'] = daily_20181226_tscode_list
for table_name in daily_20181226.columns.values.tolist():
    daily_20181226_addname_dataframe[table_name] = daily_20181226[table_name]
print("日线行情-时间为序  daily_20181226 返回数据 row 行数 = "+str(daily_20181226.shape[0]))
daily_20181226_addname_dataframe.to_excel(daily_201812_excel_writer,'26_3',index=False)
daily_201812_excel_writer.save()
daily_20181227 = pro.daily(start_date='',end_date='',trade_date='20181227', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20181227_tscode_list = list() 
for ts_code_sh in daily_20181227['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20181227_tscode_list.append(stock_name)
daily_20181227_addname_dataframe=pd.DataFrame()
daily_20181227_addname_dataframe['cname'] = daily_20181227_tscode_list
for table_name in daily_20181227.columns.values.tolist():
    daily_20181227_addname_dataframe[table_name] = daily_20181227[table_name]
print("日线行情-时间为序  daily_20181227 返回数据 row 行数 = "+str(daily_20181227.shape[0]))
daily_20181227_addname_dataframe.to_excel(daily_201812_excel_writer,'27_4',index=False)
daily_201812_excel_writer.save()
daily_20181228 = pro.daily(start_date='',end_date='',trade_date='20181228', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20181228_tscode_list = list() 
for ts_code_sh in daily_20181228['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20181228_tscode_list.append(stock_name)
daily_20181228_addname_dataframe=pd.DataFrame()
daily_20181228_addname_dataframe['cname'] = daily_20181228_tscode_list
for table_name in daily_20181228.columns.values.tolist():
    daily_20181228_addname_dataframe[table_name] = daily_20181228[table_name]
print("日线行情-时间为序  daily_20181228 返回数据 row 行数 = "+str(daily_20181228.shape[0]))
daily_20181228_addname_dataframe.to_excel(daily_201812_excel_writer,'28_5',index=False)
daily_201812_excel_writer.save()




createexcel('daily_201901.xlsx')
daily_201901_book = load_workbook('C:\\Users\\zhuzj5\\Desktop\\zbin\\J0_Data\\daily_201901.xlsx')
daily_201901_excel_writer = pd.ExcelWriter('C:\\Users\\zhuzj5\\Desktop\\zbin\\J0_Data\\daily_201901.xlsx', engine='openpyxl')
daily_201901_excel_writer.book = daily_201901_book
daily_201901_excel_writer.sheets = dict((ws.title, ws) for ws in daily_201901_book.worksheets)
J0_PROPS.put(tree_node_name+"record_date", "20190101")       ###  更新 记录日期
daily_20190102 = pro.daily(start_date='',end_date='',trade_date='20190102', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20190102_tscode_list = list() 
for ts_code_sh in daily_20190102['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20190102_tscode_list.append(stock_name)
daily_20190102_addname_dataframe=pd.DataFrame()
daily_20190102_addname_dataframe['cname'] = daily_20190102_tscode_list
for table_name in daily_20190102.columns.values.tolist():
    daily_20190102_addname_dataframe[table_name] = daily_20190102[table_name]
print("日线行情-时间为序  daily_20190102 返回数据 row 行数 = "+str(daily_20190102.shape[0]))
daily_20190102_addname_dataframe.to_excel(daily_201901_excel_writer,'2_3',index=False)
daily_201901_excel_writer.save()
daily_20190103 = pro.daily(start_date='',end_date='',trade_date='20190103', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20190103_tscode_list = list() 
for ts_code_sh in daily_20190103['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20190103_tscode_list.append(stock_name)
daily_20190103_addname_dataframe=pd.DataFrame()
daily_20190103_addname_dataframe['cname'] = daily_20190103_tscode_list
for table_name in daily_20190103.columns.values.tolist():
    daily_20190103_addname_dataframe[table_name] = daily_20190103[table_name]
print("日线行情-时间为序  daily_20190103 返回数据 row 行数 = "+str(daily_20190103.shape[0]))
daily_20190103_addname_dataframe.to_excel(daily_201901_excel_writer,'3_4',index=False)
daily_201901_excel_writer.save()
daily_20190104 = pro.daily(start_date='',end_date='',trade_date='20190104', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20190104_tscode_list = list() 
for ts_code_sh in daily_20190104['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20190104_tscode_list.append(stock_name)
daily_20190104_addname_dataframe=pd.DataFrame()
daily_20190104_addname_dataframe['cname'] = daily_20190104_tscode_list
for table_name in daily_20190104.columns.values.tolist():
    daily_20190104_addname_dataframe[table_name] = daily_20190104[table_name]
print("日线行情-时间为序  daily_20190104 返回数据 row 行数 = "+str(daily_20190104.shape[0]))
daily_20190104_addname_dataframe.to_excel(daily_201901_excel_writer,'4_5',index=False)
daily_201901_excel_writer.save()
daily_20190107 = pro.daily(start_date='',end_date='',trade_date='20190107', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20190107_tscode_list = list() 
for ts_code_sh in daily_20190107['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20190107_tscode_list.append(stock_name)
daily_20190107_addname_dataframe=pd.DataFrame()
daily_20190107_addname_dataframe['cname'] = daily_20190107_tscode_list
for table_name in daily_20190107.columns.values.tolist():
    daily_20190107_addname_dataframe[table_name] = daily_20190107[table_name]
print("日线行情-时间为序  daily_20190107 返回数据 row 行数 = "+str(daily_20190107.shape[0]))
daily_20190107_addname_dataframe.to_excel(daily_201901_excel_writer,'7_1',index=False)
daily_201901_excel_writer.save()
daily_20190108 = pro.daily(start_date='',end_date='',trade_date='20190108', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20190108_tscode_list = list() 
for ts_code_sh in daily_20190108['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20190108_tscode_list.append(stock_name)
daily_20190108_addname_dataframe=pd.DataFrame()
daily_20190108_addname_dataframe['cname'] = daily_20190108_tscode_list
for table_name in daily_20190108.columns.values.tolist():
    daily_20190108_addname_dataframe[table_name] = daily_20190108[table_name]
print("日线行情-时间为序  daily_20190108 返回数据 row 行数 = "+str(daily_20190108.shape[0]))
daily_20190108_addname_dataframe.to_excel(daily_201901_excel_writer,'8_2',index=False)
daily_201901_excel_writer.save()
daily_20190109 = pro.daily(start_date='',end_date='',trade_date='20190109', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20190109_tscode_list = list() 
for ts_code_sh in daily_20190109['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20190109_tscode_list.append(stock_name)
daily_20190109_addname_dataframe=pd.DataFrame()
daily_20190109_addname_dataframe['cname'] = daily_20190109_tscode_list
for table_name in daily_20190109.columns.values.tolist():
    daily_20190109_addname_dataframe[table_name] = daily_20190109[table_name]
print("日线行情-时间为序  daily_20190109 返回数据 row 行数 = "+str(daily_20190109.shape[0]))
daily_20190109_addname_dataframe.to_excel(daily_201901_excel_writer,'9_3',index=False)
daily_201901_excel_writer.save()
daily_20190110 = pro.daily(start_date='',end_date='',trade_date='20190110', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20190110_tscode_list = list() 
for ts_code_sh in daily_20190110['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20190110_tscode_list.append(stock_name)
daily_20190110_addname_dataframe=pd.DataFrame()
daily_20190110_addname_dataframe['cname'] = daily_20190110_tscode_list
for table_name in daily_20190110.columns.values.tolist():
    daily_20190110_addname_dataframe[table_name] = daily_20190110[table_name]
print("日线行情-时间为序  daily_20190110 返回数据 row 行数 = "+str(daily_20190110.shape[0]))
daily_20190110_addname_dataframe.to_excel(daily_201901_excel_writer,'10_4',index=False)
daily_201901_excel_writer.save()
daily_20190111 = pro.daily(start_date='',end_date='',trade_date='20190111', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20190111_tscode_list = list() 
for ts_code_sh in daily_20190111['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20190111_tscode_list.append(stock_name)
daily_20190111_addname_dataframe=pd.DataFrame()
daily_20190111_addname_dataframe['cname'] = daily_20190111_tscode_list
for table_name in daily_20190111.columns.values.tolist():
    daily_20190111_addname_dataframe[table_name] = daily_20190111[table_name]
print("日线行情-时间为序  daily_20190111 返回数据 row 行数 = "+str(daily_20190111.shape[0]))
daily_20190111_addname_dataframe.to_excel(daily_201901_excel_writer,'11_5',index=False)
daily_201901_excel_writer.save()
daily_20190114 = pro.daily(start_date='',end_date='',trade_date='20190114', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20190114_tscode_list = list() 
for ts_code_sh in daily_20190114['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20190114_tscode_list.append(stock_name)
daily_20190114_addname_dataframe=pd.DataFrame()
daily_20190114_addname_dataframe['cname'] = daily_20190114_tscode_list
for table_name in daily_20190114.columns.values.tolist():
    daily_20190114_addname_dataframe[table_name] = daily_20190114[table_name]
print("日线行情-时间为序  daily_20190114 返回数据 row 行数 = "+str(daily_20190114.shape[0]))
daily_20190114_addname_dataframe.to_excel(daily_201901_excel_writer,'14_1',index=False)
daily_201901_excel_writer.save()
daily_20190115 = pro.daily(start_date='',end_date='',trade_date='20190115', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20190115_tscode_list = list() 
for ts_code_sh in daily_20190115['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20190115_tscode_list.append(stock_name)
daily_20190115_addname_dataframe=pd.DataFrame()
daily_20190115_addname_dataframe['cname'] = daily_20190115_tscode_list
for table_name in daily_20190115.columns.values.tolist():
    daily_20190115_addname_dataframe[table_name] = daily_20190115[table_name]
print("日线行情-时间为序  daily_20190115 返回数据 row 行数 = "+str(daily_20190115.shape[0]))
daily_20190115_addname_dataframe.to_excel(daily_201901_excel_writer,'15_2',index=False)
daily_201901_excel_writer.save()
daily_20190116 = pro.daily(start_date='',end_date='',trade_date='20190116', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20190116_tscode_list = list() 
for ts_code_sh in daily_20190116['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20190116_tscode_list.append(stock_name)
daily_20190116_addname_dataframe=pd.DataFrame()
daily_20190116_addname_dataframe['cname'] = daily_20190116_tscode_list
for table_name in daily_20190116.columns.values.tolist():
    daily_20190116_addname_dataframe[table_name] = daily_20190116[table_name]
print("日线行情-时间为序  daily_20190116 返回数据 row 行数 = "+str(daily_20190116.shape[0]))
daily_20190116_addname_dataframe.to_excel(daily_201901_excel_writer,'16_3',index=False)
daily_201901_excel_writer.save()
daily_20190117 = pro.daily(start_date='',end_date='',trade_date='20190117', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20190117_tscode_list = list() 
for ts_code_sh in daily_20190117['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20190117_tscode_list.append(stock_name)
daily_20190117_addname_dataframe=pd.DataFrame()
daily_20190117_addname_dataframe['cname'] = daily_20190117_tscode_list
for table_name in daily_20190117.columns.values.tolist():
    daily_20190117_addname_dataframe[table_name] = daily_20190117[table_name]
print("日线行情-时间为序  daily_20190117 返回数据 row 行数 = "+str(daily_20190117.shape[0]))
daily_20190117_addname_dataframe.to_excel(daily_201901_excel_writer,'17_4',index=False)
daily_201901_excel_writer.save()
daily_20190118 = pro.daily(start_date='',end_date='',trade_date='20190118', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20190118_tscode_list = list() 
for ts_code_sh in daily_20190118['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20190118_tscode_list.append(stock_name)
daily_20190118_addname_dataframe=pd.DataFrame()
daily_20190118_addname_dataframe['cname'] = daily_20190118_tscode_list
for table_name in daily_20190118.columns.values.tolist():
    daily_20190118_addname_dataframe[table_name] = daily_20190118[table_name]
print("日线行情-时间为序  daily_20190118 返回数据 row 行数 = "+str(daily_20190118.shape[0]))
daily_20190118_addname_dataframe.to_excel(daily_201901_excel_writer,'18_5',index=False)
daily_201901_excel_writer.save()
daily_20190121 = pro.daily(start_date='',end_date='',trade_date='20190121', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20190121_tscode_list = list() 
for ts_code_sh in daily_20190121['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20190121_tscode_list.append(stock_name)
daily_20190121_addname_dataframe=pd.DataFrame()
daily_20190121_addname_dataframe['cname'] = daily_20190121_tscode_list
for table_name in daily_20190121.columns.values.tolist():
    daily_20190121_addname_dataframe[table_name] = daily_20190121[table_name]
print("日线行情-时间为序  daily_20190121 返回数据 row 行数 = "+str(daily_20190121.shape[0]))
daily_20190121_addname_dataframe.to_excel(daily_201901_excel_writer,'21_1',index=False)
daily_201901_excel_writer.save()
daily_20190122 = pro.daily(start_date='',end_date='',trade_date='20190122', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20190122_tscode_list = list() 
for ts_code_sh in daily_20190122['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20190122_tscode_list.append(stock_name)
daily_20190122_addname_dataframe=pd.DataFrame()
daily_20190122_addname_dataframe['cname'] = daily_20190122_tscode_list
for table_name in daily_20190122.columns.values.tolist():
    daily_20190122_addname_dataframe[table_name] = daily_20190122[table_name]
print("日线行情-时间为序  daily_20190122 返回数据 row 行数 = "+str(daily_20190122.shape[0]))
daily_20190122_addname_dataframe.to_excel(daily_201901_excel_writer,'22_2',index=False)
daily_201901_excel_writer.save()
daily_20190123 = pro.daily(start_date='',end_date='',trade_date='20190123', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20190123_tscode_list = list() 
for ts_code_sh in daily_20190123['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20190123_tscode_list.append(stock_name)
daily_20190123_addname_dataframe=pd.DataFrame()
daily_20190123_addname_dataframe['cname'] = daily_20190123_tscode_list
for table_name in daily_20190123.columns.values.tolist():
    daily_20190123_addname_dataframe[table_name] = daily_20190123[table_name]
print("日线行情-时间为序  daily_20190123 返回数据 row 行数 = "+str(daily_20190123.shape[0]))
daily_20190123_addname_dataframe.to_excel(daily_201901_excel_writer,'23_3',index=False)
daily_201901_excel_writer.save()
daily_20190124 = pro.daily(start_date='',end_date='',trade_date='20190124', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20190124_tscode_list = list() 
for ts_code_sh in daily_20190124['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20190124_tscode_list.append(stock_name)
daily_20190124_addname_dataframe=pd.DataFrame()
daily_20190124_addname_dataframe['cname'] = daily_20190124_tscode_list
for table_name in daily_20190124.columns.values.tolist():
    daily_20190124_addname_dataframe[table_name] = daily_20190124[table_name]
print("日线行情-时间为序  daily_20190124 返回数据 row 行数 = "+str(daily_20190124.shape[0]))
daily_20190124_addname_dataframe.to_excel(daily_201901_excel_writer,'24_4',index=False)
daily_201901_excel_writer.save()
daily_20190125 = pro.daily(start_date='',end_date='',trade_date='20190125', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20190125_tscode_list = list() 
for ts_code_sh in daily_20190125['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20190125_tscode_list.append(stock_name)
daily_20190125_addname_dataframe=pd.DataFrame()
daily_20190125_addname_dataframe['cname'] = daily_20190125_tscode_list
for table_name in daily_20190125.columns.values.tolist():
    daily_20190125_addname_dataframe[table_name] = daily_20190125[table_name]
print("日线行情-时间为序  daily_20190125 返回数据 row 行数 = "+str(daily_20190125.shape[0]))
daily_20190125_addname_dataframe.to_excel(daily_201901_excel_writer,'25_5',index=False)
daily_201901_excel_writer.save()
daily_20190128 = pro.daily(start_date='',end_date='',trade_date='20190128', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20190128_tscode_list = list() 
for ts_code_sh in daily_20190128['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20190128_tscode_list.append(stock_name)
daily_20190128_addname_dataframe=pd.DataFrame()
daily_20190128_addname_dataframe['cname'] = daily_20190128_tscode_list
for table_name in daily_20190128.columns.values.tolist():
    daily_20190128_addname_dataframe[table_name] = daily_20190128[table_name]
print("日线行情-时间为序  daily_20190128 返回数据 row 行数 = "+str(daily_20190128.shape[0]))
daily_20190128_addname_dataframe.to_excel(daily_201901_excel_writer,'28_1',index=False)
daily_201901_excel_writer.save()
daily_20190129 = pro.daily(start_date='',end_date='',trade_date='20190129', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20190129_tscode_list = list() 
for ts_code_sh in daily_20190129['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20190129_tscode_list.append(stock_name)
daily_20190129_addname_dataframe=pd.DataFrame()
daily_20190129_addname_dataframe['cname'] = daily_20190129_tscode_list
for table_name in daily_20190129.columns.values.tolist():
    daily_20190129_addname_dataframe[table_name] = daily_20190129[table_name]
print("日线行情-时间为序  daily_20190129 返回数据 row 行数 = "+str(daily_20190129.shape[0]))
daily_20190129_addname_dataframe.to_excel(daily_201901_excel_writer,'29_2',index=False)
daily_201901_excel_writer.save()
daily_20190130 = pro.daily(start_date='',end_date='',trade_date='20190130', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20190130_tscode_list = list() 
for ts_code_sh in daily_20190130['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20190130_tscode_list.append(stock_name)
daily_20190130_addname_dataframe=pd.DataFrame()
daily_20190130_addname_dataframe['cname'] = daily_20190130_tscode_list
for table_name in daily_20190130.columns.values.tolist():
    daily_20190130_addname_dataframe[table_name] = daily_20190130[table_name]
print("日线行情-时间为序  daily_20190130 返回数据 row 行数 = "+str(daily_20190130.shape[0]))
daily_20190130_addname_dataframe.to_excel(daily_201901_excel_writer,'30_3',index=False)
daily_201901_excel_writer.save()
daily_20190131 = pro.daily(start_date='',end_date='',trade_date='20190131', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20190131_tscode_list = list() 
for ts_code_sh in daily_20190131['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20190131_tscode_list.append(stock_name)
daily_20190131_addname_dataframe=pd.DataFrame()
daily_20190131_addname_dataframe['cname'] = daily_20190131_tscode_list
for table_name in daily_20190131.columns.values.tolist():
    daily_20190131_addname_dataframe[table_name] = daily_20190131[table_name]
print("日线行情-时间为序  daily_20190131 返回数据 row 行数 = "+str(daily_20190131.shape[0]))
daily_20190131_addname_dataframe.to_excel(daily_201901_excel_writer,'31_4',index=False)
daily_201901_excel_writer.save()




createexcel('daily_201902.xlsx')
daily_201902_book = load_workbook('C:\\Users\\zhuzj5\\Desktop\\zbin\\J0_Data\\daily_201902.xlsx')
daily_201902_excel_writer = pd.ExcelWriter('C:\\Users\\zhuzj5\\Desktop\\zbin\\J0_Data\\daily_201902.xlsx', engine='openpyxl')
daily_201902_excel_writer.book = daily_201902_book
daily_201902_excel_writer.sheets = dict((ws.title, ws) for ws in daily_201902_book.worksheets)
J0_PROPS.put(tree_node_name+"record_date", "20190201")       ###  更新 记录日期
daily_20190201 = pro.daily(start_date='',end_date='',trade_date='20190201', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20190201_tscode_list = list() 
for ts_code_sh in daily_20190201['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20190201_tscode_list.append(stock_name)
daily_20190201_addname_dataframe=pd.DataFrame()
daily_20190201_addname_dataframe['cname'] = daily_20190201_tscode_list
for table_name in daily_20190201.columns.values.tolist():
    daily_20190201_addname_dataframe[table_name] = daily_20190201[table_name]
print("日线行情-时间为序  daily_20190201 返回数据 row 行数 = "+str(daily_20190201.shape[0]))
daily_20190201_addname_dataframe.to_excel(daily_201902_excel_writer,'1_5',index=False)
daily_201902_excel_writer.save()
daily_20190211 = pro.daily(start_date='',end_date='',trade_date='20190211', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20190211_tscode_list = list() 
for ts_code_sh in daily_20190211['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20190211_tscode_list.append(stock_name)
daily_20190211_addname_dataframe=pd.DataFrame()
daily_20190211_addname_dataframe['cname'] = daily_20190211_tscode_list
for table_name in daily_20190211.columns.values.tolist():
    daily_20190211_addname_dataframe[table_name] = daily_20190211[table_name]
print("日线行情-时间为序  daily_20190211 返回数据 row 行数 = "+str(daily_20190211.shape[0]))
daily_20190211_addname_dataframe.to_excel(daily_201902_excel_writer,'11_1',index=False)
daily_201902_excel_writer.save()
daily_20190212 = pro.daily(start_date='',end_date='',trade_date='20190212', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20190212_tscode_list = list() 
for ts_code_sh in daily_20190212['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20190212_tscode_list.append(stock_name)
daily_20190212_addname_dataframe=pd.DataFrame()
daily_20190212_addname_dataframe['cname'] = daily_20190212_tscode_list
for table_name in daily_20190212.columns.values.tolist():
    daily_20190212_addname_dataframe[table_name] = daily_20190212[table_name]
print("日线行情-时间为序  daily_20190212 返回数据 row 行数 = "+str(daily_20190212.shape[0]))
daily_20190212_addname_dataframe.to_excel(daily_201902_excel_writer,'12_2',index=False)
daily_201902_excel_writer.save()
daily_20190213 = pro.daily(start_date='',end_date='',trade_date='20190213', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20190213_tscode_list = list() 
for ts_code_sh in daily_20190213['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20190213_tscode_list.append(stock_name)
daily_20190213_addname_dataframe=pd.DataFrame()
daily_20190213_addname_dataframe['cname'] = daily_20190213_tscode_list
for table_name in daily_20190213.columns.values.tolist():
    daily_20190213_addname_dataframe[table_name] = daily_20190213[table_name]
print("日线行情-时间为序  daily_20190213 返回数据 row 行数 = "+str(daily_20190213.shape[0]))
daily_20190213_addname_dataframe.to_excel(daily_201902_excel_writer,'13_3',index=False)
daily_201902_excel_writer.save()
daily_20190214 = pro.daily(start_date='',end_date='',trade_date='20190214', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20190214_tscode_list = list() 
for ts_code_sh in daily_20190214['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20190214_tscode_list.append(stock_name)
daily_20190214_addname_dataframe=pd.DataFrame()
daily_20190214_addname_dataframe['cname'] = daily_20190214_tscode_list
for table_name in daily_20190214.columns.values.tolist():
    daily_20190214_addname_dataframe[table_name] = daily_20190214[table_name]
print("日线行情-时间为序  daily_20190214 返回数据 row 行数 = "+str(daily_20190214.shape[0]))
daily_20190214_addname_dataframe.to_excel(daily_201902_excel_writer,'14_4',index=False)
daily_201902_excel_writer.save()
daily_20190215 = pro.daily(start_date='',end_date='',trade_date='20190215', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20190215_tscode_list = list() 
for ts_code_sh in daily_20190215['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20190215_tscode_list.append(stock_name)
daily_20190215_addname_dataframe=pd.DataFrame()
daily_20190215_addname_dataframe['cname'] = daily_20190215_tscode_list
for table_name in daily_20190215.columns.values.tolist():
    daily_20190215_addname_dataframe[table_name] = daily_20190215[table_name]
print("日线行情-时间为序  daily_20190215 返回数据 row 行数 = "+str(daily_20190215.shape[0]))
daily_20190215_addname_dataframe.to_excel(daily_201902_excel_writer,'15_5',index=False)
daily_201902_excel_writer.save()
daily_20190218 = pro.daily(start_date='',end_date='',trade_date='20190218', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20190218_tscode_list = list() 
for ts_code_sh in daily_20190218['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20190218_tscode_list.append(stock_name)
daily_20190218_addname_dataframe=pd.DataFrame()
daily_20190218_addname_dataframe['cname'] = daily_20190218_tscode_list
for table_name in daily_20190218.columns.values.tolist():
    daily_20190218_addname_dataframe[table_name] = daily_20190218[table_name]
print("日线行情-时间为序  daily_20190218 返回数据 row 行数 = "+str(daily_20190218.shape[0]))
daily_20190218_addname_dataframe.to_excel(daily_201902_excel_writer,'18_1',index=False)
daily_201902_excel_writer.save()
daily_20190219 = pro.daily(start_date='',end_date='',trade_date='20190219', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20190219_tscode_list = list() 
for ts_code_sh in daily_20190219['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20190219_tscode_list.append(stock_name)
daily_20190219_addname_dataframe=pd.DataFrame()
daily_20190219_addname_dataframe['cname'] = daily_20190219_tscode_list
for table_name in daily_20190219.columns.values.tolist():
    daily_20190219_addname_dataframe[table_name] = daily_20190219[table_name]
print("日线行情-时间为序  daily_20190219 返回数据 row 行数 = "+str(daily_20190219.shape[0]))
daily_20190219_addname_dataframe.to_excel(daily_201902_excel_writer,'19_2',index=False)
daily_201902_excel_writer.save()
daily_20190220 = pro.daily(start_date='',end_date='',trade_date='20190220', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20190220_tscode_list = list() 
for ts_code_sh in daily_20190220['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20190220_tscode_list.append(stock_name)
daily_20190220_addname_dataframe=pd.DataFrame()
daily_20190220_addname_dataframe['cname'] = daily_20190220_tscode_list
for table_name in daily_20190220.columns.values.tolist():
    daily_20190220_addname_dataframe[table_name] = daily_20190220[table_name]
print("日线行情-时间为序  daily_20190220 返回数据 row 行数 = "+str(daily_20190220.shape[0]))
daily_20190220_addname_dataframe.to_excel(daily_201902_excel_writer,'20_3',index=False)
daily_201902_excel_writer.save()
daily_20190221 = pro.daily(start_date='',end_date='',trade_date='20190221', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20190221_tscode_list = list() 
for ts_code_sh in daily_20190221['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20190221_tscode_list.append(stock_name)
daily_20190221_addname_dataframe=pd.DataFrame()
daily_20190221_addname_dataframe['cname'] = daily_20190221_tscode_list
for table_name in daily_20190221.columns.values.tolist():
    daily_20190221_addname_dataframe[table_name] = daily_20190221[table_name]
print("日线行情-时间为序  daily_20190221 返回数据 row 行数 = "+str(daily_20190221.shape[0]))
daily_20190221_addname_dataframe.to_excel(daily_201902_excel_writer,'21_4',index=False)
daily_201902_excel_writer.save()
daily_20190222 = pro.daily(start_date='',end_date='',trade_date='20190222', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20190222_tscode_list = list() 
for ts_code_sh in daily_20190222['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20190222_tscode_list.append(stock_name)
daily_20190222_addname_dataframe=pd.DataFrame()
daily_20190222_addname_dataframe['cname'] = daily_20190222_tscode_list
for table_name in daily_20190222.columns.values.tolist():
    daily_20190222_addname_dataframe[table_name] = daily_20190222[table_name]
print("日线行情-时间为序  daily_20190222 返回数据 row 行数 = "+str(daily_20190222.shape[0]))
daily_20190222_addname_dataframe.to_excel(daily_201902_excel_writer,'22_5',index=False)
daily_201902_excel_writer.save()
daily_20190225 = pro.daily(start_date='',end_date='',trade_date='20190225', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20190225_tscode_list = list() 
for ts_code_sh in daily_20190225['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20190225_tscode_list.append(stock_name)
daily_20190225_addname_dataframe=pd.DataFrame()
daily_20190225_addname_dataframe['cname'] = daily_20190225_tscode_list
for table_name in daily_20190225.columns.values.tolist():
    daily_20190225_addname_dataframe[table_name] = daily_20190225[table_name]
print("日线行情-时间为序  daily_20190225 返回数据 row 行数 = "+str(daily_20190225.shape[0]))
daily_20190225_addname_dataframe.to_excel(daily_201902_excel_writer,'25_1',index=False)
daily_201902_excel_writer.save()
daily_20190226 = pro.daily(start_date='',end_date='',trade_date='20190226', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20190226_tscode_list = list() 
for ts_code_sh in daily_20190226['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20190226_tscode_list.append(stock_name)
daily_20190226_addname_dataframe=pd.DataFrame()
daily_20190226_addname_dataframe['cname'] = daily_20190226_tscode_list
for table_name in daily_20190226.columns.values.tolist():
    daily_20190226_addname_dataframe[table_name] = daily_20190226[table_name]
print("日线行情-时间为序  daily_20190226 返回数据 row 行数 = "+str(daily_20190226.shape[0]))
daily_20190226_addname_dataframe.to_excel(daily_201902_excel_writer,'26_2',index=False)
daily_201902_excel_writer.save()
daily_20190227 = pro.daily(start_date='',end_date='',trade_date='20190227', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20190227_tscode_list = list() 
for ts_code_sh in daily_20190227['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20190227_tscode_list.append(stock_name)
daily_20190227_addname_dataframe=pd.DataFrame()
daily_20190227_addname_dataframe['cname'] = daily_20190227_tscode_list
for table_name in daily_20190227.columns.values.tolist():
    daily_20190227_addname_dataframe[table_name] = daily_20190227[table_name]
print("日线行情-时间为序  daily_20190227 返回数据 row 行数 = "+str(daily_20190227.shape[0]))
daily_20190227_addname_dataframe.to_excel(daily_201902_excel_writer,'27_3',index=False)
daily_201902_excel_writer.save()
daily_20190228 = pro.daily(start_date='',end_date='',trade_date='20190228', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20190228_tscode_list = list() 
for ts_code_sh in daily_20190228['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20190228_tscode_list.append(stock_name)
daily_20190228_addname_dataframe=pd.DataFrame()
daily_20190228_addname_dataframe['cname'] = daily_20190228_tscode_list
for table_name in daily_20190228.columns.values.tolist():
    daily_20190228_addname_dataframe[table_name] = daily_20190228[table_name]
print("日线行情-时间为序  daily_20190228 返回数据 row 行数 = "+str(daily_20190228.shape[0]))
daily_20190228_addname_dataframe.to_excel(daily_201902_excel_writer,'28_4',index=False)
daily_201902_excel_writer.save()




createexcel('daily_201903.xlsx')
daily_201903_book = load_workbook('C:\\Users\\zhuzj5\\Desktop\\zbin\\J0_Data\\daily_201903.xlsx')
daily_201903_excel_writer = pd.ExcelWriter('C:\\Users\\zhuzj5\\Desktop\\zbin\\J0_Data\\daily_201903.xlsx', engine='openpyxl')
daily_201903_excel_writer.book = daily_201903_book
daily_201903_excel_writer.sheets = dict((ws.title, ws) for ws in daily_201903_book.worksheets)
J0_PROPS.put(tree_node_name+"record_date", "20190301")       ###  更新 记录日期
daily_20190301 = pro.daily(start_date='',end_date='',trade_date='20190301', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20190301_tscode_list = list() 
for ts_code_sh in daily_20190301['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20190301_tscode_list.append(stock_name)
daily_20190301_addname_dataframe=pd.DataFrame()
daily_20190301_addname_dataframe['cname'] = daily_20190301_tscode_list
for table_name in daily_20190301.columns.values.tolist():
    daily_20190301_addname_dataframe[table_name] = daily_20190301[table_name]
print("日线行情-时间为序  daily_20190301 返回数据 row 行数 = "+str(daily_20190301.shape[0]))
daily_20190301_addname_dataframe.to_excel(daily_201903_excel_writer,'1_5',index=False)
daily_201903_excel_writer.save()
daily_20190304 = pro.daily(start_date='',end_date='',trade_date='20190304', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20190304_tscode_list = list() 
for ts_code_sh in daily_20190304['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20190304_tscode_list.append(stock_name)
daily_20190304_addname_dataframe=pd.DataFrame()
daily_20190304_addname_dataframe['cname'] = daily_20190304_tscode_list
for table_name in daily_20190304.columns.values.tolist():
    daily_20190304_addname_dataframe[table_name] = daily_20190304[table_name]
print("日线行情-时间为序  daily_20190304 返回数据 row 行数 = "+str(daily_20190304.shape[0]))
daily_20190304_addname_dataframe.to_excel(daily_201903_excel_writer,'4_1',index=False)
daily_201903_excel_writer.save()
daily_20190305 = pro.daily(start_date='',end_date='',trade_date='20190305', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20190305_tscode_list = list() 
for ts_code_sh in daily_20190305['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20190305_tscode_list.append(stock_name)
daily_20190305_addname_dataframe=pd.DataFrame()
daily_20190305_addname_dataframe['cname'] = daily_20190305_tscode_list
for table_name in daily_20190305.columns.values.tolist():
    daily_20190305_addname_dataframe[table_name] = daily_20190305[table_name]
print("日线行情-时间为序  daily_20190305 返回数据 row 行数 = "+str(daily_20190305.shape[0]))
daily_20190305_addname_dataframe.to_excel(daily_201903_excel_writer,'5_2',index=False)
daily_201903_excel_writer.save()
daily_20190306 = pro.daily(start_date='',end_date='',trade_date='20190306', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20190306_tscode_list = list() 
for ts_code_sh in daily_20190306['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20190306_tscode_list.append(stock_name)
daily_20190306_addname_dataframe=pd.DataFrame()
daily_20190306_addname_dataframe['cname'] = daily_20190306_tscode_list
for table_name in daily_20190306.columns.values.tolist():
    daily_20190306_addname_dataframe[table_name] = daily_20190306[table_name]
print("日线行情-时间为序  daily_20190306 返回数据 row 行数 = "+str(daily_20190306.shape[0]))
daily_20190306_addname_dataframe.to_excel(daily_201903_excel_writer,'6_3',index=False)
daily_201903_excel_writer.save()
daily_20190307 = pro.daily(start_date='',end_date='',trade_date='20190307', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20190307_tscode_list = list() 
for ts_code_sh in daily_20190307['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20190307_tscode_list.append(stock_name)
daily_20190307_addname_dataframe=pd.DataFrame()
daily_20190307_addname_dataframe['cname'] = daily_20190307_tscode_list
for table_name in daily_20190307.columns.values.tolist():
    daily_20190307_addname_dataframe[table_name] = daily_20190307[table_name]
print("日线行情-时间为序  daily_20190307 返回数据 row 行数 = "+str(daily_20190307.shape[0]))
daily_20190307_addname_dataframe.to_excel(daily_201903_excel_writer,'7_4',index=False)
daily_201903_excel_writer.save()
daily_20190308 = pro.daily(start_date='',end_date='',trade_date='20190308', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20190308_tscode_list = list() 
for ts_code_sh in daily_20190308['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20190308_tscode_list.append(stock_name)
daily_20190308_addname_dataframe=pd.DataFrame()
daily_20190308_addname_dataframe['cname'] = daily_20190308_tscode_list
for table_name in daily_20190308.columns.values.tolist():
    daily_20190308_addname_dataframe[table_name] = daily_20190308[table_name]
print("日线行情-时间为序  daily_20190308 返回数据 row 行数 = "+str(daily_20190308.shape[0]))
daily_20190308_addname_dataframe.to_excel(daily_201903_excel_writer,'8_5',index=False)
daily_201903_excel_writer.save()
daily_20190311 = pro.daily(start_date='',end_date='',trade_date='20190311', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20190311_tscode_list = list() 
for ts_code_sh in daily_20190311['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20190311_tscode_list.append(stock_name)
daily_20190311_addname_dataframe=pd.DataFrame()
daily_20190311_addname_dataframe['cname'] = daily_20190311_tscode_list
for table_name in daily_20190311.columns.values.tolist():
    daily_20190311_addname_dataframe[table_name] = daily_20190311[table_name]
print("日线行情-时间为序  daily_20190311 返回数据 row 行数 = "+str(daily_20190311.shape[0]))
daily_20190311_addname_dataframe.to_excel(daily_201903_excel_writer,'11_1',index=False)
daily_201903_excel_writer.save()
daily_20190312 = pro.daily(start_date='',end_date='',trade_date='20190312', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20190312_tscode_list = list() 
for ts_code_sh in daily_20190312['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20190312_tscode_list.append(stock_name)
daily_20190312_addname_dataframe=pd.DataFrame()
daily_20190312_addname_dataframe['cname'] = daily_20190312_tscode_list
for table_name in daily_20190312.columns.values.tolist():
    daily_20190312_addname_dataframe[table_name] = daily_20190312[table_name]
print("日线行情-时间为序  daily_20190312 返回数据 row 行数 = "+str(daily_20190312.shape[0]))
daily_20190312_addname_dataframe.to_excel(daily_201903_excel_writer,'12_2',index=False)
daily_201903_excel_writer.save()
daily_20190313 = pro.daily(start_date='',end_date='',trade_date='20190313', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20190313_tscode_list = list() 
for ts_code_sh in daily_20190313['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20190313_tscode_list.append(stock_name)
daily_20190313_addname_dataframe=pd.DataFrame()
daily_20190313_addname_dataframe['cname'] = daily_20190313_tscode_list
for table_name in daily_20190313.columns.values.tolist():
    daily_20190313_addname_dataframe[table_name] = daily_20190313[table_name]
print("日线行情-时间为序  daily_20190313 返回数据 row 行数 = "+str(daily_20190313.shape[0]))
daily_20190313_addname_dataframe.to_excel(daily_201903_excel_writer,'13_3',index=False)
daily_201903_excel_writer.save()
daily_20190314 = pro.daily(start_date='',end_date='',trade_date='20190314', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20190314_tscode_list = list() 
for ts_code_sh in daily_20190314['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20190314_tscode_list.append(stock_name)
daily_20190314_addname_dataframe=pd.DataFrame()
daily_20190314_addname_dataframe['cname'] = daily_20190314_tscode_list
for table_name in daily_20190314.columns.values.tolist():
    daily_20190314_addname_dataframe[table_name] = daily_20190314[table_name]
print("日线行情-时间为序  daily_20190314 返回数据 row 行数 = "+str(daily_20190314.shape[0]))
daily_20190314_addname_dataframe.to_excel(daily_201903_excel_writer,'14_4',index=False)
daily_201903_excel_writer.save()
daily_20190315 = pro.daily(start_date='',end_date='',trade_date='20190315', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20190315_tscode_list = list() 
for ts_code_sh in daily_20190315['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20190315_tscode_list.append(stock_name)
daily_20190315_addname_dataframe=pd.DataFrame()
daily_20190315_addname_dataframe['cname'] = daily_20190315_tscode_list
for table_name in daily_20190315.columns.values.tolist():
    daily_20190315_addname_dataframe[table_name] = daily_20190315[table_name]
print("日线行情-时间为序  daily_20190315 返回数据 row 行数 = "+str(daily_20190315.shape[0]))
daily_20190315_addname_dataframe.to_excel(daily_201903_excel_writer,'15_5',index=False)
daily_201903_excel_writer.save()
daily_20190318 = pro.daily(start_date='',end_date='',trade_date='20190318', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20190318_tscode_list = list() 
for ts_code_sh in daily_20190318['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20190318_tscode_list.append(stock_name)
daily_20190318_addname_dataframe=pd.DataFrame()
daily_20190318_addname_dataframe['cname'] = daily_20190318_tscode_list
for table_name in daily_20190318.columns.values.tolist():
    daily_20190318_addname_dataframe[table_name] = daily_20190318[table_name]
print("日线行情-时间为序  daily_20190318 返回数据 row 行数 = "+str(daily_20190318.shape[0]))
daily_20190318_addname_dataframe.to_excel(daily_201903_excel_writer,'18_1',index=False)
daily_201903_excel_writer.save()
daily_20190319 = pro.daily(start_date='',end_date='',trade_date='20190319', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20190319_tscode_list = list() 
for ts_code_sh in daily_20190319['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20190319_tscode_list.append(stock_name)
daily_20190319_addname_dataframe=pd.DataFrame()
daily_20190319_addname_dataframe['cname'] = daily_20190319_tscode_list
for table_name in daily_20190319.columns.values.tolist():
    daily_20190319_addname_dataframe[table_name] = daily_20190319[table_name]
print("日线行情-时间为序  daily_20190319 返回数据 row 行数 = "+str(daily_20190319.shape[0]))
daily_20190319_addname_dataframe.to_excel(daily_201903_excel_writer,'19_2',index=False)
daily_201903_excel_writer.save()
daily_20190320 = pro.daily(start_date='',end_date='',trade_date='20190320', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20190320_tscode_list = list() 
for ts_code_sh in daily_20190320['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20190320_tscode_list.append(stock_name)
daily_20190320_addname_dataframe=pd.DataFrame()
daily_20190320_addname_dataframe['cname'] = daily_20190320_tscode_list
for table_name in daily_20190320.columns.values.tolist():
    daily_20190320_addname_dataframe[table_name] = daily_20190320[table_name]
print("日线行情-时间为序  daily_20190320 返回数据 row 行数 = "+str(daily_20190320.shape[0]))
daily_20190320_addname_dataframe.to_excel(daily_201903_excel_writer,'20_3',index=False)
daily_201903_excel_writer.save()
daily_20190321 = pro.daily(start_date='',end_date='',trade_date='20190321', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20190321_tscode_list = list() 
for ts_code_sh in daily_20190321['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20190321_tscode_list.append(stock_name)
daily_20190321_addname_dataframe=pd.DataFrame()
daily_20190321_addname_dataframe['cname'] = daily_20190321_tscode_list
for table_name in daily_20190321.columns.values.tolist():
    daily_20190321_addname_dataframe[table_name] = daily_20190321[table_name]
print("日线行情-时间为序  daily_20190321 返回数据 row 行数 = "+str(daily_20190321.shape[0]))
daily_20190321_addname_dataframe.to_excel(daily_201903_excel_writer,'21_4',index=False)
daily_201903_excel_writer.save()
daily_20190322 = pro.daily(start_date='',end_date='',trade_date='20190322', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20190322_tscode_list = list() 
for ts_code_sh in daily_20190322['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20190322_tscode_list.append(stock_name)
daily_20190322_addname_dataframe=pd.DataFrame()
daily_20190322_addname_dataframe['cname'] = daily_20190322_tscode_list
for table_name in daily_20190322.columns.values.tolist():
    daily_20190322_addname_dataframe[table_name] = daily_20190322[table_name]
print("日线行情-时间为序  daily_20190322 返回数据 row 行数 = "+str(daily_20190322.shape[0]))
daily_20190322_addname_dataframe.to_excel(daily_201903_excel_writer,'22_5',index=False)
daily_201903_excel_writer.save()
daily_20190325 = pro.daily(start_date='',end_date='',trade_date='20190325', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20190325_tscode_list = list() 
for ts_code_sh in daily_20190325['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20190325_tscode_list.append(stock_name)
daily_20190325_addname_dataframe=pd.DataFrame()
daily_20190325_addname_dataframe['cname'] = daily_20190325_tscode_list
for table_name in daily_20190325.columns.values.tolist():
    daily_20190325_addname_dataframe[table_name] = daily_20190325[table_name]
print("日线行情-时间为序  daily_20190325 返回数据 row 行数 = "+str(daily_20190325.shape[0]))
daily_20190325_addname_dataframe.to_excel(daily_201903_excel_writer,'25_1',index=False)
daily_201903_excel_writer.save()
daily_20190326 = pro.daily(start_date='',end_date='',trade_date='20190326', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20190326_tscode_list = list() 
for ts_code_sh in daily_20190326['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20190326_tscode_list.append(stock_name)
daily_20190326_addname_dataframe=pd.DataFrame()
daily_20190326_addname_dataframe['cname'] = daily_20190326_tscode_list
for table_name in daily_20190326.columns.values.tolist():
    daily_20190326_addname_dataframe[table_name] = daily_20190326[table_name]
print("日线行情-时间为序  daily_20190326 返回数据 row 行数 = "+str(daily_20190326.shape[0]))
daily_20190326_addname_dataframe.to_excel(daily_201903_excel_writer,'26_2',index=False)
daily_201903_excel_writer.save()
daily_20190327 = pro.daily(start_date='',end_date='',trade_date='20190327', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20190327_tscode_list = list() 
for ts_code_sh in daily_20190327['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20190327_tscode_list.append(stock_name)
daily_20190327_addname_dataframe=pd.DataFrame()
daily_20190327_addname_dataframe['cname'] = daily_20190327_tscode_list
for table_name in daily_20190327.columns.values.tolist():
    daily_20190327_addname_dataframe[table_name] = daily_20190327[table_name]
print("日线行情-时间为序  daily_20190327 返回数据 row 行数 = "+str(daily_20190327.shape[0]))
daily_20190327_addname_dataframe.to_excel(daily_201903_excel_writer,'27_3',index=False)
daily_201903_excel_writer.save()
daily_20190328 = pro.daily(start_date='',end_date='',trade_date='20190328', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20190328_tscode_list = list() 
for ts_code_sh in daily_20190328['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20190328_tscode_list.append(stock_name)
daily_20190328_addname_dataframe=pd.DataFrame()
daily_20190328_addname_dataframe['cname'] = daily_20190328_tscode_list
for table_name in daily_20190328.columns.values.tolist():
    daily_20190328_addname_dataframe[table_name] = daily_20190328[table_name]
print("日线行情-时间为序  daily_20190328 返回数据 row 行数 = "+str(daily_20190328.shape[0]))
daily_20190328_addname_dataframe.to_excel(daily_201903_excel_writer,'28_4',index=False)
daily_201903_excel_writer.save()
daily_20190329 = pro.daily(start_date='',end_date='',trade_date='20190329', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20190329_tscode_list = list() 
for ts_code_sh in daily_20190329['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20190329_tscode_list.append(stock_name)
daily_20190329_addname_dataframe=pd.DataFrame()
daily_20190329_addname_dataframe['cname'] = daily_20190329_tscode_list
for table_name in daily_20190329.columns.values.tolist():
    daily_20190329_addname_dataframe[table_name] = daily_20190329[table_name]
print("日线行情-时间为序  daily_20190329 返回数据 row 行数 = "+str(daily_20190329.shape[0]))
daily_20190329_addname_dataframe.to_excel(daily_201903_excel_writer,'29_5',index=False)
daily_201903_excel_writer.save()




createexcel('daily_201904.xlsx')
daily_201904_book = load_workbook('C:\\Users\\zhuzj5\\Desktop\\zbin\\J0_Data\\daily_201904.xlsx')
daily_201904_excel_writer = pd.ExcelWriter('C:\\Users\\zhuzj5\\Desktop\\zbin\\J0_Data\\daily_201904.xlsx', engine='openpyxl')
daily_201904_excel_writer.book = daily_201904_book
daily_201904_excel_writer.sheets = dict((ws.title, ws) for ws in daily_201904_book.worksheets)
J0_PROPS.put(tree_node_name+"record_date", "20190401")       ###  更新 记录日期
daily_20190401 = pro.daily(start_date='',end_date='',trade_date='20190401', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20190401_tscode_list = list() 
for ts_code_sh in daily_20190401['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20190401_tscode_list.append(stock_name)
daily_20190401_addname_dataframe=pd.DataFrame()
daily_20190401_addname_dataframe['cname'] = daily_20190401_tscode_list
for table_name in daily_20190401.columns.values.tolist():
    daily_20190401_addname_dataframe[table_name] = daily_20190401[table_name]
print("日线行情-时间为序  daily_20190401 返回数据 row 行数 = "+str(daily_20190401.shape[0]))
daily_20190401_addname_dataframe.to_excel(daily_201904_excel_writer,'1_1',index=False)
daily_201904_excel_writer.save()
daily_20190402 = pro.daily(start_date='',end_date='',trade_date='20190402', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20190402_tscode_list = list() 
for ts_code_sh in daily_20190402['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20190402_tscode_list.append(stock_name)
daily_20190402_addname_dataframe=pd.DataFrame()
daily_20190402_addname_dataframe['cname'] = daily_20190402_tscode_list
for table_name in daily_20190402.columns.values.tolist():
    daily_20190402_addname_dataframe[table_name] = daily_20190402[table_name]
print("日线行情-时间为序  daily_20190402 返回数据 row 行数 = "+str(daily_20190402.shape[0]))
daily_20190402_addname_dataframe.to_excel(daily_201904_excel_writer,'2_2',index=False)
daily_201904_excel_writer.save()
daily_20190403 = pro.daily(start_date='',end_date='',trade_date='20190403', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20190403_tscode_list = list() 
for ts_code_sh in daily_20190403['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20190403_tscode_list.append(stock_name)
daily_20190403_addname_dataframe=pd.DataFrame()
daily_20190403_addname_dataframe['cname'] = daily_20190403_tscode_list
for table_name in daily_20190403.columns.values.tolist():
    daily_20190403_addname_dataframe[table_name] = daily_20190403[table_name]
print("日线行情-时间为序  daily_20190403 返回数据 row 行数 = "+str(daily_20190403.shape[0]))
daily_20190403_addname_dataframe.to_excel(daily_201904_excel_writer,'3_3',index=False)
daily_201904_excel_writer.save()
daily_20190404 = pro.daily(start_date='',end_date='',trade_date='20190404', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20190404_tscode_list = list() 
for ts_code_sh in daily_20190404['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20190404_tscode_list.append(stock_name)
daily_20190404_addname_dataframe=pd.DataFrame()
daily_20190404_addname_dataframe['cname'] = daily_20190404_tscode_list
for table_name in daily_20190404.columns.values.tolist():
    daily_20190404_addname_dataframe[table_name] = daily_20190404[table_name]
print("日线行情-时间为序  daily_20190404 返回数据 row 行数 = "+str(daily_20190404.shape[0]))
daily_20190404_addname_dataframe.to_excel(daily_201904_excel_writer,'4_4',index=False)
daily_201904_excel_writer.save()
daily_20190408 = pro.daily(start_date='',end_date='',trade_date='20190408', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20190408_tscode_list = list() 
for ts_code_sh in daily_20190408['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20190408_tscode_list.append(stock_name)
daily_20190408_addname_dataframe=pd.DataFrame()
daily_20190408_addname_dataframe['cname'] = daily_20190408_tscode_list
for table_name in daily_20190408.columns.values.tolist():
    daily_20190408_addname_dataframe[table_name] = daily_20190408[table_name]
print("日线行情-时间为序  daily_20190408 返回数据 row 行数 = "+str(daily_20190408.shape[0]))
daily_20190408_addname_dataframe.to_excel(daily_201904_excel_writer,'8_1',index=False)
daily_201904_excel_writer.save()
daily_20190409 = pro.daily(start_date='',end_date='',trade_date='20190409', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20190409_tscode_list = list() 
for ts_code_sh in daily_20190409['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20190409_tscode_list.append(stock_name)
daily_20190409_addname_dataframe=pd.DataFrame()
daily_20190409_addname_dataframe['cname'] = daily_20190409_tscode_list
for table_name in daily_20190409.columns.values.tolist():
    daily_20190409_addname_dataframe[table_name] = daily_20190409[table_name]
print("日线行情-时间为序  daily_20190409 返回数据 row 行数 = "+str(daily_20190409.shape[0]))
daily_20190409_addname_dataframe.to_excel(daily_201904_excel_writer,'9_2',index=False)
daily_201904_excel_writer.save()
daily_20190410 = pro.daily(start_date='',end_date='',trade_date='20190410', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20190410_tscode_list = list() 
for ts_code_sh in daily_20190410['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20190410_tscode_list.append(stock_name)
daily_20190410_addname_dataframe=pd.DataFrame()
daily_20190410_addname_dataframe['cname'] = daily_20190410_tscode_list
for table_name in daily_20190410.columns.values.tolist():
    daily_20190410_addname_dataframe[table_name] = daily_20190410[table_name]
print("日线行情-时间为序  daily_20190410 返回数据 row 行数 = "+str(daily_20190410.shape[0]))
daily_20190410_addname_dataframe.to_excel(daily_201904_excel_writer,'10_3',index=False)
daily_201904_excel_writer.save()
daily_20190411 = pro.daily(start_date='',end_date='',trade_date='20190411', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20190411_tscode_list = list() 
for ts_code_sh in daily_20190411['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20190411_tscode_list.append(stock_name)
daily_20190411_addname_dataframe=pd.DataFrame()
daily_20190411_addname_dataframe['cname'] = daily_20190411_tscode_list
for table_name in daily_20190411.columns.values.tolist():
    daily_20190411_addname_dataframe[table_name] = daily_20190411[table_name]
print("日线行情-时间为序  daily_20190411 返回数据 row 行数 = "+str(daily_20190411.shape[0]))
daily_20190411_addname_dataframe.to_excel(daily_201904_excel_writer,'11_4',index=False)
daily_201904_excel_writer.save()
daily_20190412 = pro.daily(start_date='',end_date='',trade_date='20190412', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20190412_tscode_list = list() 
for ts_code_sh in daily_20190412['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20190412_tscode_list.append(stock_name)
daily_20190412_addname_dataframe=pd.DataFrame()
daily_20190412_addname_dataframe['cname'] = daily_20190412_tscode_list
for table_name in daily_20190412.columns.values.tolist():
    daily_20190412_addname_dataframe[table_name] = daily_20190412[table_name]
print("日线行情-时间为序  daily_20190412 返回数据 row 行数 = "+str(daily_20190412.shape[0]))
daily_20190412_addname_dataframe.to_excel(daily_201904_excel_writer,'12_5',index=False)
daily_201904_excel_writer.save()
daily_20190415 = pro.daily(start_date='',end_date='',trade_date='20190415', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20190415_tscode_list = list() 
for ts_code_sh in daily_20190415['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20190415_tscode_list.append(stock_name)
daily_20190415_addname_dataframe=pd.DataFrame()
daily_20190415_addname_dataframe['cname'] = daily_20190415_tscode_list
for table_name in daily_20190415.columns.values.tolist():
    daily_20190415_addname_dataframe[table_name] = daily_20190415[table_name]
print("日线行情-时间为序  daily_20190415 返回数据 row 行数 = "+str(daily_20190415.shape[0]))
daily_20190415_addname_dataframe.to_excel(daily_201904_excel_writer,'15_1',index=False)
daily_201904_excel_writer.save()
daily_20190416 = pro.daily(start_date='',end_date='',trade_date='20190416', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20190416_tscode_list = list() 
for ts_code_sh in daily_20190416['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20190416_tscode_list.append(stock_name)
daily_20190416_addname_dataframe=pd.DataFrame()
daily_20190416_addname_dataframe['cname'] = daily_20190416_tscode_list
for table_name in daily_20190416.columns.values.tolist():
    daily_20190416_addname_dataframe[table_name] = daily_20190416[table_name]
print("日线行情-时间为序  daily_20190416 返回数据 row 行数 = "+str(daily_20190416.shape[0]))
daily_20190416_addname_dataframe.to_excel(daily_201904_excel_writer,'16_2',index=False)
daily_201904_excel_writer.save()
daily_20190417 = pro.daily(start_date='',end_date='',trade_date='20190417', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20190417_tscode_list = list() 
for ts_code_sh in daily_20190417['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20190417_tscode_list.append(stock_name)
daily_20190417_addname_dataframe=pd.DataFrame()
daily_20190417_addname_dataframe['cname'] = daily_20190417_tscode_list
for table_name in daily_20190417.columns.values.tolist():
    daily_20190417_addname_dataframe[table_name] = daily_20190417[table_name]
print("日线行情-时间为序  daily_20190417 返回数据 row 行数 = "+str(daily_20190417.shape[0]))
daily_20190417_addname_dataframe.to_excel(daily_201904_excel_writer,'17_3',index=False)
daily_201904_excel_writer.save()
daily_20190418 = pro.daily(start_date='',end_date='',trade_date='20190418', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20190418_tscode_list = list() 
for ts_code_sh in daily_20190418['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20190418_tscode_list.append(stock_name)
daily_20190418_addname_dataframe=pd.DataFrame()
daily_20190418_addname_dataframe['cname'] = daily_20190418_tscode_list
for table_name in daily_20190418.columns.values.tolist():
    daily_20190418_addname_dataframe[table_name] = daily_20190418[table_name]
print("日线行情-时间为序  daily_20190418 返回数据 row 行数 = "+str(daily_20190418.shape[0]))
daily_20190418_addname_dataframe.to_excel(daily_201904_excel_writer,'18_4',index=False)
daily_201904_excel_writer.save()
daily_20190419 = pro.daily(start_date='',end_date='',trade_date='20190419', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20190419_tscode_list = list() 
for ts_code_sh in daily_20190419['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20190419_tscode_list.append(stock_name)
daily_20190419_addname_dataframe=pd.DataFrame()
daily_20190419_addname_dataframe['cname'] = daily_20190419_tscode_list
for table_name in daily_20190419.columns.values.tolist():
    daily_20190419_addname_dataframe[table_name] = daily_20190419[table_name]
print("日线行情-时间为序  daily_20190419 返回数据 row 行数 = "+str(daily_20190419.shape[0]))
daily_20190419_addname_dataframe.to_excel(daily_201904_excel_writer,'19_5',index=False)
daily_201904_excel_writer.save()
daily_20190422 = pro.daily(start_date='',end_date='',trade_date='20190422', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20190422_tscode_list = list() 
for ts_code_sh in daily_20190422['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20190422_tscode_list.append(stock_name)
daily_20190422_addname_dataframe=pd.DataFrame()
daily_20190422_addname_dataframe['cname'] = daily_20190422_tscode_list
for table_name in daily_20190422.columns.values.tolist():
    daily_20190422_addname_dataframe[table_name] = daily_20190422[table_name]
print("日线行情-时间为序  daily_20190422 返回数据 row 行数 = "+str(daily_20190422.shape[0]))
daily_20190422_addname_dataframe.to_excel(daily_201904_excel_writer,'22_1',index=False)
daily_201904_excel_writer.save()
daily_20190423 = pro.daily(start_date='',end_date='',trade_date='20190423', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20190423_tscode_list = list() 
for ts_code_sh in daily_20190423['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20190423_tscode_list.append(stock_name)
daily_20190423_addname_dataframe=pd.DataFrame()
daily_20190423_addname_dataframe['cname'] = daily_20190423_tscode_list
for table_name in daily_20190423.columns.values.tolist():
    daily_20190423_addname_dataframe[table_name] = daily_20190423[table_name]
print("日线行情-时间为序  daily_20190423 返回数据 row 行数 = "+str(daily_20190423.shape[0]))
daily_20190423_addname_dataframe.to_excel(daily_201904_excel_writer,'23_2',index=False)
daily_201904_excel_writer.save()
daily_20190424 = pro.daily(start_date='',end_date='',trade_date='20190424', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20190424_tscode_list = list() 
for ts_code_sh in daily_20190424['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20190424_tscode_list.append(stock_name)
daily_20190424_addname_dataframe=pd.DataFrame()
daily_20190424_addname_dataframe['cname'] = daily_20190424_tscode_list
for table_name in daily_20190424.columns.values.tolist():
    daily_20190424_addname_dataframe[table_name] = daily_20190424[table_name]
print("日线行情-时间为序  daily_20190424 返回数据 row 行数 = "+str(daily_20190424.shape[0]))
daily_20190424_addname_dataframe.to_excel(daily_201904_excel_writer,'24_3',index=False)
daily_201904_excel_writer.save()
daily_20190425 = pro.daily(start_date='',end_date='',trade_date='20190425', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20190425_tscode_list = list() 
for ts_code_sh in daily_20190425['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20190425_tscode_list.append(stock_name)
daily_20190425_addname_dataframe=pd.DataFrame()
daily_20190425_addname_dataframe['cname'] = daily_20190425_tscode_list
for table_name in daily_20190425.columns.values.tolist():
    daily_20190425_addname_dataframe[table_name] = daily_20190425[table_name]
print("日线行情-时间为序  daily_20190425 返回数据 row 行数 = "+str(daily_20190425.shape[0]))
daily_20190425_addname_dataframe.to_excel(daily_201904_excel_writer,'25_4',index=False)
daily_201904_excel_writer.save()
daily_20190426 = pro.daily(start_date='',end_date='',trade_date='20190426', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20190426_tscode_list = list() 
for ts_code_sh in daily_20190426['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20190426_tscode_list.append(stock_name)
daily_20190426_addname_dataframe=pd.DataFrame()
daily_20190426_addname_dataframe['cname'] = daily_20190426_tscode_list
for table_name in daily_20190426.columns.values.tolist():
    daily_20190426_addname_dataframe[table_name] = daily_20190426[table_name]
print("日线行情-时间为序  daily_20190426 返回数据 row 行数 = "+str(daily_20190426.shape[0]))
daily_20190426_addname_dataframe.to_excel(daily_201904_excel_writer,'26_5',index=False)
daily_201904_excel_writer.save()
daily_20190429 = pro.daily(start_date='',end_date='',trade_date='20190429', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20190429_tscode_list = list() 
for ts_code_sh in daily_20190429['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20190429_tscode_list.append(stock_name)
daily_20190429_addname_dataframe=pd.DataFrame()
daily_20190429_addname_dataframe['cname'] = daily_20190429_tscode_list
for table_name in daily_20190429.columns.values.tolist():
    daily_20190429_addname_dataframe[table_name] = daily_20190429[table_name]
print("日线行情-时间为序  daily_20190429 返回数据 row 行数 = "+str(daily_20190429.shape[0]))
daily_20190429_addname_dataframe.to_excel(daily_201904_excel_writer,'29_1',index=False)
daily_201904_excel_writer.save()
daily_20190430 = pro.daily(start_date='',end_date='',trade_date='20190430', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20190430_tscode_list = list() 
for ts_code_sh in daily_20190430['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20190430_tscode_list.append(stock_name)
daily_20190430_addname_dataframe=pd.DataFrame()
daily_20190430_addname_dataframe['cname'] = daily_20190430_tscode_list
for table_name in daily_20190430.columns.values.tolist():
    daily_20190430_addname_dataframe[table_name] = daily_20190430[table_name]
print("日线行情-时间为序  daily_20190430 返回数据 row 行数 = "+str(daily_20190430.shape[0]))
daily_20190430_addname_dataframe.to_excel(daily_201904_excel_writer,'30_2',index=False)
daily_201904_excel_writer.save()




createexcel('daily_201905.xlsx')
daily_201905_book = load_workbook('C:\\Users\\zhuzj5\\Desktop\\zbin\\J0_Data\\daily_201905.xlsx')
daily_201905_excel_writer = pd.ExcelWriter('C:\\Users\\zhuzj5\\Desktop\\zbin\\J0_Data\\daily_201905.xlsx', engine='openpyxl')
daily_201905_excel_writer.book = daily_201905_book
daily_201905_excel_writer.sheets = dict((ws.title, ws) for ws in daily_201905_book.worksheets)
J0_PROPS.put(tree_node_name+"record_date", "20190501")       ###  更新 记录日期
daily_20190506 = pro.daily(start_date='',end_date='',trade_date='20190506', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20190506_tscode_list = list() 
for ts_code_sh in daily_20190506['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20190506_tscode_list.append(stock_name)
daily_20190506_addname_dataframe=pd.DataFrame()
daily_20190506_addname_dataframe['cname'] = daily_20190506_tscode_list
for table_name in daily_20190506.columns.values.tolist():
    daily_20190506_addname_dataframe[table_name] = daily_20190506[table_name]
print("日线行情-时间为序  daily_20190506 返回数据 row 行数 = "+str(daily_20190506.shape[0]))
daily_20190506_addname_dataframe.to_excel(daily_201905_excel_writer,'6_1',index=False)
daily_201905_excel_writer.save()
daily_20190507 = pro.daily(start_date='',end_date='',trade_date='20190507', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20190507_tscode_list = list() 
for ts_code_sh in daily_20190507['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20190507_tscode_list.append(stock_name)
daily_20190507_addname_dataframe=pd.DataFrame()
daily_20190507_addname_dataframe['cname'] = daily_20190507_tscode_list
for table_name in daily_20190507.columns.values.tolist():
    daily_20190507_addname_dataframe[table_name] = daily_20190507[table_name]
print("日线行情-时间为序  daily_20190507 返回数据 row 行数 = "+str(daily_20190507.shape[0]))
daily_20190507_addname_dataframe.to_excel(daily_201905_excel_writer,'7_2',index=False)
daily_201905_excel_writer.save()
daily_20190508 = pro.daily(start_date='',end_date='',trade_date='20190508', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20190508_tscode_list = list() 
for ts_code_sh in daily_20190508['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20190508_tscode_list.append(stock_name)
daily_20190508_addname_dataframe=pd.DataFrame()
daily_20190508_addname_dataframe['cname'] = daily_20190508_tscode_list
for table_name in daily_20190508.columns.values.tolist():
    daily_20190508_addname_dataframe[table_name] = daily_20190508[table_name]
print("日线行情-时间为序  daily_20190508 返回数据 row 行数 = "+str(daily_20190508.shape[0]))
daily_20190508_addname_dataframe.to_excel(daily_201905_excel_writer,'8_3',index=False)
daily_201905_excel_writer.save()
daily_20190509 = pro.daily(start_date='',end_date='',trade_date='20190509', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20190509_tscode_list = list() 
for ts_code_sh in daily_20190509['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20190509_tscode_list.append(stock_name)
daily_20190509_addname_dataframe=pd.DataFrame()
daily_20190509_addname_dataframe['cname'] = daily_20190509_tscode_list
for table_name in daily_20190509.columns.values.tolist():
    daily_20190509_addname_dataframe[table_name] = daily_20190509[table_name]
print("日线行情-时间为序  daily_20190509 返回数据 row 行数 = "+str(daily_20190509.shape[0]))
daily_20190509_addname_dataframe.to_excel(daily_201905_excel_writer,'9_4',index=False)
daily_201905_excel_writer.save()
daily_20190510 = pro.daily(start_date='',end_date='',trade_date='20190510', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20190510_tscode_list = list() 
for ts_code_sh in daily_20190510['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20190510_tscode_list.append(stock_name)
daily_20190510_addname_dataframe=pd.DataFrame()
daily_20190510_addname_dataframe['cname'] = daily_20190510_tscode_list
for table_name in daily_20190510.columns.values.tolist():
    daily_20190510_addname_dataframe[table_name] = daily_20190510[table_name]
print("日线行情-时间为序  daily_20190510 返回数据 row 行数 = "+str(daily_20190510.shape[0]))
daily_20190510_addname_dataframe.to_excel(daily_201905_excel_writer,'10_5',index=False)
daily_201905_excel_writer.save()
daily_20190513 = pro.daily(start_date='',end_date='',trade_date='20190513', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20190513_tscode_list = list() 
for ts_code_sh in daily_20190513['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20190513_tscode_list.append(stock_name)
daily_20190513_addname_dataframe=pd.DataFrame()
daily_20190513_addname_dataframe['cname'] = daily_20190513_tscode_list
for table_name in daily_20190513.columns.values.tolist():
    daily_20190513_addname_dataframe[table_name] = daily_20190513[table_name]
print("日线行情-时间为序  daily_20190513 返回数据 row 行数 = "+str(daily_20190513.shape[0]))
daily_20190513_addname_dataframe.to_excel(daily_201905_excel_writer,'13_1',index=False)
daily_201905_excel_writer.save()
daily_20190514 = pro.daily(start_date='',end_date='',trade_date='20190514', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20190514_tscode_list = list() 
for ts_code_sh in daily_20190514['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20190514_tscode_list.append(stock_name)
daily_20190514_addname_dataframe=pd.DataFrame()
daily_20190514_addname_dataframe['cname'] = daily_20190514_tscode_list
for table_name in daily_20190514.columns.values.tolist():
    daily_20190514_addname_dataframe[table_name] = daily_20190514[table_name]
print("日线行情-时间为序  daily_20190514 返回数据 row 行数 = "+str(daily_20190514.shape[0]))
daily_20190514_addname_dataframe.to_excel(daily_201905_excel_writer,'14_2',index=False)
daily_201905_excel_writer.save()
daily_20190515 = pro.daily(start_date='',end_date='',trade_date='20190515', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20190515_tscode_list = list() 
for ts_code_sh in daily_20190515['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20190515_tscode_list.append(stock_name)
daily_20190515_addname_dataframe=pd.DataFrame()
daily_20190515_addname_dataframe['cname'] = daily_20190515_tscode_list
for table_name in daily_20190515.columns.values.tolist():
    daily_20190515_addname_dataframe[table_name] = daily_20190515[table_name]
print("日线行情-时间为序  daily_20190515 返回数据 row 行数 = "+str(daily_20190515.shape[0]))
daily_20190515_addname_dataframe.to_excel(daily_201905_excel_writer,'15_3',index=False)
daily_201905_excel_writer.save()
daily_20190516 = pro.daily(start_date='',end_date='',trade_date='20190516', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20190516_tscode_list = list() 
for ts_code_sh in daily_20190516['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20190516_tscode_list.append(stock_name)
daily_20190516_addname_dataframe=pd.DataFrame()
daily_20190516_addname_dataframe['cname'] = daily_20190516_tscode_list
for table_name in daily_20190516.columns.values.tolist():
    daily_20190516_addname_dataframe[table_name] = daily_20190516[table_name]
print("日线行情-时间为序  daily_20190516 返回数据 row 行数 = "+str(daily_20190516.shape[0]))
daily_20190516_addname_dataframe.to_excel(daily_201905_excel_writer,'16_4',index=False)
daily_201905_excel_writer.save()
daily_20190517 = pro.daily(start_date='',end_date='',trade_date='20190517', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20190517_tscode_list = list() 
for ts_code_sh in daily_20190517['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20190517_tscode_list.append(stock_name)
daily_20190517_addname_dataframe=pd.DataFrame()
daily_20190517_addname_dataframe['cname'] = daily_20190517_tscode_list
for table_name in daily_20190517.columns.values.tolist():
    daily_20190517_addname_dataframe[table_name] = daily_20190517[table_name]
print("日线行情-时间为序  daily_20190517 返回数据 row 行数 = "+str(daily_20190517.shape[0]))
daily_20190517_addname_dataframe.to_excel(daily_201905_excel_writer,'17_5',index=False)
daily_201905_excel_writer.save()
daily_20190520 = pro.daily(start_date='',end_date='',trade_date='20190520', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20190520_tscode_list = list() 
for ts_code_sh in daily_20190520['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20190520_tscode_list.append(stock_name)
daily_20190520_addname_dataframe=pd.DataFrame()
daily_20190520_addname_dataframe['cname'] = daily_20190520_tscode_list
for table_name in daily_20190520.columns.values.tolist():
    daily_20190520_addname_dataframe[table_name] = daily_20190520[table_name]
print("日线行情-时间为序  daily_20190520 返回数据 row 行数 = "+str(daily_20190520.shape[0]))
daily_20190520_addname_dataframe.to_excel(daily_201905_excel_writer,'20_1',index=False)
daily_201905_excel_writer.save()
daily_20190521 = pro.daily(start_date='',end_date='',trade_date='20190521', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20190521_tscode_list = list() 
for ts_code_sh in daily_20190521['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20190521_tscode_list.append(stock_name)
daily_20190521_addname_dataframe=pd.DataFrame()
daily_20190521_addname_dataframe['cname'] = daily_20190521_tscode_list
for table_name in daily_20190521.columns.values.tolist():
    daily_20190521_addname_dataframe[table_name] = daily_20190521[table_name]
print("日线行情-时间为序  daily_20190521 返回数据 row 行数 = "+str(daily_20190521.shape[0]))
daily_20190521_addname_dataframe.to_excel(daily_201905_excel_writer,'21_2',index=False)
daily_201905_excel_writer.save()
daily_20190522 = pro.daily(start_date='',end_date='',trade_date='20190522', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20190522_tscode_list = list() 
for ts_code_sh in daily_20190522['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20190522_tscode_list.append(stock_name)
daily_20190522_addname_dataframe=pd.DataFrame()
daily_20190522_addname_dataframe['cname'] = daily_20190522_tscode_list
for table_name in daily_20190522.columns.values.tolist():
    daily_20190522_addname_dataframe[table_name] = daily_20190522[table_name]
print("日线行情-时间为序  daily_20190522 返回数据 row 行数 = "+str(daily_20190522.shape[0]))
daily_20190522_addname_dataframe.to_excel(daily_201905_excel_writer,'22_3',index=False)
daily_201905_excel_writer.save()
daily_20190523 = pro.daily(start_date='',end_date='',trade_date='20190523', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20190523_tscode_list = list() 
for ts_code_sh in daily_20190523['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20190523_tscode_list.append(stock_name)
daily_20190523_addname_dataframe=pd.DataFrame()
daily_20190523_addname_dataframe['cname'] = daily_20190523_tscode_list
for table_name in daily_20190523.columns.values.tolist():
    daily_20190523_addname_dataframe[table_name] = daily_20190523[table_name]
print("日线行情-时间为序  daily_20190523 返回数据 row 行数 = "+str(daily_20190523.shape[0]))
daily_20190523_addname_dataframe.to_excel(daily_201905_excel_writer,'23_4',index=False)
daily_201905_excel_writer.save()
daily_20190524 = pro.daily(start_date='',end_date='',trade_date='20190524', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20190524_tscode_list = list() 
for ts_code_sh in daily_20190524['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20190524_tscode_list.append(stock_name)
daily_20190524_addname_dataframe=pd.DataFrame()
daily_20190524_addname_dataframe['cname'] = daily_20190524_tscode_list
for table_name in daily_20190524.columns.values.tolist():
    daily_20190524_addname_dataframe[table_name] = daily_20190524[table_name]
print("日线行情-时间为序  daily_20190524 返回数据 row 行数 = "+str(daily_20190524.shape[0]))
daily_20190524_addname_dataframe.to_excel(daily_201905_excel_writer,'24_5',index=False)
daily_201905_excel_writer.save()
daily_20190527 = pro.daily(start_date='',end_date='',trade_date='20190527', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20190527_tscode_list = list() 
for ts_code_sh in daily_20190527['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20190527_tscode_list.append(stock_name)
daily_20190527_addname_dataframe=pd.DataFrame()
daily_20190527_addname_dataframe['cname'] = daily_20190527_tscode_list
for table_name in daily_20190527.columns.values.tolist():
    daily_20190527_addname_dataframe[table_name] = daily_20190527[table_name]
print("日线行情-时间为序  daily_20190527 返回数据 row 行数 = "+str(daily_20190527.shape[0]))
daily_20190527_addname_dataframe.to_excel(daily_201905_excel_writer,'27_1',index=False)
daily_201905_excel_writer.save()
daily_20190528 = pro.daily(start_date='',end_date='',trade_date='20190528', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20190528_tscode_list = list() 
for ts_code_sh in daily_20190528['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20190528_tscode_list.append(stock_name)
daily_20190528_addname_dataframe=pd.DataFrame()
daily_20190528_addname_dataframe['cname'] = daily_20190528_tscode_list
for table_name in daily_20190528.columns.values.tolist():
    daily_20190528_addname_dataframe[table_name] = daily_20190528[table_name]
print("日线行情-时间为序  daily_20190528 返回数据 row 行数 = "+str(daily_20190528.shape[0]))
daily_20190528_addname_dataframe.to_excel(daily_201905_excel_writer,'28_2',index=False)
daily_201905_excel_writer.save()
daily_20190529 = pro.daily(start_date='',end_date='',trade_date='20190529', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20190529_tscode_list = list() 
for ts_code_sh in daily_20190529['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20190529_tscode_list.append(stock_name)
daily_20190529_addname_dataframe=pd.DataFrame()
daily_20190529_addname_dataframe['cname'] = daily_20190529_tscode_list
for table_name in daily_20190529.columns.values.tolist():
    daily_20190529_addname_dataframe[table_name] = daily_20190529[table_name]
print("日线行情-时间为序  daily_20190529 返回数据 row 行数 = "+str(daily_20190529.shape[0]))
daily_20190529_addname_dataframe.to_excel(daily_201905_excel_writer,'29_3',index=False)
daily_201905_excel_writer.save()
daily_20190530 = pro.daily(start_date='',end_date='',trade_date='20190530', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20190530_tscode_list = list() 
for ts_code_sh in daily_20190530['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20190530_tscode_list.append(stock_name)
daily_20190530_addname_dataframe=pd.DataFrame()
daily_20190530_addname_dataframe['cname'] = daily_20190530_tscode_list
for table_name in daily_20190530.columns.values.tolist():
    daily_20190530_addname_dataframe[table_name] = daily_20190530[table_name]
print("日线行情-时间为序  daily_20190530 返回数据 row 行数 = "+str(daily_20190530.shape[0]))
daily_20190530_addname_dataframe.to_excel(daily_201905_excel_writer,'30_4',index=False)
daily_201905_excel_writer.save()
daily_20190531 = pro.daily(start_date='',end_date='',trade_date='20190531', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20190531_tscode_list = list() 
for ts_code_sh in daily_20190531['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20190531_tscode_list.append(stock_name)
daily_20190531_addname_dataframe=pd.DataFrame()
daily_20190531_addname_dataframe['cname'] = daily_20190531_tscode_list
for table_name in daily_20190531.columns.values.tolist():
    daily_20190531_addname_dataframe[table_name] = daily_20190531[table_name]
print("日线行情-时间为序  daily_20190531 返回数据 row 行数 = "+str(daily_20190531.shape[0]))
daily_20190531_addname_dataframe.to_excel(daily_201905_excel_writer,'31_5',index=False)
daily_201905_excel_writer.save()




createexcel('daily_201906.xlsx')
daily_201906_book = load_workbook('C:\\Users\\zhuzj5\\Desktop\\zbin\\J0_Data\\daily_201906.xlsx')
daily_201906_excel_writer = pd.ExcelWriter('C:\\Users\\zhuzj5\\Desktop\\zbin\\J0_Data\\daily_201906.xlsx', engine='openpyxl')
daily_201906_excel_writer.book = daily_201906_book
daily_201906_excel_writer.sheets = dict((ws.title, ws) for ws in daily_201906_book.worksheets)
J0_PROPS.put(tree_node_name+"record_date", "20190601")       ###  更新 记录日期
daily_20190603 = pro.daily(start_date='',end_date='',trade_date='20190603', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20190603_tscode_list = list() 
for ts_code_sh in daily_20190603['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20190603_tscode_list.append(stock_name)
daily_20190603_addname_dataframe=pd.DataFrame()
daily_20190603_addname_dataframe['cname'] = daily_20190603_tscode_list
for table_name in daily_20190603.columns.values.tolist():
    daily_20190603_addname_dataframe[table_name] = daily_20190603[table_name]
print("日线行情-时间为序  daily_20190603 返回数据 row 行数 = "+str(daily_20190603.shape[0]))
daily_20190603_addname_dataframe.to_excel(daily_201906_excel_writer,'3_1',index=False)
daily_201906_excel_writer.save()
daily_20190604 = pro.daily(start_date='',end_date='',trade_date='20190604', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20190604_tscode_list = list() 
for ts_code_sh in daily_20190604['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20190604_tscode_list.append(stock_name)
daily_20190604_addname_dataframe=pd.DataFrame()
daily_20190604_addname_dataframe['cname'] = daily_20190604_tscode_list
for table_name in daily_20190604.columns.values.tolist():
    daily_20190604_addname_dataframe[table_name] = daily_20190604[table_name]
print("日线行情-时间为序  daily_20190604 返回数据 row 行数 = "+str(daily_20190604.shape[0]))
daily_20190604_addname_dataframe.to_excel(daily_201906_excel_writer,'4_2',index=False)
daily_201906_excel_writer.save()
daily_20190605 = pro.daily(start_date='',end_date='',trade_date='20190605', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20190605_tscode_list = list() 
for ts_code_sh in daily_20190605['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20190605_tscode_list.append(stock_name)
daily_20190605_addname_dataframe=pd.DataFrame()
daily_20190605_addname_dataframe['cname'] = daily_20190605_tscode_list
for table_name in daily_20190605.columns.values.tolist():
    daily_20190605_addname_dataframe[table_name] = daily_20190605[table_name]
print("日线行情-时间为序  daily_20190605 返回数据 row 行数 = "+str(daily_20190605.shape[0]))
daily_20190605_addname_dataframe.to_excel(daily_201906_excel_writer,'5_3',index=False)
daily_201906_excel_writer.save()
daily_20190606 = pro.daily(start_date='',end_date='',trade_date='20190606', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20190606_tscode_list = list() 
for ts_code_sh in daily_20190606['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20190606_tscode_list.append(stock_name)
daily_20190606_addname_dataframe=pd.DataFrame()
daily_20190606_addname_dataframe['cname'] = daily_20190606_tscode_list
for table_name in daily_20190606.columns.values.tolist():
    daily_20190606_addname_dataframe[table_name] = daily_20190606[table_name]
print("日线行情-时间为序  daily_20190606 返回数据 row 行数 = "+str(daily_20190606.shape[0]))
daily_20190606_addname_dataframe.to_excel(daily_201906_excel_writer,'6_4',index=False)
daily_201906_excel_writer.save()
daily_20190610 = pro.daily(start_date='',end_date='',trade_date='20190610', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20190610_tscode_list = list() 
for ts_code_sh in daily_20190610['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20190610_tscode_list.append(stock_name)
daily_20190610_addname_dataframe=pd.DataFrame()
daily_20190610_addname_dataframe['cname'] = daily_20190610_tscode_list
for table_name in daily_20190610.columns.values.tolist():
    daily_20190610_addname_dataframe[table_name] = daily_20190610[table_name]
print("日线行情-时间为序  daily_20190610 返回数据 row 行数 = "+str(daily_20190610.shape[0]))
daily_20190610_addname_dataframe.to_excel(daily_201906_excel_writer,'10_1',index=False)
daily_201906_excel_writer.save()
daily_20190611 = pro.daily(start_date='',end_date='',trade_date='20190611', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20190611_tscode_list = list() 
for ts_code_sh in daily_20190611['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20190611_tscode_list.append(stock_name)
daily_20190611_addname_dataframe=pd.DataFrame()
daily_20190611_addname_dataframe['cname'] = daily_20190611_tscode_list
for table_name in daily_20190611.columns.values.tolist():
    daily_20190611_addname_dataframe[table_name] = daily_20190611[table_name]
print("日线行情-时间为序  daily_20190611 返回数据 row 行数 = "+str(daily_20190611.shape[0]))
daily_20190611_addname_dataframe.to_excel(daily_201906_excel_writer,'11_2',index=False)
daily_201906_excel_writer.save()
daily_20190612 = pro.daily(start_date='',end_date='',trade_date='20190612', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20190612_tscode_list = list() 
for ts_code_sh in daily_20190612['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20190612_tscode_list.append(stock_name)
daily_20190612_addname_dataframe=pd.DataFrame()
daily_20190612_addname_dataframe['cname'] = daily_20190612_tscode_list
for table_name in daily_20190612.columns.values.tolist():
    daily_20190612_addname_dataframe[table_name] = daily_20190612[table_name]
print("日线行情-时间为序  daily_20190612 返回数据 row 行数 = "+str(daily_20190612.shape[0]))
daily_20190612_addname_dataframe.to_excel(daily_201906_excel_writer,'12_3',index=False)
daily_201906_excel_writer.save()
daily_20190613 = pro.daily(start_date='',end_date='',trade_date='20190613', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20190613_tscode_list = list() 
for ts_code_sh in daily_20190613['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20190613_tscode_list.append(stock_name)
daily_20190613_addname_dataframe=pd.DataFrame()
daily_20190613_addname_dataframe['cname'] = daily_20190613_tscode_list
for table_name in daily_20190613.columns.values.tolist():
    daily_20190613_addname_dataframe[table_name] = daily_20190613[table_name]
print("日线行情-时间为序  daily_20190613 返回数据 row 行数 = "+str(daily_20190613.shape[0]))
daily_20190613_addname_dataframe.to_excel(daily_201906_excel_writer,'13_4',index=False)
daily_201906_excel_writer.save()
daily_20190614 = pro.daily(start_date='',end_date='',trade_date='20190614', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20190614_tscode_list = list() 
for ts_code_sh in daily_20190614['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20190614_tscode_list.append(stock_name)
daily_20190614_addname_dataframe=pd.DataFrame()
daily_20190614_addname_dataframe['cname'] = daily_20190614_tscode_list
for table_name in daily_20190614.columns.values.tolist():
    daily_20190614_addname_dataframe[table_name] = daily_20190614[table_name]
print("日线行情-时间为序  daily_20190614 返回数据 row 行数 = "+str(daily_20190614.shape[0]))
daily_20190614_addname_dataframe.to_excel(daily_201906_excel_writer,'14_5',index=False)
daily_201906_excel_writer.save()
daily_20190617 = pro.daily(start_date='',end_date='',trade_date='20190617', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20190617_tscode_list = list() 
for ts_code_sh in daily_20190617['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20190617_tscode_list.append(stock_name)
daily_20190617_addname_dataframe=pd.DataFrame()
daily_20190617_addname_dataframe['cname'] = daily_20190617_tscode_list
for table_name in daily_20190617.columns.values.tolist():
    daily_20190617_addname_dataframe[table_name] = daily_20190617[table_name]
print("日线行情-时间为序  daily_20190617 返回数据 row 行数 = "+str(daily_20190617.shape[0]))
daily_20190617_addname_dataframe.to_excel(daily_201906_excel_writer,'17_1',index=False)
daily_201906_excel_writer.save()
daily_20190618 = pro.daily(start_date='',end_date='',trade_date='20190618', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20190618_tscode_list = list() 
for ts_code_sh in daily_20190618['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20190618_tscode_list.append(stock_name)
daily_20190618_addname_dataframe=pd.DataFrame()
daily_20190618_addname_dataframe['cname'] = daily_20190618_tscode_list
for table_name in daily_20190618.columns.values.tolist():
    daily_20190618_addname_dataframe[table_name] = daily_20190618[table_name]
print("日线行情-时间为序  daily_20190618 返回数据 row 行数 = "+str(daily_20190618.shape[0]))
daily_20190618_addname_dataframe.to_excel(daily_201906_excel_writer,'18_2',index=False)
daily_201906_excel_writer.save()
daily_20190619 = pro.daily(start_date='',end_date='',trade_date='20190619', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20190619_tscode_list = list() 
for ts_code_sh in daily_20190619['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20190619_tscode_list.append(stock_name)
daily_20190619_addname_dataframe=pd.DataFrame()
daily_20190619_addname_dataframe['cname'] = daily_20190619_tscode_list
for table_name in daily_20190619.columns.values.tolist():
    daily_20190619_addname_dataframe[table_name] = daily_20190619[table_name]
print("日线行情-时间为序  daily_20190619 返回数据 row 行数 = "+str(daily_20190619.shape[0]))
daily_20190619_addname_dataframe.to_excel(daily_201906_excel_writer,'19_3',index=False)
daily_201906_excel_writer.save()
daily_20190620 = pro.daily(start_date='',end_date='',trade_date='20190620', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20190620_tscode_list = list() 
for ts_code_sh in daily_20190620['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20190620_tscode_list.append(stock_name)
daily_20190620_addname_dataframe=pd.DataFrame()
daily_20190620_addname_dataframe['cname'] = daily_20190620_tscode_list
for table_name in daily_20190620.columns.values.tolist():
    daily_20190620_addname_dataframe[table_name] = daily_20190620[table_name]
print("日线行情-时间为序  daily_20190620 返回数据 row 行数 = "+str(daily_20190620.shape[0]))
daily_20190620_addname_dataframe.to_excel(daily_201906_excel_writer,'20_4',index=False)
daily_201906_excel_writer.save()
daily_20190621 = pro.daily(start_date='',end_date='',trade_date='20190621', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20190621_tscode_list = list() 
for ts_code_sh in daily_20190621['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20190621_tscode_list.append(stock_name)
daily_20190621_addname_dataframe=pd.DataFrame()
daily_20190621_addname_dataframe['cname'] = daily_20190621_tscode_list
for table_name in daily_20190621.columns.values.tolist():
    daily_20190621_addname_dataframe[table_name] = daily_20190621[table_name]
print("日线行情-时间为序  daily_20190621 返回数据 row 行数 = "+str(daily_20190621.shape[0]))
daily_20190621_addname_dataframe.to_excel(daily_201906_excel_writer,'21_5',index=False)
daily_201906_excel_writer.save()
daily_20190624 = pro.daily(start_date='',end_date='',trade_date='20190624', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20190624_tscode_list = list() 
for ts_code_sh in daily_20190624['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20190624_tscode_list.append(stock_name)
daily_20190624_addname_dataframe=pd.DataFrame()
daily_20190624_addname_dataframe['cname'] = daily_20190624_tscode_list
for table_name in daily_20190624.columns.values.tolist():
    daily_20190624_addname_dataframe[table_name] = daily_20190624[table_name]
print("日线行情-时间为序  daily_20190624 返回数据 row 行数 = "+str(daily_20190624.shape[0]))
daily_20190624_addname_dataframe.to_excel(daily_201906_excel_writer,'24_1',index=False)
daily_201906_excel_writer.save()
daily_20190625 = pro.daily(start_date='',end_date='',trade_date='20190625', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20190625_tscode_list = list() 
for ts_code_sh in daily_20190625['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20190625_tscode_list.append(stock_name)
daily_20190625_addname_dataframe=pd.DataFrame()
daily_20190625_addname_dataframe['cname'] = daily_20190625_tscode_list
for table_name in daily_20190625.columns.values.tolist():
    daily_20190625_addname_dataframe[table_name] = daily_20190625[table_name]
print("日线行情-时间为序  daily_20190625 返回数据 row 行数 = "+str(daily_20190625.shape[0]))
daily_20190625_addname_dataframe.to_excel(daily_201906_excel_writer,'25_2',index=False)
daily_201906_excel_writer.save()
daily_20190626 = pro.daily(start_date='',end_date='',trade_date='20190626', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20190626_tscode_list = list() 
for ts_code_sh in daily_20190626['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20190626_tscode_list.append(stock_name)
daily_20190626_addname_dataframe=pd.DataFrame()
daily_20190626_addname_dataframe['cname'] = daily_20190626_tscode_list
for table_name in daily_20190626.columns.values.tolist():
    daily_20190626_addname_dataframe[table_name] = daily_20190626[table_name]
print("日线行情-时间为序  daily_20190626 返回数据 row 行数 = "+str(daily_20190626.shape[0]))
daily_20190626_addname_dataframe.to_excel(daily_201906_excel_writer,'26_3',index=False)
daily_201906_excel_writer.save()
daily_20190627 = pro.daily(start_date='',end_date='',trade_date='20190627', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20190627_tscode_list = list() 
for ts_code_sh in daily_20190627['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20190627_tscode_list.append(stock_name)
daily_20190627_addname_dataframe=pd.DataFrame()
daily_20190627_addname_dataframe['cname'] = daily_20190627_tscode_list
for table_name in daily_20190627.columns.values.tolist():
    daily_20190627_addname_dataframe[table_name] = daily_20190627[table_name]
print("日线行情-时间为序  daily_20190627 返回数据 row 行数 = "+str(daily_20190627.shape[0]))
daily_20190627_addname_dataframe.to_excel(daily_201906_excel_writer,'27_4',index=False)
daily_201906_excel_writer.save()
daily_20190628 = pro.daily(start_date='',end_date='',trade_date='20190628', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20190628_tscode_list = list() 
for ts_code_sh in daily_20190628['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20190628_tscode_list.append(stock_name)
daily_20190628_addname_dataframe=pd.DataFrame()
daily_20190628_addname_dataframe['cname'] = daily_20190628_tscode_list
for table_name in daily_20190628.columns.values.tolist():
    daily_20190628_addname_dataframe[table_name] = daily_20190628[table_name]
print("日线行情-时间为序  daily_20190628 返回数据 row 行数 = "+str(daily_20190628.shape[0]))
daily_20190628_addname_dataframe.to_excel(daily_201906_excel_writer,'28_5',index=False)
daily_201906_excel_writer.save()




createexcel('daily_201907.xlsx')
daily_201907_book = load_workbook('C:\\Users\\zhuzj5\\Desktop\\zbin\\J0_Data\\daily_201907.xlsx')
daily_201907_excel_writer = pd.ExcelWriter('C:\\Users\\zhuzj5\\Desktop\\zbin\\J0_Data\\daily_201907.xlsx', engine='openpyxl')
daily_201907_excel_writer.book = daily_201907_book
daily_201907_excel_writer.sheets = dict((ws.title, ws) for ws in daily_201907_book.worksheets)
J0_PROPS.put(tree_node_name+"record_date", "20190701")       ###  更新 记录日期
daily_20190701 = pro.daily(start_date='',end_date='',trade_date='20190701', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20190701_tscode_list = list() 
for ts_code_sh in daily_20190701['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20190701_tscode_list.append(stock_name)
daily_20190701_addname_dataframe=pd.DataFrame()
daily_20190701_addname_dataframe['cname'] = daily_20190701_tscode_list
for table_name in daily_20190701.columns.values.tolist():
    daily_20190701_addname_dataframe[table_name] = daily_20190701[table_name]
print("日线行情-时间为序  daily_20190701 返回数据 row 行数 = "+str(daily_20190701.shape[0]))
daily_20190701_addname_dataframe.to_excel(daily_201907_excel_writer,'1_1',index=False)
daily_201907_excel_writer.save()
daily_20190702 = pro.daily(start_date='',end_date='',trade_date='20190702', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20190702_tscode_list = list() 
for ts_code_sh in daily_20190702['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20190702_tscode_list.append(stock_name)
daily_20190702_addname_dataframe=pd.DataFrame()
daily_20190702_addname_dataframe['cname'] = daily_20190702_tscode_list
for table_name in daily_20190702.columns.values.tolist():
    daily_20190702_addname_dataframe[table_name] = daily_20190702[table_name]
print("日线行情-时间为序  daily_20190702 返回数据 row 行数 = "+str(daily_20190702.shape[0]))
daily_20190702_addname_dataframe.to_excel(daily_201907_excel_writer,'2_2',index=False)
daily_201907_excel_writer.save()
daily_20190703 = pro.daily(start_date='',end_date='',trade_date='20190703', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20190703_tscode_list = list() 
for ts_code_sh in daily_20190703['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20190703_tscode_list.append(stock_name)
daily_20190703_addname_dataframe=pd.DataFrame()
daily_20190703_addname_dataframe['cname'] = daily_20190703_tscode_list
for table_name in daily_20190703.columns.values.tolist():
    daily_20190703_addname_dataframe[table_name] = daily_20190703[table_name]
print("日线行情-时间为序  daily_20190703 返回数据 row 行数 = "+str(daily_20190703.shape[0]))
daily_20190703_addname_dataframe.to_excel(daily_201907_excel_writer,'3_3',index=False)
daily_201907_excel_writer.save()
daily_20190704 = pro.daily(start_date='',end_date='',trade_date='20190704', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20190704_tscode_list = list() 
for ts_code_sh in daily_20190704['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20190704_tscode_list.append(stock_name)
daily_20190704_addname_dataframe=pd.DataFrame()
daily_20190704_addname_dataframe['cname'] = daily_20190704_tscode_list
for table_name in daily_20190704.columns.values.tolist():
    daily_20190704_addname_dataframe[table_name] = daily_20190704[table_name]
print("日线行情-时间为序  daily_20190704 返回数据 row 行数 = "+str(daily_20190704.shape[0]))
daily_20190704_addname_dataframe.to_excel(daily_201907_excel_writer,'4_4',index=False)
daily_201907_excel_writer.save()
daily_20190705 = pro.daily(start_date='',end_date='',trade_date='20190705', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20190705_tscode_list = list() 
for ts_code_sh in daily_20190705['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20190705_tscode_list.append(stock_name)
daily_20190705_addname_dataframe=pd.DataFrame()
daily_20190705_addname_dataframe['cname'] = daily_20190705_tscode_list
for table_name in daily_20190705.columns.values.tolist():
    daily_20190705_addname_dataframe[table_name] = daily_20190705[table_name]
print("日线行情-时间为序  daily_20190705 返回数据 row 行数 = "+str(daily_20190705.shape[0]))
daily_20190705_addname_dataframe.to_excel(daily_201907_excel_writer,'5_5',index=False)
daily_201907_excel_writer.save()
daily_20190708 = pro.daily(start_date='',end_date='',trade_date='20190708', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20190708_tscode_list = list() 
for ts_code_sh in daily_20190708['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20190708_tscode_list.append(stock_name)
daily_20190708_addname_dataframe=pd.DataFrame()
daily_20190708_addname_dataframe['cname'] = daily_20190708_tscode_list
for table_name in daily_20190708.columns.values.tolist():
    daily_20190708_addname_dataframe[table_name] = daily_20190708[table_name]
print("日线行情-时间为序  daily_20190708 返回数据 row 行数 = "+str(daily_20190708.shape[0]))
daily_20190708_addname_dataframe.to_excel(daily_201907_excel_writer,'8_1',index=False)
daily_201907_excel_writer.save()
daily_20190709 = pro.daily(start_date='',end_date='',trade_date='20190709', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20190709_tscode_list = list() 
for ts_code_sh in daily_20190709['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20190709_tscode_list.append(stock_name)
daily_20190709_addname_dataframe=pd.DataFrame()
daily_20190709_addname_dataframe['cname'] = daily_20190709_tscode_list
for table_name in daily_20190709.columns.values.tolist():
    daily_20190709_addname_dataframe[table_name] = daily_20190709[table_name]
print("日线行情-时间为序  daily_20190709 返回数据 row 行数 = "+str(daily_20190709.shape[0]))
daily_20190709_addname_dataframe.to_excel(daily_201907_excel_writer,'9_2',index=False)
daily_201907_excel_writer.save()
daily_20190710 = pro.daily(start_date='',end_date='',trade_date='20190710', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20190710_tscode_list = list() 
for ts_code_sh in daily_20190710['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20190710_tscode_list.append(stock_name)
daily_20190710_addname_dataframe=pd.DataFrame()
daily_20190710_addname_dataframe['cname'] = daily_20190710_tscode_list
for table_name in daily_20190710.columns.values.tolist():
    daily_20190710_addname_dataframe[table_name] = daily_20190710[table_name]
print("日线行情-时间为序  daily_20190710 返回数据 row 行数 = "+str(daily_20190710.shape[0]))
daily_20190710_addname_dataframe.to_excel(daily_201907_excel_writer,'10_3',index=False)
daily_201907_excel_writer.save()
daily_20190711 = pro.daily(start_date='',end_date='',trade_date='20190711', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20190711_tscode_list = list() 
for ts_code_sh in daily_20190711['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20190711_tscode_list.append(stock_name)
daily_20190711_addname_dataframe=pd.DataFrame()
daily_20190711_addname_dataframe['cname'] = daily_20190711_tscode_list
for table_name in daily_20190711.columns.values.tolist():
    daily_20190711_addname_dataframe[table_name] = daily_20190711[table_name]
print("日线行情-时间为序  daily_20190711 返回数据 row 行数 = "+str(daily_20190711.shape[0]))
daily_20190711_addname_dataframe.to_excel(daily_201907_excel_writer,'11_4',index=False)
daily_201907_excel_writer.save()
daily_20190712 = pro.daily(start_date='',end_date='',trade_date='20190712', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20190712_tscode_list = list() 
for ts_code_sh in daily_20190712['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20190712_tscode_list.append(stock_name)
daily_20190712_addname_dataframe=pd.DataFrame()
daily_20190712_addname_dataframe['cname'] = daily_20190712_tscode_list
for table_name in daily_20190712.columns.values.tolist():
    daily_20190712_addname_dataframe[table_name] = daily_20190712[table_name]
print("日线行情-时间为序  daily_20190712 返回数据 row 行数 = "+str(daily_20190712.shape[0]))
daily_20190712_addname_dataframe.to_excel(daily_201907_excel_writer,'12_5',index=False)
daily_201907_excel_writer.save()
daily_20190715 = pro.daily(start_date='',end_date='',trade_date='20190715', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20190715_tscode_list = list() 
for ts_code_sh in daily_20190715['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20190715_tscode_list.append(stock_name)
daily_20190715_addname_dataframe=pd.DataFrame()
daily_20190715_addname_dataframe['cname'] = daily_20190715_tscode_list
for table_name in daily_20190715.columns.values.tolist():
    daily_20190715_addname_dataframe[table_name] = daily_20190715[table_name]
print("日线行情-时间为序  daily_20190715 返回数据 row 行数 = "+str(daily_20190715.shape[0]))
daily_20190715_addname_dataframe.to_excel(daily_201907_excel_writer,'15_1',index=False)
daily_201907_excel_writer.save()
daily_20190716 = pro.daily(start_date='',end_date='',trade_date='20190716', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20190716_tscode_list = list() 
for ts_code_sh in daily_20190716['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20190716_tscode_list.append(stock_name)
daily_20190716_addname_dataframe=pd.DataFrame()
daily_20190716_addname_dataframe['cname'] = daily_20190716_tscode_list
for table_name in daily_20190716.columns.values.tolist():
    daily_20190716_addname_dataframe[table_name] = daily_20190716[table_name]
print("日线行情-时间为序  daily_20190716 返回数据 row 行数 = "+str(daily_20190716.shape[0]))
daily_20190716_addname_dataframe.to_excel(daily_201907_excel_writer,'16_2',index=False)
daily_201907_excel_writer.save()
daily_20190717 = pro.daily(start_date='',end_date='',trade_date='20190717', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20190717_tscode_list = list() 
for ts_code_sh in daily_20190717['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20190717_tscode_list.append(stock_name)
daily_20190717_addname_dataframe=pd.DataFrame()
daily_20190717_addname_dataframe['cname'] = daily_20190717_tscode_list
for table_name in daily_20190717.columns.values.tolist():
    daily_20190717_addname_dataframe[table_name] = daily_20190717[table_name]
print("日线行情-时间为序  daily_20190717 返回数据 row 行数 = "+str(daily_20190717.shape[0]))
daily_20190717_addname_dataframe.to_excel(daily_201907_excel_writer,'17_3',index=False)
daily_201907_excel_writer.save()
daily_20190718 = pro.daily(start_date='',end_date='',trade_date='20190718', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20190718_tscode_list = list() 
for ts_code_sh in daily_20190718['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20190718_tscode_list.append(stock_name)
daily_20190718_addname_dataframe=pd.DataFrame()
daily_20190718_addname_dataframe['cname'] = daily_20190718_tscode_list
for table_name in daily_20190718.columns.values.tolist():
    daily_20190718_addname_dataframe[table_name] = daily_20190718[table_name]
print("日线行情-时间为序  daily_20190718 返回数据 row 行数 = "+str(daily_20190718.shape[0]))
daily_20190718_addname_dataframe.to_excel(daily_201907_excel_writer,'18_4',index=False)
daily_201907_excel_writer.save()
daily_20190719 = pro.daily(start_date='',end_date='',trade_date='20190719', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20190719_tscode_list = list() 
for ts_code_sh in daily_20190719['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20190719_tscode_list.append(stock_name)
daily_20190719_addname_dataframe=pd.DataFrame()
daily_20190719_addname_dataframe['cname'] = daily_20190719_tscode_list
for table_name in daily_20190719.columns.values.tolist():
    daily_20190719_addname_dataframe[table_name] = daily_20190719[table_name]
print("日线行情-时间为序  daily_20190719 返回数据 row 行数 = "+str(daily_20190719.shape[0]))
daily_20190719_addname_dataframe.to_excel(daily_201907_excel_writer,'19_5',index=False)
daily_201907_excel_writer.save()
daily_20190722 = pro.daily(start_date='',end_date='',trade_date='20190722', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20190722_tscode_list = list() 
for ts_code_sh in daily_20190722['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20190722_tscode_list.append(stock_name)
daily_20190722_addname_dataframe=pd.DataFrame()
daily_20190722_addname_dataframe['cname'] = daily_20190722_tscode_list
for table_name in daily_20190722.columns.values.tolist():
    daily_20190722_addname_dataframe[table_name] = daily_20190722[table_name]
print("日线行情-时间为序  daily_20190722 返回数据 row 行数 = "+str(daily_20190722.shape[0]))
daily_20190722_addname_dataframe.to_excel(daily_201907_excel_writer,'22_1',index=False)
daily_201907_excel_writer.save()
daily_20190723 = pro.daily(start_date='',end_date='',trade_date='20190723', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20190723_tscode_list = list() 
for ts_code_sh in daily_20190723['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20190723_tscode_list.append(stock_name)
daily_20190723_addname_dataframe=pd.DataFrame()
daily_20190723_addname_dataframe['cname'] = daily_20190723_tscode_list
for table_name in daily_20190723.columns.values.tolist():
    daily_20190723_addname_dataframe[table_name] = daily_20190723[table_name]
print("日线行情-时间为序  daily_20190723 返回数据 row 行数 = "+str(daily_20190723.shape[0]))
daily_20190723_addname_dataframe.to_excel(daily_201907_excel_writer,'23_2',index=False)
daily_201907_excel_writer.save()
daily_20190724 = pro.daily(start_date='',end_date='',trade_date='20190724', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20190724_tscode_list = list() 
for ts_code_sh in daily_20190724['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20190724_tscode_list.append(stock_name)
daily_20190724_addname_dataframe=pd.DataFrame()
daily_20190724_addname_dataframe['cname'] = daily_20190724_tscode_list
for table_name in daily_20190724.columns.values.tolist():
    daily_20190724_addname_dataframe[table_name] = daily_20190724[table_name]
print("日线行情-时间为序  daily_20190724 返回数据 row 行数 = "+str(daily_20190724.shape[0]))
daily_20190724_addname_dataframe.to_excel(daily_201907_excel_writer,'24_3',index=False)
daily_201907_excel_writer.save()
daily_20190725 = pro.daily(start_date='',end_date='',trade_date='20190725', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20190725_tscode_list = list() 
for ts_code_sh in daily_20190725['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20190725_tscode_list.append(stock_name)
daily_20190725_addname_dataframe=pd.DataFrame()
daily_20190725_addname_dataframe['cname'] = daily_20190725_tscode_list
for table_name in daily_20190725.columns.values.tolist():
    daily_20190725_addname_dataframe[table_name] = daily_20190725[table_name]
print("日线行情-时间为序  daily_20190725 返回数据 row 行数 = "+str(daily_20190725.shape[0]))
daily_20190725_addname_dataframe.to_excel(daily_201907_excel_writer,'25_4',index=False)
daily_201907_excel_writer.save()
daily_20190726 = pro.daily(start_date='',end_date='',trade_date='20190726', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20190726_tscode_list = list() 
for ts_code_sh in daily_20190726['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20190726_tscode_list.append(stock_name)
daily_20190726_addname_dataframe=pd.DataFrame()
daily_20190726_addname_dataframe['cname'] = daily_20190726_tscode_list
for table_name in daily_20190726.columns.values.tolist():
    daily_20190726_addname_dataframe[table_name] = daily_20190726[table_name]
print("日线行情-时间为序  daily_20190726 返回数据 row 行数 = "+str(daily_20190726.shape[0]))
daily_20190726_addname_dataframe.to_excel(daily_201907_excel_writer,'26_5',index=False)
daily_201907_excel_writer.save()
daily_20190729 = pro.daily(start_date='',end_date='',trade_date='20190729', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20190729_tscode_list = list() 
for ts_code_sh in daily_20190729['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20190729_tscode_list.append(stock_name)
daily_20190729_addname_dataframe=pd.DataFrame()
daily_20190729_addname_dataframe['cname'] = daily_20190729_tscode_list
for table_name in daily_20190729.columns.values.tolist():
    daily_20190729_addname_dataframe[table_name] = daily_20190729[table_name]
print("日线行情-时间为序  daily_20190729 返回数据 row 行数 = "+str(daily_20190729.shape[0]))
daily_20190729_addname_dataframe.to_excel(daily_201907_excel_writer,'29_1',index=False)
daily_201907_excel_writer.save()
daily_20190730 = pro.daily(start_date='',end_date='',trade_date='20190730', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20190730_tscode_list = list() 
for ts_code_sh in daily_20190730['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20190730_tscode_list.append(stock_name)
daily_20190730_addname_dataframe=pd.DataFrame()
daily_20190730_addname_dataframe['cname'] = daily_20190730_tscode_list
for table_name in daily_20190730.columns.values.tolist():
    daily_20190730_addname_dataframe[table_name] = daily_20190730[table_name]
print("日线行情-时间为序  daily_20190730 返回数据 row 行数 = "+str(daily_20190730.shape[0]))
daily_20190730_addname_dataframe.to_excel(daily_201907_excel_writer,'30_2',index=False)
daily_201907_excel_writer.save()
daily_20190731 = pro.daily(start_date='',end_date='',trade_date='20190731', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20190731_tscode_list = list() 
for ts_code_sh in daily_20190731['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20190731_tscode_list.append(stock_name)
daily_20190731_addname_dataframe=pd.DataFrame()
daily_20190731_addname_dataframe['cname'] = daily_20190731_tscode_list
for table_name in daily_20190731.columns.values.tolist():
    daily_20190731_addname_dataframe[table_name] = daily_20190731[table_name]
print("日线行情-时间为序  daily_20190731 返回数据 row 行数 = "+str(daily_20190731.shape[0]))
daily_20190731_addname_dataframe.to_excel(daily_201907_excel_writer,'31_3',index=False)
daily_201907_excel_writer.save()




createexcel('daily_201908.xlsx')
daily_201908_book = load_workbook('C:\\Users\\zhuzj5\\Desktop\\zbin\\J0_Data\\daily_201908.xlsx')
daily_201908_excel_writer = pd.ExcelWriter('C:\\Users\\zhuzj5\\Desktop\\zbin\\J0_Data\\daily_201908.xlsx', engine='openpyxl')
daily_201908_excel_writer.book = daily_201908_book
daily_201908_excel_writer.sheets = dict((ws.title, ws) for ws in daily_201908_book.worksheets)
J0_PROPS.put(tree_node_name+"record_date", "20190801")       ###  更新 记录日期
daily_20190801 = pro.daily(start_date='',end_date='',trade_date='20190801', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20190801_tscode_list = list() 
for ts_code_sh in daily_20190801['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20190801_tscode_list.append(stock_name)
daily_20190801_addname_dataframe=pd.DataFrame()
daily_20190801_addname_dataframe['cname'] = daily_20190801_tscode_list
for table_name in daily_20190801.columns.values.tolist():
    daily_20190801_addname_dataframe[table_name] = daily_20190801[table_name]
print("日线行情-时间为序  daily_20190801 返回数据 row 行数 = "+str(daily_20190801.shape[0]))
daily_20190801_addname_dataframe.to_excel(daily_201908_excel_writer,'1_4',index=False)
daily_201908_excel_writer.save()
daily_20190802 = pro.daily(start_date='',end_date='',trade_date='20190802', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20190802_tscode_list = list() 
for ts_code_sh in daily_20190802['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20190802_tscode_list.append(stock_name)
daily_20190802_addname_dataframe=pd.DataFrame()
daily_20190802_addname_dataframe['cname'] = daily_20190802_tscode_list
for table_name in daily_20190802.columns.values.tolist():
    daily_20190802_addname_dataframe[table_name] = daily_20190802[table_name]
print("日线行情-时间为序  daily_20190802 返回数据 row 行数 = "+str(daily_20190802.shape[0]))
daily_20190802_addname_dataframe.to_excel(daily_201908_excel_writer,'2_5',index=False)
daily_201908_excel_writer.save()
daily_20190805 = pro.daily(start_date='',end_date='',trade_date='20190805', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20190805_tscode_list = list() 
for ts_code_sh in daily_20190805['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20190805_tscode_list.append(stock_name)
daily_20190805_addname_dataframe=pd.DataFrame()
daily_20190805_addname_dataframe['cname'] = daily_20190805_tscode_list
for table_name in daily_20190805.columns.values.tolist():
    daily_20190805_addname_dataframe[table_name] = daily_20190805[table_name]
print("日线行情-时间为序  daily_20190805 返回数据 row 行数 = "+str(daily_20190805.shape[0]))
daily_20190805_addname_dataframe.to_excel(daily_201908_excel_writer,'5_1',index=False)
daily_201908_excel_writer.save()
daily_20190806 = pro.daily(start_date='',end_date='',trade_date='20190806', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20190806_tscode_list = list() 
for ts_code_sh in daily_20190806['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20190806_tscode_list.append(stock_name)
daily_20190806_addname_dataframe=pd.DataFrame()
daily_20190806_addname_dataframe['cname'] = daily_20190806_tscode_list
for table_name in daily_20190806.columns.values.tolist():
    daily_20190806_addname_dataframe[table_name] = daily_20190806[table_name]
print("日线行情-时间为序  daily_20190806 返回数据 row 行数 = "+str(daily_20190806.shape[0]))
daily_20190806_addname_dataframe.to_excel(daily_201908_excel_writer,'6_2',index=False)
daily_201908_excel_writer.save()
daily_20190807 = pro.daily(start_date='',end_date='',trade_date='20190807', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20190807_tscode_list = list() 
for ts_code_sh in daily_20190807['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20190807_tscode_list.append(stock_name)
daily_20190807_addname_dataframe=pd.DataFrame()
daily_20190807_addname_dataframe['cname'] = daily_20190807_tscode_list
for table_name in daily_20190807.columns.values.tolist():
    daily_20190807_addname_dataframe[table_name] = daily_20190807[table_name]
print("日线行情-时间为序  daily_20190807 返回数据 row 行数 = "+str(daily_20190807.shape[0]))
daily_20190807_addname_dataframe.to_excel(daily_201908_excel_writer,'7_3',index=False)
daily_201908_excel_writer.save()
daily_20190808 = pro.daily(start_date='',end_date='',trade_date='20190808', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20190808_tscode_list = list() 
for ts_code_sh in daily_20190808['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20190808_tscode_list.append(stock_name)
daily_20190808_addname_dataframe=pd.DataFrame()
daily_20190808_addname_dataframe['cname'] = daily_20190808_tscode_list
for table_name in daily_20190808.columns.values.tolist():
    daily_20190808_addname_dataframe[table_name] = daily_20190808[table_name]
print("日线行情-时间为序  daily_20190808 返回数据 row 行数 = "+str(daily_20190808.shape[0]))
daily_20190808_addname_dataframe.to_excel(daily_201908_excel_writer,'8_4',index=False)
daily_201908_excel_writer.save()
daily_20190809 = pro.daily(start_date='',end_date='',trade_date='20190809', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20190809_tscode_list = list() 
for ts_code_sh in daily_20190809['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20190809_tscode_list.append(stock_name)
daily_20190809_addname_dataframe=pd.DataFrame()
daily_20190809_addname_dataframe['cname'] = daily_20190809_tscode_list
for table_name in daily_20190809.columns.values.tolist():
    daily_20190809_addname_dataframe[table_name] = daily_20190809[table_name]
print("日线行情-时间为序  daily_20190809 返回数据 row 行数 = "+str(daily_20190809.shape[0]))
daily_20190809_addname_dataframe.to_excel(daily_201908_excel_writer,'9_5',index=False)
daily_201908_excel_writer.save()
daily_20190812 = pro.daily(start_date='',end_date='',trade_date='20190812', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20190812_tscode_list = list() 
for ts_code_sh in daily_20190812['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20190812_tscode_list.append(stock_name)
daily_20190812_addname_dataframe=pd.DataFrame()
daily_20190812_addname_dataframe['cname'] = daily_20190812_tscode_list
for table_name in daily_20190812.columns.values.tolist():
    daily_20190812_addname_dataframe[table_name] = daily_20190812[table_name]
print("日线行情-时间为序  daily_20190812 返回数据 row 行数 = "+str(daily_20190812.shape[0]))
daily_20190812_addname_dataframe.to_excel(daily_201908_excel_writer,'12_1',index=False)
daily_201908_excel_writer.save()
daily_20190813 = pro.daily(start_date='',end_date='',trade_date='20190813', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20190813_tscode_list = list() 
for ts_code_sh in daily_20190813['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20190813_tscode_list.append(stock_name)
daily_20190813_addname_dataframe=pd.DataFrame()
daily_20190813_addname_dataframe['cname'] = daily_20190813_tscode_list
for table_name in daily_20190813.columns.values.tolist():
    daily_20190813_addname_dataframe[table_name] = daily_20190813[table_name]
print("日线行情-时间为序  daily_20190813 返回数据 row 行数 = "+str(daily_20190813.shape[0]))
daily_20190813_addname_dataframe.to_excel(daily_201908_excel_writer,'13_2',index=False)
daily_201908_excel_writer.save()
daily_20190814 = pro.daily(start_date='',end_date='',trade_date='20190814', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20190814_tscode_list = list() 
for ts_code_sh in daily_20190814['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20190814_tscode_list.append(stock_name)
daily_20190814_addname_dataframe=pd.DataFrame()
daily_20190814_addname_dataframe['cname'] = daily_20190814_tscode_list
for table_name in daily_20190814.columns.values.tolist():
    daily_20190814_addname_dataframe[table_name] = daily_20190814[table_name]
print("日线行情-时间为序  daily_20190814 返回数据 row 行数 = "+str(daily_20190814.shape[0]))
daily_20190814_addname_dataframe.to_excel(daily_201908_excel_writer,'14_3',index=False)
daily_201908_excel_writer.save()
daily_20190815 = pro.daily(start_date='',end_date='',trade_date='20190815', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20190815_tscode_list = list() 
for ts_code_sh in daily_20190815['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20190815_tscode_list.append(stock_name)
daily_20190815_addname_dataframe=pd.DataFrame()
daily_20190815_addname_dataframe['cname'] = daily_20190815_tscode_list
for table_name in daily_20190815.columns.values.tolist():
    daily_20190815_addname_dataframe[table_name] = daily_20190815[table_name]
print("日线行情-时间为序  daily_20190815 返回数据 row 行数 = "+str(daily_20190815.shape[0]))
daily_20190815_addname_dataframe.to_excel(daily_201908_excel_writer,'15_4',index=False)
daily_201908_excel_writer.save()
daily_20190816 = pro.daily(start_date='',end_date='',trade_date='20190816', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20190816_tscode_list = list() 
for ts_code_sh in daily_20190816['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20190816_tscode_list.append(stock_name)
daily_20190816_addname_dataframe=pd.DataFrame()
daily_20190816_addname_dataframe['cname'] = daily_20190816_tscode_list
for table_name in daily_20190816.columns.values.tolist():
    daily_20190816_addname_dataframe[table_name] = daily_20190816[table_name]
print("日线行情-时间为序  daily_20190816 返回数据 row 行数 = "+str(daily_20190816.shape[0]))
daily_20190816_addname_dataframe.to_excel(daily_201908_excel_writer,'16_5',index=False)
daily_201908_excel_writer.save()
daily_20190819 = pro.daily(start_date='',end_date='',trade_date='20190819', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20190819_tscode_list = list() 
for ts_code_sh in daily_20190819['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20190819_tscode_list.append(stock_name)
daily_20190819_addname_dataframe=pd.DataFrame()
daily_20190819_addname_dataframe['cname'] = daily_20190819_tscode_list
for table_name in daily_20190819.columns.values.tolist():
    daily_20190819_addname_dataframe[table_name] = daily_20190819[table_name]
print("日线行情-时间为序  daily_20190819 返回数据 row 行数 = "+str(daily_20190819.shape[0]))
daily_20190819_addname_dataframe.to_excel(daily_201908_excel_writer,'19_1',index=False)
daily_201908_excel_writer.save()
daily_20190820 = pro.daily(start_date='',end_date='',trade_date='20190820', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20190820_tscode_list = list() 
for ts_code_sh in daily_20190820['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20190820_tscode_list.append(stock_name)
daily_20190820_addname_dataframe=pd.DataFrame()
daily_20190820_addname_dataframe['cname'] = daily_20190820_tscode_list
for table_name in daily_20190820.columns.values.tolist():
    daily_20190820_addname_dataframe[table_name] = daily_20190820[table_name]
print("日线行情-时间为序  daily_20190820 返回数据 row 行数 = "+str(daily_20190820.shape[0]))
daily_20190820_addname_dataframe.to_excel(daily_201908_excel_writer,'20_2',index=False)
daily_201908_excel_writer.save()
daily_20190821 = pro.daily(start_date='',end_date='',trade_date='20190821', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20190821_tscode_list = list() 
for ts_code_sh in daily_20190821['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20190821_tscode_list.append(stock_name)
daily_20190821_addname_dataframe=pd.DataFrame()
daily_20190821_addname_dataframe['cname'] = daily_20190821_tscode_list
for table_name in daily_20190821.columns.values.tolist():
    daily_20190821_addname_dataframe[table_name] = daily_20190821[table_name]
print("日线行情-时间为序  daily_20190821 返回数据 row 行数 = "+str(daily_20190821.shape[0]))
daily_20190821_addname_dataframe.to_excel(daily_201908_excel_writer,'21_3',index=False)
daily_201908_excel_writer.save()
daily_20190822 = pro.daily(start_date='',end_date='',trade_date='20190822', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20190822_tscode_list = list() 
for ts_code_sh in daily_20190822['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20190822_tscode_list.append(stock_name)
daily_20190822_addname_dataframe=pd.DataFrame()
daily_20190822_addname_dataframe['cname'] = daily_20190822_tscode_list
for table_name in daily_20190822.columns.values.tolist():
    daily_20190822_addname_dataframe[table_name] = daily_20190822[table_name]
print("日线行情-时间为序  daily_20190822 返回数据 row 行数 = "+str(daily_20190822.shape[0]))
daily_20190822_addname_dataframe.to_excel(daily_201908_excel_writer,'22_4',index=False)
daily_201908_excel_writer.save()
daily_20190823 = pro.daily(start_date='',end_date='',trade_date='20190823', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20190823_tscode_list = list() 
for ts_code_sh in daily_20190823['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20190823_tscode_list.append(stock_name)
daily_20190823_addname_dataframe=pd.DataFrame()
daily_20190823_addname_dataframe['cname'] = daily_20190823_tscode_list
for table_name in daily_20190823.columns.values.tolist():
    daily_20190823_addname_dataframe[table_name] = daily_20190823[table_name]
print("日线行情-时间为序  daily_20190823 返回数据 row 行数 = "+str(daily_20190823.shape[0]))
daily_20190823_addname_dataframe.to_excel(daily_201908_excel_writer,'23_5',index=False)
daily_201908_excel_writer.save()
daily_20190826 = pro.daily(start_date='',end_date='',trade_date='20190826', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20190826_tscode_list = list() 
for ts_code_sh in daily_20190826['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20190826_tscode_list.append(stock_name)
daily_20190826_addname_dataframe=pd.DataFrame()
daily_20190826_addname_dataframe['cname'] = daily_20190826_tscode_list
for table_name in daily_20190826.columns.values.tolist():
    daily_20190826_addname_dataframe[table_name] = daily_20190826[table_name]
print("日线行情-时间为序  daily_20190826 返回数据 row 行数 = "+str(daily_20190826.shape[0]))
daily_20190826_addname_dataframe.to_excel(daily_201908_excel_writer,'26_1',index=False)
daily_201908_excel_writer.save()
daily_20190827 = pro.daily(start_date='',end_date='',trade_date='20190827', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20190827_tscode_list = list() 
for ts_code_sh in daily_20190827['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20190827_tscode_list.append(stock_name)
daily_20190827_addname_dataframe=pd.DataFrame()
daily_20190827_addname_dataframe['cname'] = daily_20190827_tscode_list
for table_name in daily_20190827.columns.values.tolist():
    daily_20190827_addname_dataframe[table_name] = daily_20190827[table_name]
print("日线行情-时间为序  daily_20190827 返回数据 row 行数 = "+str(daily_20190827.shape[0]))
daily_20190827_addname_dataframe.to_excel(daily_201908_excel_writer,'27_2',index=False)
daily_201908_excel_writer.save()
daily_20190828 = pro.daily(start_date='',end_date='',trade_date='20190828', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20190828_tscode_list = list() 
for ts_code_sh in daily_20190828['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20190828_tscode_list.append(stock_name)
daily_20190828_addname_dataframe=pd.DataFrame()
daily_20190828_addname_dataframe['cname'] = daily_20190828_tscode_list
for table_name in daily_20190828.columns.values.tolist():
    daily_20190828_addname_dataframe[table_name] = daily_20190828[table_name]
print("日线行情-时间为序  daily_20190828 返回数据 row 行数 = "+str(daily_20190828.shape[0]))
daily_20190828_addname_dataframe.to_excel(daily_201908_excel_writer,'28_3',index=False)
daily_201908_excel_writer.save()
daily_20190829 = pro.daily(start_date='',end_date='',trade_date='20190829', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20190829_tscode_list = list() 
for ts_code_sh in daily_20190829['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20190829_tscode_list.append(stock_name)
daily_20190829_addname_dataframe=pd.DataFrame()
daily_20190829_addname_dataframe['cname'] = daily_20190829_tscode_list
for table_name in daily_20190829.columns.values.tolist():
    daily_20190829_addname_dataframe[table_name] = daily_20190829[table_name]
print("日线行情-时间为序  daily_20190829 返回数据 row 行数 = "+str(daily_20190829.shape[0]))
daily_20190829_addname_dataframe.to_excel(daily_201908_excel_writer,'29_4',index=False)
daily_201908_excel_writer.save()
daily_20190830 = pro.daily(start_date='',end_date='',trade_date='20190830', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20190830_tscode_list = list() 
for ts_code_sh in daily_20190830['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20190830_tscode_list.append(stock_name)
daily_20190830_addname_dataframe=pd.DataFrame()
daily_20190830_addname_dataframe['cname'] = daily_20190830_tscode_list
for table_name in daily_20190830.columns.values.tolist():
    daily_20190830_addname_dataframe[table_name] = daily_20190830[table_name]
print("日线行情-时间为序  daily_20190830 返回数据 row 行数 = "+str(daily_20190830.shape[0]))
daily_20190830_addname_dataframe.to_excel(daily_201908_excel_writer,'30_5',index=False)
daily_201908_excel_writer.save()




createexcel('daily_201909.xlsx')
daily_201909_book = load_workbook('C:\\Users\\zhuzj5\\Desktop\\zbin\\J0_Data\\daily_201909.xlsx')
daily_201909_excel_writer = pd.ExcelWriter('C:\\Users\\zhuzj5\\Desktop\\zbin\\J0_Data\\daily_201909.xlsx', engine='openpyxl')
daily_201909_excel_writer.book = daily_201909_book
daily_201909_excel_writer.sheets = dict((ws.title, ws) for ws in daily_201909_book.worksheets)
J0_PROPS.put(tree_node_name+"record_date", "20190901")       ###  更新 记录日期
daily_20190902 = pro.daily(start_date='',end_date='',trade_date='20190902', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20190902_tscode_list = list() 
for ts_code_sh in daily_20190902['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20190902_tscode_list.append(stock_name)
daily_20190902_addname_dataframe=pd.DataFrame()
daily_20190902_addname_dataframe['cname'] = daily_20190902_tscode_list
for table_name in daily_20190902.columns.values.tolist():
    daily_20190902_addname_dataframe[table_name] = daily_20190902[table_name]
print("日线行情-时间为序  daily_20190902 返回数据 row 行数 = "+str(daily_20190902.shape[0]))
daily_20190902_addname_dataframe.to_excel(daily_201909_excel_writer,'2_1',index=False)
daily_201909_excel_writer.save()
daily_20190903 = pro.daily(start_date='',end_date='',trade_date='20190903', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20190903_tscode_list = list() 
for ts_code_sh in daily_20190903['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20190903_tscode_list.append(stock_name)
daily_20190903_addname_dataframe=pd.DataFrame()
daily_20190903_addname_dataframe['cname'] = daily_20190903_tscode_list
for table_name in daily_20190903.columns.values.tolist():
    daily_20190903_addname_dataframe[table_name] = daily_20190903[table_name]
print("日线行情-时间为序  daily_20190903 返回数据 row 行数 = "+str(daily_20190903.shape[0]))
daily_20190903_addname_dataframe.to_excel(daily_201909_excel_writer,'3_2',index=False)
daily_201909_excel_writer.save()
daily_20190904 = pro.daily(start_date='',end_date='',trade_date='20190904', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20190904_tscode_list = list() 
for ts_code_sh in daily_20190904['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20190904_tscode_list.append(stock_name)
daily_20190904_addname_dataframe=pd.DataFrame()
daily_20190904_addname_dataframe['cname'] = daily_20190904_tscode_list
for table_name in daily_20190904.columns.values.tolist():
    daily_20190904_addname_dataframe[table_name] = daily_20190904[table_name]
print("日线行情-时间为序  daily_20190904 返回数据 row 行数 = "+str(daily_20190904.shape[0]))
daily_20190904_addname_dataframe.to_excel(daily_201909_excel_writer,'4_3',index=False)
daily_201909_excel_writer.save()
daily_20190905 = pro.daily(start_date='',end_date='',trade_date='20190905', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20190905_tscode_list = list() 
for ts_code_sh in daily_20190905['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20190905_tscode_list.append(stock_name)
daily_20190905_addname_dataframe=pd.DataFrame()
daily_20190905_addname_dataframe['cname'] = daily_20190905_tscode_list
for table_name in daily_20190905.columns.values.tolist():
    daily_20190905_addname_dataframe[table_name] = daily_20190905[table_name]
print("日线行情-时间为序  daily_20190905 返回数据 row 行数 = "+str(daily_20190905.shape[0]))
daily_20190905_addname_dataframe.to_excel(daily_201909_excel_writer,'5_4',index=False)
daily_201909_excel_writer.save()
daily_20190906 = pro.daily(start_date='',end_date='',trade_date='20190906', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20190906_tscode_list = list() 
for ts_code_sh in daily_20190906['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20190906_tscode_list.append(stock_name)
daily_20190906_addname_dataframe=pd.DataFrame()
daily_20190906_addname_dataframe['cname'] = daily_20190906_tscode_list
for table_name in daily_20190906.columns.values.tolist():
    daily_20190906_addname_dataframe[table_name] = daily_20190906[table_name]
print("日线行情-时间为序  daily_20190906 返回数据 row 行数 = "+str(daily_20190906.shape[0]))
daily_20190906_addname_dataframe.to_excel(daily_201909_excel_writer,'6_5',index=False)
daily_201909_excel_writer.save()
daily_20190909 = pro.daily(start_date='',end_date='',trade_date='20190909', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20190909_tscode_list = list() 
for ts_code_sh in daily_20190909['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20190909_tscode_list.append(stock_name)
daily_20190909_addname_dataframe=pd.DataFrame()
daily_20190909_addname_dataframe['cname'] = daily_20190909_tscode_list
for table_name in daily_20190909.columns.values.tolist():
    daily_20190909_addname_dataframe[table_name] = daily_20190909[table_name]
print("日线行情-时间为序  daily_20190909 返回数据 row 行数 = "+str(daily_20190909.shape[0]))
daily_20190909_addname_dataframe.to_excel(daily_201909_excel_writer,'9_1',index=False)
daily_201909_excel_writer.save()
daily_20190910 = pro.daily(start_date='',end_date='',trade_date='20190910', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20190910_tscode_list = list() 
for ts_code_sh in daily_20190910['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20190910_tscode_list.append(stock_name)
daily_20190910_addname_dataframe=pd.DataFrame()
daily_20190910_addname_dataframe['cname'] = daily_20190910_tscode_list
for table_name in daily_20190910.columns.values.tolist():
    daily_20190910_addname_dataframe[table_name] = daily_20190910[table_name]
print("日线行情-时间为序  daily_20190910 返回数据 row 行数 = "+str(daily_20190910.shape[0]))
daily_20190910_addname_dataframe.to_excel(daily_201909_excel_writer,'10_2',index=False)
daily_201909_excel_writer.save()
daily_20190911 = pro.daily(start_date='',end_date='',trade_date='20190911', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20190911_tscode_list = list() 
for ts_code_sh in daily_20190911['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20190911_tscode_list.append(stock_name)
daily_20190911_addname_dataframe=pd.DataFrame()
daily_20190911_addname_dataframe['cname'] = daily_20190911_tscode_list
for table_name in daily_20190911.columns.values.tolist():
    daily_20190911_addname_dataframe[table_name] = daily_20190911[table_name]
print("日线行情-时间为序  daily_20190911 返回数据 row 行数 = "+str(daily_20190911.shape[0]))
daily_20190911_addname_dataframe.to_excel(daily_201909_excel_writer,'11_3',index=False)
daily_201909_excel_writer.save()
daily_20190912 = pro.daily(start_date='',end_date='',trade_date='20190912', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20190912_tscode_list = list() 
for ts_code_sh in daily_20190912['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20190912_tscode_list.append(stock_name)
daily_20190912_addname_dataframe=pd.DataFrame()
daily_20190912_addname_dataframe['cname'] = daily_20190912_tscode_list
for table_name in daily_20190912.columns.values.tolist():
    daily_20190912_addname_dataframe[table_name] = daily_20190912[table_name]
print("日线行情-时间为序  daily_20190912 返回数据 row 行数 = "+str(daily_20190912.shape[0]))
daily_20190912_addname_dataframe.to_excel(daily_201909_excel_writer,'12_4',index=False)
daily_201909_excel_writer.save()
daily_20190916 = pro.daily(start_date='',end_date='',trade_date='20190916', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20190916_tscode_list = list() 
for ts_code_sh in daily_20190916['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20190916_tscode_list.append(stock_name)
daily_20190916_addname_dataframe=pd.DataFrame()
daily_20190916_addname_dataframe['cname'] = daily_20190916_tscode_list
for table_name in daily_20190916.columns.values.tolist():
    daily_20190916_addname_dataframe[table_name] = daily_20190916[table_name]
print("日线行情-时间为序  daily_20190916 返回数据 row 行数 = "+str(daily_20190916.shape[0]))
daily_20190916_addname_dataframe.to_excel(daily_201909_excel_writer,'16_1',index=False)
daily_201909_excel_writer.save()
daily_20190917 = pro.daily(start_date='',end_date='',trade_date='20190917', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20190917_tscode_list = list() 
for ts_code_sh in daily_20190917['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20190917_tscode_list.append(stock_name)
daily_20190917_addname_dataframe=pd.DataFrame()
daily_20190917_addname_dataframe['cname'] = daily_20190917_tscode_list
for table_name in daily_20190917.columns.values.tolist():
    daily_20190917_addname_dataframe[table_name] = daily_20190917[table_name]
print("日线行情-时间为序  daily_20190917 返回数据 row 行数 = "+str(daily_20190917.shape[0]))
daily_20190917_addname_dataframe.to_excel(daily_201909_excel_writer,'17_2',index=False)
daily_201909_excel_writer.save()
daily_20190918 = pro.daily(start_date='',end_date='',trade_date='20190918', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20190918_tscode_list = list() 
for ts_code_sh in daily_20190918['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20190918_tscode_list.append(stock_name)
daily_20190918_addname_dataframe=pd.DataFrame()
daily_20190918_addname_dataframe['cname'] = daily_20190918_tscode_list
for table_name in daily_20190918.columns.values.tolist():
    daily_20190918_addname_dataframe[table_name] = daily_20190918[table_name]
print("日线行情-时间为序  daily_20190918 返回数据 row 行数 = "+str(daily_20190918.shape[0]))
daily_20190918_addname_dataframe.to_excel(daily_201909_excel_writer,'18_3',index=False)
daily_201909_excel_writer.save()
daily_20190919 = pro.daily(start_date='',end_date='',trade_date='20190919', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20190919_tscode_list = list() 
for ts_code_sh in daily_20190919['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20190919_tscode_list.append(stock_name)
daily_20190919_addname_dataframe=pd.DataFrame()
daily_20190919_addname_dataframe['cname'] = daily_20190919_tscode_list
for table_name in daily_20190919.columns.values.tolist():
    daily_20190919_addname_dataframe[table_name] = daily_20190919[table_name]
print("日线行情-时间为序  daily_20190919 返回数据 row 行数 = "+str(daily_20190919.shape[0]))
daily_20190919_addname_dataframe.to_excel(daily_201909_excel_writer,'19_4',index=False)
daily_201909_excel_writer.save()
daily_20190920 = pro.daily(start_date='',end_date='',trade_date='20190920', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20190920_tscode_list = list() 
for ts_code_sh in daily_20190920['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20190920_tscode_list.append(stock_name)
daily_20190920_addname_dataframe=pd.DataFrame()
daily_20190920_addname_dataframe['cname'] = daily_20190920_tscode_list
for table_name in daily_20190920.columns.values.tolist():
    daily_20190920_addname_dataframe[table_name] = daily_20190920[table_name]
print("日线行情-时间为序  daily_20190920 返回数据 row 行数 = "+str(daily_20190920.shape[0]))
daily_20190920_addname_dataframe.to_excel(daily_201909_excel_writer,'20_5',index=False)
daily_201909_excel_writer.save()
daily_20190923 = pro.daily(start_date='',end_date='',trade_date='20190923', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20190923_tscode_list = list() 
for ts_code_sh in daily_20190923['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20190923_tscode_list.append(stock_name)
daily_20190923_addname_dataframe=pd.DataFrame()
daily_20190923_addname_dataframe['cname'] = daily_20190923_tscode_list
for table_name in daily_20190923.columns.values.tolist():
    daily_20190923_addname_dataframe[table_name] = daily_20190923[table_name]
print("日线行情-时间为序  daily_20190923 返回数据 row 行数 = "+str(daily_20190923.shape[0]))
daily_20190923_addname_dataframe.to_excel(daily_201909_excel_writer,'23_1',index=False)
daily_201909_excel_writer.save()
daily_20190924 = pro.daily(start_date='',end_date='',trade_date='20190924', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20190924_tscode_list = list() 
for ts_code_sh in daily_20190924['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20190924_tscode_list.append(stock_name)
daily_20190924_addname_dataframe=pd.DataFrame()
daily_20190924_addname_dataframe['cname'] = daily_20190924_tscode_list
for table_name in daily_20190924.columns.values.tolist():
    daily_20190924_addname_dataframe[table_name] = daily_20190924[table_name]
print("日线行情-时间为序  daily_20190924 返回数据 row 行数 = "+str(daily_20190924.shape[0]))
daily_20190924_addname_dataframe.to_excel(daily_201909_excel_writer,'24_2',index=False)
daily_201909_excel_writer.save()
daily_20190925 = pro.daily(start_date='',end_date='',trade_date='20190925', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20190925_tscode_list = list() 
for ts_code_sh in daily_20190925['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20190925_tscode_list.append(stock_name)
daily_20190925_addname_dataframe=pd.DataFrame()
daily_20190925_addname_dataframe['cname'] = daily_20190925_tscode_list
for table_name in daily_20190925.columns.values.tolist():
    daily_20190925_addname_dataframe[table_name] = daily_20190925[table_name]
print("日线行情-时间为序  daily_20190925 返回数据 row 行数 = "+str(daily_20190925.shape[0]))
daily_20190925_addname_dataframe.to_excel(daily_201909_excel_writer,'25_3',index=False)
daily_201909_excel_writer.save()
daily_20190926 = pro.daily(start_date='',end_date='',trade_date='20190926', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20190926_tscode_list = list() 
for ts_code_sh in daily_20190926['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20190926_tscode_list.append(stock_name)
daily_20190926_addname_dataframe=pd.DataFrame()
daily_20190926_addname_dataframe['cname'] = daily_20190926_tscode_list
for table_name in daily_20190926.columns.values.tolist():
    daily_20190926_addname_dataframe[table_name] = daily_20190926[table_name]
print("日线行情-时间为序  daily_20190926 返回数据 row 行数 = "+str(daily_20190926.shape[0]))
daily_20190926_addname_dataframe.to_excel(daily_201909_excel_writer,'26_4',index=False)
daily_201909_excel_writer.save()
daily_20190927 = pro.daily(start_date='',end_date='',trade_date='20190927', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20190927_tscode_list = list() 
for ts_code_sh in daily_20190927['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20190927_tscode_list.append(stock_name)
daily_20190927_addname_dataframe=pd.DataFrame()
daily_20190927_addname_dataframe['cname'] = daily_20190927_tscode_list
for table_name in daily_20190927.columns.values.tolist():
    daily_20190927_addname_dataframe[table_name] = daily_20190927[table_name]
print("日线行情-时间为序  daily_20190927 返回数据 row 行数 = "+str(daily_20190927.shape[0]))
daily_20190927_addname_dataframe.to_excel(daily_201909_excel_writer,'27_5',index=False)
daily_201909_excel_writer.save()
daily_20190930 = pro.daily(start_date='',end_date='',trade_date='20190930', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20190930_tscode_list = list() 
for ts_code_sh in daily_20190930['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20190930_tscode_list.append(stock_name)
daily_20190930_addname_dataframe=pd.DataFrame()
daily_20190930_addname_dataframe['cname'] = daily_20190930_tscode_list
for table_name in daily_20190930.columns.values.tolist():
    daily_20190930_addname_dataframe[table_name] = daily_20190930[table_name]
print("日线行情-时间为序  daily_20190930 返回数据 row 行数 = "+str(daily_20190930.shape[0]))
daily_20190930_addname_dataframe.to_excel(daily_201909_excel_writer,'30_1',index=False)
daily_201909_excel_writer.save()




createexcel('daily_201910.xlsx')
daily_201910_book = load_workbook('C:\\Users\\zhuzj5\\Desktop\\zbin\\J0_Data\\daily_201910.xlsx')
daily_201910_excel_writer = pd.ExcelWriter('C:\\Users\\zhuzj5\\Desktop\\zbin\\J0_Data\\daily_201910.xlsx', engine='openpyxl')
daily_201910_excel_writer.book = daily_201910_book
daily_201910_excel_writer.sheets = dict((ws.title, ws) for ws in daily_201910_book.worksheets)
J0_PROPS.put(tree_node_name+"record_date", "20191001")       ###  更新 记录日期
daily_20191008 = pro.daily(start_date='',end_date='',trade_date='20191008', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20191008_tscode_list = list() 
for ts_code_sh in daily_20191008['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20191008_tscode_list.append(stock_name)
daily_20191008_addname_dataframe=pd.DataFrame()
daily_20191008_addname_dataframe['cname'] = daily_20191008_tscode_list
for table_name in daily_20191008.columns.values.tolist():
    daily_20191008_addname_dataframe[table_name] = daily_20191008[table_name]
print("日线行情-时间为序  daily_20191008 返回数据 row 行数 = "+str(daily_20191008.shape[0]))
daily_20191008_addname_dataframe.to_excel(daily_201910_excel_writer,'8_2',index=False)
daily_201910_excel_writer.save()
daily_20191009 = pro.daily(start_date='',end_date='',trade_date='20191009', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20191009_tscode_list = list() 
for ts_code_sh in daily_20191009['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20191009_tscode_list.append(stock_name)
daily_20191009_addname_dataframe=pd.DataFrame()
daily_20191009_addname_dataframe['cname'] = daily_20191009_tscode_list
for table_name in daily_20191009.columns.values.tolist():
    daily_20191009_addname_dataframe[table_name] = daily_20191009[table_name]
print("日线行情-时间为序  daily_20191009 返回数据 row 行数 = "+str(daily_20191009.shape[0]))
daily_20191009_addname_dataframe.to_excel(daily_201910_excel_writer,'9_3',index=False)
daily_201910_excel_writer.save()
daily_20191010 = pro.daily(start_date='',end_date='',trade_date='20191010', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20191010_tscode_list = list() 
for ts_code_sh in daily_20191010['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20191010_tscode_list.append(stock_name)
daily_20191010_addname_dataframe=pd.DataFrame()
daily_20191010_addname_dataframe['cname'] = daily_20191010_tscode_list
for table_name in daily_20191010.columns.values.tolist():
    daily_20191010_addname_dataframe[table_name] = daily_20191010[table_name]
print("日线行情-时间为序  daily_20191010 返回数据 row 行数 = "+str(daily_20191010.shape[0]))
daily_20191010_addname_dataframe.to_excel(daily_201910_excel_writer,'10_4',index=False)
daily_201910_excel_writer.save()
daily_20191011 = pro.daily(start_date='',end_date='',trade_date='20191011', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20191011_tscode_list = list() 
for ts_code_sh in daily_20191011['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20191011_tscode_list.append(stock_name)
daily_20191011_addname_dataframe=pd.DataFrame()
daily_20191011_addname_dataframe['cname'] = daily_20191011_tscode_list
for table_name in daily_20191011.columns.values.tolist():
    daily_20191011_addname_dataframe[table_name] = daily_20191011[table_name]
print("日线行情-时间为序  daily_20191011 返回数据 row 行数 = "+str(daily_20191011.shape[0]))
daily_20191011_addname_dataframe.to_excel(daily_201910_excel_writer,'11_5',index=False)
daily_201910_excel_writer.save()
daily_20191014 = pro.daily(start_date='',end_date='',trade_date='20191014', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20191014_tscode_list = list() 
for ts_code_sh in daily_20191014['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20191014_tscode_list.append(stock_name)
daily_20191014_addname_dataframe=pd.DataFrame()
daily_20191014_addname_dataframe['cname'] = daily_20191014_tscode_list
for table_name in daily_20191014.columns.values.tolist():
    daily_20191014_addname_dataframe[table_name] = daily_20191014[table_name]
print("日线行情-时间为序  daily_20191014 返回数据 row 行数 = "+str(daily_20191014.shape[0]))
daily_20191014_addname_dataframe.to_excel(daily_201910_excel_writer,'14_1',index=False)
daily_201910_excel_writer.save()
daily_20191015 = pro.daily(start_date='',end_date='',trade_date='20191015', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20191015_tscode_list = list() 
for ts_code_sh in daily_20191015['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20191015_tscode_list.append(stock_name)
daily_20191015_addname_dataframe=pd.DataFrame()
daily_20191015_addname_dataframe['cname'] = daily_20191015_tscode_list
for table_name in daily_20191015.columns.values.tolist():
    daily_20191015_addname_dataframe[table_name] = daily_20191015[table_name]
print("日线行情-时间为序  daily_20191015 返回数据 row 行数 = "+str(daily_20191015.shape[0]))
daily_20191015_addname_dataframe.to_excel(daily_201910_excel_writer,'15_2',index=False)
daily_201910_excel_writer.save()
daily_20191016 = pro.daily(start_date='',end_date='',trade_date='20191016', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20191016_tscode_list = list() 
for ts_code_sh in daily_20191016['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20191016_tscode_list.append(stock_name)
daily_20191016_addname_dataframe=pd.DataFrame()
daily_20191016_addname_dataframe['cname'] = daily_20191016_tscode_list
for table_name in daily_20191016.columns.values.tolist():
    daily_20191016_addname_dataframe[table_name] = daily_20191016[table_name]
print("日线行情-时间为序  daily_20191016 返回数据 row 行数 = "+str(daily_20191016.shape[0]))
daily_20191016_addname_dataframe.to_excel(daily_201910_excel_writer,'16_3',index=False)
daily_201910_excel_writer.save()
daily_20191017 = pro.daily(start_date='',end_date='',trade_date='20191017', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20191017_tscode_list = list() 
for ts_code_sh in daily_20191017['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20191017_tscode_list.append(stock_name)
daily_20191017_addname_dataframe=pd.DataFrame()
daily_20191017_addname_dataframe['cname'] = daily_20191017_tscode_list
for table_name in daily_20191017.columns.values.tolist():
    daily_20191017_addname_dataframe[table_name] = daily_20191017[table_name]
print("日线行情-时间为序  daily_20191017 返回数据 row 行数 = "+str(daily_20191017.shape[0]))
daily_20191017_addname_dataframe.to_excel(daily_201910_excel_writer,'17_4',index=False)
daily_201910_excel_writer.save()
daily_20191018 = pro.daily(start_date='',end_date='',trade_date='20191018', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20191018_tscode_list = list() 
for ts_code_sh in daily_20191018['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20191018_tscode_list.append(stock_name)
daily_20191018_addname_dataframe=pd.DataFrame()
daily_20191018_addname_dataframe['cname'] = daily_20191018_tscode_list
for table_name in daily_20191018.columns.values.tolist():
    daily_20191018_addname_dataframe[table_name] = daily_20191018[table_name]
print("日线行情-时间为序  daily_20191018 返回数据 row 行数 = "+str(daily_20191018.shape[0]))
daily_20191018_addname_dataframe.to_excel(daily_201910_excel_writer,'18_5',index=False)
daily_201910_excel_writer.save()
daily_20191021 = pro.daily(start_date='',end_date='',trade_date='20191021', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20191021_tscode_list = list() 
for ts_code_sh in daily_20191021['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20191021_tscode_list.append(stock_name)
daily_20191021_addname_dataframe=pd.DataFrame()
daily_20191021_addname_dataframe['cname'] = daily_20191021_tscode_list
for table_name in daily_20191021.columns.values.tolist():
    daily_20191021_addname_dataframe[table_name] = daily_20191021[table_name]
print("日线行情-时间为序  daily_20191021 返回数据 row 行数 = "+str(daily_20191021.shape[0]))
daily_20191021_addname_dataframe.to_excel(daily_201910_excel_writer,'21_1',index=False)
daily_201910_excel_writer.save()
daily_20191022 = pro.daily(start_date='',end_date='',trade_date='20191022', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20191022_tscode_list = list() 
for ts_code_sh in daily_20191022['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20191022_tscode_list.append(stock_name)
daily_20191022_addname_dataframe=pd.DataFrame()
daily_20191022_addname_dataframe['cname'] = daily_20191022_tscode_list
for table_name in daily_20191022.columns.values.tolist():
    daily_20191022_addname_dataframe[table_name] = daily_20191022[table_name]
print("日线行情-时间为序  daily_20191022 返回数据 row 行数 = "+str(daily_20191022.shape[0]))
daily_20191022_addname_dataframe.to_excel(daily_201910_excel_writer,'22_2',index=False)
daily_201910_excel_writer.save()
daily_20191023 = pro.daily(start_date='',end_date='',trade_date='20191023', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20191023_tscode_list = list() 
for ts_code_sh in daily_20191023['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20191023_tscode_list.append(stock_name)
daily_20191023_addname_dataframe=pd.DataFrame()
daily_20191023_addname_dataframe['cname'] = daily_20191023_tscode_list
for table_name in daily_20191023.columns.values.tolist():
    daily_20191023_addname_dataframe[table_name] = daily_20191023[table_name]
print("日线行情-时间为序  daily_20191023 返回数据 row 行数 = "+str(daily_20191023.shape[0]))
daily_20191023_addname_dataframe.to_excel(daily_201910_excel_writer,'23_3',index=False)
daily_201910_excel_writer.save()
daily_20191024 = pro.daily(start_date='',end_date='',trade_date='20191024', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20191024_tscode_list = list() 
for ts_code_sh in daily_20191024['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20191024_tscode_list.append(stock_name)
daily_20191024_addname_dataframe=pd.DataFrame()
daily_20191024_addname_dataframe['cname'] = daily_20191024_tscode_list
for table_name in daily_20191024.columns.values.tolist():
    daily_20191024_addname_dataframe[table_name] = daily_20191024[table_name]
print("日线行情-时间为序  daily_20191024 返回数据 row 行数 = "+str(daily_20191024.shape[0]))
daily_20191024_addname_dataframe.to_excel(daily_201910_excel_writer,'24_4',index=False)
daily_201910_excel_writer.save()
daily_20191025 = pro.daily(start_date='',end_date='',trade_date='20191025', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20191025_tscode_list = list() 
for ts_code_sh in daily_20191025['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20191025_tscode_list.append(stock_name)
daily_20191025_addname_dataframe=pd.DataFrame()
daily_20191025_addname_dataframe['cname'] = daily_20191025_tscode_list
for table_name in daily_20191025.columns.values.tolist():
    daily_20191025_addname_dataframe[table_name] = daily_20191025[table_name]
print("日线行情-时间为序  daily_20191025 返回数据 row 行数 = "+str(daily_20191025.shape[0]))
daily_20191025_addname_dataframe.to_excel(daily_201910_excel_writer,'25_5',index=False)
daily_201910_excel_writer.save()
daily_20191028 = pro.daily(start_date='',end_date='',trade_date='20191028', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20191028_tscode_list = list() 
for ts_code_sh in daily_20191028['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20191028_tscode_list.append(stock_name)
daily_20191028_addname_dataframe=pd.DataFrame()
daily_20191028_addname_dataframe['cname'] = daily_20191028_tscode_list
for table_name in daily_20191028.columns.values.tolist():
    daily_20191028_addname_dataframe[table_name] = daily_20191028[table_name]
print("日线行情-时间为序  daily_20191028 返回数据 row 行数 = "+str(daily_20191028.shape[0]))
daily_20191028_addname_dataframe.to_excel(daily_201910_excel_writer,'28_1',index=False)
daily_201910_excel_writer.save()
daily_20191029 = pro.daily(start_date='',end_date='',trade_date='20191029', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20191029_tscode_list = list() 
for ts_code_sh in daily_20191029['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20191029_tscode_list.append(stock_name)
daily_20191029_addname_dataframe=pd.DataFrame()
daily_20191029_addname_dataframe['cname'] = daily_20191029_tscode_list
for table_name in daily_20191029.columns.values.tolist():
    daily_20191029_addname_dataframe[table_name] = daily_20191029[table_name]
print("日线行情-时间为序  daily_20191029 返回数据 row 行数 = "+str(daily_20191029.shape[0]))
daily_20191029_addname_dataframe.to_excel(daily_201910_excel_writer,'29_2',index=False)
daily_201910_excel_writer.save()
daily_20191030 = pro.daily(start_date='',end_date='',trade_date='20191030', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20191030_tscode_list = list() 
for ts_code_sh in daily_20191030['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20191030_tscode_list.append(stock_name)
daily_20191030_addname_dataframe=pd.DataFrame()
daily_20191030_addname_dataframe['cname'] = daily_20191030_tscode_list
for table_name in daily_20191030.columns.values.tolist():
    daily_20191030_addname_dataframe[table_name] = daily_20191030[table_name]
print("日线行情-时间为序  daily_20191030 返回数据 row 行数 = "+str(daily_20191030.shape[0]))
daily_20191030_addname_dataframe.to_excel(daily_201910_excel_writer,'30_3',index=False)
daily_201910_excel_writer.save()
daily_20191031 = pro.daily(start_date='',end_date='',trade_date='20191031', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20191031_tscode_list = list() 
for ts_code_sh in daily_20191031['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20191031_tscode_list.append(stock_name)
daily_20191031_addname_dataframe=pd.DataFrame()
daily_20191031_addname_dataframe['cname'] = daily_20191031_tscode_list
for table_name in daily_20191031.columns.values.tolist():
    daily_20191031_addname_dataframe[table_name] = daily_20191031[table_name]
print("日线行情-时间为序  daily_20191031 返回数据 row 行数 = "+str(daily_20191031.shape[0]))
daily_20191031_addname_dataframe.to_excel(daily_201910_excel_writer,'31_4',index=False)
daily_201910_excel_writer.save()




createexcel('daily_201911.xlsx')
daily_201911_book = load_workbook('C:\\Users\\zhuzj5\\Desktop\\zbin\\J0_Data\\daily_201911.xlsx')
daily_201911_excel_writer = pd.ExcelWriter('C:\\Users\\zhuzj5\\Desktop\\zbin\\J0_Data\\daily_201911.xlsx', engine='openpyxl')
daily_201911_excel_writer.book = daily_201911_book
daily_201911_excel_writer.sheets = dict((ws.title, ws) for ws in daily_201911_book.worksheets)
J0_PROPS.put(tree_node_name+"record_date", "20191101")       ###  更新 记录日期
daily_20191101 = pro.daily(start_date='',end_date='',trade_date='20191101', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20191101_tscode_list = list() 
for ts_code_sh in daily_20191101['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20191101_tscode_list.append(stock_name)
daily_20191101_addname_dataframe=pd.DataFrame()
daily_20191101_addname_dataframe['cname'] = daily_20191101_tscode_list
for table_name in daily_20191101.columns.values.tolist():
    daily_20191101_addname_dataframe[table_name] = daily_20191101[table_name]
print("日线行情-时间为序  daily_20191101 返回数据 row 行数 = "+str(daily_20191101.shape[0]))
daily_20191101_addname_dataframe.to_excel(daily_201911_excel_writer,'1_5',index=False)
daily_201911_excel_writer.save()
daily_20191104 = pro.daily(start_date='',end_date='',trade_date='20191104', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20191104_tscode_list = list() 
for ts_code_sh in daily_20191104['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20191104_tscode_list.append(stock_name)
daily_20191104_addname_dataframe=pd.DataFrame()
daily_20191104_addname_dataframe['cname'] = daily_20191104_tscode_list
for table_name in daily_20191104.columns.values.tolist():
    daily_20191104_addname_dataframe[table_name] = daily_20191104[table_name]
print("日线行情-时间为序  daily_20191104 返回数据 row 行数 = "+str(daily_20191104.shape[0]))
daily_20191104_addname_dataframe.to_excel(daily_201911_excel_writer,'4_1',index=False)
daily_201911_excel_writer.save()
daily_20191105 = pro.daily(start_date='',end_date='',trade_date='20191105', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20191105_tscode_list = list() 
for ts_code_sh in daily_20191105['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20191105_tscode_list.append(stock_name)
daily_20191105_addname_dataframe=pd.DataFrame()
daily_20191105_addname_dataframe['cname'] = daily_20191105_tscode_list
for table_name in daily_20191105.columns.values.tolist():
    daily_20191105_addname_dataframe[table_name] = daily_20191105[table_name]
print("日线行情-时间为序  daily_20191105 返回数据 row 行数 = "+str(daily_20191105.shape[0]))
daily_20191105_addname_dataframe.to_excel(daily_201911_excel_writer,'5_2',index=False)
daily_201911_excel_writer.save()
daily_20191106 = pro.daily(start_date='',end_date='',trade_date='20191106', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20191106_tscode_list = list() 
for ts_code_sh in daily_20191106['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20191106_tscode_list.append(stock_name)
daily_20191106_addname_dataframe=pd.DataFrame()
daily_20191106_addname_dataframe['cname'] = daily_20191106_tscode_list
for table_name in daily_20191106.columns.values.tolist():
    daily_20191106_addname_dataframe[table_name] = daily_20191106[table_name]
print("日线行情-时间为序  daily_20191106 返回数据 row 行数 = "+str(daily_20191106.shape[0]))
daily_20191106_addname_dataframe.to_excel(daily_201911_excel_writer,'6_3',index=False)
daily_201911_excel_writer.save()
daily_20191107 = pro.daily(start_date='',end_date='',trade_date='20191107', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20191107_tscode_list = list() 
for ts_code_sh in daily_20191107['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20191107_tscode_list.append(stock_name)
daily_20191107_addname_dataframe=pd.DataFrame()
daily_20191107_addname_dataframe['cname'] = daily_20191107_tscode_list
for table_name in daily_20191107.columns.values.tolist():
    daily_20191107_addname_dataframe[table_name] = daily_20191107[table_name]
print("日线行情-时间为序  daily_20191107 返回数据 row 行数 = "+str(daily_20191107.shape[0]))
daily_20191107_addname_dataframe.to_excel(daily_201911_excel_writer,'7_4',index=False)
daily_201911_excel_writer.save()
daily_20191108 = pro.daily(start_date='',end_date='',trade_date='20191108', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20191108_tscode_list = list() 
for ts_code_sh in daily_20191108['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20191108_tscode_list.append(stock_name)
daily_20191108_addname_dataframe=pd.DataFrame()
daily_20191108_addname_dataframe['cname'] = daily_20191108_tscode_list
for table_name in daily_20191108.columns.values.tolist():
    daily_20191108_addname_dataframe[table_name] = daily_20191108[table_name]
print("日线行情-时间为序  daily_20191108 返回数据 row 行数 = "+str(daily_20191108.shape[0]))
daily_20191108_addname_dataframe.to_excel(daily_201911_excel_writer,'8_5',index=False)
daily_201911_excel_writer.save()
daily_20191111 = pro.daily(start_date='',end_date='',trade_date='20191111', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20191111_tscode_list = list() 
for ts_code_sh in daily_20191111['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20191111_tscode_list.append(stock_name)
daily_20191111_addname_dataframe=pd.DataFrame()
daily_20191111_addname_dataframe['cname'] = daily_20191111_tscode_list
for table_name in daily_20191111.columns.values.tolist():
    daily_20191111_addname_dataframe[table_name] = daily_20191111[table_name]
print("日线行情-时间为序  daily_20191111 返回数据 row 行数 = "+str(daily_20191111.shape[0]))
daily_20191111_addname_dataframe.to_excel(daily_201911_excel_writer,'11_1',index=False)
daily_201911_excel_writer.save()
daily_20191112 = pro.daily(start_date='',end_date='',trade_date='20191112', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20191112_tscode_list = list() 
for ts_code_sh in daily_20191112['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20191112_tscode_list.append(stock_name)
daily_20191112_addname_dataframe=pd.DataFrame()
daily_20191112_addname_dataframe['cname'] = daily_20191112_tscode_list
for table_name in daily_20191112.columns.values.tolist():
    daily_20191112_addname_dataframe[table_name] = daily_20191112[table_name]
print("日线行情-时间为序  daily_20191112 返回数据 row 行数 = "+str(daily_20191112.shape[0]))
daily_20191112_addname_dataframe.to_excel(daily_201911_excel_writer,'12_2',index=False)
daily_201911_excel_writer.save()
daily_20191113 = pro.daily(start_date='',end_date='',trade_date='20191113', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20191113_tscode_list = list() 
for ts_code_sh in daily_20191113['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20191113_tscode_list.append(stock_name)
daily_20191113_addname_dataframe=pd.DataFrame()
daily_20191113_addname_dataframe['cname'] = daily_20191113_tscode_list
for table_name in daily_20191113.columns.values.tolist():
    daily_20191113_addname_dataframe[table_name] = daily_20191113[table_name]
print("日线行情-时间为序  daily_20191113 返回数据 row 行数 = "+str(daily_20191113.shape[0]))
daily_20191113_addname_dataframe.to_excel(daily_201911_excel_writer,'13_3',index=False)
daily_201911_excel_writer.save()
daily_20191114 = pro.daily(start_date='',end_date='',trade_date='20191114', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20191114_tscode_list = list() 
for ts_code_sh in daily_20191114['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20191114_tscode_list.append(stock_name)
daily_20191114_addname_dataframe=pd.DataFrame()
daily_20191114_addname_dataframe['cname'] = daily_20191114_tscode_list
for table_name in daily_20191114.columns.values.tolist():
    daily_20191114_addname_dataframe[table_name] = daily_20191114[table_name]
print("日线行情-时间为序  daily_20191114 返回数据 row 行数 = "+str(daily_20191114.shape[0]))
daily_20191114_addname_dataframe.to_excel(daily_201911_excel_writer,'14_4',index=False)
daily_201911_excel_writer.save()
daily_20191115 = pro.daily(start_date='',end_date='',trade_date='20191115', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20191115_tscode_list = list() 
for ts_code_sh in daily_20191115['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20191115_tscode_list.append(stock_name)
daily_20191115_addname_dataframe=pd.DataFrame()
daily_20191115_addname_dataframe['cname'] = daily_20191115_tscode_list
for table_name in daily_20191115.columns.values.tolist():
    daily_20191115_addname_dataframe[table_name] = daily_20191115[table_name]
print("日线行情-时间为序  daily_20191115 返回数据 row 行数 = "+str(daily_20191115.shape[0]))
daily_20191115_addname_dataframe.to_excel(daily_201911_excel_writer,'15_5',index=False)
daily_201911_excel_writer.save()
daily_20191118 = pro.daily(start_date='',end_date='',trade_date='20191118', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20191118_tscode_list = list() 
for ts_code_sh in daily_20191118['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20191118_tscode_list.append(stock_name)
daily_20191118_addname_dataframe=pd.DataFrame()
daily_20191118_addname_dataframe['cname'] = daily_20191118_tscode_list
for table_name in daily_20191118.columns.values.tolist():
    daily_20191118_addname_dataframe[table_name] = daily_20191118[table_name]
print("日线行情-时间为序  daily_20191118 返回数据 row 行数 = "+str(daily_20191118.shape[0]))
daily_20191118_addname_dataframe.to_excel(daily_201911_excel_writer,'18_1',index=False)
daily_201911_excel_writer.save()
daily_20191119 = pro.daily(start_date='',end_date='',trade_date='20191119', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20191119_tscode_list = list() 
for ts_code_sh in daily_20191119['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20191119_tscode_list.append(stock_name)
daily_20191119_addname_dataframe=pd.DataFrame()
daily_20191119_addname_dataframe['cname'] = daily_20191119_tscode_list
for table_name in daily_20191119.columns.values.tolist():
    daily_20191119_addname_dataframe[table_name] = daily_20191119[table_name]
print("日线行情-时间为序  daily_20191119 返回数据 row 行数 = "+str(daily_20191119.shape[0]))
daily_20191119_addname_dataframe.to_excel(daily_201911_excel_writer,'19_2',index=False)
daily_201911_excel_writer.save()
daily_20191120 = pro.daily(start_date='',end_date='',trade_date='20191120', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20191120_tscode_list = list() 
for ts_code_sh in daily_20191120['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20191120_tscode_list.append(stock_name)
daily_20191120_addname_dataframe=pd.DataFrame()
daily_20191120_addname_dataframe['cname'] = daily_20191120_tscode_list
for table_name in daily_20191120.columns.values.tolist():
    daily_20191120_addname_dataframe[table_name] = daily_20191120[table_name]
print("日线行情-时间为序  daily_20191120 返回数据 row 行数 = "+str(daily_20191120.shape[0]))
daily_20191120_addname_dataframe.to_excel(daily_201911_excel_writer,'20_3',index=False)
daily_201911_excel_writer.save()
daily_20191121 = pro.daily(start_date='',end_date='',trade_date='20191121', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20191121_tscode_list = list() 
for ts_code_sh in daily_20191121['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20191121_tscode_list.append(stock_name)
daily_20191121_addname_dataframe=pd.DataFrame()
daily_20191121_addname_dataframe['cname'] = daily_20191121_tscode_list
for table_name in daily_20191121.columns.values.tolist():
    daily_20191121_addname_dataframe[table_name] = daily_20191121[table_name]
print("日线行情-时间为序  daily_20191121 返回数据 row 行数 = "+str(daily_20191121.shape[0]))
daily_20191121_addname_dataframe.to_excel(daily_201911_excel_writer,'21_4',index=False)
daily_201911_excel_writer.save()
daily_20191122 = pro.daily(start_date='',end_date='',trade_date='20191122', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20191122_tscode_list = list() 
for ts_code_sh in daily_20191122['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20191122_tscode_list.append(stock_name)
daily_20191122_addname_dataframe=pd.DataFrame()
daily_20191122_addname_dataframe['cname'] = daily_20191122_tscode_list
for table_name in daily_20191122.columns.values.tolist():
    daily_20191122_addname_dataframe[table_name] = daily_20191122[table_name]
print("日线行情-时间为序  daily_20191122 返回数据 row 行数 = "+str(daily_20191122.shape[0]))
daily_20191122_addname_dataframe.to_excel(daily_201911_excel_writer,'22_5',index=False)
daily_201911_excel_writer.save()
daily_20191125 = pro.daily(start_date='',end_date='',trade_date='20191125', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20191125_tscode_list = list() 
for ts_code_sh in daily_20191125['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20191125_tscode_list.append(stock_name)
daily_20191125_addname_dataframe=pd.DataFrame()
daily_20191125_addname_dataframe['cname'] = daily_20191125_tscode_list
for table_name in daily_20191125.columns.values.tolist():
    daily_20191125_addname_dataframe[table_name] = daily_20191125[table_name]
print("日线行情-时间为序  daily_20191125 返回数据 row 行数 = "+str(daily_20191125.shape[0]))
daily_20191125_addname_dataframe.to_excel(daily_201911_excel_writer,'25_1',index=False)
daily_201911_excel_writer.save()
daily_20191126 = pro.daily(start_date='',end_date='',trade_date='20191126', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20191126_tscode_list = list() 
for ts_code_sh in daily_20191126['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20191126_tscode_list.append(stock_name)
daily_20191126_addname_dataframe=pd.DataFrame()
daily_20191126_addname_dataframe['cname'] = daily_20191126_tscode_list
for table_name in daily_20191126.columns.values.tolist():
    daily_20191126_addname_dataframe[table_name] = daily_20191126[table_name]
print("日线行情-时间为序  daily_20191126 返回数据 row 行数 = "+str(daily_20191126.shape[0]))
daily_20191126_addname_dataframe.to_excel(daily_201911_excel_writer,'26_2',index=False)
daily_201911_excel_writer.save()
daily_20191127 = pro.daily(start_date='',end_date='',trade_date='20191127', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20191127_tscode_list = list() 
for ts_code_sh in daily_20191127['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20191127_tscode_list.append(stock_name)
daily_20191127_addname_dataframe=pd.DataFrame()
daily_20191127_addname_dataframe['cname'] = daily_20191127_tscode_list
for table_name in daily_20191127.columns.values.tolist():
    daily_20191127_addname_dataframe[table_name] = daily_20191127[table_name]
print("日线行情-时间为序  daily_20191127 返回数据 row 行数 = "+str(daily_20191127.shape[0]))
daily_20191127_addname_dataframe.to_excel(daily_201911_excel_writer,'27_3',index=False)
daily_201911_excel_writer.save()
daily_20191128 = pro.daily(start_date='',end_date='',trade_date='20191128', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20191128_tscode_list = list() 
for ts_code_sh in daily_20191128['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20191128_tscode_list.append(stock_name)
daily_20191128_addname_dataframe=pd.DataFrame()
daily_20191128_addname_dataframe['cname'] = daily_20191128_tscode_list
for table_name in daily_20191128.columns.values.tolist():
    daily_20191128_addname_dataframe[table_name] = daily_20191128[table_name]
print("日线行情-时间为序  daily_20191128 返回数据 row 行数 = "+str(daily_20191128.shape[0]))
daily_20191128_addname_dataframe.to_excel(daily_201911_excel_writer,'28_4',index=False)
daily_201911_excel_writer.save()
daily_20191129 = pro.daily(start_date='',end_date='',trade_date='20191129', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20191129_tscode_list = list() 
for ts_code_sh in daily_20191129['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20191129_tscode_list.append(stock_name)
daily_20191129_addname_dataframe=pd.DataFrame()
daily_20191129_addname_dataframe['cname'] = daily_20191129_tscode_list
for table_name in daily_20191129.columns.values.tolist():
    daily_20191129_addname_dataframe[table_name] = daily_20191129[table_name]
print("日线行情-时间为序  daily_20191129 返回数据 row 行数 = "+str(daily_20191129.shape[0]))
daily_20191129_addname_dataframe.to_excel(daily_201911_excel_writer,'29_5',index=False)
daily_201911_excel_writer.save()




createexcel('daily_201912.xlsx')
daily_201912_book = load_workbook('C:\\Users\\zhuzj5\\Desktop\\zbin\\J0_Data\\daily_201912.xlsx')
daily_201912_excel_writer = pd.ExcelWriter('C:\\Users\\zhuzj5\\Desktop\\zbin\\J0_Data\\daily_201912.xlsx', engine='openpyxl')
daily_201912_excel_writer.book = daily_201912_book
daily_201912_excel_writer.sheets = dict((ws.title, ws) for ws in daily_201912_book.worksheets)
J0_PROPS.put(tree_node_name+"record_date", "20191201")       ###  更新 记录日期
daily_20191202 = pro.daily(start_date='',end_date='',trade_date='20191202', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20191202_tscode_list = list() 
for ts_code_sh in daily_20191202['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20191202_tscode_list.append(stock_name)
daily_20191202_addname_dataframe=pd.DataFrame()
daily_20191202_addname_dataframe['cname'] = daily_20191202_tscode_list
for table_name in daily_20191202.columns.values.tolist():
    daily_20191202_addname_dataframe[table_name] = daily_20191202[table_name]
print("日线行情-时间为序  daily_20191202 返回数据 row 行数 = "+str(daily_20191202.shape[0]))
daily_20191202_addname_dataframe.to_excel(daily_201912_excel_writer,'2_1',index=False)
daily_201912_excel_writer.save()
daily_20191203 = pro.daily(start_date='',end_date='',trade_date='20191203', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20191203_tscode_list = list() 
for ts_code_sh in daily_20191203['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20191203_tscode_list.append(stock_name)
daily_20191203_addname_dataframe=pd.DataFrame()
daily_20191203_addname_dataframe['cname'] = daily_20191203_tscode_list
for table_name in daily_20191203.columns.values.tolist():
    daily_20191203_addname_dataframe[table_name] = daily_20191203[table_name]
print("日线行情-时间为序  daily_20191203 返回数据 row 行数 = "+str(daily_20191203.shape[0]))
daily_20191203_addname_dataframe.to_excel(daily_201912_excel_writer,'3_2',index=False)
daily_201912_excel_writer.save()
daily_20191204 = pro.daily(start_date='',end_date='',trade_date='20191204', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20191204_tscode_list = list() 
for ts_code_sh in daily_20191204['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20191204_tscode_list.append(stock_name)
daily_20191204_addname_dataframe=pd.DataFrame()
daily_20191204_addname_dataframe['cname'] = daily_20191204_tscode_list
for table_name in daily_20191204.columns.values.tolist():
    daily_20191204_addname_dataframe[table_name] = daily_20191204[table_name]
print("日线行情-时间为序  daily_20191204 返回数据 row 行数 = "+str(daily_20191204.shape[0]))
daily_20191204_addname_dataframe.to_excel(daily_201912_excel_writer,'4_3',index=False)
daily_201912_excel_writer.save()
daily_20191205 = pro.daily(start_date='',end_date='',trade_date='20191205', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20191205_tscode_list = list() 
for ts_code_sh in daily_20191205['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20191205_tscode_list.append(stock_name)
daily_20191205_addname_dataframe=pd.DataFrame()
daily_20191205_addname_dataframe['cname'] = daily_20191205_tscode_list
for table_name in daily_20191205.columns.values.tolist():
    daily_20191205_addname_dataframe[table_name] = daily_20191205[table_name]
print("日线行情-时间为序  daily_20191205 返回数据 row 行数 = "+str(daily_20191205.shape[0]))
daily_20191205_addname_dataframe.to_excel(daily_201912_excel_writer,'5_4',index=False)
daily_201912_excel_writer.save()
daily_20191206 = pro.daily(start_date='',end_date='',trade_date='20191206', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20191206_tscode_list = list() 
for ts_code_sh in daily_20191206['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20191206_tscode_list.append(stock_name)
daily_20191206_addname_dataframe=pd.DataFrame()
daily_20191206_addname_dataframe['cname'] = daily_20191206_tscode_list
for table_name in daily_20191206.columns.values.tolist():
    daily_20191206_addname_dataframe[table_name] = daily_20191206[table_name]
print("日线行情-时间为序  daily_20191206 返回数据 row 行数 = "+str(daily_20191206.shape[0]))
daily_20191206_addname_dataframe.to_excel(daily_201912_excel_writer,'6_5',index=False)
daily_201912_excel_writer.save()
daily_20191209 = pro.daily(start_date='',end_date='',trade_date='20191209', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20191209_tscode_list = list() 
for ts_code_sh in daily_20191209['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20191209_tscode_list.append(stock_name)
daily_20191209_addname_dataframe=pd.DataFrame()
daily_20191209_addname_dataframe['cname'] = daily_20191209_tscode_list
for table_name in daily_20191209.columns.values.tolist():
    daily_20191209_addname_dataframe[table_name] = daily_20191209[table_name]
print("日线行情-时间为序  daily_20191209 返回数据 row 行数 = "+str(daily_20191209.shape[0]))
daily_20191209_addname_dataframe.to_excel(daily_201912_excel_writer,'9_1',index=False)
daily_201912_excel_writer.save()
daily_20191210 = pro.daily(start_date='',end_date='',trade_date='20191210', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20191210_tscode_list = list() 
for ts_code_sh in daily_20191210['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20191210_tscode_list.append(stock_name)
daily_20191210_addname_dataframe=pd.DataFrame()
daily_20191210_addname_dataframe['cname'] = daily_20191210_tscode_list
for table_name in daily_20191210.columns.values.tolist():
    daily_20191210_addname_dataframe[table_name] = daily_20191210[table_name]
print("日线行情-时间为序  daily_20191210 返回数据 row 行数 = "+str(daily_20191210.shape[0]))
daily_20191210_addname_dataframe.to_excel(daily_201912_excel_writer,'10_2',index=False)
daily_201912_excel_writer.save()
daily_20191211 = pro.daily(start_date='',end_date='',trade_date='20191211', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20191211_tscode_list = list() 
for ts_code_sh in daily_20191211['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20191211_tscode_list.append(stock_name)
daily_20191211_addname_dataframe=pd.DataFrame()
daily_20191211_addname_dataframe['cname'] = daily_20191211_tscode_list
for table_name in daily_20191211.columns.values.tolist():
    daily_20191211_addname_dataframe[table_name] = daily_20191211[table_name]
print("日线行情-时间为序  daily_20191211 返回数据 row 行数 = "+str(daily_20191211.shape[0]))
daily_20191211_addname_dataframe.to_excel(daily_201912_excel_writer,'11_3',index=False)
daily_201912_excel_writer.save()
daily_20191212 = pro.daily(start_date='',end_date='',trade_date='20191212', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20191212_tscode_list = list() 
for ts_code_sh in daily_20191212['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20191212_tscode_list.append(stock_name)
daily_20191212_addname_dataframe=pd.DataFrame()
daily_20191212_addname_dataframe['cname'] = daily_20191212_tscode_list
for table_name in daily_20191212.columns.values.tolist():
    daily_20191212_addname_dataframe[table_name] = daily_20191212[table_name]
print("日线行情-时间为序  daily_20191212 返回数据 row 行数 = "+str(daily_20191212.shape[0]))
daily_20191212_addname_dataframe.to_excel(daily_201912_excel_writer,'12_4',index=False)
daily_201912_excel_writer.save()
daily_20191213 = pro.daily(start_date='',end_date='',trade_date='20191213', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20191213_tscode_list = list() 
for ts_code_sh in daily_20191213['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20191213_tscode_list.append(stock_name)
daily_20191213_addname_dataframe=pd.DataFrame()
daily_20191213_addname_dataframe['cname'] = daily_20191213_tscode_list
for table_name in daily_20191213.columns.values.tolist():
    daily_20191213_addname_dataframe[table_name] = daily_20191213[table_name]
print("日线行情-时间为序  daily_20191213 返回数据 row 行数 = "+str(daily_20191213.shape[0]))
daily_20191213_addname_dataframe.to_excel(daily_201912_excel_writer,'13_5',index=False)
daily_201912_excel_writer.save()
daily_20191216 = pro.daily(start_date='',end_date='',trade_date='20191216', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20191216_tscode_list = list() 
for ts_code_sh in daily_20191216['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20191216_tscode_list.append(stock_name)
daily_20191216_addname_dataframe=pd.DataFrame()
daily_20191216_addname_dataframe['cname'] = daily_20191216_tscode_list
for table_name in daily_20191216.columns.values.tolist():
    daily_20191216_addname_dataframe[table_name] = daily_20191216[table_name]
print("日线行情-时间为序  daily_20191216 返回数据 row 行数 = "+str(daily_20191216.shape[0]))
daily_20191216_addname_dataframe.to_excel(daily_201912_excel_writer,'16_1',index=False)
daily_201912_excel_writer.save()
daily_20191217 = pro.daily(start_date='',end_date='',trade_date='20191217', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20191217_tscode_list = list() 
for ts_code_sh in daily_20191217['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20191217_tscode_list.append(stock_name)
daily_20191217_addname_dataframe=pd.DataFrame()
daily_20191217_addname_dataframe['cname'] = daily_20191217_tscode_list
for table_name in daily_20191217.columns.values.tolist():
    daily_20191217_addname_dataframe[table_name] = daily_20191217[table_name]
print("日线行情-时间为序  daily_20191217 返回数据 row 行数 = "+str(daily_20191217.shape[0]))
daily_20191217_addname_dataframe.to_excel(daily_201912_excel_writer,'17_2',index=False)
daily_201912_excel_writer.save()
daily_20191218 = pro.daily(start_date='',end_date='',trade_date='20191218', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20191218_tscode_list = list() 
for ts_code_sh in daily_20191218['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20191218_tscode_list.append(stock_name)
daily_20191218_addname_dataframe=pd.DataFrame()
daily_20191218_addname_dataframe['cname'] = daily_20191218_tscode_list
for table_name in daily_20191218.columns.values.tolist():
    daily_20191218_addname_dataframe[table_name] = daily_20191218[table_name]
print("日线行情-时间为序  daily_20191218 返回数据 row 行数 = "+str(daily_20191218.shape[0]))
daily_20191218_addname_dataframe.to_excel(daily_201912_excel_writer,'18_3',index=False)
daily_201912_excel_writer.save()
daily_20191219 = pro.daily(start_date='',end_date='',trade_date='20191219', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20191219_tscode_list = list() 
for ts_code_sh in daily_20191219['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20191219_tscode_list.append(stock_name)
daily_20191219_addname_dataframe=pd.DataFrame()
daily_20191219_addname_dataframe['cname'] = daily_20191219_tscode_list
for table_name in daily_20191219.columns.values.tolist():
    daily_20191219_addname_dataframe[table_name] = daily_20191219[table_name]
print("日线行情-时间为序  daily_20191219 返回数据 row 行数 = "+str(daily_20191219.shape[0]))
daily_20191219_addname_dataframe.to_excel(daily_201912_excel_writer,'19_4',index=False)
daily_201912_excel_writer.save()
daily_20191220 = pro.daily(start_date='',end_date='',trade_date='20191220', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20191220_tscode_list = list() 
for ts_code_sh in daily_20191220['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20191220_tscode_list.append(stock_name)
daily_20191220_addname_dataframe=pd.DataFrame()
daily_20191220_addname_dataframe['cname'] = daily_20191220_tscode_list
for table_name in daily_20191220.columns.values.tolist():
    daily_20191220_addname_dataframe[table_name] = daily_20191220[table_name]
print("日线行情-时间为序  daily_20191220 返回数据 row 行数 = "+str(daily_20191220.shape[0]))
daily_20191220_addname_dataframe.to_excel(daily_201912_excel_writer,'20_5',index=False)
daily_201912_excel_writer.save()
daily_20191223 = pro.daily(start_date='',end_date='',trade_date='20191223', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20191223_tscode_list = list() 
for ts_code_sh in daily_20191223['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20191223_tscode_list.append(stock_name)
daily_20191223_addname_dataframe=pd.DataFrame()
daily_20191223_addname_dataframe['cname'] = daily_20191223_tscode_list
for table_name in daily_20191223.columns.values.tolist():
    daily_20191223_addname_dataframe[table_name] = daily_20191223[table_name]
print("日线行情-时间为序  daily_20191223 返回数据 row 行数 = "+str(daily_20191223.shape[0]))
daily_20191223_addname_dataframe.to_excel(daily_201912_excel_writer,'23_1',index=False)
daily_201912_excel_writer.save()
daily_20191224 = pro.daily(start_date='',end_date='',trade_date='20191224', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20191224_tscode_list = list() 
for ts_code_sh in daily_20191224['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20191224_tscode_list.append(stock_name)
daily_20191224_addname_dataframe=pd.DataFrame()
daily_20191224_addname_dataframe['cname'] = daily_20191224_tscode_list
for table_name in daily_20191224.columns.values.tolist():
    daily_20191224_addname_dataframe[table_name] = daily_20191224[table_name]
print("日线行情-时间为序  daily_20191224 返回数据 row 行数 = "+str(daily_20191224.shape[0]))
daily_20191224_addname_dataframe.to_excel(daily_201912_excel_writer,'24_2',index=False)
daily_201912_excel_writer.save()
daily_20191225 = pro.daily(start_date='',end_date='',trade_date='20191225', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20191225_tscode_list = list() 
for ts_code_sh in daily_20191225['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20191225_tscode_list.append(stock_name)
daily_20191225_addname_dataframe=pd.DataFrame()
daily_20191225_addname_dataframe['cname'] = daily_20191225_tscode_list
for table_name in daily_20191225.columns.values.tolist():
    daily_20191225_addname_dataframe[table_name] = daily_20191225[table_name]
print("日线行情-时间为序  daily_20191225 返回数据 row 行数 = "+str(daily_20191225.shape[0]))
daily_20191225_addname_dataframe.to_excel(daily_201912_excel_writer,'25_3',index=False)
daily_201912_excel_writer.save()
daily_20191226 = pro.daily(start_date='',end_date='',trade_date='20191226', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20191226_tscode_list = list() 
for ts_code_sh in daily_20191226['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20191226_tscode_list.append(stock_name)
daily_20191226_addname_dataframe=pd.DataFrame()
daily_20191226_addname_dataframe['cname'] = daily_20191226_tscode_list
for table_name in daily_20191226.columns.values.tolist():
    daily_20191226_addname_dataframe[table_name] = daily_20191226[table_name]
print("日线行情-时间为序  daily_20191226 返回数据 row 行数 = "+str(daily_20191226.shape[0]))
daily_20191226_addname_dataframe.to_excel(daily_201912_excel_writer,'26_4',index=False)
daily_201912_excel_writer.save()
daily_20191227 = pro.daily(start_date='',end_date='',trade_date='20191227', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20191227_tscode_list = list() 
for ts_code_sh in daily_20191227['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20191227_tscode_list.append(stock_name)
daily_20191227_addname_dataframe=pd.DataFrame()
daily_20191227_addname_dataframe['cname'] = daily_20191227_tscode_list
for table_name in daily_20191227.columns.values.tolist():
    daily_20191227_addname_dataframe[table_name] = daily_20191227[table_name]
print("日线行情-时间为序  daily_20191227 返回数据 row 行数 = "+str(daily_20191227.shape[0]))
daily_20191227_addname_dataframe.to_excel(daily_201912_excel_writer,'27_5',index=False)
daily_201912_excel_writer.save()
daily_20191230 = pro.daily(start_date='',end_date='',trade_date='20191230', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20191230_tscode_list = list() 
for ts_code_sh in daily_20191230['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20191230_tscode_list.append(stock_name)
daily_20191230_addname_dataframe=pd.DataFrame()
daily_20191230_addname_dataframe['cname'] = daily_20191230_tscode_list
for table_name in daily_20191230.columns.values.tolist():
    daily_20191230_addname_dataframe[table_name] = daily_20191230[table_name]
print("日线行情-时间为序  daily_20191230 返回数据 row 行数 = "+str(daily_20191230.shape[0]))
daily_20191230_addname_dataframe.to_excel(daily_201912_excel_writer,'30_1',index=False)
daily_201912_excel_writer.save()
daily_20191231 = pro.daily(start_date='',end_date='',trade_date='20191231', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20191231_tscode_list = list() 
for ts_code_sh in daily_20191231['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20191231_tscode_list.append(stock_name)
daily_20191231_addname_dataframe=pd.DataFrame()
daily_20191231_addname_dataframe['cname'] = daily_20191231_tscode_list
for table_name in daily_20191231.columns.values.tolist():
    daily_20191231_addname_dataframe[table_name] = daily_20191231[table_name]
print("日线行情-时间为序  daily_20191231 返回数据 row 行数 = "+str(daily_20191231.shape[0]))
daily_20191231_addname_dataframe.to_excel(daily_201912_excel_writer,'31_2',index=False)
daily_201912_excel_writer.save()




createexcel('daily_202001.xlsx')
daily_202001_book = load_workbook('C:\\Users\\zhuzj5\\Desktop\\zbin\\J0_Data\\daily_202001.xlsx')
daily_202001_excel_writer = pd.ExcelWriter('C:\\Users\\zhuzj5\\Desktop\\zbin\\J0_Data\\daily_202001.xlsx', engine='openpyxl')
daily_202001_excel_writer.book = daily_202001_book
daily_202001_excel_writer.sheets = dict((ws.title, ws) for ws in daily_202001_book.worksheets)
J0_PROPS.put(tree_node_name+"record_date", "20200101")       ###  更新 记录日期
daily_20200102 = pro.daily(start_date='',end_date='',trade_date='20200102', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20200102_tscode_list = list() 
for ts_code_sh in daily_20200102['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20200102_tscode_list.append(stock_name)
daily_20200102_addname_dataframe=pd.DataFrame()
daily_20200102_addname_dataframe['cname'] = daily_20200102_tscode_list
for table_name in daily_20200102.columns.values.tolist():
    daily_20200102_addname_dataframe[table_name] = daily_20200102[table_name]
print("日线行情-时间为序  daily_20200102 返回数据 row 行数 = "+str(daily_20200102.shape[0]))
daily_20200102_addname_dataframe.to_excel(daily_202001_excel_writer,'2_4',index=False)
daily_202001_excel_writer.save()
daily_20200103 = pro.daily(start_date='',end_date='',trade_date='20200103', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20200103_tscode_list = list() 
for ts_code_sh in daily_20200103['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20200103_tscode_list.append(stock_name)
daily_20200103_addname_dataframe=pd.DataFrame()
daily_20200103_addname_dataframe['cname'] = daily_20200103_tscode_list
for table_name in daily_20200103.columns.values.tolist():
    daily_20200103_addname_dataframe[table_name] = daily_20200103[table_name]
print("日线行情-时间为序  daily_20200103 返回数据 row 行数 = "+str(daily_20200103.shape[0]))
daily_20200103_addname_dataframe.to_excel(daily_202001_excel_writer,'3_5',index=False)
daily_202001_excel_writer.save()
daily_20200106 = pro.daily(start_date='',end_date='',trade_date='20200106', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20200106_tscode_list = list() 
for ts_code_sh in daily_20200106['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20200106_tscode_list.append(stock_name)
daily_20200106_addname_dataframe=pd.DataFrame()
daily_20200106_addname_dataframe['cname'] = daily_20200106_tscode_list
for table_name in daily_20200106.columns.values.tolist():
    daily_20200106_addname_dataframe[table_name] = daily_20200106[table_name]
print("日线行情-时间为序  daily_20200106 返回数据 row 行数 = "+str(daily_20200106.shape[0]))
daily_20200106_addname_dataframe.to_excel(daily_202001_excel_writer,'6_1',index=False)
daily_202001_excel_writer.save()
daily_20200107 = pro.daily(start_date='',end_date='',trade_date='20200107', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20200107_tscode_list = list() 
for ts_code_sh in daily_20200107['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20200107_tscode_list.append(stock_name)
daily_20200107_addname_dataframe=pd.DataFrame()
daily_20200107_addname_dataframe['cname'] = daily_20200107_tscode_list
for table_name in daily_20200107.columns.values.tolist():
    daily_20200107_addname_dataframe[table_name] = daily_20200107[table_name]
print("日线行情-时间为序  daily_20200107 返回数据 row 行数 = "+str(daily_20200107.shape[0]))
daily_20200107_addname_dataframe.to_excel(daily_202001_excel_writer,'7_2',index=False)
daily_202001_excel_writer.save()
daily_20200108 = pro.daily(start_date='',end_date='',trade_date='20200108', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20200108_tscode_list = list() 
for ts_code_sh in daily_20200108['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20200108_tscode_list.append(stock_name)
daily_20200108_addname_dataframe=pd.DataFrame()
daily_20200108_addname_dataframe['cname'] = daily_20200108_tscode_list
for table_name in daily_20200108.columns.values.tolist():
    daily_20200108_addname_dataframe[table_name] = daily_20200108[table_name]
print("日线行情-时间为序  daily_20200108 返回数据 row 行数 = "+str(daily_20200108.shape[0]))
daily_20200108_addname_dataframe.to_excel(daily_202001_excel_writer,'8_3',index=False)
daily_202001_excel_writer.save()
daily_20200109 = pro.daily(start_date='',end_date='',trade_date='20200109', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20200109_tscode_list = list() 
for ts_code_sh in daily_20200109['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20200109_tscode_list.append(stock_name)
daily_20200109_addname_dataframe=pd.DataFrame()
daily_20200109_addname_dataframe['cname'] = daily_20200109_tscode_list
for table_name in daily_20200109.columns.values.tolist():
    daily_20200109_addname_dataframe[table_name] = daily_20200109[table_name]
print("日线行情-时间为序  daily_20200109 返回数据 row 行数 = "+str(daily_20200109.shape[0]))
daily_20200109_addname_dataframe.to_excel(daily_202001_excel_writer,'9_4',index=False)
daily_202001_excel_writer.save()
daily_20200110 = pro.daily(start_date='',end_date='',trade_date='20200110', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20200110_tscode_list = list() 
for ts_code_sh in daily_20200110['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20200110_tscode_list.append(stock_name)
daily_20200110_addname_dataframe=pd.DataFrame()
daily_20200110_addname_dataframe['cname'] = daily_20200110_tscode_list
for table_name in daily_20200110.columns.values.tolist():
    daily_20200110_addname_dataframe[table_name] = daily_20200110[table_name]
print("日线行情-时间为序  daily_20200110 返回数据 row 行数 = "+str(daily_20200110.shape[0]))
daily_20200110_addname_dataframe.to_excel(daily_202001_excel_writer,'10_5',index=False)
daily_202001_excel_writer.save()
daily_20200113 = pro.daily(start_date='',end_date='',trade_date='20200113', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20200113_tscode_list = list() 
for ts_code_sh in daily_20200113['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20200113_tscode_list.append(stock_name)
daily_20200113_addname_dataframe=pd.DataFrame()
daily_20200113_addname_dataframe['cname'] = daily_20200113_tscode_list
for table_name in daily_20200113.columns.values.tolist():
    daily_20200113_addname_dataframe[table_name] = daily_20200113[table_name]
print("日线行情-时间为序  daily_20200113 返回数据 row 行数 = "+str(daily_20200113.shape[0]))
daily_20200113_addname_dataframe.to_excel(daily_202001_excel_writer,'13_1',index=False)
daily_202001_excel_writer.save()
daily_20200114 = pro.daily(start_date='',end_date='',trade_date='20200114', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20200114_tscode_list = list() 
for ts_code_sh in daily_20200114['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20200114_tscode_list.append(stock_name)
daily_20200114_addname_dataframe=pd.DataFrame()
daily_20200114_addname_dataframe['cname'] = daily_20200114_tscode_list
for table_name in daily_20200114.columns.values.tolist():
    daily_20200114_addname_dataframe[table_name] = daily_20200114[table_name]
print("日线行情-时间为序  daily_20200114 返回数据 row 行数 = "+str(daily_20200114.shape[0]))
daily_20200114_addname_dataframe.to_excel(daily_202001_excel_writer,'14_2',index=False)
daily_202001_excel_writer.save()
daily_20200115 = pro.daily(start_date='',end_date='',trade_date='20200115', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20200115_tscode_list = list() 
for ts_code_sh in daily_20200115['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20200115_tscode_list.append(stock_name)
daily_20200115_addname_dataframe=pd.DataFrame()
daily_20200115_addname_dataframe['cname'] = daily_20200115_tscode_list
for table_name in daily_20200115.columns.values.tolist():
    daily_20200115_addname_dataframe[table_name] = daily_20200115[table_name]
print("日线行情-时间为序  daily_20200115 返回数据 row 行数 = "+str(daily_20200115.shape[0]))
daily_20200115_addname_dataframe.to_excel(daily_202001_excel_writer,'15_3',index=False)
daily_202001_excel_writer.save()
daily_20200116 = pro.daily(start_date='',end_date='',trade_date='20200116', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20200116_tscode_list = list() 
for ts_code_sh in daily_20200116['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20200116_tscode_list.append(stock_name)
daily_20200116_addname_dataframe=pd.DataFrame()
daily_20200116_addname_dataframe['cname'] = daily_20200116_tscode_list
for table_name in daily_20200116.columns.values.tolist():
    daily_20200116_addname_dataframe[table_name] = daily_20200116[table_name]
print("日线行情-时间为序  daily_20200116 返回数据 row 行数 = "+str(daily_20200116.shape[0]))
daily_20200116_addname_dataframe.to_excel(daily_202001_excel_writer,'16_4',index=False)
daily_202001_excel_writer.save()
daily_20200117 = pro.daily(start_date='',end_date='',trade_date='20200117', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20200117_tscode_list = list() 
for ts_code_sh in daily_20200117['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20200117_tscode_list.append(stock_name)
daily_20200117_addname_dataframe=pd.DataFrame()
daily_20200117_addname_dataframe['cname'] = daily_20200117_tscode_list
for table_name in daily_20200117.columns.values.tolist():
    daily_20200117_addname_dataframe[table_name] = daily_20200117[table_name]
print("日线行情-时间为序  daily_20200117 返回数据 row 行数 = "+str(daily_20200117.shape[0]))
daily_20200117_addname_dataframe.to_excel(daily_202001_excel_writer,'17_5',index=False)
daily_202001_excel_writer.save()
daily_20200120 = pro.daily(start_date='',end_date='',trade_date='20200120', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20200120_tscode_list = list() 
for ts_code_sh in daily_20200120['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20200120_tscode_list.append(stock_name)
daily_20200120_addname_dataframe=pd.DataFrame()
daily_20200120_addname_dataframe['cname'] = daily_20200120_tscode_list
for table_name in daily_20200120.columns.values.tolist():
    daily_20200120_addname_dataframe[table_name] = daily_20200120[table_name]
print("日线行情-时间为序  daily_20200120 返回数据 row 行数 = "+str(daily_20200120.shape[0]))
daily_20200120_addname_dataframe.to_excel(daily_202001_excel_writer,'20_1',index=False)
daily_202001_excel_writer.save()
daily_20200121 = pro.daily(start_date='',end_date='',trade_date='20200121', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20200121_tscode_list = list() 
for ts_code_sh in daily_20200121['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20200121_tscode_list.append(stock_name)
daily_20200121_addname_dataframe=pd.DataFrame()
daily_20200121_addname_dataframe['cname'] = daily_20200121_tscode_list
for table_name in daily_20200121.columns.values.tolist():
    daily_20200121_addname_dataframe[table_name] = daily_20200121[table_name]
print("日线行情-时间为序  daily_20200121 返回数据 row 行数 = "+str(daily_20200121.shape[0]))
daily_20200121_addname_dataframe.to_excel(daily_202001_excel_writer,'21_2',index=False)
daily_202001_excel_writer.save()
daily_20200122 = pro.daily(start_date='',end_date='',trade_date='20200122', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20200122_tscode_list = list() 
for ts_code_sh in daily_20200122['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20200122_tscode_list.append(stock_name)
daily_20200122_addname_dataframe=pd.DataFrame()
daily_20200122_addname_dataframe['cname'] = daily_20200122_tscode_list
for table_name in daily_20200122.columns.values.tolist():
    daily_20200122_addname_dataframe[table_name] = daily_20200122[table_name]
print("日线行情-时间为序  daily_20200122 返回数据 row 行数 = "+str(daily_20200122.shape[0]))
daily_20200122_addname_dataframe.to_excel(daily_202001_excel_writer,'22_3',index=False)
daily_202001_excel_writer.save()
daily_20200123 = pro.daily(start_date='',end_date='',trade_date='20200123', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20200123_tscode_list = list() 
for ts_code_sh in daily_20200123['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20200123_tscode_list.append(stock_name)
daily_20200123_addname_dataframe=pd.DataFrame()
daily_20200123_addname_dataframe['cname'] = daily_20200123_tscode_list
for table_name in daily_20200123.columns.values.tolist():
    daily_20200123_addname_dataframe[table_name] = daily_20200123[table_name]
print("日线行情-时间为序  daily_20200123 返回数据 row 行数 = "+str(daily_20200123.shape[0]))
daily_20200123_addname_dataframe.to_excel(daily_202001_excel_writer,'23_4',index=False)
daily_202001_excel_writer.save()




createexcel('daily_202002.xlsx')
daily_202002_book = load_workbook('C:\\Users\\zhuzj5\\Desktop\\zbin\\J0_Data\\daily_202002.xlsx')
daily_202002_excel_writer = pd.ExcelWriter('C:\\Users\\zhuzj5\\Desktop\\zbin\\J0_Data\\daily_202002.xlsx', engine='openpyxl')
daily_202002_excel_writer.book = daily_202002_book
daily_202002_excel_writer.sheets = dict((ws.title, ws) for ws in daily_202002_book.worksheets)
J0_PROPS.put(tree_node_name+"record_date", "20200201")       ###  更新 记录日期
daily_20200203 = pro.daily(start_date='',end_date='',trade_date='20200203', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20200203_tscode_list = list() 
for ts_code_sh in daily_20200203['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20200203_tscode_list.append(stock_name)
daily_20200203_addname_dataframe=pd.DataFrame()
daily_20200203_addname_dataframe['cname'] = daily_20200203_tscode_list
for table_name in daily_20200203.columns.values.tolist():
    daily_20200203_addname_dataframe[table_name] = daily_20200203[table_name]
print("日线行情-时间为序  daily_20200203 返回数据 row 行数 = "+str(daily_20200203.shape[0]))
daily_20200203_addname_dataframe.to_excel(daily_202002_excel_writer,'3_1',index=False)
daily_202002_excel_writer.save()
daily_20200204 = pro.daily(start_date='',end_date='',trade_date='20200204', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20200204_tscode_list = list() 
for ts_code_sh in daily_20200204['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20200204_tscode_list.append(stock_name)
daily_20200204_addname_dataframe=pd.DataFrame()
daily_20200204_addname_dataframe['cname'] = daily_20200204_tscode_list
for table_name in daily_20200204.columns.values.tolist():
    daily_20200204_addname_dataframe[table_name] = daily_20200204[table_name]
print("日线行情-时间为序  daily_20200204 返回数据 row 行数 = "+str(daily_20200204.shape[0]))
daily_20200204_addname_dataframe.to_excel(daily_202002_excel_writer,'4_2',index=False)
daily_202002_excel_writer.save()
daily_20200205 = pro.daily(start_date='',end_date='',trade_date='20200205', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20200205_tscode_list = list() 
for ts_code_sh in daily_20200205['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20200205_tscode_list.append(stock_name)
daily_20200205_addname_dataframe=pd.DataFrame()
daily_20200205_addname_dataframe['cname'] = daily_20200205_tscode_list
for table_name in daily_20200205.columns.values.tolist():
    daily_20200205_addname_dataframe[table_name] = daily_20200205[table_name]
print("日线行情-时间为序  daily_20200205 返回数据 row 行数 = "+str(daily_20200205.shape[0]))
daily_20200205_addname_dataframe.to_excel(daily_202002_excel_writer,'5_3',index=False)
daily_202002_excel_writer.save()
daily_20200206 = pro.daily(start_date='',end_date='',trade_date='20200206', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20200206_tscode_list = list() 
for ts_code_sh in daily_20200206['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20200206_tscode_list.append(stock_name)
daily_20200206_addname_dataframe=pd.DataFrame()
daily_20200206_addname_dataframe['cname'] = daily_20200206_tscode_list
for table_name in daily_20200206.columns.values.tolist():
    daily_20200206_addname_dataframe[table_name] = daily_20200206[table_name]
print("日线行情-时间为序  daily_20200206 返回数据 row 行数 = "+str(daily_20200206.shape[0]))
daily_20200206_addname_dataframe.to_excel(daily_202002_excel_writer,'6_4',index=False)
daily_202002_excel_writer.save()
daily_20200207 = pro.daily(start_date='',end_date='',trade_date='20200207', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20200207_tscode_list = list() 
for ts_code_sh in daily_20200207['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20200207_tscode_list.append(stock_name)
daily_20200207_addname_dataframe=pd.DataFrame()
daily_20200207_addname_dataframe['cname'] = daily_20200207_tscode_list
for table_name in daily_20200207.columns.values.tolist():
    daily_20200207_addname_dataframe[table_name] = daily_20200207[table_name]
print("日线行情-时间为序  daily_20200207 返回数据 row 行数 = "+str(daily_20200207.shape[0]))
daily_20200207_addname_dataframe.to_excel(daily_202002_excel_writer,'7_5',index=False)
daily_202002_excel_writer.save()
daily_20200210 = pro.daily(start_date='',end_date='',trade_date='20200210', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20200210_tscode_list = list() 
for ts_code_sh in daily_20200210['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20200210_tscode_list.append(stock_name)
daily_20200210_addname_dataframe=pd.DataFrame()
daily_20200210_addname_dataframe['cname'] = daily_20200210_tscode_list
for table_name in daily_20200210.columns.values.tolist():
    daily_20200210_addname_dataframe[table_name] = daily_20200210[table_name]
print("日线行情-时间为序  daily_20200210 返回数据 row 行数 = "+str(daily_20200210.shape[0]))
daily_20200210_addname_dataframe.to_excel(daily_202002_excel_writer,'10_1',index=False)
daily_202002_excel_writer.save()
daily_20200211 = pro.daily(start_date='',end_date='',trade_date='20200211', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20200211_tscode_list = list() 
for ts_code_sh in daily_20200211['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20200211_tscode_list.append(stock_name)
daily_20200211_addname_dataframe=pd.DataFrame()
daily_20200211_addname_dataframe['cname'] = daily_20200211_tscode_list
for table_name in daily_20200211.columns.values.tolist():
    daily_20200211_addname_dataframe[table_name] = daily_20200211[table_name]
print("日线行情-时间为序  daily_20200211 返回数据 row 行数 = "+str(daily_20200211.shape[0]))
daily_20200211_addname_dataframe.to_excel(daily_202002_excel_writer,'11_2',index=False)
daily_202002_excel_writer.save()
daily_20200212 = pro.daily(start_date='',end_date='',trade_date='20200212', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20200212_tscode_list = list() 
for ts_code_sh in daily_20200212['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20200212_tscode_list.append(stock_name)
daily_20200212_addname_dataframe=pd.DataFrame()
daily_20200212_addname_dataframe['cname'] = daily_20200212_tscode_list
for table_name in daily_20200212.columns.values.tolist():
    daily_20200212_addname_dataframe[table_name] = daily_20200212[table_name]
print("日线行情-时间为序  daily_20200212 返回数据 row 行数 = "+str(daily_20200212.shape[0]))
daily_20200212_addname_dataframe.to_excel(daily_202002_excel_writer,'12_3',index=False)
daily_202002_excel_writer.save()
daily_20200213 = pro.daily(start_date='',end_date='',trade_date='20200213', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20200213_tscode_list = list() 
for ts_code_sh in daily_20200213['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20200213_tscode_list.append(stock_name)
daily_20200213_addname_dataframe=pd.DataFrame()
daily_20200213_addname_dataframe['cname'] = daily_20200213_tscode_list
for table_name in daily_20200213.columns.values.tolist():
    daily_20200213_addname_dataframe[table_name] = daily_20200213[table_name]
print("日线行情-时间为序  daily_20200213 返回数据 row 行数 = "+str(daily_20200213.shape[0]))
daily_20200213_addname_dataframe.to_excel(daily_202002_excel_writer,'13_4',index=False)
daily_202002_excel_writer.save()
daily_20200214 = pro.daily(start_date='',end_date='',trade_date='20200214', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20200214_tscode_list = list() 
for ts_code_sh in daily_20200214['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20200214_tscode_list.append(stock_name)
daily_20200214_addname_dataframe=pd.DataFrame()
daily_20200214_addname_dataframe['cname'] = daily_20200214_tscode_list
for table_name in daily_20200214.columns.values.tolist():
    daily_20200214_addname_dataframe[table_name] = daily_20200214[table_name]
print("日线行情-时间为序  daily_20200214 返回数据 row 行数 = "+str(daily_20200214.shape[0]))
daily_20200214_addname_dataframe.to_excel(daily_202002_excel_writer,'14_5',index=False)
daily_202002_excel_writer.save()
daily_20200217 = pro.daily(start_date='',end_date='',trade_date='20200217', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20200217_tscode_list = list() 
for ts_code_sh in daily_20200217['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20200217_tscode_list.append(stock_name)
daily_20200217_addname_dataframe=pd.DataFrame()
daily_20200217_addname_dataframe['cname'] = daily_20200217_tscode_list
for table_name in daily_20200217.columns.values.tolist():
    daily_20200217_addname_dataframe[table_name] = daily_20200217[table_name]
print("日线行情-时间为序  daily_20200217 返回数据 row 行数 = "+str(daily_20200217.shape[0]))
daily_20200217_addname_dataframe.to_excel(daily_202002_excel_writer,'17_1',index=False)
daily_202002_excel_writer.save()
daily_20200218 = pro.daily(start_date='',end_date='',trade_date='20200218', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20200218_tscode_list = list() 
for ts_code_sh in daily_20200218['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20200218_tscode_list.append(stock_name)
daily_20200218_addname_dataframe=pd.DataFrame()
daily_20200218_addname_dataframe['cname'] = daily_20200218_tscode_list
for table_name in daily_20200218.columns.values.tolist():
    daily_20200218_addname_dataframe[table_name] = daily_20200218[table_name]
print("日线行情-时间为序  daily_20200218 返回数据 row 行数 = "+str(daily_20200218.shape[0]))
daily_20200218_addname_dataframe.to_excel(daily_202002_excel_writer,'18_2',index=False)
daily_202002_excel_writer.save()
daily_20200219 = pro.daily(start_date='',end_date='',trade_date='20200219', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20200219_tscode_list = list() 
for ts_code_sh in daily_20200219['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20200219_tscode_list.append(stock_name)
daily_20200219_addname_dataframe=pd.DataFrame()
daily_20200219_addname_dataframe['cname'] = daily_20200219_tscode_list
for table_name in daily_20200219.columns.values.tolist():
    daily_20200219_addname_dataframe[table_name] = daily_20200219[table_name]
print("日线行情-时间为序  daily_20200219 返回数据 row 行数 = "+str(daily_20200219.shape[0]))
daily_20200219_addname_dataframe.to_excel(daily_202002_excel_writer,'19_3',index=False)
daily_202002_excel_writer.save()
daily_20200220 = pro.daily(start_date='',end_date='',trade_date='20200220', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20200220_tscode_list = list() 
for ts_code_sh in daily_20200220['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20200220_tscode_list.append(stock_name)
daily_20200220_addname_dataframe=pd.DataFrame()
daily_20200220_addname_dataframe['cname'] = daily_20200220_tscode_list
for table_name in daily_20200220.columns.values.tolist():
    daily_20200220_addname_dataframe[table_name] = daily_20200220[table_name]
print("日线行情-时间为序  daily_20200220 返回数据 row 行数 = "+str(daily_20200220.shape[0]))
daily_20200220_addname_dataframe.to_excel(daily_202002_excel_writer,'20_4',index=False)
daily_202002_excel_writer.save()
daily_20200221 = pro.daily(start_date='',end_date='',trade_date='20200221', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20200221_tscode_list = list() 
for ts_code_sh in daily_20200221['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20200221_tscode_list.append(stock_name)
daily_20200221_addname_dataframe=pd.DataFrame()
daily_20200221_addname_dataframe['cname'] = daily_20200221_tscode_list
for table_name in daily_20200221.columns.values.tolist():
    daily_20200221_addname_dataframe[table_name] = daily_20200221[table_name]
print("日线行情-时间为序  daily_20200221 返回数据 row 行数 = "+str(daily_20200221.shape[0]))
daily_20200221_addname_dataframe.to_excel(daily_202002_excel_writer,'21_5',index=False)
daily_202002_excel_writer.save()
daily_20200224 = pro.daily(start_date='',end_date='',trade_date='20200224', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20200224_tscode_list = list() 
for ts_code_sh in daily_20200224['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20200224_tscode_list.append(stock_name)
daily_20200224_addname_dataframe=pd.DataFrame()
daily_20200224_addname_dataframe['cname'] = daily_20200224_tscode_list
for table_name in daily_20200224.columns.values.tolist():
    daily_20200224_addname_dataframe[table_name] = daily_20200224[table_name]
print("日线行情-时间为序  daily_20200224 返回数据 row 行数 = "+str(daily_20200224.shape[0]))
daily_20200224_addname_dataframe.to_excel(daily_202002_excel_writer,'24_1',index=False)
daily_202002_excel_writer.save()
daily_20200225 = pro.daily(start_date='',end_date='',trade_date='20200225', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20200225_tscode_list = list() 
for ts_code_sh in daily_20200225['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20200225_tscode_list.append(stock_name)
daily_20200225_addname_dataframe=pd.DataFrame()
daily_20200225_addname_dataframe['cname'] = daily_20200225_tscode_list
for table_name in daily_20200225.columns.values.tolist():
    daily_20200225_addname_dataframe[table_name] = daily_20200225[table_name]
print("日线行情-时间为序  daily_20200225 返回数据 row 行数 = "+str(daily_20200225.shape[0]))
daily_20200225_addname_dataframe.to_excel(daily_202002_excel_writer,'25_2',index=False)
daily_202002_excel_writer.save()
daily_20200226 = pro.daily(start_date='',end_date='',trade_date='20200226', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20200226_tscode_list = list() 
for ts_code_sh in daily_20200226['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20200226_tscode_list.append(stock_name)
daily_20200226_addname_dataframe=pd.DataFrame()
daily_20200226_addname_dataframe['cname'] = daily_20200226_tscode_list
for table_name in daily_20200226.columns.values.tolist():
    daily_20200226_addname_dataframe[table_name] = daily_20200226[table_name]
print("日线行情-时间为序  daily_20200226 返回数据 row 行数 = "+str(daily_20200226.shape[0]))
daily_20200226_addname_dataframe.to_excel(daily_202002_excel_writer,'26_3',index=False)
daily_202002_excel_writer.save()
daily_20200227 = pro.daily(start_date='',end_date='',trade_date='20200227', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20200227_tscode_list = list() 
for ts_code_sh in daily_20200227['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20200227_tscode_list.append(stock_name)
daily_20200227_addname_dataframe=pd.DataFrame()
daily_20200227_addname_dataframe['cname'] = daily_20200227_tscode_list
for table_name in daily_20200227.columns.values.tolist():
    daily_20200227_addname_dataframe[table_name] = daily_20200227[table_name]
print("日线行情-时间为序  daily_20200227 返回数据 row 行数 = "+str(daily_20200227.shape[0]))
daily_20200227_addname_dataframe.to_excel(daily_202002_excel_writer,'27_4',index=False)
daily_202002_excel_writer.save()
daily_20200228 = pro.daily(start_date='',end_date='',trade_date='20200228', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20200228_tscode_list = list() 
for ts_code_sh in daily_20200228['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20200228_tscode_list.append(stock_name)
daily_20200228_addname_dataframe=pd.DataFrame()
daily_20200228_addname_dataframe['cname'] = daily_20200228_tscode_list
for table_name in daily_20200228.columns.values.tolist():
    daily_20200228_addname_dataframe[table_name] = daily_20200228[table_name]
print("日线行情-时间为序  daily_20200228 返回数据 row 行数 = "+str(daily_20200228.shape[0]))
daily_20200228_addname_dataframe.to_excel(daily_202002_excel_writer,'28_5',index=False)
daily_202002_excel_writer.save()




createexcel('daily_202003.xlsx')
daily_202003_book = load_workbook('C:\\Users\\zhuzj5\\Desktop\\zbin\\J0_Data\\daily_202003.xlsx')
daily_202003_excel_writer = pd.ExcelWriter('C:\\Users\\zhuzj5\\Desktop\\zbin\\J0_Data\\daily_202003.xlsx', engine='openpyxl')
daily_202003_excel_writer.book = daily_202003_book
daily_202003_excel_writer.sheets = dict((ws.title, ws) for ws in daily_202003_book.worksheets)
J0_PROPS.put(tree_node_name+"record_date", "20200301")       ###  更新 记录日期
daily_20200302 = pro.daily(start_date='',end_date='',trade_date='20200302', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20200302_tscode_list = list() 
for ts_code_sh in daily_20200302['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20200302_tscode_list.append(stock_name)
daily_20200302_addname_dataframe=pd.DataFrame()
daily_20200302_addname_dataframe['cname'] = daily_20200302_tscode_list
for table_name in daily_20200302.columns.values.tolist():
    daily_20200302_addname_dataframe[table_name] = daily_20200302[table_name]
print("日线行情-时间为序  daily_20200302 返回数据 row 行数 = "+str(daily_20200302.shape[0]))
daily_20200302_addname_dataframe.to_excel(daily_202003_excel_writer,'2_1',index=False)
daily_202003_excel_writer.save()
daily_20200303 = pro.daily(start_date='',end_date='',trade_date='20200303', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20200303_tscode_list = list() 
for ts_code_sh in daily_20200303['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20200303_tscode_list.append(stock_name)
daily_20200303_addname_dataframe=pd.DataFrame()
daily_20200303_addname_dataframe['cname'] = daily_20200303_tscode_list
for table_name in daily_20200303.columns.values.tolist():
    daily_20200303_addname_dataframe[table_name] = daily_20200303[table_name]
print("日线行情-时间为序  daily_20200303 返回数据 row 行数 = "+str(daily_20200303.shape[0]))
daily_20200303_addname_dataframe.to_excel(daily_202003_excel_writer,'3_2',index=False)
daily_202003_excel_writer.save()
daily_20200304 = pro.daily(start_date='',end_date='',trade_date='20200304', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20200304_tscode_list = list() 
for ts_code_sh in daily_20200304['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20200304_tscode_list.append(stock_name)
daily_20200304_addname_dataframe=pd.DataFrame()
daily_20200304_addname_dataframe['cname'] = daily_20200304_tscode_list
for table_name in daily_20200304.columns.values.tolist():
    daily_20200304_addname_dataframe[table_name] = daily_20200304[table_name]
print("日线行情-时间为序  daily_20200304 返回数据 row 行数 = "+str(daily_20200304.shape[0]))
daily_20200304_addname_dataframe.to_excel(daily_202003_excel_writer,'4_3',index=False)
daily_202003_excel_writer.save()
daily_20200305 = pro.daily(start_date='',end_date='',trade_date='20200305', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20200305_tscode_list = list() 
for ts_code_sh in daily_20200305['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20200305_tscode_list.append(stock_name)
daily_20200305_addname_dataframe=pd.DataFrame()
daily_20200305_addname_dataframe['cname'] = daily_20200305_tscode_list
for table_name in daily_20200305.columns.values.tolist():
    daily_20200305_addname_dataframe[table_name] = daily_20200305[table_name]
print("日线行情-时间为序  daily_20200305 返回数据 row 行数 = "+str(daily_20200305.shape[0]))
daily_20200305_addname_dataframe.to_excel(daily_202003_excel_writer,'5_4',index=False)
daily_202003_excel_writer.save()
daily_20200306 = pro.daily(start_date='',end_date='',trade_date='20200306', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20200306_tscode_list = list() 
for ts_code_sh in daily_20200306['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20200306_tscode_list.append(stock_name)
daily_20200306_addname_dataframe=pd.DataFrame()
daily_20200306_addname_dataframe['cname'] = daily_20200306_tscode_list
for table_name in daily_20200306.columns.values.tolist():
    daily_20200306_addname_dataframe[table_name] = daily_20200306[table_name]
print("日线行情-时间为序  daily_20200306 返回数据 row 行数 = "+str(daily_20200306.shape[0]))
daily_20200306_addname_dataframe.to_excel(daily_202003_excel_writer,'6_5',index=False)
daily_202003_excel_writer.save()
daily_20200309 = pro.daily(start_date='',end_date='',trade_date='20200309', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20200309_tscode_list = list() 
for ts_code_sh in daily_20200309['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20200309_tscode_list.append(stock_name)
daily_20200309_addname_dataframe=pd.DataFrame()
daily_20200309_addname_dataframe['cname'] = daily_20200309_tscode_list
for table_name in daily_20200309.columns.values.tolist():
    daily_20200309_addname_dataframe[table_name] = daily_20200309[table_name]
print("日线行情-时间为序  daily_20200309 返回数据 row 行数 = "+str(daily_20200309.shape[0]))
daily_20200309_addname_dataframe.to_excel(daily_202003_excel_writer,'9_1',index=False)
daily_202003_excel_writer.save()
daily_20200310 = pro.daily(start_date='',end_date='',trade_date='20200310', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20200310_tscode_list = list() 
for ts_code_sh in daily_20200310['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20200310_tscode_list.append(stock_name)
daily_20200310_addname_dataframe=pd.DataFrame()
daily_20200310_addname_dataframe['cname'] = daily_20200310_tscode_list
for table_name in daily_20200310.columns.values.tolist():
    daily_20200310_addname_dataframe[table_name] = daily_20200310[table_name]
print("日线行情-时间为序  daily_20200310 返回数据 row 行数 = "+str(daily_20200310.shape[0]))
daily_20200310_addname_dataframe.to_excel(daily_202003_excel_writer,'10_2',index=False)
daily_202003_excel_writer.save()
daily_20200311 = pro.daily(start_date='',end_date='',trade_date='20200311', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20200311_tscode_list = list() 
for ts_code_sh in daily_20200311['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20200311_tscode_list.append(stock_name)
daily_20200311_addname_dataframe=pd.DataFrame()
daily_20200311_addname_dataframe['cname'] = daily_20200311_tscode_list
for table_name in daily_20200311.columns.values.tolist():
    daily_20200311_addname_dataframe[table_name] = daily_20200311[table_name]
print("日线行情-时间为序  daily_20200311 返回数据 row 行数 = "+str(daily_20200311.shape[0]))
daily_20200311_addname_dataframe.to_excel(daily_202003_excel_writer,'11_3',index=False)
daily_202003_excel_writer.save()
daily_20200312 = pro.daily(start_date='',end_date='',trade_date='20200312', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20200312_tscode_list = list() 
for ts_code_sh in daily_20200312['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20200312_tscode_list.append(stock_name)
daily_20200312_addname_dataframe=pd.DataFrame()
daily_20200312_addname_dataframe['cname'] = daily_20200312_tscode_list
for table_name in daily_20200312.columns.values.tolist():
    daily_20200312_addname_dataframe[table_name] = daily_20200312[table_name]
print("日线行情-时间为序  daily_20200312 返回数据 row 行数 = "+str(daily_20200312.shape[0]))
daily_20200312_addname_dataframe.to_excel(daily_202003_excel_writer,'12_4',index=False)
daily_202003_excel_writer.save()
daily_20200313 = pro.daily(start_date='',end_date='',trade_date='20200313', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20200313_tscode_list = list() 
for ts_code_sh in daily_20200313['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20200313_tscode_list.append(stock_name)
daily_20200313_addname_dataframe=pd.DataFrame()
daily_20200313_addname_dataframe['cname'] = daily_20200313_tscode_list
for table_name in daily_20200313.columns.values.tolist():
    daily_20200313_addname_dataframe[table_name] = daily_20200313[table_name]
print("日线行情-时间为序  daily_20200313 返回数据 row 行数 = "+str(daily_20200313.shape[0]))
daily_20200313_addname_dataframe.to_excel(daily_202003_excel_writer,'13_5',index=False)
daily_202003_excel_writer.save()
daily_20200316 = pro.daily(start_date='',end_date='',trade_date='20200316', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20200316_tscode_list = list() 
for ts_code_sh in daily_20200316['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20200316_tscode_list.append(stock_name)
daily_20200316_addname_dataframe=pd.DataFrame()
daily_20200316_addname_dataframe['cname'] = daily_20200316_tscode_list
for table_name in daily_20200316.columns.values.tolist():
    daily_20200316_addname_dataframe[table_name] = daily_20200316[table_name]
print("日线行情-时间为序  daily_20200316 返回数据 row 行数 = "+str(daily_20200316.shape[0]))
daily_20200316_addname_dataframe.to_excel(daily_202003_excel_writer,'16_1',index=False)
daily_202003_excel_writer.save()
daily_20200317 = pro.daily(start_date='',end_date='',trade_date='20200317', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20200317_tscode_list = list() 
for ts_code_sh in daily_20200317['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20200317_tscode_list.append(stock_name)
daily_20200317_addname_dataframe=pd.DataFrame()
daily_20200317_addname_dataframe['cname'] = daily_20200317_tscode_list
for table_name in daily_20200317.columns.values.tolist():
    daily_20200317_addname_dataframe[table_name] = daily_20200317[table_name]
print("日线行情-时间为序  daily_20200317 返回数据 row 行数 = "+str(daily_20200317.shape[0]))
daily_20200317_addname_dataframe.to_excel(daily_202003_excel_writer,'17_2',index=False)
daily_202003_excel_writer.save()
daily_20200318 = pro.daily(start_date='',end_date='',trade_date='20200318', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20200318_tscode_list = list() 
for ts_code_sh in daily_20200318['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20200318_tscode_list.append(stock_name)
daily_20200318_addname_dataframe=pd.DataFrame()
daily_20200318_addname_dataframe['cname'] = daily_20200318_tscode_list
for table_name in daily_20200318.columns.values.tolist():
    daily_20200318_addname_dataframe[table_name] = daily_20200318[table_name]
print("日线行情-时间为序  daily_20200318 返回数据 row 行数 = "+str(daily_20200318.shape[0]))
daily_20200318_addname_dataframe.to_excel(daily_202003_excel_writer,'18_3',index=False)
daily_202003_excel_writer.save()
daily_20200319 = pro.daily(start_date='',end_date='',trade_date='20200319', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20200319_tscode_list = list() 
for ts_code_sh in daily_20200319['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20200319_tscode_list.append(stock_name)
daily_20200319_addname_dataframe=pd.DataFrame()
daily_20200319_addname_dataframe['cname'] = daily_20200319_tscode_list
for table_name in daily_20200319.columns.values.tolist():
    daily_20200319_addname_dataframe[table_name] = daily_20200319[table_name]
print("日线行情-时间为序  daily_20200319 返回数据 row 行数 = "+str(daily_20200319.shape[0]))
daily_20200319_addname_dataframe.to_excel(daily_202003_excel_writer,'19_4',index=False)
daily_202003_excel_writer.save()
daily_20200320 = pro.daily(start_date='',end_date='',trade_date='20200320', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20200320_tscode_list = list() 
for ts_code_sh in daily_20200320['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20200320_tscode_list.append(stock_name)
daily_20200320_addname_dataframe=pd.DataFrame()
daily_20200320_addname_dataframe['cname'] = daily_20200320_tscode_list
for table_name in daily_20200320.columns.values.tolist():
    daily_20200320_addname_dataframe[table_name] = daily_20200320[table_name]
print("日线行情-时间为序  daily_20200320 返回数据 row 行数 = "+str(daily_20200320.shape[0]))
daily_20200320_addname_dataframe.to_excel(daily_202003_excel_writer,'20_5',index=False)
daily_202003_excel_writer.save()
daily_20200323 = pro.daily(start_date='',end_date='',trade_date='20200323', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20200323_tscode_list = list() 
for ts_code_sh in daily_20200323['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20200323_tscode_list.append(stock_name)
daily_20200323_addname_dataframe=pd.DataFrame()
daily_20200323_addname_dataframe['cname'] = daily_20200323_tscode_list
for table_name in daily_20200323.columns.values.tolist():
    daily_20200323_addname_dataframe[table_name] = daily_20200323[table_name]
print("日线行情-时间为序  daily_20200323 返回数据 row 行数 = "+str(daily_20200323.shape[0]))
daily_20200323_addname_dataframe.to_excel(daily_202003_excel_writer,'23_1',index=False)
daily_202003_excel_writer.save()
daily_20200324 = pro.daily(start_date='',end_date='',trade_date='20200324', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20200324_tscode_list = list() 
for ts_code_sh in daily_20200324['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20200324_tscode_list.append(stock_name)
daily_20200324_addname_dataframe=pd.DataFrame()
daily_20200324_addname_dataframe['cname'] = daily_20200324_tscode_list
for table_name in daily_20200324.columns.values.tolist():
    daily_20200324_addname_dataframe[table_name] = daily_20200324[table_name]
print("日线行情-时间为序  daily_20200324 返回数据 row 行数 = "+str(daily_20200324.shape[0]))
daily_20200324_addname_dataframe.to_excel(daily_202003_excel_writer,'24_2',index=False)
daily_202003_excel_writer.save()
daily_20200325 = pro.daily(start_date='',end_date='',trade_date='20200325', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20200325_tscode_list = list() 
for ts_code_sh in daily_20200325['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20200325_tscode_list.append(stock_name)
daily_20200325_addname_dataframe=pd.DataFrame()
daily_20200325_addname_dataframe['cname'] = daily_20200325_tscode_list
for table_name in daily_20200325.columns.values.tolist():
    daily_20200325_addname_dataframe[table_name] = daily_20200325[table_name]
print("日线行情-时间为序  daily_20200325 返回数据 row 行数 = "+str(daily_20200325.shape[0]))
daily_20200325_addname_dataframe.to_excel(daily_202003_excel_writer,'25_3',index=False)
daily_202003_excel_writer.save()
daily_20200326 = pro.daily(start_date='',end_date='',trade_date='20200326', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20200326_tscode_list = list() 
for ts_code_sh in daily_20200326['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20200326_tscode_list.append(stock_name)
daily_20200326_addname_dataframe=pd.DataFrame()
daily_20200326_addname_dataframe['cname'] = daily_20200326_tscode_list
for table_name in daily_20200326.columns.values.tolist():
    daily_20200326_addname_dataframe[table_name] = daily_20200326[table_name]
print("日线行情-时间为序  daily_20200326 返回数据 row 行数 = "+str(daily_20200326.shape[0]))
daily_20200326_addname_dataframe.to_excel(daily_202003_excel_writer,'26_4',index=False)
daily_202003_excel_writer.save()
daily_20200327 = pro.daily(start_date='',end_date='',trade_date='20200327', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20200327_tscode_list = list() 
for ts_code_sh in daily_20200327['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20200327_tscode_list.append(stock_name)
daily_20200327_addname_dataframe=pd.DataFrame()
daily_20200327_addname_dataframe['cname'] = daily_20200327_tscode_list
for table_name in daily_20200327.columns.values.tolist():
    daily_20200327_addname_dataframe[table_name] = daily_20200327[table_name]
print("日线行情-时间为序  daily_20200327 返回数据 row 行数 = "+str(daily_20200327.shape[0]))
daily_20200327_addname_dataframe.to_excel(daily_202003_excel_writer,'27_5',index=False)
daily_202003_excel_writer.save()
daily_20200330 = pro.daily(start_date='',end_date='',trade_date='20200330', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20200330_tscode_list = list() 
for ts_code_sh in daily_20200330['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20200330_tscode_list.append(stock_name)
daily_20200330_addname_dataframe=pd.DataFrame()
daily_20200330_addname_dataframe['cname'] = daily_20200330_tscode_list
for table_name in daily_20200330.columns.values.tolist():
    daily_20200330_addname_dataframe[table_name] = daily_20200330[table_name]
print("日线行情-时间为序  daily_20200330 返回数据 row 行数 = "+str(daily_20200330.shape[0]))
daily_20200330_addname_dataframe.to_excel(daily_202003_excel_writer,'30_1',index=False)
daily_202003_excel_writer.save()
daily_20200331 = pro.daily(start_date='',end_date='',trade_date='20200331', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20200331_tscode_list = list() 
for ts_code_sh in daily_20200331['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20200331_tscode_list.append(stock_name)
daily_20200331_addname_dataframe=pd.DataFrame()
daily_20200331_addname_dataframe['cname'] = daily_20200331_tscode_list
for table_name in daily_20200331.columns.values.tolist():
    daily_20200331_addname_dataframe[table_name] = daily_20200331[table_name]
print("日线行情-时间为序  daily_20200331 返回数据 row 行数 = "+str(daily_20200331.shape[0]))
daily_20200331_addname_dataframe.to_excel(daily_202003_excel_writer,'31_2',index=False)
daily_202003_excel_writer.save()




createexcel('daily_202004.xlsx')
daily_202004_book = load_workbook('C:\\Users\\zhuzj5\\Desktop\\zbin\\J0_Data\\daily_202004.xlsx')
daily_202004_excel_writer = pd.ExcelWriter('C:\\Users\\zhuzj5\\Desktop\\zbin\\J0_Data\\daily_202004.xlsx', engine='openpyxl')
daily_202004_excel_writer.book = daily_202004_book
daily_202004_excel_writer.sheets = dict((ws.title, ws) for ws in daily_202004_book.worksheets)
J0_PROPS.put(tree_node_name+"record_date", "20200401")       ###  更新 记录日期
daily_20200401 = pro.daily(start_date='',end_date='',trade_date='20200401', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20200401_tscode_list = list() 
for ts_code_sh in daily_20200401['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20200401_tscode_list.append(stock_name)
daily_20200401_addname_dataframe=pd.DataFrame()
daily_20200401_addname_dataframe['cname'] = daily_20200401_tscode_list
for table_name in daily_20200401.columns.values.tolist():
    daily_20200401_addname_dataframe[table_name] = daily_20200401[table_name]
print("日线行情-时间为序  daily_20200401 返回数据 row 行数 = "+str(daily_20200401.shape[0]))
daily_20200401_addname_dataframe.to_excel(daily_202004_excel_writer,'1_3',index=False)
daily_202004_excel_writer.save()
daily_20200402 = pro.daily(start_date='',end_date='',trade_date='20200402', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20200402_tscode_list = list() 
for ts_code_sh in daily_20200402['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20200402_tscode_list.append(stock_name)
daily_20200402_addname_dataframe=pd.DataFrame()
daily_20200402_addname_dataframe['cname'] = daily_20200402_tscode_list
for table_name in daily_20200402.columns.values.tolist():
    daily_20200402_addname_dataframe[table_name] = daily_20200402[table_name]
print("日线行情-时间为序  daily_20200402 返回数据 row 行数 = "+str(daily_20200402.shape[0]))
daily_20200402_addname_dataframe.to_excel(daily_202004_excel_writer,'2_4',index=False)
daily_202004_excel_writer.save()
daily_20200403 = pro.daily(start_date='',end_date='',trade_date='20200403', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20200403_tscode_list = list() 
for ts_code_sh in daily_20200403['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20200403_tscode_list.append(stock_name)
daily_20200403_addname_dataframe=pd.DataFrame()
daily_20200403_addname_dataframe['cname'] = daily_20200403_tscode_list
for table_name in daily_20200403.columns.values.tolist():
    daily_20200403_addname_dataframe[table_name] = daily_20200403[table_name]
print("日线行情-时间为序  daily_20200403 返回数据 row 行数 = "+str(daily_20200403.shape[0]))
daily_20200403_addname_dataframe.to_excel(daily_202004_excel_writer,'3_5',index=False)
daily_202004_excel_writer.save()
daily_20200407 = pro.daily(start_date='',end_date='',trade_date='20200407', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20200407_tscode_list = list() 
for ts_code_sh in daily_20200407['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20200407_tscode_list.append(stock_name)
daily_20200407_addname_dataframe=pd.DataFrame()
daily_20200407_addname_dataframe['cname'] = daily_20200407_tscode_list
for table_name in daily_20200407.columns.values.tolist():
    daily_20200407_addname_dataframe[table_name] = daily_20200407[table_name]
print("日线行情-时间为序  daily_20200407 返回数据 row 行数 = "+str(daily_20200407.shape[0]))
daily_20200407_addname_dataframe.to_excel(daily_202004_excel_writer,'7_2',index=False)
daily_202004_excel_writer.save()
daily_20200408 = pro.daily(start_date='',end_date='',trade_date='20200408', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20200408_tscode_list = list() 
for ts_code_sh in daily_20200408['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20200408_tscode_list.append(stock_name)
daily_20200408_addname_dataframe=pd.DataFrame()
daily_20200408_addname_dataframe['cname'] = daily_20200408_tscode_list
for table_name in daily_20200408.columns.values.tolist():
    daily_20200408_addname_dataframe[table_name] = daily_20200408[table_name]
print("日线行情-时间为序  daily_20200408 返回数据 row 行数 = "+str(daily_20200408.shape[0]))
daily_20200408_addname_dataframe.to_excel(daily_202004_excel_writer,'8_3',index=False)
daily_202004_excel_writer.save()
daily_20200409 = pro.daily(start_date='',end_date='',trade_date='20200409', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20200409_tscode_list = list() 
for ts_code_sh in daily_20200409['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20200409_tscode_list.append(stock_name)
daily_20200409_addname_dataframe=pd.DataFrame()
daily_20200409_addname_dataframe['cname'] = daily_20200409_tscode_list
for table_name in daily_20200409.columns.values.tolist():
    daily_20200409_addname_dataframe[table_name] = daily_20200409[table_name]
print("日线行情-时间为序  daily_20200409 返回数据 row 行数 = "+str(daily_20200409.shape[0]))
daily_20200409_addname_dataframe.to_excel(daily_202004_excel_writer,'9_4',index=False)
daily_202004_excel_writer.save()
daily_20200410 = pro.daily(start_date='',end_date='',trade_date='20200410', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20200410_tscode_list = list() 
for ts_code_sh in daily_20200410['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20200410_tscode_list.append(stock_name)
daily_20200410_addname_dataframe=pd.DataFrame()
daily_20200410_addname_dataframe['cname'] = daily_20200410_tscode_list
for table_name in daily_20200410.columns.values.tolist():
    daily_20200410_addname_dataframe[table_name] = daily_20200410[table_name]
print("日线行情-时间为序  daily_20200410 返回数据 row 行数 = "+str(daily_20200410.shape[0]))
daily_20200410_addname_dataframe.to_excel(daily_202004_excel_writer,'10_5',index=False)
daily_202004_excel_writer.save()
daily_20200413 = pro.daily(start_date='',end_date='',trade_date='20200413', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20200413_tscode_list = list() 
for ts_code_sh in daily_20200413['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20200413_tscode_list.append(stock_name)
daily_20200413_addname_dataframe=pd.DataFrame()
daily_20200413_addname_dataframe['cname'] = daily_20200413_tscode_list
for table_name in daily_20200413.columns.values.tolist():
    daily_20200413_addname_dataframe[table_name] = daily_20200413[table_name]
print("日线行情-时间为序  daily_20200413 返回数据 row 行数 = "+str(daily_20200413.shape[0]))
daily_20200413_addname_dataframe.to_excel(daily_202004_excel_writer,'13_1',index=False)
daily_202004_excel_writer.save()
daily_20200414 = pro.daily(start_date='',end_date='',trade_date='20200414', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20200414_tscode_list = list() 
for ts_code_sh in daily_20200414['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20200414_tscode_list.append(stock_name)
daily_20200414_addname_dataframe=pd.DataFrame()
daily_20200414_addname_dataframe['cname'] = daily_20200414_tscode_list
for table_name in daily_20200414.columns.values.tolist():
    daily_20200414_addname_dataframe[table_name] = daily_20200414[table_name]
print("日线行情-时间为序  daily_20200414 返回数据 row 行数 = "+str(daily_20200414.shape[0]))
daily_20200414_addname_dataframe.to_excel(daily_202004_excel_writer,'14_2',index=False)
daily_202004_excel_writer.save()
daily_20200415 = pro.daily(start_date='',end_date='',trade_date='20200415', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20200415_tscode_list = list() 
for ts_code_sh in daily_20200415['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20200415_tscode_list.append(stock_name)
daily_20200415_addname_dataframe=pd.DataFrame()
daily_20200415_addname_dataframe['cname'] = daily_20200415_tscode_list
for table_name in daily_20200415.columns.values.tolist():
    daily_20200415_addname_dataframe[table_name] = daily_20200415[table_name]
print("日线行情-时间为序  daily_20200415 返回数据 row 行数 = "+str(daily_20200415.shape[0]))
daily_20200415_addname_dataframe.to_excel(daily_202004_excel_writer,'15_3',index=False)
daily_202004_excel_writer.save()
daily_20200416 = pro.daily(start_date='',end_date='',trade_date='20200416', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20200416_tscode_list = list() 
for ts_code_sh in daily_20200416['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20200416_tscode_list.append(stock_name)
daily_20200416_addname_dataframe=pd.DataFrame()
daily_20200416_addname_dataframe['cname'] = daily_20200416_tscode_list
for table_name in daily_20200416.columns.values.tolist():
    daily_20200416_addname_dataframe[table_name] = daily_20200416[table_name]
print("日线行情-时间为序  daily_20200416 返回数据 row 行数 = "+str(daily_20200416.shape[0]))
daily_20200416_addname_dataframe.to_excel(daily_202004_excel_writer,'16_4',index=False)
daily_202004_excel_writer.save()
daily_20200417 = pro.daily(start_date='',end_date='',trade_date='20200417', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20200417_tscode_list = list() 
for ts_code_sh in daily_20200417['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20200417_tscode_list.append(stock_name)
daily_20200417_addname_dataframe=pd.DataFrame()
daily_20200417_addname_dataframe['cname'] = daily_20200417_tscode_list
for table_name in daily_20200417.columns.values.tolist():
    daily_20200417_addname_dataframe[table_name] = daily_20200417[table_name]
print("日线行情-时间为序  daily_20200417 返回数据 row 行数 = "+str(daily_20200417.shape[0]))
daily_20200417_addname_dataframe.to_excel(daily_202004_excel_writer,'17_5',index=False)
daily_202004_excel_writer.save()
daily_20200420 = pro.daily(start_date='',end_date='',trade_date='20200420', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20200420_tscode_list = list() 
for ts_code_sh in daily_20200420['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20200420_tscode_list.append(stock_name)
daily_20200420_addname_dataframe=pd.DataFrame()
daily_20200420_addname_dataframe['cname'] = daily_20200420_tscode_list
for table_name in daily_20200420.columns.values.tolist():
    daily_20200420_addname_dataframe[table_name] = daily_20200420[table_name]
print("日线行情-时间为序  daily_20200420 返回数据 row 行数 = "+str(daily_20200420.shape[0]))
daily_20200420_addname_dataframe.to_excel(daily_202004_excel_writer,'20_1',index=False)
daily_202004_excel_writer.save()
daily_20200421 = pro.daily(start_date='',end_date='',trade_date='20200421', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20200421_tscode_list = list() 
for ts_code_sh in daily_20200421['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20200421_tscode_list.append(stock_name)
daily_20200421_addname_dataframe=pd.DataFrame()
daily_20200421_addname_dataframe['cname'] = daily_20200421_tscode_list
for table_name in daily_20200421.columns.values.tolist():
    daily_20200421_addname_dataframe[table_name] = daily_20200421[table_name]
print("日线行情-时间为序  daily_20200421 返回数据 row 行数 = "+str(daily_20200421.shape[0]))
daily_20200421_addname_dataframe.to_excel(daily_202004_excel_writer,'21_2',index=False)
daily_202004_excel_writer.save()
daily_20200422 = pro.daily(start_date='',end_date='',trade_date='20200422', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20200422_tscode_list = list() 
for ts_code_sh in daily_20200422['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20200422_tscode_list.append(stock_name)
daily_20200422_addname_dataframe=pd.DataFrame()
daily_20200422_addname_dataframe['cname'] = daily_20200422_tscode_list
for table_name in daily_20200422.columns.values.tolist():
    daily_20200422_addname_dataframe[table_name] = daily_20200422[table_name]
print("日线行情-时间为序  daily_20200422 返回数据 row 行数 = "+str(daily_20200422.shape[0]))
daily_20200422_addname_dataframe.to_excel(daily_202004_excel_writer,'22_3',index=False)
daily_202004_excel_writer.save()
daily_20200423 = pro.daily(start_date='',end_date='',trade_date='20200423', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20200423_tscode_list = list() 
for ts_code_sh in daily_20200423['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20200423_tscode_list.append(stock_name)
daily_20200423_addname_dataframe=pd.DataFrame()
daily_20200423_addname_dataframe['cname'] = daily_20200423_tscode_list
for table_name in daily_20200423.columns.values.tolist():
    daily_20200423_addname_dataframe[table_name] = daily_20200423[table_name]
print("日线行情-时间为序  daily_20200423 返回数据 row 行数 = "+str(daily_20200423.shape[0]))
daily_20200423_addname_dataframe.to_excel(daily_202004_excel_writer,'23_4',index=False)
daily_202004_excel_writer.save()
daily_20200424 = pro.daily(start_date='',end_date='',trade_date='20200424', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20200424_tscode_list = list() 
for ts_code_sh in daily_20200424['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20200424_tscode_list.append(stock_name)
daily_20200424_addname_dataframe=pd.DataFrame()
daily_20200424_addname_dataframe['cname'] = daily_20200424_tscode_list
for table_name in daily_20200424.columns.values.tolist():
    daily_20200424_addname_dataframe[table_name] = daily_20200424[table_name]
print("日线行情-时间为序  daily_20200424 返回数据 row 行数 = "+str(daily_20200424.shape[0]))
daily_20200424_addname_dataframe.to_excel(daily_202004_excel_writer,'24_5',index=False)
daily_202004_excel_writer.save()
daily_20200427 = pro.daily(start_date='',end_date='',trade_date='20200427', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20200427_tscode_list = list() 
for ts_code_sh in daily_20200427['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20200427_tscode_list.append(stock_name)
daily_20200427_addname_dataframe=pd.DataFrame()
daily_20200427_addname_dataframe['cname'] = daily_20200427_tscode_list
for table_name in daily_20200427.columns.values.tolist():
    daily_20200427_addname_dataframe[table_name] = daily_20200427[table_name]
print("日线行情-时间为序  daily_20200427 返回数据 row 行数 = "+str(daily_20200427.shape[0]))
daily_20200427_addname_dataframe.to_excel(daily_202004_excel_writer,'27_1',index=False)
daily_202004_excel_writer.save()
daily_20200428 = pro.daily(start_date='',end_date='',trade_date='20200428', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20200428_tscode_list = list() 
for ts_code_sh in daily_20200428['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20200428_tscode_list.append(stock_name)
daily_20200428_addname_dataframe=pd.DataFrame()
daily_20200428_addname_dataframe['cname'] = daily_20200428_tscode_list
for table_name in daily_20200428.columns.values.tolist():
    daily_20200428_addname_dataframe[table_name] = daily_20200428[table_name]
print("日线行情-时间为序  daily_20200428 返回数据 row 行数 = "+str(daily_20200428.shape[0]))
daily_20200428_addname_dataframe.to_excel(daily_202004_excel_writer,'28_2',index=False)
daily_202004_excel_writer.save()
daily_20200429 = pro.daily(start_date='',end_date='',trade_date='20200429', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20200429_tscode_list = list() 
for ts_code_sh in daily_20200429['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20200429_tscode_list.append(stock_name)
daily_20200429_addname_dataframe=pd.DataFrame()
daily_20200429_addname_dataframe['cname'] = daily_20200429_tscode_list
for table_name in daily_20200429.columns.values.tolist():
    daily_20200429_addname_dataframe[table_name] = daily_20200429[table_name]
print("日线行情-时间为序  daily_20200429 返回数据 row 行数 = "+str(daily_20200429.shape[0]))
daily_20200429_addname_dataframe.to_excel(daily_202004_excel_writer,'29_3',index=False)
daily_202004_excel_writer.save()
daily_20200430 = pro.daily(start_date='',end_date='',trade_date='20200430', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20200430_tscode_list = list() 
for ts_code_sh in daily_20200430['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20200430_tscode_list.append(stock_name)
daily_20200430_addname_dataframe=pd.DataFrame()
daily_20200430_addname_dataframe['cname'] = daily_20200430_tscode_list
for table_name in daily_20200430.columns.values.tolist():
    daily_20200430_addname_dataframe[table_name] = daily_20200430[table_name]
print("日线行情-时间为序  daily_20200430 返回数据 row 行数 = "+str(daily_20200430.shape[0]))
daily_20200430_addname_dataframe.to_excel(daily_202004_excel_writer,'30_4',index=False)
daily_202004_excel_writer.save()




createexcel('daily_202005.xlsx')
daily_202005_book = load_workbook('C:\\Users\\zhuzj5\\Desktop\\zbin\\J0_Data\\daily_202005.xlsx')
daily_202005_excel_writer = pd.ExcelWriter('C:\\Users\\zhuzj5\\Desktop\\zbin\\J0_Data\\daily_202005.xlsx', engine='openpyxl')
daily_202005_excel_writer.book = daily_202005_book
daily_202005_excel_writer.sheets = dict((ws.title, ws) for ws in daily_202005_book.worksheets)
J0_PROPS.put(tree_node_name+"record_date", "20200501")       ###  更新 记录日期
daily_20200506 = pro.daily(start_date='',end_date='',trade_date='20200506', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20200506_tscode_list = list() 
for ts_code_sh in daily_20200506['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20200506_tscode_list.append(stock_name)
daily_20200506_addname_dataframe=pd.DataFrame()
daily_20200506_addname_dataframe['cname'] = daily_20200506_tscode_list
for table_name in daily_20200506.columns.values.tolist():
    daily_20200506_addname_dataframe[table_name] = daily_20200506[table_name]
print("日线行情-时间为序  daily_20200506 返回数据 row 行数 = "+str(daily_20200506.shape[0]))
daily_20200506_addname_dataframe.to_excel(daily_202005_excel_writer,'6_3',index=False)
daily_202005_excel_writer.save()
daily_20200507 = pro.daily(start_date='',end_date='',trade_date='20200507', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20200507_tscode_list = list() 
for ts_code_sh in daily_20200507['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20200507_tscode_list.append(stock_name)
daily_20200507_addname_dataframe=pd.DataFrame()
daily_20200507_addname_dataframe['cname'] = daily_20200507_tscode_list
for table_name in daily_20200507.columns.values.tolist():
    daily_20200507_addname_dataframe[table_name] = daily_20200507[table_name]
print("日线行情-时间为序  daily_20200507 返回数据 row 行数 = "+str(daily_20200507.shape[0]))
daily_20200507_addname_dataframe.to_excel(daily_202005_excel_writer,'7_4',index=False)
daily_202005_excel_writer.save()
daily_20200508 = pro.daily(start_date='',end_date='',trade_date='20200508', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20200508_tscode_list = list() 
for ts_code_sh in daily_20200508['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20200508_tscode_list.append(stock_name)
daily_20200508_addname_dataframe=pd.DataFrame()
daily_20200508_addname_dataframe['cname'] = daily_20200508_tscode_list
for table_name in daily_20200508.columns.values.tolist():
    daily_20200508_addname_dataframe[table_name] = daily_20200508[table_name]
print("日线行情-时间为序  daily_20200508 返回数据 row 行数 = "+str(daily_20200508.shape[0]))
daily_20200508_addname_dataframe.to_excel(daily_202005_excel_writer,'8_5',index=False)
daily_202005_excel_writer.save()
daily_20200511 = pro.daily(start_date='',end_date='',trade_date='20200511', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20200511_tscode_list = list() 
for ts_code_sh in daily_20200511['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20200511_tscode_list.append(stock_name)
daily_20200511_addname_dataframe=pd.DataFrame()
daily_20200511_addname_dataframe['cname'] = daily_20200511_tscode_list
for table_name in daily_20200511.columns.values.tolist():
    daily_20200511_addname_dataframe[table_name] = daily_20200511[table_name]
print("日线行情-时间为序  daily_20200511 返回数据 row 行数 = "+str(daily_20200511.shape[0]))
daily_20200511_addname_dataframe.to_excel(daily_202005_excel_writer,'11_1',index=False)
daily_202005_excel_writer.save()
daily_20200512 = pro.daily(start_date='',end_date='',trade_date='20200512', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20200512_tscode_list = list() 
for ts_code_sh in daily_20200512['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20200512_tscode_list.append(stock_name)
daily_20200512_addname_dataframe=pd.DataFrame()
daily_20200512_addname_dataframe['cname'] = daily_20200512_tscode_list
for table_name in daily_20200512.columns.values.tolist():
    daily_20200512_addname_dataframe[table_name] = daily_20200512[table_name]
print("日线行情-时间为序  daily_20200512 返回数据 row 行数 = "+str(daily_20200512.shape[0]))
daily_20200512_addname_dataframe.to_excel(daily_202005_excel_writer,'12_2',index=False)
daily_202005_excel_writer.save()
daily_20200513 = pro.daily(start_date='',end_date='',trade_date='20200513', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20200513_tscode_list = list() 
for ts_code_sh in daily_20200513['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20200513_tscode_list.append(stock_name)
daily_20200513_addname_dataframe=pd.DataFrame()
daily_20200513_addname_dataframe['cname'] = daily_20200513_tscode_list
for table_name in daily_20200513.columns.values.tolist():
    daily_20200513_addname_dataframe[table_name] = daily_20200513[table_name]
print("日线行情-时间为序  daily_20200513 返回数据 row 行数 = "+str(daily_20200513.shape[0]))
daily_20200513_addname_dataframe.to_excel(daily_202005_excel_writer,'13_3',index=False)
daily_202005_excel_writer.save()
daily_20200514 = pro.daily(start_date='',end_date='',trade_date='20200514', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20200514_tscode_list = list() 
for ts_code_sh in daily_20200514['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20200514_tscode_list.append(stock_name)
daily_20200514_addname_dataframe=pd.DataFrame()
daily_20200514_addname_dataframe['cname'] = daily_20200514_tscode_list
for table_name in daily_20200514.columns.values.tolist():
    daily_20200514_addname_dataframe[table_name] = daily_20200514[table_name]
print("日线行情-时间为序  daily_20200514 返回数据 row 行数 = "+str(daily_20200514.shape[0]))
daily_20200514_addname_dataframe.to_excel(daily_202005_excel_writer,'14_4',index=False)
daily_202005_excel_writer.save()
daily_20200515 = pro.daily(start_date='',end_date='',trade_date='20200515', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20200515_tscode_list = list() 
for ts_code_sh in daily_20200515['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20200515_tscode_list.append(stock_name)
daily_20200515_addname_dataframe=pd.DataFrame()
daily_20200515_addname_dataframe['cname'] = daily_20200515_tscode_list
for table_name in daily_20200515.columns.values.tolist():
    daily_20200515_addname_dataframe[table_name] = daily_20200515[table_name]
print("日线行情-时间为序  daily_20200515 返回数据 row 行数 = "+str(daily_20200515.shape[0]))
daily_20200515_addname_dataframe.to_excel(daily_202005_excel_writer,'15_5',index=False)
daily_202005_excel_writer.save()
daily_20200518 = pro.daily(start_date='',end_date='',trade_date='20200518', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20200518_tscode_list = list() 
for ts_code_sh in daily_20200518['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20200518_tscode_list.append(stock_name)
daily_20200518_addname_dataframe=pd.DataFrame()
daily_20200518_addname_dataframe['cname'] = daily_20200518_tscode_list
for table_name in daily_20200518.columns.values.tolist():
    daily_20200518_addname_dataframe[table_name] = daily_20200518[table_name]
print("日线行情-时间为序  daily_20200518 返回数据 row 行数 = "+str(daily_20200518.shape[0]))
daily_20200518_addname_dataframe.to_excel(daily_202005_excel_writer,'18_1',index=False)
daily_202005_excel_writer.save()
daily_20200519 = pro.daily(start_date='',end_date='',trade_date='20200519', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20200519_tscode_list = list() 
for ts_code_sh in daily_20200519['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20200519_tscode_list.append(stock_name)
daily_20200519_addname_dataframe=pd.DataFrame()
daily_20200519_addname_dataframe['cname'] = daily_20200519_tscode_list
for table_name in daily_20200519.columns.values.tolist():
    daily_20200519_addname_dataframe[table_name] = daily_20200519[table_name]
print("日线行情-时间为序  daily_20200519 返回数据 row 行数 = "+str(daily_20200519.shape[0]))
daily_20200519_addname_dataframe.to_excel(daily_202005_excel_writer,'19_2',index=False)
daily_202005_excel_writer.save()
daily_20200520 = pro.daily(start_date='',end_date='',trade_date='20200520', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20200520_tscode_list = list() 
for ts_code_sh in daily_20200520['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20200520_tscode_list.append(stock_name)
daily_20200520_addname_dataframe=pd.DataFrame()
daily_20200520_addname_dataframe['cname'] = daily_20200520_tscode_list
for table_name in daily_20200520.columns.values.tolist():
    daily_20200520_addname_dataframe[table_name] = daily_20200520[table_name]
print("日线行情-时间为序  daily_20200520 返回数据 row 行数 = "+str(daily_20200520.shape[0]))
daily_20200520_addname_dataframe.to_excel(daily_202005_excel_writer,'20_3',index=False)
daily_202005_excel_writer.save()
daily_20200521 = pro.daily(start_date='',end_date='',trade_date='20200521', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20200521_tscode_list = list() 
for ts_code_sh in daily_20200521['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20200521_tscode_list.append(stock_name)
daily_20200521_addname_dataframe=pd.DataFrame()
daily_20200521_addname_dataframe['cname'] = daily_20200521_tscode_list
for table_name in daily_20200521.columns.values.tolist():
    daily_20200521_addname_dataframe[table_name] = daily_20200521[table_name]
print("日线行情-时间为序  daily_20200521 返回数据 row 行数 = "+str(daily_20200521.shape[0]))
daily_20200521_addname_dataframe.to_excel(daily_202005_excel_writer,'21_4',index=False)
daily_202005_excel_writer.save()
daily_20200522 = pro.daily(start_date='',end_date='',trade_date='20200522', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20200522_tscode_list = list() 
for ts_code_sh in daily_20200522['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20200522_tscode_list.append(stock_name)
daily_20200522_addname_dataframe=pd.DataFrame()
daily_20200522_addname_dataframe['cname'] = daily_20200522_tscode_list
for table_name in daily_20200522.columns.values.tolist():
    daily_20200522_addname_dataframe[table_name] = daily_20200522[table_name]
print("日线行情-时间为序  daily_20200522 返回数据 row 行数 = "+str(daily_20200522.shape[0]))
daily_20200522_addname_dataframe.to_excel(daily_202005_excel_writer,'22_5',index=False)
daily_202005_excel_writer.save()
daily_20200525 = pro.daily(start_date='',end_date='',trade_date='20200525', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20200525_tscode_list = list() 
for ts_code_sh in daily_20200525['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20200525_tscode_list.append(stock_name)
daily_20200525_addname_dataframe=pd.DataFrame()
daily_20200525_addname_dataframe['cname'] = daily_20200525_tscode_list
for table_name in daily_20200525.columns.values.tolist():
    daily_20200525_addname_dataframe[table_name] = daily_20200525[table_name]
print("日线行情-时间为序  daily_20200525 返回数据 row 行数 = "+str(daily_20200525.shape[0]))
daily_20200525_addname_dataframe.to_excel(daily_202005_excel_writer,'25_1',index=False)
daily_202005_excel_writer.save()
daily_20200526 = pro.daily(start_date='',end_date='',trade_date='20200526', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20200526_tscode_list = list() 
for ts_code_sh in daily_20200526['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20200526_tscode_list.append(stock_name)
daily_20200526_addname_dataframe=pd.DataFrame()
daily_20200526_addname_dataframe['cname'] = daily_20200526_tscode_list
for table_name in daily_20200526.columns.values.tolist():
    daily_20200526_addname_dataframe[table_name] = daily_20200526[table_name]
print("日线行情-时间为序  daily_20200526 返回数据 row 行数 = "+str(daily_20200526.shape[0]))
daily_20200526_addname_dataframe.to_excel(daily_202005_excel_writer,'26_2',index=False)
daily_202005_excel_writer.save()
daily_20200527 = pro.daily(start_date='',end_date='',trade_date='20200527', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20200527_tscode_list = list() 
for ts_code_sh in daily_20200527['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20200527_tscode_list.append(stock_name)
daily_20200527_addname_dataframe=pd.DataFrame()
daily_20200527_addname_dataframe['cname'] = daily_20200527_tscode_list
for table_name in daily_20200527.columns.values.tolist():
    daily_20200527_addname_dataframe[table_name] = daily_20200527[table_name]
print("日线行情-时间为序  daily_20200527 返回数据 row 行数 = "+str(daily_20200527.shape[0]))
daily_20200527_addname_dataframe.to_excel(daily_202005_excel_writer,'27_3',index=False)
daily_202005_excel_writer.save()
daily_20200528 = pro.daily(start_date='',end_date='',trade_date='20200528', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20200528_tscode_list = list() 
for ts_code_sh in daily_20200528['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20200528_tscode_list.append(stock_name)
daily_20200528_addname_dataframe=pd.DataFrame()
daily_20200528_addname_dataframe['cname'] = daily_20200528_tscode_list
for table_name in daily_20200528.columns.values.tolist():
    daily_20200528_addname_dataframe[table_name] = daily_20200528[table_name]
print("日线行情-时间为序  daily_20200528 返回数据 row 行数 = "+str(daily_20200528.shape[0]))
daily_20200528_addname_dataframe.to_excel(daily_202005_excel_writer,'28_4',index=False)
daily_202005_excel_writer.save()
daily_20200529 = pro.daily(start_date='',end_date='',trade_date='20200529', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20200529_tscode_list = list() 
for ts_code_sh in daily_20200529['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20200529_tscode_list.append(stock_name)
daily_20200529_addname_dataframe=pd.DataFrame()
daily_20200529_addname_dataframe['cname'] = daily_20200529_tscode_list
for table_name in daily_20200529.columns.values.tolist():
    daily_20200529_addname_dataframe[table_name] = daily_20200529[table_name]
print("日线行情-时间为序  daily_20200529 返回数据 row 行数 = "+str(daily_20200529.shape[0]))
daily_20200529_addname_dataframe.to_excel(daily_202005_excel_writer,'29_5',index=False)
daily_202005_excel_writer.save()




createexcel('daily_202006.xlsx')
daily_202006_book = load_workbook('C:\\Users\\zhuzj5\\Desktop\\zbin\\J0_Data\\daily_202006.xlsx')
daily_202006_excel_writer = pd.ExcelWriter('C:\\Users\\zhuzj5\\Desktop\\zbin\\J0_Data\\daily_202006.xlsx', engine='openpyxl')
daily_202006_excel_writer.book = daily_202006_book
daily_202006_excel_writer.sheets = dict((ws.title, ws) for ws in daily_202006_book.worksheets)
J0_PROPS.put(tree_node_name+"record_date", "20200601")       ###  更新 记录日期
daily_20200601 = pro.daily(start_date='',end_date='',trade_date='20200601', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20200601_tscode_list = list() 
for ts_code_sh in daily_20200601['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20200601_tscode_list.append(stock_name)
daily_20200601_addname_dataframe=pd.DataFrame()
daily_20200601_addname_dataframe['cname'] = daily_20200601_tscode_list
for table_name in daily_20200601.columns.values.tolist():
    daily_20200601_addname_dataframe[table_name] = daily_20200601[table_name]
print("日线行情-时间为序  daily_20200601 返回数据 row 行数 = "+str(daily_20200601.shape[0]))
daily_20200601_addname_dataframe.to_excel(daily_202006_excel_writer,'1_1',index=False)
daily_202006_excel_writer.save()
daily_20200602 = pro.daily(start_date='',end_date='',trade_date='20200602', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20200602_tscode_list = list() 
for ts_code_sh in daily_20200602['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20200602_tscode_list.append(stock_name)
daily_20200602_addname_dataframe=pd.DataFrame()
daily_20200602_addname_dataframe['cname'] = daily_20200602_tscode_list
for table_name in daily_20200602.columns.values.tolist():
    daily_20200602_addname_dataframe[table_name] = daily_20200602[table_name]
print("日线行情-时间为序  daily_20200602 返回数据 row 行数 = "+str(daily_20200602.shape[0]))
daily_20200602_addname_dataframe.to_excel(daily_202006_excel_writer,'2_2',index=False)
daily_202006_excel_writer.save()
daily_20200603 = pro.daily(start_date='',end_date='',trade_date='20200603', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20200603_tscode_list = list() 
for ts_code_sh in daily_20200603['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20200603_tscode_list.append(stock_name)
daily_20200603_addname_dataframe=pd.DataFrame()
daily_20200603_addname_dataframe['cname'] = daily_20200603_tscode_list
for table_name in daily_20200603.columns.values.tolist():
    daily_20200603_addname_dataframe[table_name] = daily_20200603[table_name]
print("日线行情-时间为序  daily_20200603 返回数据 row 行数 = "+str(daily_20200603.shape[0]))
daily_20200603_addname_dataframe.to_excel(daily_202006_excel_writer,'3_3',index=False)
daily_202006_excel_writer.save()
daily_20200604 = pro.daily(start_date='',end_date='',trade_date='20200604', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20200604_tscode_list = list() 
for ts_code_sh in daily_20200604['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20200604_tscode_list.append(stock_name)
daily_20200604_addname_dataframe=pd.DataFrame()
daily_20200604_addname_dataframe['cname'] = daily_20200604_tscode_list
for table_name in daily_20200604.columns.values.tolist():
    daily_20200604_addname_dataframe[table_name] = daily_20200604[table_name]
print("日线行情-时间为序  daily_20200604 返回数据 row 行数 = "+str(daily_20200604.shape[0]))
daily_20200604_addname_dataframe.to_excel(daily_202006_excel_writer,'4_4',index=False)
daily_202006_excel_writer.save()
daily_20200605 = pro.daily(start_date='',end_date='',trade_date='20200605', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20200605_tscode_list = list() 
for ts_code_sh in daily_20200605['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20200605_tscode_list.append(stock_name)
daily_20200605_addname_dataframe=pd.DataFrame()
daily_20200605_addname_dataframe['cname'] = daily_20200605_tscode_list
for table_name in daily_20200605.columns.values.tolist():
    daily_20200605_addname_dataframe[table_name] = daily_20200605[table_name]
print("日线行情-时间为序  daily_20200605 返回数据 row 行数 = "+str(daily_20200605.shape[0]))
daily_20200605_addname_dataframe.to_excel(daily_202006_excel_writer,'5_5',index=False)
daily_202006_excel_writer.save()
daily_20200608 = pro.daily(start_date='',end_date='',trade_date='20200608', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20200608_tscode_list = list() 
for ts_code_sh in daily_20200608['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20200608_tscode_list.append(stock_name)
daily_20200608_addname_dataframe=pd.DataFrame()
daily_20200608_addname_dataframe['cname'] = daily_20200608_tscode_list
for table_name in daily_20200608.columns.values.tolist():
    daily_20200608_addname_dataframe[table_name] = daily_20200608[table_name]
print("日线行情-时间为序  daily_20200608 返回数据 row 行数 = "+str(daily_20200608.shape[0]))
daily_20200608_addname_dataframe.to_excel(daily_202006_excel_writer,'8_1',index=False)
daily_202006_excel_writer.save()
daily_20200609 = pro.daily(start_date='',end_date='',trade_date='20200609', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20200609_tscode_list = list() 
for ts_code_sh in daily_20200609['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20200609_tscode_list.append(stock_name)
daily_20200609_addname_dataframe=pd.DataFrame()
daily_20200609_addname_dataframe['cname'] = daily_20200609_tscode_list
for table_name in daily_20200609.columns.values.tolist():
    daily_20200609_addname_dataframe[table_name] = daily_20200609[table_name]
print("日线行情-时间为序  daily_20200609 返回数据 row 行数 = "+str(daily_20200609.shape[0]))
daily_20200609_addname_dataframe.to_excel(daily_202006_excel_writer,'9_2',index=False)
daily_202006_excel_writer.save()
daily_20200610 = pro.daily(start_date='',end_date='',trade_date='20200610', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20200610_tscode_list = list() 
for ts_code_sh in daily_20200610['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20200610_tscode_list.append(stock_name)
daily_20200610_addname_dataframe=pd.DataFrame()
daily_20200610_addname_dataframe['cname'] = daily_20200610_tscode_list
for table_name in daily_20200610.columns.values.tolist():
    daily_20200610_addname_dataframe[table_name] = daily_20200610[table_name]
print("日线行情-时间为序  daily_20200610 返回数据 row 行数 = "+str(daily_20200610.shape[0]))
daily_20200610_addname_dataframe.to_excel(daily_202006_excel_writer,'10_3',index=False)
daily_202006_excel_writer.save()
daily_20200611 = pro.daily(start_date='',end_date='',trade_date='20200611', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20200611_tscode_list = list() 
for ts_code_sh in daily_20200611['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20200611_tscode_list.append(stock_name)
daily_20200611_addname_dataframe=pd.DataFrame()
daily_20200611_addname_dataframe['cname'] = daily_20200611_tscode_list
for table_name in daily_20200611.columns.values.tolist():
    daily_20200611_addname_dataframe[table_name] = daily_20200611[table_name]
print("日线行情-时间为序  daily_20200611 返回数据 row 行数 = "+str(daily_20200611.shape[0]))
daily_20200611_addname_dataframe.to_excel(daily_202006_excel_writer,'11_4',index=False)
daily_202006_excel_writer.save()
daily_20200612 = pro.daily(start_date='',end_date='',trade_date='20200612', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20200612_tscode_list = list() 
for ts_code_sh in daily_20200612['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20200612_tscode_list.append(stock_name)
daily_20200612_addname_dataframe=pd.DataFrame()
daily_20200612_addname_dataframe['cname'] = daily_20200612_tscode_list
for table_name in daily_20200612.columns.values.tolist():
    daily_20200612_addname_dataframe[table_name] = daily_20200612[table_name]
print("日线行情-时间为序  daily_20200612 返回数据 row 行数 = "+str(daily_20200612.shape[0]))
daily_20200612_addname_dataframe.to_excel(daily_202006_excel_writer,'12_5',index=False)
daily_202006_excel_writer.save()
daily_20200615 = pro.daily(start_date='',end_date='',trade_date='20200615', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20200615_tscode_list = list() 
for ts_code_sh in daily_20200615['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20200615_tscode_list.append(stock_name)
daily_20200615_addname_dataframe=pd.DataFrame()
daily_20200615_addname_dataframe['cname'] = daily_20200615_tscode_list
for table_name in daily_20200615.columns.values.tolist():
    daily_20200615_addname_dataframe[table_name] = daily_20200615[table_name]
print("日线行情-时间为序  daily_20200615 返回数据 row 行数 = "+str(daily_20200615.shape[0]))
daily_20200615_addname_dataframe.to_excel(daily_202006_excel_writer,'15_1',index=False)
daily_202006_excel_writer.save()
daily_20200616 = pro.daily(start_date='',end_date='',trade_date='20200616', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20200616_tscode_list = list() 
for ts_code_sh in daily_20200616['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20200616_tscode_list.append(stock_name)
daily_20200616_addname_dataframe=pd.DataFrame()
daily_20200616_addname_dataframe['cname'] = daily_20200616_tscode_list
for table_name in daily_20200616.columns.values.tolist():
    daily_20200616_addname_dataframe[table_name] = daily_20200616[table_name]
print("日线行情-时间为序  daily_20200616 返回数据 row 行数 = "+str(daily_20200616.shape[0]))
daily_20200616_addname_dataframe.to_excel(daily_202006_excel_writer,'16_2',index=False)
daily_202006_excel_writer.save()
daily_20200617 = pro.daily(start_date='',end_date='',trade_date='20200617', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20200617_tscode_list = list() 
for ts_code_sh in daily_20200617['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20200617_tscode_list.append(stock_name)
daily_20200617_addname_dataframe=pd.DataFrame()
daily_20200617_addname_dataframe['cname'] = daily_20200617_tscode_list
for table_name in daily_20200617.columns.values.tolist():
    daily_20200617_addname_dataframe[table_name] = daily_20200617[table_name]
print("日线行情-时间为序  daily_20200617 返回数据 row 行数 = "+str(daily_20200617.shape[0]))
daily_20200617_addname_dataframe.to_excel(daily_202006_excel_writer,'17_3',index=False)
daily_202006_excel_writer.save()
daily_20200618 = pro.daily(start_date='',end_date='',trade_date='20200618', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20200618_tscode_list = list() 
for ts_code_sh in daily_20200618['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20200618_tscode_list.append(stock_name)
daily_20200618_addname_dataframe=pd.DataFrame()
daily_20200618_addname_dataframe['cname'] = daily_20200618_tscode_list
for table_name in daily_20200618.columns.values.tolist():
    daily_20200618_addname_dataframe[table_name] = daily_20200618[table_name]
print("日线行情-时间为序  daily_20200618 返回数据 row 行数 = "+str(daily_20200618.shape[0]))
daily_20200618_addname_dataframe.to_excel(daily_202006_excel_writer,'18_4',index=False)
daily_202006_excel_writer.save()
daily_20200619 = pro.daily(start_date='',end_date='',trade_date='20200619', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20200619_tscode_list = list() 
for ts_code_sh in daily_20200619['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20200619_tscode_list.append(stock_name)
daily_20200619_addname_dataframe=pd.DataFrame()
daily_20200619_addname_dataframe['cname'] = daily_20200619_tscode_list
for table_name in daily_20200619.columns.values.tolist():
    daily_20200619_addname_dataframe[table_name] = daily_20200619[table_name]
print("日线行情-时间为序  daily_20200619 返回数据 row 行数 = "+str(daily_20200619.shape[0]))
daily_20200619_addname_dataframe.to_excel(daily_202006_excel_writer,'19_5',index=False)
daily_202006_excel_writer.save()
daily_20200622 = pro.daily(start_date='',end_date='',trade_date='20200622', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20200622_tscode_list = list() 
for ts_code_sh in daily_20200622['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20200622_tscode_list.append(stock_name)
daily_20200622_addname_dataframe=pd.DataFrame()
daily_20200622_addname_dataframe['cname'] = daily_20200622_tscode_list
for table_name in daily_20200622.columns.values.tolist():
    daily_20200622_addname_dataframe[table_name] = daily_20200622[table_name]
print("日线行情-时间为序  daily_20200622 返回数据 row 行数 = "+str(daily_20200622.shape[0]))
daily_20200622_addname_dataframe.to_excel(daily_202006_excel_writer,'22_1',index=False)
daily_202006_excel_writer.save()
daily_20200623 = pro.daily(start_date='',end_date='',trade_date='20200623', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20200623_tscode_list = list() 
for ts_code_sh in daily_20200623['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20200623_tscode_list.append(stock_name)
daily_20200623_addname_dataframe=pd.DataFrame()
daily_20200623_addname_dataframe['cname'] = daily_20200623_tscode_list
for table_name in daily_20200623.columns.values.tolist():
    daily_20200623_addname_dataframe[table_name] = daily_20200623[table_name]
print("日线行情-时间为序  daily_20200623 返回数据 row 行数 = "+str(daily_20200623.shape[0]))
daily_20200623_addname_dataframe.to_excel(daily_202006_excel_writer,'23_2',index=False)
daily_202006_excel_writer.save()
daily_20200624 = pro.daily(start_date='',end_date='',trade_date='20200624', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20200624_tscode_list = list() 
for ts_code_sh in daily_20200624['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20200624_tscode_list.append(stock_name)
daily_20200624_addname_dataframe=pd.DataFrame()
daily_20200624_addname_dataframe['cname'] = daily_20200624_tscode_list
for table_name in daily_20200624.columns.values.tolist():
    daily_20200624_addname_dataframe[table_name] = daily_20200624[table_name]
print("日线行情-时间为序  daily_20200624 返回数据 row 行数 = "+str(daily_20200624.shape[0]))
daily_20200624_addname_dataframe.to_excel(daily_202006_excel_writer,'24_3',index=False)
daily_202006_excel_writer.save()
daily_20200629 = pro.daily(start_date='',end_date='',trade_date='20200629', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20200629_tscode_list = list() 
for ts_code_sh in daily_20200629['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20200629_tscode_list.append(stock_name)
daily_20200629_addname_dataframe=pd.DataFrame()
daily_20200629_addname_dataframe['cname'] = daily_20200629_tscode_list
for table_name in daily_20200629.columns.values.tolist():
    daily_20200629_addname_dataframe[table_name] = daily_20200629[table_name]
print("日线行情-时间为序  daily_20200629 返回数据 row 行数 = "+str(daily_20200629.shape[0]))
daily_20200629_addname_dataframe.to_excel(daily_202006_excel_writer,'29_1',index=False)
daily_202006_excel_writer.save()
daily_20200630 = pro.daily(start_date='',end_date='',trade_date='20200630', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20200630_tscode_list = list() 
for ts_code_sh in daily_20200630['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20200630_tscode_list.append(stock_name)
daily_20200630_addname_dataframe=pd.DataFrame()
daily_20200630_addname_dataframe['cname'] = daily_20200630_tscode_list
for table_name in daily_20200630.columns.values.tolist():
    daily_20200630_addname_dataframe[table_name] = daily_20200630[table_name]
print("日线行情-时间为序  daily_20200630 返回数据 row 行数 = "+str(daily_20200630.shape[0]))
daily_20200630_addname_dataframe.to_excel(daily_202006_excel_writer,'30_2',index=False)
daily_202006_excel_writer.save()




createexcel('daily_202007.xlsx')
daily_202007_book = load_workbook('C:\\Users\\zhuzj5\\Desktop\\zbin\\J0_Data\\daily_202007.xlsx')
daily_202007_excel_writer = pd.ExcelWriter('C:\\Users\\zhuzj5\\Desktop\\zbin\\J0_Data\\daily_202007.xlsx', engine='openpyxl')
daily_202007_excel_writer.book = daily_202007_book
daily_202007_excel_writer.sheets = dict((ws.title, ws) for ws in daily_202007_book.worksheets)
J0_PROPS.put(tree_node_name+"record_date", "20200701")       ###  更新 记录日期
daily_20200701 = pro.daily(start_date='',end_date='',trade_date='20200701', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20200701_tscode_list = list() 
for ts_code_sh in daily_20200701['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20200701_tscode_list.append(stock_name)
daily_20200701_addname_dataframe=pd.DataFrame()
daily_20200701_addname_dataframe['cname'] = daily_20200701_tscode_list
for table_name in daily_20200701.columns.values.tolist():
    daily_20200701_addname_dataframe[table_name] = daily_20200701[table_name]
print("日线行情-时间为序  daily_20200701 返回数据 row 行数 = "+str(daily_20200701.shape[0]))
daily_20200701_addname_dataframe.to_excel(daily_202007_excel_writer,'1_3',index=False)
daily_202007_excel_writer.save()
daily_20200702 = pro.daily(start_date='',end_date='',trade_date='20200702', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20200702_tscode_list = list() 
for ts_code_sh in daily_20200702['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20200702_tscode_list.append(stock_name)
daily_20200702_addname_dataframe=pd.DataFrame()
daily_20200702_addname_dataframe['cname'] = daily_20200702_tscode_list
for table_name in daily_20200702.columns.values.tolist():
    daily_20200702_addname_dataframe[table_name] = daily_20200702[table_name]
print("日线行情-时间为序  daily_20200702 返回数据 row 行数 = "+str(daily_20200702.shape[0]))
daily_20200702_addname_dataframe.to_excel(daily_202007_excel_writer,'2_4',index=False)
daily_202007_excel_writer.save()
daily_20200703 = pro.daily(start_date='',end_date='',trade_date='20200703', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20200703_tscode_list = list() 
for ts_code_sh in daily_20200703['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20200703_tscode_list.append(stock_name)
daily_20200703_addname_dataframe=pd.DataFrame()
daily_20200703_addname_dataframe['cname'] = daily_20200703_tscode_list
for table_name in daily_20200703.columns.values.tolist():
    daily_20200703_addname_dataframe[table_name] = daily_20200703[table_name]
print("日线行情-时间为序  daily_20200703 返回数据 row 行数 = "+str(daily_20200703.shape[0]))
daily_20200703_addname_dataframe.to_excel(daily_202007_excel_writer,'3_5',index=False)
daily_202007_excel_writer.save()
daily_20200706 = pro.daily(start_date='',end_date='',trade_date='20200706', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20200706_tscode_list = list() 
for ts_code_sh in daily_20200706['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20200706_tscode_list.append(stock_name)
daily_20200706_addname_dataframe=pd.DataFrame()
daily_20200706_addname_dataframe['cname'] = daily_20200706_tscode_list
for table_name in daily_20200706.columns.values.tolist():
    daily_20200706_addname_dataframe[table_name] = daily_20200706[table_name]
print("日线行情-时间为序  daily_20200706 返回数据 row 行数 = "+str(daily_20200706.shape[0]))
daily_20200706_addname_dataframe.to_excel(daily_202007_excel_writer,'6_1',index=False)
daily_202007_excel_writer.save()
daily_20200707 = pro.daily(start_date='',end_date='',trade_date='20200707', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20200707_tscode_list = list() 
for ts_code_sh in daily_20200707['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20200707_tscode_list.append(stock_name)
daily_20200707_addname_dataframe=pd.DataFrame()
daily_20200707_addname_dataframe['cname'] = daily_20200707_tscode_list
for table_name in daily_20200707.columns.values.tolist():
    daily_20200707_addname_dataframe[table_name] = daily_20200707[table_name]
print("日线行情-时间为序  daily_20200707 返回数据 row 行数 = "+str(daily_20200707.shape[0]))
daily_20200707_addname_dataframe.to_excel(daily_202007_excel_writer,'7_2',index=False)
daily_202007_excel_writer.save()
daily_20200708 = pro.daily(start_date='',end_date='',trade_date='20200708', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20200708_tscode_list = list() 
for ts_code_sh in daily_20200708['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20200708_tscode_list.append(stock_name)
daily_20200708_addname_dataframe=pd.DataFrame()
daily_20200708_addname_dataframe['cname'] = daily_20200708_tscode_list
for table_name in daily_20200708.columns.values.tolist():
    daily_20200708_addname_dataframe[table_name] = daily_20200708[table_name]
print("日线行情-时间为序  daily_20200708 返回数据 row 行数 = "+str(daily_20200708.shape[0]))
daily_20200708_addname_dataframe.to_excel(daily_202007_excel_writer,'8_3',index=False)
daily_202007_excel_writer.save()
daily_20200709 = pro.daily(start_date='',end_date='',trade_date='20200709', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20200709_tscode_list = list() 
for ts_code_sh in daily_20200709['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20200709_tscode_list.append(stock_name)
daily_20200709_addname_dataframe=pd.DataFrame()
daily_20200709_addname_dataframe['cname'] = daily_20200709_tscode_list
for table_name in daily_20200709.columns.values.tolist():
    daily_20200709_addname_dataframe[table_name] = daily_20200709[table_name]
print("日线行情-时间为序  daily_20200709 返回数据 row 行数 = "+str(daily_20200709.shape[0]))
daily_20200709_addname_dataframe.to_excel(daily_202007_excel_writer,'9_4',index=False)
daily_202007_excel_writer.save()
daily_20200710 = pro.daily(start_date='',end_date='',trade_date='20200710', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20200710_tscode_list = list() 
for ts_code_sh in daily_20200710['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20200710_tscode_list.append(stock_name)
daily_20200710_addname_dataframe=pd.DataFrame()
daily_20200710_addname_dataframe['cname'] = daily_20200710_tscode_list
for table_name in daily_20200710.columns.values.tolist():
    daily_20200710_addname_dataframe[table_name] = daily_20200710[table_name]
print("日线行情-时间为序  daily_20200710 返回数据 row 行数 = "+str(daily_20200710.shape[0]))
daily_20200710_addname_dataframe.to_excel(daily_202007_excel_writer,'10_5',index=False)
daily_202007_excel_writer.save()
daily_20200713 = pro.daily(start_date='',end_date='',trade_date='20200713', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20200713_tscode_list = list() 
for ts_code_sh in daily_20200713['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20200713_tscode_list.append(stock_name)
daily_20200713_addname_dataframe=pd.DataFrame()
daily_20200713_addname_dataframe['cname'] = daily_20200713_tscode_list
for table_name in daily_20200713.columns.values.tolist():
    daily_20200713_addname_dataframe[table_name] = daily_20200713[table_name]
print("日线行情-时间为序  daily_20200713 返回数据 row 行数 = "+str(daily_20200713.shape[0]))
daily_20200713_addname_dataframe.to_excel(daily_202007_excel_writer,'13_1',index=False)
daily_202007_excel_writer.save()
daily_20200714 = pro.daily(start_date='',end_date='',trade_date='20200714', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20200714_tscode_list = list() 
for ts_code_sh in daily_20200714['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20200714_tscode_list.append(stock_name)
daily_20200714_addname_dataframe=pd.DataFrame()
daily_20200714_addname_dataframe['cname'] = daily_20200714_tscode_list
for table_name in daily_20200714.columns.values.tolist():
    daily_20200714_addname_dataframe[table_name] = daily_20200714[table_name]
print("日线行情-时间为序  daily_20200714 返回数据 row 行数 = "+str(daily_20200714.shape[0]))
daily_20200714_addname_dataframe.to_excel(daily_202007_excel_writer,'14_2',index=False)
daily_202007_excel_writer.save()
daily_20200715 = pro.daily(start_date='',end_date='',trade_date='20200715', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20200715_tscode_list = list() 
for ts_code_sh in daily_20200715['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20200715_tscode_list.append(stock_name)
daily_20200715_addname_dataframe=pd.DataFrame()
daily_20200715_addname_dataframe['cname'] = daily_20200715_tscode_list
for table_name in daily_20200715.columns.values.tolist():
    daily_20200715_addname_dataframe[table_name] = daily_20200715[table_name]
print("日线行情-时间为序  daily_20200715 返回数据 row 行数 = "+str(daily_20200715.shape[0]))
daily_20200715_addname_dataframe.to_excel(daily_202007_excel_writer,'15_3',index=False)
daily_202007_excel_writer.save()
daily_20200716 = pro.daily(start_date='',end_date='',trade_date='20200716', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20200716_tscode_list = list() 
for ts_code_sh in daily_20200716['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20200716_tscode_list.append(stock_name)
daily_20200716_addname_dataframe=pd.DataFrame()
daily_20200716_addname_dataframe['cname'] = daily_20200716_tscode_list
for table_name in daily_20200716.columns.values.tolist():
    daily_20200716_addname_dataframe[table_name] = daily_20200716[table_name]
print("日线行情-时间为序  daily_20200716 返回数据 row 行数 = "+str(daily_20200716.shape[0]))
daily_20200716_addname_dataframe.to_excel(daily_202007_excel_writer,'16_4',index=False)
daily_202007_excel_writer.save()
daily_20200717 = pro.daily(start_date='',end_date='',trade_date='20200717', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20200717_tscode_list = list() 
for ts_code_sh in daily_20200717['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20200717_tscode_list.append(stock_name)
daily_20200717_addname_dataframe=pd.DataFrame()
daily_20200717_addname_dataframe['cname'] = daily_20200717_tscode_list
for table_name in daily_20200717.columns.values.tolist():
    daily_20200717_addname_dataframe[table_name] = daily_20200717[table_name]
print("日线行情-时间为序  daily_20200717 返回数据 row 行数 = "+str(daily_20200717.shape[0]))
daily_20200717_addname_dataframe.to_excel(daily_202007_excel_writer,'17_5',index=False)
daily_202007_excel_writer.save()
daily_20200720 = pro.daily(start_date='',end_date='',trade_date='20200720', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20200720_tscode_list = list() 
for ts_code_sh in daily_20200720['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20200720_tscode_list.append(stock_name)
daily_20200720_addname_dataframe=pd.DataFrame()
daily_20200720_addname_dataframe['cname'] = daily_20200720_tscode_list
for table_name in daily_20200720.columns.values.tolist():
    daily_20200720_addname_dataframe[table_name] = daily_20200720[table_name]
print("日线行情-时间为序  daily_20200720 返回数据 row 行数 = "+str(daily_20200720.shape[0]))
daily_20200720_addname_dataframe.to_excel(daily_202007_excel_writer,'20_1',index=False)
daily_202007_excel_writer.save()
daily_20200721 = pro.daily(start_date='',end_date='',trade_date='20200721', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20200721_tscode_list = list() 
for ts_code_sh in daily_20200721['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20200721_tscode_list.append(stock_name)
daily_20200721_addname_dataframe=pd.DataFrame()
daily_20200721_addname_dataframe['cname'] = daily_20200721_tscode_list
for table_name in daily_20200721.columns.values.tolist():
    daily_20200721_addname_dataframe[table_name] = daily_20200721[table_name]
print("日线行情-时间为序  daily_20200721 返回数据 row 行数 = "+str(daily_20200721.shape[0]))
daily_20200721_addname_dataframe.to_excel(daily_202007_excel_writer,'21_2',index=False)
daily_202007_excel_writer.save()
daily_20200722 = pro.daily(start_date='',end_date='',trade_date='20200722', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20200722_tscode_list = list() 
for ts_code_sh in daily_20200722['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20200722_tscode_list.append(stock_name)
daily_20200722_addname_dataframe=pd.DataFrame()
daily_20200722_addname_dataframe['cname'] = daily_20200722_tscode_list
for table_name in daily_20200722.columns.values.tolist():
    daily_20200722_addname_dataframe[table_name] = daily_20200722[table_name]
print("日线行情-时间为序  daily_20200722 返回数据 row 行数 = "+str(daily_20200722.shape[0]))
daily_20200722_addname_dataframe.to_excel(daily_202007_excel_writer,'22_3',index=False)
daily_202007_excel_writer.save()
daily_20200723 = pro.daily(start_date='',end_date='',trade_date='20200723', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20200723_tscode_list = list() 
for ts_code_sh in daily_20200723['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20200723_tscode_list.append(stock_name)
daily_20200723_addname_dataframe=pd.DataFrame()
daily_20200723_addname_dataframe['cname'] = daily_20200723_tscode_list
for table_name in daily_20200723.columns.values.tolist():
    daily_20200723_addname_dataframe[table_name] = daily_20200723[table_name]
print("日线行情-时间为序  daily_20200723 返回数据 row 行数 = "+str(daily_20200723.shape[0]))
daily_20200723_addname_dataframe.to_excel(daily_202007_excel_writer,'23_4',index=False)
daily_202007_excel_writer.save()
daily_20200724 = pro.daily(start_date='',end_date='',trade_date='20200724', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20200724_tscode_list = list() 
for ts_code_sh in daily_20200724['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20200724_tscode_list.append(stock_name)
daily_20200724_addname_dataframe=pd.DataFrame()
daily_20200724_addname_dataframe['cname'] = daily_20200724_tscode_list
for table_name in daily_20200724.columns.values.tolist():
    daily_20200724_addname_dataframe[table_name] = daily_20200724[table_name]
print("日线行情-时间为序  daily_20200724 返回数据 row 行数 = "+str(daily_20200724.shape[0]))
daily_20200724_addname_dataframe.to_excel(daily_202007_excel_writer,'24_5',index=False)
daily_202007_excel_writer.save()
daily_20200727 = pro.daily(start_date='',end_date='',trade_date='20200727', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20200727_tscode_list = list() 
for ts_code_sh in daily_20200727['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20200727_tscode_list.append(stock_name)
daily_20200727_addname_dataframe=pd.DataFrame()
daily_20200727_addname_dataframe['cname'] = daily_20200727_tscode_list
for table_name in daily_20200727.columns.values.tolist():
    daily_20200727_addname_dataframe[table_name] = daily_20200727[table_name]
print("日线行情-时间为序  daily_20200727 返回数据 row 行数 = "+str(daily_20200727.shape[0]))
daily_20200727_addname_dataframe.to_excel(daily_202007_excel_writer,'27_1',index=False)
daily_202007_excel_writer.save()
daily_20200728 = pro.daily(start_date='',end_date='',trade_date='20200728', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20200728_tscode_list = list() 
for ts_code_sh in daily_20200728['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20200728_tscode_list.append(stock_name)
daily_20200728_addname_dataframe=pd.DataFrame()
daily_20200728_addname_dataframe['cname'] = daily_20200728_tscode_list
for table_name in daily_20200728.columns.values.tolist():
    daily_20200728_addname_dataframe[table_name] = daily_20200728[table_name]
print("日线行情-时间为序  daily_20200728 返回数据 row 行数 = "+str(daily_20200728.shape[0]))
daily_20200728_addname_dataframe.to_excel(daily_202007_excel_writer,'28_2',index=False)
daily_202007_excel_writer.save()
daily_20200729 = pro.daily(start_date='',end_date='',trade_date='20200729', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20200729_tscode_list = list() 
for ts_code_sh in daily_20200729['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20200729_tscode_list.append(stock_name)
daily_20200729_addname_dataframe=pd.DataFrame()
daily_20200729_addname_dataframe['cname'] = daily_20200729_tscode_list
for table_name in daily_20200729.columns.values.tolist():
    daily_20200729_addname_dataframe[table_name] = daily_20200729[table_name]
print("日线行情-时间为序  daily_20200729 返回数据 row 行数 = "+str(daily_20200729.shape[0]))
daily_20200729_addname_dataframe.to_excel(daily_202007_excel_writer,'29_3',index=False)
daily_202007_excel_writer.save()
daily_20200730 = pro.daily(start_date='',end_date='',trade_date='20200730', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20200730_tscode_list = list() 
for ts_code_sh in daily_20200730['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20200730_tscode_list.append(stock_name)
daily_20200730_addname_dataframe=pd.DataFrame()
daily_20200730_addname_dataframe['cname'] = daily_20200730_tscode_list
for table_name in daily_20200730.columns.values.tolist():
    daily_20200730_addname_dataframe[table_name] = daily_20200730[table_name]
print("日线行情-时间为序  daily_20200730 返回数据 row 行数 = "+str(daily_20200730.shape[0]))
daily_20200730_addname_dataframe.to_excel(daily_202007_excel_writer,'30_4',index=False)
daily_202007_excel_writer.save()
daily_20200731 = pro.daily(start_date='',end_date='',trade_date='20200731', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20200731_tscode_list = list() 
for ts_code_sh in daily_20200731['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20200731_tscode_list.append(stock_name)
daily_20200731_addname_dataframe=pd.DataFrame()
daily_20200731_addname_dataframe['cname'] = daily_20200731_tscode_list
for table_name in daily_20200731.columns.values.tolist():
    daily_20200731_addname_dataframe[table_name] = daily_20200731[table_name]
print("日线行情-时间为序  daily_20200731 返回数据 row 行数 = "+str(daily_20200731.shape[0]))
daily_20200731_addname_dataframe.to_excel(daily_202007_excel_writer,'31_5',index=False)
daily_202007_excel_writer.save()




createexcel('daily_202008.xlsx')
daily_202008_book = load_workbook('C:\\Users\\zhuzj5\\Desktop\\zbin\\J0_Data\\daily_202008.xlsx')
daily_202008_excel_writer = pd.ExcelWriter('C:\\Users\\zhuzj5\\Desktop\\zbin\\J0_Data\\daily_202008.xlsx', engine='openpyxl')
daily_202008_excel_writer.book = daily_202008_book
daily_202008_excel_writer.sheets = dict((ws.title, ws) for ws in daily_202008_book.worksheets)
J0_PROPS.put(tree_node_name+"record_date", "20200801")       ###  更新 记录日期
daily_20200803 = pro.daily(start_date='',end_date='',trade_date='20200803', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20200803_tscode_list = list() 
for ts_code_sh in daily_20200803['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20200803_tscode_list.append(stock_name)
daily_20200803_addname_dataframe=pd.DataFrame()
daily_20200803_addname_dataframe['cname'] = daily_20200803_tscode_list
for table_name in daily_20200803.columns.values.tolist():
    daily_20200803_addname_dataframe[table_name] = daily_20200803[table_name]
print("日线行情-时间为序  daily_20200803 返回数据 row 行数 = "+str(daily_20200803.shape[0]))
daily_20200803_addname_dataframe.to_excel(daily_202008_excel_writer,'3_1',index=False)
daily_202008_excel_writer.save()
daily_20200804 = pro.daily(start_date='',end_date='',trade_date='20200804', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20200804_tscode_list = list() 
for ts_code_sh in daily_20200804['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20200804_tscode_list.append(stock_name)
daily_20200804_addname_dataframe=pd.DataFrame()
daily_20200804_addname_dataframe['cname'] = daily_20200804_tscode_list
for table_name in daily_20200804.columns.values.tolist():
    daily_20200804_addname_dataframe[table_name] = daily_20200804[table_name]
print("日线行情-时间为序  daily_20200804 返回数据 row 行数 = "+str(daily_20200804.shape[0]))
daily_20200804_addname_dataframe.to_excel(daily_202008_excel_writer,'4_2',index=False)
daily_202008_excel_writer.save()
daily_20200805 = pro.daily(start_date='',end_date='',trade_date='20200805', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20200805_tscode_list = list() 
for ts_code_sh in daily_20200805['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20200805_tscode_list.append(stock_name)
daily_20200805_addname_dataframe=pd.DataFrame()
daily_20200805_addname_dataframe['cname'] = daily_20200805_tscode_list
for table_name in daily_20200805.columns.values.tolist():
    daily_20200805_addname_dataframe[table_name] = daily_20200805[table_name]
print("日线行情-时间为序  daily_20200805 返回数据 row 行数 = "+str(daily_20200805.shape[0]))
daily_20200805_addname_dataframe.to_excel(daily_202008_excel_writer,'5_3',index=False)
daily_202008_excel_writer.save()
daily_20200806 = pro.daily(start_date='',end_date='',trade_date='20200806', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20200806_tscode_list = list() 
for ts_code_sh in daily_20200806['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20200806_tscode_list.append(stock_name)
daily_20200806_addname_dataframe=pd.DataFrame()
daily_20200806_addname_dataframe['cname'] = daily_20200806_tscode_list
for table_name in daily_20200806.columns.values.tolist():
    daily_20200806_addname_dataframe[table_name] = daily_20200806[table_name]
print("日线行情-时间为序  daily_20200806 返回数据 row 行数 = "+str(daily_20200806.shape[0]))
daily_20200806_addname_dataframe.to_excel(daily_202008_excel_writer,'6_4',index=False)
daily_202008_excel_writer.save()
daily_20200807 = pro.daily(start_date='',end_date='',trade_date='20200807', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20200807_tscode_list = list() 
for ts_code_sh in daily_20200807['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20200807_tscode_list.append(stock_name)
daily_20200807_addname_dataframe=pd.DataFrame()
daily_20200807_addname_dataframe['cname'] = daily_20200807_tscode_list
for table_name in daily_20200807.columns.values.tolist():
    daily_20200807_addname_dataframe[table_name] = daily_20200807[table_name]
print("日线行情-时间为序  daily_20200807 返回数据 row 行数 = "+str(daily_20200807.shape[0]))
daily_20200807_addname_dataframe.to_excel(daily_202008_excel_writer,'7_5',index=False)
daily_202008_excel_writer.save()
daily_20200810 = pro.daily(start_date='',end_date='',trade_date='20200810', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20200810_tscode_list = list() 
for ts_code_sh in daily_20200810['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20200810_tscode_list.append(stock_name)
daily_20200810_addname_dataframe=pd.DataFrame()
daily_20200810_addname_dataframe['cname'] = daily_20200810_tscode_list
for table_name in daily_20200810.columns.values.tolist():
    daily_20200810_addname_dataframe[table_name] = daily_20200810[table_name]
print("日线行情-时间为序  daily_20200810 返回数据 row 行数 = "+str(daily_20200810.shape[0]))
daily_20200810_addname_dataframe.to_excel(daily_202008_excel_writer,'10_1',index=False)
daily_202008_excel_writer.save()
daily_20200811 = pro.daily(start_date='',end_date='',trade_date='20200811', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20200811_tscode_list = list() 
for ts_code_sh in daily_20200811['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20200811_tscode_list.append(stock_name)
daily_20200811_addname_dataframe=pd.DataFrame()
daily_20200811_addname_dataframe['cname'] = daily_20200811_tscode_list
for table_name in daily_20200811.columns.values.tolist():
    daily_20200811_addname_dataframe[table_name] = daily_20200811[table_name]
print("日线行情-时间为序  daily_20200811 返回数据 row 行数 = "+str(daily_20200811.shape[0]))
daily_20200811_addname_dataframe.to_excel(daily_202008_excel_writer,'11_2',index=False)
daily_202008_excel_writer.save()
daily_20200812 = pro.daily(start_date='',end_date='',trade_date='20200812', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20200812_tscode_list = list() 
for ts_code_sh in daily_20200812['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20200812_tscode_list.append(stock_name)
daily_20200812_addname_dataframe=pd.DataFrame()
daily_20200812_addname_dataframe['cname'] = daily_20200812_tscode_list
for table_name in daily_20200812.columns.values.tolist():
    daily_20200812_addname_dataframe[table_name] = daily_20200812[table_name]
print("日线行情-时间为序  daily_20200812 返回数据 row 行数 = "+str(daily_20200812.shape[0]))
daily_20200812_addname_dataframe.to_excel(daily_202008_excel_writer,'12_3',index=False)
daily_202008_excel_writer.save()
daily_20200813 = pro.daily(start_date='',end_date='',trade_date='20200813', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20200813_tscode_list = list() 
for ts_code_sh in daily_20200813['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20200813_tscode_list.append(stock_name)
daily_20200813_addname_dataframe=pd.DataFrame()
daily_20200813_addname_dataframe['cname'] = daily_20200813_tscode_list
for table_name in daily_20200813.columns.values.tolist():
    daily_20200813_addname_dataframe[table_name] = daily_20200813[table_name]
print("日线行情-时间为序  daily_20200813 返回数据 row 行数 = "+str(daily_20200813.shape[0]))
daily_20200813_addname_dataframe.to_excel(daily_202008_excel_writer,'13_4',index=False)
daily_202008_excel_writer.save()
daily_20200814 = pro.daily(start_date='',end_date='',trade_date='20200814', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20200814_tscode_list = list() 
for ts_code_sh in daily_20200814['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20200814_tscode_list.append(stock_name)
daily_20200814_addname_dataframe=pd.DataFrame()
daily_20200814_addname_dataframe['cname'] = daily_20200814_tscode_list
for table_name in daily_20200814.columns.values.tolist():
    daily_20200814_addname_dataframe[table_name] = daily_20200814[table_name]
print("日线行情-时间为序  daily_20200814 返回数据 row 行数 = "+str(daily_20200814.shape[0]))
daily_20200814_addname_dataframe.to_excel(daily_202008_excel_writer,'14_5',index=False)
daily_202008_excel_writer.save()
daily_20200817 = pro.daily(start_date='',end_date='',trade_date='20200817', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20200817_tscode_list = list() 
for ts_code_sh in daily_20200817['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20200817_tscode_list.append(stock_name)
daily_20200817_addname_dataframe=pd.DataFrame()
daily_20200817_addname_dataframe['cname'] = daily_20200817_tscode_list
for table_name in daily_20200817.columns.values.tolist():
    daily_20200817_addname_dataframe[table_name] = daily_20200817[table_name]
print("日线行情-时间为序  daily_20200817 返回数据 row 行数 = "+str(daily_20200817.shape[0]))
daily_20200817_addname_dataframe.to_excel(daily_202008_excel_writer,'17_1',index=False)
daily_202008_excel_writer.save()
daily_20200818 = pro.daily(start_date='',end_date='',trade_date='20200818', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20200818_tscode_list = list() 
for ts_code_sh in daily_20200818['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20200818_tscode_list.append(stock_name)
daily_20200818_addname_dataframe=pd.DataFrame()
daily_20200818_addname_dataframe['cname'] = daily_20200818_tscode_list
for table_name in daily_20200818.columns.values.tolist():
    daily_20200818_addname_dataframe[table_name] = daily_20200818[table_name]
print("日线行情-时间为序  daily_20200818 返回数据 row 行数 = "+str(daily_20200818.shape[0]))
daily_20200818_addname_dataframe.to_excel(daily_202008_excel_writer,'18_2',index=False)
daily_202008_excel_writer.save()
daily_20200819 = pro.daily(start_date='',end_date='',trade_date='20200819', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20200819_tscode_list = list() 
for ts_code_sh in daily_20200819['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20200819_tscode_list.append(stock_name)
daily_20200819_addname_dataframe=pd.DataFrame()
daily_20200819_addname_dataframe['cname'] = daily_20200819_tscode_list
for table_name in daily_20200819.columns.values.tolist():
    daily_20200819_addname_dataframe[table_name] = daily_20200819[table_name]
print("日线行情-时间为序  daily_20200819 返回数据 row 行数 = "+str(daily_20200819.shape[0]))
daily_20200819_addname_dataframe.to_excel(daily_202008_excel_writer,'19_3',index=False)
daily_202008_excel_writer.save()
daily_20200820 = pro.daily(start_date='',end_date='',trade_date='20200820', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20200820_tscode_list = list() 
for ts_code_sh in daily_20200820['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20200820_tscode_list.append(stock_name)
daily_20200820_addname_dataframe=pd.DataFrame()
daily_20200820_addname_dataframe['cname'] = daily_20200820_tscode_list
for table_name in daily_20200820.columns.values.tolist():
    daily_20200820_addname_dataframe[table_name] = daily_20200820[table_name]
print("日线行情-时间为序  daily_20200820 返回数据 row 行数 = "+str(daily_20200820.shape[0]))
daily_20200820_addname_dataframe.to_excel(daily_202008_excel_writer,'20_4',index=False)
daily_202008_excel_writer.save()
daily_20200821 = pro.daily(start_date='',end_date='',trade_date='20200821', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20200821_tscode_list = list() 
for ts_code_sh in daily_20200821['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20200821_tscode_list.append(stock_name)
daily_20200821_addname_dataframe=pd.DataFrame()
daily_20200821_addname_dataframe['cname'] = daily_20200821_tscode_list
for table_name in daily_20200821.columns.values.tolist():
    daily_20200821_addname_dataframe[table_name] = daily_20200821[table_name]
print("日线行情-时间为序  daily_20200821 返回数据 row 行数 = "+str(daily_20200821.shape[0]))
daily_20200821_addname_dataframe.to_excel(daily_202008_excel_writer,'21_5',index=False)
daily_202008_excel_writer.save()
daily_20200824 = pro.daily(start_date='',end_date='',trade_date='20200824', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20200824_tscode_list = list() 
for ts_code_sh in daily_20200824['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20200824_tscode_list.append(stock_name)
daily_20200824_addname_dataframe=pd.DataFrame()
daily_20200824_addname_dataframe['cname'] = daily_20200824_tscode_list
for table_name in daily_20200824.columns.values.tolist():
    daily_20200824_addname_dataframe[table_name] = daily_20200824[table_name]
print("日线行情-时间为序  daily_20200824 返回数据 row 行数 = "+str(daily_20200824.shape[0]))
daily_20200824_addname_dataframe.to_excel(daily_202008_excel_writer,'24_1',index=False)
daily_202008_excel_writer.save()
daily_20200825 = pro.daily(start_date='',end_date='',trade_date='20200825', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20200825_tscode_list = list() 
for ts_code_sh in daily_20200825['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20200825_tscode_list.append(stock_name)
daily_20200825_addname_dataframe=pd.DataFrame()
daily_20200825_addname_dataframe['cname'] = daily_20200825_tscode_list
for table_name in daily_20200825.columns.values.tolist():
    daily_20200825_addname_dataframe[table_name] = daily_20200825[table_name]
print("日线行情-时间为序  daily_20200825 返回数据 row 行数 = "+str(daily_20200825.shape[0]))
daily_20200825_addname_dataframe.to_excel(daily_202008_excel_writer,'25_2',index=False)
daily_202008_excel_writer.save()
daily_20200826 = pro.daily(start_date='',end_date='',trade_date='20200826', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20200826_tscode_list = list() 
for ts_code_sh in daily_20200826['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20200826_tscode_list.append(stock_name)
daily_20200826_addname_dataframe=pd.DataFrame()
daily_20200826_addname_dataframe['cname'] = daily_20200826_tscode_list
for table_name in daily_20200826.columns.values.tolist():
    daily_20200826_addname_dataframe[table_name] = daily_20200826[table_name]
print("日线行情-时间为序  daily_20200826 返回数据 row 行数 = "+str(daily_20200826.shape[0]))
daily_20200826_addname_dataframe.to_excel(daily_202008_excel_writer,'26_3',index=False)
daily_202008_excel_writer.save()
daily_20200827 = pro.daily(start_date='',end_date='',trade_date='20200827', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20200827_tscode_list = list() 
for ts_code_sh in daily_20200827['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20200827_tscode_list.append(stock_name)
daily_20200827_addname_dataframe=pd.DataFrame()
daily_20200827_addname_dataframe['cname'] = daily_20200827_tscode_list
for table_name in daily_20200827.columns.values.tolist():
    daily_20200827_addname_dataframe[table_name] = daily_20200827[table_name]
print("日线行情-时间为序  daily_20200827 返回数据 row 行数 = "+str(daily_20200827.shape[0]))
daily_20200827_addname_dataframe.to_excel(daily_202008_excel_writer,'27_4',index=False)
daily_202008_excel_writer.save()
daily_20200828 = pro.daily(start_date='',end_date='',trade_date='20200828', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20200828_tscode_list = list() 
for ts_code_sh in daily_20200828['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20200828_tscode_list.append(stock_name)
daily_20200828_addname_dataframe=pd.DataFrame()
daily_20200828_addname_dataframe['cname'] = daily_20200828_tscode_list
for table_name in daily_20200828.columns.values.tolist():
    daily_20200828_addname_dataframe[table_name] = daily_20200828[table_name]
print("日线行情-时间为序  daily_20200828 返回数据 row 行数 = "+str(daily_20200828.shape[0]))
daily_20200828_addname_dataframe.to_excel(daily_202008_excel_writer,'28_5',index=False)
daily_202008_excel_writer.save()
daily_20200831 = pro.daily(start_date='',end_date='',trade_date='20200831', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20200831_tscode_list = list() 
for ts_code_sh in daily_20200831['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20200831_tscode_list.append(stock_name)
daily_20200831_addname_dataframe=pd.DataFrame()
daily_20200831_addname_dataframe['cname'] = daily_20200831_tscode_list
for table_name in daily_20200831.columns.values.tolist():
    daily_20200831_addname_dataframe[table_name] = daily_20200831[table_name]
print("日线行情-时间为序  daily_20200831 返回数据 row 行数 = "+str(daily_20200831.shape[0]))
daily_20200831_addname_dataframe.to_excel(daily_202008_excel_writer,'31_1',index=False)
daily_202008_excel_writer.save()




createexcel('daily_202009.xlsx')
daily_202009_book = load_workbook('C:\\Users\\zhuzj5\\Desktop\\zbin\\J0_Data\\daily_202009.xlsx')
daily_202009_excel_writer = pd.ExcelWriter('C:\\Users\\zhuzj5\\Desktop\\zbin\\J0_Data\\daily_202009.xlsx', engine='openpyxl')
daily_202009_excel_writer.book = daily_202009_book
daily_202009_excel_writer.sheets = dict((ws.title, ws) for ws in daily_202009_book.worksheets)
J0_PROPS.put(tree_node_name+"record_date", "20200901")       ###  更新 记录日期
daily_20200901 = pro.daily(start_date='',end_date='',trade_date='20200901', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20200901_tscode_list = list() 
for ts_code_sh in daily_20200901['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20200901_tscode_list.append(stock_name)
daily_20200901_addname_dataframe=pd.DataFrame()
daily_20200901_addname_dataframe['cname'] = daily_20200901_tscode_list
for table_name in daily_20200901.columns.values.tolist():
    daily_20200901_addname_dataframe[table_name] = daily_20200901[table_name]
print("日线行情-时间为序  daily_20200901 返回数据 row 行数 = "+str(daily_20200901.shape[0]))
daily_20200901_addname_dataframe.to_excel(daily_202009_excel_writer,'1_2',index=False)
daily_202009_excel_writer.save()
daily_20200902 = pro.daily(start_date='',end_date='',trade_date='20200902', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20200902_tscode_list = list() 
for ts_code_sh in daily_20200902['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20200902_tscode_list.append(stock_name)
daily_20200902_addname_dataframe=pd.DataFrame()
daily_20200902_addname_dataframe['cname'] = daily_20200902_tscode_list
for table_name in daily_20200902.columns.values.tolist():
    daily_20200902_addname_dataframe[table_name] = daily_20200902[table_name]
print("日线行情-时间为序  daily_20200902 返回数据 row 行数 = "+str(daily_20200902.shape[0]))
daily_20200902_addname_dataframe.to_excel(daily_202009_excel_writer,'2_3',index=False)
daily_202009_excel_writer.save()
daily_20200903 = pro.daily(start_date='',end_date='',trade_date='20200903', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20200903_tscode_list = list() 
for ts_code_sh in daily_20200903['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20200903_tscode_list.append(stock_name)
daily_20200903_addname_dataframe=pd.DataFrame()
daily_20200903_addname_dataframe['cname'] = daily_20200903_tscode_list
for table_name in daily_20200903.columns.values.tolist():
    daily_20200903_addname_dataframe[table_name] = daily_20200903[table_name]
print("日线行情-时间为序  daily_20200903 返回数据 row 行数 = "+str(daily_20200903.shape[0]))
daily_20200903_addname_dataframe.to_excel(daily_202009_excel_writer,'3_4',index=False)
daily_202009_excel_writer.save()
daily_20200904 = pro.daily(start_date='',end_date='',trade_date='20200904', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20200904_tscode_list = list() 
for ts_code_sh in daily_20200904['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20200904_tscode_list.append(stock_name)
daily_20200904_addname_dataframe=pd.DataFrame()
daily_20200904_addname_dataframe['cname'] = daily_20200904_tscode_list
for table_name in daily_20200904.columns.values.tolist():
    daily_20200904_addname_dataframe[table_name] = daily_20200904[table_name]
print("日线行情-时间为序  daily_20200904 返回数据 row 行数 = "+str(daily_20200904.shape[0]))
daily_20200904_addname_dataframe.to_excel(daily_202009_excel_writer,'4_5',index=False)
daily_202009_excel_writer.save()
daily_20200907 = pro.daily(start_date='',end_date='',trade_date='20200907', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20200907_tscode_list = list() 
for ts_code_sh in daily_20200907['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20200907_tscode_list.append(stock_name)
daily_20200907_addname_dataframe=pd.DataFrame()
daily_20200907_addname_dataframe['cname'] = daily_20200907_tscode_list
for table_name in daily_20200907.columns.values.tolist():
    daily_20200907_addname_dataframe[table_name] = daily_20200907[table_name]
print("日线行情-时间为序  daily_20200907 返回数据 row 行数 = "+str(daily_20200907.shape[0]))
daily_20200907_addname_dataframe.to_excel(daily_202009_excel_writer,'7_1',index=False)
daily_202009_excel_writer.save()
daily_20200908 = pro.daily(start_date='',end_date='',trade_date='20200908', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20200908_tscode_list = list() 
for ts_code_sh in daily_20200908['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20200908_tscode_list.append(stock_name)
daily_20200908_addname_dataframe=pd.DataFrame()
daily_20200908_addname_dataframe['cname'] = daily_20200908_tscode_list
for table_name in daily_20200908.columns.values.tolist():
    daily_20200908_addname_dataframe[table_name] = daily_20200908[table_name]
print("日线行情-时间为序  daily_20200908 返回数据 row 行数 = "+str(daily_20200908.shape[0]))
daily_20200908_addname_dataframe.to_excel(daily_202009_excel_writer,'8_2',index=False)
daily_202009_excel_writer.save()
daily_20200909 = pro.daily(start_date='',end_date='',trade_date='20200909', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20200909_tscode_list = list() 
for ts_code_sh in daily_20200909['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20200909_tscode_list.append(stock_name)
daily_20200909_addname_dataframe=pd.DataFrame()
daily_20200909_addname_dataframe['cname'] = daily_20200909_tscode_list
for table_name in daily_20200909.columns.values.tolist():
    daily_20200909_addname_dataframe[table_name] = daily_20200909[table_name]
print("日线行情-时间为序  daily_20200909 返回数据 row 行数 = "+str(daily_20200909.shape[0]))
daily_20200909_addname_dataframe.to_excel(daily_202009_excel_writer,'9_3',index=False)
daily_202009_excel_writer.save()
daily_20200910 = pro.daily(start_date='',end_date='',trade_date='20200910', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20200910_tscode_list = list() 
for ts_code_sh in daily_20200910['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20200910_tscode_list.append(stock_name)
daily_20200910_addname_dataframe=pd.DataFrame()
daily_20200910_addname_dataframe['cname'] = daily_20200910_tscode_list
for table_name in daily_20200910.columns.values.tolist():
    daily_20200910_addname_dataframe[table_name] = daily_20200910[table_name]
print("日线行情-时间为序  daily_20200910 返回数据 row 行数 = "+str(daily_20200910.shape[0]))
daily_20200910_addname_dataframe.to_excel(daily_202009_excel_writer,'10_4',index=False)
daily_202009_excel_writer.save()
daily_20200911 = pro.daily(start_date='',end_date='',trade_date='20200911', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20200911_tscode_list = list() 
for ts_code_sh in daily_20200911['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20200911_tscode_list.append(stock_name)
daily_20200911_addname_dataframe=pd.DataFrame()
daily_20200911_addname_dataframe['cname'] = daily_20200911_tscode_list
for table_name in daily_20200911.columns.values.tolist():
    daily_20200911_addname_dataframe[table_name] = daily_20200911[table_name]
print("日线行情-时间为序  daily_20200911 返回数据 row 行数 = "+str(daily_20200911.shape[0]))
daily_20200911_addname_dataframe.to_excel(daily_202009_excel_writer,'11_5',index=False)
daily_202009_excel_writer.save()
daily_20200914 = pro.daily(start_date='',end_date='',trade_date='20200914', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20200914_tscode_list = list() 
for ts_code_sh in daily_20200914['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20200914_tscode_list.append(stock_name)
daily_20200914_addname_dataframe=pd.DataFrame()
daily_20200914_addname_dataframe['cname'] = daily_20200914_tscode_list
for table_name in daily_20200914.columns.values.tolist():
    daily_20200914_addname_dataframe[table_name] = daily_20200914[table_name]
print("日线行情-时间为序  daily_20200914 返回数据 row 行数 = "+str(daily_20200914.shape[0]))
daily_20200914_addname_dataframe.to_excel(daily_202009_excel_writer,'14_1',index=False)
daily_202009_excel_writer.save()
daily_20200915 = pro.daily(start_date='',end_date='',trade_date='20200915', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20200915_tscode_list = list() 
for ts_code_sh in daily_20200915['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20200915_tscode_list.append(stock_name)
daily_20200915_addname_dataframe=pd.DataFrame()
daily_20200915_addname_dataframe['cname'] = daily_20200915_tscode_list
for table_name in daily_20200915.columns.values.tolist():
    daily_20200915_addname_dataframe[table_name] = daily_20200915[table_name]
print("日线行情-时间为序  daily_20200915 返回数据 row 行数 = "+str(daily_20200915.shape[0]))
daily_20200915_addname_dataframe.to_excel(daily_202009_excel_writer,'15_2',index=False)
daily_202009_excel_writer.save()
daily_20200916 = pro.daily(start_date='',end_date='',trade_date='20200916', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20200916_tscode_list = list() 
for ts_code_sh in daily_20200916['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20200916_tscode_list.append(stock_name)
daily_20200916_addname_dataframe=pd.DataFrame()
daily_20200916_addname_dataframe['cname'] = daily_20200916_tscode_list
for table_name in daily_20200916.columns.values.tolist():
    daily_20200916_addname_dataframe[table_name] = daily_20200916[table_name]
print("日线行情-时间为序  daily_20200916 返回数据 row 行数 = "+str(daily_20200916.shape[0]))
daily_20200916_addname_dataframe.to_excel(daily_202009_excel_writer,'16_3',index=False)
daily_202009_excel_writer.save()
daily_20200917 = pro.daily(start_date='',end_date='',trade_date='20200917', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20200917_tscode_list = list() 
for ts_code_sh in daily_20200917['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20200917_tscode_list.append(stock_name)
daily_20200917_addname_dataframe=pd.DataFrame()
daily_20200917_addname_dataframe['cname'] = daily_20200917_tscode_list
for table_name in daily_20200917.columns.values.tolist():
    daily_20200917_addname_dataframe[table_name] = daily_20200917[table_name]
print("日线行情-时间为序  daily_20200917 返回数据 row 行数 = "+str(daily_20200917.shape[0]))
daily_20200917_addname_dataframe.to_excel(daily_202009_excel_writer,'17_4',index=False)
daily_202009_excel_writer.save()
daily_20200918 = pro.daily(start_date='',end_date='',trade_date='20200918', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20200918_tscode_list = list() 
for ts_code_sh in daily_20200918['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20200918_tscode_list.append(stock_name)
daily_20200918_addname_dataframe=pd.DataFrame()
daily_20200918_addname_dataframe['cname'] = daily_20200918_tscode_list
for table_name in daily_20200918.columns.values.tolist():
    daily_20200918_addname_dataframe[table_name] = daily_20200918[table_name]
print("日线行情-时间为序  daily_20200918 返回数据 row 行数 = "+str(daily_20200918.shape[0]))
daily_20200918_addname_dataframe.to_excel(daily_202009_excel_writer,'18_5',index=False)
daily_202009_excel_writer.save()
daily_20200921 = pro.daily(start_date='',end_date='',trade_date='20200921', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20200921_tscode_list = list() 
for ts_code_sh in daily_20200921['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20200921_tscode_list.append(stock_name)
daily_20200921_addname_dataframe=pd.DataFrame()
daily_20200921_addname_dataframe['cname'] = daily_20200921_tscode_list
for table_name in daily_20200921.columns.values.tolist():
    daily_20200921_addname_dataframe[table_name] = daily_20200921[table_name]
print("日线行情-时间为序  daily_20200921 返回数据 row 行数 = "+str(daily_20200921.shape[0]))
daily_20200921_addname_dataframe.to_excel(daily_202009_excel_writer,'21_1',index=False)
daily_202009_excel_writer.save()
daily_20200922 = pro.daily(start_date='',end_date='',trade_date='20200922', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20200922_tscode_list = list() 
for ts_code_sh in daily_20200922['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20200922_tscode_list.append(stock_name)
daily_20200922_addname_dataframe=pd.DataFrame()
daily_20200922_addname_dataframe['cname'] = daily_20200922_tscode_list
for table_name in daily_20200922.columns.values.tolist():
    daily_20200922_addname_dataframe[table_name] = daily_20200922[table_name]
print("日线行情-时间为序  daily_20200922 返回数据 row 行数 = "+str(daily_20200922.shape[0]))
daily_20200922_addname_dataframe.to_excel(daily_202009_excel_writer,'22_2',index=False)
daily_202009_excel_writer.save()
daily_20200923 = pro.daily(start_date='',end_date='',trade_date='20200923', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20200923_tscode_list = list() 
for ts_code_sh in daily_20200923['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20200923_tscode_list.append(stock_name)
daily_20200923_addname_dataframe=pd.DataFrame()
daily_20200923_addname_dataframe['cname'] = daily_20200923_tscode_list
for table_name in daily_20200923.columns.values.tolist():
    daily_20200923_addname_dataframe[table_name] = daily_20200923[table_name]
print("日线行情-时间为序  daily_20200923 返回数据 row 行数 = "+str(daily_20200923.shape[0]))
daily_20200923_addname_dataframe.to_excel(daily_202009_excel_writer,'23_3',index=False)
daily_202009_excel_writer.save()
daily_20200924 = pro.daily(start_date='',end_date='',trade_date='20200924', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20200924_tscode_list = list() 
for ts_code_sh in daily_20200924['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20200924_tscode_list.append(stock_name)
daily_20200924_addname_dataframe=pd.DataFrame()
daily_20200924_addname_dataframe['cname'] = daily_20200924_tscode_list
for table_name in daily_20200924.columns.values.tolist():
    daily_20200924_addname_dataframe[table_name] = daily_20200924[table_name]
print("日线行情-时间为序  daily_20200924 返回数据 row 行数 = "+str(daily_20200924.shape[0]))
daily_20200924_addname_dataframe.to_excel(daily_202009_excel_writer,'24_4',index=False)
daily_202009_excel_writer.save()
daily_20200925 = pro.daily(start_date='',end_date='',trade_date='20200925', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20200925_tscode_list = list() 
for ts_code_sh in daily_20200925['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20200925_tscode_list.append(stock_name)
daily_20200925_addname_dataframe=pd.DataFrame()
daily_20200925_addname_dataframe['cname'] = daily_20200925_tscode_list
for table_name in daily_20200925.columns.values.tolist():
    daily_20200925_addname_dataframe[table_name] = daily_20200925[table_name]
print("日线行情-时间为序  daily_20200925 返回数据 row 行数 = "+str(daily_20200925.shape[0]))
daily_20200925_addname_dataframe.to_excel(daily_202009_excel_writer,'25_5',index=False)
daily_202009_excel_writer.save()
daily_20200928 = pro.daily(start_date='',end_date='',trade_date='20200928', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20200928_tscode_list = list() 
for ts_code_sh in daily_20200928['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20200928_tscode_list.append(stock_name)
daily_20200928_addname_dataframe=pd.DataFrame()
daily_20200928_addname_dataframe['cname'] = daily_20200928_tscode_list
for table_name in daily_20200928.columns.values.tolist():
    daily_20200928_addname_dataframe[table_name] = daily_20200928[table_name]
print("日线行情-时间为序  daily_20200928 返回数据 row 行数 = "+str(daily_20200928.shape[0]))
daily_20200928_addname_dataframe.to_excel(daily_202009_excel_writer,'28_1',index=False)
daily_202009_excel_writer.save()
daily_20200929 = pro.daily(start_date='',end_date='',trade_date='20200929', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20200929_tscode_list = list() 
for ts_code_sh in daily_20200929['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20200929_tscode_list.append(stock_name)
daily_20200929_addname_dataframe=pd.DataFrame()
daily_20200929_addname_dataframe['cname'] = daily_20200929_tscode_list
for table_name in daily_20200929.columns.values.tolist():
    daily_20200929_addname_dataframe[table_name] = daily_20200929[table_name]
print("日线行情-时间为序  daily_20200929 返回数据 row 行数 = "+str(daily_20200929.shape[0]))
daily_20200929_addname_dataframe.to_excel(daily_202009_excel_writer,'29_2',index=False)
daily_202009_excel_writer.save()
daily_20200930 = pro.daily(start_date='',end_date='',trade_date='20200930', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20200930_tscode_list = list() 
for ts_code_sh in daily_20200930['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20200930_tscode_list.append(stock_name)
daily_20200930_addname_dataframe=pd.DataFrame()
daily_20200930_addname_dataframe['cname'] = daily_20200930_tscode_list
for table_name in daily_20200930.columns.values.tolist():
    daily_20200930_addname_dataframe[table_name] = daily_20200930[table_name]
print("日线行情-时间为序  daily_20200930 返回数据 row 行数 = "+str(daily_20200930.shape[0]))
daily_20200930_addname_dataframe.to_excel(daily_202009_excel_writer,'30_3',index=False)
daily_202009_excel_writer.save()




createexcel('daily_202010.xlsx')
daily_202010_book = load_workbook('C:\\Users\\zhuzj5\\Desktop\\zbin\\J0_Data\\daily_202010.xlsx')
daily_202010_excel_writer = pd.ExcelWriter('C:\\Users\\zhuzj5\\Desktop\\zbin\\J0_Data\\daily_202010.xlsx', engine='openpyxl')
daily_202010_excel_writer.book = daily_202010_book
daily_202010_excel_writer.sheets = dict((ws.title, ws) for ws in daily_202010_book.worksheets)
J0_PROPS.put(tree_node_name+"record_date", "20201001")       ###  更新 记录日期
daily_20201009 = pro.daily(start_date='',end_date='',trade_date='20201009', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20201009_tscode_list = list() 
for ts_code_sh in daily_20201009['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20201009_tscode_list.append(stock_name)
daily_20201009_addname_dataframe=pd.DataFrame()
daily_20201009_addname_dataframe['cname'] = daily_20201009_tscode_list
for table_name in daily_20201009.columns.values.tolist():
    daily_20201009_addname_dataframe[table_name] = daily_20201009[table_name]
print("日线行情-时间为序  daily_20201009 返回数据 row 行数 = "+str(daily_20201009.shape[0]))
daily_20201009_addname_dataframe.to_excel(daily_202010_excel_writer,'9_5',index=False)
daily_202010_excel_writer.save()
daily_20201012 = pro.daily(start_date='',end_date='',trade_date='20201012', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20201012_tscode_list = list() 
for ts_code_sh in daily_20201012['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20201012_tscode_list.append(stock_name)
daily_20201012_addname_dataframe=pd.DataFrame()
daily_20201012_addname_dataframe['cname'] = daily_20201012_tscode_list
for table_name in daily_20201012.columns.values.tolist():
    daily_20201012_addname_dataframe[table_name] = daily_20201012[table_name]
print("日线行情-时间为序  daily_20201012 返回数据 row 行数 = "+str(daily_20201012.shape[0]))
daily_20201012_addname_dataframe.to_excel(daily_202010_excel_writer,'12_1',index=False)
daily_202010_excel_writer.save()
daily_20201013 = pro.daily(start_date='',end_date='',trade_date='20201013', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20201013_tscode_list = list() 
for ts_code_sh in daily_20201013['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20201013_tscode_list.append(stock_name)
daily_20201013_addname_dataframe=pd.DataFrame()
daily_20201013_addname_dataframe['cname'] = daily_20201013_tscode_list
for table_name in daily_20201013.columns.values.tolist():
    daily_20201013_addname_dataframe[table_name] = daily_20201013[table_name]
print("日线行情-时间为序  daily_20201013 返回数据 row 行数 = "+str(daily_20201013.shape[0]))
daily_20201013_addname_dataframe.to_excel(daily_202010_excel_writer,'13_2',index=False)
daily_202010_excel_writer.save()
daily_20201014 = pro.daily(start_date='',end_date='',trade_date='20201014', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20201014_tscode_list = list() 
for ts_code_sh in daily_20201014['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20201014_tscode_list.append(stock_name)
daily_20201014_addname_dataframe=pd.DataFrame()
daily_20201014_addname_dataframe['cname'] = daily_20201014_tscode_list
for table_name in daily_20201014.columns.values.tolist():
    daily_20201014_addname_dataframe[table_name] = daily_20201014[table_name]
print("日线行情-时间为序  daily_20201014 返回数据 row 行数 = "+str(daily_20201014.shape[0]))
daily_20201014_addname_dataframe.to_excel(daily_202010_excel_writer,'14_3',index=False)
daily_202010_excel_writer.save()
daily_20201015 = pro.daily(start_date='',end_date='',trade_date='20201015', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20201015_tscode_list = list() 
for ts_code_sh in daily_20201015['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20201015_tscode_list.append(stock_name)
daily_20201015_addname_dataframe=pd.DataFrame()
daily_20201015_addname_dataframe['cname'] = daily_20201015_tscode_list
for table_name in daily_20201015.columns.values.tolist():
    daily_20201015_addname_dataframe[table_name] = daily_20201015[table_name]
print("日线行情-时间为序  daily_20201015 返回数据 row 行数 = "+str(daily_20201015.shape[0]))
daily_20201015_addname_dataframe.to_excel(daily_202010_excel_writer,'15_4',index=False)
daily_202010_excel_writer.save()
daily_20201016 = pro.daily(start_date='',end_date='',trade_date='20201016', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20201016_tscode_list = list() 
for ts_code_sh in daily_20201016['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20201016_tscode_list.append(stock_name)
daily_20201016_addname_dataframe=pd.DataFrame()
daily_20201016_addname_dataframe['cname'] = daily_20201016_tscode_list
for table_name in daily_20201016.columns.values.tolist():
    daily_20201016_addname_dataframe[table_name] = daily_20201016[table_name]
print("日线行情-时间为序  daily_20201016 返回数据 row 行数 = "+str(daily_20201016.shape[0]))
daily_20201016_addname_dataframe.to_excel(daily_202010_excel_writer,'16_5',index=False)
daily_202010_excel_writer.save()
daily_20201019 = pro.daily(start_date='',end_date='',trade_date='20201019', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20201019_tscode_list = list() 
for ts_code_sh in daily_20201019['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20201019_tscode_list.append(stock_name)
daily_20201019_addname_dataframe=pd.DataFrame()
daily_20201019_addname_dataframe['cname'] = daily_20201019_tscode_list
for table_name in daily_20201019.columns.values.tolist():
    daily_20201019_addname_dataframe[table_name] = daily_20201019[table_name]
print("日线行情-时间为序  daily_20201019 返回数据 row 行数 = "+str(daily_20201019.shape[0]))
daily_20201019_addname_dataframe.to_excel(daily_202010_excel_writer,'19_1',index=False)
daily_202010_excel_writer.save()
daily_20201020 = pro.daily(start_date='',end_date='',trade_date='20201020', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20201020_tscode_list = list() 
for ts_code_sh in daily_20201020['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20201020_tscode_list.append(stock_name)
daily_20201020_addname_dataframe=pd.DataFrame()
daily_20201020_addname_dataframe['cname'] = daily_20201020_tscode_list
for table_name in daily_20201020.columns.values.tolist():
    daily_20201020_addname_dataframe[table_name] = daily_20201020[table_name]
print("日线行情-时间为序  daily_20201020 返回数据 row 行数 = "+str(daily_20201020.shape[0]))
daily_20201020_addname_dataframe.to_excel(daily_202010_excel_writer,'20_2',index=False)
daily_202010_excel_writer.save()
daily_20201021 = pro.daily(start_date='',end_date='',trade_date='20201021', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20201021_tscode_list = list() 
for ts_code_sh in daily_20201021['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20201021_tscode_list.append(stock_name)
daily_20201021_addname_dataframe=pd.DataFrame()
daily_20201021_addname_dataframe['cname'] = daily_20201021_tscode_list
for table_name in daily_20201021.columns.values.tolist():
    daily_20201021_addname_dataframe[table_name] = daily_20201021[table_name]
print("日线行情-时间为序  daily_20201021 返回数据 row 行数 = "+str(daily_20201021.shape[0]))
daily_20201021_addname_dataframe.to_excel(daily_202010_excel_writer,'21_3',index=False)
daily_202010_excel_writer.save()
daily_20201022 = pro.daily(start_date='',end_date='',trade_date='20201022', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20201022_tscode_list = list() 
for ts_code_sh in daily_20201022['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20201022_tscode_list.append(stock_name)
daily_20201022_addname_dataframe=pd.DataFrame()
daily_20201022_addname_dataframe['cname'] = daily_20201022_tscode_list
for table_name in daily_20201022.columns.values.tolist():
    daily_20201022_addname_dataframe[table_name] = daily_20201022[table_name]
print("日线行情-时间为序  daily_20201022 返回数据 row 行数 = "+str(daily_20201022.shape[0]))
daily_20201022_addname_dataframe.to_excel(daily_202010_excel_writer,'22_4',index=False)
daily_202010_excel_writer.save()
daily_20201023 = pro.daily(start_date='',end_date='',trade_date='20201023', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20201023_tscode_list = list() 
for ts_code_sh in daily_20201023['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20201023_tscode_list.append(stock_name)
daily_20201023_addname_dataframe=pd.DataFrame()
daily_20201023_addname_dataframe['cname'] = daily_20201023_tscode_list
for table_name in daily_20201023.columns.values.tolist():
    daily_20201023_addname_dataframe[table_name] = daily_20201023[table_name]
print("日线行情-时间为序  daily_20201023 返回数据 row 行数 = "+str(daily_20201023.shape[0]))
daily_20201023_addname_dataframe.to_excel(daily_202010_excel_writer,'23_5',index=False)
daily_202010_excel_writer.save()
daily_20201026 = pro.daily(start_date='',end_date='',trade_date='20201026', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20201026_tscode_list = list() 
for ts_code_sh in daily_20201026['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20201026_tscode_list.append(stock_name)
daily_20201026_addname_dataframe=pd.DataFrame()
daily_20201026_addname_dataframe['cname'] = daily_20201026_tscode_list
for table_name in daily_20201026.columns.values.tolist():
    daily_20201026_addname_dataframe[table_name] = daily_20201026[table_name]
print("日线行情-时间为序  daily_20201026 返回数据 row 行数 = "+str(daily_20201026.shape[0]))
daily_20201026_addname_dataframe.to_excel(daily_202010_excel_writer,'26_1',index=False)
daily_202010_excel_writer.save()
daily_20201027 = pro.daily(start_date='',end_date='',trade_date='20201027', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20201027_tscode_list = list() 
for ts_code_sh in daily_20201027['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20201027_tscode_list.append(stock_name)
daily_20201027_addname_dataframe=pd.DataFrame()
daily_20201027_addname_dataframe['cname'] = daily_20201027_tscode_list
for table_name in daily_20201027.columns.values.tolist():
    daily_20201027_addname_dataframe[table_name] = daily_20201027[table_name]
print("日线行情-时间为序  daily_20201027 返回数据 row 行数 = "+str(daily_20201027.shape[0]))
daily_20201027_addname_dataframe.to_excel(daily_202010_excel_writer,'27_2',index=False)
daily_202010_excel_writer.save()
daily_20201028 = pro.daily(start_date='',end_date='',trade_date='20201028', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20201028_tscode_list = list() 
for ts_code_sh in daily_20201028['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20201028_tscode_list.append(stock_name)
daily_20201028_addname_dataframe=pd.DataFrame()
daily_20201028_addname_dataframe['cname'] = daily_20201028_tscode_list
for table_name in daily_20201028.columns.values.tolist():
    daily_20201028_addname_dataframe[table_name] = daily_20201028[table_name]
print("日线行情-时间为序  daily_20201028 返回数据 row 行数 = "+str(daily_20201028.shape[0]))
daily_20201028_addname_dataframe.to_excel(daily_202010_excel_writer,'28_3',index=False)
daily_202010_excel_writer.save()
daily_20201029 = pro.daily(start_date='',end_date='',trade_date='20201029', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20201029_tscode_list = list() 
for ts_code_sh in daily_20201029['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20201029_tscode_list.append(stock_name)
daily_20201029_addname_dataframe=pd.DataFrame()
daily_20201029_addname_dataframe['cname'] = daily_20201029_tscode_list
for table_name in daily_20201029.columns.values.tolist():
    daily_20201029_addname_dataframe[table_name] = daily_20201029[table_name]
print("日线行情-时间为序  daily_20201029 返回数据 row 行数 = "+str(daily_20201029.shape[0]))
daily_20201029_addname_dataframe.to_excel(daily_202010_excel_writer,'29_4',index=False)
daily_202010_excel_writer.save()
daily_20201030 = pro.daily(start_date='',end_date='',trade_date='20201030', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20201030_tscode_list = list() 
for ts_code_sh in daily_20201030['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20201030_tscode_list.append(stock_name)
daily_20201030_addname_dataframe=pd.DataFrame()
daily_20201030_addname_dataframe['cname'] = daily_20201030_tscode_list
for table_name in daily_20201030.columns.values.tolist():
    daily_20201030_addname_dataframe[table_name] = daily_20201030[table_name]
print("日线行情-时间为序  daily_20201030 返回数据 row 行数 = "+str(daily_20201030.shape[0]))
daily_20201030_addname_dataframe.to_excel(daily_202010_excel_writer,'30_5',index=False)
daily_202010_excel_writer.save()




createexcel('daily_202011.xlsx')
daily_202011_book = load_workbook('C:\\Users\\zhuzj5\\Desktop\\zbin\\J0_Data\\daily_202011.xlsx')
daily_202011_excel_writer = pd.ExcelWriter('C:\\Users\\zhuzj5\\Desktop\\zbin\\J0_Data\\daily_202011.xlsx', engine='openpyxl')
daily_202011_excel_writer.book = daily_202011_book
daily_202011_excel_writer.sheets = dict((ws.title, ws) for ws in daily_202011_book.worksheets)
J0_PROPS.put(tree_node_name+"record_date", "20201101")       ###  更新 记录日期
daily_20201102 = pro.daily(start_date='',end_date='',trade_date='20201102', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20201102_tscode_list = list() 
for ts_code_sh in daily_20201102['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20201102_tscode_list.append(stock_name)
daily_20201102_addname_dataframe=pd.DataFrame()
daily_20201102_addname_dataframe['cname'] = daily_20201102_tscode_list
for table_name in daily_20201102.columns.values.tolist():
    daily_20201102_addname_dataframe[table_name] = daily_20201102[table_name]
print("日线行情-时间为序  daily_20201102 返回数据 row 行数 = "+str(daily_20201102.shape[0]))
daily_20201102_addname_dataframe.to_excel(daily_202011_excel_writer,'2_1',index=False)
daily_202011_excel_writer.save()
daily_20201103 = pro.daily(start_date='',end_date='',trade_date='20201103', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20201103_tscode_list = list() 
for ts_code_sh in daily_20201103['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20201103_tscode_list.append(stock_name)
daily_20201103_addname_dataframe=pd.DataFrame()
daily_20201103_addname_dataframe['cname'] = daily_20201103_tscode_list
for table_name in daily_20201103.columns.values.tolist():
    daily_20201103_addname_dataframe[table_name] = daily_20201103[table_name]
print("日线行情-时间为序  daily_20201103 返回数据 row 行数 = "+str(daily_20201103.shape[0]))
daily_20201103_addname_dataframe.to_excel(daily_202011_excel_writer,'3_2',index=False)
daily_202011_excel_writer.save()
daily_20201104 = pro.daily(start_date='',end_date='',trade_date='20201104', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20201104_tscode_list = list() 
for ts_code_sh in daily_20201104['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20201104_tscode_list.append(stock_name)
daily_20201104_addname_dataframe=pd.DataFrame()
daily_20201104_addname_dataframe['cname'] = daily_20201104_tscode_list
for table_name in daily_20201104.columns.values.tolist():
    daily_20201104_addname_dataframe[table_name] = daily_20201104[table_name]
print("日线行情-时间为序  daily_20201104 返回数据 row 行数 = "+str(daily_20201104.shape[0]))
daily_20201104_addname_dataframe.to_excel(daily_202011_excel_writer,'4_3',index=False)
daily_202011_excel_writer.save()
daily_20201105 = pro.daily(start_date='',end_date='',trade_date='20201105', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20201105_tscode_list = list() 
for ts_code_sh in daily_20201105['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20201105_tscode_list.append(stock_name)
daily_20201105_addname_dataframe=pd.DataFrame()
daily_20201105_addname_dataframe['cname'] = daily_20201105_tscode_list
for table_name in daily_20201105.columns.values.tolist():
    daily_20201105_addname_dataframe[table_name] = daily_20201105[table_name]
print("日线行情-时间为序  daily_20201105 返回数据 row 行数 = "+str(daily_20201105.shape[0]))
daily_20201105_addname_dataframe.to_excel(daily_202011_excel_writer,'5_4',index=False)
daily_202011_excel_writer.save()
daily_20201106 = pro.daily(start_date='',end_date='',trade_date='20201106', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20201106_tscode_list = list() 
for ts_code_sh in daily_20201106['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20201106_tscode_list.append(stock_name)
daily_20201106_addname_dataframe=pd.DataFrame()
daily_20201106_addname_dataframe['cname'] = daily_20201106_tscode_list
for table_name in daily_20201106.columns.values.tolist():
    daily_20201106_addname_dataframe[table_name] = daily_20201106[table_name]
print("日线行情-时间为序  daily_20201106 返回数据 row 行数 = "+str(daily_20201106.shape[0]))
daily_20201106_addname_dataframe.to_excel(daily_202011_excel_writer,'6_5',index=False)
daily_202011_excel_writer.save()
daily_20201109 = pro.daily(start_date='',end_date='',trade_date='20201109', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20201109_tscode_list = list() 
for ts_code_sh in daily_20201109['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20201109_tscode_list.append(stock_name)
daily_20201109_addname_dataframe=pd.DataFrame()
daily_20201109_addname_dataframe['cname'] = daily_20201109_tscode_list
for table_name in daily_20201109.columns.values.tolist():
    daily_20201109_addname_dataframe[table_name] = daily_20201109[table_name]
print("日线行情-时间为序  daily_20201109 返回数据 row 行数 = "+str(daily_20201109.shape[0]))
daily_20201109_addname_dataframe.to_excel(daily_202011_excel_writer,'9_1',index=False)
daily_202011_excel_writer.save()
daily_20201110 = pro.daily(start_date='',end_date='',trade_date='20201110', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20201110_tscode_list = list() 
for ts_code_sh in daily_20201110['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20201110_tscode_list.append(stock_name)
daily_20201110_addname_dataframe=pd.DataFrame()
daily_20201110_addname_dataframe['cname'] = daily_20201110_tscode_list
for table_name in daily_20201110.columns.values.tolist():
    daily_20201110_addname_dataframe[table_name] = daily_20201110[table_name]
print("日线行情-时间为序  daily_20201110 返回数据 row 行数 = "+str(daily_20201110.shape[0]))
daily_20201110_addname_dataframe.to_excel(daily_202011_excel_writer,'10_2',index=False)
daily_202011_excel_writer.save()
daily_20201111 = pro.daily(start_date='',end_date='',trade_date='20201111', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20201111_tscode_list = list() 
for ts_code_sh in daily_20201111['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20201111_tscode_list.append(stock_name)
daily_20201111_addname_dataframe=pd.DataFrame()
daily_20201111_addname_dataframe['cname'] = daily_20201111_tscode_list
for table_name in daily_20201111.columns.values.tolist():
    daily_20201111_addname_dataframe[table_name] = daily_20201111[table_name]
print("日线行情-时间为序  daily_20201111 返回数据 row 行数 = "+str(daily_20201111.shape[0]))
daily_20201111_addname_dataframe.to_excel(daily_202011_excel_writer,'11_3',index=False)
daily_202011_excel_writer.save()
daily_20201112 = pro.daily(start_date='',end_date='',trade_date='20201112', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20201112_tscode_list = list() 
for ts_code_sh in daily_20201112['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20201112_tscode_list.append(stock_name)
daily_20201112_addname_dataframe=pd.DataFrame()
daily_20201112_addname_dataframe['cname'] = daily_20201112_tscode_list
for table_name in daily_20201112.columns.values.tolist():
    daily_20201112_addname_dataframe[table_name] = daily_20201112[table_name]
print("日线行情-时间为序  daily_20201112 返回数据 row 行数 = "+str(daily_20201112.shape[0]))
daily_20201112_addname_dataframe.to_excel(daily_202011_excel_writer,'12_4',index=False)
daily_202011_excel_writer.save()
daily_20201113 = pro.daily(start_date='',end_date='',trade_date='20201113', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20201113_tscode_list = list() 
for ts_code_sh in daily_20201113['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20201113_tscode_list.append(stock_name)
daily_20201113_addname_dataframe=pd.DataFrame()
daily_20201113_addname_dataframe['cname'] = daily_20201113_tscode_list
for table_name in daily_20201113.columns.values.tolist():
    daily_20201113_addname_dataframe[table_name] = daily_20201113[table_name]
print("日线行情-时间为序  daily_20201113 返回数据 row 行数 = "+str(daily_20201113.shape[0]))
daily_20201113_addname_dataframe.to_excel(daily_202011_excel_writer,'13_5',index=False)
daily_202011_excel_writer.save()
daily_20201116 = pro.daily(start_date='',end_date='',trade_date='20201116', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20201116_tscode_list = list() 
for ts_code_sh in daily_20201116['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20201116_tscode_list.append(stock_name)
daily_20201116_addname_dataframe=pd.DataFrame()
daily_20201116_addname_dataframe['cname'] = daily_20201116_tscode_list
for table_name in daily_20201116.columns.values.tolist():
    daily_20201116_addname_dataframe[table_name] = daily_20201116[table_name]
print("日线行情-时间为序  daily_20201116 返回数据 row 行数 = "+str(daily_20201116.shape[0]))
daily_20201116_addname_dataframe.to_excel(daily_202011_excel_writer,'16_1',index=False)
daily_202011_excel_writer.save()
daily_20201117 = pro.daily(start_date='',end_date='',trade_date='20201117', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20201117_tscode_list = list() 
for ts_code_sh in daily_20201117['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20201117_tscode_list.append(stock_name)
daily_20201117_addname_dataframe=pd.DataFrame()
daily_20201117_addname_dataframe['cname'] = daily_20201117_tscode_list
for table_name in daily_20201117.columns.values.tolist():
    daily_20201117_addname_dataframe[table_name] = daily_20201117[table_name]
print("日线行情-时间为序  daily_20201117 返回数据 row 行数 = "+str(daily_20201117.shape[0]))
daily_20201117_addname_dataframe.to_excel(daily_202011_excel_writer,'17_2',index=False)
daily_202011_excel_writer.save()
daily_20201118 = pro.daily(start_date='',end_date='',trade_date='20201118', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20201118_tscode_list = list() 
for ts_code_sh in daily_20201118['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20201118_tscode_list.append(stock_name)
daily_20201118_addname_dataframe=pd.DataFrame()
daily_20201118_addname_dataframe['cname'] = daily_20201118_tscode_list
for table_name in daily_20201118.columns.values.tolist():
    daily_20201118_addname_dataframe[table_name] = daily_20201118[table_name]
print("日线行情-时间为序  daily_20201118 返回数据 row 行数 = "+str(daily_20201118.shape[0]))
daily_20201118_addname_dataframe.to_excel(daily_202011_excel_writer,'18_3',index=False)
daily_202011_excel_writer.save()
daily_20201119 = pro.daily(start_date='',end_date='',trade_date='20201119', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20201119_tscode_list = list() 
for ts_code_sh in daily_20201119['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20201119_tscode_list.append(stock_name)
daily_20201119_addname_dataframe=pd.DataFrame()
daily_20201119_addname_dataframe['cname'] = daily_20201119_tscode_list
for table_name in daily_20201119.columns.values.tolist():
    daily_20201119_addname_dataframe[table_name] = daily_20201119[table_name]
print("日线行情-时间为序  daily_20201119 返回数据 row 行数 = "+str(daily_20201119.shape[0]))
daily_20201119_addname_dataframe.to_excel(daily_202011_excel_writer,'19_4',index=False)
daily_202011_excel_writer.save()
daily_20201120 = pro.daily(start_date='',end_date='',trade_date='20201120', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20201120_tscode_list = list() 
for ts_code_sh in daily_20201120['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20201120_tscode_list.append(stock_name)
daily_20201120_addname_dataframe=pd.DataFrame()
daily_20201120_addname_dataframe['cname'] = daily_20201120_tscode_list
for table_name in daily_20201120.columns.values.tolist():
    daily_20201120_addname_dataframe[table_name] = daily_20201120[table_name]
print("日线行情-时间为序  daily_20201120 返回数据 row 行数 = "+str(daily_20201120.shape[0]))
daily_20201120_addname_dataframe.to_excel(daily_202011_excel_writer,'20_5',index=False)
daily_202011_excel_writer.save()
daily_20201123 = pro.daily(start_date='',end_date='',trade_date='20201123', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20201123_tscode_list = list() 
for ts_code_sh in daily_20201123['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20201123_tscode_list.append(stock_name)
daily_20201123_addname_dataframe=pd.DataFrame()
daily_20201123_addname_dataframe['cname'] = daily_20201123_tscode_list
for table_name in daily_20201123.columns.values.tolist():
    daily_20201123_addname_dataframe[table_name] = daily_20201123[table_name]
print("日线行情-时间为序  daily_20201123 返回数据 row 行数 = "+str(daily_20201123.shape[0]))
daily_20201123_addname_dataframe.to_excel(daily_202011_excel_writer,'23_1',index=False)
daily_202011_excel_writer.save()
daily_20201124 = pro.daily(start_date='',end_date='',trade_date='20201124', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20201124_tscode_list = list() 
for ts_code_sh in daily_20201124['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20201124_tscode_list.append(stock_name)
daily_20201124_addname_dataframe=pd.DataFrame()
daily_20201124_addname_dataframe['cname'] = daily_20201124_tscode_list
for table_name in daily_20201124.columns.values.tolist():
    daily_20201124_addname_dataframe[table_name] = daily_20201124[table_name]
print("日线行情-时间为序  daily_20201124 返回数据 row 行数 = "+str(daily_20201124.shape[0]))
daily_20201124_addname_dataframe.to_excel(daily_202011_excel_writer,'24_2',index=False)
daily_202011_excel_writer.save()
daily_20201125 = pro.daily(start_date='',end_date='',trade_date='20201125', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20201125_tscode_list = list() 
for ts_code_sh in daily_20201125['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20201125_tscode_list.append(stock_name)
daily_20201125_addname_dataframe=pd.DataFrame()
daily_20201125_addname_dataframe['cname'] = daily_20201125_tscode_list
for table_name in daily_20201125.columns.values.tolist():
    daily_20201125_addname_dataframe[table_name] = daily_20201125[table_name]
print("日线行情-时间为序  daily_20201125 返回数据 row 行数 = "+str(daily_20201125.shape[0]))
daily_20201125_addname_dataframe.to_excel(daily_202011_excel_writer,'25_3',index=False)
daily_202011_excel_writer.save()
daily_20201126 = pro.daily(start_date='',end_date='',trade_date='20201126', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20201126_tscode_list = list() 
for ts_code_sh in daily_20201126['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20201126_tscode_list.append(stock_name)
daily_20201126_addname_dataframe=pd.DataFrame()
daily_20201126_addname_dataframe['cname'] = daily_20201126_tscode_list
for table_name in daily_20201126.columns.values.tolist():
    daily_20201126_addname_dataframe[table_name] = daily_20201126[table_name]
print("日线行情-时间为序  daily_20201126 返回数据 row 行数 = "+str(daily_20201126.shape[0]))
daily_20201126_addname_dataframe.to_excel(daily_202011_excel_writer,'26_4',index=False)
daily_202011_excel_writer.save()
daily_20201127 = pro.daily(start_date='',end_date='',trade_date='20201127', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20201127_tscode_list = list() 
for ts_code_sh in daily_20201127['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20201127_tscode_list.append(stock_name)
daily_20201127_addname_dataframe=pd.DataFrame()
daily_20201127_addname_dataframe['cname'] = daily_20201127_tscode_list
for table_name in daily_20201127.columns.values.tolist():
    daily_20201127_addname_dataframe[table_name] = daily_20201127[table_name]
print("日线行情-时间为序  daily_20201127 返回数据 row 行数 = "+str(daily_20201127.shape[0]))
daily_20201127_addname_dataframe.to_excel(daily_202011_excel_writer,'27_5',index=False)
daily_202011_excel_writer.save()
daily_20201130 = pro.daily(start_date='',end_date='',trade_date='20201130', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20201130_tscode_list = list() 
for ts_code_sh in daily_20201130['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20201130_tscode_list.append(stock_name)
daily_20201130_addname_dataframe=pd.DataFrame()
daily_20201130_addname_dataframe['cname'] = daily_20201130_tscode_list
for table_name in daily_20201130.columns.values.tolist():
    daily_20201130_addname_dataframe[table_name] = daily_20201130[table_name]
print("日线行情-时间为序  daily_20201130 返回数据 row 行数 = "+str(daily_20201130.shape[0]))
daily_20201130_addname_dataframe.to_excel(daily_202011_excel_writer,'30_1',index=False)
daily_202011_excel_writer.save()




createexcel('daily_202012.xlsx')
daily_202012_book = load_workbook('C:\\Users\\zhuzj5\\Desktop\\zbin\\J0_Data\\daily_202012.xlsx')
daily_202012_excel_writer = pd.ExcelWriter('C:\\Users\\zhuzj5\\Desktop\\zbin\\J0_Data\\daily_202012.xlsx', engine='openpyxl')
daily_202012_excel_writer.book = daily_202012_book
daily_202012_excel_writer.sheets = dict((ws.title, ws) for ws in daily_202012_book.worksheets)
J0_PROPS.put(tree_node_name+"record_date", "20201201")       ###  更新 记录日期
daily_20201201 = pro.daily(start_date='',end_date='',trade_date='20201201', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20201201_tscode_list = list() 
for ts_code_sh in daily_20201201['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20201201_tscode_list.append(stock_name)
daily_20201201_addname_dataframe=pd.DataFrame()
daily_20201201_addname_dataframe['cname'] = daily_20201201_tscode_list
for table_name in daily_20201201.columns.values.tolist():
    daily_20201201_addname_dataframe[table_name] = daily_20201201[table_name]
print("日线行情-时间为序  daily_20201201 返回数据 row 行数 = "+str(daily_20201201.shape[0]))
daily_20201201_addname_dataframe.to_excel(daily_202012_excel_writer,'1_2',index=False)
daily_202012_excel_writer.save()
daily_20201202 = pro.daily(start_date='',end_date='',trade_date='20201202', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20201202_tscode_list = list() 
for ts_code_sh in daily_20201202['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20201202_tscode_list.append(stock_name)
daily_20201202_addname_dataframe=pd.DataFrame()
daily_20201202_addname_dataframe['cname'] = daily_20201202_tscode_list
for table_name in daily_20201202.columns.values.tolist():
    daily_20201202_addname_dataframe[table_name] = daily_20201202[table_name]
print("日线行情-时间为序  daily_20201202 返回数据 row 行数 = "+str(daily_20201202.shape[0]))
daily_20201202_addname_dataframe.to_excel(daily_202012_excel_writer,'2_3',index=False)
daily_202012_excel_writer.save()
daily_20201203 = pro.daily(start_date='',end_date='',trade_date='20201203', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20201203_tscode_list = list() 
for ts_code_sh in daily_20201203['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20201203_tscode_list.append(stock_name)
daily_20201203_addname_dataframe=pd.DataFrame()
daily_20201203_addname_dataframe['cname'] = daily_20201203_tscode_list
for table_name in daily_20201203.columns.values.tolist():
    daily_20201203_addname_dataframe[table_name] = daily_20201203[table_name]
print("日线行情-时间为序  daily_20201203 返回数据 row 行数 = "+str(daily_20201203.shape[0]))
daily_20201203_addname_dataframe.to_excel(daily_202012_excel_writer,'3_4',index=False)
daily_202012_excel_writer.save()
daily_20201204 = pro.daily(start_date='',end_date='',trade_date='20201204', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20201204_tscode_list = list() 
for ts_code_sh in daily_20201204['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20201204_tscode_list.append(stock_name)
daily_20201204_addname_dataframe=pd.DataFrame()
daily_20201204_addname_dataframe['cname'] = daily_20201204_tscode_list
for table_name in daily_20201204.columns.values.tolist():
    daily_20201204_addname_dataframe[table_name] = daily_20201204[table_name]
print("日线行情-时间为序  daily_20201204 返回数据 row 行数 = "+str(daily_20201204.shape[0]))
daily_20201204_addname_dataframe.to_excel(daily_202012_excel_writer,'4_5',index=False)
daily_202012_excel_writer.save()
daily_20201207 = pro.daily(start_date='',end_date='',trade_date='20201207', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20201207_tscode_list = list() 
for ts_code_sh in daily_20201207['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20201207_tscode_list.append(stock_name)
daily_20201207_addname_dataframe=pd.DataFrame()
daily_20201207_addname_dataframe['cname'] = daily_20201207_tscode_list
for table_name in daily_20201207.columns.values.tolist():
    daily_20201207_addname_dataframe[table_name] = daily_20201207[table_name]
print("日线行情-时间为序  daily_20201207 返回数据 row 行数 = "+str(daily_20201207.shape[0]))
daily_20201207_addname_dataframe.to_excel(daily_202012_excel_writer,'7_1',index=False)
daily_202012_excel_writer.save()
daily_20201208 = pro.daily(start_date='',end_date='',trade_date='20201208', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20201208_tscode_list = list() 
for ts_code_sh in daily_20201208['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20201208_tscode_list.append(stock_name)
daily_20201208_addname_dataframe=pd.DataFrame()
daily_20201208_addname_dataframe['cname'] = daily_20201208_tscode_list
for table_name in daily_20201208.columns.values.tolist():
    daily_20201208_addname_dataframe[table_name] = daily_20201208[table_name]
print("日线行情-时间为序  daily_20201208 返回数据 row 行数 = "+str(daily_20201208.shape[0]))
daily_20201208_addname_dataframe.to_excel(daily_202012_excel_writer,'8_2',index=False)
daily_202012_excel_writer.save()
daily_20201209 = pro.daily(start_date='',end_date='',trade_date='20201209', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20201209_tscode_list = list() 
for ts_code_sh in daily_20201209['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20201209_tscode_list.append(stock_name)
daily_20201209_addname_dataframe=pd.DataFrame()
daily_20201209_addname_dataframe['cname'] = daily_20201209_tscode_list
for table_name in daily_20201209.columns.values.tolist():
    daily_20201209_addname_dataframe[table_name] = daily_20201209[table_name]
print("日线行情-时间为序  daily_20201209 返回数据 row 行数 = "+str(daily_20201209.shape[0]))
daily_20201209_addname_dataframe.to_excel(daily_202012_excel_writer,'9_3',index=False)
daily_202012_excel_writer.save()
daily_20201210 = pro.daily(start_date='',end_date='',trade_date='20201210', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20201210_tscode_list = list() 
for ts_code_sh in daily_20201210['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20201210_tscode_list.append(stock_name)
daily_20201210_addname_dataframe=pd.DataFrame()
daily_20201210_addname_dataframe['cname'] = daily_20201210_tscode_list
for table_name in daily_20201210.columns.values.tolist():
    daily_20201210_addname_dataframe[table_name] = daily_20201210[table_name]
print("日线行情-时间为序  daily_20201210 返回数据 row 行数 = "+str(daily_20201210.shape[0]))
daily_20201210_addname_dataframe.to_excel(daily_202012_excel_writer,'10_4',index=False)
daily_202012_excel_writer.save()
daily_20201211 = pro.daily(start_date='',end_date='',trade_date='20201211', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20201211_tscode_list = list() 
for ts_code_sh in daily_20201211['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20201211_tscode_list.append(stock_name)
daily_20201211_addname_dataframe=pd.DataFrame()
daily_20201211_addname_dataframe['cname'] = daily_20201211_tscode_list
for table_name in daily_20201211.columns.values.tolist():
    daily_20201211_addname_dataframe[table_name] = daily_20201211[table_name]
print("日线行情-时间为序  daily_20201211 返回数据 row 行数 = "+str(daily_20201211.shape[0]))
daily_20201211_addname_dataframe.to_excel(daily_202012_excel_writer,'11_5',index=False)
daily_202012_excel_writer.save()
daily_20201214 = pro.daily(start_date='',end_date='',trade_date='20201214', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20201214_tscode_list = list() 
for ts_code_sh in daily_20201214['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20201214_tscode_list.append(stock_name)
daily_20201214_addname_dataframe=pd.DataFrame()
daily_20201214_addname_dataframe['cname'] = daily_20201214_tscode_list
for table_name in daily_20201214.columns.values.tolist():
    daily_20201214_addname_dataframe[table_name] = daily_20201214[table_name]
print("日线行情-时间为序  daily_20201214 返回数据 row 行数 = "+str(daily_20201214.shape[0]))
daily_20201214_addname_dataframe.to_excel(daily_202012_excel_writer,'14_1',index=False)
daily_202012_excel_writer.save()
daily_20201215 = pro.daily(start_date='',end_date='',trade_date='20201215', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20201215_tscode_list = list() 
for ts_code_sh in daily_20201215['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20201215_tscode_list.append(stock_name)
daily_20201215_addname_dataframe=pd.DataFrame()
daily_20201215_addname_dataframe['cname'] = daily_20201215_tscode_list
for table_name in daily_20201215.columns.values.tolist():
    daily_20201215_addname_dataframe[table_name] = daily_20201215[table_name]
print("日线行情-时间为序  daily_20201215 返回数据 row 行数 = "+str(daily_20201215.shape[0]))
daily_20201215_addname_dataframe.to_excel(daily_202012_excel_writer,'15_2',index=False)
daily_202012_excel_writer.save()
daily_20201216 = pro.daily(start_date='',end_date='',trade_date='20201216', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20201216_tscode_list = list() 
for ts_code_sh in daily_20201216['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20201216_tscode_list.append(stock_name)
daily_20201216_addname_dataframe=pd.DataFrame()
daily_20201216_addname_dataframe['cname'] = daily_20201216_tscode_list
for table_name in daily_20201216.columns.values.tolist():
    daily_20201216_addname_dataframe[table_name] = daily_20201216[table_name]
print("日线行情-时间为序  daily_20201216 返回数据 row 行数 = "+str(daily_20201216.shape[0]))
daily_20201216_addname_dataframe.to_excel(daily_202012_excel_writer,'16_3',index=False)
daily_202012_excel_writer.save()
daily_20201217 = pro.daily(start_date='',end_date='',trade_date='20201217', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20201217_tscode_list = list() 
for ts_code_sh in daily_20201217['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20201217_tscode_list.append(stock_name)
daily_20201217_addname_dataframe=pd.DataFrame()
daily_20201217_addname_dataframe['cname'] = daily_20201217_tscode_list
for table_name in daily_20201217.columns.values.tolist():
    daily_20201217_addname_dataframe[table_name] = daily_20201217[table_name]
print("日线行情-时间为序  daily_20201217 返回数据 row 行数 = "+str(daily_20201217.shape[0]))
daily_20201217_addname_dataframe.to_excel(daily_202012_excel_writer,'17_4',index=False)
daily_202012_excel_writer.save()
daily_20201218 = pro.daily(start_date='',end_date='',trade_date='20201218', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20201218_tscode_list = list() 
for ts_code_sh in daily_20201218['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20201218_tscode_list.append(stock_name)
daily_20201218_addname_dataframe=pd.DataFrame()
daily_20201218_addname_dataframe['cname'] = daily_20201218_tscode_list
for table_name in daily_20201218.columns.values.tolist():
    daily_20201218_addname_dataframe[table_name] = daily_20201218[table_name]
print("日线行情-时间为序  daily_20201218 返回数据 row 行数 = "+str(daily_20201218.shape[0]))
daily_20201218_addname_dataframe.to_excel(daily_202012_excel_writer,'18_5',index=False)
daily_202012_excel_writer.save()
daily_20201221 = pro.daily(start_date='',end_date='',trade_date='20201221', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20201221_tscode_list = list() 
for ts_code_sh in daily_20201221['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20201221_tscode_list.append(stock_name)
daily_20201221_addname_dataframe=pd.DataFrame()
daily_20201221_addname_dataframe['cname'] = daily_20201221_tscode_list
for table_name in daily_20201221.columns.values.tolist():
    daily_20201221_addname_dataframe[table_name] = daily_20201221[table_name]
print("日线行情-时间为序  daily_20201221 返回数据 row 行数 = "+str(daily_20201221.shape[0]))
daily_20201221_addname_dataframe.to_excel(daily_202012_excel_writer,'21_1',index=False)
daily_202012_excel_writer.save()
daily_20201222 = pro.daily(start_date='',end_date='',trade_date='20201222', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20201222_tscode_list = list() 
for ts_code_sh in daily_20201222['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20201222_tscode_list.append(stock_name)
daily_20201222_addname_dataframe=pd.DataFrame()
daily_20201222_addname_dataframe['cname'] = daily_20201222_tscode_list
for table_name in daily_20201222.columns.values.tolist():
    daily_20201222_addname_dataframe[table_name] = daily_20201222[table_name]
print("日线行情-时间为序  daily_20201222 返回数据 row 行数 = "+str(daily_20201222.shape[0]))
daily_20201222_addname_dataframe.to_excel(daily_202012_excel_writer,'22_2',index=False)
daily_202012_excel_writer.save()
daily_20201223 = pro.daily(start_date='',end_date='',trade_date='20201223', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20201223_tscode_list = list() 
for ts_code_sh in daily_20201223['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20201223_tscode_list.append(stock_name)
daily_20201223_addname_dataframe=pd.DataFrame()
daily_20201223_addname_dataframe['cname'] = daily_20201223_tscode_list
for table_name in daily_20201223.columns.values.tolist():
    daily_20201223_addname_dataframe[table_name] = daily_20201223[table_name]
print("日线行情-时间为序  daily_20201223 返回数据 row 行数 = "+str(daily_20201223.shape[0]))
daily_20201223_addname_dataframe.to_excel(daily_202012_excel_writer,'23_3',index=False)
daily_202012_excel_writer.save()
daily_20201224 = pro.daily(start_date='',end_date='',trade_date='20201224', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20201224_tscode_list = list() 
for ts_code_sh in daily_20201224['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20201224_tscode_list.append(stock_name)
daily_20201224_addname_dataframe=pd.DataFrame()
daily_20201224_addname_dataframe['cname'] = daily_20201224_tscode_list
for table_name in daily_20201224.columns.values.tolist():
    daily_20201224_addname_dataframe[table_name] = daily_20201224[table_name]
print("日线行情-时间为序  daily_20201224 返回数据 row 行数 = "+str(daily_20201224.shape[0]))
daily_20201224_addname_dataframe.to_excel(daily_202012_excel_writer,'24_4',index=False)
daily_202012_excel_writer.save()
daily_20201225 = pro.daily(start_date='',end_date='',trade_date='20201225', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20201225_tscode_list = list() 
for ts_code_sh in daily_20201225['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20201225_tscode_list.append(stock_name)
daily_20201225_addname_dataframe=pd.DataFrame()
daily_20201225_addname_dataframe['cname'] = daily_20201225_tscode_list
for table_name in daily_20201225.columns.values.tolist():
    daily_20201225_addname_dataframe[table_name] = daily_20201225[table_name]
print("日线行情-时间为序  daily_20201225 返回数据 row 行数 = "+str(daily_20201225.shape[0]))
daily_20201225_addname_dataframe.to_excel(daily_202012_excel_writer,'25_5',index=False)
daily_202012_excel_writer.save()
daily_20201228 = pro.daily(start_date='',end_date='',trade_date='20201228', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20201228_tscode_list = list() 
for ts_code_sh in daily_20201228['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20201228_tscode_list.append(stock_name)
daily_20201228_addname_dataframe=pd.DataFrame()
daily_20201228_addname_dataframe['cname'] = daily_20201228_tscode_list
for table_name in daily_20201228.columns.values.tolist():
    daily_20201228_addname_dataframe[table_name] = daily_20201228[table_name]
print("日线行情-时间为序  daily_20201228 返回数据 row 行数 = "+str(daily_20201228.shape[0]))
daily_20201228_addname_dataframe.to_excel(daily_202012_excel_writer,'28_1',index=False)
daily_202012_excel_writer.save()
daily_20201229 = pro.daily(start_date='',end_date='',trade_date='20201229', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20201229_tscode_list = list() 
for ts_code_sh in daily_20201229['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20201229_tscode_list.append(stock_name)
daily_20201229_addname_dataframe=pd.DataFrame()
daily_20201229_addname_dataframe['cname'] = daily_20201229_tscode_list
for table_name in daily_20201229.columns.values.tolist():
    daily_20201229_addname_dataframe[table_name] = daily_20201229[table_name]
print("日线行情-时间为序  daily_20201229 返回数据 row 行数 = "+str(daily_20201229.shape[0]))
daily_20201229_addname_dataframe.to_excel(daily_202012_excel_writer,'29_2',index=False)
daily_202012_excel_writer.save()
daily_20201230 = pro.daily(start_date='',end_date='',trade_date='20201230', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20201230_tscode_list = list() 
for ts_code_sh in daily_20201230['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20201230_tscode_list.append(stock_name)
daily_20201230_addname_dataframe=pd.DataFrame()
daily_20201230_addname_dataframe['cname'] = daily_20201230_tscode_list
for table_name in daily_20201230.columns.values.tolist():
    daily_20201230_addname_dataframe[table_name] = daily_20201230[table_name]
print("日线行情-时间为序  daily_20201230 返回数据 row 行数 = "+str(daily_20201230.shape[0]))
daily_20201230_addname_dataframe.to_excel(daily_202012_excel_writer,'30_3',index=False)
daily_202012_excel_writer.save()
daily_20201231 = pro.daily(start_date='',end_date='',trade_date='20201231', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20201231_tscode_list = list() 
for ts_code_sh in daily_20201231['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20201231_tscode_list.append(stock_name)
daily_20201231_addname_dataframe=pd.DataFrame()
daily_20201231_addname_dataframe['cname'] = daily_20201231_tscode_list
for table_name in daily_20201231.columns.values.tolist():
    daily_20201231_addname_dataframe[table_name] = daily_20201231[table_name]
print("日线行情-时间为序  daily_20201231 返回数据 row 行数 = "+str(daily_20201231.shape[0]))
daily_20201231_addname_dataframe.to_excel(daily_202012_excel_writer,'31_4',index=False)
daily_202012_excel_writer.save()




createexcel('daily_202101.xlsx')
daily_202101_book = load_workbook('C:\\Users\\zhuzj5\\Desktop\\zbin\\J0_Data\\daily_202101.xlsx')
daily_202101_excel_writer = pd.ExcelWriter('C:\\Users\\zhuzj5\\Desktop\\zbin\\J0_Data\\daily_202101.xlsx', engine='openpyxl')
daily_202101_excel_writer.book = daily_202101_book
daily_202101_excel_writer.sheets = dict((ws.title, ws) for ws in daily_202101_book.worksheets)
J0_PROPS.put(tree_node_name+"record_date", "20210101")       ###  更新 记录日期
daily_20210101 = pro.daily(start_date='',end_date='',trade_date='20210101', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20210101_tscode_list = list() 
for ts_code_sh in daily_20210101['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20210101_tscode_list.append(stock_name)
daily_20210101_addname_dataframe=pd.DataFrame()
daily_20210101_addname_dataframe['cname'] = daily_20210101_tscode_list
for table_name in daily_20210101.columns.values.tolist():
    daily_20210101_addname_dataframe[table_name] = daily_20210101[table_name]
print("日线行情-时间为序  daily_20210101 返回数据 row 行数 = "+str(daily_20210101.shape[0]))
daily_20210101_addname_dataframe.to_excel(daily_202101_excel_writer,'1_5',index=False)
daily_202101_excel_writer.save()
daily_20210102 = pro.daily(start_date='',end_date='',trade_date='20210102', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20210102_tscode_list = list() 
for ts_code_sh in daily_20210102['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20210102_tscode_list.append(stock_name)
daily_20210102_addname_dataframe=pd.DataFrame()
daily_20210102_addname_dataframe['cname'] = daily_20210102_tscode_list
for table_name in daily_20210102.columns.values.tolist():
    daily_20210102_addname_dataframe[table_name] = daily_20210102[table_name]
print("日线行情-时间为序  daily_20210102 返回数据 row 行数 = "+str(daily_20210102.shape[0]))
daily_20210102_addname_dataframe.to_excel(daily_202101_excel_writer,'2_6',index=False)
daily_202101_excel_writer.save()
daily_20210103 = pro.daily(start_date='',end_date='',trade_date='20210103', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20210103_tscode_list = list() 
for ts_code_sh in daily_20210103['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20210103_tscode_list.append(stock_name)
daily_20210103_addname_dataframe=pd.DataFrame()
daily_20210103_addname_dataframe['cname'] = daily_20210103_tscode_list
for table_name in daily_20210103.columns.values.tolist():
    daily_20210103_addname_dataframe[table_name] = daily_20210103[table_name]
print("日线行情-时间为序  daily_20210103 返回数据 row 行数 = "+str(daily_20210103.shape[0]))
daily_20210103_addname_dataframe.to_excel(daily_202101_excel_writer,'3_7',index=False)
daily_202101_excel_writer.save()
daily_20210104 = pro.daily(start_date='',end_date='',trade_date='20210104', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20210104_tscode_list = list() 
for ts_code_sh in daily_20210104['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20210104_tscode_list.append(stock_name)
daily_20210104_addname_dataframe=pd.DataFrame()
daily_20210104_addname_dataframe['cname'] = daily_20210104_tscode_list
for table_name in daily_20210104.columns.values.tolist():
    daily_20210104_addname_dataframe[table_name] = daily_20210104[table_name]
print("日线行情-时间为序  daily_20210104 返回数据 row 行数 = "+str(daily_20210104.shape[0]))
daily_20210104_addname_dataframe.to_excel(daily_202101_excel_writer,'4_1',index=False)
daily_202101_excel_writer.save()
daily_20210105 = pro.daily(start_date='',end_date='',trade_date='20210105', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20210105_tscode_list = list() 
for ts_code_sh in daily_20210105['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20210105_tscode_list.append(stock_name)
daily_20210105_addname_dataframe=pd.DataFrame()
daily_20210105_addname_dataframe['cname'] = daily_20210105_tscode_list
for table_name in daily_20210105.columns.values.tolist():
    daily_20210105_addname_dataframe[table_name] = daily_20210105[table_name]
print("日线行情-时间为序  daily_20210105 返回数据 row 行数 = "+str(daily_20210105.shape[0]))
daily_20210105_addname_dataframe.to_excel(daily_202101_excel_writer,'5_2',index=False)
daily_202101_excel_writer.save()
daily_20210106 = pro.daily(start_date='',end_date='',trade_date='20210106', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20210106_tscode_list = list() 
for ts_code_sh in daily_20210106['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20210106_tscode_list.append(stock_name)
daily_20210106_addname_dataframe=pd.DataFrame()
daily_20210106_addname_dataframe['cname'] = daily_20210106_tscode_list
for table_name in daily_20210106.columns.values.tolist():
    daily_20210106_addname_dataframe[table_name] = daily_20210106[table_name]
print("日线行情-时间为序  daily_20210106 返回数据 row 行数 = "+str(daily_20210106.shape[0]))
daily_20210106_addname_dataframe.to_excel(daily_202101_excel_writer,'6_3',index=False)
daily_202101_excel_writer.save()
daily_20210107 = pro.daily(start_date='',end_date='',trade_date='20210107', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20210107_tscode_list = list() 
for ts_code_sh in daily_20210107['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20210107_tscode_list.append(stock_name)
daily_20210107_addname_dataframe=pd.DataFrame()
daily_20210107_addname_dataframe['cname'] = daily_20210107_tscode_list
for table_name in daily_20210107.columns.values.tolist():
    daily_20210107_addname_dataframe[table_name] = daily_20210107[table_name]
print("日线行情-时间为序  daily_20210107 返回数据 row 行数 = "+str(daily_20210107.shape[0]))
daily_20210107_addname_dataframe.to_excel(daily_202101_excel_writer,'7_4',index=False)
daily_202101_excel_writer.save()
daily_20210108 = pro.daily(start_date='',end_date='',trade_date='20210108', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20210108_tscode_list = list() 
for ts_code_sh in daily_20210108['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20210108_tscode_list.append(stock_name)
daily_20210108_addname_dataframe=pd.DataFrame()
daily_20210108_addname_dataframe['cname'] = daily_20210108_tscode_list
for table_name in daily_20210108.columns.values.tolist():
    daily_20210108_addname_dataframe[table_name] = daily_20210108[table_name]
print("日线行情-时间为序  daily_20210108 返回数据 row 行数 = "+str(daily_20210108.shape[0]))
daily_20210108_addname_dataframe.to_excel(daily_202101_excel_writer,'8_5',index=False)
daily_202101_excel_writer.save()
daily_20210109 = pro.daily(start_date='',end_date='',trade_date='20210109', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20210109_tscode_list = list() 
for ts_code_sh in daily_20210109['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20210109_tscode_list.append(stock_name)
daily_20210109_addname_dataframe=pd.DataFrame()
daily_20210109_addname_dataframe['cname'] = daily_20210109_tscode_list
for table_name in daily_20210109.columns.values.tolist():
    daily_20210109_addname_dataframe[table_name] = daily_20210109[table_name]
print("日线行情-时间为序  daily_20210109 返回数据 row 行数 = "+str(daily_20210109.shape[0]))
daily_20210109_addname_dataframe.to_excel(daily_202101_excel_writer,'9_6',index=False)
daily_202101_excel_writer.save()
daily_20210110 = pro.daily(start_date='',end_date='',trade_date='20210110', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20210110_tscode_list = list() 
for ts_code_sh in daily_20210110['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20210110_tscode_list.append(stock_name)
daily_20210110_addname_dataframe=pd.DataFrame()
daily_20210110_addname_dataframe['cname'] = daily_20210110_tscode_list
for table_name in daily_20210110.columns.values.tolist():
    daily_20210110_addname_dataframe[table_name] = daily_20210110[table_name]
print("日线行情-时间为序  daily_20210110 返回数据 row 行数 = "+str(daily_20210110.shape[0]))
daily_20210110_addname_dataframe.to_excel(daily_202101_excel_writer,'10_7',index=False)
daily_202101_excel_writer.save()
daily_20210111 = pro.daily(start_date='',end_date='',trade_date='20210111', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20210111_tscode_list = list() 
for ts_code_sh in daily_20210111['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20210111_tscode_list.append(stock_name)
daily_20210111_addname_dataframe=pd.DataFrame()
daily_20210111_addname_dataframe['cname'] = daily_20210111_tscode_list
for table_name in daily_20210111.columns.values.tolist():
    daily_20210111_addname_dataframe[table_name] = daily_20210111[table_name]
print("日线行情-时间为序  daily_20210111 返回数据 row 行数 = "+str(daily_20210111.shape[0]))
daily_20210111_addname_dataframe.to_excel(daily_202101_excel_writer,'11_1',index=False)
daily_202101_excel_writer.save()
daily_20210112 = pro.daily(start_date='',end_date='',trade_date='20210112', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20210112_tscode_list = list() 
for ts_code_sh in daily_20210112['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20210112_tscode_list.append(stock_name)
daily_20210112_addname_dataframe=pd.DataFrame()
daily_20210112_addname_dataframe['cname'] = daily_20210112_tscode_list
for table_name in daily_20210112.columns.values.tolist():
    daily_20210112_addname_dataframe[table_name] = daily_20210112[table_name]
print("日线行情-时间为序  daily_20210112 返回数据 row 行数 = "+str(daily_20210112.shape[0]))
daily_20210112_addname_dataframe.to_excel(daily_202101_excel_writer,'12_2',index=False)
daily_202101_excel_writer.save()
daily_20210113 = pro.daily(start_date='',end_date='',trade_date='20210113', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20210113_tscode_list = list() 
for ts_code_sh in daily_20210113['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20210113_tscode_list.append(stock_name)
daily_20210113_addname_dataframe=pd.DataFrame()
daily_20210113_addname_dataframe['cname'] = daily_20210113_tscode_list
for table_name in daily_20210113.columns.values.tolist():
    daily_20210113_addname_dataframe[table_name] = daily_20210113[table_name]
print("日线行情-时间为序  daily_20210113 返回数据 row 行数 = "+str(daily_20210113.shape[0]))
daily_20210113_addname_dataframe.to_excel(daily_202101_excel_writer,'13_3',index=False)
daily_202101_excel_writer.save()
daily_20210114 = pro.daily(start_date='',end_date='',trade_date='20210114', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20210114_tscode_list = list() 
for ts_code_sh in daily_20210114['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20210114_tscode_list.append(stock_name)
daily_20210114_addname_dataframe=pd.DataFrame()
daily_20210114_addname_dataframe['cname'] = daily_20210114_tscode_list
for table_name in daily_20210114.columns.values.tolist():
    daily_20210114_addname_dataframe[table_name] = daily_20210114[table_name]
print("日线行情-时间为序  daily_20210114 返回数据 row 行数 = "+str(daily_20210114.shape[0]))
daily_20210114_addname_dataframe.to_excel(daily_202101_excel_writer,'14_4',index=False)
daily_202101_excel_writer.save()
daily_20210115 = pro.daily(start_date='',end_date='',trade_date='20210115', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20210115_tscode_list = list() 
for ts_code_sh in daily_20210115['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20210115_tscode_list.append(stock_name)
daily_20210115_addname_dataframe=pd.DataFrame()
daily_20210115_addname_dataframe['cname'] = daily_20210115_tscode_list
for table_name in daily_20210115.columns.values.tolist():
    daily_20210115_addname_dataframe[table_name] = daily_20210115[table_name]
print("日线行情-时间为序  daily_20210115 返回数据 row 行数 = "+str(daily_20210115.shape[0]))
daily_20210115_addname_dataframe.to_excel(daily_202101_excel_writer,'15_5',index=False)
daily_202101_excel_writer.save()
daily_20210116 = pro.daily(start_date='',end_date='',trade_date='20210116', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20210116_tscode_list = list() 
for ts_code_sh in daily_20210116['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20210116_tscode_list.append(stock_name)
daily_20210116_addname_dataframe=pd.DataFrame()
daily_20210116_addname_dataframe['cname'] = daily_20210116_tscode_list
for table_name in daily_20210116.columns.values.tolist():
    daily_20210116_addname_dataframe[table_name] = daily_20210116[table_name]
print("日线行情-时间为序  daily_20210116 返回数据 row 行数 = "+str(daily_20210116.shape[0]))
daily_20210116_addname_dataframe.to_excel(daily_202101_excel_writer,'16_6',index=False)
daily_202101_excel_writer.save()
daily_20210117 = pro.daily(start_date='',end_date='',trade_date='20210117', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20210117_tscode_list = list() 
for ts_code_sh in daily_20210117['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20210117_tscode_list.append(stock_name)
daily_20210117_addname_dataframe=pd.DataFrame()
daily_20210117_addname_dataframe['cname'] = daily_20210117_tscode_list
for table_name in daily_20210117.columns.values.tolist():
    daily_20210117_addname_dataframe[table_name] = daily_20210117[table_name]
print("日线行情-时间为序  daily_20210117 返回数据 row 行数 = "+str(daily_20210117.shape[0]))
daily_20210117_addname_dataframe.to_excel(daily_202101_excel_writer,'17_7',index=False)
daily_202101_excel_writer.save()
daily_20210118 = pro.daily(start_date='',end_date='',trade_date='20210118', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20210118_tscode_list = list() 
for ts_code_sh in daily_20210118['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20210118_tscode_list.append(stock_name)
daily_20210118_addname_dataframe=pd.DataFrame()
daily_20210118_addname_dataframe['cname'] = daily_20210118_tscode_list
for table_name in daily_20210118.columns.values.tolist():
    daily_20210118_addname_dataframe[table_name] = daily_20210118[table_name]
print("日线行情-时间为序  daily_20210118 返回数据 row 行数 = "+str(daily_20210118.shape[0]))
daily_20210118_addname_dataframe.to_excel(daily_202101_excel_writer,'18_1',index=False)
daily_202101_excel_writer.save()
daily_20210119 = pro.daily(start_date='',end_date='',trade_date='20210119', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20210119_tscode_list = list() 
for ts_code_sh in daily_20210119['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20210119_tscode_list.append(stock_name)
daily_20210119_addname_dataframe=pd.DataFrame()
daily_20210119_addname_dataframe['cname'] = daily_20210119_tscode_list
for table_name in daily_20210119.columns.values.tolist():
    daily_20210119_addname_dataframe[table_name] = daily_20210119[table_name]
print("日线行情-时间为序  daily_20210119 返回数据 row 行数 = "+str(daily_20210119.shape[0]))
daily_20210119_addname_dataframe.to_excel(daily_202101_excel_writer,'19_2',index=False)
daily_202101_excel_writer.save()
daily_20210120 = pro.daily(start_date='',end_date='',trade_date='20210120', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20210120_tscode_list = list() 
for ts_code_sh in daily_20210120['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20210120_tscode_list.append(stock_name)
daily_20210120_addname_dataframe=pd.DataFrame()
daily_20210120_addname_dataframe['cname'] = daily_20210120_tscode_list
for table_name in daily_20210120.columns.values.tolist():
    daily_20210120_addname_dataframe[table_name] = daily_20210120[table_name]
print("日线行情-时间为序  daily_20210120 返回数据 row 行数 = "+str(daily_20210120.shape[0]))
daily_20210120_addname_dataframe.to_excel(daily_202101_excel_writer,'20_3',index=False)
daily_202101_excel_writer.save()
daily_20210121 = pro.daily(start_date='',end_date='',trade_date='20210121', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20210121_tscode_list = list() 
for ts_code_sh in daily_20210121['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20210121_tscode_list.append(stock_name)
daily_20210121_addname_dataframe=pd.DataFrame()
daily_20210121_addname_dataframe['cname'] = daily_20210121_tscode_list
for table_name in daily_20210121.columns.values.tolist():
    daily_20210121_addname_dataframe[table_name] = daily_20210121[table_name]
print("日线行情-时间为序  daily_20210121 返回数据 row 行数 = "+str(daily_20210121.shape[0]))
daily_20210121_addname_dataframe.to_excel(daily_202101_excel_writer,'21_4',index=False)
daily_202101_excel_writer.save()
daily_20210122 = pro.daily(start_date='',end_date='',trade_date='20210122', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20210122_tscode_list = list() 
for ts_code_sh in daily_20210122['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20210122_tscode_list.append(stock_name)
daily_20210122_addname_dataframe=pd.DataFrame()
daily_20210122_addname_dataframe['cname'] = daily_20210122_tscode_list
for table_name in daily_20210122.columns.values.tolist():
    daily_20210122_addname_dataframe[table_name] = daily_20210122[table_name]
print("日线行情-时间为序  daily_20210122 返回数据 row 行数 = "+str(daily_20210122.shape[0]))
daily_20210122_addname_dataframe.to_excel(daily_202101_excel_writer,'22_5',index=False)
daily_202101_excel_writer.save()
daily_20210123 = pro.daily(start_date='',end_date='',trade_date='20210123', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20210123_tscode_list = list() 
for ts_code_sh in daily_20210123['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20210123_tscode_list.append(stock_name)
daily_20210123_addname_dataframe=pd.DataFrame()
daily_20210123_addname_dataframe['cname'] = daily_20210123_tscode_list
for table_name in daily_20210123.columns.values.tolist():
    daily_20210123_addname_dataframe[table_name] = daily_20210123[table_name]
print("日线行情-时间为序  daily_20210123 返回数据 row 行数 = "+str(daily_20210123.shape[0]))
daily_20210123_addname_dataframe.to_excel(daily_202101_excel_writer,'23_6',index=False)
daily_202101_excel_writer.save()
daily_20210124 = pro.daily(start_date='',end_date='',trade_date='20210124', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20210124_tscode_list = list() 
for ts_code_sh in daily_20210124['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20210124_tscode_list.append(stock_name)
daily_20210124_addname_dataframe=pd.DataFrame()
daily_20210124_addname_dataframe['cname'] = daily_20210124_tscode_list
for table_name in daily_20210124.columns.values.tolist():
    daily_20210124_addname_dataframe[table_name] = daily_20210124[table_name]
print("日线行情-时间为序  daily_20210124 返回数据 row 行数 = "+str(daily_20210124.shape[0]))
daily_20210124_addname_dataframe.to_excel(daily_202101_excel_writer,'24_7',index=False)
daily_202101_excel_writer.save()
daily_20210125 = pro.daily(start_date='',end_date='',trade_date='20210125', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20210125_tscode_list = list() 
for ts_code_sh in daily_20210125['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20210125_tscode_list.append(stock_name)
daily_20210125_addname_dataframe=pd.DataFrame()
daily_20210125_addname_dataframe['cname'] = daily_20210125_tscode_list
for table_name in daily_20210125.columns.values.tolist():
    daily_20210125_addname_dataframe[table_name] = daily_20210125[table_name]
print("日线行情-时间为序  daily_20210125 返回数据 row 行数 = "+str(daily_20210125.shape[0]))
daily_20210125_addname_dataframe.to_excel(daily_202101_excel_writer,'25_1',index=False)
daily_202101_excel_writer.save()
daily_20210126 = pro.daily(start_date='',end_date='',trade_date='20210126', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20210126_tscode_list = list() 
for ts_code_sh in daily_20210126['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20210126_tscode_list.append(stock_name)
daily_20210126_addname_dataframe=pd.DataFrame()
daily_20210126_addname_dataframe['cname'] = daily_20210126_tscode_list
for table_name in daily_20210126.columns.values.tolist():
    daily_20210126_addname_dataframe[table_name] = daily_20210126[table_name]
print("日线行情-时间为序  daily_20210126 返回数据 row 行数 = "+str(daily_20210126.shape[0]))
daily_20210126_addname_dataframe.to_excel(daily_202101_excel_writer,'26_2',index=False)
daily_202101_excel_writer.save()
daily_20210127 = pro.daily(start_date='',end_date='',trade_date='20210127', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20210127_tscode_list = list() 
for ts_code_sh in daily_20210127['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20210127_tscode_list.append(stock_name)
daily_20210127_addname_dataframe=pd.DataFrame()
daily_20210127_addname_dataframe['cname'] = daily_20210127_tscode_list
for table_name in daily_20210127.columns.values.tolist():
    daily_20210127_addname_dataframe[table_name] = daily_20210127[table_name]
print("日线行情-时间为序  daily_20210127 返回数据 row 行数 = "+str(daily_20210127.shape[0]))
daily_20210127_addname_dataframe.to_excel(daily_202101_excel_writer,'27_3',index=False)
daily_202101_excel_writer.save()
daily_20210128 = pro.daily(start_date='',end_date='',trade_date='20210128', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20210128_tscode_list = list() 
for ts_code_sh in daily_20210128['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20210128_tscode_list.append(stock_name)
daily_20210128_addname_dataframe=pd.DataFrame()
daily_20210128_addname_dataframe['cname'] = daily_20210128_tscode_list
for table_name in daily_20210128.columns.values.tolist():
    daily_20210128_addname_dataframe[table_name] = daily_20210128[table_name]
print("日线行情-时间为序  daily_20210128 返回数据 row 行数 = "+str(daily_20210128.shape[0]))
daily_20210128_addname_dataframe.to_excel(daily_202101_excel_writer,'28_4',index=False)
daily_202101_excel_writer.save()
daily_20210129 = pro.daily(start_date='',end_date='',trade_date='20210129', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20210129_tscode_list = list() 
for ts_code_sh in daily_20210129['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20210129_tscode_list.append(stock_name)
daily_20210129_addname_dataframe=pd.DataFrame()
daily_20210129_addname_dataframe['cname'] = daily_20210129_tscode_list
for table_name in daily_20210129.columns.values.tolist():
    daily_20210129_addname_dataframe[table_name] = daily_20210129[table_name]
print("日线行情-时间为序  daily_20210129 返回数据 row 行数 = "+str(daily_20210129.shape[0]))
daily_20210129_addname_dataframe.to_excel(daily_202101_excel_writer,'29_5',index=False)
daily_202101_excel_writer.save()
daily_20210130 = pro.daily(start_date='',end_date='',trade_date='20210130', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20210130_tscode_list = list() 
for ts_code_sh in daily_20210130['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20210130_tscode_list.append(stock_name)
daily_20210130_addname_dataframe=pd.DataFrame()
daily_20210130_addname_dataframe['cname'] = daily_20210130_tscode_list
for table_name in daily_20210130.columns.values.tolist():
    daily_20210130_addname_dataframe[table_name] = daily_20210130[table_name]
print("日线行情-时间为序  daily_20210130 返回数据 row 行数 = "+str(daily_20210130.shape[0]))
daily_20210130_addname_dataframe.to_excel(daily_202101_excel_writer,'30_6',index=False)
daily_202101_excel_writer.save()
daily_20210131 = pro.daily(start_date='',end_date='',trade_date='20210131', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20210131_tscode_list = list() 
for ts_code_sh in daily_20210131['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20210131_tscode_list.append(stock_name)
daily_20210131_addname_dataframe=pd.DataFrame()
daily_20210131_addname_dataframe['cname'] = daily_20210131_tscode_list
for table_name in daily_20210131.columns.values.tolist():
    daily_20210131_addname_dataframe[table_name] = daily_20210131[table_name]
print("日线行情-时间为序  daily_20210131 返回数据 row 行数 = "+str(daily_20210131.shape[0]))
daily_20210131_addname_dataframe.to_excel(daily_202101_excel_writer,'31_7',index=False)
daily_202101_excel_writer.save()




createexcel('daily_202102.xlsx')
daily_202102_book = load_workbook('C:\\Users\\zhuzj5\\Desktop\\zbin\\J0_Data\\daily_202102.xlsx')
daily_202102_excel_writer = pd.ExcelWriter('C:\\Users\\zhuzj5\\Desktop\\zbin\\J0_Data\\daily_202102.xlsx', engine='openpyxl')
daily_202102_excel_writer.book = daily_202102_book
daily_202102_excel_writer.sheets = dict((ws.title, ws) for ws in daily_202102_book.worksheets)
J0_PROPS.put(tree_node_name+"record_date", "20210201")       ###  更新 记录日期
daily_20210201 = pro.daily(start_date='',end_date='',trade_date='20210201', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20210201_tscode_list = list() 
for ts_code_sh in daily_20210201['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20210201_tscode_list.append(stock_name)
daily_20210201_addname_dataframe=pd.DataFrame()
daily_20210201_addname_dataframe['cname'] = daily_20210201_tscode_list
for table_name in daily_20210201.columns.values.tolist():
    daily_20210201_addname_dataframe[table_name] = daily_20210201[table_name]
print("日线行情-时间为序  daily_20210201 返回数据 row 行数 = "+str(daily_20210201.shape[0]))
daily_20210201_addname_dataframe.to_excel(daily_202102_excel_writer,'1_1',index=False)
daily_202102_excel_writer.save()
daily_20210202 = pro.daily(start_date='',end_date='',trade_date='20210202', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20210202_tscode_list = list() 
for ts_code_sh in daily_20210202['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20210202_tscode_list.append(stock_name)
daily_20210202_addname_dataframe=pd.DataFrame()
daily_20210202_addname_dataframe['cname'] = daily_20210202_tscode_list
for table_name in daily_20210202.columns.values.tolist():
    daily_20210202_addname_dataframe[table_name] = daily_20210202[table_name]
print("日线行情-时间为序  daily_20210202 返回数据 row 行数 = "+str(daily_20210202.shape[0]))
daily_20210202_addname_dataframe.to_excel(daily_202102_excel_writer,'2_2',index=False)
daily_202102_excel_writer.save()
daily_20210203 = pro.daily(start_date='',end_date='',trade_date='20210203', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20210203_tscode_list = list() 
for ts_code_sh in daily_20210203['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20210203_tscode_list.append(stock_name)
daily_20210203_addname_dataframe=pd.DataFrame()
daily_20210203_addname_dataframe['cname'] = daily_20210203_tscode_list
for table_name in daily_20210203.columns.values.tolist():
    daily_20210203_addname_dataframe[table_name] = daily_20210203[table_name]
print("日线行情-时间为序  daily_20210203 返回数据 row 行数 = "+str(daily_20210203.shape[0]))
daily_20210203_addname_dataframe.to_excel(daily_202102_excel_writer,'3_3',index=False)
daily_202102_excel_writer.save()
daily_20210204 = pro.daily(start_date='',end_date='',trade_date='20210204', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20210204_tscode_list = list() 
for ts_code_sh in daily_20210204['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20210204_tscode_list.append(stock_name)
daily_20210204_addname_dataframe=pd.DataFrame()
daily_20210204_addname_dataframe['cname'] = daily_20210204_tscode_list
for table_name in daily_20210204.columns.values.tolist():
    daily_20210204_addname_dataframe[table_name] = daily_20210204[table_name]
print("日线行情-时间为序  daily_20210204 返回数据 row 行数 = "+str(daily_20210204.shape[0]))
daily_20210204_addname_dataframe.to_excel(daily_202102_excel_writer,'4_4',index=False)
daily_202102_excel_writer.save()
daily_20210205 = pro.daily(start_date='',end_date='',trade_date='20210205', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20210205_tscode_list = list() 
for ts_code_sh in daily_20210205['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20210205_tscode_list.append(stock_name)
daily_20210205_addname_dataframe=pd.DataFrame()
daily_20210205_addname_dataframe['cname'] = daily_20210205_tscode_list
for table_name in daily_20210205.columns.values.tolist():
    daily_20210205_addname_dataframe[table_name] = daily_20210205[table_name]
print("日线行情-时间为序  daily_20210205 返回数据 row 行数 = "+str(daily_20210205.shape[0]))
daily_20210205_addname_dataframe.to_excel(daily_202102_excel_writer,'5_5',index=False)
daily_202102_excel_writer.save()
daily_20210206 = pro.daily(start_date='',end_date='',trade_date='20210206', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20210206_tscode_list = list() 
for ts_code_sh in daily_20210206['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20210206_tscode_list.append(stock_name)
daily_20210206_addname_dataframe=pd.DataFrame()
daily_20210206_addname_dataframe['cname'] = daily_20210206_tscode_list
for table_name in daily_20210206.columns.values.tolist():
    daily_20210206_addname_dataframe[table_name] = daily_20210206[table_name]
print("日线行情-时间为序  daily_20210206 返回数据 row 行数 = "+str(daily_20210206.shape[0]))
daily_20210206_addname_dataframe.to_excel(daily_202102_excel_writer,'6_6',index=False)
daily_202102_excel_writer.save()
daily_20210207 = pro.daily(start_date='',end_date='',trade_date='20210207', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20210207_tscode_list = list() 
for ts_code_sh in daily_20210207['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20210207_tscode_list.append(stock_name)
daily_20210207_addname_dataframe=pd.DataFrame()
daily_20210207_addname_dataframe['cname'] = daily_20210207_tscode_list
for table_name in daily_20210207.columns.values.tolist():
    daily_20210207_addname_dataframe[table_name] = daily_20210207[table_name]
print("日线行情-时间为序  daily_20210207 返回数据 row 行数 = "+str(daily_20210207.shape[0]))
daily_20210207_addname_dataframe.to_excel(daily_202102_excel_writer,'7_7',index=False)
daily_202102_excel_writer.save()
daily_20210208 = pro.daily(start_date='',end_date='',trade_date='20210208', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20210208_tscode_list = list() 
for ts_code_sh in daily_20210208['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20210208_tscode_list.append(stock_name)
daily_20210208_addname_dataframe=pd.DataFrame()
daily_20210208_addname_dataframe['cname'] = daily_20210208_tscode_list
for table_name in daily_20210208.columns.values.tolist():
    daily_20210208_addname_dataframe[table_name] = daily_20210208[table_name]
print("日线行情-时间为序  daily_20210208 返回数据 row 行数 = "+str(daily_20210208.shape[0]))
daily_20210208_addname_dataframe.to_excel(daily_202102_excel_writer,'8_1',index=False)
daily_202102_excel_writer.save()
daily_20210209 = pro.daily(start_date='',end_date='',trade_date='20210209', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20210209_tscode_list = list() 
for ts_code_sh in daily_20210209['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20210209_tscode_list.append(stock_name)
daily_20210209_addname_dataframe=pd.DataFrame()
daily_20210209_addname_dataframe['cname'] = daily_20210209_tscode_list
for table_name in daily_20210209.columns.values.tolist():
    daily_20210209_addname_dataframe[table_name] = daily_20210209[table_name]
print("日线行情-时间为序  daily_20210209 返回数据 row 行数 = "+str(daily_20210209.shape[0]))
daily_20210209_addname_dataframe.to_excel(daily_202102_excel_writer,'9_2',index=False)
daily_202102_excel_writer.save()
daily_20210210 = pro.daily(start_date='',end_date='',trade_date='20210210', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20210210_tscode_list = list() 
for ts_code_sh in daily_20210210['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20210210_tscode_list.append(stock_name)
daily_20210210_addname_dataframe=pd.DataFrame()
daily_20210210_addname_dataframe['cname'] = daily_20210210_tscode_list
for table_name in daily_20210210.columns.values.tolist():
    daily_20210210_addname_dataframe[table_name] = daily_20210210[table_name]
print("日线行情-时间为序  daily_20210210 返回数据 row 行数 = "+str(daily_20210210.shape[0]))
daily_20210210_addname_dataframe.to_excel(daily_202102_excel_writer,'10_3',index=False)
daily_202102_excel_writer.save()
daily_20210211 = pro.daily(start_date='',end_date='',trade_date='20210211', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20210211_tscode_list = list() 
for ts_code_sh in daily_20210211['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20210211_tscode_list.append(stock_name)
daily_20210211_addname_dataframe=pd.DataFrame()
daily_20210211_addname_dataframe['cname'] = daily_20210211_tscode_list
for table_name in daily_20210211.columns.values.tolist():
    daily_20210211_addname_dataframe[table_name] = daily_20210211[table_name]
print("日线行情-时间为序  daily_20210211 返回数据 row 行数 = "+str(daily_20210211.shape[0]))
daily_20210211_addname_dataframe.to_excel(daily_202102_excel_writer,'11_4',index=False)
daily_202102_excel_writer.save()
daily_20210212 = pro.daily(start_date='',end_date='',trade_date='20210212', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20210212_tscode_list = list() 
for ts_code_sh in daily_20210212['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20210212_tscode_list.append(stock_name)
daily_20210212_addname_dataframe=pd.DataFrame()
daily_20210212_addname_dataframe['cname'] = daily_20210212_tscode_list
for table_name in daily_20210212.columns.values.tolist():
    daily_20210212_addname_dataframe[table_name] = daily_20210212[table_name]
print("日线行情-时间为序  daily_20210212 返回数据 row 行数 = "+str(daily_20210212.shape[0]))
daily_20210212_addname_dataframe.to_excel(daily_202102_excel_writer,'12_5',index=False)
daily_202102_excel_writer.save()
daily_20210213 = pro.daily(start_date='',end_date='',trade_date='20210213', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20210213_tscode_list = list() 
for ts_code_sh in daily_20210213['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20210213_tscode_list.append(stock_name)
daily_20210213_addname_dataframe=pd.DataFrame()
daily_20210213_addname_dataframe['cname'] = daily_20210213_tscode_list
for table_name in daily_20210213.columns.values.tolist():
    daily_20210213_addname_dataframe[table_name] = daily_20210213[table_name]
print("日线行情-时间为序  daily_20210213 返回数据 row 行数 = "+str(daily_20210213.shape[0]))
daily_20210213_addname_dataframe.to_excel(daily_202102_excel_writer,'13_6',index=False)
daily_202102_excel_writer.save()
daily_20210214 = pro.daily(start_date='',end_date='',trade_date='20210214', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20210214_tscode_list = list() 
for ts_code_sh in daily_20210214['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20210214_tscode_list.append(stock_name)
daily_20210214_addname_dataframe=pd.DataFrame()
daily_20210214_addname_dataframe['cname'] = daily_20210214_tscode_list
for table_name in daily_20210214.columns.values.tolist():
    daily_20210214_addname_dataframe[table_name] = daily_20210214[table_name]
print("日线行情-时间为序  daily_20210214 返回数据 row 行数 = "+str(daily_20210214.shape[0]))
daily_20210214_addname_dataframe.to_excel(daily_202102_excel_writer,'14_7',index=False)
daily_202102_excel_writer.save()
daily_20210215 = pro.daily(start_date='',end_date='',trade_date='20210215', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20210215_tscode_list = list() 
for ts_code_sh in daily_20210215['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20210215_tscode_list.append(stock_name)
daily_20210215_addname_dataframe=pd.DataFrame()
daily_20210215_addname_dataframe['cname'] = daily_20210215_tscode_list
for table_name in daily_20210215.columns.values.tolist():
    daily_20210215_addname_dataframe[table_name] = daily_20210215[table_name]
print("日线行情-时间为序  daily_20210215 返回数据 row 行数 = "+str(daily_20210215.shape[0]))
daily_20210215_addname_dataframe.to_excel(daily_202102_excel_writer,'15_1',index=False)
daily_202102_excel_writer.save()
daily_20210216 = pro.daily(start_date='',end_date='',trade_date='20210216', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20210216_tscode_list = list() 
for ts_code_sh in daily_20210216['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20210216_tscode_list.append(stock_name)
daily_20210216_addname_dataframe=pd.DataFrame()
daily_20210216_addname_dataframe['cname'] = daily_20210216_tscode_list
for table_name in daily_20210216.columns.values.tolist():
    daily_20210216_addname_dataframe[table_name] = daily_20210216[table_name]
print("日线行情-时间为序  daily_20210216 返回数据 row 行数 = "+str(daily_20210216.shape[0]))
daily_20210216_addname_dataframe.to_excel(daily_202102_excel_writer,'16_2',index=False)
daily_202102_excel_writer.save()
daily_20210217 = pro.daily(start_date='',end_date='',trade_date='20210217', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20210217_tscode_list = list() 
for ts_code_sh in daily_20210217['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20210217_tscode_list.append(stock_name)
daily_20210217_addname_dataframe=pd.DataFrame()
daily_20210217_addname_dataframe['cname'] = daily_20210217_tscode_list
for table_name in daily_20210217.columns.values.tolist():
    daily_20210217_addname_dataframe[table_name] = daily_20210217[table_name]
print("日线行情-时间为序  daily_20210217 返回数据 row 行数 = "+str(daily_20210217.shape[0]))
daily_20210217_addname_dataframe.to_excel(daily_202102_excel_writer,'17_3',index=False)
daily_202102_excel_writer.save()
daily_20210218 = pro.daily(start_date='',end_date='',trade_date='20210218', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20210218_tscode_list = list() 
for ts_code_sh in daily_20210218['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20210218_tscode_list.append(stock_name)
daily_20210218_addname_dataframe=pd.DataFrame()
daily_20210218_addname_dataframe['cname'] = daily_20210218_tscode_list
for table_name in daily_20210218.columns.values.tolist():
    daily_20210218_addname_dataframe[table_name] = daily_20210218[table_name]
print("日线行情-时间为序  daily_20210218 返回数据 row 行数 = "+str(daily_20210218.shape[0]))
daily_20210218_addname_dataframe.to_excel(daily_202102_excel_writer,'18_4',index=False)
daily_202102_excel_writer.save()
daily_20210219 = pro.daily(start_date='',end_date='',trade_date='20210219', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20210219_tscode_list = list() 
for ts_code_sh in daily_20210219['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20210219_tscode_list.append(stock_name)
daily_20210219_addname_dataframe=pd.DataFrame()
daily_20210219_addname_dataframe['cname'] = daily_20210219_tscode_list
for table_name in daily_20210219.columns.values.tolist():
    daily_20210219_addname_dataframe[table_name] = daily_20210219[table_name]
print("日线行情-时间为序  daily_20210219 返回数据 row 行数 = "+str(daily_20210219.shape[0]))
daily_20210219_addname_dataframe.to_excel(daily_202102_excel_writer,'19_5',index=False)
daily_202102_excel_writer.save()
daily_20210220 = pro.daily(start_date='',end_date='',trade_date='20210220', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20210220_tscode_list = list() 
for ts_code_sh in daily_20210220['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20210220_tscode_list.append(stock_name)
daily_20210220_addname_dataframe=pd.DataFrame()
daily_20210220_addname_dataframe['cname'] = daily_20210220_tscode_list
for table_name in daily_20210220.columns.values.tolist():
    daily_20210220_addname_dataframe[table_name] = daily_20210220[table_name]
print("日线行情-时间为序  daily_20210220 返回数据 row 行数 = "+str(daily_20210220.shape[0]))
daily_20210220_addname_dataframe.to_excel(daily_202102_excel_writer,'20_6',index=False)
daily_202102_excel_writer.save()
daily_20210221 = pro.daily(start_date='',end_date='',trade_date='20210221', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20210221_tscode_list = list() 
for ts_code_sh in daily_20210221['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20210221_tscode_list.append(stock_name)
daily_20210221_addname_dataframe=pd.DataFrame()
daily_20210221_addname_dataframe['cname'] = daily_20210221_tscode_list
for table_name in daily_20210221.columns.values.tolist():
    daily_20210221_addname_dataframe[table_name] = daily_20210221[table_name]
print("日线行情-时间为序  daily_20210221 返回数据 row 行数 = "+str(daily_20210221.shape[0]))
daily_20210221_addname_dataframe.to_excel(daily_202102_excel_writer,'21_7',index=False)
daily_202102_excel_writer.save()
daily_20210222 = pro.daily(start_date='',end_date='',trade_date='20210222', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20210222_tscode_list = list() 
for ts_code_sh in daily_20210222['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20210222_tscode_list.append(stock_name)
daily_20210222_addname_dataframe=pd.DataFrame()
daily_20210222_addname_dataframe['cname'] = daily_20210222_tscode_list
for table_name in daily_20210222.columns.values.tolist():
    daily_20210222_addname_dataframe[table_name] = daily_20210222[table_name]
print("日线行情-时间为序  daily_20210222 返回数据 row 行数 = "+str(daily_20210222.shape[0]))
daily_20210222_addname_dataframe.to_excel(daily_202102_excel_writer,'22_1',index=False)
daily_202102_excel_writer.save()
daily_20210223 = pro.daily(start_date='',end_date='',trade_date='20210223', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20210223_tscode_list = list() 
for ts_code_sh in daily_20210223['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20210223_tscode_list.append(stock_name)
daily_20210223_addname_dataframe=pd.DataFrame()
daily_20210223_addname_dataframe['cname'] = daily_20210223_tscode_list
for table_name in daily_20210223.columns.values.tolist():
    daily_20210223_addname_dataframe[table_name] = daily_20210223[table_name]
print("日线行情-时间为序  daily_20210223 返回数据 row 行数 = "+str(daily_20210223.shape[0]))
daily_20210223_addname_dataframe.to_excel(daily_202102_excel_writer,'23_2',index=False)
daily_202102_excel_writer.save()
daily_20210224 = pro.daily(start_date='',end_date='',trade_date='20210224', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20210224_tscode_list = list() 
for ts_code_sh in daily_20210224['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20210224_tscode_list.append(stock_name)
daily_20210224_addname_dataframe=pd.DataFrame()
daily_20210224_addname_dataframe['cname'] = daily_20210224_tscode_list
for table_name in daily_20210224.columns.values.tolist():
    daily_20210224_addname_dataframe[table_name] = daily_20210224[table_name]
print("日线行情-时间为序  daily_20210224 返回数据 row 行数 = "+str(daily_20210224.shape[0]))
daily_20210224_addname_dataframe.to_excel(daily_202102_excel_writer,'24_3',index=False)
daily_202102_excel_writer.save()
daily_20210225 = pro.daily(start_date='',end_date='',trade_date='20210225', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20210225_tscode_list = list() 
for ts_code_sh in daily_20210225['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20210225_tscode_list.append(stock_name)
daily_20210225_addname_dataframe=pd.DataFrame()
daily_20210225_addname_dataframe['cname'] = daily_20210225_tscode_list
for table_name in daily_20210225.columns.values.tolist():
    daily_20210225_addname_dataframe[table_name] = daily_20210225[table_name]
print("日线行情-时间为序  daily_20210225 返回数据 row 行数 = "+str(daily_20210225.shape[0]))
daily_20210225_addname_dataframe.to_excel(daily_202102_excel_writer,'25_4',index=False)
daily_202102_excel_writer.save()
daily_20210226 = pro.daily(start_date='',end_date='',trade_date='20210226', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20210226_tscode_list = list() 
for ts_code_sh in daily_20210226['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20210226_tscode_list.append(stock_name)
daily_20210226_addname_dataframe=pd.DataFrame()
daily_20210226_addname_dataframe['cname'] = daily_20210226_tscode_list
for table_name in daily_20210226.columns.values.tolist():
    daily_20210226_addname_dataframe[table_name] = daily_20210226[table_name]
print("日线行情-时间为序  daily_20210226 返回数据 row 行数 = "+str(daily_20210226.shape[0]))
daily_20210226_addname_dataframe.to_excel(daily_202102_excel_writer,'26_5',index=False)
daily_202102_excel_writer.save()
daily_20210227 = pro.daily(start_date='',end_date='',trade_date='20210227', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20210227_tscode_list = list() 
for ts_code_sh in daily_20210227['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20210227_tscode_list.append(stock_name)
daily_20210227_addname_dataframe=pd.DataFrame()
daily_20210227_addname_dataframe['cname'] = daily_20210227_tscode_list
for table_name in daily_20210227.columns.values.tolist():
    daily_20210227_addname_dataframe[table_name] = daily_20210227[table_name]
print("日线行情-时间为序  daily_20210227 返回数据 row 行数 = "+str(daily_20210227.shape[0]))
daily_20210227_addname_dataframe.to_excel(daily_202102_excel_writer,'27_6',index=False)
daily_202102_excel_writer.save()
daily_20210228 = pro.daily(start_date='',end_date='',trade_date='20210228', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20210228_tscode_list = list() 
for ts_code_sh in daily_20210228['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20210228_tscode_list.append(stock_name)
daily_20210228_addname_dataframe=pd.DataFrame()
daily_20210228_addname_dataframe['cname'] = daily_20210228_tscode_list
for table_name in daily_20210228.columns.values.tolist():
    daily_20210228_addname_dataframe[table_name] = daily_20210228[table_name]
print("日线行情-时间为序  daily_20210228 返回数据 row 行数 = "+str(daily_20210228.shape[0]))
daily_20210228_addname_dataframe.to_excel(daily_202102_excel_writer,'28_7',index=False)
daily_202102_excel_writer.save()




createexcel('daily_202103.xlsx')
daily_202103_book = load_workbook('C:\\Users\\zhuzj5\\Desktop\\zbin\\J0_Data\\daily_202103.xlsx')
daily_202103_excel_writer = pd.ExcelWriter('C:\\Users\\zhuzj5\\Desktop\\zbin\\J0_Data\\daily_202103.xlsx', engine='openpyxl')
daily_202103_excel_writer.book = daily_202103_book
daily_202103_excel_writer.sheets = dict((ws.title, ws) for ws in daily_202103_book.worksheets)
J0_PROPS.put(tree_node_name+"record_date", "20210301")       ###  更新 记录日期
daily_20210301 = pro.daily(start_date='',end_date='',trade_date='20210301', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20210301_tscode_list = list() 
for ts_code_sh in daily_20210301['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20210301_tscode_list.append(stock_name)
daily_20210301_addname_dataframe=pd.DataFrame()
daily_20210301_addname_dataframe['cname'] = daily_20210301_tscode_list
for table_name in daily_20210301.columns.values.tolist():
    daily_20210301_addname_dataframe[table_name] = daily_20210301[table_name]
print("日线行情-时间为序  daily_20210301 返回数据 row 行数 = "+str(daily_20210301.shape[0]))
daily_20210301_addname_dataframe.to_excel(daily_202103_excel_writer,'1_1',index=False)
daily_202103_excel_writer.save()
daily_20210302 = pro.daily(start_date='',end_date='',trade_date='20210302', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20210302_tscode_list = list() 
for ts_code_sh in daily_20210302['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20210302_tscode_list.append(stock_name)
daily_20210302_addname_dataframe=pd.DataFrame()
daily_20210302_addname_dataframe['cname'] = daily_20210302_tscode_list
for table_name in daily_20210302.columns.values.tolist():
    daily_20210302_addname_dataframe[table_name] = daily_20210302[table_name]
print("日线行情-时间为序  daily_20210302 返回数据 row 行数 = "+str(daily_20210302.shape[0]))
daily_20210302_addname_dataframe.to_excel(daily_202103_excel_writer,'2_2',index=False)
daily_202103_excel_writer.save()
daily_20210303 = pro.daily(start_date='',end_date='',trade_date='20210303', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20210303_tscode_list = list() 
for ts_code_sh in daily_20210303['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20210303_tscode_list.append(stock_name)
daily_20210303_addname_dataframe=pd.DataFrame()
daily_20210303_addname_dataframe['cname'] = daily_20210303_tscode_list
for table_name in daily_20210303.columns.values.tolist():
    daily_20210303_addname_dataframe[table_name] = daily_20210303[table_name]
print("日线行情-时间为序  daily_20210303 返回数据 row 行数 = "+str(daily_20210303.shape[0]))
daily_20210303_addname_dataframe.to_excel(daily_202103_excel_writer,'3_3',index=False)
daily_202103_excel_writer.save()
daily_20210304 = pro.daily(start_date='',end_date='',trade_date='20210304', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20210304_tscode_list = list() 
for ts_code_sh in daily_20210304['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20210304_tscode_list.append(stock_name)
daily_20210304_addname_dataframe=pd.DataFrame()
daily_20210304_addname_dataframe['cname'] = daily_20210304_tscode_list
for table_name in daily_20210304.columns.values.tolist():
    daily_20210304_addname_dataframe[table_name] = daily_20210304[table_name]
print("日线行情-时间为序  daily_20210304 返回数据 row 行数 = "+str(daily_20210304.shape[0]))
daily_20210304_addname_dataframe.to_excel(daily_202103_excel_writer,'4_4',index=False)
daily_202103_excel_writer.save()
daily_20210305 = pro.daily(start_date='',end_date='',trade_date='20210305', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20210305_tscode_list = list() 
for ts_code_sh in daily_20210305['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20210305_tscode_list.append(stock_name)
daily_20210305_addname_dataframe=pd.DataFrame()
daily_20210305_addname_dataframe['cname'] = daily_20210305_tscode_list
for table_name in daily_20210305.columns.values.tolist():
    daily_20210305_addname_dataframe[table_name] = daily_20210305[table_name]
print("日线行情-时间为序  daily_20210305 返回数据 row 行数 = "+str(daily_20210305.shape[0]))
daily_20210305_addname_dataframe.to_excel(daily_202103_excel_writer,'5_5',index=False)
daily_202103_excel_writer.save()
daily_20210306 = pro.daily(start_date='',end_date='',trade_date='20210306', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20210306_tscode_list = list() 
for ts_code_sh in daily_20210306['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20210306_tscode_list.append(stock_name)
daily_20210306_addname_dataframe=pd.DataFrame()
daily_20210306_addname_dataframe['cname'] = daily_20210306_tscode_list
for table_name in daily_20210306.columns.values.tolist():
    daily_20210306_addname_dataframe[table_name] = daily_20210306[table_name]
print("日线行情-时间为序  daily_20210306 返回数据 row 行数 = "+str(daily_20210306.shape[0]))
daily_20210306_addname_dataframe.to_excel(daily_202103_excel_writer,'6_6',index=False)
daily_202103_excel_writer.save()
daily_20210307 = pro.daily(start_date='',end_date='',trade_date='20210307', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20210307_tscode_list = list() 
for ts_code_sh in daily_20210307['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20210307_tscode_list.append(stock_name)
daily_20210307_addname_dataframe=pd.DataFrame()
daily_20210307_addname_dataframe['cname'] = daily_20210307_tscode_list
for table_name in daily_20210307.columns.values.tolist():
    daily_20210307_addname_dataframe[table_name] = daily_20210307[table_name]
print("日线行情-时间为序  daily_20210307 返回数据 row 行数 = "+str(daily_20210307.shape[0]))
daily_20210307_addname_dataframe.to_excel(daily_202103_excel_writer,'7_7',index=False)
daily_202103_excel_writer.save()
daily_20210308 = pro.daily(start_date='',end_date='',trade_date='20210308', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20210308_tscode_list = list() 
for ts_code_sh in daily_20210308['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20210308_tscode_list.append(stock_name)
daily_20210308_addname_dataframe=pd.DataFrame()
daily_20210308_addname_dataframe['cname'] = daily_20210308_tscode_list
for table_name in daily_20210308.columns.values.tolist():
    daily_20210308_addname_dataframe[table_name] = daily_20210308[table_name]
print("日线行情-时间为序  daily_20210308 返回数据 row 行数 = "+str(daily_20210308.shape[0]))
daily_20210308_addname_dataframe.to_excel(daily_202103_excel_writer,'8_1',index=False)
daily_202103_excel_writer.save()
daily_20210309 = pro.daily(start_date='',end_date='',trade_date='20210309', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20210309_tscode_list = list() 
for ts_code_sh in daily_20210309['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20210309_tscode_list.append(stock_name)
daily_20210309_addname_dataframe=pd.DataFrame()
daily_20210309_addname_dataframe['cname'] = daily_20210309_tscode_list
for table_name in daily_20210309.columns.values.tolist():
    daily_20210309_addname_dataframe[table_name] = daily_20210309[table_name]
print("日线行情-时间为序  daily_20210309 返回数据 row 行数 = "+str(daily_20210309.shape[0]))
daily_20210309_addname_dataframe.to_excel(daily_202103_excel_writer,'9_2',index=False)
daily_202103_excel_writer.save()
daily_20210310 = pro.daily(start_date='',end_date='',trade_date='20210310', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20210310_tscode_list = list() 
for ts_code_sh in daily_20210310['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20210310_tscode_list.append(stock_name)
daily_20210310_addname_dataframe=pd.DataFrame()
daily_20210310_addname_dataframe['cname'] = daily_20210310_tscode_list
for table_name in daily_20210310.columns.values.tolist():
    daily_20210310_addname_dataframe[table_name] = daily_20210310[table_name]
print("日线行情-时间为序  daily_20210310 返回数据 row 行数 = "+str(daily_20210310.shape[0]))
daily_20210310_addname_dataframe.to_excel(daily_202103_excel_writer,'10_3',index=False)
daily_202103_excel_writer.save()
daily_20210311 = pro.daily(start_date='',end_date='',trade_date='20210311', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20210311_tscode_list = list() 
for ts_code_sh in daily_20210311['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20210311_tscode_list.append(stock_name)
daily_20210311_addname_dataframe=pd.DataFrame()
daily_20210311_addname_dataframe['cname'] = daily_20210311_tscode_list
for table_name in daily_20210311.columns.values.tolist():
    daily_20210311_addname_dataframe[table_name] = daily_20210311[table_name]
print("日线行情-时间为序  daily_20210311 返回数据 row 行数 = "+str(daily_20210311.shape[0]))
daily_20210311_addname_dataframe.to_excel(daily_202103_excel_writer,'11_4',index=False)
daily_202103_excel_writer.save()
daily_20210312 = pro.daily(start_date='',end_date='',trade_date='20210312', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20210312_tscode_list = list() 
for ts_code_sh in daily_20210312['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20210312_tscode_list.append(stock_name)
daily_20210312_addname_dataframe=pd.DataFrame()
daily_20210312_addname_dataframe['cname'] = daily_20210312_tscode_list
for table_name in daily_20210312.columns.values.tolist():
    daily_20210312_addname_dataframe[table_name] = daily_20210312[table_name]
print("日线行情-时间为序  daily_20210312 返回数据 row 行数 = "+str(daily_20210312.shape[0]))
daily_20210312_addname_dataframe.to_excel(daily_202103_excel_writer,'12_5',index=False)
daily_202103_excel_writer.save()
daily_20210313 = pro.daily(start_date='',end_date='',trade_date='20210313', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20210313_tscode_list = list() 
for ts_code_sh in daily_20210313['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20210313_tscode_list.append(stock_name)
daily_20210313_addname_dataframe=pd.DataFrame()
daily_20210313_addname_dataframe['cname'] = daily_20210313_tscode_list
for table_name in daily_20210313.columns.values.tolist():
    daily_20210313_addname_dataframe[table_name] = daily_20210313[table_name]
print("日线行情-时间为序  daily_20210313 返回数据 row 行数 = "+str(daily_20210313.shape[0]))
daily_20210313_addname_dataframe.to_excel(daily_202103_excel_writer,'13_6',index=False)
daily_202103_excel_writer.save()
daily_20210314 = pro.daily(start_date='',end_date='',trade_date='20210314', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20210314_tscode_list = list() 
for ts_code_sh in daily_20210314['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20210314_tscode_list.append(stock_name)
daily_20210314_addname_dataframe=pd.DataFrame()
daily_20210314_addname_dataframe['cname'] = daily_20210314_tscode_list
for table_name in daily_20210314.columns.values.tolist():
    daily_20210314_addname_dataframe[table_name] = daily_20210314[table_name]
print("日线行情-时间为序  daily_20210314 返回数据 row 行数 = "+str(daily_20210314.shape[0]))
daily_20210314_addname_dataframe.to_excel(daily_202103_excel_writer,'14_7',index=False)
daily_202103_excel_writer.save()
daily_20210315 = pro.daily(start_date='',end_date='',trade_date='20210315', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20210315_tscode_list = list() 
for ts_code_sh in daily_20210315['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20210315_tscode_list.append(stock_name)
daily_20210315_addname_dataframe=pd.DataFrame()
daily_20210315_addname_dataframe['cname'] = daily_20210315_tscode_list
for table_name in daily_20210315.columns.values.tolist():
    daily_20210315_addname_dataframe[table_name] = daily_20210315[table_name]
print("日线行情-时间为序  daily_20210315 返回数据 row 行数 = "+str(daily_20210315.shape[0]))
daily_20210315_addname_dataframe.to_excel(daily_202103_excel_writer,'15_1',index=False)
daily_202103_excel_writer.save()
daily_20210316 = pro.daily(start_date='',end_date='',trade_date='20210316', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20210316_tscode_list = list() 
for ts_code_sh in daily_20210316['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20210316_tscode_list.append(stock_name)
daily_20210316_addname_dataframe=pd.DataFrame()
daily_20210316_addname_dataframe['cname'] = daily_20210316_tscode_list
for table_name in daily_20210316.columns.values.tolist():
    daily_20210316_addname_dataframe[table_name] = daily_20210316[table_name]
print("日线行情-时间为序  daily_20210316 返回数据 row 行数 = "+str(daily_20210316.shape[0]))
daily_20210316_addname_dataframe.to_excel(daily_202103_excel_writer,'16_2',index=False)
daily_202103_excel_writer.save()
daily_20210317 = pro.daily(start_date='',end_date='',trade_date='20210317', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20210317_tscode_list = list() 
for ts_code_sh in daily_20210317['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20210317_tscode_list.append(stock_name)
daily_20210317_addname_dataframe=pd.DataFrame()
daily_20210317_addname_dataframe['cname'] = daily_20210317_tscode_list
for table_name in daily_20210317.columns.values.tolist():
    daily_20210317_addname_dataframe[table_name] = daily_20210317[table_name]
print("日线行情-时间为序  daily_20210317 返回数据 row 行数 = "+str(daily_20210317.shape[0]))
daily_20210317_addname_dataframe.to_excel(daily_202103_excel_writer,'17_3',index=False)
daily_202103_excel_writer.save()
daily_20210318 = pro.daily(start_date='',end_date='',trade_date='20210318', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20210318_tscode_list = list() 
for ts_code_sh in daily_20210318['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20210318_tscode_list.append(stock_name)
daily_20210318_addname_dataframe=pd.DataFrame()
daily_20210318_addname_dataframe['cname'] = daily_20210318_tscode_list
for table_name in daily_20210318.columns.values.tolist():
    daily_20210318_addname_dataframe[table_name] = daily_20210318[table_name]
print("日线行情-时间为序  daily_20210318 返回数据 row 行数 = "+str(daily_20210318.shape[0]))
daily_20210318_addname_dataframe.to_excel(daily_202103_excel_writer,'18_4',index=False)
daily_202103_excel_writer.save()
daily_20210319 = pro.daily(start_date='',end_date='',trade_date='20210319', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20210319_tscode_list = list() 
for ts_code_sh in daily_20210319['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20210319_tscode_list.append(stock_name)
daily_20210319_addname_dataframe=pd.DataFrame()
daily_20210319_addname_dataframe['cname'] = daily_20210319_tscode_list
for table_name in daily_20210319.columns.values.tolist():
    daily_20210319_addname_dataframe[table_name] = daily_20210319[table_name]
print("日线行情-时间为序  daily_20210319 返回数据 row 行数 = "+str(daily_20210319.shape[0]))
daily_20210319_addname_dataframe.to_excel(daily_202103_excel_writer,'19_5',index=False)
daily_202103_excel_writer.save()
daily_20210320 = pro.daily(start_date='',end_date='',trade_date='20210320', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20210320_tscode_list = list() 
for ts_code_sh in daily_20210320['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20210320_tscode_list.append(stock_name)
daily_20210320_addname_dataframe=pd.DataFrame()
daily_20210320_addname_dataframe['cname'] = daily_20210320_tscode_list
for table_name in daily_20210320.columns.values.tolist():
    daily_20210320_addname_dataframe[table_name] = daily_20210320[table_name]
print("日线行情-时间为序  daily_20210320 返回数据 row 行数 = "+str(daily_20210320.shape[0]))
daily_20210320_addname_dataframe.to_excel(daily_202103_excel_writer,'20_6',index=False)
daily_202103_excel_writer.save()
daily_20210321 = pro.daily(start_date='',end_date='',trade_date='20210321', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20210321_tscode_list = list() 
for ts_code_sh in daily_20210321['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20210321_tscode_list.append(stock_name)
daily_20210321_addname_dataframe=pd.DataFrame()
daily_20210321_addname_dataframe['cname'] = daily_20210321_tscode_list
for table_name in daily_20210321.columns.values.tolist():
    daily_20210321_addname_dataframe[table_name] = daily_20210321[table_name]
print("日线行情-时间为序  daily_20210321 返回数据 row 行数 = "+str(daily_20210321.shape[0]))
daily_20210321_addname_dataframe.to_excel(daily_202103_excel_writer,'21_7',index=False)
daily_202103_excel_writer.save()
daily_20210322 = pro.daily(start_date='',end_date='',trade_date='20210322', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20210322_tscode_list = list() 
for ts_code_sh in daily_20210322['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20210322_tscode_list.append(stock_name)
daily_20210322_addname_dataframe=pd.DataFrame()
daily_20210322_addname_dataframe['cname'] = daily_20210322_tscode_list
for table_name in daily_20210322.columns.values.tolist():
    daily_20210322_addname_dataframe[table_name] = daily_20210322[table_name]
print("日线行情-时间为序  daily_20210322 返回数据 row 行数 = "+str(daily_20210322.shape[0]))
daily_20210322_addname_dataframe.to_excel(daily_202103_excel_writer,'22_1',index=False)
daily_202103_excel_writer.save()
daily_20210323 = pro.daily(start_date='',end_date='',trade_date='20210323', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20210323_tscode_list = list() 
for ts_code_sh in daily_20210323['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20210323_tscode_list.append(stock_name)
daily_20210323_addname_dataframe=pd.DataFrame()
daily_20210323_addname_dataframe['cname'] = daily_20210323_tscode_list
for table_name in daily_20210323.columns.values.tolist():
    daily_20210323_addname_dataframe[table_name] = daily_20210323[table_name]
print("日线行情-时间为序  daily_20210323 返回数据 row 行数 = "+str(daily_20210323.shape[0]))
daily_20210323_addname_dataframe.to_excel(daily_202103_excel_writer,'23_2',index=False)
daily_202103_excel_writer.save()
daily_20210324 = pro.daily(start_date='',end_date='',trade_date='20210324', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20210324_tscode_list = list() 
for ts_code_sh in daily_20210324['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20210324_tscode_list.append(stock_name)
daily_20210324_addname_dataframe=pd.DataFrame()
daily_20210324_addname_dataframe['cname'] = daily_20210324_tscode_list
for table_name in daily_20210324.columns.values.tolist():
    daily_20210324_addname_dataframe[table_name] = daily_20210324[table_name]
print("日线行情-时间为序  daily_20210324 返回数据 row 行数 = "+str(daily_20210324.shape[0]))
daily_20210324_addname_dataframe.to_excel(daily_202103_excel_writer,'24_3',index=False)
daily_202103_excel_writer.save()
daily_20210325 = pro.daily(start_date='',end_date='',trade_date='20210325', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20210325_tscode_list = list() 
for ts_code_sh in daily_20210325['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20210325_tscode_list.append(stock_name)
daily_20210325_addname_dataframe=pd.DataFrame()
daily_20210325_addname_dataframe['cname'] = daily_20210325_tscode_list
for table_name in daily_20210325.columns.values.tolist():
    daily_20210325_addname_dataframe[table_name] = daily_20210325[table_name]
print("日线行情-时间为序  daily_20210325 返回数据 row 行数 = "+str(daily_20210325.shape[0]))
daily_20210325_addname_dataframe.to_excel(daily_202103_excel_writer,'25_4',index=False)
daily_202103_excel_writer.save()
daily_20210326 = pro.daily(start_date='',end_date='',trade_date='20210326', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20210326_tscode_list = list() 
for ts_code_sh in daily_20210326['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20210326_tscode_list.append(stock_name)
daily_20210326_addname_dataframe=pd.DataFrame()
daily_20210326_addname_dataframe['cname'] = daily_20210326_tscode_list
for table_name in daily_20210326.columns.values.tolist():
    daily_20210326_addname_dataframe[table_name] = daily_20210326[table_name]
print("日线行情-时间为序  daily_20210326 返回数据 row 行数 = "+str(daily_20210326.shape[0]))
daily_20210326_addname_dataframe.to_excel(daily_202103_excel_writer,'26_5',index=False)
daily_202103_excel_writer.save()
daily_20210327 = pro.daily(start_date='',end_date='',trade_date='20210327', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20210327_tscode_list = list() 
for ts_code_sh in daily_20210327['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20210327_tscode_list.append(stock_name)
daily_20210327_addname_dataframe=pd.DataFrame()
daily_20210327_addname_dataframe['cname'] = daily_20210327_tscode_list
for table_name in daily_20210327.columns.values.tolist():
    daily_20210327_addname_dataframe[table_name] = daily_20210327[table_name]
print("日线行情-时间为序  daily_20210327 返回数据 row 行数 = "+str(daily_20210327.shape[0]))
daily_20210327_addname_dataframe.to_excel(daily_202103_excel_writer,'27_6',index=False)
daily_202103_excel_writer.save()
daily_20210328 = pro.daily(start_date='',end_date='',trade_date='20210328', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20210328_tscode_list = list() 
for ts_code_sh in daily_20210328['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20210328_tscode_list.append(stock_name)
daily_20210328_addname_dataframe=pd.DataFrame()
daily_20210328_addname_dataframe['cname'] = daily_20210328_tscode_list
for table_name in daily_20210328.columns.values.tolist():
    daily_20210328_addname_dataframe[table_name] = daily_20210328[table_name]
print("日线行情-时间为序  daily_20210328 返回数据 row 行数 = "+str(daily_20210328.shape[0]))
daily_20210328_addname_dataframe.to_excel(daily_202103_excel_writer,'28_7',index=False)
daily_202103_excel_writer.save()
daily_20210329 = pro.daily(start_date='',end_date='',trade_date='20210329', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20210329_tscode_list = list() 
for ts_code_sh in daily_20210329['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20210329_tscode_list.append(stock_name)
daily_20210329_addname_dataframe=pd.DataFrame()
daily_20210329_addname_dataframe['cname'] = daily_20210329_tscode_list
for table_name in daily_20210329.columns.values.tolist():
    daily_20210329_addname_dataframe[table_name] = daily_20210329[table_name]
print("日线行情-时间为序  daily_20210329 返回数据 row 行数 = "+str(daily_20210329.shape[0]))
daily_20210329_addname_dataframe.to_excel(daily_202103_excel_writer,'29_1',index=False)
daily_202103_excel_writer.save()
daily_20210330 = pro.daily(start_date='',end_date='',trade_date='20210330', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20210330_tscode_list = list() 
for ts_code_sh in daily_20210330['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20210330_tscode_list.append(stock_name)
daily_20210330_addname_dataframe=pd.DataFrame()
daily_20210330_addname_dataframe['cname'] = daily_20210330_tscode_list
for table_name in daily_20210330.columns.values.tolist():
    daily_20210330_addname_dataframe[table_name] = daily_20210330[table_name]
print("日线行情-时间为序  daily_20210330 返回数据 row 行数 = "+str(daily_20210330.shape[0]))
daily_20210330_addname_dataframe.to_excel(daily_202103_excel_writer,'30_2',index=False)
daily_202103_excel_writer.save()
daily_20210331 = pro.daily(start_date='',end_date='',trade_date='20210331', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20210331_tscode_list = list() 
for ts_code_sh in daily_20210331['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20210331_tscode_list.append(stock_name)
daily_20210331_addname_dataframe=pd.DataFrame()
daily_20210331_addname_dataframe['cname'] = daily_20210331_tscode_list
for table_name in daily_20210331.columns.values.tolist():
    daily_20210331_addname_dataframe[table_name] = daily_20210331[table_name]
print("日线行情-时间为序  daily_20210331 返回数据 row 行数 = "+str(daily_20210331.shape[0]))
daily_20210331_addname_dataframe.to_excel(daily_202103_excel_writer,'31_3',index=False)
daily_202103_excel_writer.save()




createexcel('daily_202104.xlsx')
daily_202104_book = load_workbook('C:\\Users\\zhuzj5\\Desktop\\zbin\\J0_Data\\daily_202104.xlsx')
daily_202104_excel_writer = pd.ExcelWriter('C:\\Users\\zhuzj5\\Desktop\\zbin\\J0_Data\\daily_202104.xlsx', engine='openpyxl')
daily_202104_excel_writer.book = daily_202104_book
daily_202104_excel_writer.sheets = dict((ws.title, ws) for ws in daily_202104_book.worksheets)
J0_PROPS.put(tree_node_name+"record_date", "20210401")       ###  更新 记录日期
daily_20210401 = pro.daily(start_date='',end_date='',trade_date='20210401', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20210401_tscode_list = list() 
for ts_code_sh in daily_20210401['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20210401_tscode_list.append(stock_name)
daily_20210401_addname_dataframe=pd.DataFrame()
daily_20210401_addname_dataframe['cname'] = daily_20210401_tscode_list
for table_name in daily_20210401.columns.values.tolist():
    daily_20210401_addname_dataframe[table_name] = daily_20210401[table_name]
print("日线行情-时间为序  daily_20210401 返回数据 row 行数 = "+str(daily_20210401.shape[0]))
daily_20210401_addname_dataframe.to_excel(daily_202104_excel_writer,'1_4',index=False)
daily_202104_excel_writer.save()
daily_20210402 = pro.daily(start_date='',end_date='',trade_date='20210402', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20210402_tscode_list = list() 
for ts_code_sh in daily_20210402['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20210402_tscode_list.append(stock_name)
daily_20210402_addname_dataframe=pd.DataFrame()
daily_20210402_addname_dataframe['cname'] = daily_20210402_tscode_list
for table_name in daily_20210402.columns.values.tolist():
    daily_20210402_addname_dataframe[table_name] = daily_20210402[table_name]
print("日线行情-时间为序  daily_20210402 返回数据 row 行数 = "+str(daily_20210402.shape[0]))
daily_20210402_addname_dataframe.to_excel(daily_202104_excel_writer,'2_5',index=False)
daily_202104_excel_writer.save()
daily_20210403 = pro.daily(start_date='',end_date='',trade_date='20210403', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20210403_tscode_list = list() 
for ts_code_sh in daily_20210403['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20210403_tscode_list.append(stock_name)
daily_20210403_addname_dataframe=pd.DataFrame()
daily_20210403_addname_dataframe['cname'] = daily_20210403_tscode_list
for table_name in daily_20210403.columns.values.tolist():
    daily_20210403_addname_dataframe[table_name] = daily_20210403[table_name]
print("日线行情-时间为序  daily_20210403 返回数据 row 行数 = "+str(daily_20210403.shape[0]))
daily_20210403_addname_dataframe.to_excel(daily_202104_excel_writer,'3_6',index=False)
daily_202104_excel_writer.save()
daily_20210404 = pro.daily(start_date='',end_date='',trade_date='20210404', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20210404_tscode_list = list() 
for ts_code_sh in daily_20210404['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20210404_tscode_list.append(stock_name)
daily_20210404_addname_dataframe=pd.DataFrame()
daily_20210404_addname_dataframe['cname'] = daily_20210404_tscode_list
for table_name in daily_20210404.columns.values.tolist():
    daily_20210404_addname_dataframe[table_name] = daily_20210404[table_name]
print("日线行情-时间为序  daily_20210404 返回数据 row 行数 = "+str(daily_20210404.shape[0]))
daily_20210404_addname_dataframe.to_excel(daily_202104_excel_writer,'4_7',index=False)
daily_202104_excel_writer.save()
daily_20210405 = pro.daily(start_date='',end_date='',trade_date='20210405', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20210405_tscode_list = list() 
for ts_code_sh in daily_20210405['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20210405_tscode_list.append(stock_name)
daily_20210405_addname_dataframe=pd.DataFrame()
daily_20210405_addname_dataframe['cname'] = daily_20210405_tscode_list
for table_name in daily_20210405.columns.values.tolist():
    daily_20210405_addname_dataframe[table_name] = daily_20210405[table_name]
print("日线行情-时间为序  daily_20210405 返回数据 row 行数 = "+str(daily_20210405.shape[0]))
daily_20210405_addname_dataframe.to_excel(daily_202104_excel_writer,'5_1',index=False)
daily_202104_excel_writer.save()
daily_20210406 = pro.daily(start_date='',end_date='',trade_date='20210406', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20210406_tscode_list = list() 
for ts_code_sh in daily_20210406['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20210406_tscode_list.append(stock_name)
daily_20210406_addname_dataframe=pd.DataFrame()
daily_20210406_addname_dataframe['cname'] = daily_20210406_tscode_list
for table_name in daily_20210406.columns.values.tolist():
    daily_20210406_addname_dataframe[table_name] = daily_20210406[table_name]
print("日线行情-时间为序  daily_20210406 返回数据 row 行数 = "+str(daily_20210406.shape[0]))
daily_20210406_addname_dataframe.to_excel(daily_202104_excel_writer,'6_2',index=False)
daily_202104_excel_writer.save()
daily_20210407 = pro.daily(start_date='',end_date='',trade_date='20210407', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20210407_tscode_list = list() 
for ts_code_sh in daily_20210407['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20210407_tscode_list.append(stock_name)
daily_20210407_addname_dataframe=pd.DataFrame()
daily_20210407_addname_dataframe['cname'] = daily_20210407_tscode_list
for table_name in daily_20210407.columns.values.tolist():
    daily_20210407_addname_dataframe[table_name] = daily_20210407[table_name]
print("日线行情-时间为序  daily_20210407 返回数据 row 行数 = "+str(daily_20210407.shape[0]))
daily_20210407_addname_dataframe.to_excel(daily_202104_excel_writer,'7_3',index=False)
daily_202104_excel_writer.save()
daily_20210408 = pro.daily(start_date='',end_date='',trade_date='20210408', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20210408_tscode_list = list() 
for ts_code_sh in daily_20210408['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20210408_tscode_list.append(stock_name)
daily_20210408_addname_dataframe=pd.DataFrame()
daily_20210408_addname_dataframe['cname'] = daily_20210408_tscode_list
for table_name in daily_20210408.columns.values.tolist():
    daily_20210408_addname_dataframe[table_name] = daily_20210408[table_name]
print("日线行情-时间为序  daily_20210408 返回数据 row 行数 = "+str(daily_20210408.shape[0]))
daily_20210408_addname_dataframe.to_excel(daily_202104_excel_writer,'8_4',index=False)
daily_202104_excel_writer.save()
daily_20210409 = pro.daily(start_date='',end_date='',trade_date='20210409', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20210409_tscode_list = list() 
for ts_code_sh in daily_20210409['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20210409_tscode_list.append(stock_name)
daily_20210409_addname_dataframe=pd.DataFrame()
daily_20210409_addname_dataframe['cname'] = daily_20210409_tscode_list
for table_name in daily_20210409.columns.values.tolist():
    daily_20210409_addname_dataframe[table_name] = daily_20210409[table_name]
print("日线行情-时间为序  daily_20210409 返回数据 row 行数 = "+str(daily_20210409.shape[0]))
daily_20210409_addname_dataframe.to_excel(daily_202104_excel_writer,'9_5',index=False)
daily_202104_excel_writer.save()
daily_20210410 = pro.daily(start_date='',end_date='',trade_date='20210410', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20210410_tscode_list = list() 
for ts_code_sh in daily_20210410['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20210410_tscode_list.append(stock_name)
daily_20210410_addname_dataframe=pd.DataFrame()
daily_20210410_addname_dataframe['cname'] = daily_20210410_tscode_list
for table_name in daily_20210410.columns.values.tolist():
    daily_20210410_addname_dataframe[table_name] = daily_20210410[table_name]
print("日线行情-时间为序  daily_20210410 返回数据 row 行数 = "+str(daily_20210410.shape[0]))
daily_20210410_addname_dataframe.to_excel(daily_202104_excel_writer,'10_6',index=False)
daily_202104_excel_writer.save()
daily_20210411 = pro.daily(start_date='',end_date='',trade_date='20210411', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20210411_tscode_list = list() 
for ts_code_sh in daily_20210411['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20210411_tscode_list.append(stock_name)
daily_20210411_addname_dataframe=pd.DataFrame()
daily_20210411_addname_dataframe['cname'] = daily_20210411_tscode_list
for table_name in daily_20210411.columns.values.tolist():
    daily_20210411_addname_dataframe[table_name] = daily_20210411[table_name]
print("日线行情-时间为序  daily_20210411 返回数据 row 行数 = "+str(daily_20210411.shape[0]))
daily_20210411_addname_dataframe.to_excel(daily_202104_excel_writer,'11_7',index=False)
daily_202104_excel_writer.save()
daily_20210412 = pro.daily(start_date='',end_date='',trade_date='20210412', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20210412_tscode_list = list() 
for ts_code_sh in daily_20210412['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20210412_tscode_list.append(stock_name)
daily_20210412_addname_dataframe=pd.DataFrame()
daily_20210412_addname_dataframe['cname'] = daily_20210412_tscode_list
for table_name in daily_20210412.columns.values.tolist():
    daily_20210412_addname_dataframe[table_name] = daily_20210412[table_name]
print("日线行情-时间为序  daily_20210412 返回数据 row 行数 = "+str(daily_20210412.shape[0]))
daily_20210412_addname_dataframe.to_excel(daily_202104_excel_writer,'12_1',index=False)
daily_202104_excel_writer.save()
daily_20210413 = pro.daily(start_date='',end_date='',trade_date='20210413', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20210413_tscode_list = list() 
for ts_code_sh in daily_20210413['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20210413_tscode_list.append(stock_name)
daily_20210413_addname_dataframe=pd.DataFrame()
daily_20210413_addname_dataframe['cname'] = daily_20210413_tscode_list
for table_name in daily_20210413.columns.values.tolist():
    daily_20210413_addname_dataframe[table_name] = daily_20210413[table_name]
print("日线行情-时间为序  daily_20210413 返回数据 row 行数 = "+str(daily_20210413.shape[0]))
daily_20210413_addname_dataframe.to_excel(daily_202104_excel_writer,'13_2',index=False)
daily_202104_excel_writer.save()
daily_20210414 = pro.daily(start_date='',end_date='',trade_date='20210414', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20210414_tscode_list = list() 
for ts_code_sh in daily_20210414['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20210414_tscode_list.append(stock_name)
daily_20210414_addname_dataframe=pd.DataFrame()
daily_20210414_addname_dataframe['cname'] = daily_20210414_tscode_list
for table_name in daily_20210414.columns.values.tolist():
    daily_20210414_addname_dataframe[table_name] = daily_20210414[table_name]
print("日线行情-时间为序  daily_20210414 返回数据 row 行数 = "+str(daily_20210414.shape[0]))
daily_20210414_addname_dataframe.to_excel(daily_202104_excel_writer,'14_3',index=False)
daily_202104_excel_writer.save()
daily_20210415 = pro.daily(start_date='',end_date='',trade_date='20210415', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20210415_tscode_list = list() 
for ts_code_sh in daily_20210415['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20210415_tscode_list.append(stock_name)
daily_20210415_addname_dataframe=pd.DataFrame()
daily_20210415_addname_dataframe['cname'] = daily_20210415_tscode_list
for table_name in daily_20210415.columns.values.tolist():
    daily_20210415_addname_dataframe[table_name] = daily_20210415[table_name]
print("日线行情-时间为序  daily_20210415 返回数据 row 行数 = "+str(daily_20210415.shape[0]))
daily_20210415_addname_dataframe.to_excel(daily_202104_excel_writer,'15_4',index=False)
daily_202104_excel_writer.save()
daily_20210416 = pro.daily(start_date='',end_date='',trade_date='20210416', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20210416_tscode_list = list() 
for ts_code_sh in daily_20210416['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20210416_tscode_list.append(stock_name)
daily_20210416_addname_dataframe=pd.DataFrame()
daily_20210416_addname_dataframe['cname'] = daily_20210416_tscode_list
for table_name in daily_20210416.columns.values.tolist():
    daily_20210416_addname_dataframe[table_name] = daily_20210416[table_name]
print("日线行情-时间为序  daily_20210416 返回数据 row 行数 = "+str(daily_20210416.shape[0]))
daily_20210416_addname_dataframe.to_excel(daily_202104_excel_writer,'16_5',index=False)
daily_202104_excel_writer.save()
daily_20210417 = pro.daily(start_date='',end_date='',trade_date='20210417', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20210417_tscode_list = list() 
for ts_code_sh in daily_20210417['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20210417_tscode_list.append(stock_name)
daily_20210417_addname_dataframe=pd.DataFrame()
daily_20210417_addname_dataframe['cname'] = daily_20210417_tscode_list
for table_name in daily_20210417.columns.values.tolist():
    daily_20210417_addname_dataframe[table_name] = daily_20210417[table_name]
print("日线行情-时间为序  daily_20210417 返回数据 row 行数 = "+str(daily_20210417.shape[0]))
daily_20210417_addname_dataframe.to_excel(daily_202104_excel_writer,'17_6',index=False)
daily_202104_excel_writer.save()
daily_20210418 = pro.daily(start_date='',end_date='',trade_date='20210418', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20210418_tscode_list = list() 
for ts_code_sh in daily_20210418['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20210418_tscode_list.append(stock_name)
daily_20210418_addname_dataframe=pd.DataFrame()
daily_20210418_addname_dataframe['cname'] = daily_20210418_tscode_list
for table_name in daily_20210418.columns.values.tolist():
    daily_20210418_addname_dataframe[table_name] = daily_20210418[table_name]
print("日线行情-时间为序  daily_20210418 返回数据 row 行数 = "+str(daily_20210418.shape[0]))
daily_20210418_addname_dataframe.to_excel(daily_202104_excel_writer,'18_7',index=False)
daily_202104_excel_writer.save()
daily_20210419 = pro.daily(start_date='',end_date='',trade_date='20210419', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20210419_tscode_list = list() 
for ts_code_sh in daily_20210419['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20210419_tscode_list.append(stock_name)
daily_20210419_addname_dataframe=pd.DataFrame()
daily_20210419_addname_dataframe['cname'] = daily_20210419_tscode_list
for table_name in daily_20210419.columns.values.tolist():
    daily_20210419_addname_dataframe[table_name] = daily_20210419[table_name]
print("日线行情-时间为序  daily_20210419 返回数据 row 行数 = "+str(daily_20210419.shape[0]))
daily_20210419_addname_dataframe.to_excel(daily_202104_excel_writer,'19_1',index=False)
daily_202104_excel_writer.save()
daily_20210420 = pro.daily(start_date='',end_date='',trade_date='20210420', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20210420_tscode_list = list() 
for ts_code_sh in daily_20210420['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20210420_tscode_list.append(stock_name)
daily_20210420_addname_dataframe=pd.DataFrame()
daily_20210420_addname_dataframe['cname'] = daily_20210420_tscode_list
for table_name in daily_20210420.columns.values.tolist():
    daily_20210420_addname_dataframe[table_name] = daily_20210420[table_name]
print("日线行情-时间为序  daily_20210420 返回数据 row 行数 = "+str(daily_20210420.shape[0]))
daily_20210420_addname_dataframe.to_excel(daily_202104_excel_writer,'20_2',index=False)
daily_202104_excel_writer.save()
daily_20210421 = pro.daily(start_date='',end_date='',trade_date='20210421', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20210421_tscode_list = list() 
for ts_code_sh in daily_20210421['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20210421_tscode_list.append(stock_name)
daily_20210421_addname_dataframe=pd.DataFrame()
daily_20210421_addname_dataframe['cname'] = daily_20210421_tscode_list
for table_name in daily_20210421.columns.values.tolist():
    daily_20210421_addname_dataframe[table_name] = daily_20210421[table_name]
print("日线行情-时间为序  daily_20210421 返回数据 row 行数 = "+str(daily_20210421.shape[0]))
daily_20210421_addname_dataframe.to_excel(daily_202104_excel_writer,'21_3',index=False)
daily_202104_excel_writer.save()
daily_20210422 = pro.daily(start_date='',end_date='',trade_date='20210422', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20210422_tscode_list = list() 
for ts_code_sh in daily_20210422['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20210422_tscode_list.append(stock_name)
daily_20210422_addname_dataframe=pd.DataFrame()
daily_20210422_addname_dataframe['cname'] = daily_20210422_tscode_list
for table_name in daily_20210422.columns.values.tolist():
    daily_20210422_addname_dataframe[table_name] = daily_20210422[table_name]
print("日线行情-时间为序  daily_20210422 返回数据 row 行数 = "+str(daily_20210422.shape[0]))
daily_20210422_addname_dataframe.to_excel(daily_202104_excel_writer,'22_4',index=False)
daily_202104_excel_writer.save()
daily_20210423 = pro.daily(start_date='',end_date='',trade_date='20210423', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20210423_tscode_list = list() 
for ts_code_sh in daily_20210423['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20210423_tscode_list.append(stock_name)
daily_20210423_addname_dataframe=pd.DataFrame()
daily_20210423_addname_dataframe['cname'] = daily_20210423_tscode_list
for table_name in daily_20210423.columns.values.tolist():
    daily_20210423_addname_dataframe[table_name] = daily_20210423[table_name]
print("日线行情-时间为序  daily_20210423 返回数据 row 行数 = "+str(daily_20210423.shape[0]))
daily_20210423_addname_dataframe.to_excel(daily_202104_excel_writer,'23_5',index=False)
daily_202104_excel_writer.save()
daily_20210424 = pro.daily(start_date='',end_date='',trade_date='20210424', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20210424_tscode_list = list() 
for ts_code_sh in daily_20210424['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20210424_tscode_list.append(stock_name)
daily_20210424_addname_dataframe=pd.DataFrame()
daily_20210424_addname_dataframe['cname'] = daily_20210424_tscode_list
for table_name in daily_20210424.columns.values.tolist():
    daily_20210424_addname_dataframe[table_name] = daily_20210424[table_name]
print("日线行情-时间为序  daily_20210424 返回数据 row 行数 = "+str(daily_20210424.shape[0]))
daily_20210424_addname_dataframe.to_excel(daily_202104_excel_writer,'24_6',index=False)
daily_202104_excel_writer.save()
daily_20210425 = pro.daily(start_date='',end_date='',trade_date='20210425', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20210425_tscode_list = list() 
for ts_code_sh in daily_20210425['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20210425_tscode_list.append(stock_name)
daily_20210425_addname_dataframe=pd.DataFrame()
daily_20210425_addname_dataframe['cname'] = daily_20210425_tscode_list
for table_name in daily_20210425.columns.values.tolist():
    daily_20210425_addname_dataframe[table_name] = daily_20210425[table_name]
print("日线行情-时间为序  daily_20210425 返回数据 row 行数 = "+str(daily_20210425.shape[0]))
daily_20210425_addname_dataframe.to_excel(daily_202104_excel_writer,'25_7',index=False)
daily_202104_excel_writer.save()
daily_20210426 = pro.daily(start_date='',end_date='',trade_date='20210426', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20210426_tscode_list = list() 
for ts_code_sh in daily_20210426['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20210426_tscode_list.append(stock_name)
daily_20210426_addname_dataframe=pd.DataFrame()
daily_20210426_addname_dataframe['cname'] = daily_20210426_tscode_list
for table_name in daily_20210426.columns.values.tolist():
    daily_20210426_addname_dataframe[table_name] = daily_20210426[table_name]
print("日线行情-时间为序  daily_20210426 返回数据 row 行数 = "+str(daily_20210426.shape[0]))
daily_20210426_addname_dataframe.to_excel(daily_202104_excel_writer,'26_1',index=False)
daily_202104_excel_writer.save()
daily_20210427 = pro.daily(start_date='',end_date='',trade_date='20210427', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20210427_tscode_list = list() 
for ts_code_sh in daily_20210427['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20210427_tscode_list.append(stock_name)
daily_20210427_addname_dataframe=pd.DataFrame()
daily_20210427_addname_dataframe['cname'] = daily_20210427_tscode_list
for table_name in daily_20210427.columns.values.tolist():
    daily_20210427_addname_dataframe[table_name] = daily_20210427[table_name]
print("日线行情-时间为序  daily_20210427 返回数据 row 行数 = "+str(daily_20210427.shape[0]))
daily_20210427_addname_dataframe.to_excel(daily_202104_excel_writer,'27_2',index=False)
daily_202104_excel_writer.save()
daily_20210428 = pro.daily(start_date='',end_date='',trade_date='20210428', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20210428_tscode_list = list() 
for ts_code_sh in daily_20210428['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20210428_tscode_list.append(stock_name)
daily_20210428_addname_dataframe=pd.DataFrame()
daily_20210428_addname_dataframe['cname'] = daily_20210428_tscode_list
for table_name in daily_20210428.columns.values.tolist():
    daily_20210428_addname_dataframe[table_name] = daily_20210428[table_name]
print("日线行情-时间为序  daily_20210428 返回数据 row 行数 = "+str(daily_20210428.shape[0]))
daily_20210428_addname_dataframe.to_excel(daily_202104_excel_writer,'28_3',index=False)
daily_202104_excel_writer.save()
daily_20210429 = pro.daily(start_date='',end_date='',trade_date='20210429', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20210429_tscode_list = list() 
for ts_code_sh in daily_20210429['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20210429_tscode_list.append(stock_name)
daily_20210429_addname_dataframe=pd.DataFrame()
daily_20210429_addname_dataframe['cname'] = daily_20210429_tscode_list
for table_name in daily_20210429.columns.values.tolist():
    daily_20210429_addname_dataframe[table_name] = daily_20210429[table_name]
print("日线行情-时间为序  daily_20210429 返回数据 row 行数 = "+str(daily_20210429.shape[0]))
daily_20210429_addname_dataframe.to_excel(daily_202104_excel_writer,'29_4',index=False)
daily_202104_excel_writer.save()
daily_20210430 = pro.daily(start_date='',end_date='',trade_date='20210430', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20210430_tscode_list = list() 
for ts_code_sh in daily_20210430['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20210430_tscode_list.append(stock_name)
daily_20210430_addname_dataframe=pd.DataFrame()
daily_20210430_addname_dataframe['cname'] = daily_20210430_tscode_list
for table_name in daily_20210430.columns.values.tolist():
    daily_20210430_addname_dataframe[table_name] = daily_20210430[table_name]
print("日线行情-时间为序  daily_20210430 返回数据 row 行数 = "+str(daily_20210430.shape[0]))
daily_20210430_addname_dataframe.to_excel(daily_202104_excel_writer,'30_5',index=False)
daily_202104_excel_writer.save()




createexcel('daily_202105.xlsx')
daily_202105_book = load_workbook('C:\\Users\\zhuzj5\\Desktop\\zbin\\J0_Data\\daily_202105.xlsx')
daily_202105_excel_writer = pd.ExcelWriter('C:\\Users\\zhuzj5\\Desktop\\zbin\\J0_Data\\daily_202105.xlsx', engine='openpyxl')
daily_202105_excel_writer.book = daily_202105_book
daily_202105_excel_writer.sheets = dict((ws.title, ws) for ws in daily_202105_book.worksheets)
J0_PROPS.put(tree_node_name+"record_date", "20210501")       ###  更新 记录日期
daily_20210501 = pro.daily(start_date='',end_date='',trade_date='20210501', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20210501_tscode_list = list() 
for ts_code_sh in daily_20210501['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20210501_tscode_list.append(stock_name)
daily_20210501_addname_dataframe=pd.DataFrame()
daily_20210501_addname_dataframe['cname'] = daily_20210501_tscode_list
for table_name in daily_20210501.columns.values.tolist():
    daily_20210501_addname_dataframe[table_name] = daily_20210501[table_name]
print("日线行情-时间为序  daily_20210501 返回数据 row 行数 = "+str(daily_20210501.shape[0]))
daily_20210501_addname_dataframe.to_excel(daily_202105_excel_writer,'1_6',index=False)
daily_202105_excel_writer.save()
daily_20210502 = pro.daily(start_date='',end_date='',trade_date='20210502', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20210502_tscode_list = list() 
for ts_code_sh in daily_20210502['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20210502_tscode_list.append(stock_name)
daily_20210502_addname_dataframe=pd.DataFrame()
daily_20210502_addname_dataframe['cname'] = daily_20210502_tscode_list
for table_name in daily_20210502.columns.values.tolist():
    daily_20210502_addname_dataframe[table_name] = daily_20210502[table_name]
print("日线行情-时间为序  daily_20210502 返回数据 row 行数 = "+str(daily_20210502.shape[0]))
daily_20210502_addname_dataframe.to_excel(daily_202105_excel_writer,'2_7',index=False)
daily_202105_excel_writer.save()
daily_20210503 = pro.daily(start_date='',end_date='',trade_date='20210503', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20210503_tscode_list = list() 
for ts_code_sh in daily_20210503['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20210503_tscode_list.append(stock_name)
daily_20210503_addname_dataframe=pd.DataFrame()
daily_20210503_addname_dataframe['cname'] = daily_20210503_tscode_list
for table_name in daily_20210503.columns.values.tolist():
    daily_20210503_addname_dataframe[table_name] = daily_20210503[table_name]
print("日线行情-时间为序  daily_20210503 返回数据 row 行数 = "+str(daily_20210503.shape[0]))
daily_20210503_addname_dataframe.to_excel(daily_202105_excel_writer,'3_1',index=False)
daily_202105_excel_writer.save()
daily_20210504 = pro.daily(start_date='',end_date='',trade_date='20210504', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20210504_tscode_list = list() 
for ts_code_sh in daily_20210504['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20210504_tscode_list.append(stock_name)
daily_20210504_addname_dataframe=pd.DataFrame()
daily_20210504_addname_dataframe['cname'] = daily_20210504_tscode_list
for table_name in daily_20210504.columns.values.tolist():
    daily_20210504_addname_dataframe[table_name] = daily_20210504[table_name]
print("日线行情-时间为序  daily_20210504 返回数据 row 行数 = "+str(daily_20210504.shape[0]))
daily_20210504_addname_dataframe.to_excel(daily_202105_excel_writer,'4_2',index=False)
daily_202105_excel_writer.save()
daily_20210505 = pro.daily(start_date='',end_date='',trade_date='20210505', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20210505_tscode_list = list() 
for ts_code_sh in daily_20210505['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20210505_tscode_list.append(stock_name)
daily_20210505_addname_dataframe=pd.DataFrame()
daily_20210505_addname_dataframe['cname'] = daily_20210505_tscode_list
for table_name in daily_20210505.columns.values.tolist():
    daily_20210505_addname_dataframe[table_name] = daily_20210505[table_name]
print("日线行情-时间为序  daily_20210505 返回数据 row 行数 = "+str(daily_20210505.shape[0]))
daily_20210505_addname_dataframe.to_excel(daily_202105_excel_writer,'5_3',index=False)
daily_202105_excel_writer.save()
daily_20210506 = pro.daily(start_date='',end_date='',trade_date='20210506', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20210506_tscode_list = list() 
for ts_code_sh in daily_20210506['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20210506_tscode_list.append(stock_name)
daily_20210506_addname_dataframe=pd.DataFrame()
daily_20210506_addname_dataframe['cname'] = daily_20210506_tscode_list
for table_name in daily_20210506.columns.values.tolist():
    daily_20210506_addname_dataframe[table_name] = daily_20210506[table_name]
print("日线行情-时间为序  daily_20210506 返回数据 row 行数 = "+str(daily_20210506.shape[0]))
daily_20210506_addname_dataframe.to_excel(daily_202105_excel_writer,'6_4',index=False)
daily_202105_excel_writer.save()
daily_20210507 = pro.daily(start_date='',end_date='',trade_date='20210507', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20210507_tscode_list = list() 
for ts_code_sh in daily_20210507['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20210507_tscode_list.append(stock_name)
daily_20210507_addname_dataframe=pd.DataFrame()
daily_20210507_addname_dataframe['cname'] = daily_20210507_tscode_list
for table_name in daily_20210507.columns.values.tolist():
    daily_20210507_addname_dataframe[table_name] = daily_20210507[table_name]
print("日线行情-时间为序  daily_20210507 返回数据 row 行数 = "+str(daily_20210507.shape[0]))
daily_20210507_addname_dataframe.to_excel(daily_202105_excel_writer,'7_5',index=False)
daily_202105_excel_writer.save()
daily_20210508 = pro.daily(start_date='',end_date='',trade_date='20210508', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20210508_tscode_list = list() 
for ts_code_sh in daily_20210508['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20210508_tscode_list.append(stock_name)
daily_20210508_addname_dataframe=pd.DataFrame()
daily_20210508_addname_dataframe['cname'] = daily_20210508_tscode_list
for table_name in daily_20210508.columns.values.tolist():
    daily_20210508_addname_dataframe[table_name] = daily_20210508[table_name]
print("日线行情-时间为序  daily_20210508 返回数据 row 行数 = "+str(daily_20210508.shape[0]))
daily_20210508_addname_dataframe.to_excel(daily_202105_excel_writer,'8_6',index=False)
daily_202105_excel_writer.save()
daily_20210509 = pro.daily(start_date='',end_date='',trade_date='20210509', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20210509_tscode_list = list() 
for ts_code_sh in daily_20210509['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20210509_tscode_list.append(stock_name)
daily_20210509_addname_dataframe=pd.DataFrame()
daily_20210509_addname_dataframe['cname'] = daily_20210509_tscode_list
for table_name in daily_20210509.columns.values.tolist():
    daily_20210509_addname_dataframe[table_name] = daily_20210509[table_name]
print("日线行情-时间为序  daily_20210509 返回数据 row 行数 = "+str(daily_20210509.shape[0]))
daily_20210509_addname_dataframe.to_excel(daily_202105_excel_writer,'9_7',index=False)
daily_202105_excel_writer.save()
daily_20210510 = pro.daily(start_date='',end_date='',trade_date='20210510', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20210510_tscode_list = list() 
for ts_code_sh in daily_20210510['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20210510_tscode_list.append(stock_name)
daily_20210510_addname_dataframe=pd.DataFrame()
daily_20210510_addname_dataframe['cname'] = daily_20210510_tscode_list
for table_name in daily_20210510.columns.values.tolist():
    daily_20210510_addname_dataframe[table_name] = daily_20210510[table_name]
print("日线行情-时间为序  daily_20210510 返回数据 row 行数 = "+str(daily_20210510.shape[0]))
daily_20210510_addname_dataframe.to_excel(daily_202105_excel_writer,'10_1',index=False)
daily_202105_excel_writer.save()
daily_20210511 = pro.daily(start_date='',end_date='',trade_date='20210511', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20210511_tscode_list = list() 
for ts_code_sh in daily_20210511['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20210511_tscode_list.append(stock_name)
daily_20210511_addname_dataframe=pd.DataFrame()
daily_20210511_addname_dataframe['cname'] = daily_20210511_tscode_list
for table_name in daily_20210511.columns.values.tolist():
    daily_20210511_addname_dataframe[table_name] = daily_20210511[table_name]
print("日线行情-时间为序  daily_20210511 返回数据 row 行数 = "+str(daily_20210511.shape[0]))
daily_20210511_addname_dataframe.to_excel(daily_202105_excel_writer,'11_2',index=False)
daily_202105_excel_writer.save()
daily_20210512 = pro.daily(start_date='',end_date='',trade_date='20210512', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20210512_tscode_list = list() 
for ts_code_sh in daily_20210512['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20210512_tscode_list.append(stock_name)
daily_20210512_addname_dataframe=pd.DataFrame()
daily_20210512_addname_dataframe['cname'] = daily_20210512_tscode_list
for table_name in daily_20210512.columns.values.tolist():
    daily_20210512_addname_dataframe[table_name] = daily_20210512[table_name]
print("日线行情-时间为序  daily_20210512 返回数据 row 行数 = "+str(daily_20210512.shape[0]))
daily_20210512_addname_dataframe.to_excel(daily_202105_excel_writer,'12_3',index=False)
daily_202105_excel_writer.save()
daily_20210513 = pro.daily(start_date='',end_date='',trade_date='20210513', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20210513_tscode_list = list() 
for ts_code_sh in daily_20210513['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20210513_tscode_list.append(stock_name)
daily_20210513_addname_dataframe=pd.DataFrame()
daily_20210513_addname_dataframe['cname'] = daily_20210513_tscode_list
for table_name in daily_20210513.columns.values.tolist():
    daily_20210513_addname_dataframe[table_name] = daily_20210513[table_name]
print("日线行情-时间为序  daily_20210513 返回数据 row 行数 = "+str(daily_20210513.shape[0]))
daily_20210513_addname_dataframe.to_excel(daily_202105_excel_writer,'13_4',index=False)
daily_202105_excel_writer.save()
daily_20210514 = pro.daily(start_date='',end_date='',trade_date='20210514', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20210514_tscode_list = list() 
for ts_code_sh in daily_20210514['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20210514_tscode_list.append(stock_name)
daily_20210514_addname_dataframe=pd.DataFrame()
daily_20210514_addname_dataframe['cname'] = daily_20210514_tscode_list
for table_name in daily_20210514.columns.values.tolist():
    daily_20210514_addname_dataframe[table_name] = daily_20210514[table_name]
print("日线行情-时间为序  daily_20210514 返回数据 row 行数 = "+str(daily_20210514.shape[0]))
daily_20210514_addname_dataframe.to_excel(daily_202105_excel_writer,'14_5',index=False)
daily_202105_excel_writer.save()
daily_20210515 = pro.daily(start_date='',end_date='',trade_date='20210515', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20210515_tscode_list = list() 
for ts_code_sh in daily_20210515['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20210515_tscode_list.append(stock_name)
daily_20210515_addname_dataframe=pd.DataFrame()
daily_20210515_addname_dataframe['cname'] = daily_20210515_tscode_list
for table_name in daily_20210515.columns.values.tolist():
    daily_20210515_addname_dataframe[table_name] = daily_20210515[table_name]
print("日线行情-时间为序  daily_20210515 返回数据 row 行数 = "+str(daily_20210515.shape[0]))
daily_20210515_addname_dataframe.to_excel(daily_202105_excel_writer,'15_6',index=False)
daily_202105_excel_writer.save()
daily_20210516 = pro.daily(start_date='',end_date='',trade_date='20210516', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20210516_tscode_list = list() 
for ts_code_sh in daily_20210516['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20210516_tscode_list.append(stock_name)
daily_20210516_addname_dataframe=pd.DataFrame()
daily_20210516_addname_dataframe['cname'] = daily_20210516_tscode_list
for table_name in daily_20210516.columns.values.tolist():
    daily_20210516_addname_dataframe[table_name] = daily_20210516[table_name]
print("日线行情-时间为序  daily_20210516 返回数据 row 行数 = "+str(daily_20210516.shape[0]))
daily_20210516_addname_dataframe.to_excel(daily_202105_excel_writer,'16_7',index=False)
daily_202105_excel_writer.save()
daily_20210517 = pro.daily(start_date='',end_date='',trade_date='20210517', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20210517_tscode_list = list() 
for ts_code_sh in daily_20210517['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20210517_tscode_list.append(stock_name)
daily_20210517_addname_dataframe=pd.DataFrame()
daily_20210517_addname_dataframe['cname'] = daily_20210517_tscode_list
for table_name in daily_20210517.columns.values.tolist():
    daily_20210517_addname_dataframe[table_name] = daily_20210517[table_name]
print("日线行情-时间为序  daily_20210517 返回数据 row 行数 = "+str(daily_20210517.shape[0]))
daily_20210517_addname_dataframe.to_excel(daily_202105_excel_writer,'17_1',index=False)
daily_202105_excel_writer.save()
daily_20210518 = pro.daily(start_date='',end_date='',trade_date='20210518', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20210518_tscode_list = list() 
for ts_code_sh in daily_20210518['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20210518_tscode_list.append(stock_name)
daily_20210518_addname_dataframe=pd.DataFrame()
daily_20210518_addname_dataframe['cname'] = daily_20210518_tscode_list
for table_name in daily_20210518.columns.values.tolist():
    daily_20210518_addname_dataframe[table_name] = daily_20210518[table_name]
print("日线行情-时间为序  daily_20210518 返回数据 row 行数 = "+str(daily_20210518.shape[0]))
daily_20210518_addname_dataframe.to_excel(daily_202105_excel_writer,'18_2',index=False)
daily_202105_excel_writer.save()
daily_20210519 = pro.daily(start_date='',end_date='',trade_date='20210519', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20210519_tscode_list = list() 
for ts_code_sh in daily_20210519['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20210519_tscode_list.append(stock_name)
daily_20210519_addname_dataframe=pd.DataFrame()
daily_20210519_addname_dataframe['cname'] = daily_20210519_tscode_list
for table_name in daily_20210519.columns.values.tolist():
    daily_20210519_addname_dataframe[table_name] = daily_20210519[table_name]
print("日线行情-时间为序  daily_20210519 返回数据 row 行数 = "+str(daily_20210519.shape[0]))
daily_20210519_addname_dataframe.to_excel(daily_202105_excel_writer,'19_3',index=False)
daily_202105_excel_writer.save()
daily_20210520 = pro.daily(start_date='',end_date='',trade_date='20210520', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20210520_tscode_list = list() 
for ts_code_sh in daily_20210520['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20210520_tscode_list.append(stock_name)
daily_20210520_addname_dataframe=pd.DataFrame()
daily_20210520_addname_dataframe['cname'] = daily_20210520_tscode_list
for table_name in daily_20210520.columns.values.tolist():
    daily_20210520_addname_dataframe[table_name] = daily_20210520[table_name]
print("日线行情-时间为序  daily_20210520 返回数据 row 行数 = "+str(daily_20210520.shape[0]))
daily_20210520_addname_dataframe.to_excel(daily_202105_excel_writer,'20_4',index=False)
daily_202105_excel_writer.save()
daily_20210521 = pro.daily(start_date='',end_date='',trade_date='20210521', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20210521_tscode_list = list() 
for ts_code_sh in daily_20210521['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20210521_tscode_list.append(stock_name)
daily_20210521_addname_dataframe=pd.DataFrame()
daily_20210521_addname_dataframe['cname'] = daily_20210521_tscode_list
for table_name in daily_20210521.columns.values.tolist():
    daily_20210521_addname_dataframe[table_name] = daily_20210521[table_name]
print("日线行情-时间为序  daily_20210521 返回数据 row 行数 = "+str(daily_20210521.shape[0]))
daily_20210521_addname_dataframe.to_excel(daily_202105_excel_writer,'21_5',index=False)
daily_202105_excel_writer.save()
daily_20210522 = pro.daily(start_date='',end_date='',trade_date='20210522', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20210522_tscode_list = list() 
for ts_code_sh in daily_20210522['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20210522_tscode_list.append(stock_name)
daily_20210522_addname_dataframe=pd.DataFrame()
daily_20210522_addname_dataframe['cname'] = daily_20210522_tscode_list
for table_name in daily_20210522.columns.values.tolist():
    daily_20210522_addname_dataframe[table_name] = daily_20210522[table_name]
print("日线行情-时间为序  daily_20210522 返回数据 row 行数 = "+str(daily_20210522.shape[0]))
daily_20210522_addname_dataframe.to_excel(daily_202105_excel_writer,'22_6',index=False)
daily_202105_excel_writer.save()
daily_20210523 = pro.daily(start_date='',end_date='',trade_date='20210523', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20210523_tscode_list = list() 
for ts_code_sh in daily_20210523['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20210523_tscode_list.append(stock_name)
daily_20210523_addname_dataframe=pd.DataFrame()
daily_20210523_addname_dataframe['cname'] = daily_20210523_tscode_list
for table_name in daily_20210523.columns.values.tolist():
    daily_20210523_addname_dataframe[table_name] = daily_20210523[table_name]
print("日线行情-时间为序  daily_20210523 返回数据 row 行数 = "+str(daily_20210523.shape[0]))
daily_20210523_addname_dataframe.to_excel(daily_202105_excel_writer,'23_7',index=False)
daily_202105_excel_writer.save()
daily_20210524 = pro.daily(start_date='',end_date='',trade_date='20210524', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20210524_tscode_list = list() 
for ts_code_sh in daily_20210524['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20210524_tscode_list.append(stock_name)
daily_20210524_addname_dataframe=pd.DataFrame()
daily_20210524_addname_dataframe['cname'] = daily_20210524_tscode_list
for table_name in daily_20210524.columns.values.tolist():
    daily_20210524_addname_dataframe[table_name] = daily_20210524[table_name]
print("日线行情-时间为序  daily_20210524 返回数据 row 行数 = "+str(daily_20210524.shape[0]))
daily_20210524_addname_dataframe.to_excel(daily_202105_excel_writer,'24_1',index=False)
daily_202105_excel_writer.save()
daily_20210525 = pro.daily(start_date='',end_date='',trade_date='20210525', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20210525_tscode_list = list() 
for ts_code_sh in daily_20210525['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20210525_tscode_list.append(stock_name)
daily_20210525_addname_dataframe=pd.DataFrame()
daily_20210525_addname_dataframe['cname'] = daily_20210525_tscode_list
for table_name in daily_20210525.columns.values.tolist():
    daily_20210525_addname_dataframe[table_name] = daily_20210525[table_name]
print("日线行情-时间为序  daily_20210525 返回数据 row 行数 = "+str(daily_20210525.shape[0]))
daily_20210525_addname_dataframe.to_excel(daily_202105_excel_writer,'25_2',index=False)
daily_202105_excel_writer.save()
daily_20210526 = pro.daily(start_date='',end_date='',trade_date='20210526', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20210526_tscode_list = list() 
for ts_code_sh in daily_20210526['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20210526_tscode_list.append(stock_name)
daily_20210526_addname_dataframe=pd.DataFrame()
daily_20210526_addname_dataframe['cname'] = daily_20210526_tscode_list
for table_name in daily_20210526.columns.values.tolist():
    daily_20210526_addname_dataframe[table_name] = daily_20210526[table_name]
print("日线行情-时间为序  daily_20210526 返回数据 row 行数 = "+str(daily_20210526.shape[0]))
daily_20210526_addname_dataframe.to_excel(daily_202105_excel_writer,'26_3',index=False)
daily_202105_excel_writer.save()
daily_20210527 = pro.daily(start_date='',end_date='',trade_date='20210527', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20210527_tscode_list = list() 
for ts_code_sh in daily_20210527['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20210527_tscode_list.append(stock_name)
daily_20210527_addname_dataframe=pd.DataFrame()
daily_20210527_addname_dataframe['cname'] = daily_20210527_tscode_list
for table_name in daily_20210527.columns.values.tolist():
    daily_20210527_addname_dataframe[table_name] = daily_20210527[table_name]
print("日线行情-时间为序  daily_20210527 返回数据 row 行数 = "+str(daily_20210527.shape[0]))
daily_20210527_addname_dataframe.to_excel(daily_202105_excel_writer,'27_4',index=False)
daily_202105_excel_writer.save()
daily_20210528 = pro.daily(start_date='',end_date='',trade_date='20210528', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20210528_tscode_list = list() 
for ts_code_sh in daily_20210528['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20210528_tscode_list.append(stock_name)
daily_20210528_addname_dataframe=pd.DataFrame()
daily_20210528_addname_dataframe['cname'] = daily_20210528_tscode_list
for table_name in daily_20210528.columns.values.tolist():
    daily_20210528_addname_dataframe[table_name] = daily_20210528[table_name]
print("日线行情-时间为序  daily_20210528 返回数据 row 行数 = "+str(daily_20210528.shape[0]))
daily_20210528_addname_dataframe.to_excel(daily_202105_excel_writer,'28_5',index=False)
daily_202105_excel_writer.save()
daily_20210529 = pro.daily(start_date='',end_date='',trade_date='20210529', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20210529_tscode_list = list() 
for ts_code_sh in daily_20210529['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20210529_tscode_list.append(stock_name)
daily_20210529_addname_dataframe=pd.DataFrame()
daily_20210529_addname_dataframe['cname'] = daily_20210529_tscode_list
for table_name in daily_20210529.columns.values.tolist():
    daily_20210529_addname_dataframe[table_name] = daily_20210529[table_name]
print("日线行情-时间为序  daily_20210529 返回数据 row 行数 = "+str(daily_20210529.shape[0]))
daily_20210529_addname_dataframe.to_excel(daily_202105_excel_writer,'29_6',index=False)
daily_202105_excel_writer.save()
daily_20210530 = pro.daily(start_date='',end_date='',trade_date='20210530', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20210530_tscode_list = list() 
for ts_code_sh in daily_20210530['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20210530_tscode_list.append(stock_name)
daily_20210530_addname_dataframe=pd.DataFrame()
daily_20210530_addname_dataframe['cname'] = daily_20210530_tscode_list
for table_name in daily_20210530.columns.values.tolist():
    daily_20210530_addname_dataframe[table_name] = daily_20210530[table_name]
print("日线行情-时间为序  daily_20210530 返回数据 row 行数 = "+str(daily_20210530.shape[0]))
daily_20210530_addname_dataframe.to_excel(daily_202105_excel_writer,'30_7',index=False)
daily_202105_excel_writer.save()
daily_20210531 = pro.daily(start_date='',end_date='',trade_date='20210531', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20210531_tscode_list = list() 
for ts_code_sh in daily_20210531['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20210531_tscode_list.append(stock_name)
daily_20210531_addname_dataframe=pd.DataFrame()
daily_20210531_addname_dataframe['cname'] = daily_20210531_tscode_list
for table_name in daily_20210531.columns.values.tolist():
    daily_20210531_addname_dataframe[table_name] = daily_20210531[table_name]
print("日线行情-时间为序  daily_20210531 返回数据 row 行数 = "+str(daily_20210531.shape[0]))
daily_20210531_addname_dataframe.to_excel(daily_202105_excel_writer,'31_1',index=False)
daily_202105_excel_writer.save()




createexcel('daily_202106.xlsx')
daily_202106_book = load_workbook('C:\\Users\\zhuzj5\\Desktop\\zbin\\J0_Data\\daily_202106.xlsx')
daily_202106_excel_writer = pd.ExcelWriter('C:\\Users\\zhuzj5\\Desktop\\zbin\\J0_Data\\daily_202106.xlsx', engine='openpyxl')
daily_202106_excel_writer.book = daily_202106_book
daily_202106_excel_writer.sheets = dict((ws.title, ws) for ws in daily_202106_book.worksheets)
J0_PROPS.put(tree_node_name+"record_date", "20210601")       ###  更新 记录日期
daily_20210601 = pro.daily(start_date='',end_date='',trade_date='20210601', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20210601_tscode_list = list() 
for ts_code_sh in daily_20210601['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20210601_tscode_list.append(stock_name)
daily_20210601_addname_dataframe=pd.DataFrame()
daily_20210601_addname_dataframe['cname'] = daily_20210601_tscode_list
for table_name in daily_20210601.columns.values.tolist():
    daily_20210601_addname_dataframe[table_name] = daily_20210601[table_name]
print("日线行情-时间为序  daily_20210601 返回数据 row 行数 = "+str(daily_20210601.shape[0]))
daily_20210601_addname_dataframe.to_excel(daily_202106_excel_writer,'1_2',index=False)
daily_202106_excel_writer.save()
daily_20210602 = pro.daily(start_date='',end_date='',trade_date='20210602', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20210602_tscode_list = list() 
for ts_code_sh in daily_20210602['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20210602_tscode_list.append(stock_name)
daily_20210602_addname_dataframe=pd.DataFrame()
daily_20210602_addname_dataframe['cname'] = daily_20210602_tscode_list
for table_name in daily_20210602.columns.values.tolist():
    daily_20210602_addname_dataframe[table_name] = daily_20210602[table_name]
print("日线行情-时间为序  daily_20210602 返回数据 row 行数 = "+str(daily_20210602.shape[0]))
daily_20210602_addname_dataframe.to_excel(daily_202106_excel_writer,'2_3',index=False)
daily_202106_excel_writer.save()
daily_20210603 = pro.daily(start_date='',end_date='',trade_date='20210603', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20210603_tscode_list = list() 
for ts_code_sh in daily_20210603['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20210603_tscode_list.append(stock_name)
daily_20210603_addname_dataframe=pd.DataFrame()
daily_20210603_addname_dataframe['cname'] = daily_20210603_tscode_list
for table_name in daily_20210603.columns.values.tolist():
    daily_20210603_addname_dataframe[table_name] = daily_20210603[table_name]
print("日线行情-时间为序  daily_20210603 返回数据 row 行数 = "+str(daily_20210603.shape[0]))
daily_20210603_addname_dataframe.to_excel(daily_202106_excel_writer,'3_4',index=False)
daily_202106_excel_writer.save()
daily_20210604 = pro.daily(start_date='',end_date='',trade_date='20210604', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20210604_tscode_list = list() 
for ts_code_sh in daily_20210604['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20210604_tscode_list.append(stock_name)
daily_20210604_addname_dataframe=pd.DataFrame()
daily_20210604_addname_dataframe['cname'] = daily_20210604_tscode_list
for table_name in daily_20210604.columns.values.tolist():
    daily_20210604_addname_dataframe[table_name] = daily_20210604[table_name]
print("日线行情-时间为序  daily_20210604 返回数据 row 行数 = "+str(daily_20210604.shape[0]))
daily_20210604_addname_dataframe.to_excel(daily_202106_excel_writer,'4_5',index=False)
daily_202106_excel_writer.save()
daily_20210605 = pro.daily(start_date='',end_date='',trade_date='20210605', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20210605_tscode_list = list() 
for ts_code_sh in daily_20210605['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20210605_tscode_list.append(stock_name)
daily_20210605_addname_dataframe=pd.DataFrame()
daily_20210605_addname_dataframe['cname'] = daily_20210605_tscode_list
for table_name in daily_20210605.columns.values.tolist():
    daily_20210605_addname_dataframe[table_name] = daily_20210605[table_name]
print("日线行情-时间为序  daily_20210605 返回数据 row 行数 = "+str(daily_20210605.shape[0]))
daily_20210605_addname_dataframe.to_excel(daily_202106_excel_writer,'5_6',index=False)
daily_202106_excel_writer.save()
daily_20210606 = pro.daily(start_date='',end_date='',trade_date='20210606', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20210606_tscode_list = list() 
for ts_code_sh in daily_20210606['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20210606_tscode_list.append(stock_name)
daily_20210606_addname_dataframe=pd.DataFrame()
daily_20210606_addname_dataframe['cname'] = daily_20210606_tscode_list
for table_name in daily_20210606.columns.values.tolist():
    daily_20210606_addname_dataframe[table_name] = daily_20210606[table_name]
print("日线行情-时间为序  daily_20210606 返回数据 row 行数 = "+str(daily_20210606.shape[0]))
daily_20210606_addname_dataframe.to_excel(daily_202106_excel_writer,'6_7',index=False)
daily_202106_excel_writer.save()
daily_20210607 = pro.daily(start_date='',end_date='',trade_date='20210607', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20210607_tscode_list = list() 
for ts_code_sh in daily_20210607['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20210607_tscode_list.append(stock_name)
daily_20210607_addname_dataframe=pd.DataFrame()
daily_20210607_addname_dataframe['cname'] = daily_20210607_tscode_list
for table_name in daily_20210607.columns.values.tolist():
    daily_20210607_addname_dataframe[table_name] = daily_20210607[table_name]
print("日线行情-时间为序  daily_20210607 返回数据 row 行数 = "+str(daily_20210607.shape[0]))
daily_20210607_addname_dataframe.to_excel(daily_202106_excel_writer,'7_1',index=False)
daily_202106_excel_writer.save()
daily_20210608 = pro.daily(start_date='',end_date='',trade_date='20210608', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20210608_tscode_list = list() 
for ts_code_sh in daily_20210608['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20210608_tscode_list.append(stock_name)
daily_20210608_addname_dataframe=pd.DataFrame()
daily_20210608_addname_dataframe['cname'] = daily_20210608_tscode_list
for table_name in daily_20210608.columns.values.tolist():
    daily_20210608_addname_dataframe[table_name] = daily_20210608[table_name]
print("日线行情-时间为序  daily_20210608 返回数据 row 行数 = "+str(daily_20210608.shape[0]))
daily_20210608_addname_dataframe.to_excel(daily_202106_excel_writer,'8_2',index=False)
daily_202106_excel_writer.save()
daily_20210609 = pro.daily(start_date='',end_date='',trade_date='20210609', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20210609_tscode_list = list() 
for ts_code_sh in daily_20210609['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20210609_tscode_list.append(stock_name)
daily_20210609_addname_dataframe=pd.DataFrame()
daily_20210609_addname_dataframe['cname'] = daily_20210609_tscode_list
for table_name in daily_20210609.columns.values.tolist():
    daily_20210609_addname_dataframe[table_name] = daily_20210609[table_name]
print("日线行情-时间为序  daily_20210609 返回数据 row 行数 = "+str(daily_20210609.shape[0]))
daily_20210609_addname_dataframe.to_excel(daily_202106_excel_writer,'9_3',index=False)
daily_202106_excel_writer.save()
daily_20210610 = pro.daily(start_date='',end_date='',trade_date='20210610', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20210610_tscode_list = list() 
for ts_code_sh in daily_20210610['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20210610_tscode_list.append(stock_name)
daily_20210610_addname_dataframe=pd.DataFrame()
daily_20210610_addname_dataframe['cname'] = daily_20210610_tscode_list
for table_name in daily_20210610.columns.values.tolist():
    daily_20210610_addname_dataframe[table_name] = daily_20210610[table_name]
print("日线行情-时间为序  daily_20210610 返回数据 row 行数 = "+str(daily_20210610.shape[0]))
daily_20210610_addname_dataframe.to_excel(daily_202106_excel_writer,'10_4',index=False)
daily_202106_excel_writer.save()
daily_20210611 = pro.daily(start_date='',end_date='',trade_date='20210611', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20210611_tscode_list = list() 
for ts_code_sh in daily_20210611['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20210611_tscode_list.append(stock_name)
daily_20210611_addname_dataframe=pd.DataFrame()
daily_20210611_addname_dataframe['cname'] = daily_20210611_tscode_list
for table_name in daily_20210611.columns.values.tolist():
    daily_20210611_addname_dataframe[table_name] = daily_20210611[table_name]
print("日线行情-时间为序  daily_20210611 返回数据 row 行数 = "+str(daily_20210611.shape[0]))
daily_20210611_addname_dataframe.to_excel(daily_202106_excel_writer,'11_5',index=False)
daily_202106_excel_writer.save()
daily_20210612 = pro.daily(start_date='',end_date='',trade_date='20210612', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20210612_tscode_list = list() 
for ts_code_sh in daily_20210612['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20210612_tscode_list.append(stock_name)
daily_20210612_addname_dataframe=pd.DataFrame()
daily_20210612_addname_dataframe['cname'] = daily_20210612_tscode_list
for table_name in daily_20210612.columns.values.tolist():
    daily_20210612_addname_dataframe[table_name] = daily_20210612[table_name]
print("日线行情-时间为序  daily_20210612 返回数据 row 行数 = "+str(daily_20210612.shape[0]))
daily_20210612_addname_dataframe.to_excel(daily_202106_excel_writer,'12_6',index=False)
daily_202106_excel_writer.save()
daily_20210613 = pro.daily(start_date='',end_date='',trade_date='20210613', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20210613_tscode_list = list() 
for ts_code_sh in daily_20210613['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20210613_tscode_list.append(stock_name)
daily_20210613_addname_dataframe=pd.DataFrame()
daily_20210613_addname_dataframe['cname'] = daily_20210613_tscode_list
for table_name in daily_20210613.columns.values.tolist():
    daily_20210613_addname_dataframe[table_name] = daily_20210613[table_name]
print("日线行情-时间为序  daily_20210613 返回数据 row 行数 = "+str(daily_20210613.shape[0]))
daily_20210613_addname_dataframe.to_excel(daily_202106_excel_writer,'13_7',index=False)
daily_202106_excel_writer.save()
daily_20210614 = pro.daily(start_date='',end_date='',trade_date='20210614', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20210614_tscode_list = list() 
for ts_code_sh in daily_20210614['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20210614_tscode_list.append(stock_name)
daily_20210614_addname_dataframe=pd.DataFrame()
daily_20210614_addname_dataframe['cname'] = daily_20210614_tscode_list
for table_name in daily_20210614.columns.values.tolist():
    daily_20210614_addname_dataframe[table_name] = daily_20210614[table_name]
print("日线行情-时间为序  daily_20210614 返回数据 row 行数 = "+str(daily_20210614.shape[0]))
daily_20210614_addname_dataframe.to_excel(daily_202106_excel_writer,'14_1',index=False)
daily_202106_excel_writer.save()
daily_20210615 = pro.daily(start_date='',end_date='',trade_date='20210615', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20210615_tscode_list = list() 
for ts_code_sh in daily_20210615['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20210615_tscode_list.append(stock_name)
daily_20210615_addname_dataframe=pd.DataFrame()
daily_20210615_addname_dataframe['cname'] = daily_20210615_tscode_list
for table_name in daily_20210615.columns.values.tolist():
    daily_20210615_addname_dataframe[table_name] = daily_20210615[table_name]
print("日线行情-时间为序  daily_20210615 返回数据 row 行数 = "+str(daily_20210615.shape[0]))
daily_20210615_addname_dataframe.to_excel(daily_202106_excel_writer,'15_2',index=False)
daily_202106_excel_writer.save()
daily_20210616 = pro.daily(start_date='',end_date='',trade_date='20210616', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20210616_tscode_list = list() 
for ts_code_sh in daily_20210616['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20210616_tscode_list.append(stock_name)
daily_20210616_addname_dataframe=pd.DataFrame()
daily_20210616_addname_dataframe['cname'] = daily_20210616_tscode_list
for table_name in daily_20210616.columns.values.tolist():
    daily_20210616_addname_dataframe[table_name] = daily_20210616[table_name]
print("日线行情-时间为序  daily_20210616 返回数据 row 行数 = "+str(daily_20210616.shape[0]))
daily_20210616_addname_dataframe.to_excel(daily_202106_excel_writer,'16_3',index=False)
daily_202106_excel_writer.save()
daily_20210617 = pro.daily(start_date='',end_date='',trade_date='20210617', fields='ts_code,trade_date,open,high,low,close,pre_close,change,pct_chg,vol,amount')
daily_20210617_tscode_list = list() 
for ts_code_sh in daily_20210617['ts_code']:
    stock_name = tscode_name_dict.get(ts_code_sh)
    if stock_name is None:
        stock_name = 'null'
    daily_20210617_tscode_list.append(stock_name)
daily_20210617_addname_dataframe=pd.DataFrame()
daily_20210617_addname_dataframe['cname'] = daily_20210617_tscode_list
for table_name in daily_20210617.columns.values.tolist():
    daily_20210617_addname_dataframe[table_name] = daily_20210617[table_name]
print("日线行情-时间为序  daily_20210617 返回数据 row 行数 = "+str(daily_20210617.shape[0]))
daily_20210617_addname_dataframe.to_excel(daily_202106_excel_writer,'17_4',index=False)
daily_202106_excel_writer.save()




createexcel('daily_202107.xlsx')
daily_202107_book = load_workbook('C:\\Users\\zhuzj5\\Desktop\\zbin\\J0_Data\\daily_202107.xlsx')
daily_202107_excel_writer = pd.ExcelWriter('C:\\Users\\zhuzj5\\Desktop\\zbin\\J0_Data\\daily_202107.xlsx', engine='openpyxl')
daily_202107_excel_writer.book = daily_202107_book
daily_202107_excel_writer.sheets = dict((ws.title, ws) for ws in daily_202107_book.worksheets)
J0_PROPS.put(tree_node_name+"record_date", "20210701")       ###  更新 记录日期




J0_PROPS.put(tree_node_name+"record_date", "19901219")       ###  更新 记录日期
